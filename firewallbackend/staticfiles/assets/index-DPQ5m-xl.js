(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Cf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var hv={exports:{}},bf={},pv={exports:{}},gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nc=Symbol.for("react.element"),EE=Symbol.for("react.portal"),SE=Symbol.for("react.fragment"),TE=Symbol.for("react.strict_mode"),CE=Symbol.for("react.profiler"),bE=Symbol.for("react.provider"),NE=Symbol.for("react.context"),AE=Symbol.for("react.forward_ref"),LE=Symbol.for("react.suspense"),FE=Symbol.for("react.memo"),PE=Symbol.for("react.lazy"),mg=Symbol.iterator;function OE(e){return e===null||typeof e!="object"?null:(e=mg&&e[mg]||e["@@iterator"],typeof e=="function"?e:null)}var mv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gv=Object.assign,xv={};function _o(e,t,r){this.props=e,this.context=t,this.refs=xv,this.updater=r||mv}_o.prototype.isReactComponent={};_o.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_o.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vv(){}vv.prototype=_o.prototype;function jh(e,t,r){this.props=e,this.context=t,this.refs=xv,this.updater=r||mv}var Bh=jh.prototype=new vv;Bh.constructor=jh;gv(Bh,_o.prototype);Bh.isPureReactComponent=!0;var gg=Array.isArray,_v=Object.prototype.hasOwnProperty,zh={current:null},yv={key:!0,ref:!0,__self:!0,__source:!0};function wv(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)_v.call(t,n)&&!yv.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var u=Array(l),f=0;f<l;f++)u[f]=arguments[f+2];a.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:nc,type:e,key:i,ref:o,props:a,_owner:zh.current}}function RE(e,t){return{$$typeof:nc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Uh(e){return typeof e=="object"&&e!==null&&e.$$typeof===nc}function ME(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var xg=/\/+/g;function N0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ME(""+e.key):t.toString(36)}function mu(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case nc:case EE:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+N0(o,0):n,gg(a)?(r="",e!=null&&(r=e.replace(xg,"$&/")+"/"),mu(a,t,r,"",function(f){return f})):a!=null&&(Uh(a)&&(a=RE(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(xg,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",gg(e))for(var l=0;l<e.length;l++){i=e[l];var u=n+N0(i,l);o+=mu(i,t,r,u,a)}else if(u=OE(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=n+N0(i,l++),o+=mu(i,t,r,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Bc(e,t,r){if(e==null)return e;var n=[],a=0;return mu(e,n,"","",function(i){return t.call(r,i,a++)}),n}function IE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qr={current:null},gu={transition:null},DE={ReactCurrentDispatcher:qr,ReactCurrentBatchConfig:gu,ReactCurrentOwner:zh};function kv(){throw Error("act(...) is not supported in production builds of React.")}gt.Children={map:Bc,forEach:function(e,t,r){Bc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Bc(e,function(){t++}),t},toArray:function(e){return Bc(e,function(t){return t})||[]},only:function(e){if(!Uh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};gt.Component=_o;gt.Fragment=SE;gt.Profiler=CE;gt.PureComponent=jh;gt.StrictMode=TE;gt.Suspense=LE;gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DE;gt.act=kv;gt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=gv({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=zh.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)_v.call(t,u)&&!yv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var f=0;f<u;f++)l[f]=arguments[f+2];n.children=l}return{$$typeof:nc,type:e.type,key:a,ref:i,props:n,_owner:o}};gt.createContext=function(e){return e={$$typeof:NE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bE,_context:e},e.Consumer=e};gt.createElement=wv;gt.createFactory=function(e){var t=wv.bind(null,e);return t.type=e,t};gt.createRef=function(){return{current:null}};gt.forwardRef=function(e){return{$$typeof:AE,render:e}};gt.isValidElement=Uh;gt.lazy=function(e){return{$$typeof:PE,_payload:{_status:-1,_result:e},_init:IE}};gt.memo=function(e,t){return{$$typeof:FE,type:e,compare:t===void 0?null:t}};gt.startTransition=function(e){var t=gu.transition;gu.transition={};try{e()}finally{gu.transition=t}};gt.unstable_act=kv;gt.useCallback=function(e,t){return qr.current.useCallback(e,t)};gt.useContext=function(e){return qr.current.useContext(e)};gt.useDebugValue=function(){};gt.useDeferredValue=function(e){return qr.current.useDeferredValue(e)};gt.useEffect=function(e,t){return qr.current.useEffect(e,t)};gt.useId=function(){return qr.current.useId()};gt.useImperativeHandle=function(e,t,r){return qr.current.useImperativeHandle(e,t,r)};gt.useInsertionEffect=function(e,t){return qr.current.useInsertionEffect(e,t)};gt.useLayoutEffect=function(e,t){return qr.current.useLayoutEffect(e,t)};gt.useMemo=function(e,t){return qr.current.useMemo(e,t)};gt.useReducer=function(e,t,r){return qr.current.useReducer(e,t,r)};gt.useRef=function(e){return qr.current.useRef(e)};gt.useState=function(e){return qr.current.useState(e)};gt.useSyncExternalStore=function(e,t,r){return qr.current.useSyncExternalStore(e,t,r)};gt.useTransition=function(){return qr.current.useTransition()};gt.version="18.3.1";pv.exports=gt;var C=pv.exports;const Pn=dv(C);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jE=C,BE=Symbol.for("react.element"),zE=Symbol.for("react.fragment"),UE=Object.prototype.hasOwnProperty,HE=jE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VE={key:!0,ref:!0,__self:!0,__source:!0};function Ev(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)UE.call(t,n)&&!VE.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:BE,type:e,key:i,ref:o,props:a,_owner:HE.current}}bf.Fragment=zE;bf.jsx=Ev;bf.jsxs=Ev;hv.exports=bf;var d=hv.exports,yd={},Sv={exports:{}},_n={},Tv={exports:{}},Cv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,K){var ie=re.length;re.push(K);e:for(;0<ie;){var he=ie-1>>>1,R=re[he];if(0<a(R,K))re[he]=K,re[ie]=R,ie=he;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var K=re[0],ie=re.pop();if(ie!==K){re[0]=ie;e:for(var he=0,R=re.length,J=R>>>1;he<J;){var q=2*(he+1)-1,Z=re[q],ae=q+1,ye=re[ae];if(0>a(Z,ie))ae<R&&0>a(ye,Z)?(re[he]=ye,re[ae]=ie,he=ae):(re[he]=Z,re[q]=ie,he=q);else if(ae<R&&0>a(ye,ie))re[he]=ye,re[ae]=ie,he=ae;else break e}}return K}function a(re,K){var ie=re.sortIndex-K.sortIndex;return ie!==0?ie:re.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],f=[],h=1,m=null,g=3,x=!1,_=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(re){for(var K=r(f);K!==null;){if(K.callback===null)n(f);else if(K.startTime<=re)n(f),K.sortIndex=K.expirationTime,t(u,K);else break;K=r(f)}}function F(re){if(y=!1,w(re),!_)if(r(u)!==null)_=!0,Y(j);else{var K=r(f);K!==null&&xe(F,K.startTime-re)}}function j(re,K){_=!1,y&&(y=!1,k(M),M=-1),x=!0;var ie=g;try{for(w(K),m=r(u);m!==null&&(!(m.expirationTime>K)||re&&!H());){var he=m.callback;if(typeof he=="function"){m.callback=null,g=m.priorityLevel;var R=he(m.expirationTime<=K);K=e.unstable_now(),typeof R=="function"?m.callback=R:m===r(u)&&n(u),w(K)}else n(u);m=r(u)}if(m!==null)var J=!0;else{var q=r(f);q!==null&&xe(F,q.startTime-K),J=!1}return J}finally{m=null,g=ie,x=!1}}var D=!1,A=null,M=-1,O=5,G=-1;function H(){return!(e.unstable_now()-G<O)}function W(){if(A!==null){var re=e.unstable_now();G=re;var K=!0;try{K=A(!0,re)}finally{K?fe():(D=!1,A=null)}}else D=!1}var fe;if(typeof E=="function")fe=function(){E(W)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,le=Se.port2;Se.port1.onmessage=W,fe=function(){le.postMessage(null)}}else fe=function(){S(W,0)};function Y(re){A=re,D||(D=!0,fe())}function xe(re,K){M=S(function(){re(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){_||x||(_=!0,Y(j))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(re){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var ie=g;g=K;try{return re()}finally{g=ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,K){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ie=g;g=re;try{return K()}finally{g=ie}},e.unstable_scheduleCallback=function(re,K,ie){var he=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?he+ie:he):ie=he,re){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=ie+R,re={id:h++,callback:K,priorityLevel:re,startTime:ie,expirationTime:R,sortIndex:-1},ie>he?(re.sortIndex=ie,t(f,re),r(u)===null&&re===r(f)&&(y?(k(M),M=-1):y=!0,xe(F,ie-he))):(re.sortIndex=R,t(u,re),_||x||(_=!0,Y(j))),re},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(re){var K=g;return function(){var ie=g;g=K;try{return re.apply(this,arguments)}finally{g=ie}}}})(Cv);Tv.exports=Cv;var $E=Tv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WE=C,xn=$E;function Te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bv=new Set,Ll={};function ps(e,t){co(e,t),co(e+"Capture",t)}function co(e,t){for(Ll[e]=t,e=0;e<t.length;e++)bv.add(t[e])}var Ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wd=Object.prototype.hasOwnProperty,ZE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vg={},_g={};function GE(e){return wd.call(_g,e)?!0:wd.call(vg,e)?!1:ZE.test(e)?_g[e]=!0:(vg[e]=!0,!1)}function XE(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qE(e,t,r,n){if(t===null||typeof t>"u"||XE(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Kr(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Tr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Tr[e]=new Kr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Tr[t]=new Kr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Tr[e]=new Kr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Tr[e]=new Kr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Tr[e]=new Kr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Tr[e]=new Kr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Tr[e]=new Kr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Tr[e]=new Kr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Tr[e]=new Kr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hh=/[\-:]([a-z])/g;function Vh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hh,Vh);Tr[t]=new Kr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hh,Vh);Tr[t]=new Kr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hh,Vh);Tr[t]=new Kr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Tr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!1,!1)});Tr.xlinkHref=new Kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Tr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!0,!0)});function $h(e,t,r,n){var a=Tr.hasOwnProperty(t)?Tr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(qE(t,r,a,n)&&(r=null),n||a===null?GE(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Xa=WE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zc=Symbol.for("react.element"),js=Symbol.for("react.portal"),Bs=Symbol.for("react.fragment"),Wh=Symbol.for("react.strict_mode"),kd=Symbol.for("react.profiler"),Nv=Symbol.for("react.provider"),Av=Symbol.for("react.context"),Zh=Symbol.for("react.forward_ref"),Ed=Symbol.for("react.suspense"),Sd=Symbol.for("react.suspense_list"),Gh=Symbol.for("react.memo"),ri=Symbol.for("react.lazy"),Lv=Symbol.for("react.offscreen"),yg=Symbol.iterator;function $o(e){return e===null||typeof e!="object"?null:(e=yg&&e[yg]||e["@@iterator"],typeof e=="function"?e:null)}var $t=Object.assign,A0;function el(e){if(A0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);A0=t&&t[1]||""}return`
`+A0+e}var L0=!1;function F0(e,t){if(!e||L0)return"";L0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var a=f.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var u=`
`+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{L0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?el(e):""}function KE(e){switch(e.tag){case 5:return el(e.type);case 16:return el("Lazy");case 13:return el("Suspense");case 19:return el("SuspenseList");case 0:case 2:case 15:return e=F0(e.type,!1),e;case 11:return e=F0(e.type.render,!1),e;case 1:return e=F0(e.type,!0),e;default:return""}}function Td(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Bs:return"Fragment";case js:return"Portal";case kd:return"Profiler";case Wh:return"StrictMode";case Ed:return"Suspense";case Sd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Av:return(e.displayName||"Context")+".Consumer";case Nv:return(e._context.displayName||"Context")+".Provider";case Zh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Gh:return t=e.displayName||null,t!==null?t:Td(e.type)||"Memo";case ri:t=e._payload,e=e._init;try{return Td(e(t))}catch{}}return null}function YE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Td(t);case 8:return t===Wh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ci(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Fv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function JE(e){var t=Fv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Uc(e){e._valueTracker||(e._valueTracker=JE(e))}function Pv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Fv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ou(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cd(e,t){var r=t.checked;return $t({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function wg(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ci(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ov(e,t){t=t.checked,t!=null&&$h(e,"checked",t,!1)}function bd(e,t){Ov(e,t);var r=Ci(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nd(e,t.type,r):t.hasOwnProperty("defaultValue")&&Nd(e,t.type,Ci(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function kg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Nd(e,t,r){(t!=="number"||Ou(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var tl=Array.isArray;function eo(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ci(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Ad(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Te(91));return $t({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Eg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Te(92));if(tl(r)){if(1<r.length)throw Error(Te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ci(r)}}function Rv(e,t){var r=Ci(t.value),n=Ci(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Sg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Mv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ld(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Mv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Hc,Iv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Hc=Hc||document.createElement("div"),Hc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Hc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Fl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ul={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QE=["Webkit","ms","Moz","O"];Object.keys(ul).forEach(function(e){QE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ul[t]=ul[e]})});function Dv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ul.hasOwnProperty(e)&&ul[e]?(""+t).trim():t+"px"}function jv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Dv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var eS=$t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fd(e,t){if(t){if(eS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Te(62))}}function Pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Od=null;function Xh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Rd=null,to=null,ro=null;function Tg(e){if(e=sc(e)){if(typeof Rd!="function")throw Error(Te(280));var t=e.stateNode;t&&(t=Pf(t),Rd(e.stateNode,e.type,t))}}function Bv(e){to?ro?ro.push(e):ro=[e]:to=e}function zv(){if(to){var e=to,t=ro;if(ro=to=null,Tg(e),t)for(e=0;e<t.length;e++)Tg(t[e])}}function Uv(e,t){return e(t)}function Hv(){}var P0=!1;function Vv(e,t,r){if(P0)return e(t,r);P0=!0;try{return Uv(e,t,r)}finally{P0=!1,(to!==null||ro!==null)&&(Hv(),zv())}}function Pl(e,t){var r=e.stateNode;if(r===null)return null;var n=Pf(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Te(231,t,typeof r));return r}var Md=!1;if(Ua)try{var Wo={};Object.defineProperty(Wo,"passive",{get:function(){Md=!0}}),window.addEventListener("test",Wo,Wo),window.removeEventListener("test",Wo,Wo)}catch{Md=!1}function tS(e,t,r,n,a,i,o,l,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(h){this.onError(h)}}var fl=!1,Ru=null,Mu=!1,Id=null,rS={onError:function(e){fl=!0,Ru=e}};function nS(e,t,r,n,a,i,o,l,u){fl=!1,Ru=null,tS.apply(rS,arguments)}function aS(e,t,r,n,a,i,o,l,u){if(nS.apply(this,arguments),fl){if(fl){var f=Ru;fl=!1,Ru=null}else throw Error(Te(198));Mu||(Mu=!0,Id=f)}}function ms(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function $v(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Cg(e){if(ms(e)!==e)throw Error(Te(188))}function iS(e){var t=e.alternate;if(!t){if(t=ms(e),t===null)throw Error(Te(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Cg(a),e;if(i===n)return Cg(a),t;i=i.sibling}throw Error(Te(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(Te(189))}}if(r.alternate!==n)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?e:t}function Wv(e){return e=iS(e),e!==null?Zv(e):null}function Zv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Zv(e);if(t!==null)return t;e=e.sibling}return null}var Gv=xn.unstable_scheduleCallback,bg=xn.unstable_cancelCallback,sS=xn.unstable_shouldYield,oS=xn.unstable_requestPaint,Jt=xn.unstable_now,lS=xn.unstable_getCurrentPriorityLevel,qh=xn.unstable_ImmediatePriority,Xv=xn.unstable_UserBlockingPriority,Iu=xn.unstable_NormalPriority,cS=xn.unstable_LowPriority,qv=xn.unstable_IdlePriority,Nf=null,ga=null;function uS(e){if(ga&&typeof ga.onCommitFiberRoot=="function")try{ga.onCommitFiberRoot(Nf,e,void 0,(e.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:hS,fS=Math.log,dS=Math.LN2;function hS(e){return e>>>=0,e===0?32:31-(fS(e)/dS|0)|0}var Vc=64,$c=4194304;function rl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Du(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=rl(l):(i&=o,i!==0&&(n=rl(i)))}else o=r&~a,o!==0?n=rl(o):i!==0&&(n=rl(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Yn(t),a=1<<r,n|=e[r],t&=~a;return n}function pS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Yn(i),l=1<<o,u=a[o];u===-1?(!(l&r)||l&n)&&(a[o]=pS(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function Dd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Kv(){var e=Vc;return Vc<<=1,!(Vc&4194240)&&(Vc=64),e}function O0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ac(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yn(t),e[t]=r}function gS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Yn(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Kh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Yn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var At=0;function Yv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Jv,Yh,Qv,e_,t_,jd=!1,Wc=[],mi=null,gi=null,xi=null,Ol=new Map,Rl=new Map,ii=[],xS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ng(e,t){switch(e){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":xi=null;break;case"pointerover":case"pointerout":Ol.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rl.delete(t.pointerId)}}function Zo(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=sc(t),t!==null&&Yh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function vS(e,t,r,n,a){switch(t){case"focusin":return mi=Zo(mi,e,t,r,n,a),!0;case"dragenter":return gi=Zo(gi,e,t,r,n,a),!0;case"mouseover":return xi=Zo(xi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Ol.set(i,Zo(Ol.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Rl.set(i,Zo(Rl.get(i)||null,e,t,r,n,a)),!0}return!1}function r_(e){var t=Gi(e.target);if(t!==null){var r=ms(t);if(r!==null){if(t=r.tag,t===13){if(t=$v(r),t!==null){e.blockedOn=t,t_(e.priority,function(){Qv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Bd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Od=n,r.target.dispatchEvent(n),Od=null}else return t=sc(r),t!==null&&Yh(t),e.blockedOn=r,!1;t.shift()}return!0}function Ag(e,t,r){xu(e)&&r.delete(t)}function _S(){jd=!1,mi!==null&&xu(mi)&&(mi=null),gi!==null&&xu(gi)&&(gi=null),xi!==null&&xu(xi)&&(xi=null),Ol.forEach(Ag),Rl.forEach(Ag)}function Go(e,t){e.blockedOn===t&&(e.blockedOn=null,jd||(jd=!0,xn.unstable_scheduleCallback(xn.unstable_NormalPriority,_S)))}function Ml(e){function t(a){return Go(a,e)}if(0<Wc.length){Go(Wc[0],e);for(var r=1;r<Wc.length;r++){var n=Wc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(mi!==null&&Go(mi,e),gi!==null&&Go(gi,e),xi!==null&&Go(xi,e),Ol.forEach(t),Rl.forEach(t),r=0;r<ii.length;r++)n=ii[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ii.length&&(r=ii[0],r.blockedOn===null);)r_(r),r.blockedOn===null&&ii.shift()}var no=Xa.ReactCurrentBatchConfig,ju=!0;function yS(e,t,r,n){var a=At,i=no.transition;no.transition=null;try{At=1,Jh(e,t,r,n)}finally{At=a,no.transition=i}}function wS(e,t,r,n){var a=At,i=no.transition;no.transition=null;try{At=4,Jh(e,t,r,n)}finally{At=a,no.transition=i}}function Jh(e,t,r,n){if(ju){var a=Bd(e,t,r,n);if(a===null)V0(e,t,n,Bu,r),Ng(e,n);else if(vS(a,e,t,r,n))n.stopPropagation();else if(Ng(e,n),t&4&&-1<xS.indexOf(e)){for(;a!==null;){var i=sc(a);if(i!==null&&Jv(i),i=Bd(e,t,r,n),i===null&&V0(e,t,n,Bu,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else V0(e,t,n,null,r)}}var Bu=null;function Bd(e,t,r,n){if(Bu=null,e=Xh(n),e=Gi(e),e!==null)if(t=ms(e),t===null)e=null;else if(r=t.tag,r===13){if(e=$v(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Bu=e,null}function n_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lS()){case qh:return 1;case Xv:return 4;case Iu:case cS:return 16;case qv:return 536870912;default:return 16}default:return 16}}var ui=null,Qh=null,vu=null;function a_(){if(vu)return vu;var e,t=Qh,r=t.length,n,a="value"in ui?ui.value:ui.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return vu=a.slice(e,1<n?1-n:void 0)}function _u(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zc(){return!0}function Lg(){return!1}function yn(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zc:Lg,this.isPropagationStopped=Lg,this}return $t(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Zc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Zc)},persist:function(){},isPersistent:Zc}),t}var yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ep=yn(yo),ic=$t({},yo,{view:0,detail:0}),kS=yn(ic),R0,M0,Xo,Af=$t({},ic,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xo&&(Xo&&e.type==="mousemove"?(R0=e.screenX-Xo.screenX,M0=e.screenY-Xo.screenY):M0=R0=0,Xo=e),R0)},movementY:function(e){return"movementY"in e?e.movementY:M0}}),Fg=yn(Af),ES=$t({},Af,{dataTransfer:0}),SS=yn(ES),TS=$t({},ic,{relatedTarget:0}),I0=yn(TS),CS=$t({},yo,{animationName:0,elapsedTime:0,pseudoElement:0}),bS=yn(CS),NS=$t({},yo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),AS=yn(NS),LS=$t({},yo,{data:0}),Pg=yn(LS),FS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},PS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function RS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=OS[e])?!!t[e]:!1}function tp(){return RS}var MS=$t({},ic,{key:function(e){if(e.key){var t=FS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=_u(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?PS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tp,charCode:function(e){return e.type==="keypress"?_u(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?_u(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),IS=yn(MS),DS=$t({},Af,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Og=yn(DS),jS=$t({},ic,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tp}),BS=yn(jS),zS=$t({},yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),US=yn(zS),HS=$t({},Af,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),VS=yn(HS),$S=[9,13,27,32],rp=Ua&&"CompositionEvent"in window,dl=null;Ua&&"documentMode"in document&&(dl=document.documentMode);var WS=Ua&&"TextEvent"in window&&!dl,i_=Ua&&(!rp||dl&&8<dl&&11>=dl),Rg=" ",Mg=!1;function s_(e,t){switch(e){case"keyup":return $S.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function o_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var zs=!1;function ZS(e,t){switch(e){case"compositionend":return o_(t);case"keypress":return t.which!==32?null:(Mg=!0,Rg);case"textInput":return e=t.data,e===Rg&&Mg?null:e;default:return null}}function GS(e,t){if(zs)return e==="compositionend"||!rp&&s_(e,t)?(e=a_(),vu=Qh=ui=null,zs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return i_&&t.locale!=="ko"?null:t.data;default:return null}}var XS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ig(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!XS[e.type]:t==="textarea"}function l_(e,t,r,n){Bv(n),t=zu(t,"onChange"),0<t.length&&(r=new ep("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var hl=null,Il=null;function qS(e){__(e,0)}function Lf(e){var t=Vs(e);if(Pv(t))return e}function KS(e,t){if(e==="change")return t}var c_=!1;if(Ua){var D0;if(Ua){var j0="oninput"in document;if(!j0){var Dg=document.createElement("div");Dg.setAttribute("oninput","return;"),j0=typeof Dg.oninput=="function"}D0=j0}else D0=!1;c_=D0&&(!document.documentMode||9<document.documentMode)}function jg(){hl&&(hl.detachEvent("onpropertychange",u_),Il=hl=null)}function u_(e){if(e.propertyName==="value"&&Lf(Il)){var t=[];l_(t,Il,e,Xh(e)),Vv(qS,t)}}function YS(e,t,r){e==="focusin"?(jg(),hl=t,Il=r,hl.attachEvent("onpropertychange",u_)):e==="focusout"&&jg()}function JS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Lf(Il)}function QS(e,t){if(e==="click")return Lf(t)}function eT(e,t){if(e==="input"||e==="change")return Lf(t)}function tT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ea=typeof Object.is=="function"?Object.is:tT;function Dl(e,t){if(ea(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!wd.call(t,a)||!ea(e[a],t[a]))return!1}return!0}function Bg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zg(e,t){var r=Bg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Bg(r)}}function f_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?f_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function d_(){for(var e=window,t=Ou();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ou(e.document)}return t}function np(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function rT(e){var t=d_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&f_(r.ownerDocument.documentElement,r)){if(n!==null&&np(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=zg(r,i);var o=zg(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nT=Ua&&"documentMode"in document&&11>=document.documentMode,Us=null,zd=null,pl=null,Ud=!1;function Ug(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ud||Us==null||Us!==Ou(n)||(n=Us,"selectionStart"in n&&np(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pl&&Dl(pl,n)||(pl=n,n=zu(zd,"onSelect"),0<n.length&&(t=new ep("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Us)))}function Gc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Hs={animationend:Gc("Animation","AnimationEnd"),animationiteration:Gc("Animation","AnimationIteration"),animationstart:Gc("Animation","AnimationStart"),transitionend:Gc("Transition","TransitionEnd")},B0={},h_={};Ua&&(h_=document.createElement("div").style,"AnimationEvent"in window||(delete Hs.animationend.animation,delete Hs.animationiteration.animation,delete Hs.animationstart.animation),"TransitionEvent"in window||delete Hs.transitionend.transition);function Ff(e){if(B0[e])return B0[e];if(!Hs[e])return e;var t=Hs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in h_)return B0[e]=t[r];return e}var p_=Ff("animationend"),m_=Ff("animationiteration"),g_=Ff("animationstart"),x_=Ff("transitionend"),v_=new Map,Hg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fi(e,t){v_.set(e,t),ps(t,[e])}for(var z0=0;z0<Hg.length;z0++){var U0=Hg[z0],aT=U0.toLowerCase(),iT=U0[0].toUpperCase()+U0.slice(1);Fi(aT,"on"+iT)}Fi(p_,"onAnimationEnd");Fi(m_,"onAnimationIteration");Fi(g_,"onAnimationStart");Fi("dblclick","onDoubleClick");Fi("focusin","onFocus");Fi("focusout","onBlur");Fi(x_,"onTransitionEnd");co("onMouseEnter",["mouseout","mouseover"]);co("onMouseLeave",["mouseout","mouseover"]);co("onPointerEnter",["pointerout","pointerover"]);co("onPointerLeave",["pointerout","pointerover"]);ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sT=new Set("cancel close invalid load scroll toggle".split(" ").concat(nl));function Vg(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,aS(n,t,void 0,e),e.currentTarget=null}function __(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,f=l.currentTarget;if(l=l.listener,u!==i&&a.isPropagationStopped())break e;Vg(a,l,f),i=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,f=l.currentTarget,l=l.listener,u!==i&&a.isPropagationStopped())break e;Vg(a,l,f),i=u}}}if(Mu)throw e=Id,Mu=!1,Id=null,e}function Mt(e,t){var r=t[Zd];r===void 0&&(r=t[Zd]=new Set);var n=e+"__bubble";r.has(n)||(y_(t,e,2,!1),r.add(n))}function H0(e,t,r){var n=0;t&&(n|=4),y_(r,e,n,t)}var Xc="_reactListening"+Math.random().toString(36).slice(2);function jl(e){if(!e[Xc]){e[Xc]=!0,bv.forEach(function(r){r!=="selectionchange"&&(sT.has(r)||H0(r,!1,e),H0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Xc]||(t[Xc]=!0,H0("selectionchange",!1,t))}}function y_(e,t,r,n){switch(n_(t)){case 1:var a=yS;break;case 4:a=wS;break;default:a=Jh}r=a.bind(null,t,r,e),a=void 0,!Md||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function V0(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Gi(l),o===null)return;if(u=o.tag,u===5||u===6){n=i=o;continue e}l=l.parentNode}}n=n.return}Vv(function(){var f=i,h=Xh(r),m=[];e:{var g=v_.get(e);if(g!==void 0){var x=ep,_=e;switch(e){case"keypress":if(_u(r)===0)break e;case"keydown":case"keyup":x=IS;break;case"focusin":_="focus",x=I0;break;case"focusout":_="blur",x=I0;break;case"beforeblur":case"afterblur":x=I0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=SS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=BS;break;case p_:case m_:case g_:x=bS;break;case x_:x=US;break;case"scroll":x=kS;break;case"wheel":x=VS;break;case"copy":case"cut":case"paste":x=AS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Og}var y=(t&4)!==0,S=!y&&e==="scroll",k=y?g!==null?g+"Capture":null:g;y=[];for(var E=f,w;E!==null;){w=E;var F=w.stateNode;if(w.tag===5&&F!==null&&(w=F,k!==null&&(F=Pl(E,k),F!=null&&y.push(Bl(E,F,w)))),S)break;E=E.return}0<y.length&&(g=new x(g,_,null,r,h),m.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",g&&r!==Od&&(_=r.relatedTarget||r.fromElement)&&(Gi(_)||_[Ha]))break e;if((x||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,x?(_=r.relatedTarget||r.toElement,x=f,_=_?Gi(_):null,_!==null&&(S=ms(_),_!==S||_.tag!==5&&_.tag!==6)&&(_=null)):(x=null,_=f),x!==_)){if(y=Fg,F="onMouseLeave",k="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(y=Og,F="onPointerLeave",k="onPointerEnter",E="pointer"),S=x==null?g:Vs(x),w=_==null?g:Vs(_),g=new y(F,E+"leave",x,r,h),g.target=S,g.relatedTarget=w,F=null,Gi(h)===f&&(y=new y(k,E+"enter",_,r,h),y.target=w,y.relatedTarget=S,F=y),S=F,x&&_)t:{for(y=x,k=_,E=0,w=y;w;w=Ps(w))E++;for(w=0,F=k;F;F=Ps(F))w++;for(;0<E-w;)y=Ps(y),E--;for(;0<w-E;)k=Ps(k),w--;for(;E--;){if(y===k||k!==null&&y===k.alternate)break t;y=Ps(y),k=Ps(k)}y=null}else y=null;x!==null&&$g(m,g,x,y,!1),_!==null&&S!==null&&$g(m,S,_,y,!0)}}e:{if(g=f?Vs(f):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var j=KS;else if(Ig(g))if(c_)j=eT;else{j=JS;var D=YS}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(j=QS);if(j&&(j=j(e,f))){l_(m,j,r,h);break e}D&&D(e,g,f),e==="focusout"&&(D=g._wrapperState)&&D.controlled&&g.type==="number"&&Nd(g,"number",g.value)}switch(D=f?Vs(f):window,e){case"focusin":(Ig(D)||D.contentEditable==="true")&&(Us=D,zd=f,pl=null);break;case"focusout":pl=zd=Us=null;break;case"mousedown":Ud=!0;break;case"contextmenu":case"mouseup":case"dragend":Ud=!1,Ug(m,r,h);break;case"selectionchange":if(nT)break;case"keydown":case"keyup":Ug(m,r,h)}var A;if(rp)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else zs?s_(e,r)&&(M="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(i_&&r.locale!=="ko"&&(zs||M!=="onCompositionStart"?M==="onCompositionEnd"&&zs&&(A=a_()):(ui=h,Qh="value"in ui?ui.value:ui.textContent,zs=!0)),D=zu(f,M),0<D.length&&(M=new Pg(M,e,null,r,h),m.push({event:M,listeners:D}),A?M.data=A:(A=o_(r),A!==null&&(M.data=A)))),(A=WS?ZS(e,r):GS(e,r))&&(f=zu(f,"onBeforeInput"),0<f.length&&(h=new Pg("onBeforeInput","beforeinput",null,r,h),m.push({event:h,listeners:f}),h.data=A))}__(m,t)})}function Bl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function zu(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Pl(e,r),i!=null&&n.unshift(Bl(e,i,a)),i=Pl(e,t),i!=null&&n.push(Bl(e,i,a))),e=e.return}return n}function Ps(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $g(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,f=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&f!==null&&(l=f,a?(u=Pl(r,i),u!=null&&o.unshift(Bl(r,u,l))):a||(u=Pl(r,i),u!=null&&o.push(Bl(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var oT=/\r\n?/g,lT=/\u0000|\uFFFD/g;function Wg(e){return(typeof e=="string"?e:""+e).replace(oT,`
`).replace(lT,"")}function qc(e,t,r){if(t=Wg(t),Wg(e)!==t&&r)throw Error(Te(425))}function Uu(){}var Hd=null,Vd=null;function $d(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wd=typeof setTimeout=="function"?setTimeout:void 0,cT=typeof clearTimeout=="function"?clearTimeout:void 0,Zg=typeof Promise=="function"?Promise:void 0,uT=typeof queueMicrotask=="function"?queueMicrotask:typeof Zg<"u"?function(e){return Zg.resolve(null).then(e).catch(fT)}:Wd;function fT(e){setTimeout(function(){throw e})}function $0(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Ml(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Ml(t)}function vi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Gg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var wo=Math.random().toString(36).slice(2),ma="__reactFiber$"+wo,zl="__reactProps$"+wo,Ha="__reactContainer$"+wo,Zd="__reactEvents$"+wo,dT="__reactListeners$"+wo,hT="__reactHandles$"+wo;function Gi(e){var t=e[ma];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ha]||r[ma]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Gg(e);e!==null;){if(r=e[ma])return r;e=Gg(e)}return t}e=r,r=e.parentNode}return null}function sc(e){return e=e[ma]||e[Ha],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Te(33))}function Pf(e){return e[zl]||null}var Gd=[],$s=-1;function Pi(e){return{current:e}}function It(e){0>$s||(e.current=Gd[$s],Gd[$s]=null,$s--)}function Ft(e,t){$s++,Gd[$s]=e.current,e.current=t}var bi={},Dr=Pi(bi),nn=Pi(!1),as=bi;function uo(e,t){var r=e.type.contextTypes;if(!r)return bi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function an(e){return e=e.childContextTypes,e!=null}function Hu(){It(nn),It(Dr)}function Xg(e,t,r){if(Dr.current!==bi)throw Error(Te(168));Ft(Dr,t),Ft(nn,r)}function w_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Te(108,YE(e)||"Unknown",a));return $t({},r,n)}function Vu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bi,as=Dr.current,Ft(Dr,e),Ft(nn,nn.current),!0}function qg(e,t,r){var n=e.stateNode;if(!n)throw Error(Te(169));r?(e=w_(e,t,as),n.__reactInternalMemoizedMergedChildContext=e,It(nn),It(Dr),Ft(Dr,e)):It(nn),Ft(nn,r)}var Pa=null,Of=!1,W0=!1;function k_(e){Pa===null?Pa=[e]:Pa.push(e)}function pT(e){Of=!0,k_(e)}function Oi(){if(!W0&&Pa!==null){W0=!0;var e=0,t=At;try{var r=Pa;for(At=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Pa=null,Of=!1}catch(a){throw Pa!==null&&(Pa=Pa.slice(e+1)),Gv(qh,Oi),a}finally{At=t,W0=!1}}return null}var Ws=[],Zs=0,$u=null,Wu=0,bn=[],Nn=0,is=null,Ra=1,Ma="";function Ui(e,t){Ws[Zs++]=Wu,Ws[Zs++]=$u,$u=e,Wu=t}function E_(e,t,r){bn[Nn++]=Ra,bn[Nn++]=Ma,bn[Nn++]=is,is=e;var n=Ra;e=Ma;var a=32-Yn(n)-1;n&=~(1<<a),r+=1;var i=32-Yn(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Ra=1<<32-Yn(t)+a|r<<a|n,Ma=i+e}else Ra=1<<i|r<<a|n,Ma=e}function ap(e){e.return!==null&&(Ui(e,1),E_(e,1,0))}function ip(e){for(;e===$u;)$u=Ws[--Zs],Ws[Zs]=null,Wu=Ws[--Zs],Ws[Zs]=null;for(;e===is;)is=bn[--Nn],bn[Nn]=null,Ma=bn[--Nn],bn[Nn]=null,Ra=bn[--Nn],bn[Nn]=null}var mn=null,pn=null,jt=!1,Gn=null;function S_(e,t){var r=Ln(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Kg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,mn=e,pn=vi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,mn=e,pn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=is!==null?{id:Ra,overflow:Ma}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ln(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,mn=e,pn=null,!0):!1;default:return!1}}function Xd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function qd(e){if(jt){var t=pn;if(t){var r=t;if(!Kg(e,t)){if(Xd(e))throw Error(Te(418));t=vi(r.nextSibling);var n=mn;t&&Kg(e,t)?S_(n,r):(e.flags=e.flags&-4097|2,jt=!1,mn=e)}}else{if(Xd(e))throw Error(Te(418));e.flags=e.flags&-4097|2,jt=!1,mn=e}}}function Yg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;mn=e}function Kc(e){if(e!==mn)return!1;if(!jt)return Yg(e),jt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!$d(e.type,e.memoizedProps)),t&&(t=pn)){if(Xd(e))throw T_(),Error(Te(418));for(;t;)S_(e,t),t=vi(t.nextSibling)}if(Yg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){pn=vi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}pn=null}}else pn=mn?vi(e.stateNode.nextSibling):null;return!0}function T_(){for(var e=pn;e;)e=vi(e.nextSibling)}function fo(){pn=mn=null,jt=!1}function sp(e){Gn===null?Gn=[e]:Gn.push(e)}var mT=Xa.ReactCurrentBatchConfig;function qo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var n=r.stateNode}if(!n)throw Error(Te(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,e))}return e}function Yc(e,t){throw e=Object.prototype.toString.call(t),Error(Te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Jg(e){var t=e._init;return t(e._payload)}function C_(e){function t(k,E){if(e){var w=k.deletions;w===null?(k.deletions=[E],k.flags|=16):w.push(E)}}function r(k,E){if(!e)return null;for(;E!==null;)t(k,E),E=E.sibling;return null}function n(k,E){for(k=new Map;E!==null;)E.key!==null?k.set(E.key,E):k.set(E.index,E),E=E.sibling;return k}function a(k,E){return k=ki(k,E),k.index=0,k.sibling=null,k}function i(k,E,w){return k.index=w,e?(w=k.alternate,w!==null?(w=w.index,w<E?(k.flags|=2,E):w):(k.flags|=2,E)):(k.flags|=1048576,E)}function o(k){return e&&k.alternate===null&&(k.flags|=2),k}function l(k,E,w,F){return E===null||E.tag!==6?(E=J0(w,k.mode,F),E.return=k,E):(E=a(E,w),E.return=k,E)}function u(k,E,w,F){var j=w.type;return j===Bs?h(k,E,w.props.children,F,w.key):E!==null&&(E.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ri&&Jg(j)===E.type)?(F=a(E,w.props),F.ref=qo(k,E,w),F.return=k,F):(F=Cu(w.type,w.key,w.props,null,k.mode,F),F.ref=qo(k,E,w),F.return=k,F)}function f(k,E,w,F){return E===null||E.tag!==4||E.stateNode.containerInfo!==w.containerInfo||E.stateNode.implementation!==w.implementation?(E=Q0(w,k.mode,F),E.return=k,E):(E=a(E,w.children||[]),E.return=k,E)}function h(k,E,w,F,j){return E===null||E.tag!==7?(E=es(w,k.mode,F,j),E.return=k,E):(E=a(E,w),E.return=k,E)}function m(k,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return E=J0(""+E,k.mode,w),E.return=k,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case zc:return w=Cu(E.type,E.key,E.props,null,k.mode,w),w.ref=qo(k,null,E),w.return=k,w;case js:return E=Q0(E,k.mode,w),E.return=k,E;case ri:var F=E._init;return m(k,F(E._payload),w)}if(tl(E)||$o(E))return E=es(E,k.mode,w,null),E.return=k,E;Yc(k,E)}return null}function g(k,E,w,F){var j=E!==null?E.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:l(k,E,""+w,F);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case zc:return w.key===j?u(k,E,w,F):null;case js:return w.key===j?f(k,E,w,F):null;case ri:return j=w._init,g(k,E,j(w._payload),F)}if(tl(w)||$o(w))return j!==null?null:h(k,E,w,F,null);Yc(k,w)}return null}function x(k,E,w,F,j){if(typeof F=="string"&&F!==""||typeof F=="number")return k=k.get(w)||null,l(E,k,""+F,j);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case zc:return k=k.get(F.key===null?w:F.key)||null,u(E,k,F,j);case js:return k=k.get(F.key===null?w:F.key)||null,f(E,k,F,j);case ri:var D=F._init;return x(k,E,w,D(F._payload),j)}if(tl(F)||$o(F))return k=k.get(w)||null,h(E,k,F,j,null);Yc(E,F)}return null}function _(k,E,w,F){for(var j=null,D=null,A=E,M=E=0,O=null;A!==null&&M<w.length;M++){A.index>M?(O=A,A=null):O=A.sibling;var G=g(k,A,w[M],F);if(G===null){A===null&&(A=O);break}e&&A&&G.alternate===null&&t(k,A),E=i(G,E,M),D===null?j=G:D.sibling=G,D=G,A=O}if(M===w.length)return r(k,A),jt&&Ui(k,M),j;if(A===null){for(;M<w.length;M++)A=m(k,w[M],F),A!==null&&(E=i(A,E,M),D===null?j=A:D.sibling=A,D=A);return jt&&Ui(k,M),j}for(A=n(k,A);M<w.length;M++)O=x(A,k,M,w[M],F),O!==null&&(e&&O.alternate!==null&&A.delete(O.key===null?M:O.key),E=i(O,E,M),D===null?j=O:D.sibling=O,D=O);return e&&A.forEach(function(H){return t(k,H)}),jt&&Ui(k,M),j}function y(k,E,w,F){var j=$o(w);if(typeof j!="function")throw Error(Te(150));if(w=j.call(w),w==null)throw Error(Te(151));for(var D=j=null,A=E,M=E=0,O=null,G=w.next();A!==null&&!G.done;M++,G=w.next()){A.index>M?(O=A,A=null):O=A.sibling;var H=g(k,A,G.value,F);if(H===null){A===null&&(A=O);break}e&&A&&H.alternate===null&&t(k,A),E=i(H,E,M),D===null?j=H:D.sibling=H,D=H,A=O}if(G.done)return r(k,A),jt&&Ui(k,M),j;if(A===null){for(;!G.done;M++,G=w.next())G=m(k,G.value,F),G!==null&&(E=i(G,E,M),D===null?j=G:D.sibling=G,D=G);return jt&&Ui(k,M),j}for(A=n(k,A);!G.done;M++,G=w.next())G=x(A,k,M,G.value,F),G!==null&&(e&&G.alternate!==null&&A.delete(G.key===null?M:G.key),E=i(G,E,M),D===null?j=G:D.sibling=G,D=G);return e&&A.forEach(function(W){return t(k,W)}),jt&&Ui(k,M),j}function S(k,E,w,F){if(typeof w=="object"&&w!==null&&w.type===Bs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case zc:e:{for(var j=w.key,D=E;D!==null;){if(D.key===j){if(j=w.type,j===Bs){if(D.tag===7){r(k,D.sibling),E=a(D,w.props.children),E.return=k,k=E;break e}}else if(D.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===ri&&Jg(j)===D.type){r(k,D.sibling),E=a(D,w.props),E.ref=qo(k,D,w),E.return=k,k=E;break e}r(k,D);break}else t(k,D);D=D.sibling}w.type===Bs?(E=es(w.props.children,k.mode,F,w.key),E.return=k,k=E):(F=Cu(w.type,w.key,w.props,null,k.mode,F),F.ref=qo(k,E,w),F.return=k,k=F)}return o(k);case js:e:{for(D=w.key;E!==null;){if(E.key===D)if(E.tag===4&&E.stateNode.containerInfo===w.containerInfo&&E.stateNode.implementation===w.implementation){r(k,E.sibling),E=a(E,w.children||[]),E.return=k,k=E;break e}else{r(k,E);break}else t(k,E);E=E.sibling}E=Q0(w,k.mode,F),E.return=k,k=E}return o(k);case ri:return D=w._init,S(k,E,D(w._payload),F)}if(tl(w))return _(k,E,w,F);if($o(w))return y(k,E,w,F);Yc(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,E!==null&&E.tag===6?(r(k,E.sibling),E=a(E,w),E.return=k,k=E):(r(k,E),E=J0(w,k.mode,F),E.return=k,k=E),o(k)):r(k,E)}return S}var ho=C_(!0),b_=C_(!1),Zu=Pi(null),Gu=null,Gs=null,op=null;function lp(){op=Gs=Gu=null}function cp(e){var t=Zu.current;It(Zu),e._currentValue=t}function Kd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ao(e,t){Gu=e,op=Gs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(tn=!0),e.firstContext=null)}function Rn(e){var t=e._currentValue;if(op!==e)if(e={context:e,memoizedValue:t,next:null},Gs===null){if(Gu===null)throw Error(Te(308));Gs=e,Gu.dependencies={lanes:0,firstContext:e}}else Gs=Gs.next=e;return t}var Xi=null;function up(e){Xi===null?Xi=[e]:Xi.push(e)}function N_(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,up(t)):(r.next=a.next,a.next=r),t.interleaved=r,Va(e,n)}function Va(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ni=!1;function fp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function A_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Da(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _i(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,kt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Va(e,r)}return a=n.interleaved,a===null?(t.next=t,up(n)):(t.next=a.next,a.next=t),n.interleaved=t,Va(e,r)}function yu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Kh(e,r)}}function Qg(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Xu(e,t,r,n){var a=e.updateQueue;ni=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var u=l,f=u.next;u.next=null,o===null?i=f:o.next=f,o=u;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=f:l.next=f,h.lastBaseUpdate=u))}if(i!==null){var m=a.baseState;o=0,h=f=u=null,l=i;do{var g=l.lane,x=l.eventTime;if((n&g)===g){h!==null&&(h=h.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=e,y=l;switch(g=t,x=r,y.tag){case 1:if(_=y.payload,typeof _=="function"){m=_.call(x,m,g);break e}m=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=y.payload,g=typeof _=="function"?_.call(x,m,g):_,g==null)break e;m=$t({},m,g);break e;case 2:ni=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=a.effects,g===null?a.effects=[l]:g.push(l))}else x={eventTime:x,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(f=h=x,u=m):h=h.next=x,o|=g;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;g=l,l=g.next,g.next=null,a.lastBaseUpdate=g,a.shared.pending=null}}while(!0);if(h===null&&(u=m),a.baseState=u,a.firstBaseUpdate=f,a.lastBaseUpdate=h,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);os|=o,e.lanes=o,e.memoizedState=m}}function ex(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Te(191,a));a.call(n)}}}var oc={},xa=Pi(oc),Ul=Pi(oc),Hl=Pi(oc);function qi(e){if(e===oc)throw Error(Te(174));return e}function dp(e,t){switch(Ft(Hl,t),Ft(Ul,e),Ft(xa,oc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ld(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ld(t,e)}It(xa),Ft(xa,t)}function po(){It(xa),It(Ul),It(Hl)}function L_(e){qi(Hl.current);var t=qi(xa.current),r=Ld(t,e.type);t!==r&&(Ft(Ul,e),Ft(xa,r))}function hp(e){Ul.current===e&&(It(xa),It(Ul))}var Ut=Pi(0);function qu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Z0=[];function pp(){for(var e=0;e<Z0.length;e++)Z0[e]._workInProgressVersionPrimary=null;Z0.length=0}var wu=Xa.ReactCurrentDispatcher,G0=Xa.ReactCurrentBatchConfig,ss=0,Ht=null,cr=null,gr=null,Ku=!1,ml=!1,Vl=0,gT=0;function br(){throw Error(Te(321))}function mp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ea(e[r],t[r]))return!1;return!0}function gp(e,t,r,n,a,i){if(ss=i,Ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wu.current=e===null||e.memoizedState===null?yT:wT,e=r(n,a),ml){i=0;do{if(ml=!1,Vl=0,25<=i)throw Error(Te(301));i+=1,gr=cr=null,t.updateQueue=null,wu.current=kT,e=r(n,a)}while(ml)}if(wu.current=Yu,t=cr!==null&&cr.next!==null,ss=0,gr=cr=Ht=null,Ku=!1,t)throw Error(Te(300));return e}function xp(){var e=Vl!==0;return Vl=0,e}function pa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?Ht.memoizedState=gr=e:gr=gr.next=e,gr}function Mn(){if(cr===null){var e=Ht.alternate;e=e!==null?e.memoizedState:null}else e=cr.next;var t=gr===null?Ht.memoizedState:gr.next;if(t!==null)gr=t,cr=e;else{if(e===null)throw Error(Te(310));cr=e,e={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},gr===null?Ht.memoizedState=gr=e:gr=gr.next=e}return gr}function $l(e,t){return typeof t=="function"?t(e):t}function X0(e){var t=Mn(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=cr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,u=null,f=i;do{var h=f.lane;if((ss&h)===h)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var m={lane:h,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,Ht.lanes|=h,os|=h}f=f.next}while(f!==null&&f!==i);u===null?o=n:u.next=l,ea(n,t.memoizedState)||(tn=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Ht.lanes|=i,os|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function q0(e){var t=Mn(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);ea(i,t.memoizedState)||(tn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function F_(){}function P_(e,t){var r=Ht,n=Mn(),a=t(),i=!ea(n.memoizedState,a);if(i&&(n.memoizedState=a,tn=!0),n=n.queue,vp(M_.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||gr!==null&&gr.memoizedState.tag&1){if(r.flags|=2048,Wl(9,R_.bind(null,r,n,a,t),void 0,null),xr===null)throw Error(Te(349));ss&30||O_(r,t,a)}return a}function O_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ht.updateQueue,t===null?(t={lastEffect:null,stores:null},Ht.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function R_(e,t,r,n){t.value=r,t.getSnapshot=n,I_(t)&&D_(e)}function M_(e,t,r){return r(function(){I_(t)&&D_(e)})}function I_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ea(e,r)}catch{return!0}}function D_(e){var t=Va(e,1);t!==null&&Jn(t,e,1,-1)}function tx(e){var t=pa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$l,lastRenderedState:e},t.queue=e,e=e.dispatch=_T.bind(null,Ht,e),[t.memoizedState,e]}function Wl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ht.updateQueue,t===null?(t={lastEffect:null,stores:null},Ht.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function j_(){return Mn().memoizedState}function ku(e,t,r,n){var a=pa();Ht.flags|=e,a.memoizedState=Wl(1|t,r,void 0,n===void 0?null:n)}function Rf(e,t,r,n){var a=Mn();n=n===void 0?null:n;var i=void 0;if(cr!==null){var o=cr.memoizedState;if(i=o.destroy,n!==null&&mp(n,o.deps)){a.memoizedState=Wl(t,r,i,n);return}}Ht.flags|=e,a.memoizedState=Wl(1|t,r,i,n)}function rx(e,t){return ku(8390656,8,e,t)}function vp(e,t){return Rf(2048,8,e,t)}function B_(e,t){return Rf(4,2,e,t)}function z_(e,t){return Rf(4,4,e,t)}function U_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function H_(e,t,r){return r=r!=null?r.concat([e]):null,Rf(4,4,U_.bind(null,t,e),r)}function _p(){}function V_(e,t){var r=Mn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&mp(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function $_(e,t){var r=Mn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&mp(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function W_(e,t,r){return ss&21?(ea(r,t)||(r=Kv(),Ht.lanes|=r,os|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,tn=!0),e.memoizedState=r)}function xT(e,t){var r=At;At=r!==0&&4>r?r:4,e(!0);var n=G0.transition;G0.transition={};try{e(!1),t()}finally{At=r,G0.transition=n}}function Z_(){return Mn().memoizedState}function vT(e,t,r){var n=wi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},G_(e))X_(t,r);else if(r=N_(e,t,r,n),r!==null){var a=Zr();Jn(r,e,n,a),q_(r,t,n)}}function _T(e,t,r){var n=wi(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(G_(e))X_(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,ea(l,o)){var u=t.interleaved;u===null?(a.next=a,up(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}r=N_(e,t,a,n),r!==null&&(a=Zr(),Jn(r,e,n,a),q_(r,t,n))}}function G_(e){var t=e.alternate;return e===Ht||t!==null&&t===Ht}function X_(e,t){ml=Ku=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function q_(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Kh(e,r)}}var Yu={readContext:Rn,useCallback:br,useContext:br,useEffect:br,useImperativeHandle:br,useInsertionEffect:br,useLayoutEffect:br,useMemo:br,useReducer:br,useRef:br,useState:br,useDebugValue:br,useDeferredValue:br,useTransition:br,useMutableSource:br,useSyncExternalStore:br,useId:br,unstable_isNewReconciler:!1},yT={readContext:Rn,useCallback:function(e,t){return pa().memoizedState=[e,t===void 0?null:t],e},useContext:Rn,useEffect:rx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ku(4194308,4,U_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ku(4194308,4,e,t)},useInsertionEffect:function(e,t){return ku(4,2,e,t)},useMemo:function(e,t){var r=pa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=pa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=vT.bind(null,Ht,e),[n.memoizedState,e]},useRef:function(e){var t=pa();return e={current:e},t.memoizedState=e},useState:tx,useDebugValue:_p,useDeferredValue:function(e){return pa().memoizedState=e},useTransition:function(){var e=tx(!1),t=e[0];return e=xT.bind(null,e[1]),pa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ht,a=pa();if(jt){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=t(),xr===null)throw Error(Te(349));ss&30||O_(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,rx(M_.bind(null,n,i,e),[e]),n.flags|=2048,Wl(9,R_.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=pa(),t=xr.identifierPrefix;if(jt){var r=Ma,n=Ra;r=(n&~(1<<32-Yn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Vl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=gT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wT={readContext:Rn,useCallback:V_,useContext:Rn,useEffect:vp,useImperativeHandle:H_,useInsertionEffect:B_,useLayoutEffect:z_,useMemo:$_,useReducer:X0,useRef:j_,useState:function(){return X0($l)},useDebugValue:_p,useDeferredValue:function(e){var t=Mn();return W_(t,cr.memoizedState,e)},useTransition:function(){var e=X0($l)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:F_,useSyncExternalStore:P_,useId:Z_,unstable_isNewReconciler:!1},kT={readContext:Rn,useCallback:V_,useContext:Rn,useEffect:vp,useImperativeHandle:H_,useInsertionEffect:B_,useLayoutEffect:z_,useMemo:$_,useReducer:q0,useRef:j_,useState:function(){return q0($l)},useDebugValue:_p,useDeferredValue:function(e){var t=Mn();return cr===null?t.memoizedState=e:W_(t,cr.memoizedState,e)},useTransition:function(){var e=q0($l)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:F_,useSyncExternalStore:P_,useId:Z_,unstable_isNewReconciler:!1};function Wn(e,t){if(e&&e.defaultProps){t=$t({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Yd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:$t({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Mf={isMounted:function(e){return(e=e._reactInternals)?ms(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Zr(),a=wi(e),i=Da(n,a);i.payload=t,r!=null&&(i.callback=r),t=_i(e,i,a),t!==null&&(Jn(t,e,a,n),yu(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Zr(),a=wi(e),i=Da(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=_i(e,i,a),t!==null&&(Jn(t,e,a,n),yu(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Zr(),n=wi(e),a=Da(r,n);a.tag=2,t!=null&&(a.callback=t),t=_i(e,a,n),t!==null&&(Jn(t,e,n,r),yu(t,e,n))}};function nx(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Dl(r,n)||!Dl(a,i):!0}function K_(e,t,r){var n=!1,a=bi,i=t.contextType;return typeof i=="object"&&i!==null?i=Rn(i):(a=an(t)?as:Dr.current,n=t.contextTypes,i=(n=n!=null)?uo(e,a):bi),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Mf,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function ax(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Mf.enqueueReplaceState(t,t.state,null)}function Jd(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},fp(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Rn(i):(i=an(t)?as:Dr.current,a.context=uo(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Yd(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Mf.enqueueReplaceState(a,a.state,null),Xu(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function mo(e,t){try{var r="",n=t;do r+=KE(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function K0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Qd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ET=typeof WeakMap=="function"?WeakMap:Map;function Y_(e,t,r){r=Da(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Qu||(Qu=!0,ch=n),Qd(e,t)},r}function J_(e,t,r){r=Da(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Qd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Qd(e,t),typeof n!="function"&&(yi===null?yi=new Set([this]):yi.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function ix(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ET;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=DT.bind(null,e,t,r),t.then(e,e))}function sx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ox(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Da(-1,1),t.tag=2,_i(r,t,1))),r.lanes|=1),e)}var ST=Xa.ReactCurrentOwner,tn=!1;function Ur(e,t,r,n){t.child=e===null?b_(t,null,r,n):ho(t,e.child,r,n)}function lx(e,t,r,n,a){r=r.render;var i=t.ref;return ao(t,a),n=gp(e,t,r,n,i,a),r=xp(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,$a(e,t,a)):(jt&&r&&ap(t),t.flags|=1,Ur(e,t,n,a),t.child)}function cx(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!bp(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Q_(e,t,i,n,a)):(e=Cu(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Dl,r(o,n)&&e.ref===t.ref)return $a(e,t,a)}return t.flags|=1,e=ki(i,n),e.ref=t.ref,e.return=t,t.child=e}function Q_(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Dl(i,n)&&e.ref===t.ref)if(tn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(tn=!0);else return t.lanes=e.lanes,$a(e,t,a)}return eh(e,t,r,n,a)}function ey(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ft(qs,un),un|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ft(qs,un),un|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Ft(qs,un),un|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Ft(qs,un),un|=n;return Ur(e,t,a,r),t.child}function ty(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function eh(e,t,r,n,a){var i=an(r)?as:Dr.current;return i=uo(t,i),ao(t,a),r=gp(e,t,r,n,i,a),n=xp(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,$a(e,t,a)):(jt&&n&&ap(t),t.flags|=1,Ur(e,t,r,a),t.child)}function ux(e,t,r,n,a){if(an(r)){var i=!0;Vu(t)}else i=!1;if(ao(t,a),t.stateNode===null)Eu(e,t),K_(t,r,n),Jd(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,f=r.contextType;typeof f=="object"&&f!==null?f=Rn(f):(f=an(r)?as:Dr.current,f=uo(t,f));var h=r.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==f)&&ax(t,o,n,f),ni=!1;var g=t.memoizedState;o.state=g,Xu(t,n,o,a),u=t.memoizedState,l!==n||g!==u||nn.current||ni?(typeof h=="function"&&(Yd(t,r,h,n),u=t.memoizedState),(l=ni||nx(t,r,l,n,g,u,f))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=f,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,A_(e,t),l=t.memoizedProps,f=t.type===t.elementType?l:Wn(t.type,l),o.props=f,m=t.pendingProps,g=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=Rn(u):(u=an(r)?as:Dr.current,u=uo(t,u));var x=r.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==u)&&ax(t,o,n,u),ni=!1,g=t.memoizedState,o.state=g,Xu(t,n,o,a);var _=t.memoizedState;l!==m||g!==_||nn.current||ni?(typeof x=="function"&&(Yd(t,r,x,n),_=t.memoizedState),(f=ni||nx(t,r,f,n,g,_,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,_,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,_,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=_),o.props=n,o.state=_,o.context=u,n=f):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return th(e,t,r,n,i,a)}function th(e,t,r,n,a,i){ty(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&qg(t,r,!1),$a(e,t,i);n=t.stateNode,ST.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ho(t,e.child,null,i),t.child=ho(t,null,l,i)):Ur(e,t,l,i),t.memoizedState=n.state,a&&qg(t,r,!0),t.child}function ry(e){var t=e.stateNode;t.pendingContext?Xg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Xg(e,t.context,!1),dp(e,t.containerInfo)}function fx(e,t,r,n,a){return fo(),sp(a),t.flags|=256,Ur(e,t,r,n),t.child}var rh={dehydrated:null,treeContext:null,retryLane:0};function nh(e){return{baseLanes:e,cachePool:null,transitions:null}}function ny(e,t,r){var n=t.pendingProps,a=Ut.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ft(Ut,a&1),e===null)return qd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=jf(o,n,0,null),e=es(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=nh(r),t.memoizedState=rh,e):yp(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return TT(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=ki(a,u),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=ki(l,i):(i=es(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?nh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=rh,n}return i=e.child,e=i.sibling,n=ki(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function yp(e,t){return t=jf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Jc(e,t,r,n){return n!==null&&sp(n),ho(t,e.child,null,r),e=yp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function TT(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=K0(Error(Te(422))),Jc(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=jf({mode:"visible",children:n.children},a,0,null),i=es(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&ho(t,e.child,null,o),t.child.memoizedState=nh(o),t.memoizedState=rh,i);if(!(t.mode&1))return Jc(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Te(419)),n=K0(i,n,void 0),Jc(e,t,o,n)}if(l=(o&e.childLanes)!==0,tn||l){if(n=xr,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Va(e,a),Jn(n,e,a,-1))}return Cp(),n=K0(Error(Te(421))),Jc(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=jT.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,pn=vi(a.nextSibling),mn=t,jt=!0,Gn=null,e!==null&&(bn[Nn++]=Ra,bn[Nn++]=Ma,bn[Nn++]=is,Ra=e.id,Ma=e.overflow,is=t),t=yp(t,n.children),t.flags|=4096,t)}function dx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Kd(e.return,t,r)}function Y0(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function ay(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Ur(e,t,n.children,r),n=Ut.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&dx(e,r,t);else if(e.tag===19)dx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ft(Ut,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&qu(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Y0(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&qu(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Y0(t,!0,r,null,i);break;case"together":Y0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Eu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $a(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),os|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Te(153));if(t.child!==null){for(e=t.child,r=ki(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ki(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function CT(e,t,r){switch(t.tag){case 3:ry(t),fo();break;case 5:L_(t);break;case 1:an(t.type)&&Vu(t);break;case 4:dp(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Ft(Zu,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ft(Ut,Ut.current&1),t.flags|=128,null):r&t.child.childLanes?ny(e,t,r):(Ft(Ut,Ut.current&1),e=$a(e,t,r),e!==null?e.sibling:null);Ft(Ut,Ut.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return ay(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ft(Ut,Ut.current),n)break;return null;case 22:case 23:return t.lanes=0,ey(e,t,r)}return $a(e,t,r)}var iy,ah,sy,oy;iy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ah=function(){};sy=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,qi(xa.current);var i=null;switch(r){case"input":a=Cd(e,a),n=Cd(e,n),i=[];break;case"select":a=$t({},a,{value:void 0}),n=$t({},n,{value:void 0}),i=[];break;case"textarea":a=Ad(e,a),n=Ad(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Uu)}Fd(r,n);var o;r=null;for(f in a)if(!n.hasOwnProperty(f)&&a.hasOwnProperty(f)&&a[f]!=null)if(f==="style"){var l=a[f];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Ll.hasOwnProperty(f)?i||(i=[]):(i=i||[]).push(f,null));for(f in n){var u=n[f];if(l=a!=null?a[f]:void 0,n.hasOwnProperty(f)&&u!==l&&(u!=null||l!=null))if(f==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(i||(i=[]),i.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Ll.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Mt("scroll",e),i||l===u||(i=[])):(i=i||[]).push(f,u))}r&&(i=i||[]).push("style",r);var f=i;(t.updateQueue=f)&&(t.flags|=4)}};oy=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ko(e,t){if(!jt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function bT(e,t,r){var n=t.pendingProps;switch(ip(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(t),null;case 1:return an(t.type)&&Hu(),Nr(t),null;case 3:return n=t.stateNode,po(),It(nn),It(Dr),pp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Kc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gn!==null&&(dh(Gn),Gn=null))),ah(e,t),Nr(t),null;case 5:hp(t);var a=qi(Hl.current);if(r=t.type,e!==null&&t.stateNode!=null)sy(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Te(166));return Nr(t),null}if(e=qi(xa.current),Kc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ma]=t,n[zl]=i,e=(t.mode&1)!==0,r){case"dialog":Mt("cancel",n),Mt("close",n);break;case"iframe":case"object":case"embed":Mt("load",n);break;case"video":case"audio":for(a=0;a<nl.length;a++)Mt(nl[a],n);break;case"source":Mt("error",n);break;case"img":case"image":case"link":Mt("error",n),Mt("load",n);break;case"details":Mt("toggle",n);break;case"input":wg(n,i),Mt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Mt("invalid",n);break;case"textarea":Eg(n,i),Mt("invalid",n)}Fd(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&qc(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&qc(n.textContent,l,e),a=["children",""+l]):Ll.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Mt("scroll",n)}switch(r){case"input":Uc(n),kg(n,i,!0);break;case"textarea":Uc(n),Sg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Uu)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Mv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[ma]=t,e[zl]=n,iy(e,t,!1,!1),t.stateNode=e;e:{switch(o=Pd(r,n),r){case"dialog":Mt("cancel",e),Mt("close",e),a=n;break;case"iframe":case"object":case"embed":Mt("load",e),a=n;break;case"video":case"audio":for(a=0;a<nl.length;a++)Mt(nl[a],e);a=n;break;case"source":Mt("error",e),a=n;break;case"img":case"image":case"link":Mt("error",e),Mt("load",e),a=n;break;case"details":Mt("toggle",e),a=n;break;case"input":wg(e,n),a=Cd(e,n),Mt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=$t({},n,{value:void 0}),Mt("invalid",e);break;case"textarea":Eg(e,n),a=Ad(e,n),Mt("invalid",e);break;default:a=n}Fd(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?jv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Iv(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Fl(e,u):typeof u=="number"&&Fl(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ll.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Mt("scroll",e):u!=null&&$h(e,i,u,o))}switch(r){case"input":Uc(e),kg(e,n,!1);break;case"textarea":Uc(e),Sg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ci(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?eo(e,!!n.multiple,i,!1):n.defaultValue!=null&&eo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Uu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nr(t),null;case 6:if(e&&t.stateNode!=null)oy(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Te(166));if(r=qi(Hl.current),qi(xa.current),Kc(t)){if(n=t.stateNode,r=t.memoizedProps,n[ma]=t,(i=n.nodeValue!==r)&&(e=mn,e!==null))switch(e.tag){case 3:qc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ma]=t,t.stateNode=n}return Nr(t),null;case 13:if(It(Ut),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(jt&&pn!==null&&t.mode&1&&!(t.flags&128))T_(),fo(),t.flags|=98560,i=!1;else if(i=Kc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Te(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Te(317));i[ma]=t}else fo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nr(t),i=!1}else Gn!==null&&(dh(Gn),Gn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ut.current&1?ur===0&&(ur=3):Cp())),t.updateQueue!==null&&(t.flags|=4),Nr(t),null);case 4:return po(),ah(e,t),e===null&&jl(t.stateNode.containerInfo),Nr(t),null;case 10:return cp(t.type._context),Nr(t),null;case 17:return an(t.type)&&Hu(),Nr(t),null;case 19:if(It(Ut),i=t.memoizedState,i===null)return Nr(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Ko(i,!1);else{if(ur!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=qu(e),o!==null){for(t.flags|=128,Ko(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ft(Ut,Ut.current&1|2),t.child}e=e.sibling}i.tail!==null&&Jt()>go&&(t.flags|=128,n=!0,Ko(i,!1),t.lanes=4194304)}else{if(!n)if(e=qu(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ko(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!jt)return Nr(t),null}else 2*Jt()-i.renderingStartTime>go&&r!==1073741824&&(t.flags|=128,n=!0,Ko(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Jt(),t.sibling=null,r=Ut.current,Ft(Ut,n?r&1|2:r&1),t):(Nr(t),null);case 22:case 23:return Tp(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?un&1073741824&&(Nr(t),t.subtreeFlags&6&&(t.flags|=8192)):Nr(t),null;case 24:return null;case 25:return null}throw Error(Te(156,t.tag))}function NT(e,t){switch(ip(t),t.tag){case 1:return an(t.type)&&Hu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return po(),It(nn),It(Dr),pp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return hp(t),null;case 13:if(It(Ut),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Te(340));fo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return It(Ut),null;case 4:return po(),null;case 10:return cp(t.type._context),null;case 22:case 23:return Tp(),null;case 24:return null;default:return null}}var Qc=!1,Pr=!1,AT=typeof WeakSet=="function"?WeakSet:Set,je=null;function Xs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Gt(e,t,n)}else r.current=null}function ih(e,t,r){try{r()}catch(n){Gt(e,t,n)}}var hx=!1;function LT(e,t){if(Hd=ju,e=d_(),np(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,f=0,h=0,m=e,g=null;t:for(;;){for(var x;m!==r||a!==0&&m.nodeType!==3||(l=o+a),m!==i||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)g=m,m=x;for(;;){if(m===e)break t;if(g===r&&++f===a&&(l=o),g===i&&++h===n&&(u=o),(x=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=x}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Vd={focusedElem:e,selectionRange:r},ju=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var _=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var y=_.memoizedProps,S=_.memoizedState,k=t.stateNode,E=k.getSnapshotBeforeUpdate(t.elementType===t.type?y:Wn(t.type,y),S);k.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(F){Gt(t,t.return,F)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return _=hx,hx=!1,_}function gl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&ih(t,r,i)}a=a.next}while(a!==n)}}function If(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function sh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ly(e){var t=e.alternate;t!==null&&(e.alternate=null,ly(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ma],delete t[zl],delete t[Zd],delete t[dT],delete t[hT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function cy(e){return e.tag===5||e.tag===3||e.tag===4}function px(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function oh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Uu));else if(n!==4&&(e=e.child,e!==null))for(oh(e,t,r),e=e.sibling;e!==null;)oh(e,t,r),e=e.sibling}function lh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(lh(e,t,r),e=e.sibling;e!==null;)lh(e,t,r),e=e.sibling}var yr=null,Zn=!1;function ei(e,t,r){for(r=r.child;r!==null;)uy(e,t,r),r=r.sibling}function uy(e,t,r){if(ga&&typeof ga.onCommitFiberUnmount=="function")try{ga.onCommitFiberUnmount(Nf,r)}catch{}switch(r.tag){case 5:Pr||Xs(r,t);case 6:var n=yr,a=Zn;yr=null,ei(e,t,r),yr=n,Zn=a,yr!==null&&(Zn?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&(Zn?(e=yr,r=r.stateNode,e.nodeType===8?$0(e.parentNode,r):e.nodeType===1&&$0(e,r),Ml(e)):$0(yr,r.stateNode));break;case 4:n=yr,a=Zn,yr=r.stateNode.containerInfo,Zn=!0,ei(e,t,r),yr=n,Zn=a;break;case 0:case 11:case 14:case 15:if(!Pr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ih(r,t,o),a=a.next}while(a!==n)}ei(e,t,r);break;case 1:if(!Pr&&(Xs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Gt(r,t,l)}ei(e,t,r);break;case 21:ei(e,t,r);break;case 22:r.mode&1?(Pr=(n=Pr)||r.memoizedState!==null,ei(e,t,r),Pr=n):ei(e,t,r);break;default:ei(e,t,r)}}function mx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new AT),t.forEach(function(n){var a=BT.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Hn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:yr=l.stateNode,Zn=!1;break e;case 3:yr=l.stateNode.containerInfo,Zn=!0;break e;case 4:yr=l.stateNode.containerInfo,Zn=!0;break e}l=l.return}if(yr===null)throw Error(Te(160));uy(i,o,a),yr=null,Zn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(f){Gt(a,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)fy(t,e),t=t.sibling}function fy(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Hn(t,e),ua(e),n&4){try{gl(3,e,e.return),If(3,e)}catch(y){Gt(e,e.return,y)}try{gl(5,e,e.return)}catch(y){Gt(e,e.return,y)}}break;case 1:Hn(t,e),ua(e),n&512&&r!==null&&Xs(r,r.return);break;case 5:if(Hn(t,e),ua(e),n&512&&r!==null&&Xs(r,r.return),e.flags&32){var a=e.stateNode;try{Fl(a,"")}catch(y){Gt(e,e.return,y)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Ov(a,i),Pd(l,o);var f=Pd(l,i);for(o=0;o<u.length;o+=2){var h=u[o],m=u[o+1];h==="style"?jv(a,m):h==="dangerouslySetInnerHTML"?Iv(a,m):h==="children"?Fl(a,m):$h(a,h,m,f)}switch(l){case"input":bd(a,i);break;case"textarea":Rv(a,i);break;case"select":var g=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?eo(a,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?eo(a,!!i.multiple,i.defaultValue,!0):eo(a,!!i.multiple,i.multiple?[]:"",!1))}a[zl]=i}catch(y){Gt(e,e.return,y)}}break;case 6:if(Hn(t,e),ua(e),n&4){if(e.stateNode===null)throw Error(Te(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(y){Gt(e,e.return,y)}}break;case 3:if(Hn(t,e),ua(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ml(t.containerInfo)}catch(y){Gt(e,e.return,y)}break;case 4:Hn(t,e),ua(e);break;case 13:Hn(t,e),ua(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Ep=Jt())),n&4&&mx(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(Pr=(f=Pr)||h,Hn(t,e),Pr=f):Hn(t,e),ua(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!h&&e.mode&1)for(je=e,h=e.child;h!==null;){for(m=je=h;je!==null;){switch(g=je,x=g.child,g.tag){case 0:case 11:case 14:case 15:gl(4,g,g.return);break;case 1:Xs(g,g.return);var _=g.stateNode;if(typeof _.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(y){Gt(n,r,y)}}break;case 5:Xs(g,g.return);break;case 22:if(g.memoizedState!==null){xx(m);continue}}x!==null?(x.return=g,je=x):xx(m)}h=h.sibling}e:for(h=null,m=e;;){if(m.tag===5){if(h===null){h=m;try{a=m.stateNode,f?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Dv("display",o))}catch(y){Gt(e,e.return,y)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(y){Gt(e,e.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Hn(t,e),ua(e),n&4&&mx(e);break;case 21:break;default:Hn(t,e),ua(e)}}function ua(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(cy(r)){var n=r;break e}r=r.return}throw Error(Te(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Fl(a,""),n.flags&=-33);var i=px(e);lh(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=px(e);oh(e,l,o);break;default:throw Error(Te(161))}}catch(u){Gt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function FT(e,t,r){je=e,dy(e)}function dy(e,t,r){for(var n=(e.mode&1)!==0;je!==null;){var a=je,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||Qc;if(!o){var l=a.alternate,u=l!==null&&l.memoizedState!==null||Pr;l=Qc;var f=Pr;if(Qc=o,(Pr=u)&&!f)for(je=a;je!==null;)o=je,u=o.child,o.tag===22&&o.memoizedState!==null?vx(a):u!==null?(u.return=o,je=u):vx(a);for(;i!==null;)je=i,dy(i),i=i.sibling;je=a,Qc=l,Pr=f}gx(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,je=i):gx(e)}}function gx(e){for(;je!==null;){var t=je;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Pr||If(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Pr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Wn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&ex(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ex(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var h=f.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Ml(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}Pr||t.flags&512&&sh(t)}catch(g){Gt(t,t.return,g)}}if(t===e){je=null;break}if(r=t.sibling,r!==null){r.return=t.return,je=r;break}je=t.return}}function xx(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var r=t.sibling;if(r!==null){r.return=t.return,je=r;break}je=t.return}}function vx(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{If(4,t)}catch(u){Gt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(u){Gt(t,a,u)}}var i=t.return;try{sh(t)}catch(u){Gt(t,i,u)}break;case 5:var o=t.return;try{sh(t)}catch(u){Gt(t,o,u)}}}catch(u){Gt(t,t.return,u)}if(t===e){je=null;break}var l=t.sibling;if(l!==null){l.return=t.return,je=l;break}je=t.return}}var PT=Math.ceil,Ju=Xa.ReactCurrentDispatcher,wp=Xa.ReactCurrentOwner,On=Xa.ReactCurrentBatchConfig,kt=0,xr=null,sr=null,kr=0,un=0,qs=Pi(0),ur=0,Zl=null,os=0,Df=0,kp=0,xl=null,en=null,Ep=0,go=1/0,La=null,Qu=!1,ch=null,yi=null,eu=!1,fi=null,ef=0,vl=0,uh=null,Su=-1,Tu=0;function Zr(){return kt&6?Jt():Su!==-1?Su:Su=Jt()}function wi(e){return e.mode&1?kt&2&&kr!==0?kr&-kr:mT.transition!==null?(Tu===0&&(Tu=Kv()),Tu):(e=At,e!==0||(e=window.event,e=e===void 0?16:n_(e.type)),e):1}function Jn(e,t,r,n){if(50<vl)throw vl=0,uh=null,Error(Te(185));ac(e,r,n),(!(kt&2)||e!==xr)&&(e===xr&&(!(kt&2)&&(Df|=r),ur===4&&si(e,kr)),sn(e,n),r===1&&kt===0&&!(t.mode&1)&&(go=Jt()+500,Of&&Oi()))}function sn(e,t){var r=e.callbackNode;mS(e,t);var n=Du(e,e===xr?kr:0);if(n===0)r!==null&&bg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&bg(r),t===1)e.tag===0?pT(_x.bind(null,e)):k_(_x.bind(null,e)),uT(function(){!(kt&6)&&Oi()}),r=null;else{switch(Yv(n)){case 1:r=qh;break;case 4:r=Xv;break;case 16:r=Iu;break;case 536870912:r=qv;break;default:r=Iu}r=yy(r,hy.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function hy(e,t){if(Su=-1,Tu=0,kt&6)throw Error(Te(327));var r=e.callbackNode;if(io()&&e.callbackNode!==r)return null;var n=Du(e,e===xr?kr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=tf(e,n);else{t=n;var a=kt;kt|=2;var i=my();(xr!==e||kr!==t)&&(La=null,go=Jt()+500,Qi(e,t));do try{MT();break}catch(l){py(e,l)}while(!0);lp(),Ju.current=i,kt=a,sr!==null?t=0:(xr=null,kr=0,t=ur)}if(t!==0){if(t===2&&(a=Dd(e),a!==0&&(n=a,t=fh(e,a))),t===1)throw r=Zl,Qi(e,0),si(e,n),sn(e,Jt()),r;if(t===6)si(e,n);else{if(a=e.current.alternate,!(n&30)&&!OT(a)&&(t=tf(e,n),t===2&&(i=Dd(e),i!==0&&(n=i,t=fh(e,i))),t===1))throw r=Zl,Qi(e,0),si(e,n),sn(e,Jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Te(345));case 2:Hi(e,en,La);break;case 3:if(si(e,n),(n&130023424)===n&&(t=Ep+500-Jt(),10<t)){if(Du(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Zr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Wd(Hi.bind(null,e,en,La),t);break}Hi(e,en,La);break;case 4:if(si(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Yn(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*PT(n/1960))-n,10<n){e.timeoutHandle=Wd(Hi.bind(null,e,en,La),n);break}Hi(e,en,La);break;case 5:Hi(e,en,La);break;default:throw Error(Te(329))}}}return sn(e,Jt()),e.callbackNode===r?hy.bind(null,e):null}function fh(e,t){var r=xl;return e.current.memoizedState.isDehydrated&&(Qi(e,t).flags|=256),e=tf(e,t),e!==2&&(t=en,en=r,t!==null&&dh(t)),e}function dh(e){en===null?en=e:en.push.apply(en,e)}function OT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!ea(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function si(e,t){for(t&=~kp,t&=~Df,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Yn(t),n=1<<r;e[r]=-1,t&=~n}}function _x(e){if(kt&6)throw Error(Te(327));io();var t=Du(e,0);if(!(t&1))return sn(e,Jt()),null;var r=tf(e,t);if(e.tag!==0&&r===2){var n=Dd(e);n!==0&&(t=n,r=fh(e,n))}if(r===1)throw r=Zl,Qi(e,0),si(e,t),sn(e,Jt()),r;if(r===6)throw Error(Te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Hi(e,en,La),sn(e,Jt()),null}function Sp(e,t){var r=kt;kt|=1;try{return e(t)}finally{kt=r,kt===0&&(go=Jt()+500,Of&&Oi())}}function ls(e){fi!==null&&fi.tag===0&&!(kt&6)&&io();var t=kt;kt|=1;var r=On.transition,n=At;try{if(On.transition=null,At=1,e)return e()}finally{At=n,On.transition=r,kt=t,!(kt&6)&&Oi()}}function Tp(){un=qs.current,It(qs)}function Qi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,cT(r)),sr!==null)for(r=sr.return;r!==null;){var n=r;switch(ip(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hu();break;case 3:po(),It(nn),It(Dr),pp();break;case 5:hp(n);break;case 4:po();break;case 13:It(Ut);break;case 19:It(Ut);break;case 10:cp(n.type._context);break;case 22:case 23:Tp()}r=r.return}if(xr=e,sr=e=ki(e.current,null),kr=un=t,ur=0,Zl=null,kp=Df=os=0,en=xl=null,Xi!==null){for(t=0;t<Xi.length;t++)if(r=Xi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Xi=null}return e}function py(e,t){do{var r=sr;try{if(lp(),wu.current=Yu,Ku){for(var n=Ht.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Ku=!1}if(ss=0,gr=cr=Ht=null,ml=!1,Vl=0,wp.current=null,r===null||r.return===null){ur=1,Zl=t,sr=null;break}e:{var i=e,o=r.return,l=r,u=t;if(t=kr,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,h=l,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=sx(o);if(x!==null){x.flags&=-257,ox(x,o,l,i,t),x.mode&1&&ix(i,f,t),t=x,u=f;var _=t.updateQueue;if(_===null){var y=new Set;y.add(u),t.updateQueue=y}else _.add(u);break e}else{if(!(t&1)){ix(i,f,t),Cp();break e}u=Error(Te(426))}}else if(jt&&l.mode&1){var S=sx(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),ox(S,o,l,i,t),sp(mo(u,l));break e}}i=u=mo(u,l),ur!==4&&(ur=2),xl===null?xl=[i]:xl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var k=Y_(i,u,t);Qg(i,k);break e;case 1:l=u;var E=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(yi===null||!yi.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var F=J_(i,l,t);Qg(i,F);break e}}i=i.return}while(i!==null)}xy(r)}catch(j){t=j,sr===r&&r!==null&&(sr=r=r.return);continue}break}while(!0)}function my(){var e=Ju.current;return Ju.current=Yu,e===null?Yu:e}function Cp(){(ur===0||ur===3||ur===2)&&(ur=4),xr===null||!(os&268435455)&&!(Df&268435455)||si(xr,kr)}function tf(e,t){var r=kt;kt|=2;var n=my();(xr!==e||kr!==t)&&(La=null,Qi(e,t));do try{RT();break}catch(a){py(e,a)}while(!0);if(lp(),kt=r,Ju.current=n,sr!==null)throw Error(Te(261));return xr=null,kr=0,ur}function RT(){for(;sr!==null;)gy(sr)}function MT(){for(;sr!==null&&!sS();)gy(sr)}function gy(e){var t=_y(e.alternate,e,un);e.memoizedProps=e.pendingProps,t===null?xy(e):sr=t,wp.current=null}function xy(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=NT(r,t),r!==null){r.flags&=32767,sr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ur=6,sr=null;return}}else if(r=bT(r,t,un),r!==null){sr=r;return}if(t=t.sibling,t!==null){sr=t;return}sr=t=e}while(t!==null);ur===0&&(ur=5)}function Hi(e,t,r){var n=At,a=On.transition;try{On.transition=null,At=1,IT(e,t,r,n)}finally{On.transition=a,At=n}return null}function IT(e,t,r,n){do io();while(fi!==null);if(kt&6)throw Error(Te(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Te(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(gS(e,i),e===xr&&(sr=xr=null,kr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||eu||(eu=!0,yy(Iu,function(){return io(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=On.transition,On.transition=null;var o=At;At=1;var l=kt;kt|=4,wp.current=null,LT(e,r),fy(r,e),rT(Vd),ju=!!Hd,Vd=Hd=null,e.current=r,FT(r),oS(),kt=l,At=o,On.transition=i}else e.current=r;if(eu&&(eu=!1,fi=e,ef=a),i=e.pendingLanes,i===0&&(yi=null),uS(r.stateNode),sn(e,Jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Qu)throw Qu=!1,e=ch,ch=null,e;return ef&1&&e.tag!==0&&io(),i=e.pendingLanes,i&1?e===uh?vl++:(vl=0,uh=e):vl=0,Oi(),null}function io(){if(fi!==null){var e=Yv(ef),t=On.transition,r=At;try{if(On.transition=null,At=16>e?16:e,fi===null)var n=!1;else{if(e=fi,fi=null,ef=0,kt&6)throw Error(Te(331));var a=kt;for(kt|=4,je=e.current;je!==null;){var i=je,o=i.child;if(je.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var f=l[u];for(je=f;je!==null;){var h=je;switch(h.tag){case 0:case 11:case 15:gl(8,h,i)}var m=h.child;if(m!==null)m.return=h,je=m;else for(;je!==null;){h=je;var g=h.sibling,x=h.return;if(ly(h),h===f){je=null;break}if(g!==null){g.return=x,je=g;break}je=x}}}var _=i.alternate;if(_!==null){var y=_.child;if(y!==null){_.child=null;do{var S=y.sibling;y.sibling=null,y=S}while(y!==null)}}je=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,je=o;else e:for(;je!==null;){if(i=je,i.flags&2048)switch(i.tag){case 0:case 11:case 15:gl(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,je=k;break e}je=i.return}}var E=e.current;for(je=E;je!==null;){o=je;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,je=w;else e:for(o=E;je!==null;){if(l=je,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:If(9,l)}}catch(j){Gt(l,l.return,j)}if(l===o){je=null;break e}var F=l.sibling;if(F!==null){F.return=l.return,je=F;break e}je=l.return}}if(kt=a,Oi(),ga&&typeof ga.onPostCommitFiberRoot=="function")try{ga.onPostCommitFiberRoot(Nf,e)}catch{}n=!0}return n}finally{At=r,On.transition=t}}return!1}function yx(e,t,r){t=mo(r,t),t=Y_(e,t,1),e=_i(e,t,1),t=Zr(),e!==null&&(ac(e,1,t),sn(e,t))}function Gt(e,t,r){if(e.tag===3)yx(e,e,r);else for(;t!==null;){if(t.tag===3){yx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(yi===null||!yi.has(n))){e=mo(r,e),e=J_(t,e,1),t=_i(t,e,1),e=Zr(),t!==null&&(ac(t,1,e),sn(t,e));break}}t=t.return}}function DT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Zr(),e.pingedLanes|=e.suspendedLanes&r,xr===e&&(kr&r)===r&&(ur===4||ur===3&&(kr&130023424)===kr&&500>Jt()-Ep?Qi(e,0):kp|=r),sn(e,t)}function vy(e,t){t===0&&(e.mode&1?(t=$c,$c<<=1,!($c&130023424)&&($c=4194304)):t=1);var r=Zr();e=Va(e,t),e!==null&&(ac(e,t,r),sn(e,r))}function jT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),vy(e,r)}function BT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Te(314))}n!==null&&n.delete(t),vy(e,r)}var _y;_y=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||nn.current)tn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return tn=!1,CT(e,t,r);tn=!!(e.flags&131072)}else tn=!1,jt&&t.flags&1048576&&E_(t,Wu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Eu(e,t),e=t.pendingProps;var a=uo(t,Dr.current);ao(t,r),a=gp(null,t,n,e,a,r);var i=xp();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,an(n)?(i=!0,Vu(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,fp(t),a.updater=Mf,t.stateNode=a,a._reactInternals=t,Jd(t,n,e,r),t=th(null,t,n,!0,i,r)):(t.tag=0,jt&&i&&ap(t),Ur(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Eu(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=UT(n),e=Wn(n,e),a){case 0:t=eh(null,t,n,e,r);break e;case 1:t=ux(null,t,n,e,r);break e;case 11:t=lx(null,t,n,e,r);break e;case 14:t=cx(null,t,n,Wn(n.type,e),r);break e}throw Error(Te(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),eh(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),ux(e,t,n,a,r);case 3:e:{if(ry(t),e===null)throw Error(Te(387));n=t.pendingProps,i=t.memoizedState,a=i.element,A_(e,t),Xu(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=mo(Error(Te(423)),t),t=fx(e,t,n,r,a);break e}else if(n!==a){a=mo(Error(Te(424)),t),t=fx(e,t,n,r,a);break e}else for(pn=vi(t.stateNode.containerInfo.firstChild),mn=t,jt=!0,Gn=null,r=b_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(fo(),n===a){t=$a(e,t,r);break e}Ur(e,t,n,r)}t=t.child}return t;case 5:return L_(t),e===null&&qd(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,$d(n,a)?o=null:i!==null&&$d(n,i)&&(t.flags|=32),ty(e,t),Ur(e,t,o,r),t.child;case 6:return e===null&&qd(t),null;case 13:return ny(e,t,r);case 4:return dp(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ho(t,null,n,r):Ur(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),lx(e,t,n,a,r);case 7:return Ur(e,t,t.pendingProps,r),t.child;case 8:return Ur(e,t,t.pendingProps.children,r),t.child;case 12:return Ur(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Ft(Zu,n._currentValue),n._currentValue=o,i!==null)if(ea(i.value,o)){if(i.children===a.children&&!nn.current){t=$a(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=Da(-1,r&-r),u.tag=2;var f=i.updateQueue;if(f!==null){f=f.shared;var h=f.pending;h===null?u.next=u:(u.next=h.next,h.next=u),f.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Kd(i.return,r,t),l.lanes|=r;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Te(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Kd(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ur(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ao(t,r),a=Rn(a),n=n(a),t.flags|=1,Ur(e,t,n,r),t.child;case 14:return n=t.type,a=Wn(n,t.pendingProps),a=Wn(n.type,a),cx(e,t,n,a,r);case 15:return Q_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),Eu(e,t),t.tag=1,an(n)?(e=!0,Vu(t)):e=!1,ao(t,r),K_(t,n,a),Jd(t,n,a,r),th(null,t,n,!0,e,r);case 19:return ay(e,t,r);case 22:return ey(e,t,r)}throw Error(Te(156,t.tag))};function yy(e,t){return Gv(e,t)}function zT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(e,t,r,n){return new zT(e,t,r,n)}function bp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function UT(e){if(typeof e=="function")return bp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Zh)return 11;if(e===Gh)return 14}return 2}function ki(e,t){var r=e.alternate;return r===null?(r=Ln(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Cu(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")bp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Bs:return es(r.children,a,i,t);case Wh:o=8,a|=8;break;case kd:return e=Ln(12,r,t,a|2),e.elementType=kd,e.lanes=i,e;case Ed:return e=Ln(13,r,t,a),e.elementType=Ed,e.lanes=i,e;case Sd:return e=Ln(19,r,t,a),e.elementType=Sd,e.lanes=i,e;case Lv:return jf(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Nv:o=10;break e;case Av:o=9;break e;case Zh:o=11;break e;case Gh:o=14;break e;case ri:o=16,n=null;break e}throw Error(Te(130,e==null?e:typeof e,""))}return t=Ln(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function es(e,t,r,n){return e=Ln(7,e,n,t),e.lanes=r,e}function jf(e,t,r,n){return e=Ln(22,e,n,t),e.elementType=Lv,e.lanes=r,e.stateNode={isHidden:!1},e}function J0(e,t,r){return e=Ln(6,e,null,t),e.lanes=r,e}function Q0(e,t,r){return t=Ln(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function HT(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=O0(0),this.expirationTimes=O0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Np(e,t,r,n,a,i,o,l,u){return e=new HT(e,t,r,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ln(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},fp(i),e}function VT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:js,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function wy(e){if(!e)return bi;e=e._reactInternals;e:{if(ms(e)!==e||e.tag!==1)throw Error(Te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(an(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Te(171))}if(e.tag===1){var r=e.type;if(an(r))return w_(e,r,t)}return t}function ky(e,t,r,n,a,i,o,l,u){return e=Np(r,n,!0,e,a,i,o,l,u),e.context=wy(null),r=e.current,n=Zr(),a=wi(r),i=Da(n,a),i.callback=t??null,_i(r,i,a),e.current.lanes=a,ac(e,a,n),sn(e,n),e}function Bf(e,t,r,n){var a=t.current,i=Zr(),o=wi(a);return r=wy(r),t.context===null?t.context=r:t.pendingContext=r,t=Da(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=_i(a,t,o),e!==null&&(Jn(e,a,o,i),yu(e,a,o)),o}function rf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function wx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ap(e,t){wx(e,t),(e=e.alternate)&&wx(e,t)}function $T(){return null}var Ey=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lp(e){this._internalRoot=e}zf.prototype.render=Lp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Te(409));Bf(e,t,null,null)};zf.prototype.unmount=Lp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ls(function(){Bf(null,e,null,null)}),t[Ha]=null}};function zf(e){this._internalRoot=e}zf.prototype.unstable_scheduleHydration=function(e){if(e){var t=e_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ii.length&&t!==0&&t<ii[r].priority;r++);ii.splice(r,0,e),r===0&&r_(e)}};function Fp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Uf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function kx(){}function WT(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var f=rf(o);i.call(f)}}var o=ky(t,n,e,0,null,!1,!1,"",kx);return e._reactRootContainer=o,e[Ha]=o.current,jl(e.nodeType===8?e.parentNode:e),ls(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var f=rf(u);l.call(f)}}var u=Np(e,0,!1,null,null,!1,!1,"",kx);return e._reactRootContainer=u,e[Ha]=u.current,jl(e.nodeType===8?e.parentNode:e),ls(function(){Bf(t,u,r,n)}),u}function Hf(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var u=rf(o);l.call(u)}}Bf(t,o,e,a)}else o=WT(r,t,e,a,n);return rf(o)}Jv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=rl(t.pendingLanes);r!==0&&(Kh(t,r|1),sn(t,Jt()),!(kt&6)&&(go=Jt()+500,Oi()))}break;case 13:ls(function(){var n=Va(e,1);if(n!==null){var a=Zr();Jn(n,e,1,a)}}),Ap(e,1)}};Yh=function(e){if(e.tag===13){var t=Va(e,134217728);if(t!==null){var r=Zr();Jn(t,e,134217728,r)}Ap(e,134217728)}};Qv=function(e){if(e.tag===13){var t=wi(e),r=Va(e,t);if(r!==null){var n=Zr();Jn(r,e,t,n)}Ap(e,t)}};e_=function(){return At};t_=function(e,t){var r=At;try{return At=e,t()}finally{At=r}};Rd=function(e,t,r){switch(t){case"input":if(bd(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Pf(n);if(!a)throw Error(Te(90));Pv(n),bd(n,a)}}}break;case"textarea":Rv(e,r);break;case"select":t=r.value,t!=null&&eo(e,!!r.multiple,t,!1)}};Uv=Sp;Hv=ls;var ZT={usingClientEntryPoint:!1,Events:[sc,Vs,Pf,Bv,zv,Sp]},Yo={findFiberByHostInstance:Gi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GT={bundleType:Yo.bundleType,version:Yo.version,rendererPackageName:Yo.rendererPackageName,rendererConfig:Yo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Wv(e),e===null?null:e.stateNode},findFiberByHostInstance:Yo.findFiberByHostInstance||$T,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tu.isDisabled&&tu.supportsFiber)try{Nf=tu.inject(GT),ga=tu}catch{}}_n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZT;_n.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fp(t))throw Error(Te(200));return VT(e,t,null,r)};_n.createRoot=function(e,t){if(!Fp(e))throw Error(Te(299));var r=!1,n="",a=Ey;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Np(e,1,!1,null,null,r,!1,n,a),e[Ha]=t.current,jl(e.nodeType===8?e.parentNode:e),new Lp(t)};_n.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Te(188)):(e=Object.keys(e).join(","),Error(Te(268,e)));return e=Wv(t),e=e===null?null:e.stateNode,e};_n.flushSync=function(e){return ls(e)};_n.hydrate=function(e,t,r){if(!Uf(t))throw Error(Te(200));return Hf(null,e,t,!0,r)};_n.hydrateRoot=function(e,t,r){if(!Fp(e))throw Error(Te(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=Ey;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=ky(t,null,e,1,r??null,a,!1,i,o),e[Ha]=t.current,jl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new zf(t)};_n.render=function(e,t,r){if(!Uf(t))throw Error(Te(200));return Hf(null,e,t,!1,r)};_n.unmountComponentAtNode=function(e){if(!Uf(e))throw Error(Te(40));return e._reactRootContainer?(ls(function(){Hf(null,null,e,!1,function(){e._reactRootContainer=null,e[Ha]=null})}),!0):!1};_n.unstable_batchedUpdates=Sp;_n.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Uf(r))throw Error(Te(200));if(e==null||e._reactInternals===void 0)throw Error(Te(38));return Hf(e,t,r,!1,n)};_n.version="18.3.1-next-f1338f8080-20240426";function Sy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sy)}catch(e){console.error(e)}}Sy(),Sv.exports=_n;var Ty=Sv.exports,Ex=Ty;yd.createRoot=Ex.createRoot,yd.hydrateRoot=Ex.hydrateRoot;var Pp={};Object.defineProperty(Pp,"__esModule",{value:!0});Pp.parse=e4;Pp.serialize=t4;const XT=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,qT=/^[\u0021-\u003A\u003C-\u007E]*$/,KT=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,YT=/^[\u0020-\u003A\u003D-\u007E]*$/,JT=Object.prototype.toString,QT=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function e4(e,t){const r=new QT,n=e.length;if(n<2)return r;const a=(t==null?void 0:t.decode)||r4;let i=0;do{const o=e.indexOf("=",i);if(o===-1)break;const l=e.indexOf(";",i),u=l===-1?n:l;if(o>u){i=e.lastIndexOf(";",o-1)+1;continue}const f=Sx(e,i,o),h=Tx(e,o,f),m=e.slice(f,h);if(r[m]===void 0){let g=Sx(e,o+1,u),x=Tx(e,u,g);const _=a(e.slice(g,x));r[m]=_}i=u+1}while(i<n);return r}function Sx(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function Tx(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function t4(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!XT.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=n(t);if(!qT.test(a))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+a;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!KT.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!YT.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!n4(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function r4(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function n4(e){return JT.call(e)==="[object Date]"}/**
 * react-router v7.5.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function a4(e={}){let{initialEntries:t=["/"],initialIndex:r,v5Compat:n=!1}=e,a;a=t.map((x,_)=>h(x,typeof x=="string"?null:x.state,_===0?"default":void 0));let i=u(r??a.length-1),o="POP",l=null;function u(x){return Math.min(Math.max(x,0),a.length-1)}function f(){return a[i]}function h(x,_=null,y){let S=s4(a?f().pathname:"/",x,_,y);return In(S.pathname.charAt(0)==="/",`relative pathnames are not supported in memory history: ${JSON.stringify(x)}`),S}function m(x){return typeof x=="string"?x:nf(x)}return{get index(){return i},get action(){return o},get location(){return f()},createHref:m,createURL(x){return new URL(m(x),"http://localhost")},encodeLocation(x){let _=typeof x=="string"?gs(x):x;return{pathname:_.pathname||"",search:_.search||"",hash:_.hash||""}},push(x,_){o="PUSH";let y=h(x,_);i+=1,a.splice(i,a.length,y),n&&l&&l({action:o,location:y,delta:1})},replace(x,_){o="REPLACE";let y=h(x,_);a[i]=y,n&&l&&l({action:o,location:y,delta:0})},go(x){o="POP";let _=u(i+x),y=a[_];i=_,l&&l({action:o,location:y,delta:x})},listen(x){return l=x,()=>{l=null}}}}function Vt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function In(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function i4(){return Math.random().toString(36).substring(2,10)}function s4(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?gs(t):t,state:r,key:t&&t.key||n||i4()}}function nf({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function gs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function Cy(e,t,r="/"){return o4(e,t,r,!1)}function o4(e,t,r,n){let a=typeof t=="string"?gs(t):t,i=Wa(a.pathname||"/",r);if(i==null)return null;let o=by(e);l4(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let f=_4(i);l=x4(o[u],f,n)}return l}function by(e,t=[],r=[],n=""){let a=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Vt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let f=ja([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(Vt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),by(i.children,t,h,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:m4(f,i.index),routesMeta:h})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let u of Ny(i.path))a(i,o,u)}),t}function Ny(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Ny(n.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function l4(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:g4(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var c4=/^:[\w-]+$/,u4=3,f4=2,d4=1,h4=10,p4=-2,Cx=e=>e==="*";function m4(e,t){let r=e.split("/"),n=r.length;return r.some(Cx)&&(n+=p4),t&&(n+=f4),r.filter(a=>!Cx(a)).reduce((a,i)=>a+(c4.test(i)?u4:i===""?d4:h4),n)}function g4(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function x4(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],f=l===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",m=af({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},h),g=u.route;if(!m&&f&&r&&!n[n.length-1].route.index&&(m=af({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!m)return null;Object.assign(a,m.params),o.push({params:a,pathname:ja([i,m.pathname]),pathnameBase:E4(ja([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=ja([i,m.pathnameBase]))}return o}function af(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=v4(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:m},g)=>{if(h==="*"){let _=l[g]||"";o=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const x=l[g];return m&&!x?f[h]=void 0:f[h]=(x||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:o,pattern:e}}function v4(e,t=!1,r=!0){In(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function _4(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return In(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Wa(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function y4(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?gs(e):e;return{pathname:r?r.startsWith("/")?r:w4(r,t):t,search:S4(n),hash:T4(a)}}function w4(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ed(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function k4(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Op(e){let t=k4(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Rp(e,t,r,n=!1){let a;typeof e=="string"?a=gs(e):(a={...e},Vt(!a.pathname||!a.pathname.includes("?"),ed("?","pathname","search",a)),Vt(!a.pathname||!a.pathname.includes("#"),ed("#","pathname","hash",a)),Vt(!a.search||!a.search.includes("#"),ed("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;a.pathname=g.join("/")}l=m>=0?t[m]:"/"}let u=y4(a,l),f=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||h)&&(u.pathname+="/"),u}var ja=e=>e.join("/").replace(/\/\/+/g,"/"),E4=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),S4=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,T4=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function C4(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Ay=["POST","PUT","PATCH","DELETE"];new Set(Ay);var b4=["GET",...Ay];new Set(b4);var ko=C.createContext(null);ko.displayName="DataRouter";var Vf=C.createContext(null);Vf.displayName="DataRouterState";var Ly=C.createContext({isTransitioning:!1});Ly.displayName="ViewTransition";var N4=C.createContext(new Map);N4.displayName="Fetchers";var A4=C.createContext(null);A4.displayName="Await";var ra=C.createContext(null);ra.displayName="Navigation";var lc=C.createContext(null);lc.displayName="Location";var na=C.createContext({outlet:null,matches:[],isDataRoute:!1});na.displayName="Route";var Mp=C.createContext(null);Mp.displayName="RouteError";function L4(e,{relative:t}={}){Vt(Eo(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=C.useContext(ra),{hash:a,pathname:i,search:o}=cc(e,{relative:t}),l=i;return r!=="/"&&(l=i==="/"?r:ja([r,i])),n.createHref({pathname:l,search:o,hash:a})}function Eo(){return C.useContext(lc)!=null}function qa(){return Vt(Eo(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(lc).location}var Fy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Py(e){C.useContext(ra).static||C.useLayoutEffect(e)}function _a(){let{isDataRoute:e}=C.useContext(na);return e?$4():F4()}function F4(){Vt(Eo(),"useNavigate() may be used only in the context of a <Router> component.");let e=C.useContext(ko),{basename:t,navigator:r}=C.useContext(ra),{matches:n}=C.useContext(na),{pathname:a}=qa(),i=JSON.stringify(Op(n)),o=C.useRef(!1);return Py(()=>{o.current=!0}),C.useCallback((u,f={})=>{if(In(o.current,Fy),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=Rp(u,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ja([t,h.pathname])),(f.replace?r.replace:r.push)(h,f.state,f)},[t,r,i,a,e])}C.createContext(null);function P4(){let{matches:e}=C.useContext(na),t=e[e.length-1];return t?t.params:{}}function cc(e,{relative:t}={}){let{matches:r}=C.useContext(na),{pathname:n}=qa(),a=JSON.stringify(Op(r));return C.useMemo(()=>Rp(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function O4(e,t){return Oy(e,t)}function Oy(e,t,r,n){var E;Vt(Eo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=C.useContext(ra),{matches:o}=C.useContext(na),l=o[o.length-1],u=l?l.params:{},f=l?l.pathname:"/",h=l?l.pathnameBase:"/",m=l&&l.route;{let w=m&&m.path||"";Ry(f,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let g=qa(),x;if(t){let w=typeof t=="string"?gs(t):t;Vt(h==="/"||((E=w.pathname)==null?void 0:E.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${w.pathname}" was given in the \`location\` prop.`),x=w}else x=g;let _=x.pathname||"/",y=_;if(h!=="/"){let w=h.replace(/^\//,"").split("/");y="/"+_.replace(/^\//,"").split("/").slice(w.length).join("/")}let S=!i&&r&&r.matches&&r.matches.length>0?r.matches:Cy(e,{pathname:y});In(m||S!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),In(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=j4(S&&S.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:ja([h,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?h:ja([h,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n);return t&&k?C.createElement(lc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},k):k}function R4(){let e=V4(),t=C4(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:i},"ErrorBoundary")," or"," ",C.createElement("code",{style:i},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:a},r):null,o)}var M4=C.createElement(R4,null),I4=class extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(na.Provider,{value:this.props.routeContext},C.createElement(Mp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function D4({routeContext:e,match:t,children:r}){let n=C.useContext(ko);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(na.Provider,{value:e},r)}function j4(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let u=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);Vt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,l=-1;if(r)for(let u=0;u<a.length;u++){let f=a[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=u),f.route.id){let{loaderData:h,errors:m}=r,g=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((u,f,h)=>{let m,g=!1,x=null,_=null;r&&(m=i&&f.route.id?i[f.route.id]:void 0,x=f.route.errorElement||M4,o&&(l<0&&h===0?(Ry("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,_=null):l===h&&(g=!0,_=f.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,h+1)),S=()=>{let k;return m?k=x:g?k=_:f.route.Component?k=C.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=u,C.createElement(D4,{match:f,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:k})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?C.createElement(I4,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:S(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):S()},null)}function Ip(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function B4(e){let t=C.useContext(ko);return Vt(t,Ip(e)),t}function z4(e){let t=C.useContext(Vf);return Vt(t,Ip(e)),t}function U4(e){let t=C.useContext(na);return Vt(t,Ip(e)),t}function Dp(e){let t=U4(e),r=t.matches[t.matches.length-1];return Vt(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function H4(){return Dp("useRouteId")}function V4(){var n;let e=C.useContext(Mp),t=z4("useRouteError"),r=Dp("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function $4(){let{router:e}=B4("useNavigate"),t=Dp("useNavigate"),r=C.useRef(!1);return Py(()=>{r.current=!0}),C.useCallback(async(a,i={})=>{In(r.current,Fy),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var bx={};function Ry(e,t,r){!t&&!bx[e]&&(bx[e]=!0,In(!1,r))}C.memo(W4);function W4({routes:e,future:t,state:r}){return Oy(e,void 0,r,t)}function Z4({basename:e,children:t,initialEntries:r,initialIndex:n}){let a=C.useRef();a.current==null&&(a.current=a4({initialEntries:r,initialIndex:n,v5Compat:!0}));let i=a.current,[o,l]=C.useState({action:i.action,location:i.location}),u=C.useCallback(f=>{C.startTransition(()=>l(f))},[l]);return C.useLayoutEffect(()=>i.listen(u),[i,u]),C.createElement(X4,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i})}function G4({to:e,replace:t,state:r,relative:n}){Vt(Eo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=C.useContext(ra);In(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=C.useContext(na),{pathname:o}=qa(),l=_a(),u=Rp(e,Op(i),o,n==="path"),f=JSON.stringify(u);return C.useEffect(()=>{l(JSON.parse(f),{replace:t,state:r,relative:n})},[l,f,n,t,r]),null}function Lr(e){Vt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function X4({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){Vt(!Eo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=C.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof r=="string"&&(r=gs(r));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:g="default"}=r,x=C.useMemo(()=>{let _=Wa(u,o);return _==null?null:{location:{pathname:_,search:f,hash:h,state:m,key:g},navigationType:n}},[o,u,f,h,m,g,n]);return In(x!=null,`<Router basename="${o}"> is not able to match the URL "${u}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:C.createElement(ra.Provider,{value:l},C.createElement(lc.Provider,{children:t,value:x}))}function q4({children:e,location:t}){return O4(hh(e),t)}function hh(e,t=[]){let r=[];return C.Children.forEach(e,(n,a)=>{if(!C.isValidElement(n))return;let i=[...t,a];if(n.type===C.Fragment){r.push.apply(r,hh(n.props.children,i));return}Vt(n.type===Lr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Vt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=hh(n.props.children,i)),r.push(o)}),r}var bu="get",Nu="application/x-www-form-urlencoded";function $f(e){return e!=null&&typeof e.tagName=="string"}function K4(e){return $f(e)&&e.tagName.toLowerCase()==="button"}function Y4(e){return $f(e)&&e.tagName.toLowerCase()==="form"}function J4(e){return $f(e)&&e.tagName.toLowerCase()==="input"}function Q4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function eC(e,t){return e.button===0&&(!t||t==="_self")&&!Q4(e)}var ru=null;function tC(){if(ru===null)try{new FormData(document.createElement("form"),0),ru=!1}catch{ru=!0}return ru}var rC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function td(e){return e!=null&&!rC.has(e)?(In(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Nu}"`),null):e}function nC(e,t){let r,n,a,i,o;if(Y4(e)){let l=e.getAttribute("action");n=l?Wa(l,t):null,r=e.getAttribute("method")||bu,a=td(e.getAttribute("enctype"))||Nu,i=new FormData(e)}else if(K4(e)||J4(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||l.getAttribute("action");if(n=u?Wa(u,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||bu,a=td(e.getAttribute("formenctype"))||td(l.getAttribute("enctype"))||Nu,i=new FormData(l,e),!tC()){let{name:f,type:h,value:m}=e;if(h==="image"){let g=f?`${f}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else f&&i.append(f,m)}}else{if($f(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=bu,n=null,a=Nu,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}function jp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function aC(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function iC(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function sC(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let o=await aC(i,r);return o.links?o.links():[]}return[]}));return uC(n.flat(1).filter(iC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Nx(e,t,r,n,a,i){let o=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,l=(u,f)=>{var h;return r[f].pathname!==u.pathname||((h=r[f].route.path)==null?void 0:h.endsWith("*"))&&r[f].params["*"]!==u.params["*"]};return i==="assets"?t.filter((u,f)=>o(u,f)||l(u,f)):i==="data"?t.filter((u,f)=>{var m;let h=n.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,f)||l(u,f))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function oC(e,t,{includeHydrateFallback:r}={}){return lC(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function lC(e){return[...new Set(e)]}function cC(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function uC(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(cC(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}var fC=new Set([100,101,204,205]);function dC(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Wa(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function My(){let e=C.useContext(ko);return jp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function hC(){let e=C.useContext(Vf);return jp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Bp=C.createContext(void 0);Bp.displayName="FrameworkContext";function Iy(){let e=C.useContext(Bp);return jp(e,"You must render this element inside a <HydratedRouter> element"),e}function pC(e,t){let r=C.useContext(Bp),[n,a]=C.useState(!1),[i,o]=C.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:f,onMouseLeave:h,onTouchStart:m}=t,g=C.useRef(null);C.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let y=k=>{k.forEach(E=>{o(E.isIntersecting)})},S=new IntersectionObserver(y,{threshold:.5});return g.current&&S.observe(g.current),()=>{S.disconnect()}}},[e]),C.useEffect(()=>{if(n){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[n]);let x=()=>{a(!0)},_=()=>{a(!1),o(!1)};return r?e!=="intent"?[i,g,{}]:[i,g,{onFocus:Jo(l,x),onBlur:Jo(u,_),onMouseEnter:Jo(f,x),onMouseLeave:Jo(h,_),onTouchStart:Jo(m,x)}]:[!1,g,{}]}function Jo(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function mC({page:e,...t}){let{router:r}=My(),n=C.useMemo(()=>Cy(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?C.createElement(xC,{page:e,matches:n,...t}):null}function gC(e){let{manifest:t,routeModules:r}=Iy(),[n,a]=C.useState([]);return C.useEffect(()=>{let i=!1;return sC(e,t,r).then(o=>{i||a(o)}),()=>{i=!0}},[e,t,r]),n}function xC({page:e,matches:t,...r}){let n=qa(),{manifest:a,routeModules:i}=Iy(),{basename:o}=My(),{loaderData:l,matches:u}=hC(),f=C.useMemo(()=>Nx(e,t,u,a,n,"data"),[e,t,u,a,n]),h=C.useMemo(()=>Nx(e,t,u,a,n,"assets"),[e,t,u,a,n]),m=C.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let _=new Set,y=!1;if(t.forEach(k=>{var w;let E=a.routes[k.route.id];!E||!E.hasLoader||(!f.some(F=>F.route.id===k.route.id)&&k.route.id in l&&((w=i[k.route.id])!=null&&w.shouldRevalidate)||E.hasClientLoader?y=!0:_.add(k.route.id))}),_.size===0)return[];let S=dC(e,o);return y&&_.size>0&&S.searchParams.set("_routes",t.filter(k=>_.has(k.route.id)).map(k=>k.route.id).join(",")),[S.pathname+S.search]},[o,l,n,a,f,t,e,i]),g=C.useMemo(()=>oC(h,a),[h,a]),x=gC(h);return C.createElement(C.Fragment,null,m.map(_=>C.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...r})),g.map(_=>C.createElement("link",{key:_,rel:"modulepreload",href:_,...r})),x.map(({key:_,link:y})=>C.createElement("link",{key:_,...y})))}function vC(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Dy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Dy&&(window.__reactRouterVersion="7.5.1")}catch{}var jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uc=C.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:l,target:u,to:f,preventScrollReset:h,viewTransition:m,...g},x){let{basename:_}=C.useContext(ra),y=typeof f=="string"&&jy.test(f),S,k=!1;if(typeof f=="string"&&y&&(S=f,Dy))try{let O=new URL(window.location.href),G=f.startsWith("//")?new URL(O.protocol+f):new URL(f),H=Wa(G.pathname,_);G.origin===O.origin&&H!=null?f=H+G.search+G.hash:k=!0}catch{In(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=L4(f,{relative:a}),[w,F,j]=pC(n,g),D=kC(f,{replace:o,state:l,target:u,preventScrollReset:h,relative:a,viewTransition:m});function A(O){t&&t(O),O.defaultPrevented||D(O)}let M=C.createElement("a",{...g,...j,href:S||E,onClick:k||i?t:A,ref:vC(x,F),target:u,"data-discover":!y&&r==="render"?"true":void 0});return w&&!y?C.createElement(C.Fragment,null,M,C.createElement(mC,{page:E})):M});uc.displayName="Link";var _C=C.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:l,children:u,...f},h){let m=cc(o,{relative:f.relative}),g=qa(),x=C.useContext(Vf),{navigator:_,basename:y}=C.useContext(ra),S=x!=null&&bC(m)&&l===!0,k=_.encodeLocation?_.encodeLocation(m).pathname:m.pathname,E=g.pathname,w=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;r||(E=E.toLowerCase(),w=w?w.toLowerCase():null,k=k.toLowerCase()),w&&y&&(w=Wa(w,y)||w);const F=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let j=E===k||!a&&E.startsWith(k)&&E.charAt(F)==="/",D=w!=null&&(w===k||!a&&w.startsWith(k)&&w.charAt(k.length)==="/"),A={isActive:j,isPending:D,isTransitioning:S},M=j?t:void 0,O;typeof n=="function"?O=n(A):O=[n,j?"active":null,D?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let G=typeof i=="function"?i(A):i;return C.createElement(uc,{...f,"aria-current":M,className:O,ref:h,style:G,to:o,viewTransition:l},typeof u=="function"?u(A):u)});_C.displayName="NavLink";var yC=C.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:o=bu,action:l,onSubmit:u,relative:f,preventScrollReset:h,viewTransition:m,...g},x)=>{let _=TC(),y=CC(l,{relative:f}),S=o.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&jy.test(l),E=w=>{if(u&&u(w),w.defaultPrevented)return;w.preventDefault();let F=w.nativeEvent.submitter,j=(F==null?void 0:F.getAttribute("formmethod"))||o;_(F||w.currentTarget,{fetcherKey:t,method:j,navigate:r,replace:a,state:i,relative:f,preventScrollReset:h,viewTransition:m})};return C.createElement("form",{ref:x,method:S,action:y,onSubmit:n?u:E,...g,"data-discover":!k&&e==="render"?"true":void 0})});yC.displayName="Form";function wC(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function By(e){let t=C.useContext(ko);return Vt(t,wC(e)),t}function kC(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o}={}){let l=_a(),u=qa(),f=cc(e,{relative:i});return C.useCallback(h=>{if(eC(h,t)){h.preventDefault();let m=r!==void 0?r:nf(u)===nf(f);l(e,{replace:m,state:n,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,f,r,n,t,e,a,i,o])}var EC=0,SC=()=>`__${String(++EC)}__`;function TC(){let{router:e}=By("useSubmit"),{basename:t}=C.useContext(ra),r=H4();return C.useCallback(async(n,a={})=>{let{action:i,method:o,encType:l,formData:u,body:f}=nC(n,t);if(a.navigate===!1){let h=a.fetcherKey||SC();await e.fetch(h,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function CC(e,{relative:t}={}){let{basename:r}=C.useContext(ra),n=C.useContext(na);Vt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...cc(e||".",{relative:t})},o=qa();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(h=>h==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let h=l.toString();i.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:ja([r,i.pathname])),nf(i)}function bC(e,t={}){let r=C.useContext(Ly);Vt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=By("useViewTransitionState"),a=cc(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=Wa(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Wa(r.nextLocation.pathname,n)||r.nextLocation.pathname;return af(a.pathname,o)!=null||af(a.pathname,i)!=null}new TextEncoder;[...fC];function zy(e,t){return function(){return e.apply(t,arguments)}}const{toString:NC}=Object.prototype,{getPrototypeOf:zp}=Object,Wf=(e=>t=>{const r=NC.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),aa=e=>(e=e.toLowerCase(),t=>Wf(t)===e),Zf=e=>t=>typeof t===e,{isArray:So}=Array,Gl=Zf("undefined");function AC(e){return e!==null&&!Gl(e)&&e.constructor!==null&&!Gl(e.constructor)&&gn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Uy=aa("ArrayBuffer");function LC(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Uy(e.buffer),t}const FC=Zf("string"),gn=Zf("function"),Hy=Zf("number"),Gf=e=>e!==null&&typeof e=="object",PC=e=>e===!0||e===!1,Au=e=>{if(Wf(e)!=="object")return!1;const t=zp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},OC=aa("Date"),RC=aa("File"),MC=aa("Blob"),IC=aa("FileList"),DC=e=>Gf(e)&&gn(e.pipe),jC=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||gn(e.append)&&((t=Wf(e))==="formdata"||t==="object"&&gn(e.toString)&&e.toString()==="[object FormData]"))},BC=aa("URLSearchParams"),[zC,UC,HC,VC]=["ReadableStream","Request","Response","Headers"].map(aa),$C=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),So(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,e[l],l,e)}}function Vy(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Ki=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,$y=e=>!Gl(e)&&e!==Ki;function ph(){const{caseless:e}=$y(this)&&this||{},t={},r=(n,a)=>{const i=e&&Vy(t,a)||a;Au(t[i])&&Au(n)?t[i]=ph(t[i],n):Au(n)?t[i]=ph({},n):So(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&fc(arguments[n],r);return t}const WC=(e,t,r,{allOwnKeys:n}={})=>(fc(t,(a,i)=>{r&&gn(a)?e[i]=zy(a,r):e[i]=a},{allOwnKeys:n}),e),ZC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),GC=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},XC=(e,t,r,n)=>{let a,i,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&zp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},qC=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},KC=e=>{if(!e)return null;if(So(e))return e;let t=e.length;if(!Hy(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},YC=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&zp(Uint8Array)),JC=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},QC=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},e3=aa("HTMLFormElement"),t3=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Ax=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),r3=aa("RegExp"),Wy=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};fc(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},n3=e=>{Wy(e,(t,r)=>{if(gn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(gn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},a3=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return So(e)?n(e):n(String(e).split(t)),r},i3=()=>{},s3=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function o3(e){return!!(e&&gn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const l3=e=>{const t=new Array(10),r=(n,a)=>{if(Gf(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=So(n)?[]:{};return fc(n,(o,l)=>{const u=r(o,a+1);!Gl(u)&&(i[l]=u)}),t[a]=void 0,i}}return n};return r(e,0)},c3=aa("AsyncFunction"),u3=e=>e&&(Gf(e)||gn(e))&&gn(e.then)&&gn(e.catch),Zy=((e,t)=>e?setImmediate:t?((r,n)=>(Ki.addEventListener("message",({source:a,data:i})=>{a===Ki&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Ki.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",gn(Ki.postMessage)),f3=typeof queueMicrotask<"u"?queueMicrotask.bind(Ki):typeof process<"u"&&process.nextTick||Zy,de={isArray:So,isArrayBuffer:Uy,isBuffer:AC,isFormData:jC,isArrayBufferView:LC,isString:FC,isNumber:Hy,isBoolean:PC,isObject:Gf,isPlainObject:Au,isReadableStream:zC,isRequest:UC,isResponse:HC,isHeaders:VC,isUndefined:Gl,isDate:OC,isFile:RC,isBlob:MC,isRegExp:r3,isFunction:gn,isStream:DC,isURLSearchParams:BC,isTypedArray:YC,isFileList:IC,forEach:fc,merge:ph,extend:WC,trim:$C,stripBOM:ZC,inherits:GC,toFlatObject:XC,kindOf:Wf,kindOfTest:aa,endsWith:qC,toArray:KC,forEachEntry:JC,matchAll:QC,isHTMLForm:e3,hasOwnProperty:Ax,hasOwnProp:Ax,reduceDescriptors:Wy,freezeMethods:n3,toObjectSet:a3,toCamelCase:t3,noop:i3,toFiniteNumber:s3,findKey:Vy,global:Ki,isContextDefined:$y,isSpecCompliantForm:o3,toJSONObject:l3,isAsyncFn:c3,isThenable:u3,setImmediate:Zy,asap:f3};function at(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}de.inherits(at,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:de.toJSONObject(this.config),code:this.code,status:this.status}}});const Gy=at.prototype,Xy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Xy[e]={value:e}});Object.defineProperties(at,Xy);Object.defineProperty(Gy,"isAxiosError",{value:!0});at.from=(e,t,r,n,a,i)=>{const o=Object.create(Gy);return de.toFlatObject(e,o,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),at.call(o,e.message,t,r,n,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const d3=null;function mh(e){return de.isPlainObject(e)||de.isArray(e)}function qy(e){return de.endsWith(e,"[]")?e.slice(0,-2):e}function Lx(e,t,r){return e?e.concat(t).map(function(a,i){return a=qy(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function h3(e){return de.isArray(e)&&!e.some(mh)}const p3=de.toFlatObject(de,{},null,function(t){return/^is[A-Z]/.test(t)});function Xf(e,t,r){if(!de.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=de.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,S){return!de.isUndefined(S[y])});const n=r.metaTokens,a=r.visitor||h,i=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&de.isSpecCompliantForm(t);if(!de.isFunction(a))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(de.isDate(_))return _.toISOString();if(!u&&de.isBlob(_))throw new at("Blob is not supported. Use a Buffer instead.");return de.isArrayBuffer(_)||de.isTypedArray(_)?u&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,y,S){let k=_;if(_&&!S&&typeof _=="object"){if(de.endsWith(y,"{}"))y=n?y:y.slice(0,-2),_=JSON.stringify(_);else if(de.isArray(_)&&h3(_)||(de.isFileList(_)||de.endsWith(y,"[]"))&&(k=de.toArray(_)))return y=qy(y),k.forEach(function(w,F){!(de.isUndefined(w)||w===null)&&t.append(o===!0?Lx([y],F,i):o===null?y:y+"[]",f(w))}),!1}return mh(_)?!0:(t.append(Lx(S,y,i),f(_)),!1)}const m=[],g=Object.assign(p3,{defaultVisitor:h,convertValue:f,isVisitable:mh});function x(_,y){if(!de.isUndefined(_)){if(m.indexOf(_)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(_),de.forEach(_,function(k,E){(!(de.isUndefined(k)||k===null)&&a.call(t,k,de.isString(E)?E.trim():E,y,g))===!0&&x(k,y?y.concat(E):[E])}),m.pop()}}if(!de.isObject(e))throw new TypeError("data must be an object");return x(e),t}function Fx(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Up(e,t){this._pairs=[],e&&Xf(e,this,t)}const Ky=Up.prototype;Ky.append=function(t,r){this._pairs.push([t,r])};Ky.toString=function(t){const r=t?function(n){return t.call(this,n,Fx)}:Fx;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function m3(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Yy(e,t,r){if(!t)return e;const n=r&&r.encode||m3;de.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=de.isURLSearchParams(t)?t.toString():new Up(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Px{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){de.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Jy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},g3=typeof URLSearchParams<"u"?URLSearchParams:Up,x3=typeof FormData<"u"?FormData:null,v3=typeof Blob<"u"?Blob:null,_3={isBrowser:!0,classes:{URLSearchParams:g3,FormData:x3,Blob:v3},protocols:["http","https","file","blob","url","data"]},Hp=typeof window<"u"&&typeof document<"u",gh=typeof navigator=="object"&&navigator||void 0,y3=Hp&&(!gh||["ReactNative","NativeScript","NS"].indexOf(gh.product)<0),w3=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",k3=Hp&&window.location.href||"http://localhost",E3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Hp,hasStandardBrowserEnv:y3,hasStandardBrowserWebWorkerEnv:w3,navigator:gh,origin:k3},Symbol.toStringTag,{value:"Module"})),Or={...E3,..._3};function S3(e,t){return Xf(e,new Or.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Or.isNode&&de.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function T3(e){return de.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function C3(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function Qy(e){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=i>=r.length;return o=!o&&de.isArray(a)?a.length:o,u?(de.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!de.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&de.isArray(a[o])&&(a[o]=C3(a[o])),!l)}if(de.isFormData(e)&&de.isFunction(e.entries)){const r={};return de.forEachEntry(e,(n,a)=>{t(T3(n),a,r,0)}),r}return null}function b3(e,t,r){if(de.isString(e))try{return(t||JSON.parse)(e),de.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const dc={transitional:Jy,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=de.isObject(t);if(i&&de.isHTMLForm(t)&&(t=new FormData(t)),de.isFormData(t))return a?JSON.stringify(Qy(t)):t;if(de.isArrayBuffer(t)||de.isBuffer(t)||de.isStream(t)||de.isFile(t)||de.isBlob(t)||de.isReadableStream(t))return t;if(de.isArrayBufferView(t))return t.buffer;if(de.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return S3(t,this.formSerializer).toString();if((l=de.isFileList(t))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Xf(l?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),b3(t)):t}],transformResponse:[function(t){const r=this.transitional||dc.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(de.isResponse(t)||de.isReadableStream(t))return t;if(t&&de.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?at.from(l,at.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Or.classes.FormData,Blob:Or.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};de.forEach(["delete","get","head","post","put","patch"],e=>{dc.headers[e]={}});const N3=de.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),A3=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&N3[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Ox=Symbol("internals");function Qo(e){return e&&String(e).trim().toLowerCase()}function Lu(e){return e===!1||e==null?e:de.isArray(e)?e.map(Lu):String(e)}function L3(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const F3=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function rd(e,t,r,n,a){if(de.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!de.isString(t)){if(de.isString(n))return t.indexOf(n)!==-1;if(de.isRegExp(n))return n.test(t)}}function P3(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function O3(e,t){const r=de.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}class on{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(l,u,f){const h=Qo(u);if(!h)throw new Error("header name must be a non-empty string");const m=de.findKey(a,h);(!m||a[m]===void 0||f===!0||f===void 0&&a[m]!==!1)&&(a[m||u]=Lu(l))}const o=(l,u)=>de.forEach(l,(f,h)=>i(f,h,u));if(de.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(de.isString(t)&&(t=t.trim())&&!F3(t))o(A3(t),r);else if(de.isHeaders(t))for(const[l,u]of t.entries())i(u,l,n);else t!=null&&i(r,t,n);return this}get(t,r){if(t=Qo(t),t){const n=de.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return L3(a);if(de.isFunction(r))return r.call(this,a,n);if(de.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Qo(t),t){const n=de.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||rd(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=Qo(o),o){const l=de.findKey(n,o);l&&(!r||rd(n,n[l],l,r))&&(delete n[l],a=!0)}}return de.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||rd(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return de.forEach(this,(a,i)=>{const o=de.findKey(n,i);if(o){r[o]=Lu(a),delete r[i];return}const l=t?P3(i):String(i).trim();l!==i&&delete r[i],r[l]=Lu(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return de.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&de.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[Ox]=this[Ox]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=Qo(o);n[l]||(O3(a,o),n[l]=!0)}return de.isArray(t)?t.forEach(i):i(t),this}}on.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);de.reduceDescriptors(on.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});de.freezeMethods(on);function nd(e,t){const r=this||dc,n=t||r,a=on.from(n.headers);let i=n.data;return de.forEach(e,function(l){i=l.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function e2(e){return!!(e&&e.__CANCEL__)}function To(e,t,r){at.call(this,e??"canceled",at.ERR_CANCELED,t,r),this.name="CanceledError"}de.inherits(To,at,{__CANCEL__:!0});function t2(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new at("Request failed with status code "+r.status,[at.ERR_BAD_REQUEST,at.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function R3(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function M3(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(u){const f=Date.now(),h=n[i];o||(o=f),r[a]=u,n[a]=f;let m=i,g=0;for(;m!==a;)g+=r[m++],m=m%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),f-o<t)return;const x=h&&f-h;return x?Math.round(g*1e3/x):void 0}}function I3(e,t){let r=0,n=1e3/t,a,i;const o=(f,h=Date.now())=>{r=h,a=null,i&&(clearTimeout(i),i=null),e.apply(null,f)};return[(...f)=>{const h=Date.now(),m=h-r;m>=n?o(f,h):(a=f,i||(i=setTimeout(()=>{i=null,o(a)},n-m)))},()=>a&&o(a)]}const sf=(e,t,r=3)=>{let n=0;const a=M3(50,250);return I3(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,u=o-n,f=a(u),h=o<=l;n=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:f||void 0,estimated:f&&l&&h?(l-o)/f:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},Rx=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Mx=e=>(...t)=>de.asap(()=>e(...t)),D3=Or.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Or.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Or.origin),Or.navigator&&/(msie|trident)/i.test(Or.navigator.userAgent)):()=>!0,j3=Or.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];de.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),de.isString(n)&&o.push("path="+n),de.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function B3(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function z3(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function r2(e,t,r){let n=!B3(t);return e&&(n||r==!1)?z3(e,t):t}const Ix=e=>e instanceof on?{...e}:e;function cs(e,t){t=t||{};const r={};function n(f,h,m,g){return de.isPlainObject(f)&&de.isPlainObject(h)?de.merge.call({caseless:g},f,h):de.isPlainObject(h)?de.merge({},h):de.isArray(h)?h.slice():h}function a(f,h,m,g){if(de.isUndefined(h)){if(!de.isUndefined(f))return n(void 0,f,m,g)}else return n(f,h,m,g)}function i(f,h){if(!de.isUndefined(h))return n(void 0,h)}function o(f,h){if(de.isUndefined(h)){if(!de.isUndefined(f))return n(void 0,f)}else return n(void 0,h)}function l(f,h,m){if(m in t)return n(f,h);if(m in e)return n(void 0,f)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(f,h,m)=>a(Ix(f),Ix(h),m,!0)};return de.forEach(Object.keys(Object.assign({},e,t)),function(h){const m=u[h]||a,g=m(e[h],t[h],h);de.isUndefined(g)&&m!==l||(r[h]=g)}),r}const n2=e=>{const t=cs({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=t;t.headers=o=on.from(o),t.url=Yy(r2(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let u;if(de.isFormData(r)){if(Or.hasStandardBrowserEnv||Or.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[f,...h]=u?u.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([f||"multipart/form-data",...h].join("; "))}}if(Or.hasStandardBrowserEnv&&(n&&de.isFunction(n)&&(n=n(t)),n||n!==!1&&D3(t.url))){const f=a&&i&&j3.read(i);f&&o.set(a,f)}return t},U3=typeof XMLHttpRequest<"u",H3=U3&&function(e){return new Promise(function(r,n){const a=n2(e);let i=a.data;const o=on.from(a.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:f}=a,h,m,g,x,_;function y(){x&&x(),_&&_(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let S=new XMLHttpRequest;S.open(a.method.toUpperCase(),a.url,!0),S.timeout=a.timeout;function k(){if(!S)return;const w=on.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:w,config:e,request:S};t2(function(A){r(A),y()},function(A){n(A),y()},j),S=null}"onloadend"in S?S.onloadend=k:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(k)},S.onabort=function(){S&&(n(new at("Request aborted",at.ECONNABORTED,e,S)),S=null)},S.onerror=function(){n(new at("Network Error",at.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let F=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const j=a.transitional||Jy;a.timeoutErrorMessage&&(F=a.timeoutErrorMessage),n(new at(F,j.clarifyTimeoutError?at.ETIMEDOUT:at.ECONNABORTED,e,S)),S=null},i===void 0&&o.setContentType(null),"setRequestHeader"in S&&de.forEach(o.toJSON(),function(F,j){S.setRequestHeader(j,F)}),de.isUndefined(a.withCredentials)||(S.withCredentials=!!a.withCredentials),l&&l!=="json"&&(S.responseType=a.responseType),f&&([g,_]=sf(f,!0),S.addEventListener("progress",g)),u&&S.upload&&([m,x]=sf(u),S.upload.addEventListener("progress",m),S.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(h=w=>{S&&(n(!w||w.type?new To(null,e,S):w),S.abort(),S=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const E=R3(a.url);if(E&&Or.protocols.indexOf(E)===-1){n(new at("Unsupported protocol "+E+":",at.ERR_BAD_REQUEST,e));return}S.send(i||null)})},V3=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(f){if(!a){a=!0,l();const h=f instanceof Error?f:this.reason;n.abort(h instanceof at?h:new To(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,i(new at(`timeout ${t} of ms exceeded`,at.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),e=null)};e.forEach(f=>f.addEventListener("abort",i));const{signal:u}=n;return u.unsubscribe=()=>de.asap(l),u}},$3=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},W3=async function*(e,t){for await(const r of Z3(e))yield*$3(r,t)},Z3=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Dx=(e,t,r,n)=>{const a=W3(e,t);let i=0,o,l=u=>{o||(o=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:f,value:h}=await a.next();if(f){l(),u.close();return}let m=h.byteLength;if(r){let g=i+=m;r(g)}u.enqueue(new Uint8Array(h))}catch(f){throw l(f),f}},cancel(u){return l(u),a.return()}},{highWaterMark:2})},qf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",a2=qf&&typeof ReadableStream=="function",G3=qf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),i2=(e,...t)=>{try{return!!e(...t)}catch{return!1}},X3=a2&&i2(()=>{let e=!1;const t=new Request(Or.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),jx=64*1024,xh=a2&&i2(()=>de.isReadableStream(new Response("").body)),of={stream:xh&&(e=>e.body)};qf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!of[t]&&(of[t]=de.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new at(`Response type '${t}' is not supported`,at.ERR_NOT_SUPPORT,n)})})})(new Response);const q3=async e=>{if(e==null)return 0;if(de.isBlob(e))return e.size;if(de.isSpecCompliantForm(e))return(await new Request(Or.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(de.isArrayBufferView(e)||de.isArrayBuffer(e))return e.byteLength;if(de.isURLSearchParams(e)&&(e=e+""),de.isString(e))return(await G3(e)).byteLength},K3=async(e,t)=>{const r=de.toFiniteNumber(e.getContentLength());return r??q3(t)},Y3=qf&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:u,responseType:f,headers:h,withCredentials:m="same-origin",fetchOptions:g}=n2(e);f=f?(f+"").toLowerCase():"text";let x=V3([a,i&&i.toAbortSignal()],o),_;const y=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let S;try{if(u&&X3&&r!=="get"&&r!=="head"&&(S=await K3(h,n))!==0){let j=new Request(t,{method:"POST",body:n,duplex:"half"}),D;if(de.isFormData(n)&&(D=j.headers.get("content-type"))&&h.setContentType(D),j.body){const[A,M]=Rx(S,sf(Mx(u)));n=Dx(j.body,jx,A,M)}}de.isString(m)||(m=m?"include":"omit");const k="credentials"in Request.prototype;_=new Request(t,{...g,signal:x,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:k?m:void 0});let E=await fetch(_);const w=xh&&(f==="stream"||f==="response");if(xh&&(l||w&&y)){const j={};["status","statusText","headers"].forEach(O=>{j[O]=E[O]});const D=de.toFiniteNumber(E.headers.get("content-length")),[A,M]=l&&Rx(D,sf(Mx(l),!0))||[];E=new Response(Dx(E.body,jx,A,()=>{M&&M(),y&&y()}),j)}f=f||"text";let F=await of[de.findKey(of,f)||"text"](E,e);return!w&&y&&y(),await new Promise((j,D)=>{t2(j,D,{data:F,headers:on.from(E.headers),status:E.status,statusText:E.statusText,config:e,request:_})})}catch(k){throw y&&y(),k&&k.name==="TypeError"&&/fetch/i.test(k.message)?Object.assign(new at("Network Error",at.ERR_NETWORK,e,_),{cause:k.cause||k}):at.from(k,k&&k.code,e,_)}}),vh={http:d3,xhr:H3,fetch:Y3};de.forEach(vh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Bx=e=>`- ${e}`,J3=e=>de.isFunction(e)||e===null||e===!1,s2={getAdapter:e=>{e=de.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!J3(r)&&(n=vh[(o=String(r)).toLowerCase()],n===void 0))throw new at(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(Bx).join(`
`):" "+Bx(i[0]):"as no adapter specified";throw new at("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:vh};function ad(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new To(null,e)}function zx(e){return ad(e),e.headers=on.from(e.headers),e.data=nd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),s2.getAdapter(e.adapter||dc.adapter)(e).then(function(n){return ad(e),n.data=nd.call(e,e.transformResponse,n),n.headers=on.from(n.headers),n},function(n){return e2(n)||(ad(e),n&&n.response&&(n.response.data=nd.call(e,e.transformResponse,n.response),n.response.headers=on.from(n.response.headers))),Promise.reject(n)})}const o2="1.8.4",Kf={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Kf[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Ux={};Kf.transitional=function(t,r,n){function a(i,o){return"[Axios v"+o2+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new at(a(o," has been removed"+(r?" in "+r:"")),at.ERR_DEPRECATED);return r&&!Ux[o]&&(Ux[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};Kf.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Q3(e,t,r){if(typeof e!="object")throw new at("options must be an object",at.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const l=e[i],u=l===void 0||o(l,i,e);if(u!==!0)throw new at("option "+i+" must be "+u,at.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new at("Unknown option "+i,at.ERR_BAD_OPTION)}}const Fu={assertOptions:Q3,validators:Kf},fa=Fu.validators;class ts{constructor(t){this.defaults=t,this.interceptors={request:new Px,response:new Px}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=cs(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Fu.assertOptions(n,{silentJSONParsing:fa.transitional(fa.boolean),forcedJSONParsing:fa.transitional(fa.boolean),clarifyTimeoutError:fa.transitional(fa.boolean)},!1),a!=null&&(de.isFunction(a)?r.paramsSerializer={serialize:a}:Fu.assertOptions(a,{encode:fa.function,serialize:fa.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Fu.assertOptions(r,{baseUrl:fa.spelling("baseURL"),withXsrfToken:fa.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&de.merge(i.common,i[r.method]);i&&de.forEach(["delete","get","head","post","put","patch","common"],_=>{delete i[_]}),r.headers=on.concat(o,i);const l=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(u=u&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const f=[];this.interceptors.response.forEach(function(y){f.push(y.fulfilled,y.rejected)});let h,m=0,g;if(!u){const _=[zx.bind(this),void 0];for(_.unshift.apply(_,l),_.push.apply(_,f),g=_.length,h=Promise.resolve(r);m<g;)h=h.then(_[m++],_[m++]);return h}g=l.length;let x=r;for(m=0;m<g;){const _=l[m++],y=l[m++];try{x=_(x)}catch(S){y.call(this,S);break}}try{h=zx.call(this,x)}catch(_){return Promise.reject(_)}for(m=0,g=f.length;m<g;)h=h.then(f[m++],f[m++]);return h}getUri(t){t=cs(this.defaults,t);const r=r2(t.baseURL,t.url,t.allowAbsoluteUrls);return Yy(r,t.params,t.paramsSerializer)}}de.forEach(["delete","get","head","options"],function(t){ts.prototype[t]=function(r,n){return this.request(cs(n||{},{method:t,url:r,data:(n||{}).data}))}});de.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(cs(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ts.prototype[t]=r(),ts.prototype[t+"Form"]=r(!0)});class Vp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new To(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Vp(function(a){t=a}),cancel:t}}}function eb(e){return function(r){return e.apply(null,r)}}function tb(e){return de.isObject(e)&&e.isAxiosError===!0}const _h={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_h).forEach(([e,t])=>{_h[t]=e});function l2(e){const t=new ts(e),r=zy(ts.prototype.request,t);return de.extend(r,ts.prototype,t,{allOwnKeys:!0}),de.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return l2(cs(e,a))},r}const We=l2(dc);We.Axios=ts;We.CanceledError=To;We.CancelToken=Vp;We.isCancel=e2;We.VERSION=o2;We.toFormData=Xf;We.AxiosError=at;We.Cancel=We.CanceledError;We.all=function(t){return Promise.all(t)};We.spread=eb;We.isAxiosError=tb;We.mergeConfig=cs;We.AxiosHeaders=on;We.formToJSON=e=>Qy(de.isHTMLForm(e)?new FormData(e):e);We.getAdapter=s2.getAdapter;We.HttpStatusCode=_h;We.default=We;const ta="http://localhost:8000/api",Hx={CAMERAS:{LIST:"/cameras/cameras/",UPLOAD:"/cameras/cameras/upload_csv/",DETAIL:e=>`/cameras/cameras/${e}/`},COMMANDS:{SAVE_CONFIG:"/command/commands/save_config/",EXECUTE:"/command/execute/"},AUTH:{LOGIN:"/auth/token/",REFRESH:"/auth/token/refresh/"}};function c2(e){var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null}let yh=null;const rb=e=>{yh=e},lf=e=>{yh?yh(e):window.location.href=e},rn=We.create({baseURL:ta,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});rn.interceptors.request.use(e=>{var t;if(["post","put","patch","delete"].includes(((t=e.method)==null?void 0:t.toLowerCase())||"")){const r=c2("csrftoken");r&&(e.headers["X-CSRFToken"]=r)}return e});rn.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refreshToken");if(n){const a=await We.post(`${ta}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"X-CSRFToken":c2("csrftoken")}}),{access:i}=a.data;return localStorage.setItem("token",i),rn.defaults.headers.common.Authorization=`Bearer ${i}`,t.headers.Authorization=`Bearer ${i}`,rn(t)}}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),lf("/login")}}return Promise.reject(e)});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ht=(e,t)=>{const r=C.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,...f},h)=>C.createElement("svg",{ref:h,...nb,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${ab(e)}`,l].join(" "),...f},[...t.map(([m,g])=>C.createElement(m,g)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=ht("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=ht("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=ht("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=ht("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=ht("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=ht("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=ht("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=ht("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=ht("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=ht("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=ht("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=ht("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=ht("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=ht("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=ht("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=ht("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=ht("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=ht("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=ht("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=ht("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=ht("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=ht("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=ht("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=ht("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=ht("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=ht("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=ht("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=ht("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=ht("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=ht("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=ht("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=ht("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=ht("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=ht("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=ht("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wx=ht("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=ht("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=ht("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function wb({onLogin:e}){const t=_a(),[r,n]=C.useState(""),[a,i]=C.useState(""),[o,l]=C.useState(""),[u,f]=C.useState(!1);C.useEffect(()=>{(async()=>{try{await rn.get("/auth/csrf/")}catch(g){console.error("Error initializing CSRF:",g)}})()},[]);const h=async m=>{var g,x;m.preventDefault(),f(!0),l("");try{const _={username:r,password:a},y=await rn.post("/auth/login/",_);localStorage.setItem("token",y.data.access),localStorage.setItem("refreshToken",y.data.refresh),rn.defaults.headers.common.Authorization=`Bearer ${y.data.access}`,e(),t("/")}catch(_){console.error("Login error details:",_),(x=(g=_.response)==null?void 0:g.data)!=null&&x.detail?l(_.response.data.detail):l("Nom d'utilisateur ou mot de passe incorrect")}finally{f(!1)}};return d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:d.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[d.jsxs("div",{className:"flex items-center justify-center mb-8",children:[d.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:d.jsx(di,{className:"h-8 w-8 text-purple-600"})}),d.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),o&&d.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:o}),d.jsxs("form",{onSubmit:h,className:"space-y-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(us,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",value:r,onChange:m=>n(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(di,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"password",value:a,onChange:m=>i(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),d.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50",children:u?d.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Se connecter"}),d.jsx("div",{className:"text-center mt-4",children:d.jsxs("p",{className:"text-sm text-gray-600",children:["Pas encore de compte ?"," ",d.jsx(uc,{to:"/register",className:"font-medium text-purple-600 hover:text-purple-500",children:"S'inscrire"})]})})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}const Wp="http://localhost:8000/api";We.defaults.withCredentials=!0;const ff=We.create({baseURL:Wp,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}}),kb=e=>{var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null},g2=()=>kb("csrftoken"),Eb=async()=>{try{return(await We.get(`${Wp}/auth/csrf/`,{withCredentials:!0,headers:{Accept:"application/json"}})).data.token}catch(e){throw console.error("Error fetching CSRF token:",e),e}};let id=null;const Sb=async()=>(id||(id=Eb()),id);ff.interceptors.request.use(async e=>{var n;if(((n=e.method)==null?void 0:n.toLowerCase())==="get")return e;let t=g2();if(!t)try{if(t=await Sb(),!t)throw new Error("Failed to get CSRF token")}catch(a){throw console.error("Failed to fetch CSRF token:",a),a}t&&(e.headers["X-CSRFToken"]=t);const r=localStorage.getItem("access_token");return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));ff.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refresh_token");if(n){const a=await We.post(`${Wp}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"Content-Type":"application/json","X-CSRFToken":g2()}});if(a.data.access)return localStorage.setItem("access_token",a.data.access),t.headers.Authorization=`Bearer ${a.data.access}`,ff(t)}}catch(n){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(n)}}return Promise.reject(e)});function Tb({onRegister:e}){const t=_a(),[r,n]=C.useState({username:"",email:"",phone_number:"",password:"",confirmPassword:"",first_name:"",last_name:""}),[a,i]=C.useState(""),[o,l]=C.useState(!1),u=h=>{const{name:m,value:g}=h.target;n(x=>({...x,[m]:g}))},f=async h=>{var m,g,x,_,y;if(h.preventDefault(),i(""),l(!0),r.password!==r.confirmPassword){i("Les mots de passe ne correspondent pas"),l(!1);return}try{const S=await ff.post("/auth/register/",{username:r.username,email:r.email,phone_number:r.phone_number,password:r.password,first_name:r.first_name,last_name:r.last_name});S.data.access&&(localStorage.setItem("access_token",S.data.access),S.data.refresh&&localStorage.setItem("refresh_token",S.data.refresh),e?e():t("/"))}catch(S){console.error("Registration error:",S),(g=(m=S.response)==null?void 0:m.data)!=null&&g.error?i(S.response.data.error):(_=(x=S.response)==null?void 0:x.data)!=null&&_.username?i("Ce nom d'utilisateur est dj pris"):((y=S.response)==null?void 0:y.status)===403?i("Erreur CORS: Vrifiez la configuration du serveur"):i("Une erreur est survenue lors de l'inscription. Veuillez ressayer.")}finally{l(!1)}};return d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:d.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[d.jsxs("div",{className:"flex items-center justify-center mb-8",children:[d.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:d.jsx(us,{className:"h-8 w-8 text-purple-600"})}),d.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),a&&d.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:a}),d.jsxs("form",{onSubmit:f,className:"space-y-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(us,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",name:"username",value:r.username,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(Vx,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Prnom",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(Vx,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom",required:!0})]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(d2,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"email",name:"email",value:r.email,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Email",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(h2,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"tel",name:"phone_number",value:r.phone_number,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Numro de tlphone",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(di,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"password",name:"password",value:r.password,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(di,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Confirmer le mot de passe",required:!0})]}),d.jsx("div",{children:d.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:o?"Inscription en cours...":"S'inscrire"})}),d.jsx("div",{className:"text-center",children:d.jsxs("p",{className:"text-sm text-gray-600",children:["Dj un compte ?"," ",d.jsx(uc,{to:"/login",className:"font-medium text-purple-600 hover:text-purple-500",children:"Se connecter"})]})})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}const Cb=({onLogout:e})=>{const t=qa(),[r,n]=C.useState({main:!0,firewall:!0,tools:!0}),a=l=>{n(u=>({...u,[l]:!u[l]}))},i=l=>t.pathname===l,o=[{title:"Main",items:[{path:"/",icon:fb,label:"Tableau de bord"},{path:"/profile",icon:us,label:"Profile"}]},{title:"crer dc/fw",items:[{path:"/settings",icon:vb,label:"Paramtres"}]},{title:"ma carte",items:[{path:"/map",icon:hb,label:"Carte de devices"}]},{title:"Firewall",items:[{path:"/templates",icon:f2,label:"Templates des configurations"},{path:"/daily-check",icon:uf,label:"Daily Check"},{path:"/config",icon:ub,label:"Sauvegarde commande firewall"},{path:"/matrix",icon:u2,label:"Configuration dynamique firewall"}]},{title:"Tools",items:[{path:"/history",icon:uf,label:"Historique"},{path:"/firewalls",icon:Ni,label:"Pare-feux"}]}];return d.jsxs("div",{className:"w-64 bg-purple-900 text-white p-6 h-screen flex flex-col",children:[d.jsxs("div",{className:"flex items-center space-x-2 mb-8",children:[d.jsx(_b,{className:"h-6 w-6"}),d.jsx("h1",{className:"text-2xl font-bold",children:"INWI"})]}),d.jsx("nav",{className:"space-y-6 flex-grow overflow-y-auto custom-sidebar-scrollbar",children:o.map(l=>d.jsxs("div",{className:"space-y-2",children:[d.jsxs("button",{onClick:()=>a(l.title.toLowerCase()),className:"flex items-center justify-between w-full p-2 rounded-lg hover:bg-purple-800",children:[d.jsx("span",{className:"font-semibold",children:l.title}),r[l.title.toLowerCase()]?d.jsx(cf,{className:"h-4 w-4"}):d.jsx(wh,{className:"h-4 w-4"})]}),r[l.title.toLowerCase()]&&d.jsx("div",{className:"space-y-1 pl-2",children:l.items.map(u=>{const f=u.icon;return d.jsxs(uc,{to:u.path,className:`flex items-center space-x-2 w-full p-2 rounded-lg transition-colors duration-200 ${i(u.path)?"bg-purple-700 text-white":"hover:bg-purple-800 text-purple-100"}`,children:[d.jsx(f,{className:"h-5 w-5"}),d.jsx("span",{children:u.label})]},u.path)})})]},l.title))}),d.jsxs("button",{onClick:e,className:"flex items-center space-x-2 w-full p-2 rounded-lg hover:bg-purple-800 mt-auto",children:[d.jsx(db,{className:"h-5 w-5"}),d.jsx("span",{children:"Logout"})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var x2=1252,bb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Zp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Gp=function(e){bb.indexOf(e)!=-1&&(x2=Zp[0]=e)};function Nb(){Gp(1252)}var qn=function(e){Gp(e)};function v2(){qn(1200),Nb()}function Gx(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Ab(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function _2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var al=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Ab(e.slice(2)):t==254&&r==255?_2(e.slice(2)):t==65279?e.slice(1):e},nu=function(t){return String.fromCharCode(t)},Xx=function(t){return String.fromCharCode(t)},oi,hi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qx(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),i=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,a=e.charCodeAt(f++),l=(n&15)<<2|a>>6,u=a&63,isNaN(n)?l=u=64:isNaN(a)&&(u=64),t+=hi.charAt(i)+hi.charAt(o)+hi.charAt(l)+hi.charAt(u);return t}function vn(e){var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=hi.indexOf(e.charAt(f++)),o=hi.indexOf(e.charAt(f++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=hi.indexOf(e.charAt(f++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=hi.indexOf(e.charAt(f++)),a=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),xs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ai(e){return vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Kx(e){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Xn=function(t){return vt?xs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function vs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Xp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Xp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var li=vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Lb(e){for(var t=[],r=0,n=e.length+250,a=Ai(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ai(65535),n=65530)}return t.push(a.slice(0,r)),li(t)}var Gr=/\u0000/g,il=/[\u0001-\u0006]/g;function so(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Kn(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}function qp(e,t){var r=""+e;return r.length>=t?r:Xt(" ",t-r.length)+r}function df(e,t){var r=""+e;return r.length>=t?r:r+Xt(" ",t-r.length)}function Fb(e,t){var r=""+Math.round(e);return r.length>=t?r:Xt("0",t-r.length)+r}function Pb(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}var Yx=Math.pow(2,32);function Rs(e,t){if(e>Yx||e<-Yx)return Fb(e,t);var r=Math.round(e);return Pb(r,t)}function hf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Jx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ob(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Qx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Rb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pf(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,u=1,f=0,h=0,m=Math.floor(a);f<t&&(m=Math.floor(a),l=m*o+i,h=m*f+u,!(a-m<5e-8));)a=1/(a-m),i=o,o=l,u=f,f=h;if(h>t&&(f>t?(h=u,l=i):(h=f,l=o)),!r)return[0,n*l,h];var g=Math.floor(n*l/h);return[g,n*l-g*h,h]}function Yi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=zb(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var y2=new Date(1899,11,31,0,0,0),Mb=y2.getTime(),Ib=new Date(1900,2,1,0,0,0);function w2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Ib&&(r+=24*60*60*1e3),(r-(Mb+(e.getTimezoneOffset()-y2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Kp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Db(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jb(e){var t=e<0?12:11,r=Kp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Bb(e){var t=Kp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Xl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jb(e):t===10?r=e.toFixed(10).substr(0,12):r=Bb(e),Kp(Db(r.toUpperCase()))}function fs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Xl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dn(14,w2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function zb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Ub(e,t,r,n){var a="",i=0,o=0,l=r.y,u,f=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return sd[r.m-1][1];case 5:return sd[r.m-1][0];default:return sd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return Jx[r.q][0];default:return Jx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Kn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=Kn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var h=f>0?Kn(u,f):"";return h}function pi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var k2=/%/g;function Hb(e,t,r){var n=t.replace(k2,""),a=t.length-n.length;return Ba(e,n,r*Math.pow(10,2*a))+Xt("%",a)}function Vb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ba(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function E2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+E2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,h){return u+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var S2=/# (\?+)( ?)\/( ?)(\d+)/;function $b(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?Xt(" ",e[1].length+1+e[4].length):qp(o,e[1].length)+e[2]+"/"+e[3]+Kn(l,e[4].length))}function Wb(e,t,r){return r+(t===0?"":""+t)+Xt(" ",e[1].length+2+e[4].length)}var T2=/^#*0*\.([0#]+)/,C2=/\).*[0#]/,b2=/\(###\) ###\\?-####/;function Hr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function e1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function t1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Zb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Gb(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Tn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(C2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tn("n",n,r):"("+Tn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Vb(e,t,r);if(t.indexOf("%")!==-1)return Hb(e,t,r);if(t.indexOf("E")!==-1)return E2(t,r);if(t.charCodeAt(0)===36)return"$"+Tn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Rs(u,t.length);if(t.match(/^[#?]+$/))return a=Rs(r,0),a==="0"&&(a=""),a.length>t.length?a:Hr(t.substr(0,t.length-a.length))+a;if(i=t.match(S2))return $b(i,u,f);if(t.match(/^#+0+$/))return f+Rs(u,t.length-t.indexOf("0"));if(i=t.match(T2))return a=e1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Hr(i[1])).replace(/\.$/,"."+Hr(i[1])).replace(/\.(\d*)$/,function(_,y){return"."+y+Xt("0",Hr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+e1(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+pi(Rs(u,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tn(e,t,-r):pi(""+(Math.floor(r)+Zb(r,i[1].length)))+"."+Kn(t1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Tn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=so(Tn(e,t.replace(/[\\-]/g,""),r)),o=0,so(so(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<a.length?a.charAt(o++):_==="0"?"0":""}));if(t.match(b2))return a=Tn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=pf(u,Math.pow(10,o)-1,!1),a=""+f,h=Ba("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=df(l[2],o),h.length<i[4].length&&(h=Hr(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=pf(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?qp(l[1],o)+i[2]+"/"+i[3]+df(l[2],o):Xt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Rs(r,0),t.length<=a.length?a:Hr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return Hr(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=t1(r,i[1].length),r<0?"-"+Tn(e,t,-r):pi(Gb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Kn(0,3-_.length):"")+_})+"."+Kn(o,i[1].length);switch(t){case"###,##0.00":return Tn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=pi(Rs(u,0));return x!=="0"?f+x:"";case"###,###.00":return Tn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Xb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ba(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function qb(e,t,r){var n=t.replace(k2,""),a=t.length-n.length;return Ba(e,n,r*Math.pow(10,2*a))+Xt("%",a)}function N2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+N2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,h){return u+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ha(e,t,r){if(e.charCodeAt(0)===40&&!t.match(C2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ha("n",n,r):"("+ha("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Xb(e,t,r);if(t.indexOf("%")!==-1)return qb(e,t,r);if(t.indexOf("E")!==-1)return N2(t,r);if(t.charCodeAt(0)===36)return"$"+ha(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Kn(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Hr(t.substr(0,t.length-a.length))+a;if(i=t.match(S2))return Wb(i,u,f);if(t.match(/^#+0+$/))return f+Kn(u,t.length-t.indexOf("0"));if(i=t.match(T2))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Hr(i[1])).replace(/\.$/,"."+Hr(i[1])),a=a.replace(/\.(\d*)$/,function(_,y){return"."+y+Xt("0",Hr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+pi(""+u);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ha(e,t,-r):pi(""+r)+"."+Xt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ha(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=so(ha(e,t.replace(/[\\-]/g,""),r)),o=0,so(so(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<a.length?a.charAt(o++):_==="0"?"0":""}));if(t.match(b2))return a=ha(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=pf(u,Math.pow(10,o)-1,!1),a=""+f,h=Ba("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=df(l[2],o),h.length<i[4].length&&(h=Hr(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=pf(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?qp(l[1],o)+i[2]+"/"+i[3]+df(l[2],o):Xt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Hr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return Hr(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ha(e,t,-r):pi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Kn(0,3-_.length):"")+_})+"."+Kn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=pi(""+u);return x!=="0"?f+x:"";default:if(t.match(/\.[0#?]*$/))return ha(e,t.slice(0,t.lastIndexOf(".")),r)+Hr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ba(e,t,r){return(r|0)===r?ha(e,t,r):Tn(e,t,r)}function Kb(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var A2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function No(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":hf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(A2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Yb(e,t,r,n){for(var a=[],i="",o=0,l="",u="t",f,h,m,g="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!hf(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++o;break;case"\\":var x=e.charAt(++o),_=x==="("||x===")"?x:"t";a[a.length]={t:_,v:x},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=Yi(t,r,e.charAt(o+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Yi(t,r),f==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),a[a.length]={t:l,v:i},u=l;break;case"A":case"a":case"":var y={t:l,v:l};if(f==null&&(f=Yi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",o+=5,g="h"):(y.t="t",++o),f==null&&y.t==="T")return"";a[a.length]=y,u=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(A2)){if(f==null&&(f=Yi(t,r),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",No(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var S=0,k=0,E;for(o=a.length-1,u="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=g,u="h",S<1&&(S=1);break;case"s":(E=a[o].v.match(/\.0+$/))&&(k=Math.max(k,E[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":u=a[o].t;break;case"m":u==="s"&&(a[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[o].v.match(/[Hh]/)&&(S=1),S<2&&a[o].v.match(/[Mm]/)&&(S=2),S<3&&a[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var w="",F;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=Ub(a[o].t.charCodeAt(0),a[o].v,f,k),a[o].t="t";break;case"n":case"?":for(F=o+1;a[F]!=null&&((l=a[F].t)==="?"||l==="D"||(l===" "||l==="t")&&a[F+1]!=null&&(a[F+1].t==="?"||a[F+1].t==="t"&&a[F+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[F].v==="/"||a[F].v===" "&&a[F+1]!=null&&a[F+1].t=="?"));)a[o].v+=a[F].v,a[F]={v:"",t:";"},++F;w+=a[o].v,o=F-1;break;case"G":a[o].t="t",a[o].v=fs(t,r);break}var j="",D,A;if(w.length>0){w.charCodeAt(0)==40?(D=t<0&&w.charCodeAt(0)===45?-t:t,A=Ba("n",w,D)):(D=t<0&&n>1?-t:t,A=Ba("n",w,D),D<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),F=A.length-1;var M=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){M=o;break}var O=a.length;if(M===a.length&&A.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(F>=a[o].v.length-1?(F-=a[o].v.length,a[o].v=A.substr(F+1,a[o].v.length)):F<0?a[o].v="":(a[o].v=A.substr(0,F+1),F=-1),a[o].t="t",O=o);F>=0&&O<a.length&&(a[O].v=A.substr(0,F+1)+a[O].v)}else if(M!==a.length&&A.indexOf("E")===-1){for(F=A.indexOf(".")-1,o=M;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(h=a[o].v.indexOf(".")>-1&&o===M?a[o].v.indexOf(".")-1:a[o].v.length-1,j=a[o].v.substr(h+1);h>=0;--h)F>=0&&(a[o].v.charAt(h)==="0"||a[o].v.charAt(h)==="#")&&(j=A.charAt(F--)+j);a[o].v=j,a[o].t="t",O=o}for(F>=0&&O<a.length&&(a[O].v=A.substr(0,F+1)+a[O].v),F=A.indexOf(".")+1,o=M;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==M)){for(h=a[o].v.indexOf(".")>-1&&o===M?a[o].v.indexOf(".")+1:0,j=a[o].v.substr(0,h);h<a[o].v.length;++h)F<A.length&&(j+=A.charAt(F++));a[o].v=j,a[o].t="t",O=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(D=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Ba(a[o].t,a[o].v,D),a[o].t="t");var G="";for(o=0;o!==a.length;++o)a[o]!=null&&(G+=a[o].v);return G}var r1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function n1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Jb(e,t){var r=Kb(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(r1),l=r[1].match(r1);return n1(t,o)?[n,r[0]]:n1(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function Dn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[e],n==null&&(n=r.table&&r.table[Qx[e]]||nt[Qx[e]]),n==null&&(n=Rb[e]||"General");break}if(hf(n,0))return fs(t,r);t instanceof Date&&(t=w2(t,r.date1904));var a=Jb(n,t);if(hf(a[1]))return fs(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Yb(a[1],t,r,a[0])}function rs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nt[r]==null){t<0&&(t=r);continue}if(nt[r]==e){t=r;break}}t<0&&(t=391)}return nt[t]=e,t}function L2(){nt=Ob()}var Qb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},F2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eN(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(F2,"(\\d+)"),new RegExp("^"+t+"$")}function tN(e,t,r){var n=-1,a=-1,i=-1,o=-1,l=-1,u=-1;(t.match(F2)||[]).forEach(function(m,g){var x=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=x;break;case"d":i=x;break;case"h":o=x;break;case"s":u=x;break;case"m":o>=0?l=x:a=x;break}}),u>=0&&l==-1&&a>=0&&(l=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?f:n==-1&&a==-1&&i==-1?h:f+"T"+h}var rN=function(){var e={};e.version="1.2.0";function t(){for(var A=0,M=new Array(256),O=0;O!=256;++O)A=O,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,M[O]=A;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(A){var M=0,O=0,G=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)H[G]=A[G];for(G=0;G!=256;++G)for(O=A[G],M=256+G;M<4096;M+=256)O=H[M]=O>>>8^A[O&255];var W=[];for(G=1;G!=16;++G)W[G-1]=typeof Int32Array<"u"?H.subarray(G*256,G*256+256):H.slice(G*256,G*256+256);return W}var a=n(r),i=a[0],o=a[1],l=a[2],u=a[3],f=a[4],h=a[5],m=a[6],g=a[7],x=a[8],_=a[9],y=a[10],S=a[11],k=a[12],E=a[13],w=a[14];function F(A,M){for(var O=M^-1,G=0,H=A.length;G<H;)O=O>>>8^r[(O^A.charCodeAt(G++))&255];return~O}function j(A,M){for(var O=M^-1,G=A.length-15,H=0;H<G;)O=w[A[H++]^O&255]^E[A[H++]^O>>8&255]^k[A[H++]^O>>16&255]^S[A[H++]^O>>>24]^y[A[H++]]^_[A[H++]]^x[A[H++]]^g[A[H++]]^m[A[H++]]^h[A[H++]]^f[A[H++]]^u[A[H++]]^l[A[H++]]^o[A[H++]]^i[A[H++]]^r[A[H++]];for(G+=15;H<G;)O=O>>>8^r[(O^A[H++])&255];return~O}function D(A,M){for(var O=M^-1,G=0,H=A.length,W=0,fe=0;G<H;)W=A.charCodeAt(G++),W<128?O=O>>>8^r[(O^W)&255]:W<2048?(O=O>>>8^r[(O^(192|W>>6&31))&255],O=O>>>8^r[(O^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,fe=A.charCodeAt(G++)&1023,O=O>>>8^r[(O^(240|W>>8&7))&255],O=O>>>8^r[(O^(128|W>>2&63))&255],O=O>>>8^r[(O^(128|fe>>6&15|(W&3)<<4))&255],O=O>>>8^r[(O^(128|fe&63))&255]):(O=O>>>8^r[(O^(224|W>>12&15))&255],O=O>>>8^r[(O^(128|W>>6&63))&255],O=O>>>8^r[(O^(128|W&63))&255]);return~O}return e.table=r,e.bstr=F,e.buf=j,e.str=D,e}(),yt=function(){var t={};t.version="1.2.1";function r(b,I){for(var P=b.split("/"),B=I.split("/"),z=0,U=0,ee=Math.min(P.length,B.length);z<ee;++z){if(U=P[z].length-B[z].length)return U;if(P[z]!=B[z])return P[z]<B[z]?-1:1}return P.length-B.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var I=b.lastIndexOf("/");return I===-1?b:b.slice(0,I+1)}function a(b){if(b.charAt(b.length-1)=="/")return a(b.slice(0,-1));var I=b.lastIndexOf("/");return I===-1?b:b.slice(I+1)}function i(b,I){typeof I=="string"&&(I=new Date(I));var P=I.getHours();P=P<<6|I.getMinutes(),P=P<<5|I.getSeconds()>>>1,b.write_shift(2,P);var B=I.getFullYear()-1980;B=B<<4|I.getMonth()+1,B=B<<5|I.getDate(),b.write_shift(2,B)}function o(b){var I=b.read_shift(2)&65535,P=b.read_shift(2)&65535,B=new Date,z=P&31;P>>>=5;var U=P&15;P>>>=4,B.setMilliseconds(0),B.setFullYear(P+1980),B.setMonth(U-1),B.setDate(z);var ee=I&31;I>>>=5;var me=I&63;return I>>>=6,B.setHours(I),B.setMinutes(me),B.setSeconds(ee<<1),B}function l(b){wr(b,0);for(var I={},P=0;b.l<=b.length-4;){var B=b.read_shift(2),z=b.read_shift(2),U=b.l+z,ee={};switch(B){case 21589:P=b.read_shift(1),P&1&&(ee.mtime=b.read_shift(4)),z>5&&(P&2&&(ee.atime=b.read_shift(4)),P&4&&(ee.ctime=b.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}b.l=U,I[B]=ee}return I}var u;function f(){return u||(u={})}function h(b,I){if(b[0]==80&&b[1]==75)return ft(b,I);if((b[0]|32)==109&&(b[1]|32)==105)return xt(b,I);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var P=3,B=512,z=0,U=0,ee=0,me=0,ne=0,se=[],oe=b.slice(0,512);wr(oe,0);var ke=m(oe);switch(P=ke[0],P){case 3:B=512;break;case 4:B=4096;break;case 0:if(ke[1]==0)return ft(b,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}B!==512&&(oe=b.slice(0,B),wr(oe,28));var Le=b.slice(0,B);g(oe,P);var Ie=oe.read_shift(4,"i");if(P===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);oe.l+=4,ee=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),me=oe.read_shift(4,"i"),z=oe.read_shift(4,"i"),ne=oe.read_shift(4,"i"),U=oe.read_shift(4,"i");for(var Ce=-1,Re=0;Re<109&&(Ce=oe.read_shift(4,"i"),!(Ce<0));++Re)se[Re]=Ce;var Ye=x(b,B);S(ne,U,Ye,B,se);var Ot=E(Ye,ee,se,B);Ot[ee].name="!Directory",z>0&&me!==fe&&(Ot[me].name="!MiniFAT"),Ot[se[0]].name="!FAT",Ot.fat_addrs=se,Ot.ssz=B;var Rt={},hr=[],Ea=[],Bn=[];w(ee,Ot,Ye,hr,z,Rt,Ea,me),_(Ea,Bn,hr),hr.shift();var Ya={FileIndex:Ea,FullPaths:Bn};return I&&I.raw&&(Ya.raw={header:Le,sectors:Ye}),Ya}function m(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(Se,"Header Signature: "),b.l+=16;var I=b.read_shift(2,"u");return[b.read_shift(2,"u"),I]}function g(b,I){var P=9;switch(b.l+=2,P=b.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function x(b,I){for(var P=Math.ceil(b.length/I)-1,B=[],z=1;z<P;++z)B[z-1]=b.slice(z*I,(z+1)*I);return B[P-1]=b.slice(P*I),B}function _(b,I,P){for(var B=0,z=0,U=0,ee=0,me=0,ne=P.length,se=[],oe=[];B<ne;++B)se[B]=oe[B]=B,I[B]=P[B];for(;me<oe.length;++me)B=oe[me],z=b[B].L,U=b[B].R,ee=b[B].C,se[B]===B&&(z!==-1&&se[z]!==z&&(se[B]=se[z]),U!==-1&&se[U]!==U&&(se[B]=se[U])),ee!==-1&&(se[ee]=B),z!==-1&&B!=se[B]&&(se[z]=se[B],oe.lastIndexOf(z)<me&&oe.push(z)),U!==-1&&B!=se[B]&&(se[U]=se[B],oe.lastIndexOf(U)<me&&oe.push(U));for(B=1;B<ne;++B)se[B]===B&&(U!==-1&&se[U]!==U?se[B]=se[U]:z!==-1&&se[z]!==z&&(se[B]=se[z]));for(B=1;B<ne;++B)if(b[B].type!==0){if(me=B,me!=se[me])do me=se[me],I[B]=I[me]+"/"+I[B];while(me!==0&&se[me]!==-1&&me!=se[me]);se[B]=-1}for(I[0]+="/",B=1;B<ne;++B)b[B].type!==2&&(I[B]+="/")}function y(b,I,P){for(var B=b.start,z=b.size,U=[],ee=B;P&&z>0&&ee>=0;)U.push(I.slice(ee*W,ee*W+W)),z-=W,ee=Wi(P,ee*4);return U.length===0?lr(0):li(U).slice(0,b.size)}function S(b,I,P,B,z){var U=fe;if(b===fe){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ee=P[b],me=(B>>>2)-1;if(!ee)return;for(var ne=0;ne<me&&(U=Wi(ee,ne*4))!==fe;++ne)z.push(U);S(Wi(ee,B-4),I-1,P,B,z)}}function k(b,I,P,B,z){var U=[],ee=[];z||(z=[]);var me=B-1,ne=0,se=0;for(ne=I;ne>=0;){z[ne]=!0,U[U.length]=ne,ee.push(b[ne]);var oe=P[Math.floor(ne*4/B)];if(se=ne*4&me,B<4+se)throw new Error("FAT boundary crossed: "+ne+" 4 "+B);if(!b[oe])break;ne=Wi(b[oe],se)}return{nodes:U,data:h1([ee])}}function E(b,I,P,B){var z=b.length,U=[],ee=[],me=[],ne=[],se=B-1,oe=0,ke=0,Le=0,Ie=0;for(oe=0;oe<z;++oe)if(me=[],Le=oe+I,Le>=z&&(Le-=z),!ee[Le]){ne=[];var Ce=[];for(ke=Le;ke>=0;){Ce[ke]=!0,ee[ke]=!0,me[me.length]=ke,ne.push(b[ke]);var Re=P[Math.floor(ke*4/B)];if(Ie=ke*4&se,B<4+Ie)throw new Error("FAT boundary crossed: "+ke+" 4 "+B);if(!b[Re]||(ke=Wi(b[Re],Ie),Ce[ke]))break}U[Le]={nodes:me,data:h1([ne])}}return U}function w(b,I,P,B,z,U,ee,me){for(var ne=0,se=B.length?2:0,oe=I[b].data,ke=0,Le=0,Ie;ke<oe.length;ke+=128){var Ce=oe.slice(ke,ke+128);wr(Ce,64),Le=Ce.read_shift(2),Ie=tm(Ce,0,Le-se),B.push(Ie);var Re={name:Ie,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},Ye=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Ye!==0&&(Re.ct=F(Ce,Ce.l-8));var Ot=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Ot!==0&&(Re.mt=F(Ce,Ce.l-8)),Re.start=Ce.read_shift(4,"i"),Re.size=Ce.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=fe,Re.name=""),Re.type===5?(ne=Re.start,z>0&&ne!==fe&&(I[ne].name="!StreamData")):Re.size>=4096?(Re.storage="fat",I[Re.start]===void 0&&(I[Re.start]=k(P,Re.start,I.fat_addrs,I.ssz)),I[Re.start].name=Re.name,Re.content=I[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:ne!==fe&&Re.start!==fe&&I[ne]&&(Re.content=y(Re,I[ne].data,(I[me]||{}).data))),Re.content&&wr(Re.content,0),U[Ie]=Re,ee.push(Re)}}function F(b,I){return new Date((dn(b,I+4)/1e7*Math.pow(2,32)+dn(b,I)/1e7-11644473600)*1e3)}function j(b,I){return f(),h(u.readFileSync(b),I)}function D(b,I){var P=I&&I.type;switch(P||vt&&Buffer.isBuffer(b)&&(P="buffer"),P||"base64"){case"file":return j(b,I);case"base64":return h(Xn(vn(b)),I);case"binary":return h(Xn(b),I)}return h(b,I)}function A(b,I){var P=I||{},B=P.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=B+"/",b.FileIndex[0]={name:B,type:5}),P.CLSID&&(b.FileIndex[0].clsid=P.CLSID),M(b)}function M(b){var I="Sh33tJ5";if(!yt.find(b,"/"+I)){var P=lr(4);P[0]=55,P[1]=P[3]=50,P[2]=54,b.FileIndex.push({name:I,type:2,content:P,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+I),O(b)}}function O(b,I){A(b);for(var P=!1,B=!1,z=b.FullPaths.length-1;z>=0;--z){var U=b.FileIndex[z];switch(U.type){case 0:B?P=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(U.R*U.L*U.C)&&(P=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!I)){var ee=new Date(1987,1,19),me=0,ne=Object.create?Object.create(null):{},se=[];for(z=0;z<b.FullPaths.length;++z)ne[b.FullPaths[z]]=!0,b.FileIndex[z].type!==0&&se.push([b.FullPaths[z],b.FileIndex[z]]);for(z=0;z<se.length;++z){var oe=n(se[z][0]);B=ne[oe],B||(se.push([oe,{name:a(oe).replace("/",""),type:1,clsid:Y,ct:ee,mt:ee,content:null}]),ne[oe]=!0)}for(se.sort(function(Ie,Ce){return r(Ie[0],Ce[0])}),b.FullPaths=[],b.FileIndex=[],z=0;z<se.length;++z)b.FullPaths[z]=se[z][0],b.FileIndex[z]=se[z][1];for(z=0;z<se.length;++z){var ke=b.FileIndex[z],Le=b.FullPaths[z];if(ke.name=a(Le).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||Y,z===0)ke.C=se.length>1?1:-1,ke.size=0,ke.type=5;else if(Le.slice(-1)=="/"){for(me=z+1;me<se.length&&n(b.FullPaths[me])!=Le;++me);for(ke.C=me>=se.length?-1:me,me=z+1;me<se.length&&n(b.FullPaths[me])!=n(Le);++me);ke.R=me>=se.length?-1:me,ke.type=1}else n(b.FullPaths[z+1]||"")==n(Le)&&(ke.R=z+1),ke.type=2}}}function G(b,I){var P=I||{};if(P.fileType=="mad")return bt(b,P);switch(O(b),P.fileType){case"zip":return or(b,P)}var B=function(Ie){for(var Ce=0,Re=0,Ye=0;Ye<Ie.FileIndex.length;++Ye){var Ot=Ie.FileIndex[Ye];if(Ot.content){var Rt=Ot.content.length;Rt>0&&(Rt<4096?Ce+=Rt+63>>6:Re+=Rt+511>>9)}}for(var hr=Ie.FullPaths.length+3>>2,Ea=Ce+7>>3,Bn=Ce+127>>7,Ya=Ea+Re+hr+Bn,sa=Ya+127>>7,Sa=sa<=109?0:Math.ceil((sa-109)/127);Ya+sa+Sa+127>>7>sa;)Sa=++sa<=109?0:Math.ceil((sa-109)/127);var tt=[1,Sa,sa,Bn,hr,Re,Ce,0];return Ie.FileIndex[0].size=Ce<<6,tt[7]=(Ie.FileIndex[0].start=tt[0]+tt[1]+tt[2]+tt[3]+tt[4]+tt[5])+(tt[6]+7>>3),tt}(b),z=lr(B[7]<<9),U=0,ee=0;{for(U=0;U<8;++U)z.write_shift(1,le[U]);for(U=0;U<8;++U)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),U=0;U<3;++U)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,B[2]),z.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:fe),z.write_shift(4,B[3]),z.write_shift(-4,B[1]?B[0]-1:fe),z.write_shift(4,B[1]),U=0;U<109;++U)z.write_shift(-4,U<B[2]?B[1]+U:-1)}if(B[1])for(ee=0;ee<B[1];++ee){for(;U<236+ee*127;++U)z.write_shift(-4,U<B[2]?B[1]+U:-1);z.write_shift(-4,ee===B[1]-1?fe:ee+1)}var me=function(Ie){for(ee+=Ie;U<ee-1;++U)z.write_shift(-4,U+1);Ie&&(++U,z.write_shift(-4,fe))};for(ee=U=0,ee+=B[1];U<ee;++U)z.write_shift(-4,xe.DIFSECT);for(ee+=B[2];U<ee;++U)z.write_shift(-4,xe.FATSECT);me(B[3]),me(B[4]);for(var ne=0,se=0,oe=b.FileIndex[0];ne<b.FileIndex.length;++ne)oe=b.FileIndex[ne],oe.content&&(se=oe.content.length,!(se<4096)&&(oe.start=ee,me(se+511>>9)));for(me(B[6]+7>>3);z.l&511;)z.write_shift(-4,xe.ENDOFCHAIN);for(ee=U=0,ne=0;ne<b.FileIndex.length;++ne)oe=b.FileIndex[ne],oe.content&&(se=oe.content.length,!(!se||se>=4096)&&(oe.start=ee,me(se+63>>6)));for(;z.l&511;)z.write_shift(-4,xe.ENDOFCHAIN);for(U=0;U<B[4]<<2;++U){var ke=b.FullPaths[U];if(!ke||ke.length===0){for(ne=0;ne<17;++ne)z.write_shift(4,0);for(ne=0;ne<3;++ne)z.write_shift(4,-1);for(ne=0;ne<12;++ne)z.write_shift(4,0);continue}oe=b.FileIndex[U],U===0&&(oe.start=oe.size?oe.start-1:fe);var Le=U===0&&P.root||oe.name;if(se=2*(Le.length+1),z.write_shift(64,Le,"utf16le"),z.write_shift(2,se),z.write_shift(1,oe.type),z.write_shift(1,oe.color),z.write_shift(-4,oe.L),z.write_shift(-4,oe.R),z.write_shift(-4,oe.C),oe.clsid)z.write_shift(16,oe.clsid,"hex");else for(ne=0;ne<4;++ne)z.write_shift(4,0);z.write_shift(4,oe.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,oe.start),z.write_shift(4,oe.size),z.write_shift(4,0)}for(U=1;U<b.FileIndex.length;++U)if(oe=b.FileIndex[U],oe.size>=4096)if(z.l=oe.start+1<<9,vt&&Buffer.isBuffer(oe.content))oe.content.copy(z,z.l,0,oe.size),z.l+=oe.size+511&-512;else{for(ne=0;ne<oe.size;++ne)z.write_shift(1,oe.content[ne]);for(;ne&511;++ne)z.write_shift(1,0)}for(U=1;U<b.FileIndex.length;++U)if(oe=b.FileIndex[U],oe.size>0&&oe.size<4096)if(vt&&Buffer.isBuffer(oe.content))oe.content.copy(z,z.l,0,oe.size),z.l+=oe.size+63&-64;else{for(ne=0;ne<oe.size;++ne)z.write_shift(1,oe.content[ne]);for(;ne&63;++ne)z.write_shift(1,0)}if(vt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function H(b,I){var P=b.FullPaths.map(function(ne){return ne.toUpperCase()}),B=P.map(function(ne){var se=ne.split("/");return se[se.length-(ne.slice(-1)=="/"?2:1)]}),z=!1;I.charCodeAt(0)===47?(z=!0,I=P[0].slice(0,-1)+I):z=I.indexOf("/")!==-1;var U=I.toUpperCase(),ee=z===!0?P.indexOf(U):B.indexOf(U);if(ee!==-1)return b.FileIndex[ee];var me=!U.match(il);for(U=U.replace(Gr,""),me&&(U=U.replace(il,"!")),ee=0;ee<P.length;++ee)if((me?P[ee].replace(il,"!"):P[ee]).replace(Gr,"")==U||(me?B[ee].replace(il,"!"):B[ee]).replace(Gr,"")==U)return b.FileIndex[ee];return null}var W=64,fe=-2,Se="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:fe,FREESECT:-1,HEADER_SIGNATURE:Se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(b,I,P){f();var B=G(b,P);u.writeFileSync(I,B)}function K(b){for(var I=new Array(b.length),P=0;P<b.length;++P)I[P]=String.fromCharCode(b[P]);return I.join("")}function ie(b,I){var P=G(b,I);switch(I&&I.type||"buffer"){case"file":return f(),u.writeFileSync(I.filename,P),P;case"binary":return typeof P=="string"?P:K(P);case"base64":return qx(typeof P=="string"?P:K(P));case"buffer":if(vt)return Buffer.isBuffer(P)?P:xs(P);case"array":return typeof P=="string"?Xn(P):P}return P}var he;function R(b){try{var I=b.InflateRaw,P=new I;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)he=b;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function J(b,I){if(!he)return Ke(b,I);var P=he.InflateRaw,B=new P,z=B._processChunk(b.slice(b.l),B._finishFlushFlag);return b.l+=B.bytesRead,z}function q(b){return he?he.deflateRawSync(b):He(b)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(b){var I=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(I>>16|I>>8|I)&255}for(var be=typeof Uint8Array<"u",_e=be?new Uint8Array(256):[],Be=0;Be<256;++Be)_e[Be]=Fe(Be);function V(b,I){var P=_e[b&255];return I<=8?P>>>8-I:(P=P<<8|_e[b>>8&255],I<=16?P>>>16-I:(P=P<<8|_e[b>>16&255],P>>>24-I))}function qe(b,I){var P=I&7,B=I>>>3;return(b[B]|(P<=6?0:b[B+1]<<8))>>>P&3}function it(b,I){var P=I&7,B=I>>>3;return(b[B]|(P<=5?0:b[B+1]<<8))>>>P&7}function ot(b,I){var P=I&7,B=I>>>3;return(b[B]|(P<=4?0:b[B+1]<<8))>>>P&15}function Xe(b,I){var P=I&7,B=I>>>3;return(b[B]|(P<=3?0:b[B+1]<<8))>>>P&31}function Ne(b,I){var P=I&7,B=I>>>3;return(b[B]|(P<=1?0:b[B+1]<<8))>>>P&127}function St(b,I,P){var B=I&7,z=I>>>3,U=(1<<P)-1,ee=b[z]>>>B;return P<8-B||(ee|=b[z+1]<<8-B,P<16-B)||(ee|=b[z+2]<<16-B,P<24-B)||(ee|=b[z+3]<<24-B),ee&U}function Wt(b,I,P){var B=I&7,z=I>>>3;return B<=5?b[z]|=(P&7)<<B:(b[z]|=P<<B&255,b[z+1]=(P&7)>>8-B),I+3}function pe(b,I,P){var B=I&7,z=I>>>3;return P=(P&1)<<B,b[z]|=P,I+1}function Ae(b,I,P){var B=I&7,z=I>>>3;return P<<=B,b[z]|=P&255,P>>>=8,b[z+1]=P,I+8}function Pe(b,I,P){var B=I&7,z=I>>>3;return P<<=B,b[z]|=P&255,P>>>=8,b[z+1]=P&255,b[z+2]=P>>>8,I+16}function Ue(b,I){var P=b.length,B=2*P>I?2*P:I+5,z=0;if(P>=I)return b;if(vt){var U=Kx(B);if(b.copy)b.copy(U);else for(;z<b.length;++z)U[z]=b[z];return U}else if(be){var ee=new Uint8Array(B);if(ee.set)ee.set(b);else for(;z<P;++z)ee[z]=b[z];return ee}return b.length=B,b}function et(b){for(var I=new Array(b),P=0;P<b;++P)I[P]=0;return I}function pt(b,I,P){var B=1,z=0,U=0,ee=0,me=0,ne=b.length,se=be?new Uint16Array(32):et(32);for(U=0;U<32;++U)se[U]=0;for(U=ne;U<P;++U)b[U]=0;ne=b.length;var oe=be?new Uint16Array(ne):et(ne);for(U=0;U<ne;++U)se[z=b[U]]++,B<z&&(B=z),oe[U]=0;for(se[0]=0,U=1;U<=B;++U)se[U+16]=me=me+se[U-1]<<1;for(U=0;U<ne;++U)me=b[U],me!=0&&(oe[U]=se[me+16]++);var ke=0;for(U=0;U<ne;++U)if(ke=b[U],ke!=0)for(me=V(oe[U],B)>>B-ke,ee=(1<<B+4-ke)-1;ee>=0;--ee)I[me|ee<<ke]=ke&15|U<<4;return B}var Ze=be?new Uint16Array(512):et(512),Qt=be?new Uint16Array(32):et(32);if(!be){for(var Tt=0;Tt<512;++Tt)Ze[Tt]=0;for(Tt=0;Tt<32;++Tt)Qt[Tt]=0}(function(){for(var b=[],I=0;I<32;I++)b.push(5);pt(b,Qt,32);var P=[];for(I=0;I<=143;I++)P.push(8);for(;I<=255;I++)P.push(9);for(;I<=279;I++)P.push(7);for(;I<=287;I++)P.push(8);pt(P,Ze,288)})();var Bt=function(){for(var I=be?new Uint8Array(32768):[],P=0,B=0;P<ye.length-1;++P)for(;B<ye[P+1];++B)I[B]=P;for(;B<32768;++B)I[B]=29;var z=be?new Uint8Array(259):[];for(P=0,B=0;P<ae.length-1;++P)for(;B<ae[P+1];++B)z[B]=P;function U(me,ne){for(var se=0;se<me.length;){var oe=Math.min(65535,me.length-se),ke=se+oe==me.length;for(ne.write_shift(1,+ke),ne.write_shift(2,oe),ne.write_shift(2,~oe&65535);oe-- >0;)ne[ne.l++]=me[se++]}return ne.l}function ee(me,ne){for(var se=0,oe=0,ke=be?new Uint16Array(32768):[];oe<me.length;){var Le=Math.min(65535,me.length-oe);if(Le<10){for(se=Wt(ne,se,+(oe+Le==me.length)),se&7&&(se+=8-(se&7)),ne.l=se/8|0,ne.write_shift(2,Le),ne.write_shift(2,~Le&65535);Le-- >0;)ne[ne.l++]=me[oe++];se=ne.l*8;continue}se=Wt(ne,se,+(oe+Le==me.length)+2);for(var Ie=0;Le-- >0;){var Ce=me[oe];Ie=(Ie<<5^Ce)&32767;var Re=-1,Ye=0;if((Re=ke[Ie])&&(Re|=oe&-32768,Re>oe&&(Re-=32768),Re<oe))for(;me[Re+Ye]==me[oe+Ye]&&Ye<250;)++Ye;if(Ye>2){Ce=z[Ye],Ce<=22?se=Ae(ne,se,_e[Ce+1]>>1)-1:(Ae(ne,se,3),se+=5,Ae(ne,se,_e[Ce-23]>>5),se+=3);var Ot=Ce<8?0:Ce-4>>2;Ot>0&&(Pe(ne,se,Ye-ae[Ce]),se+=Ot),Ce=I[oe-Re],se=Ae(ne,se,_e[Ce]>>3),se-=3;var Rt=Ce<4?0:Ce-2>>1;Rt>0&&(Pe(ne,se,oe-Re-ye[Ce]),se+=Rt);for(var hr=0;hr<Ye;++hr)ke[Ie]=oe&32767,Ie=(Ie<<5^me[oe])&32767,++oe;Le-=Ye-1}else Ce<=143?Ce=Ce+48:se=pe(ne,se,1),se=Ae(ne,se,_e[Ce]),ke[Ie]=oe&32767,++oe}se=Ae(ne,se,0)-1}return ne.l=(se+7)/8|0,ne.l}return function(ne,se){return ne.length<8?U(ne,se):ee(ne,se)}}();function He(b){var I=lr(50+Math.floor(b.length*1.1)),P=Bt(b,I);return I.slice(0,P)}var ce=be?new Uint16Array(32768):et(32768),ge=be?new Uint16Array(32768):et(32768),Ee=be?new Uint16Array(128):et(128),Oe=1,Ve=1;function Ct(b,I){var P=Xe(b,I)+257;I+=5;var B=Xe(b,I)+1;I+=5;var z=ot(b,I)+4;I+=4;for(var U=0,ee=be?new Uint8Array(19):et(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,se=be?new Uint8Array(8):et(8),oe=be?new Uint8Array(8):et(8),ke=ee.length,Le=0;Le<z;++Le)ee[Z[Le]]=U=it(b,I),ne<U&&(ne=U),se[U]++,I+=3;var Ie=0;for(se[0]=0,Le=1;Le<=ne;++Le)oe[Le]=Ie=Ie+se[Le-1]<<1;for(Le=0;Le<ke;++Le)(Ie=ee[Le])!=0&&(me[Le]=oe[Ie]++);var Ce=0;for(Le=0;Le<ke;++Le)if(Ce=ee[Le],Ce!=0){Ie=_e[me[Le]]>>8-Ce;for(var Re=(1<<7-Ce)-1;Re>=0;--Re)Ee[Ie|Re<<Ce]=Ce&7|Le<<3}var Ye=[];for(ne=1;Ye.length<P+B;)switch(Ie=Ee[Ne(b,I)],I+=Ie&7,Ie>>>=3){case 16:for(U=3+qe(b,I),I+=2,Ie=Ye[Ye.length-1];U-- >0;)Ye.push(Ie);break;case 17:for(U=3+it(b,I),I+=3;U-- >0;)Ye.push(0);break;case 18:for(U=11+Ne(b,I),I+=7;U-- >0;)Ye.push(0);break;default:Ye.push(Ie),ne<Ie&&(ne=Ie);break}var Ot=Ye.slice(0,P),Rt=Ye.slice(P);for(Le=P;Le<286;++Le)Ot[Le]=0;for(Le=B;Le<30;++Le)Rt[Le]=0;return Oe=pt(Ot,ce,286),Ve=pt(Rt,ge,30),I}function lt(b,I){if(b[0]==3&&!(b[1]&3))return[Ai(I),2];for(var P=0,B=0,z=Kx(I||1<<18),U=0,ee=z.length>>>0,me=0,ne=0;!(B&1);){if(B=it(b,P),P+=3,B>>>1)B>>1==1?(me=9,ne=5):(P=Ct(b,P),me=Oe,ne=Ve);else{P&7&&(P+=8-(P&7));var se=b[P>>>3]|b[(P>>>3)+1]<<8;if(P+=32,se>0)for(!I&&ee<U+se&&(z=Ue(z,U+se),ee=z.length);se-- >0;)z[U++]=b[P>>>3],P+=8;continue}for(;;){!I&&ee<U+32767&&(z=Ue(z,U+32767),ee=z.length);var oe=St(b,P,me),ke=B>>>1==1?Ze[oe]:ce[oe];if(P+=ke&15,ke>>>=4,!(ke>>>8&255))z[U++]=ke;else{if(ke==256)break;ke-=257;var Le=ke<8?0:ke-4>>2;Le>5&&(Le=0);var Ie=U+ae[ke];Le>0&&(Ie+=St(b,P,Le),P+=Le),oe=St(b,P,ne),ke=B>>>1==1?Qt[oe]:ge[oe],P+=ke&15,ke>>>=4;var Ce=ke<4?0:ke-2>>1,Re=ye[ke];for(Ce>0&&(Re+=St(b,P,Ce),P+=Ce),!I&&ee<Ie&&(z=Ue(z,Ie+100),ee=z.length);U<Ie;)z[U]=z[U-Re],++U}}}return I?[z,P+7>>>3]:[z.slice(0,U),P+7>>>3]}function Ke(b,I){var P=b.slice(b.l||0),B=lt(P,I);return b.l+=B[1],B[0]}function Je(b,I){if(b)typeof console<"u"&&console.error(I);else throw new Error(I)}function ft(b,I){var P=b;wr(P,0);var B=[],z=[],U={FileIndex:B,FullPaths:z};A(U,{root:I.root});for(var ee=P.length-4;(P[ee]!=80||P[ee+1]!=75||P[ee+2]!=5||P[ee+3]!=6)&&ee>=0;)--ee;P.l=ee+4,P.l+=4;var me=P.read_shift(2);P.l+=6;var ne=P.read_shift(4);for(P.l=ne,ee=0;ee<me;++ee){P.l+=20;var se=P.read_shift(4),oe=P.read_shift(4),ke=P.read_shift(2),Le=P.read_shift(2),Ie=P.read_shift(2);P.l+=8;var Ce=P.read_shift(4),Re=l(P.slice(P.l+ke,P.l+ke+Le));P.l+=ke+Le+Ie;var Ye=P.l;P.l=Ce+4,mt(P,se,oe,U,Re),P.l=Ye}return U}function mt(b,I,P,B,z){b.l+=2;var U=b.read_shift(2),ee=b.read_shift(2),me=o(b);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var ne=b.read_shift(4),se=b.read_shift(4),oe=b.read_shift(4),ke=b.read_shift(2),Le=b.read_shift(2),Ie="",Ce=0;Ce<ke;++Ce)Ie+=String.fromCharCode(b[b.l++]);if(Le){var Re=l(b.slice(b.l,b.l+Le));(Re[21589]||{}).mt&&(me=Re[21589].mt),((z||{})[21589]||{}).mt&&(me=z[21589].mt)}b.l+=Le;var Ye=b.slice(b.l,b.l+se);switch(ee){case 8:Ye=J(b,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var Ot=!1;U&8&&(ne=b.read_shift(4),ne==134695760&&(ne=b.read_shift(4),Ot=!0),se=b.read_shift(4),oe=b.read_shift(4)),se!=I&&Je(Ot,"Bad compressed size: "+I+" != "+se),oe!=P&&Je(Ot,"Bad uncompressed size: "+P+" != "+oe),er(B,Ie,Ye,{unsafe:!0,mt:me})}function or(b,I){var P=I||{},B=[],z=[],U=lr(1),ee=P.compression?8:0,me=0,ne=0,se=0,oe=0,ke=0,Le=b.FullPaths[0],Ie=Le,Ce=b.FileIndex[0],Re=[],Ye=0;for(ne=1;ne<b.FullPaths.length;++ne)if(Ie=b.FullPaths[ne].slice(Le.length),Ce=b.FileIndex[ne],!(!Ce.size||!Ce.content||Ie=="Sh33tJ5")){var Ot=oe,Rt=lr(Ie.length);for(se=0;se<Ie.length;++se)Rt.write_shift(1,Ie.charCodeAt(se)&127);Rt=Rt.slice(0,Rt.l),Re[ke]=rN.buf(Ce.content,0);var hr=Ce.content;ee==8&&(hr=q(hr)),U=lr(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,me),U.write_shift(2,ee),Ce.mt?i(U,Ce.mt):U.write_shift(4,0),U.write_shift(-4,Re[ke]),U.write_shift(4,hr.length),U.write_shift(4,Ce.content.length),U.write_shift(2,Rt.length),U.write_shift(2,0),oe+=U.length,B.push(U),oe+=Rt.length,B.push(Rt),oe+=hr.length,B.push(hr),U=lr(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,me),U.write_shift(2,ee),U.write_shift(4,0),U.write_shift(-4,Re[ke]),U.write_shift(4,hr.length),U.write_shift(4,Ce.content.length),U.write_shift(2,Rt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,Ot),Ye+=U.l,z.push(U),Ye+=Rt.length,z.push(Rt),++ke}return U=lr(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,ke),U.write_shift(2,ke),U.write_shift(4,Ye),U.write_shift(4,oe),U.write_shift(2,0),li([li(B),li(z),U])}var Nt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function st(b,I){if(b.ctype)return b.ctype;var P=b.name||"",B=P.match(/\.([^\.]+)$/);return B&&Nt[B[1]]||I&&(B=(P=I).match(/[\.\\]([^\.\\])+$/),B&&Nt[B[1]])?Nt[B[1]]:"application/octet-stream"}function Q(b){for(var I=qx(b),P=[],B=0;B<I.length;B+=76)P.push(I.slice(B,B+76));return P.join(`\r
`)+`\r
`}function ve(b){var I=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var oe=se.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],B=I.split(`\r
`),z=0;z<B.length;++z){var U=B[z];if(U.length==0){P.push("");continue}for(var ee=0;ee<U.length;){var me=76,ne=U.slice(ee,ee+me);ne.charAt(me-1)=="="?me--:ne.charAt(me-2)=="="?me-=2:ne.charAt(me-3)=="="&&(me-=3),ne=U.slice(ee,ee+me),ee+=me,ee<U.length&&(ne+="="),P.push(ne)}}return P.join(`\r
`)}function ze(b){for(var I=[],P=0;P<b.length;++P){for(var B=b[P];P<=b.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+b[++P];I.push(B)}for(var z=0;z<I.length;++z)I[z]=I[z].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Xn(I.join(`\r
`))}function ct(b,I,P){for(var B="",z="",U="",ee,me=0;me<10;++me){var ne=I[me];if(!ne||ne.match(/^\s*$/))break;var se=ne.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":B=se[2].trim();break;case"content-type":U=se[2].trim();break;case"content-transfer-encoding":z=se[2].trim();break}}switch(++me,z.toLowerCase()){case"base64":ee=Xn(vn(I.slice(me).join("")));break;case"quoted-printable":ee=ze(I.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var oe=er(b,B.slice(P.length),ee,{unsafe:!0});U&&(oe.ctype=U)}function xt(b,I){if(K(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=I&&I.root||"",B=(vt&&Buffer.isBuffer(b)?b.toString("binary"):K(b)).split(`\r
`),z=0,U="";for(z=0;z<B.length;++z)if(U=B[z],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),P||(P=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),U.slice(0,P.length)!=P););var ee=(B[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var me="--"+(ee[1]||""),ne=[],se=[],oe={FileIndex:ne,FullPaths:se};A(oe);var ke,Le=0;for(z=0;z<B.length;++z){var Ie=B[z];Ie!==me&&Ie!==me+"--"||(Le++&&ct(oe,B.slice(ke,z),P),ke=z)}return oe}function bt(b,I){var P=I||{},B=P.boundary||"SheetJS";B="------="+B;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],U=b.FullPaths[0],ee=U,me=b.FileIndex[0],ne=1;ne<b.FullPaths.length;++ne)if(ee=b.FullPaths[ne].slice(U.length),me=b.FileIndex[ne],!(!me.size||!me.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var se=me.content,oe=vt&&Buffer.isBuffer(se)?se.toString("binary"):K(se),ke=0,Le=Math.min(1024,oe.length),Ie=0,Ce=0;Ce<=Le;++Ce)(Ie=oe.charCodeAt(Ce))>=32&&Ie<128&&++ke;var Re=ke>=Le*4/5;z.push(B),z.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+ee),z.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),z.push("Content-Type: "+st(me,ee)),z.push(""),z.push(Re?ve(oe):Q(oe))}return z.push(B+`--\r
`),z.join(`\r
`)}function Zt(b){var I={};return A(I,b),I}function er(b,I,P,B){var z=B&&B.unsafe;z||A(b);var U=!z&&yt.find(b,I);if(!U){var ee=b.FullPaths[0];I.slice(0,ee.length)==ee?ee=I:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+I).replace("//","/")),U={name:a(I),type:2},b.FileIndex.push(U),b.FullPaths.push(ee),z||yt.utils.cfb_gc(b)}return U.content=P,U.size=P?P.length:0,B&&(B.CLSID&&(U.clsid=B.CLSID),B.mt&&(U.mt=B.mt),B.ct&&(U.ct=B.ct)),U}function ia(b,I){A(b);var P=yt.find(b,I);if(P){for(var B=0;B<b.FileIndex.length;++B)if(b.FileIndex[B]==P)return b.FileIndex.splice(B,1),b.FullPaths.splice(B,1),!0}return!1}function Cr(b,I,P){A(b);var B=yt.find(b,I);if(B){for(var z=0;z<b.FileIndex.length;++z)if(b.FileIndex[z]==B)return b.FileIndex[z].name=a(P),b.FullPaths[z]=P,!0}return!1}function De(b){O(b,!0)}return t.find=H,t.read=D,t.parse=h,t.write=ie,t.writeFile=re,t.utils={cfb_new:Zt,cfb_add:er,cfb_del:ia,cfb_mov:Cr,cfb_gc:De,ReadShift:_l,CheckField:Q2,prep_blob:wr,bconcat:li,use_zlib:R,_deflateRaw:He,_inflateRaw:Ke,consts:xe},t}();function nN(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function va(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Yp(e){for(var t=[],r=va(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var mf=new Date(1899,11,30,0,0,0);function Xr(e,t){var r=e.getTime(),n=mf.getTime()+(e.getTimezoneOffset()-mf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var P2=new Date,aN=mf.getTime()+(P2.getTimezoneOffset()-mf.getTimezoneOffset())*6e4,a1=P2.getTimezoneOffset();function Yf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+aN),t.getTimezoneOffset()!==a1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-a1)*6e4),t}function iN(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var i1=new Date("2017-02-19T19:06:09.000Z"),O2=isNaN(i1.getFullYear())?new Date("2/19/17"):i1,sN=O2.getFullYear()==2017;function vr(e,t){var r=new Date(e);if(sN)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(O2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ds(e,t){if(vt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ol(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ol(_2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ol(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ol(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Er(e[r]));return t}function Xt(e,t){for(var r="";r.length<t;)r+=e;return r}function Qn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var oN=["january","february","march","april","may","june","july","august","september","october","november","december"];function xo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&oN.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var lN=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(a),o.push(i[l]);return o}}();function R2(e){return e?e.content&&e.type?ds(e.content,!0):e.data?al(e.data):e.asNodeBuffer&&vt?al(e.asNodeBuffer().toString("binary")):e.asBinary?al(e.asBinary()):e._data&&e._data.getContent?al(ds(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function M2(e){if(!e)return null;if(e.data)return Gx(e.data);if(e.asNodeBuffer&&vt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Gx(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function cN(e){return e&&e.name.slice(-4)===".bin"?M2(e):R2(e)}function Cn(e,t){for(var r=e.FullPaths||va(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Jp(e,t){var r=Cn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ar(e,t,r){if(!r)return cN(Jp(e,t));if(!t)return null;try{return ar(e,t)}catch{return null}}function hn(e,t,r){if(!r)return R2(Jp(e,t));if(!t)return null;try{return hn(e,t)}catch{return null}}function uN(e,t,r){return M2(Jp(e,t))}function s1(e){for(var t=e.FullPaths||va(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function fN(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return vt?n=xs(r):n=Lb(r),yt.utils.cfb_add(e,t,n)}yt.utils.cfb_add(e,t,r)}else e.file(t,r)}function I2(e,t){switch(t.type){case"base64":return yt.read(e,{type:"base64"});case"binary":return yt.read(e,{type:"binary"});case"buffer":case"array":return yt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function sl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var D2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,o1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hN=/<[^>]*>/g,Br=D2.match(o1)?o1:hN,pN=/<\w*:/,mN=/<(\/?)\w+:/;function Ge(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(dN),l=0,u="",f=0,h="",m="",g=1;if(o)for(f=0;f!=o.length;++f){for(m=o[f],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(h=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(g=(a=m.charCodeAt(i+1))==34||a==39?1:0,u=m.slice(i+1+g,m.length-g),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=u,n[h.toLowerCase()]=u;else{var x=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[x]&&h.slice(l-3,l)=="ext")continue;n[x]=u,n[x.toLowerCase()]=u}}return n}function ya(e){return e.replace(mN,"<$1")}var j2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gN=Yp(j2),Et=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,u){return j2[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),xN=/[&<>'"]/g,vN=/[\u0000-\u001f]/g;function Qp(e){var t=e+"";return t.replace(xN,function(r){return gN[r]}).replace(/\n/g,"<br/>").replace(vN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var l1=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Dt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function od(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function c1(e){var t=Ai(2*e.length),r,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function u1(e){return xs(e,"binary").toString("utf8")}var au="foo bar baz",Pt=vt&&(u1(au)==od(au)&&u1||c1(au)==od(au)&&c1)||od,ol=vt?function(e){return xs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ql=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),B2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),_N=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),yN=/<\/?(?:vt:)?variant>/g,wN=/<(?:vt:)([^>]*)>([\s\S]*)</;function f1(e,t){var r=Ge(e),n=e.match(_N(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(yN,"").match(wN);o&&a.push({v:Pt(o[2]),t:o[1]})}),a}var kN=/(^\s|\s$|\n)/;function EN(e){return va(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function SN(e,t,r){return"<"+e+(r!=null?EN(r):"")+(t!=null?(t.match(kN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function em(e){if(vt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pt(vs(Xp(e)));throw new Error("Bad input format: expected Buffer or string")}var Kl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,TN={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},CN=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function bN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function NN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var d1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},h1=vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xs(t)})):d1(e)}:d1,p1=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ia(e,a)));return n.join("").replace(Gr,"")},tm=vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Gr,""):p1(e,t,r)}:p1,m1=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},z2=vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):m1(e,t,r)}:m1,g1=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ms(e,a)));return n.join("")},hc=vt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):g1(t,r,n)}:g1,U2=function(e,t){var r=dn(e,t);return r>0?hc(e,t+4,t+4+r-1):""},H2=U2,V2=function(e,t){var r=dn(e,t);return r>0?hc(e,t+4,t+4+r-1):""},$2=V2,W2=function(e,t){var r=2*dn(e,t);return r>0?hc(e,t+4,t+4+r-1):""},Z2=W2,G2=function(t,r){var n=dn(t,r);return n>0?tm(t,r+4,r+4+n):""},X2=G2,q2=function(e,t){var r=dn(e,t);return r>0?hc(e,t+4,t+4+r):""},K2=q2,Y2=function(e,t){return bN(e,t)},gf=Y2,J2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};vt&&(H2=function(t,r){if(!Buffer.isBuffer(t))return U2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},$2=function(t,r){if(!Buffer.isBuffer(t))return V2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Z2=function(t,r){if(!Buffer.isBuffer(t))return W2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},X2=function(t,r){if(!Buffer.isBuffer(t))return G2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},K2=function(t,r){if(!Buffer.isBuffer(t))return q2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},gf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Y2(t,r)},J2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ms=function(e,t){return e[t]},Ia=function(e,t){return e[t+1]*256+e[t]},AN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},dn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Wi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},LN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function _l(e,t){var r="",n,a,i=[],o,l,u,f;switch(t){case"dbcs":if(f=this.l,vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Ia(this,f)),f+=2;e*=2;break;case"utf8":r=hc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=tm(this,this.l,this.l+e);break;case"wstr":return _l.call(this,e,"dbcs");case"lpstr-ansi":r=H2(this,this.l),e=4+dn(this,this.l);break;case"lpstr-cp":r=$2(this,this.l),e=4+dn(this,this.l);break;case"lpwstr":r=Z2(this,this.l),e=4+2*dn(this,this.l);break;case"lpp4":e=4+dn(this,this.l),r=X2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+dn(this,this.l),r=K2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Ms(this,this.l+e++))!==0;)i.push(nu(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Ia(this,this.l+e))!==0;)i.push(nu(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Ms(this,f),this.l=f+1,l=_l.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(nu(Ia(this,f))),f+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Ms(this,f),this.l=f+1,l=_l.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(nu(Ms(this,f))),f+=1}r=i.join("");break;default:switch(e){case 1:return n=Ms(this,this.l),this.l++,n;case 2:return n=(t==="i"?AN:Ia)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Wi:LN)(this,this.l),this.l+=4,n):(a=dn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=gf(this,this.l):a=gf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=z2(this,this.l,e);break}}return this.l+=e,r}var FN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},PN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ON=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function RN(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)ON(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,FN(this,t,this.l);break;case 8:if(n=8,r==="f"){NN(this,t,this.l);break}case 16:break;case-4:n=4,PN(this,t,this.l);break}return this.l+=n,this}function Q2(e,t){var r=z2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=_l,e.chk=Q2,e.write_shift=RN}function jr(e,t){e.l+=t}function lr(e){var t=Ai(e);return wr(t,0),t}function Ka(e,t,r){if(e){var n,a,i;wr(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var f=kf[l]||kf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;u=e.l+i;var h=f.f&&f.f(e,i,r);if(e.l=u,t(h,f,l))return}}}function kh(){var e=[],t=vt?256:2048,r=function(f){var h=lr(f);return wr(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},o=function(){return a(),li(e)},l=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function yl(e,t,r){var n=Er(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function x1(e,t,r){var n=Er(e);return n.s=yl(n.s,t.s,r),n.e=yl(n.e,t.s,r),n}function wl(e,t){if(e.cRel&&e.c<0)for(e=Er(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Er(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Qe(e);return!e.cRel&&e.cRel!=null&&(r=DN(r)),!e.rRel&&e.rRel!=null&&(r=MN(r)),r}function ld(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fr(e.s.c)+":"+(e.e.cRel?"":"$")+fr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sr(e.s.r)+":"+(e.e.rRel?"":"$")+Sr(e.e.r):wl(e.s,t.biff)+":"+wl(e.e,t.biff)}function rm(e){return parseInt(IN(e),10)-1}function Sr(e){return""+(e+1)}function MN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function IN(e){return e.replace(/\$(\d+)$/,"$1")}function nm(e){for(var t=jN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function fr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function DN(e){return e.replace(/^([A-Z])/,"$$$1")}function jN(e){return e.replace(/^\$([A-Z])/,"$1")}function BN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Qe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ao(e){var t=e.indexOf(":");return t==-1?{s:Wr(e),e:Wr(e)}:{s:Wr(e.slice(0,t)),e:Wr(e.slice(t+1))}}function wt(e,t){return typeof t>"u"||typeof t=="number"?wt(e.s,e.e):(typeof e!="string"&&(e=Qe(e)),typeof t!="string"&&(t=Qe(t)),e==t?e:e+":"+t)}function qt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function v1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dn(e.z,r?Xr(t):t)}catch{}try{return e.w=Dn((e.XF||{}).numFmtId||(r?14:0),r?Xr(t):t)}catch{return""+t}}function Za(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ws[e.v]||e.v:t==null?v1(e,e.v):v1(e,t))}function Ri(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function ew(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Wr(n.origin):n.origin;o=u.r,l=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=qt(i["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(f.e.r=o=h.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var x={v:t[m][g]},_=o+m,y=l+g;if(f.s.r>_&&(f.s.r=_),f.s.c>y&&(f.s.c=y),f.e.r<_&&(f.e.r=_),f.e.c<y&&(f.e.c=y),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))x=t[m][g];else if(Array.isArray(x.v)&&(x.f=t[m][g][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||nt[14],n.cellDates?(x.t="d",x.w=Dn(x.z,Xr(x.v))):(x.t="n",x.v=Xr(x.v),x.w=Dn(x.z,x.v))):x.t="s";if(a)i[_]||(i[_]=[]),i[_][y]&&i[_][y].z&&(x.z=i[_][y].z),i[_][y]=x;else{var S=Qe({c:y,r:_});i[S]&&i[S].z&&(x.z=i[S].z),i[S]=x}}}return f.s.c<1e7&&(i["!ref"]=wt(f)),i}function Lo(e,t){return ew(null,e,t)}function zN(e){return e.read_shift(4,"i")}function Ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function UN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function am(e,t){var r=e.l,n=e.read_shift(1),a=Ir(e),i=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)i.push(UN(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var HN=am;function jn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function _s(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var VN=Ir;function im(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var $N=Ir,Eh=im;function sm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?gf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Wi(t,0)>>2;return r?a/100:a}function tw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ys=tw;function Rr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function WN(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=ns[a];f&&(t.rgb=Jl(f));break;case 2:t.rgb=Jl([o,l,u]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function ZN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function rw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function GN(e){return rw(e,1)}function XN(e){return rw(e,2)}var om=2,Jr=3,iu=11,_1=12,xf=19,su=64,qN=65,KN=71,YN=4108,JN=4126,mr=80,nw=81,QN=[mr,nw],eA={1:{n:"CodePage",t:om},2:{n:"Category",t:mr},3:{n:"PresentationFormat",t:mr},4:{n:"ByteCount",t:Jr},5:{n:"LineCount",t:Jr},6:{n:"ParagraphCount",t:Jr},7:{n:"SlideCount",t:Jr},8:{n:"NoteCount",t:Jr},9:{n:"HiddenCount",t:Jr},10:{n:"MultimediaClipCount",t:Jr},11:{n:"ScaleCrop",t:iu},12:{n:"HeadingPairs",t:YN},13:{n:"TitlesOfParts",t:JN},14:{n:"Manager",t:mr},15:{n:"Company",t:mr},16:{n:"LinksUpToDate",t:iu},17:{n:"CharacterCount",t:Jr},19:{n:"SharedDoc",t:iu},22:{n:"HyperlinksChanged",t:iu},23:{n:"AppVersion",t:Jr,p:"version"},24:{n:"DigSig",t:qN},26:{n:"ContentType",t:mr},27:{n:"ContentStatus",t:mr},28:{n:"Language",t:mr},29:{n:"Version",t:mr},255:{},2147483648:{n:"Locale",t:xf},2147483651:{n:"Behavior",t:xf},1919054434:{}},tA={1:{n:"CodePage",t:om},2:{n:"Title",t:mr},3:{n:"Subject",t:mr},4:{n:"Author",t:mr},5:{n:"Keywords",t:mr},6:{n:"Comments",t:mr},7:{n:"Template",t:mr},8:{n:"LastAuthor",t:mr},9:{n:"RevNumber",t:mr},10:{n:"EditTime",t:su},11:{n:"LastPrinted",t:su},12:{n:"CreatedDate",t:su},13:{n:"ModifiedDate",t:su},14:{n:"PageCount",t:Jr},15:{n:"WordCount",t:Jr},16:{n:"CharCount",t:Jr},17:{n:"Thumbnail",t:KN},18:{n:"Application",t:mr},19:{n:"DocSecurity",t:Jr},255:{},2147483648:{n:"Locale",t:xf},2147483651:{n:"Behavior",t:xf},1919054434:{}},y1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function nA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var aA=nA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ns=Er(aA),ws={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},aw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},w1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function iA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sA(e){var t=iA();if(!e||!e.match)return t;var r={};if((e.match(Br)||[]).forEach(function(n){var a=Ge(n);switch(a[0].replace(pN,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[w1[a.ContentType]]!==void 0&&t[w1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==TN.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Ys={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function kl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Br)||[]).forEach(function(a){var i=Ge(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:sl(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}var oA="application/vnd.oasis.opendocument.spreadsheet";function lA(e,t){for(var r=em(e),n,a;n=Kl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ge(n[0],!1),a.path=="/"&&a.type!==oA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var El=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],cA=function(){for(var e=new Array(El.length),t=0;t<El.length;++t){var r=El[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function iw(e){var t={};e=Pt(e);for(var r=0;r<El.length;++r){var n=El[r],a=e.match(cA[r]);a!=null&&a.length>0&&(t[n[1]]=Et(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=vr(t[n[1]]))}return t}var uA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function sw(e,t,r,n){var a=[];if(typeof e=="string")a=f1(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var o=typeof t=="string"?f1(t,n).map(function(h){return h.v}):t,l=0,u=0;if(o.length>0)for(var f=0;f!==a.length;f+=2){switch(u=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function fA(e,t,r){var n={};return t||(t={}),e=Pt(e),uA.forEach(function(a){var i=(e.match(ql(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Et(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&sw(n.HeadingPairs,n.TitlesOfParts,t,r),t}var dA=/<[^>]+>[^<]*/g;function hA(e,t){var r={},n="",a=e.match(dA);if(a)for(var i=0;i!=a.length;++i){var o=a[i],l=Ge(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Et(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),f=u[0].slice(4),h=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Et(h);break;case"bool":r[n]=Dt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=vr(h);break;case"cy":case"error":r[n]=Et(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var pA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},cd;function mA(e,t,r){cd||(cd=Yp(pA)),t=cd[t]||t,e[t]=r}function lm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ow(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function lw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function cw(e,t,r){return t===31?lw(e):ow(e,t,r)}function Th(e,t,r){return cw(e,t,r===!1?0:4)}function gA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return cw(e,t,0)}function xA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Gr,""),e.l-a&2&&(e.l+=2)}return r}function vA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Gr,"");return r}function _A(e){var t=e.l,r=vf(e,nw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=vf(e,Jr);return[r,n]}function yA(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(_A(e));return r}function k1(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Gr,"").replace(il,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function uw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function wA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function vf(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==_1&&n!==t&&QN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===_1?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return ow(e,n,4).replace(Gr,"");case 31:return lw(e);case 64:return lm(e);case 65:return uw(e);case 71:return wA(e);case 80:return Th(e,n,!i.raw).replace(Gr,"");case 81:return gA(e,n).replace(Gr,"");case 4108:return yA(e);case 4126:case 4127:return n==4127?xA(e):vA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function E1(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,l=0,u=-1,f={};for(o=0;o!=a;++o){var h=e.read_shift(4),m=e.read_shift(4);i[o]=[h,m+r]}i.sort(function(E,w){return E[1]-w[1]});var g={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var x=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(x=!1,e.l=i[o][1]),x)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var _=t[i[o][0]];if(g[_.n]=vf(e,_.t,{raw:!0}),_.p==="version"&&(g[_.n]=String(g[_.n]>>16)+"."+("0000"+String(g[_.n]&65535)).slice(-4)),_.n=="CodePage")switch(g[_.n]){case 0:g[_.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qn(l=g[_.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[_.n])}}else if(i[o][0]===1){if(l=g.CodePage=vf(e,om),qn(l),u!==-1){var y=e.l;e.l=i[u][1],f=k1(e,l),e.l=y}}else if(i[o][0]===0){if(l===0){u=o,e.l=i[o+1][1];continue}f=k1(e,l)}else{var S=f[i[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=uw(e);break;case 30:e.l+=4,k=Th(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Th(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Yt(e,4);break;case 64:e.l+=4,k=vr(lm(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[S]=k}}return e.l=r+n,g}function S1(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var a,i,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==yt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=E1(n,t),g={SystemIdentifier:f};for(var x in m)g[x]=m[x];if(g.FMTID=i,a===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var _;try{_=E1(n,null)}catch{}for(x in _)g[x]=_[x];return g.FMTID=[i,o],g}function ti(e,t){return e.read_shift(t),null}function kA(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Yt(e,t){return e.read_shift(t)===1}function ir(e){return e.read_shift(2,"u")}function fw(e,t){return kA(e,t,ir)}function EA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function pc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function SA(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,l,u={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*o),n&&(e.l+=l),u.t=h,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function hs(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function mc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):hs(e,n,r)}function ks(e,t,r){if(r.biff>5)return mc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function TA(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function CA(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Gr,"");return n&&(e.l+=24),a}function bA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Gr,"");return r+o}function NA(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return CA(e);case"0303000000000000c000000000000046":return bA(e);default:throw new Error("Unsupported Moniker "+r)}}function ou(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Gr,""):"";return r}function AA(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,l,u,f="",h,m;a&16&&(i=ou(e,r-e.l)),a&128&&(o=ou(e,r-e.l)),(a&257)===257&&(l=ou(e,r-e.l)),(a&257)===1&&(u=NA(e,r-e.l)),a&8&&(f=ou(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(m=lm(e)),e.l=r;var g=o||l||u||"";g&&f&&(g+="#"+f),g||(g="#"+f),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var x={Target:g};return h&&(x.guid=h),m&&(x.time=m),i&&(x.Tooltip=i),x}function dw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function hw(e,t){var r=dw(e);return r[3]=0,r}function wa(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function LA(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function FA(e,t,r){return t===0?"":ks(e,t,r)}function PA(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function pw(e){var t=e.read_shift(2),r=sm(e);return[t,r]}function OA(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=pc(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Jf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function mw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var RA=mw;function gw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function MA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function IA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ar(e){e.l+=2,e.l+=e.read_shift(2)}var DA={0:Ar,4:Ar,5:Ar,6:Ar,7:IA,8:Ar,9:Ar,10:Ar,11:Ar,12:Ar,13:MA,14:Ar,15:Ar,16:Ar,17:Ar,18:Ar,19:Ar,20:Ar,21:gw};function jA(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(DA[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function lu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function BA(e,t){return t===0||e.read_shift(2),1200}function zA(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=ks(e,0,r);return e.read_shift(t+n-e.l),a}function UA(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function HA(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=pc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function VA(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(SA(e));return i.Count=n,i.Unique=a,i}function $A(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function WA(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function ZA(e){var t=LA(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function GA(e){return e.read_shift(2),e.read_shift(4)}function T1(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function XA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:l,Selected:u,TabRatio:f}}function qA(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function KA(){}function YA(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=pc(e,0,r),n}function JA(e){var t=wa(e);return t.isst=e.read_shift(4),t}function QA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=wa(e);r.biff==2&&e.l++;var i=mc(e,n-e.l,r);return a.val=i,a}function eL(e,t,r){var n=e.read_shift(2),a=ks(e,0,r);return[n,a]}var tL=ks;function C1(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c:u}}}function rL(e){var t=e.read_shift(2),r=e.read_shift(2),n=pw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function nL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(pw(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function aL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function iL(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return a.patternType=rA[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function sL(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=iL(e,t,n.fStyle,r),n}function oL(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function b1(e,t,r){var n=wa(e);(r.biff==2||t==9)&&++e.l;var a=EA(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function lL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=wa(e),a=Rr(e);return n.val=a,n}var N1=FA;function cL(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=hs(e,i),l=[];n>e.l;)l.push(mc(e));return[i,a,o,l]}function A1(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=OA(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var uL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function L1(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=hs(e,o,r);a&32&&(f=uL[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var m=n==e.l||l===0||!(h>0)?[]:WP(e,h,r,l);return{chKey:i,Name:f,itab:u,rgce:m}}function xw(e,t,r){if(r.biff<8)return fL(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(PA(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function fL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=pc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function dL(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=hs(e,n,r),o=hs(e,a,r);return[i,o]}function hL(e,t,r){var n=mw(e);e.l++;var a=e.read_shift(1);return t-=8,[ZP(e,t,r),a,n]}function F1(e,t,r){var n=RA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,VP(e,t,r)]}function pL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function mL(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=ks(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,i]}}function gL(e,t,r){return mL(e,t,r)}function xL(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Jf(e));return r}function vL(e,t,r){if(r&&r.biff<8)return yL(e,t,r);var n=gw(e),a=jA(e,t-22,n[1]);return{cmo:n,ft:a}}var _L={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function yL(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((_L[n]||jr)(e,t,r)),{cmo:[a,n,i],ft:o}}function wL(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=TA(e,6,r);var l=e.read_shift(2);e.read_shift(2),ir(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],m=hs(e,e.lens[f+1]-e.lens[f]-1);if(a+=m,a.length>=(h?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function kL(e,t){var r=Jf(e);e.l+=16;var n=AA(e,t-24);return[r,n]}function EL(e,t){e.read_shift(2);var r=Jf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Gr,""),[r,n]}function SL(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=y1[r]||r,r=e.read_shift(2),t[1]=y1[r]||r,t}function TL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(hw(e));return r}function CL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(hw(e));return r}function bL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function vw(e,t,r){if(!r.cellStyles)return jr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function NL(e,t){var r={};return t<32||(e.l+=16,r.header=Rr(e),r.footer=Rr(e),e.l+=2),r}function AL(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var LL=wa,FL=fw,PL=mc;function OL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function RL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=wa(e);++e.l;var a=ks(e,t-7,r);return n.t="str",n.val=a,n}function ML(e){var t=wa(e);++e.l;var r=Rr(e);return t.t="n",t.val=r,t}function IL(e){var t=wa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function DL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function jL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function BL(e,t,r){var n=e.l+t,a=wa(e),i=e.read_shift(2),o=hs(e,i,r);return e.l=n,a.t="str",a.val=o,a}var zL=[2,3,48,49,131,139,140,245],P1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var f=[],h=Ai(1);switch(u.type){case"base64":h=Xn(vn(l));break;case"binary":h=Xn(l);break;case"buffer":case"array":h=l;break}wr(h,0);var m=h.read_shift(1),g=!!(m&136),x=!1,_=!1;switch(m){case 2:break;case 3:break;case 48:x=!0,g=!0;break;case 49:x=!0,g=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,S=521;m==2&&(y=h.read_shift(2)),h.l+=3,m!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(S=h.read_shift(2));var k=h.read_shift(2),E=u.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(E=e[h[h.l]]),h.l+=1,h.l+=2),_&&(h.l+=36);for(var w=[],F={},j=Math.min(h.length,m==2?521:S-10-(x?264:0)),D=_?32:11;h.l<j&&h[h.l]!=13;)switch(F={},F.name=oi.utils.decode(E,h.slice(h.l,h.l+D)).replace(/[\u0000\r\n].*$/g,""),h.l+=D,F.type=String.fromCharCode(h.read_shift(1)),m!=2&&!_&&(F.offset=h.read_shift(4)),F.len=h.read_shift(1),m==2&&(F.offset=h.read_shift(2)),F.dec=h.read_shift(1),F.name.length&&w.push(F),m!=2&&(h.l+=_?13:14),F.type){case"B":(!x||F.len!=8)&&u.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(h[h.l]!==13&&(h.l=S-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=S;var A=0,M=0;for(f[0]=[],M=0;M!=w.length;++M)f[0][M]=w[M].name;for(;y-- >0;){if(h[h.l]===42){h.l+=k;continue}for(++h.l,f[++A]=[],M=0,M=0;M!=w.length;++M){var O=h.slice(h.l,h.l+w[M].len);h.l+=w[M].len,wr(O,0);var G=oi.utils.decode(E,O);switch(w[M].type){case"C":G.trim().length&&(f[A][M]=G.replace(/\s+$/,""));break;case"D":G.length===8?f[A][M]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):f[A][M]=G;break;case"F":f[A][M]=parseFloat(G.trim());break;case"+":case"I":f[A][M]=_?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":f[A][M]=!0;break;case"N":case"F":f[A][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[A][M]="##MEMO##"+(_?parseInt(G.trim(),10):O.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(f[A][M]=+G||0);break;case"@":f[A][M]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":f[A][M]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":f[A][M]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[A][M]=-O.read_shift(-8,"f");break;case"B":if(x&&w[M].len==8){f[A][M]=O.read_shift(8,"f");break}case"G":case"P":O.l+=w[M].len;break;case"0":if(w[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[M].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=w,f}function n(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var h=Lo(r(l,f),f);return h["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,h}function a(l,u){try{return Ri(n(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var f=u||{};if(+f.codepage>=0&&qn(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=kh(),m=Ph(l,{header:1,raw:!0,cellDates:!0}),g=m[0],x=m.slice(1),_=l["!cols"]||[],y=0,S=0,k=0,E=1;for(y=0;y<g.length;++y){if(((_[y]||{}).DBF||{}).name){g[y]=_[y].DBF.name,++k;continue}if(g[y]!=null){if(++k,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(S=0;S<1024;++S)if(g.indexOf(g[y]+"_"+S)==-1){g[y]+="_"+S;break}}}}var w=qt(l["!ref"]),F=[],j=[],D=[];for(y=0;y<=w.e.c-w.s.c;++y){var A="",M="",O=0,G=[];for(S=0;S<x.length;++S)x[S][y]!=null&&G.push(x[S][y]);if(G.length==0||g[y]==null){F[y]="?";continue}for(S=0;S<G.length;++S){switch(typeof G[S]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=G[S]instanceof Date?"D":"C";break;default:M="C"}O=Math.max(O,String(G[S]).length),A=A&&A!=M?"C":M}O>250&&(O=250),M=((_[y]||{}).DBF||{}).type,M=="C"&&_[y].DBF.len>O&&(O=_[y].DBF.len),A=="B"&&M=="N"&&(A="N",D[y]=_[y].DBF.dec,O=_[y].DBF.len),j[y]=A=="C"||M=="N"?O:i[A]||0,E+=j[y],F[y]=A}var H=h.next(32);for(H.write_shift(4,318902576),H.write_shift(4,x.length),H.write_shift(2,296+32*k),H.write_shift(2,E),y=0;y<4;++y)H.write_shift(4,0);for(H.write_shift(4,0|(+t[x2]||3)<<8),y=0,S=0;y<g.length;++y)if(g[y]!=null){var W=h.next(32),fe=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,fe,"sbcs"),W.write_shift(1,F[y]=="?"?"C":F[y],"sbcs"),W.write_shift(4,S),W.write_shift(1,j[y]||i[F[y]]||0),W.write_shift(1,D[y]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),S+=j[y]||i[F[y]]||0}var Se=h.next(264);for(Se.write_shift(4,13),y=0;y<65;++y)Se.write_shift(4,0);for(y=0;y<x.length;++y){var le=h.next(E);for(le.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(F[S]){case"L":le.write_shift(1,x[y][S]==null?63:x[y][S]?84:70);break;case"B":le.write_shift(8,x[y][S]||0,"f");break;case"N":var Y="0";for(typeof x[y][S]=="number"&&(Y=x[y][S].toFixed(D[S]||0)),k=0;k<j[S]-Y.length;++k)le.write_shift(1,32);le.write_shift(1,Y,"sbcs");break;case"D":x[y][S]?(le.write_shift(4,("0000"+x[y][S].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(x[y][S].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+x[y][S].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var xe=String(x[y][S]!=null?x[y][S]:"").slice(0,j[S]);for(le.write_shift(1,xe,"sbcs"),k=0;k<j[S]-xe.length;++k)le.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),UL=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+va(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,x){var _=e[x];return typeof _=="number"?Xx(_):_},n=function(g,x,_){var y=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return y==59?g:Xx(y)};e["|"]=254;function a(g,x){switch(x.type){case"base64":return i(vn(g),x);case"binary":return i(g,x);case"buffer":return i(vt&&Buffer.isBuffer(g)?g.toString("binary"):vs(g),x);case"array":return i(ds(g),x)}throw new Error("Unrecognized type "+x.type)}function i(g,x){var _=g.split(/[\n\r]+/),y=-1,S=-1,k=0,E=0,w=[],F=[],j=null,D={},A=[],M=[],O=[],G=0,H;for(+x.codepage>=0&&qn(+x.codepage);k!==_.length;++k){G=0;var W=_[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),fe=W.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Se=fe[0],le;if(W.length>0)switch(Se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":fe[1].charAt(0)=="P"&&F.push(W.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,xe=!1,re=!1,K=!1,ie=-1,he=-1;for(E=1;E<fe.length;++E)switch(fe[E].charAt(0)){case"A":break;case"X":S=parseInt(fe[E].slice(1))-1,xe=!0;break;case"Y":for(y=parseInt(fe[E].slice(1))-1,xe||(S=0),H=w.length;H<=y;++H)w[H]=[];break;case"K":le=fe[E].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(Qn(le))?isNaN(xo(le).getDate())||(le=vr(le)):(le=Qn(le),j!==null&&No(j)&&(le=Yf(le))),Y=!0;break;case"E":K=!0;var R=oo(fe[E].slice(1),{r:y,c:S});w[y][S]=[w[y][S],R];break;case"S":re=!0,w[y][S]=[w[y][S],"S5S"];break;case"G":break;case"R":ie=parseInt(fe[E].slice(1))-1;break;case"C":he=parseInt(fe[E].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}if(Y&&(w[y][S]&&w[y][S].length==2?w[y][S][0]=le:w[y][S]=le,j=null),re){if(K)throw new Error("SYLK shared formula cannot have own formula");var J=ie>-1&&w[ie][he];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");w[y][S][1]=Nw(J[1],{r:y-ie,c:S-he})}break;case"F":var q=0;for(E=1;E<fe.length;++E)switch(fe[E].charAt(0)){case"X":S=parseInt(fe[E].slice(1))-1,++q;break;case"Y":for(y=parseInt(fe[E].slice(1))-1,H=w.length;H<=y;++H)w[H]=[];break;case"M":G=parseInt(fe[E].slice(1))/20;break;case"F":break;case"G":break;case"P":j=F[parseInt(fe[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=fe[E].slice(1).split(" "),H=parseInt(O[0],10);H<=parseInt(O[1],10);++H)G=parseInt(O[2],10),M[H-1]=G===0?{hidden:!0}:{wch:G},vo(M[H-1]);break;case"C":S=parseInt(fe[E].slice(1))-1,M[S]||(M[S]={});break;case"R":y=parseInt(fe[E].slice(1))-1,A[y]||(A[y]={}),G>0?(A[y].hpt=G,A[y].hpx=Ql(G)):G===0&&(A[y].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}q<1&&(j=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}}return A.length>0&&(D["!rows"]=A),M.length>0&&(D["!cols"]=M),x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),[w,D]}function o(g,x){var _=a(g,x),y=_[0],S=_[1],k=Lo(y,x);return va(S).forEach(function(E){k[E]=S[E]}),k}function l(g,x){return Ri(o(g,x),x)}function u(g,x,_,y){var S="C;Y"+(_+1)+";X"+(y+1)+";K";switch(g.t){case"n":S+=g.v||0,g.f&&!g.F&&(S+=";E"+b6(g.f,{r:_,c:y}));break;case"b":S+=g.v?"TRUE":"FALSE";break;case"e":S+=g.w||g.v;break;case"d":S+='"'+(g.w||g.v)+'"';break;case"s":S+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(g,x){x.forEach(function(_,y){var S="F;W"+(y+1)+" "+(y+1)+" ";_.hidden?S+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=yf(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=wf(_.wpx)),typeof _.wch=="number"&&(S+=Math.round(_.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function h(g,x){x.forEach(function(_,y){var S="F;";_.hidden?S+="M0;":_.hpt?S+="M"+20*_.hpt+";":_.hpx&&(S+="M"+20*Tw(_.hpx)+";"),S.length>2&&g.push(S+"R"+(y+1))})}function m(g,x){var _=["ID;PWXL;N;E"],y=[],S=qt(g["!ref"]),k,E=Array.isArray(g),w=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),g["!cols"]&&f(_,g["!cols"]),g["!rows"]&&h(_,g["!rows"]),_.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var F=S.s.r;F<=S.e.r;++F)for(var j=S.s.c;j<=S.e.c;++j){var D=Qe({r:F,c:j});k=E?(g[F]||[])[j]:g[D],!(!k||k.v==null&&(!k.f||k.F))&&y.push(u(k,g,F,j))}return _.join(w)+w+y.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),HL=function(){function e(i,o){switch(o.type){case"base64":return t(vn(i),o);case"binary":return t(i,o);case"buffer":return t(vt&&Buffer.isBuffer(i)?i.toString("binary"):vs(i),o);case"array":return t(ds(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),u=-1,f=-1,h=0,m=[];h!==l.length;++h){if(l[h].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var g=l[h].trim().split(","),x=g[0],_=g[1];++h;for(var y=l[h]||"";(y.match(/["]/g)||[]).length&1&&h<l.length-1;)y+=`
`+l[++h];switch(y=y.trim(),+x){case-1:if(y==="BOT"){m[++u]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[u][f]=!0:y==="FALSE"?m[u][f]=!1:isNaN(Qn(_))?isNaN(xo(_).getDate())?m[u][f]=_:m[u][f]=vr(_):m[u][f]=Qn(_),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[u][f++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return Lo(e(i,o),o)}function n(i,o){return Ri(r(i,o),o)}var a=function(){var i=function(u,f,h,m,g){u.push(f),u.push(h+","+m),u.push('"'+g.replace(/"/g,'""')+'"')},o=function(u,f,h,m){u.push(f+","+h),u.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var f=[],h=qt(u["!ref"]),m,g=Array.isArray(u);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,h.e.r-h.s.r+1,""),i(f,"TUPLES",0,h.e.c-h.s.c+1,""),i(f,"DATA",0,0,"");for(var x=h.s.r;x<=h.e.r;++x){o(f,-1,0,"BOT");for(var _=h.s.c;_<=h.e.c;++_){var y=Qe({r:x,c:_});if(m=g?(u[x]||[])[_]:u[y],!m){o(f,1,0,"");continue}switch(m.t){case"n":var S=m.w;!S&&m.v!=null&&(S=m.v),S==null?m.f&&!m.F?o(f,1,0,"="+m.f):o(f,1,0,""):o(f,0,S,"V");break;case"b":o(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Dn(m.z||nt[14],Xr(vr(m.v)))),o(f,0,m.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var k=`\r
`,E=f.join(k);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),VL=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var x=m.split(`
`),_=-1,y=-1,S=0,k=[];S!==x.length;++S){var E=x[S].trim().split(":");if(E[0]==="cell"){var w=Wr(E[1]);if(k.length<=w.r)for(_=k.length;_<=w.r;++_)k[_]||(k[_]=[]);switch(_=w.r,y=w.c,E[2]){case"t":k[_][y]=e(E[3]);break;case"v":k[_][y]=+E[3];break;case"vtf":var F=E[E.length-1];case"vtc":switch(E[3]){case"nl":k[_][y]=!!+E[4];break;default:k[_][y]=+E[4];break}E[2]=="vtf"&&(k[_][y]=[k[_][y],F])}}}return g&&g.sheetRows&&(k=k.slice(0,g.sheetRows)),k}function n(m,g){return Lo(r(m,g),g)}function a(m,g){return Ri(n(m,g),g)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var g=[],x=[],_,y="",S=Ao(m["!ref"]),k=Array.isArray(m),E=S.s.r;E<=S.e.r;++E)for(var w=S.s.c;w<=S.e.c;++w)if(y=Qe({r:E,c:w}),_=k?(m[E]||[])[w]:m[y],!(!_||_.v==null||_.t==="z")){switch(x=["cell",y,"t"],_.t){case"s":case"str":x.push(t(_.v));break;case"n":_.f?(x[2]="vtf",x[3]="n",x[4]=_.v,x[5]=t(_.f)):(x[2]="v",x[3]=_.v);break;case"b":x[2]="vt"+(_.f?"f":"c"),x[3]="nl",x[4]=_.v?"1":"0",x[5]=t(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var F=Xr(vr(_.v));x[2]="vtc",x[3]="nd",x[4]=""+F,x[5]=_.w||Dn(_.z||nt[14],F);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(m){return[i,o,l,o,f(m),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),Yl=function(){function e(h,m,g,x,_){_.raw?m[g][x]=h:h===""||(h==="TRUE"?m[g][x]=!0:h==="FALSE"?m[g][x]=!1:isNaN(Qn(h))?isNaN(xo(h).getDate())?m[g][x]=h:m[g][x]=vr(h):m[g][x]=Qn(h))}function t(h,m){var g=m||{},x=[];if(!h||h.length===0)return x;for(var _=h.split(/[\r\n]/),y=_.length-1;y>=0&&_[y].length===0;)--y;for(var S=10,k=0,E=0;E<=y;++E)k=_[E].indexOf(" "),k==-1?k=_[E].length:k++,S=Math.max(S,k);for(E=0;E<=y;++E){x[E]=[];var w=0;for(e(_[E].slice(0,S).trim(),x,E,w,g),w=1;w<=(_[E].length-S)/10+1;++w)e(_[E].slice(S+(w-1)*10,S+w*10).trim(),x,E,w,g)}return g.sheetRows&&(x=x.slice(0,g.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var m={},g=!1,x=0,_=0;x<h.length;++x)(_=h.charCodeAt(x))==34?g=!g:!g&&_ in r&&(m[_]=(m[_]||0)+1);_=[];for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&_.push([m[x],x]);if(!_.length){m=n;for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&_.push([m[x],x])}return _.sort(function(y,S){return y[0]-S[0]||n[y[1]]-n[S[1]]}),r[_.pop()[1]]||44}function i(h,m){var g=m||{},x="",_=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(x=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(x=h.charAt(4),h=h.slice(6)):x=a(h.slice(0,1024)):g&&g.FS?x=g.FS:x=a(h.slice(0,1024));var S=0,k=0,E=0,w=0,F=0,j=x.charCodeAt(0),D=!1,A=0,M=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var O=g.dateNF!=null?eN(g.dateNF):null;function G(){var H=h.slice(w,F),W={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)W.t="z";else if(g.raw)W.t="s",W.v=H;else if(H.trim().length===0)W.t="s",W.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(W.t="s",W.v=H.slice(2,-1).replace(/""/g,'"')):A6(H)?(W.t="n",W.f=H.slice(1)):(W.t="s",W.v=H);else if(H=="TRUE")W.t="b",W.v=!0;else if(H=="FALSE")W.t="b",W.v=!1;else if(!isNaN(E=Qn(H)))W.t="n",g.cellText!==!1&&(W.w=H),W.v=E;else if(!isNaN(xo(H).getDate())||O&&H.match(O)){W.z=g.dateNF||nt[14];var fe=0;O&&H.match(O)&&(H=tN(H,g.dateNF,H.match(O)||[]),fe=1),g.cellDates?(W.t="d",W.v=vr(H,fe)):(W.t="n",W.v=Xr(vr(H,fe))),g.cellText!==!1&&(W.w=Dn(W.z,W.v instanceof Date?Xr(W.v):W.v)),g.cellNF||delete W.z}else W.t="s",W.v=H;if(W.t=="z"||(g.dense?(_[S]||(_[S]=[]),_[S][k]=W):_[Qe({c:k,r:S})]=W),w=F+1,M=h.charCodeAt(w),y.e.c<k&&(y.e.c=k),y.e.r<S&&(y.e.r=S),A==j)++k;else if(k=0,++S,g.sheetRows&&g.sheetRows<=S)return!0}e:for(;F<h.length;++F)switch(A=h.charCodeAt(F)){case 34:M===34&&(D=!D);break;case j:case 10:case 13:if(!D&&G())break e;break}return F-w>0&&G(),_["!ref"]=wt(y),_}function o(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,m):Lo(t(h,m),m)}function l(h,m){var g="",x=m.type=="string"?[0,0,0,0]:gm(h,m);switch(m.type){case"base64":g=vn(h);break;case"binary":g=h;break;case"buffer":m.codepage==65001?g=h.toString("utf8"):m.codepage&&typeof oi<"u"?g=oi.utils.decode(m.codepage,h):g=vt&&Buffer.isBuffer(h)?h.toString("binary"):vs(h);break;case"array":g=ds(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+m.type)}return x[0]==239&&x[1]==187&&x[2]==191?g=Pt(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=Pt(g):m.type=="binary"&&typeof oi<"u"&&m.codepage&&(g=oi.utils.decode(m.codepage,oi.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?VL.to_sheet(m.type=="string"?g:Pt(g),m):o(g,m)}function u(h,m){return Ri(l(h,m),m)}function f(h){for(var m=[],g=qt(h["!ref"]),x,_=Array.isArray(h),y=g.s.r;y<=g.e.r;++y){for(var S=[],k=g.s.c;k<=g.e.c;++k){var E=Qe({r:y,c:k});if(x=_?(h[y]||[])[k]:h[E],!x||x.v==null){S.push("          ");continue}for(var w=(x.w||(Za(x),x.w)||"").slice(0,10);w.length<10;)w+=" ";S.push(w+(k===0?" ":""))}m.push(S.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}();function $L(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=UL.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Yl.to_workbook(e,t)}}var Sl=function(){function e(R,J,q){if(R){wr(R,R.l||0);for(var Z=q.Enum||ie;R.l<R.length;){var ae=R.read_shift(2),ye=Z[ae]||Z[65535],Fe=R.read_shift(2),be=R.l+Fe,_e=ye.f&&ye.f(R,Fe,q);if(R.l=be,J(_e,ye,ae))return}}}function t(R,J){switch(J.type){case"base64":return r(Xn(vn(R)),J);case"binary":return r(Xn(R),J);case"buffer":case"array":return r(R,J)}throw"Unsupported type "+J.type}function r(R,J){if(!R)return R;var q=J||{},Z=q.dense?[]:{},ae="Sheet1",ye="",Fe=0,be={},_e=[],Be=[],V={s:{r:0,c:0},e:{r:0,c:0}},qe=q.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)q.Enum=ie,e(R,function(Ne,St,Wt){switch(Wt){case 0:q.vers=Ne,Ne>=4096&&(q.qpro=!0);break;case 6:V=Ne;break;case 204:Ne&&(ye=Ne);break;case 222:ye=Ne;break;case 15:case 51:q.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:Wt==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=q.dateNF||nt[14],q.cellDates&&(Ne[1].t="d",Ne[1].v=Yf(Ne[1].v))),q.qpro&&Ne[3]>Fe&&(Z["!ref"]=wt(V),be[ae]=Z,_e.push(ae),Z=q.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Fe=Ne[3],ae=ye||"Sheet"+(Fe+1),ye="");var pe=q.dense?(Z[Ne[0].r]||[])[Ne[0].c]:Z[Qe(Ne[0])];if(pe){pe.t=Ne[1].t,pe.v=Ne[1].v,Ne[1].z!=null&&(pe.z=Ne[1].z),Ne[1].f!=null&&(pe.f=Ne[1].f);break}q.dense?(Z[Ne[0].r]||(Z[Ne[0].r]=[]),Z[Ne[0].r][Ne[0].c]=Ne[1]):Z[Qe(Ne[0])]=Ne[1];break}},q);else if(R[2]==26||R[2]==14)q.Enum=he,R[2]==14&&(q.qpro=!0,R.l=0),e(R,function(Ne,St,Wt){switch(Wt){case 204:ae=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>Fe&&(Z["!ref"]=wt(V),be[ae]=Z,_e.push(ae),Z=q.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Fe=Ne[3],ae="Sheet"+(Fe+1)),qe>0&&Ne[0].r>=qe)break;q.dense?(Z[Ne[0].r]||(Z[Ne[0].r]=[]),Z[Ne[0].r][Ne[0].c]=Ne[1]):Z[Qe(Ne[0])]=Ne[1],V.e.c<Ne[0].c&&(V.e.c=Ne[0].c),V.e.r<Ne[0].r&&(V.e.r=Ne[0].r);break;case 27:Ne[14e3]&&(Be[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:Be[Ne[0]]=Ne[1],Ne[0]==Fe&&(ae=Ne[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(Z["!ref"]=wt(V),be[ye||ae]=Z,_e.push(ye||ae),!Be.length)return{SheetNames:_e,Sheets:be};for(var it={},ot=[],Xe=0;Xe<Be.length;++Xe)be[_e[Xe]]?(ot.push(Be[Xe]||_e[Xe]),it[Be[Xe]]=be[Be[Xe]]||be[_e[Xe]]):(ot.push(Be[Xe]),it[Be[Xe]]={"!ref":"A1"});return{SheetNames:ot,Sheets:it}}function n(R,J){var q=J||{};if(+q.codepage>=0&&qn(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=kh(),ae=qt(R["!ref"]),ye=Array.isArray(R),Fe=[];$n(Z,0,i(1030)),$n(Z,6,u(ae));for(var be=Math.min(ae.e.r,8191),_e=ae.s.r;_e<=be;++_e)for(var Be=Sr(_e),V=ae.s.c;V<=ae.e.c;++V){_e===ae.s.r&&(Fe[V]=fr(V));var qe=Fe[V]+Be,it=ye?(R[_e]||[])[V]:R[qe];if(!(!it||it.t=="z"))if(it.t=="n")(it.v|0)==it.v&&it.v>=-32768&&it.v<=32767?$n(Z,13,x(_e,V,it.v)):$n(Z,14,y(_e,V,it.v));else{var ot=Za(it);$n(Z,15,m(_e,V,ot.slice(0,239)))}}return $n(Z,1),Z.end()}function a(R,J){var q=J||{};if(+q.codepage>=0&&qn(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=kh();$n(Z,0,o(R));for(var ae=0,ye=0;ae<R.SheetNames.length;++ae)(R.Sheets[R.SheetNames[ae]]||{})["!ref"]&&$n(Z,27,K(R.SheetNames[ae],ye++));var Fe=0;for(ae=0;ae<R.SheetNames.length;++ae){var be=R.Sheets[R.SheetNames[ae]];if(!(!be||!be["!ref"])){for(var _e=qt(be["!ref"]),Be=Array.isArray(be),V=[],qe=Math.min(_e.e.r,8191),it=_e.s.r;it<=qe;++it)for(var ot=Sr(it),Xe=_e.s.c;Xe<=_e.e.c;++Xe){it===_e.s.r&&(V[Xe]=fr(Xe));var Ne=V[Xe]+ot,St=Be?(be[it]||[])[Xe]:be[Ne];if(!(!St||St.t=="z"))if(St.t=="n")$n(Z,23,G(it,Xe,Fe,St.v));else{var Wt=Za(St);$n(Z,22,A(it,Xe,Fe,Wt.slice(0,239)))}}++Fe}}return $n(Z,1),Z.end()}function i(R){var J=lr(2);return J.write_shift(2,R),J}function o(R){var J=lr(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var q=0,Z=0,ae=0,ye=0;ye<R.SheetNames.length;++ye){var Fe=R.SheetNames[ye],be=R.Sheets[Fe];if(!(!be||!be["!ref"])){++ae;var _e=Ao(be["!ref"]);q<_e.e.r&&(q=_e.e.r),Z<_e.e.c&&(Z=_e.e.c)}}return q>8191&&(q=8191),J.write_shift(2,q),J.write_shift(1,ae),J.write_shift(1,Z),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function l(R,J,q){var Z={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&q.qpro?(Z.s.c=R.read_shift(1),R.l++,Z.s.r=R.read_shift(2),Z.e.c=R.read_shift(1),R.l++,Z.e.r=R.read_shift(2),Z):(Z.s.c=R.read_shift(2),Z.s.r=R.read_shift(2),J==12&&q.qpro&&(R.l+=2),Z.e.c=R.read_shift(2),Z.e.r=R.read_shift(2),J==12&&q.qpro&&(R.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function u(R){var J=lr(8);return J.write_shift(2,R.s.c),J.write_shift(2,R.s.r),J.write_shift(2,R.e.c),J.write_shift(2,R.e.r),J}function f(R,J,q){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Z[0].c=R.read_shift(1),Z[3]=R.read_shift(1),Z[0].r=R.read_shift(2),R.l+=2):(Z[2]=R.read_shift(1),Z[0].c=R.read_shift(2),Z[0].r=R.read_shift(2)),Z}function h(R,J,q){var Z=R.l+J,ae=f(R,J,q);if(ae[1].t="s",q.vers==20768){R.l++;var ye=R.read_shift(1);return ae[1].v=R.read_shift(ye,"utf8"),ae}return q.qpro&&R.l++,ae[1].v=R.read_shift(Z-R.l,"cstr"),ae}function m(R,J,q){var Z=lr(7+q.length);Z.write_shift(1,255),Z.write_shift(2,J),Z.write_shift(2,R),Z.write_shift(1,39);for(var ae=0;ae<Z.length;++ae){var ye=q.charCodeAt(ae);Z.write_shift(1,ye>=128?95:ye)}return Z.write_shift(1,0),Z}function g(R,J,q){var Z=f(R,J,q);return Z[1].v=R.read_shift(2,"i"),Z}function x(R,J,q){var Z=lr(7);return Z.write_shift(1,255),Z.write_shift(2,J),Z.write_shift(2,R),Z.write_shift(2,q,"i"),Z}function _(R,J,q){var Z=f(R,J,q);return Z[1].v=R.read_shift(8,"f"),Z}function y(R,J,q){var Z=lr(13);return Z.write_shift(1,255),Z.write_shift(2,J),Z.write_shift(2,R),Z.write_shift(8,q,"f"),Z}function S(R,J,q){var Z=R.l+J,ae=f(R,J,q);if(ae[1].v=R.read_shift(8,"f"),q.qpro)R.l=Z;else{var ye=R.read_shift(2);F(R.slice(R.l,R.l+ye),ae),R.l+=ye}return ae}function k(R,J,q){var Z=J&32768;return J&=-32769,J=(Z?R:0)+(J>=8192?J-16384:J),(Z?"":"$")+(q?fr(J):Sr(J))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(R,J){wr(R,0);for(var q=[],Z=0,ae="",ye="",Fe="",be="";R.l<R.length;){var _e=R[R.l++];switch(_e){case 0:q.push(R.read_shift(8,"f"));break;case 1:ye=k(J[0].c,R.read_shift(2),!0),ae=k(J[0].r,R.read_shift(2),!1),q.push(ye+ae);break;case 2:{var Be=k(J[0].c,R.read_shift(2),!0),V=k(J[0].r,R.read_shift(2),!1);ye=k(J[0].c,R.read_shift(2),!0),ae=k(J[0].r,R.read_shift(2),!1),q.push(Be+V+":"+ye+ae)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(R.read_shift(2));break;case 6:{for(var qe="";_e=R[R.l++];)qe+=String.fromCharCode(_e);q.push('"'+qe.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:be=q.pop(),Fe=q.pop(),q.push(["AND","OR"][_e-20]+"("+Fe+","+be+")");break;default:if(_e<32&&w[_e])be=q.pop(),Fe=q.pop(),q.push(Fe+w[_e]+be);else if(E[_e]){if(Z=E[_e][1],Z==69&&(Z=R[R.l++]),Z>q.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+q.join("|")+"|");return}var it=q.slice(-Z);q.length-=Z,q.push(E[_e][0]+"("+it.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}q.length==1?J[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function j(R){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=R.read_shift(2),J[3]=R[R.l++],J[0].c=R[R.l++],J}function D(R,J){var q=j(R);return q[1].t="s",q[1].v=R.read_shift(J-4,"cstr"),q}function A(R,J,q,Z){var ae=lr(6+Z.length);ae.write_shift(2,R),ae.write_shift(1,q),ae.write_shift(1,J),ae.write_shift(1,39);for(var ye=0;ye<Z.length;++ye){var Fe=Z.charCodeAt(ye);ae.write_shift(1,Fe>=128?95:Fe)}return ae.write_shift(1,0),ae}function M(R,J){var q=j(R);q[1].v=R.read_shift(2);var Z=q[1].v>>1;if(q[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return q[1].v=Z,q}function O(R,J){var q=j(R),Z=R.read_shift(4),ae=R.read_shift(4),ye=R.read_shift(2);if(ye==65535)return Z===0&&ae===3221225472?(q[1].t="e",q[1].v=15):Z===0&&ae===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Fe=ye&32768;return ye=(ye&32767)-16446,q[1].v=(1-Fe*2)*(ae*Math.pow(2,ye+32)+Z*Math.pow(2,ye)),q}function G(R,J,q,Z){var ae=lr(14);if(ae.write_shift(2,R),ae.write_shift(1,q),ae.write_shift(1,J),Z==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var ye=0,Fe=0,be=0,_e=0;return Z<0&&(ye=1,Z=-Z),Fe=Math.log2(Z)|0,Z/=Math.pow(2,Fe-31),_e=Z>>>0,_e&2147483648||(Z/=2,++Fe,_e=Z>>>0),Z-=_e,_e|=2147483648,_e>>>=0,Z*=Math.pow(2,32),be=Z>>>0,ae.write_shift(4,be),ae.write_shift(4,_e),Fe+=16383+(ye?32768:0),ae.write_shift(2,Fe),ae}function H(R,J){var q=O(R);return R.l+=J-14,q}function W(R,J){var q=j(R),Z=R.read_shift(4);return q[1].v=Z>>6,q}function fe(R,J){var q=j(R),Z=R.read_shift(8,"f");return q[1].v=Z,q}function Se(R,J){var q=fe(R);return R.l+=J-10,q}function le(R,J){return R[R.l+J-1]==0?R.read_shift(J,"cstr"):""}function Y(R,J){var q=R[R.l++];q>J-1&&(q=J-1);for(var Z="";Z.length<q;)Z+=String.fromCharCode(R[R.l++]);return Z}function xe(R,J,q){if(!(!q.qpro||J<21)){var Z=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var ae=R.read_shift(J-21,"cstr");return[Z,ae]}}function re(R,J){for(var q={},Z=R.l+J;R.l<Z;){var ae=R.read_shift(2);if(ae==14e3){for(q[ae]=[0,""],q[ae][0]=R.read_shift(2);R[R.l];)q[ae][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return q}function K(R,J){var q=lr(5+R.length);q.write_shift(2,14e3),q.write_shift(2,J);for(var Z=0;Z<R.length;++Z){var ae=R.charCodeAt(Z);q[q.l++]=ae>127?95:ae}return q[q.l++]=0,q}var ie={0:{n:"BOF",f:ir},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:Se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function WL(e){var t={},r=e.match(Br),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Ge(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Zp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var ZL=function(){var e=ql("t"),t=ql("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Et(o[1])},u=i.match(t);return u&&(l.s=WL(u[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),GL=function(){var t=/(\r\n|\n)/g;function r(a,i,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),XL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qL=/<(?:\w+:)?r>/,KL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Et(Pt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pt(e),r&&(n.h=Qp(n.t))):e.match(qL)&&(n.r=Pt(e),n.t=Et(Pt((e.replace(KL,"").match(XL)||[]).join("").replace(Br,""))),r&&(n.h=GL(ZL(n.r)))),n):{t:""}}var YL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,JL=/<(?:\w+:)?(?:si|sstItem)>/g,QL=/<\/(?:\w+:)?(?:si|sstItem)>/;function eF(e,t){var r=[],n="";if(!e)return r;var a=e.match(YL);if(a){n=a[2].replace(JL,"").split(QL);for(var i=0;i!=n.length;++i){var o=cm(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=Ge(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function tF(e){return[e.read_shift(4),e.read_shift(4)]}function rF(e,t){var r=[],n=!1;return Ka(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function _w(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function za(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function nF(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=za(e,4),t.U=za(e,4),t.W=za(e,4),t}function aF(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function iF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(aF(e));return t}function sF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function oF(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=za(e,4),t.U=za(e,4),t.W=za(e,4),t}function lF(e){var t=oF(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function yw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ww(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function cF(e){var t=za(e);switch(t.Minor){case 2:return[t.Minor,uF(e)];case 3:return[t.Minor,fF()];case 4:return[t.Minor,dF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function uF(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=yw(e,r),a=ww(e,e.length-e.l);return{t:"Std",h:n,v:a}}function fF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function dF(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Br,function(i){var o=Ge(i);switch(ya(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function hF(e,t){var r={},n=r.EncryptionVersionInfo=za(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=yw(e,a),t-=a,r.EncryptionVerifier=ww(e,t),r}function pF(e){var t={},r=t.EncryptionVersionInfo=za(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function mF(e){var t=0,r,n=_w(e),a=n.length+1,i,o,l,u,f;for(r=Ai(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],l=t&16384?1:0,u=t<<1&32767,f=l|u,t=f^o;return t^52811}var kw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],u=104,f=o.length-1;f>=0;--f)for(var h=o[f],m=0;m!=7;++m)h&64&&(l^=r[u]),h*=2,--u;return l};return function(o){for(var l=_w(o),u=i(l),f=l.length,h=Ai(16),m=0;m!=16;++m)h[m]=0;var g,x,_;for((f&1)===1&&(g=u>>8,h[f]=a(e[0],g),--f,g=u&255,x=l[l.length-1],h[f]=a(x,g));f>0;)--f,g=u>>8,h[f]=a(l[f],g),--f,g=u&255,h[f]=a(l[f],g);for(f=15,_=15-l.length;_>0;)g=u>>8,h[f]=a(e[_],g),--f,--_,g=u&255,h[f]=a(l[f],g),--f,--_;return h}}(),gF=function(e,t,r,n,a){a||(a=t),n||(n=kw(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},xF=function(e){var t=0,r=kw(e);return function(n){var a=gF("",n,t,r);return t=a[1],a[0]}};function vF(e,t,r,n){var a={key:ir(e),verificationBytes:ir(e)};return r.password&&(a.verifier=mF(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=xF(r.password)),a}function _F(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=pF(e):n.Data=hF(e,t),n}function yF(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?_F(e,t-2,n):vF(e,r.biff>=8?t:t-2,r,n),n}var wF=function(){function e(a,i){switch(i.type){case"base64":return t(vn(a),i);case"binary":return t(a,i);case"buffer":return t(vt&&Buffer.isBuffer(a)?a.toString("binary"):vs(a),i);case"array":return t(ds(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},l=o.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,m){Array.isArray(l)&&(l[m]=[]);for(var g=/\\\w+\b/g,x=0,_,y=-1;_=g.exec(h);){switch(_[0]){case"\\cell":var S=h.slice(x,g.lastIndex-_[0].length);if(S[0]==" "&&(S=S.slice(1)),++y,S.length){var k={v:S,t:"s"};Array.isArray(l)?l[m][y]=k:l[Qe({r:m,c:y})]=k}break}x=g.lastIndex}y>f.e.c&&(f.e.c=y)}),l["!ref"]=wt(f),l}function r(a,i){return Ri(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=qt(a["!ref"]),l,u=Array.isArray(a),f=o.s.r;f<=o.e.r;++f){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var m=Qe({r:f,c:h});l=u?(a[f]||[])[h]:a[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Za(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function kF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Jl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function EF(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var l=0,u=0,f=a+i;switch(u=o/(f>1?2-f:f),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,f/2]}function SF(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=a*l,o[0]+=a,o[1]+=u;break;case 1:u=a*(2-l),o[0]+=u,o[1]+=a;break;case 2:u=a*(l-2),o[1]+=a,o[2]+=u;break;case 3:u=a*(4-l),o[1]+=u,o[2]+=a;break;case 4:u=a*(l-4),o[2]+=a,o[0]+=u;break;case 5:u=a*(6-l),o[2]+=u,o[0]+=a;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function _f(e,t){if(t===0)return e;var r=EF(kF(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Jl(SF(r))}var Ew=6,TF=15,CF=1,Vr=Ew;function yf(e){return Math.floor((e+Math.round(128/Vr)/256)*Vr)}function wf(e){return Math.floor((e-5)/Vr*100+.5)/100}function Ch(e){return Math.round((e*Vr+5)/Vr*256)/256}function ud(e){return Ch(wf(yf(e)))}function um(e){var t=Math.abs(e-ud(e)),r=Vr;if(t>.005)for(Vr=CF;Vr<TF;++Vr)Math.abs(e-ud(e))<=t&&(t=Math.abs(e-ud(e)),r=Vr);Vr=r}function vo(e){e.width?(e.wpx=yf(e.width),e.wch=wf(e.wpx),e.MDW=Vr):e.wpx?(e.wch=wf(e.wpx),e.width=Ch(e.wch),e.MDW=Vr):typeof e.wch=="number"&&(e.width=Ch(e.wch),e.wpx=yf(e.width),e.MDW=Vr),e.customWidth&&delete e.customWidth}var bF=96,Sw=bF;function Tw(e){return e*96/Sw}function Ql(e){return e*Sw/96}var NF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function AF(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Br)||[]).forEach(function(o){var l=Ge(o);switch(ya(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Dt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Dt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function LF(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Br)||[]).forEach(function(o){var l=Ge(o);switch(ya(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function FF(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Br)||[]).forEach(function(o){var l=Ge(o);switch(ya(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Pt(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Dt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Dt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Dt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Dt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Dt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Dt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Dt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Zp[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Dt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var u=ns[a.color.index];a.color.index==81&&(u=ns[1]),u||(u=ns[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=_f(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function PF(e,t,r){t.NumberFmt=[];for(var n=va(nt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=nt[n[a]];var i=e[0].match(Br);if(i)for(a=0;a<i.length;++a){var o=Ge(i[a]);switch(ya(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Et(Pt(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}rs(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var cu=["numFmtId","fillId","fontId","borderId","xfId"],uu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function OF(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Br)||[]).forEach(function(i){var o=Ge(i),l=0;switch(ya(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<cu.length;++l)n[cu[l]]&&(n[cu[l]]=parseInt(n[cu[l]],10));for(l=0;l<uu.length;++l)n[uu[l]]&&(n[uu[l]]=Dt(n[uu[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Dt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var RF=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,f){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&PF(m,h,f),(m=l.match(a))&&FF(m,h,u,f),(m=l.match(n))&&LF(m,h,u,f),(m=l.match(i))&&AF(m,h,u,f),(m=l.match(r))&&OF(m,h,f),h}}();function MF(e,t){var r=e.read_shift(2),n=Ir(e);return[r,n]}function IF(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=ZN(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=WN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ir(e),n}var DF=jr;function jF(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var BF=jr;function zF(e,t,r){var n={};n.NumberFmt=[];for(var a in nt)n.NumberFmt[a]=nt[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Ka(e,function(u,f,h){switch(h){case 44:n.NumberFmt[u[0]]=u[1],rs(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=_f(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(h),o=!0;break;case 38:i.pop(),o=!1;break;default:if(f.T>0)i.push(h);else if(f.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var UF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function HF(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Br)||[]).forEach(function(a){var i=Ge(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[UF.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function VF(){}function $F(){}var WF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ZF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,GF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function XF(e,t,r){t.themeElements={};var n;[["clrScheme",WF,HF],["fontScheme",ZF,VF],["fmtScheme",GF,$F]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var qF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Cw(e,t){(!e||e.length===0)&&(e=KF());var r,n={};if(!(r=e.match(qF)))throw new Error("themeElements not found in theme");return XF(r[0],n,t),n.raw=e,n}function KF(e,t){var r=[D2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function YF(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=I2(i,{type:"array"})}catch{return}var l=hn(o,"theme/theme/theme1.xml",!0);if(l)return Cw(l,r)}}function JF(e){return e.read_shift(4)}function QF(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=e6(e,4);break;case 2:t.xclrValue=dw(e);break;case 3:t.xclrValue=JF(e);break;case 4:e.l+=4;break}return e.l+=8,t}function e6(e,t){return jr(e,t)}function t6(e,t){return jr(e,t)}function r6(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=QF(e);break;case 6:n[1]=t6(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function n6(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(r6(e,r-e.l));return{ixfe:n,ext:i}}function a6(e,t){t.forEach(function(r){switch(r[0]){}})}function i6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ir(e)}}function s6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function o6(e){return e.l+=4,e.read_shift(4)!=0}function l6(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,l=2;return Ka(e,function(u,f,h){switch(h){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:i.push(h),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!f.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function c6(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(Br,function(l){var u=Ge(l);switch(ya(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(o=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):i==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function u6(e){var t=[];if(!e)return t;var r=1;return(e.match(Br)||[]).forEach(function(n){var a=Ge(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function f6(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Qe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function d6(e,t,r){var n=[];return Ka(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function h6(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Ka(e,function(l,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function p6(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function O1(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var l=Wr(o.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[o.ref]=i;var u=qt(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var f=wt(u);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(h.a==n[m].id){h.a=n[m].name||h.a;break}}i.c.push(h)})}function m6(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Ge(l[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=Wr(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&cm(m[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function g6(e,t){var r=[],n=!1,a={},i=0;return e.replace(Br,function(l,u){var f=Ge(l);switch(ya(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=u+l.length;break;case"</text>":a.t=e.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return l}),r}function x6(e,t){var r=[],n=!1;return e.replace(Br,function(i){var o=Ge(i);switch(ya(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function v6(e){var t={};t.iauthor=e.read_shift(4);var r=ys(e);return t.rfx=r.s,t.ref=Qe(r.s),e.l+=16,t}var _6=Ir;function y6(e,t){var r=[],n=[],a={},i=!1;return Ka(e,function(l,u,f){switch(f){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var w6="application/vnd.ms-office.vbaProject";function k6(e){var t=yt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");yt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),yt.write(t)}function E6(){return{"!type":"dialog"}}function S6(){return{"!type":"dialog"}}function T6(){return{"!type":"macro"}}function C6(){return{"!type":"macro"}}var oo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var l=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,u?f+=t.r:--f,a+(l?"":"$")+fr(h)+(u?"":"$")+Sr(f)}return function(a,i){return t=i,a.replace(e,r)}}(),bw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,b6=function(){return function(t,r){return t.replace(bw,function(n,a,i,o,l,u){var f=nm(o)-(i?0:r.c),h=rm(u)-(l?0:r.r),m=h==0?"":l?h+1:"["+h+"]",g=f==0?"":i?f+1:"["+f+"]";return a+"R"+m+"C"+g})}}();function Nw(e,t){return e.replace(bw,function(r,n,a,i,o,l){return n+(a=="$"?a+i:fr(nm(i)+t.c))+(o=="$"?o+l:Sr(rm(l)+t.r))})}function N6(e,t,r){var n=Ao(t),a=n.s,i=Wr(r),o={r:i.r-a.r,c:i.c-a.c};return Nw(e,o)}function A6(e){return e.length!=1}function R1(e){return e.replace(/_xlfn\./g,"")}function nr(e){e.l+=1}function Li(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Aw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Lw(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Li(e),l=Li(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Lw(e){var t=Li(e),r=Li(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function L6(e,t,r){if(r.biff<8)return Lw(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Li(e),o=Li(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Fw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return F6(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Li(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function F6(e){var t=Li(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function P6(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function O6(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return R6(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function R6(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function M6(e,t,r){var n=(e[e.l++]&96)>>5,a=Aw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function I6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=Aw(e,i,r);return[n,a,o]}function D6(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function j6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function B6(e,t,r){var n=(e[e.l++]&96)>>5,a=L6(e,t-1,r);return[n,a]}function z6(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function M1(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function U6(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function H6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function V6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function $6(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function W6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Pw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Z6(e){return e.read_shift(2),Pw(e)}function G6(e){return e.read_shift(2),Pw(e)}function X6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Fw(e,0,r);return[n,a]}function q6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=O6(e,0,r);return[n,a]}function K6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Fw(e,0,r);return[n,a,i]}function Y6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[JP[a],Mw[a],n]}function J6(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Q6(e);return[a,(i[0]===0?Mw:YP)[i[1]]]}function Q6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function eP(e,t,r){e.l+=r&&r.biff==2?3:4}function tP(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function rP(e){return e.l++,ws[e.read_shift(1)]}function nP(e){return e.l++,e.read_shift(2)}function aP(e){return e.l++,e.read_shift(1)!==0}function iP(e){return e.l++,Rr(e)}function sP(e,t,r){return e.l++,pc(e,t-1,r)}function oP(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Yt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ws[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Rr(e);break;case 2:r[1]=ks(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function lP(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?ys:Jf)(e));return a}function cP(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=oP(e,r.biff);return o}function uP(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function fP(e,t,r){if(r.biff==5)return dP(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function dP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function hP(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function pP(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function mP(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function gP(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var xP=jr,vP=jr,_P=jr;function gc(e,t,r){return e.l+=2,[P6(e)]}function fm(e){return e.l+=6,[]}var yP=gc,wP=fm,kP=fm,EP=gc;function Ow(e){return e.l+=2,[ir(e),e.read_shift(2)&1]}var SP=gc,TP=Ow,CP=fm,bP=gc,NP=gc,AP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function LP(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=AP[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function FP(e){return e.l+=2,[e.read_shift(4)]}function PP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function OP(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function RP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function MP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IP(e){return e.l+=4,[0,0]}var I1={1:{n:"PtgExp",f:tP},2:{n:"PtgTbl",f:_P},3:{n:"PtgAdd",f:nr},4:{n:"PtgSub",f:nr},5:{n:"PtgMul",f:nr},6:{n:"PtgDiv",f:nr},7:{n:"PtgPower",f:nr},8:{n:"PtgConcat",f:nr},9:{n:"PtgLt",f:nr},10:{n:"PtgLe",f:nr},11:{n:"PtgEq",f:nr},12:{n:"PtgGe",f:nr},13:{n:"PtgGt",f:nr},14:{n:"PtgNe",f:nr},15:{n:"PtgIsect",f:nr},16:{n:"PtgUnion",f:nr},17:{n:"PtgRange",f:nr},18:{n:"PtgUplus",f:nr},19:{n:"PtgUminus",f:nr},20:{n:"PtgPercent",f:nr},21:{n:"PtgParen",f:nr},22:{n:"PtgMissArg",f:nr},23:{n:"PtgStr",f:sP},26:{n:"PtgSheet",f:PP},27:{n:"PtgEndSheet",f:OP},28:{n:"PtgErr",f:rP},29:{n:"PtgBool",f:aP},30:{n:"PtgInt",f:nP},31:{n:"PtgNum",f:iP},32:{n:"PtgArray",f:z6},33:{n:"PtgFunc",f:Y6},34:{n:"PtgFuncVar",f:J6},35:{n:"PtgName",f:uP},36:{n:"PtgRef",f:X6},37:{n:"PtgArea",f:M6},38:{n:"PtgMemArea",f:hP},39:{n:"PtgMemErr",f:xP},40:{n:"PtgMemNoMem",f:vP},41:{n:"PtgMemFunc",f:pP},42:{n:"PtgRefErr",f:mP},43:{n:"PtgAreaErr",f:D6},44:{n:"PtgRefN",f:q6},45:{n:"PtgAreaN",f:B6},46:{n:"PtgMemAreaN",f:RP},47:{n:"PtgMemNoMemN",f:MP},57:{n:"PtgNameX",f:fP},58:{n:"PtgRef3d",f:K6},59:{n:"PtgArea3d",f:I6},60:{n:"PtgRefErr3d",f:gP},61:{n:"PtgAreaErr3d",f:j6},255:{}},DP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jP={1:{n:"PtgElfLel",f:Ow},2:{n:"PtgElfRw",f:bP},3:{n:"PtgElfCol",f:yP},6:{n:"PtgElfRwV",f:NP},7:{n:"PtgElfColV",f:EP},10:{n:"PtgElfRadical",f:SP},11:{n:"PtgElfRadicalS",f:CP},13:{n:"PtgElfColS",f:wP},15:{n:"PtgElfColSV",f:kP},16:{n:"PtgElfRadicalLel",f:TP},25:{n:"PtgList",f:LP},29:{n:"PtgSxName",f:FP},255:{}},BP={0:{n:"PtgAttrNoop",f:IP},1:{n:"PtgAttrSemi",f:W6},2:{n:"PtgAttrIf",f:V6},4:{n:"PtgAttrChoose",f:U6},8:{n:"PtgAttrGoto",f:H6},16:{n:"PtgAttrSum",f:eP},32:{n:"PtgAttrBaxcel",f:M1},33:{n:"PtgAttrBaxcel",f:M1},64:{n:"PtgAttrSpace",f:Z6},65:{n:"PtgAttrSpaceSemi",f:G6},128:{n:"PtgAttrIfError",f:$6},255:{}};function xc(e,t,r,n){if(n.biff<8)return jr(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=cP(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=lP(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(jr(e,t)),i}function vc(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=I1[i]||I1[DP[i]],(i===24||i===25)&&(a=(i===24?jP:BP)[e[e.l+1]]),!a||!a.f?jr(e,t):o.push([a.n,a.f(e,t,r)]);return o}function zP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var UP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HP(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Rw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function D1(e,t,r){var n=Rw(e,t,r);return n=="#REF"?n:HP(n,r)}function Fr(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],u,f,h,m=0,g=0,x,_="";if(!e[0]||!e[0][0])return"";for(var y=-1,S="",k=0,E=e[0].length;k<E;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),y>=0){switch(e[0][y][1][0]){case 0:S=Xt(" ",e[0][y][1][1]);break;case 1:S=Xt("\r",e[0][y][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+S,y=-1}l.push(f+UP[w[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=yl(w[1][1],o,a),l.push(wl(h,i));break;case"PtgRefN":h=r?yl(w[1][1],r,a):w[1][1],l.push(wl(h,i));break;case"PtgRef3d":m=w[1][1],h=yl(w[1][2],o,a),_=D1(n,m,a),l.push(_+"!"+wl(h,i));break;case"PtgFunc":case"PtgFuncVar":var F=w[1][0],j=w[1][1];F||(F=0),F&=127;var D=F==0?[]:l.slice(-F);l.length-=F,j==="User"&&(j=D.shift()),l.push(j+"("+D.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":x=x1(w[1][1],r?{s:r}:o,a),l.push(ld(x,a));break;case"PtgArea":x=x1(w[1][1],o,a),l.push(ld(x,a));break;case"PtgArea3d":m=w[1][1],x=w[1][2],_=D1(n,m,a),l.push(_+"!"+ld(x,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=w[1][2];var A=(n.names||[])[g-1]||(n[0]||[])[g],M=A?A.Name:"SH33TJSNAME"+String(g);M&&M.slice(0,6)=="_xlfn."&&!a.xlfn&&(M=M.slice(6)),l.push(M);break;case"PtgNameX":var O=w[1][1];g=w[1][2];var G;if(a.biff<=5)O<0&&(O=-O),n[O]&&(G=n[O][g]);else{var H="";if(((n[O]||[])[0]||[])[0]==14849||(((n[O]||[])[0]||[])[0]==1025?n[O][g]&&n[O][g].itab>0&&(H=n.SheetNames[n[O][g].itab-1]+"!"):H=n.SheetNames[g-1]+"!"),n[O]&&n[O][g])H+=n[O][g].Name;else if(n[0]&&n[0][g])H+=n[0][g].Name;else{var W=(Rw(n,O,a)||"").split(";;");W[g-1]?H=W[g-1]:H+="SH33TJSERRX"}l.push(H);break}G||(G={Name:"SH33TJSERRY"}),l.push(G.Name);break;case"PtgParen":var fe="(",Se=")";if(y>=0){switch(S="",e[0][y][1][0]){case 2:fe=Xt(" ",e[0][y][1][1])+fe;break;case 3:fe=Xt("\r",e[0][y][1][1])+fe;break;case 4:Se=Xt(" ",e[0][y][1][1])+Se;break;case 5:Se=Xt("\r",e[0][y][1][1])+Se;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}l.push(fe+l.pop()+Se);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:w[1][1],r:w[1][0]};var le={c:r.c,r:r.r};if(n.sharedf[Qe(h)]){var Y=n.sharedf[Qe(h)];l.push(Fr(Y,o,le,n,a))}else{var xe=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){l.push(Fr(f[1],o,le,n,a)),xe=!0;break}xe||l.push(w[1])}break;case"PtgArray":l.push("{"+zP(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&y>=0&&re.indexOf(e[0][k][0])==-1){w=e[0][y];var K=!0;switch(w[1][0]){case 4:K=!1;case 0:S=Xt(" ",w[1][1]);break;case 5:K=!1;case 1:S=Xt("\r",w[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((K?S:"")+l.pop()+(K?"":S)),y=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function VP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],jr(e,t-2)];var l=vc(e,o,r);return t!==o+a&&(i=xc(e,t-o-a,l,r)),e.l=n,[l,i]}function $P(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],jr(e,t-2)];var l=vc(e,o,r);return t!==o+a&&(i=xc(e,t-o-a,l,r)),e.l=n,[l,i]}function WP(e,t,r,n){var a=e.l+t,i=vc(e,n,r),o;return a!==e.l&&(o=xc(e,a-e.l,i,r)),[i,o]}function ZP(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=vc(e,i,r);return i==65535?[[],jr(e,t-2)]:(t!==i+2&&(a=xc(e,n-i-2,o,r)),[o,a])}function GP(e){var t;if(Ia(e,e.l+6)!==65535)return[Rr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function fd(e,t,r){var n=e.l+t,a=wa(e);r.biff==2&&++e.l;var i=GP(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=$P(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function Qf(e,t,r){var n=e.read_shift(4),a=vc(e,n,r),i=e.read_shift(4),o=i>0?xc(e,i,a,r):null;return[a,o]}var XP=Qf,e0=Qf,qP=Qf,KP=Qf,YP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Mw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},JP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function j1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function dd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Tl={},lo={};function Cl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Iw(e,t,r,n,a,i){try{n.cellNF&&(e.z=nt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=vr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(nt[t]==null&&rs(Qb[t]||"General",t),e.t==="e")e.w=e.w||ws[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xl(e.v);else if(e.t==="d"){var o=Xr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Xl(o)}else{if(e.v===void 0)return"";e.w=fs(e.v,lo)}else e.t==="d"?e.w=Dn(t,Xr(e.v),lo):e.w=Dn(t,e.v,lo)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=_f(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=_f(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function QP(e,t){var r=qt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=wt(r))}var e5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,t5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,r5=/<(?:\w:)?hyperlink [^>]*>/mg,n5=/"(\w*:\w*)"/,a5=/<(?:\w:)?col\b[^>]*[\/]?>/g,i5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,s5=/<(?:\w:)?pageMargins[^>]*\/>/g,Dw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,o5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,l5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function c5(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",m=e.match(t5);m?(f=e.slice(0,m.index),h=e.slice(m.index+m[0].length)):f=h=e;var g=f.match(Dw);g?dm(g[0],l,a,r):(g=f.match(o5))&&u5(g[0],g[1]||"",l,a,r);var x=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var _=f.slice(x,x+50).match(n5);_&&QP(l,_[1])}var y=f.match(l5);y&&y[1]&&g5(y[1],a);var S=[];if(t.cellStyles){var k=f.match(a5);k&&h5(S,k)}m&&x5(m[1],l,t,u,i,o);var E=h.match(i5);E&&(l["!autofilter"]=p5(E[0]));var w=[],F=h.match(e5);if(F)for(x=0;x!=F.length;++x)w[x]=qt(F[x].slice(F[x].indexOf('"')+1));var j=h.match(r5);j&&f5(l,j,n);var D=h.match(s5);if(D&&(l["!margins"]=d5(Ge(D[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=wt(u)),t.sheetRows>0&&l["!ref"]){var A=qt(l["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>u.e.r&&(A.e.r=u.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>u.e.c&&(A.e.c=u.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=wt(A))}return S.length>0&&(l["!cols"]=S),w.length>0&&(l["!merges"]=w),l}function dm(e,t,r,n){var a=Ge(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Et(Pt(a.codeName)))}function u5(e,t,r,n,a){dm(e.slice(0,e.indexOf(">")),r,n,a)}function f5(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Ge(Pt(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Et(i.location))):(i.Target="#"+Et(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=qt(i.ref),u=l.s.r;u<=l.e.r;++u)for(var f=l.s.c;f<=l.e.c;++f){var h=Qe({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function d5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function h5(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ge(t[n],!0);a.hidden&&(a.hidden=Dt(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,um(a.width)),vo(a);i<=o;)e[i++]=Er(a)}}function p5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var m5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function g5(e,t){t.Views||(t.Views=[{}]),(e.match(m5)||[]).forEach(function(r,n){var a=Ge(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Dt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var x5=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=ql("v"),o=ql("f");return function(u,f,h,m,g,x){for(var _=0,y="",S=[],k=[],E=0,w=0,F=0,j="",D,A,M=0,O=0,G,H,W=0,fe=0,Se=Array.isArray(x.CellXf),le,Y=[],xe=[],re=Array.isArray(f),K=[],ie={},he=!1,R=!!h.sheetStubs,J=u.split(t),q=0,Z=J.length;q!=Z;++q){y=J[q].trim();var ae=y.length;if(ae!==0){var ye=0;e:for(_=0;_<ae;++_)switch(y[_]){case">":if(y[_-1]!="/"){++_;break e}if(h&&h.cellStyles){if(A=Ge(y.slice(ye,_),!0),M=A.r!=null?parseInt(A.r,10):M+1,O=-1,h.sheetRows&&h.sheetRows<M)continue;ie={},he=!1,A.ht&&(he=!0,ie.hpt=parseFloat(A.ht),ie.hpx=Ql(ie.hpt)),A.hidden=="1"&&(he=!0,ie.hidden=!0),A.outlineLevel!=null&&(he=!0,ie.level=+A.outlineLevel),he&&(K[M-1]=ie)}break;case"<":ye=_;break}if(ye>=_)break;if(A=Ge(y.slice(ye,_),!0),M=A.r!=null?parseInt(A.r,10):M+1,O=-1,!(h.sheetRows&&h.sheetRows<M)){m.s.r>M-1&&(m.s.r=M-1),m.e.r<M-1&&(m.e.r=M-1),h&&h.cellStyles&&(ie={},he=!1,A.ht&&(he=!0,ie.hpt=parseFloat(A.ht),ie.hpx=Ql(ie.hpt)),A.hidden=="1"&&(he=!0,ie.hidden=!0),A.outlineLevel!=null&&(he=!0,ie.level=+A.outlineLevel),he&&(K[M-1]=ie)),S=y.slice(_).split(e);for(var Fe=0;Fe!=S.length&&S[Fe].trim().charAt(0)=="<";++Fe);for(S=S.slice(Fe),_=0;_!=S.length;++_)if(y=S[_].trim(),y.length!==0){if(k=y.match(r),E=_,w=0,F=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(E=0,j=k[1],w=0;w!=j.length&&!((F=j.charCodeAt(w)-64)<1||F>26);++w)E=26*E+F;--E,O=E}else++O;for(w=0;w!=y.length&&y.charCodeAt(w)!==62;++w);if(++w,A=Ge(y.slice(0,w),!0),A.r||(A.r=Qe({r:M-1,c:O})),j=y.slice(w),D={t:""},(k=j.match(i))!=null&&k[1]!==""&&(D.v=Et(k[1])),h.cellFormula){if((k=j.match(o))!=null&&k[1]!==""){if(D.f=Et(Pt(k[1])).replace(/\r\n/g,`
`),h.xlfn||(D.f=R1(D.f)),k[0].indexOf('t="array"')>-1)D.F=(j.match(a)||[])[1],D.F.indexOf(":")>-1&&Y.push([qt(D.F),D.F]);else if(k[0].indexOf('t="shared"')>-1){H=Ge(k[0]);var be=Et(Pt(k[1]));h.xlfn||(be=R1(be)),xe[parseInt(H.si,10)]=[H,be,A.r]}}else(k=j.match(/<f[^>]*\/>/))&&(H=Ge(k[0]),xe[H.si]&&(D.f=N6(xe[H.si][1],xe[H.si][2],A.r)));var _e=Wr(A.r);for(w=0;w<Y.length;++w)_e.r>=Y[w][0].s.r&&_e.r<=Y[w][0].e.r&&_e.c>=Y[w][0].s.c&&_e.c<=Y[w][0].e.c&&(D.F=Y[w][1])}if(A.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(R)D.t="z";else continue;else D.t=A.t||"n";switch(m.s.c>O&&(m.s.c=O),m.e.c<O&&(m.e.c=O),D.t){case"n":if(D.v==""||D.v==null){if(!R)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!R)continue;D.t="z"}else G=Tl[parseInt(D.v,10)],D.v=G.t,D.r=G.r,h.cellHTML&&(D.h=G.h);break;case"str":D.t="s",D.v=D.v!=null?Pt(D.v):"",h.cellHTML&&(D.h=Qp(D.v));break;case"inlineStr":k=j.match(n),D.t="s",k!=null&&(G=cm(k[1]))?(D.v=G.t,h.cellHTML&&(D.h=G.h)):D.v="";break;case"b":D.v=Dt(D.v);break;case"d":h.cellDates?D.v=vr(D.v,1):(D.v=Xr(vr(D.v,1)),D.t="n");break;case"e":(!h||h.cellText!==!1)&&(D.w=D.v),D.v=aw[D.v];break}if(W=fe=0,le=null,Se&&A.s!==void 0&&(le=x.CellXf[A.s],le!=null&&(le.numFmtId!=null&&(W=le.numFmtId),h.cellStyles&&le.fillId!=null&&(fe=le.fillId))),Iw(D,W,fe,h,g,x),h.cellDates&&Se&&D.t=="n"&&No(nt[W])&&(D.t="d",D.v=Yf(D.v)),A.cm&&h.xlmeta){var Be=(h.xlmeta.Cell||[])[+A.cm-1];Be&&Be.type=="XLDAPR"&&(D.D=!0)}if(re){var V=Wr(A.r);f[V.r]||(f[V.r]=[]),f[V.r][V.c]=D}else f[A.r]=D}}}}K.length>0&&(f["!rows"]=K)}}();function v5(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var _5=ys;function y5(){}function w5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=VN(e),r}function k5(e){var t=jn(e);return[t]}function E5(e){var t=_s(e);return[t]}function S5(e){var t=jn(e),r=e.read_shift(1);return[t,r,"b"]}function T5(e){var t=_s(e),r=e.read_shift(1);return[t,r,"b"]}function C5(e){var t=jn(e),r=e.read_shift(1);return[t,r,"e"]}function b5(e){var t=_s(e),r=e.read_shift(1);return[t,r,"e"]}function N5(e){var t=jn(e),r=e.read_shift(4);return[t,r,"s"]}function A5(e){var t=_s(e),r=e.read_shift(4);return[t,r,"s"]}function L5(e){var t=jn(e),r=Rr(e);return[t,r,"n"]}function jw(e){var t=_s(e),r=Rr(e);return[t,r,"n"]}function F5(e){var t=jn(e),r=sm(e);return[t,r,"n"]}function P5(e){var t=_s(e),r=sm(e);return[t,r,"n"]}function O5(e){var t=jn(e),r=am(e);return[t,r,"is"]}function R5(e){var t=jn(e),r=Ir(e);return[t,r,"str"]}function M5(e){var t=_s(e),r=Ir(e);return[t,r,"str"]}function I5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Fr(l,null,a,r.supbooks,r)}else e.l=n;return o}function D5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Fr(l,null,a,r.supbooks,r)}else e.l=n;return o}function j5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=Rr(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Fr(l,null,a,r.supbooks,r)}else e.l=n;return o}function B5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=Ir(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Fr(l,null,a,r.supbooks,r)}else e.l=n;return o}var z5=ys;function U5(e,t){var r=e.l+t,n=ys(e),a=im(e),i=Ir(e),o=Ir(e),l=Ir(e);e.l=r;var u={rfx:n,relId:a,loc:i,display:l};return o&&(u.Tooltip=o),u}function H5(){}function V5(e,t,r){var n=e.l+t,a=tw(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var l=XP(e,n-e.l,r);o[1]=l}else e.l=n;return o}function $5(e,t,r){var n=e.l+t,a=ys(e),i=[a];if(r.cellFormula){var o=KP(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}var W5=["left","right","top","bottom","header","footer"];function Z5(e){var t={};return W5.forEach(function(r){t[r]=Rr(e)}),t}function G5(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function X5(){}function q5(){}function K5(e,t,r,n,a,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,x,_,y,S,k,E,w,F,j,D=[];l.biff=12,l["!row"]=0;var A=0,M=!1,O=[],G={},H=l.supbooks||a.supbooks||[[]];if(H.sharedf=G,H.arrayf=O,H.SheetNames=a.SheetNames||a.Sheets.map(function(re){return re.name}),!l.supbooks&&(l.supbooks=H,a.Names))for(var W=0;W<a.Names.length;++W)H[0][W+1]=a.Names[W];var fe=[],Se=[],le=!1;kf[16]={n:"BrtShortReal",f:jw};var Y;if(Ka(e,function(K,ie,he){if(!g)switch(he){case 148:f=K;break;case 0:x=K,l.sheetRows&&l.sheetRows<=x.r&&(g=!0),F=Sr(S=x.r),l["!row"]=x.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=Ql(K.hpt)),Se[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:K[2]},K[2]){case"n":_.v=K[1];break;case"s":w=Tl[K[1]],_.v=w.t,_.r=w.r;break;case"b":_.v=!!K[1];break;case"e":_.v=K[1],l.cellText!==!1&&(_.w=ws[_.v]);break;case"str":_.t="s",_.v=K[1];break;case"is":_.t="s",_.v=K[1].t;break}if((y=o.CellXf[K[0].iStyleRef])&&Iw(_,y.numFmtId,null,l,i,o),k=K[0].c==-1?k+1:K[0].c,l.dense?(u[S]||(u[S]=[]),u[S][k]=_):u[fr(k)+F]=_,l.cellFormula){for(M=!1,A=0;A<O.length;++A){var R=O[A];x.r>=R[0].s.r&&x.r<=R[0].e.r&&k>=R[0].s.c&&k<=R[0].e.c&&(_.F=wt(R[0]),M=!0)}!M&&K.length>3&&(_.f=K[3])}if(h.s.r>x.r&&(h.s.r=x.r),h.s.c>k&&(h.s.c=k),h.e.r<x.r&&(h.e.r=x.r),h.e.c<k&&(h.e.c=k),l.cellDates&&y&&_.t=="n"&&No(nt[y.numFmtId])){var J=Yi(_.v);J&&(_.t="d",_.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Y&&(Y.type=="XLDAPR"&&(_.D=!0),Y=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;_={t:"z",v:void 0},k=K[0].c==-1?k+1:K[0].c,l.dense?(u[S]||(u[S]=[]),u[S][k]=_):u[fr(k)+F]=_,h.s.r>x.r&&(h.s.r=x.r),h.s.c>k&&(h.s.c=k),h.e.r<x.r&&(h.e.r=x.r),h.e.c<k&&(h.e.c=k),Y&&(Y.type=="XLDAPR"&&(_.D=!0),Y=void 0);break;case 176:D.push(K);break;case 49:Y=((l.xlmeta||{}).Cell||[])[K-1];break;case 494:var q=n["!id"][K.relId];for(q?(K.Target=q.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=q):K.relId==""&&(K.Target="#"+K.loc),S=K.rfx.s.r;S<=K.rfx.e.r;++S)for(k=K.rfx.s.c;k<=K.rfx.e.c;++k)l.dense?(u[S]||(u[S]=[]),u[S][k]||(u[S][k]={t:"z",v:void 0}),u[S][k].l=K):(E=Qe({c:k,r:S}),u[E]||(u[E]={t:"z",v:void 0}),u[E].l=K);break;case 426:if(!l.cellFormula)break;O.push(K),j=l.dense?u[S][k]:u[fr(k)+F],j.f=Fr(K[1],h,{r:x.r,c:k},H,l),j.F=wt(K[0]);break;case 427:if(!l.cellFormula)break;G[Qe(K[0].s)]=K[1],j=l.dense?u[S][k]:u[fr(k)+F],j.f=Fr(K[1],h,{r:x.r,c:k},H,l);break;case 60:if(!l.cellStyles)break;for(;K.e>=K.s;)fe[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},le||(le=!0,um(K.w/256)),vo(fe[K.e+1]);break;case 161:u["!autofilter"]={ref:wt(K)};break;case 476:u["!margins"]=K;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),K.name&&(a.Sheets[r].CodeName=K.name),(K.above||K.left)&&(u["!outline"]={above:K.above,left:K.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),K.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!ie.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=wt(f||h)),l.sheetRows&&u["!ref"]){var xe=qt(u["!ref"]);l.sheetRows<=+xe.e.r&&(xe.e.r=l.sheetRows-1,xe.e.r>h.e.r&&(xe.e.r=h.e.r),xe.e.r<xe.s.r&&(xe.s.r=xe.e.r),xe.e.c>h.e.c&&(xe.e.c=h.e.c),xe.e.c<xe.s.c&&(xe.s.c=xe.e.c),u["!fullref"]=u["!ref"],u["!ref"]=wt(xe))}return D.length>0&&(u["!merges"]=D),fe.length>0&&(u["!cols"]=fe),Se.length>0&&(u["!rows"]=Se),u}function Y5(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=Et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function J5(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,u=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=Y5(m);h.s.r=h.s.c=0,h.e.c=l,f=fr(l),g[0].forEach(function(x,_){o[f+Sr(_)]={t:"n",v:x,z:g[1]},u=_}),h.e.r<u&&(h.e.r=u),++l}),l>0&&(o["!ref"]=wt(h)),o}function Q5(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Dw);return l&&dm(l[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function e8(e,t){e.l+=10;var r=Ir(e);return{name:r}}function t8(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ka(e,function(u,f,h){switch(h){case 550:i["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Bw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],r8=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],n8=[],a8=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function B1(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Dt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function z1(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Dt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function zw(e){z1(e.WBProps,Bw),z1(e.CalcPr,a8),B1(e.WBView,r8),B1(e.Sheets,n8),lo.date1904=Dt(e.WBProps.date1904)}var i8="][*?/\\".split("");function s8(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return i8.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var o8=/<\w+:workbook/;function l8(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(Br,function(u,f){var h=Ge(u);switch(ya(h[0])){case"<?xml":break;case"<workbook":u.match(o8)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Bw.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Dt(h[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:r.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(r.WBProps.CodeName=Pt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Et(Pt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Pt(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Dt(h.hidden||"0")&&(i.Hidden=!0),o=f+u.length;break;case"</definedName>":i.Ref=Et(Pt(e.slice(o,f))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),CN.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return zw(r),r}function c8(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Eh(e),r.name=Ir(e),r}function u8(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Ir(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function f8(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function d8(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=$N(e),o=qP(e,0,r),l=im(e);e.l=n;var u={Name:i,Ptg:o};return a<268435455&&(u.Sheet=a),l&&(u.Comment=l),u}function h8(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],kf[16]={n:"BrtFRTArchID$",f:f8},Ka(e,function(u,f,h){switch(h){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Fr(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,u]):o[0]=[h,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),zw(r),r.Names=i,r.supbooks=o,r}function p8(e,t,r){return t.slice(-4)===".bin"?h8(e,r):l8(e,r)}function m8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?K5(e,n,r,a,i,o,l):c5(e,n,r,a,i,o,l)}function g8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?t8(e,n,r,a,i):Q5(e,n,r,a,i)}function x8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?T6():C6()}function v8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?E6():S6()}function _8(e,t,r,n){return t.slice(-4)===".bin"?zF(e,r,n):RF(e,r,n)}function y8(e,t,r){return Cw(e,r)}function w8(e,t,r){return t.slice(-4)===".bin"?rF(e,r):eF(e,r)}function k8(e,t,r){return t.slice(-4)===".bin"?y6(e,r):m6(e,r)}function E8(e,t,r){return t.slice(-4)===".bin"?d6(e):u6(e)}function S8(e,t,r,n){return r.slice(-4)===".bin"?h6(e,t,r,n):void 0}function T8(e,t,r){return t.slice(-4)===".bin"?l6(e,t,r):c6(e,t,r)}var Uw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Hw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Uw),i,o,l,u;if(a)for(u=0;u!=a.length;++u)i=a[u].match(Hw),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function C8(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Uw),a,i,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(Hw),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var bl;function b8(e,t){var r=bl[e]||Et(e);return r==="General"?fs(t):Dn(r,t)}function N8(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Dt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Et(t)]=a}function A8(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ws[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xl(e.v):e.w=fs(e.v):e.w=b8(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=bl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&No(n)){var a=Yi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function L8(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=NF[n.Pattern]||n.Pattern)}e[t.ID]=t}function F8(e,t,r,n,a,i,o,l,u,f){var h="General",m=n.StyleID,g={};f=f||{};var x=[],_=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(h=i[m].nf),i[m].Interior&&x.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Dt(e);break;case"String":n.t="s",n.r=l1(Et(e)),n.v=e.indexOf("<")>-1?Et(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(vr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Et(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=aw[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=l1(t||e));break}if(A8(n,h,f),f.cellFormula!==!1)if(n.Formula){var y=Et(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=oo(y,a),delete n.Formula,n.ArrayRange=="RC"?n.F=oo("RC:RC",a):n.ArrayRange&&(n.F=oo(n.ArrayRange,a),u.push([qt(n.F),n.F]))}else for(_=0;_<u.length;++_)a.r>=u[_][0].s.r&&a.r<=u[_][0].e.r&&a.c>=u[_][0].s.c&&a.c<=u[_][0].e.c&&(n.F=u[_][1]);f.cellStyles&&(x.forEach(function(S){!g.patternType&&S.patternType&&(g.patternType=S.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function P8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function hd(e,t){var r=t||{};L2();var n=al(em(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Pt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Er(r);return o.type="string",Yl.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(St){a.indexOf("<"+St)>=0&&(i=!0)}),i)return U8(n,r);bl={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],f,h={},m=[],g=r.dense?[]:{},x="",_={},y={},S=Vn('<Data ss:Type="String">'),k=0,E=0,w=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},D={},A="",M=0,O=[],G={},H={},W=0,fe=[],Se=[],le={},Y=[],xe,re=!1,K=[],ie=[],he={},R=0,J=0,q={Sheets:[],WBProps:{date1904:!1}},Z={};Kl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";l=Kl.exec(n);)switch(l[3]=(ae=l[3]).toLowerCase()){case"data":if(ae=="data"){if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?F8(n.slice(k,l.index),A,S,u[u.length-1][0]=="comment"?le:_,{c:E,r:w},j,Y[E],y,K,r):(A="",S=Vn(l[0]),k=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Se.length>0&&(_.c=Se),(!r.sheetRows||r.sheetRows>w)&&_.v!==void 0&&(r.dense?(g[w]||(g[w]=[]),g[w][E]=_):g[fr(E)+Sr(w)]=_),_.HRef&&(_.l={Target:Et(_.HRef)},_.HRefScreenTip&&(_.l.Tooltip=_.HRefScreenTip),delete _.HRef,delete _.HRefScreenTip),(_.MergeAcross||_.MergeDown)&&(R=E+(parseInt(_.MergeAcross,10)|0),J=w+(parseInt(_.MergeDown,10)|0),O.push({s:{c:E,r:w},e:{c:R,r:J}})),!r.sheetStubs)_.MergeAcross?E=R+1:++E;else if(_.MergeAcross||_.MergeDown){for(var ye=E;ye<=R;++ye)for(var Fe=w;Fe<=J;++Fe)(ye>E||Fe>w)&&(r.dense?(g[Fe]||(g[Fe]=[]),g[Fe][ye]={t:"z"}):g[fr(ye)+Sr(Fe)]={t:"z"});E=R+1}else++E;else _=C8(l[0]),_.Index&&(E=+_.Index-1),E<F.s.c&&(F.s.c=E),E>F.e.c&&(F.e.c=E),l[0].slice(-2)==="/>"&&++E,Se=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<F.s.r&&(F.s.r=w),w>F.e.r&&(F.e.r=w),l[0].slice(-2)==="/>"&&(y=Vn(l[0]),y.Index&&(w=+y.Index-1)),E=0,++w):(y=Vn(l[0]),y.Index&&(w=+y.Index-1),he={},(y.AutoFitHeight=="0"||y.Height)&&(he.hpx=parseInt(y.Height,10),he.hpt=Tw(he.hpx),ie[w]=he),y.Hidden=="1"&&(he.hidden=!0,ie[w]=he));break;case"worksheet":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));m.push(x),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(g["!ref"]=wt(F),r.sheetRows&&r.sheetRows<=F.e.r&&(g["!fullref"]=g["!ref"],F.e.r=r.sheetRows-1,g["!ref"]=wt(F))),O.length&&(g["!merges"]=O),Y.length>0&&(g["!cols"]=Y),ie.length>0&&(g["!rows"]=ie),h[x]=g}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=E=0,u.push([l[3],!1]),f=Vn(l[0]),x=Et(f.Name),g=r.dense?[]:{},O=[],K=[],ie=[],Z={name:x,Hidden:0},q.Sheets.push(Z);break;case"table":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),Y=[],re=!1}break;case"style":l[1]==="/"?L8(j,D,r):D=Vn(l[0]);break;case"numberformat":D.nf=Et(Vn(l[0]).Format||"General"),bl[D.nf]&&(D.nf=bl[D.nf]);for(var be=0;be!=392&&nt[be]!=D.nf;++be);if(be==392){for(be=57;be!=392;++be)if(nt[be]==null){rs(D.nf,be);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(xe=Vn(l[0]),xe.Hidden&&(xe.hidden=!0,delete xe.Hidden),xe.Width&&(xe.wpx=parseInt(xe.Width,10)),!re&&xe.wpx>10){re=!0,Vr=Ew;for(var _e=0;_e<Y.length;++_e)Y[_e]&&vo(Y[_e])}re&&vo(xe),Y[xe.Index-1||Y.length]=xe;for(var Be=0;Be<+xe.Span;++Be)Y[Y.length]=Er(xe);break;case"namedrange":if(l[1]==="/")break;q.Names||(q.Names=[]);var V=Ge(l[0]),qe={Name:V.Name,Ref:oo(V.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(qe.Sheet=q.Sheets.length-1),q.Names.push(qe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=n.slice(M,l.index):M=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Vn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?mA(G,ae,n.slice(W,l.index)):W=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));P8(le),Se.push(le)}else u.push([l[3],!1]),f=Vn(l[0]),le={a:f.Author};break;case"autofilter":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var it=Vn(l[0]);g["!autofilter"]={ref:oo(it.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return Z1(n,r);var ot=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ot=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ot=!1}break;case"excelworkbook":switch(l[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ot=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:ot=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(W,l.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else W=l.index+l[0].length;break;case"header":g["!margins"]||Cl(g["!margins"]={},"xlml"),isNaN(+Ge(l[0]).Margin)||(g["!margins"].header=+Ge(l[0]).Margin);break;case"footer":g["!margins"]||Cl(g["!margins"]={},"xlml"),isNaN(+Ge(l[0]).Margin)||(g["!margins"].footer=+Ge(l[0]).Margin);break;case"pagemargins":var Xe=Ge(l[0]);g["!margins"]||Cl(g["!margins"]={},"xlml"),isNaN(+Xe.Top)||(g["!margins"].top=+Xe.Top),isNaN(+Xe.Left)||(g["!margins"].left=+Xe.Left),isNaN(+Xe.Right)||(g["!margins"].right=+Xe.Right),isNaN(+Xe.Bottom)||(g["!margins"].bottom=+Xe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ot=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ot=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ot=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ot=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ot=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ot=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ot=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ot=!1}break;case"smarttags":break;default:ot=!1;break}if(ot||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?N8(H,ae,fe,n.slice(W,l.index)):(fe=l,W=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var Ne={};return!r.bookSheets&&!r.bookProps&&(Ne.Sheets=h),Ne.SheetNames=m,Ne.Workbook=q,Ne.SSF=Er(nt),Ne.Props=G,Ne.Custprops=H,Ne}function bh(e,t){switch(mm(t=t||{}),t.type||"base64"){case"base64":return hd(vn(e),t);case"binary":case"buffer":case"file":return hd(e,t);case"array":return hd(vs(e),t)}}function O8(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=GN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=XN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var R8=[60,1084,2066,2165,2175];function M8(e,t,r,n,a){var i=n,o=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=i;for(var u=Ia(r,r.l),f=Nh[u],h=0;f!=null&&R8.indexOf(u)>-1;)i=Ia(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),l=r.slice(h,r.l+4+i),o.push(l),r.l+=4+i,f=Nh[u=Ia(r,r.l)];var m=li(o);wr(m,0);var g=0;m.lens=[];for(var x=0;x<o.length;++x)m.lens.push(g),g+=o[x].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function da(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=nt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ws[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xl(e.v):e.w=fs(e.v):e.w=Dn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&No(nt[n]||String(n))){var a=Yi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function fu(e,t,r){return{v:e,ixfe:t,t:r}}function I8(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},l=null,u=[],f="",h={},m,g="",x,_,y,S,k={},E=[],w,F,j=[],D=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},O=function(He){return He<8?ns[He]:He<64&&D[He-8]||ns[He]},G=function(He,ce,ge){var Ee=ce.XF.data;if(!(!Ee||!Ee.patternType||!ge||!ge.cellStyles)){ce.s={},ce.s.patternType=Ee.patternType;var Oe;(Oe=Jl(O(Ee.icvFore)))&&(ce.s.fgColor={rgb:Oe}),(Oe=Jl(O(Ee.icvBack)))&&(ce.s.bgColor={rgb:Oe})}},H=function(He,ce,ge){if(!(he>1)&&!(ge.sheetRows&&He.r>=ge.sheetRows)){if(ge.cellStyles&&ce.XF&&ce.XF.data&&G(He,ce,ge),delete ce.ixfe,delete ce.XF,m=He,g=Qe(He),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),He.r<o.s.r&&(o.s.r=He.r),He.c<o.s.c&&(o.s.c=He.c),He.r+1>o.e.r&&(o.e.r=He.r+1),He.c+1>o.e.c&&(o.e.c=He.c+1),ge.cellFormula&&ce.f){for(var Ee=0;Ee<E.length;++Ee)if(!(E[Ee][0].s.c>He.c||E[Ee][0].s.r>He.r)&&!(E[Ee][0].e.c<He.c||E[Ee][0].e.r<He.r)){ce.F=wt(E[Ee][0]),(E[Ee][0].s.c!=He.c||E[Ee][0].s.r!=He.r)&&delete ce.f,ce.f&&(ce.f=""+Fr(E[Ee][1],o,He,K,W));break}}ge.dense?(a[He.r]||(a[He.r]=[]),a[He.r][He.c]=ce):a[g]=ce}},W={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(W.password=t.password);var fe,Se=[],le=[],Y=[],xe=[],re=!1,K=[];K.SheetNames=W.snames,K.sharedf=W.sharedf,K.arrayf=W.arrayf,K.names=[],K.XTI=[];var ie=0,he=0,R=0,J=[],q=[],Z;W.codepage=1200,qn(1200);for(var ae=!1;e.l<e.length-1;){var ye=e.l,Fe=e.read_shift(2);if(Fe===0&&ie===10)break;var be=e.l===e.length?0:e.read_shift(2),_e=Nh[Fe];if(_e&&_e.f){if(t.bookSheets&&ie===133&&Fe!==133)break;if(ie=Fe,_e.r===2||_e.r==12){var Be=e.read_shift(2);if(be-=2,!W.enc&&Be!==Fe&&((Be&255)<<8|Be>>8)!==Fe)throw new Error("rt mismatch: "+Be+"!="+Fe);_e.r==12&&(e.l+=10,be-=10)}var V={};if(Fe===10?V=_e.f(e,be,W):V=M8(Fe,_e,e,be,W),he==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(Fe){case 34:r.opts.Date1904=A.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(W.enc||(e.l=0),W.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=V;break;case 66:var qe=Number(V);switch(qe){case 21010:qe=1200;break;case 32768:qe=1e4;break;case 32769:qe=1252;break}qn(W.codepage=qe),ae=!0;break;case 317:W.rrtabid=V;break;case 25:W.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:W.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(a["!type"]="dialog"),V.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),V.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:j.push(V);break;case 430:K.push([V]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(V);break;case 24:case 536:Z={Name:V.Name,Ref:Fr(V.rgce,o,null,K,W)},V.itab>0&&(Z.Sheet=V.itab-1),K.names.push(Z),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(q[V.itab-1]={ref:wt(V.rgce[0][0][1][2])});break;case 22:W.ExternCount=V;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(V),K.XTI=K.XTI.concat(V);break;case 2196:if(W.biff<8)break;Z!=null&&(Z.Comment=V[1]);break;case 18:a["!protect"]=V;break;case 19:V!==0&&W.WTF&&console.error("Password verifier: "+V);break;case 133:i[V.pos]=V,W.snames.push(V.name);break;case 10:{if(--he)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=wt(o),t.sheetRows&&t.sheetRows<=o.e.r){var it=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=wt(o),o.e.r=it}o.e.r++,o.e.c++}Se.length>0&&(a["!merges"]=Se),le.length>0&&(a["!objects"]=le),Y.length>0&&(a["!cols"]=Y),xe.length>0&&(a["!rows"]=xe),A.Sheets.push(M)}f===""?h=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[Fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),W.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(W.biff=5,ae=!0,qn(W.codepage=28591)),W.biff==8&&V.BIFFVer==0&&V.dt==16&&(W.biff=2),he++)break;if(a=t.dense?[]:{},W.biff<8&&!ae&&(ae=!0,qn(W.codepage=t.codepage||1252)),W.biff<5||V.BIFFVer==0&&V.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ot={pos:e.l-be,name:f};i[ot.pos]=ot,W.snames.push(f)}else f=(i[ye]||{name:""}).name;V.dt==32&&(a["!type"]="chart"),V.dt==64&&(a["!type"]="macro"),Se=[],le=[],W.arrayf=E=[],Y=[],xe=[],re=!1,M={Hidden:(i[ye]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[V.r]||[])[V.c]:a[Qe({c:V.c,r:V.r})])&&++V.c,w={ixfe:V.ixfe,XF:j[V.ixfe]||{},v:V.val,t:"n"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:V.c,r:V.r},w,t);break;case 5:case 517:w={ixfe:V.ixfe,XF:j[V.ixfe],v:V.val,t:V.t},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:V.c,r:V.r},w,t);break;case 638:w={ixfe:V.ixfe,XF:j[V.ixfe],v:V.rknum,t:"n"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:V.c,r:V.r},w,t);break;case 189:for(var Xe=V.c;Xe<=V.C;++Xe){var Ne=V.rkrec[Xe-V.c][0];w={ixfe:Ne,XF:j[Ne],v:V.rkrec[Xe-V.c][1],t:"n"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:Xe,r:V.r},w,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){l=V;break}if(w=fu(V.val,V.cell.ixfe,V.tt),w.XF=j[w.ixfe],t.cellFormula){var St=V.formula;if(St&&St[0]&&St[0][0]&&St[0][0][0]=="PtgExp"){var Wt=St[0][0][1][0],pe=St[0][0][1][1],Ae=Qe({r:Wt,c:pe});k[Ae]?w.f=""+Fr(V.formula,o,V.cell,K,W):w.F=((t.dense?(a[Wt]||[])[pe]:a[Ae])||{}).F}else w.f=""+Fr(V.formula,o,V.cell,K,W)}R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H(V.cell,w,t),l=V}break;case 7:case 519:if(l)l.val=V,w=fu(V,l.cell.ixfe,"s"),w.XF=j[w.ixfe],t.cellFormula&&(w.f=""+Fr(l.formula,o,l.cell,K,W)),R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(V);var Pe=Qe(V[0].s);if(x=t.dense?(a[V[0].s.r]||[])[V[0].s.c]:a[Pe],t.cellFormula&&x){if(!l||!Pe||!x)break;x.f=""+Fr(V[1],o,V[0],K,W),x.F=wt(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!l)break;k[Qe(l.cell)]=V[0],x=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Qe(l.cell)],(x||{}).f=""+Fr(V[0],o,m,K,W)}}break;case 253:w=fu(u[V.isst].t,V.ixfe,"s"),u[V.isst].h&&(w.h=u[V.isst].h),w.XF=j[w.ixfe],R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:V.c,r:V.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:V.ixfe,XF:j[V.ixfe],t:"z"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:V.c,r:V.r},w,t));break;case 190:if(t.sheetStubs)for(var Ue=V.c;Ue<=V.C;++Ue){var et=V.ixfe[Ue-V.c];w={ixfe:et,XF:j[et],t:"z"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:Ue,r:V.r},w,t)}break;case 214:case 516:case 4:w=fu(V.val,V.ixfe,"s"),w.XF=j[w.ixfe],R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),H({c:V.c,r:V.r},w,t);break;case 0:case 512:he===1&&(o=V);break;case 252:u=V;break;case 1054:if(W.biff==4){J[R++]=V[1];for(var pt=0;pt<R+163&&nt[pt]!=V[1];++pt);pt>=163&&rs(V[1],R+163)}else rs(V[1],V[0]);break;case 30:{J[R++]=V;for(var Ze=0;Ze<R+163&&nt[Ze]!=V;++Ze);Ze>=163&&rs(V,R+163)}break;case 229:Se=Se.concat(V);break;case 93:le[V.cmo[0]]=W.lastobj=V;break;case 438:W.lastobj.TxO=V;break;case 127:W.lastobj.ImData=V;break;case 440:for(S=V[0].s.r;S<=V[0].e.r;++S)for(y=V[0].s.c;y<=V[0].e.c;++y)x=t.dense?(a[S]||[])[y]:a[Qe({c:y,r:S})],x&&(x.l=V[1]);break;case 2048:for(S=V[0].s.r;S<=V[0].e.r;++S)for(y=V[0].s.c;y<=V[0].e.c;++y)x=t.dense?(a[S]||[])[y]:a[Qe({c:y,r:S})],x&&x.l&&(x.l.Tooltip=V[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;x=t.dense?(a[V[0].r]||[])[V[0].c]:a[Qe(V[0])];var Qt=le[V[2]];x||(t.dense?(a[V[0].r]||(a[V[0].r]=[]),x=a[V[0].r][V[0].c]={t:"z"}):x=a[Qe(V[0])]={t:"z"},o.e.r=Math.max(o.e.r,V[0].r),o.s.r=Math.min(o.s.r,V[0].r),o.e.c=Math.max(o.e.c,V[0].c),o.s.c=Math.min(o.s.c,V[0].c)),x.c||(x.c=[]),_={a:V[1],t:Qt.TxO.t},x.c.push(_)}break;case 2173:a6(j[V.ixfe],V.ext);break;case 125:{if(!W.cellStyles)break;for(;V.e>=V.s;)Y[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},re||(re=!0,um(V.w/256)),vo(Y[V.e+1])}break;case 520:{var Tt={};V.level!=null&&(xe[V.r]=Tt,Tt.level=V.level),V.hidden&&(xe[V.r]=Tt,Tt.hidden=!0),V.hpt&&(xe[V.r]=Tt,Tt.hpt=V.hpt,Tt.hpx=Ql(V.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Cl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Fe]]=V;break;case 161:a["!margins"]||Cl(a["!margins"]={}),a["!margins"].header=V.header,a["!margins"].footer=V.footer;break;case 574:V.RTL&&(A.Views[0].RTL=!0);break;case 146:D=V;break;case 2198:fe=V;break;case 140:F=V;break;case 442:f?M.CodeName=V||M.name:A.WBProps.CodeName=V||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+Fe.toString(16)),e.l+=be}return r.SheetNames=va(i).sort(function(Bt,He){return Number(Bt)-Number(He)}).map(function(Bt){return i[Bt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&q.forEach(function(Bt,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=Bt}),r.Strings=u,r.SSF=Er(nt),W.enc&&(r.Encryption=W.enc),fe&&(r.Themes=fe),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),K.names.length>0&&(A.Names=K.names),r.Workbook=A,r}var U1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function D8(e,t,r){var n=yt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=S1(n,eA,U1.DSI);for(var i in a)t[i]=a[i]}catch(f){if(r.WTF)throw f}var o=yt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=S1(o,tA,U1.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(sw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Vw(e,t){t||(t={}),mm(t),v2(),t.codepage&&Gp(t.codepage);var r,n;if(e.FullPaths){if(yt.find(e,"/encryption"))throw new Error("File is password-protected");r=yt.find(e,"!CompObj"),n=yt.find(e,"/Workbook")||yt.find(e,"/Book")}else{switch(t.type){case"base64":e=Xn(vn(e));break;case"binary":e=Xn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var a,i;if(r&&O8(r),t.bookProps&&!t.bookSheets)a={};else{var o=vt?"buffer":"array";if(n&&n.content)a=I8(n.content,t);else if((i=yt.find(e,"PerfectOffice_MAIN"))&&i.content)a=Sl.to_workbook(i.content,(t.type=o,t));else if((i=yt.find(e,"NativeContent_MAIN"))&&i.content)a=Sl.to_workbook(i.content,(t.type=o,t));else throw(i=yt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&yt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=k6(e))}var l={};return e.FullPaths&&D8(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}var kf={0:{f:v5},1:{f:k5},2:{f:F5},3:{f:C5},4:{f:S5},5:{f:L5},6:{f:R5},7:{f:N5},8:{f:B5},9:{f:j5},10:{f:I5},11:{f:D5},12:{f:E5},13:{f:P5},14:{f:b5},15:{f:T5},16:{f:jw},17:{f:M5},18:{f:A5},19:{f:am},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:d8},40:{},42:{},43:{f:IF},44:{f:MF},45:{f:DF},46:{f:BF},47:{f:jF},48:{},49:{f:zN},50:{},51:{f:s6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vw},62:{f:O5},63:{f:f6},64:{f:X5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:G5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:w5},148:{f:_5,p:16},151:{f:H5},152:{},153:{f:u8},154:{},155:{},156:{f:c8},157:{},158:{},159:{T:1,f:tF},160:{T:-1},161:{T:1,f:ys},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:z5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:i6},336:{T:-1},337:{f:o6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Eh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:V5},427:{f:$5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Z5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:y5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:U5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Eh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:_6},633:{T:1},634:{T:-1},635:{T:1,f:v6},636:{T:-1},637:{f:HN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:e8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:q5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Nh={6:{f:fd},10:{f:ti},12:{f:ir},13:{f:ir},14:{f:Yt},15:{f:Yt},16:{f:Rr},17:{f:Yt},18:{f:Yt},19:{f:ir},20:{f:N1},21:{f:N1},23:{f:xw},24:{f:L1},25:{f:Yt},26:{},27:{},28:{f:gL},29:{},34:{f:Yt},35:{f:A1},38:{f:Rr},39:{f:Rr},40:{f:Rr},41:{f:Rr},42:{f:Yt},43:{f:Yt},47:{f:yF},49:{f:YA},51:{f:ir},60:{},61:{f:XA},64:{f:Yt},65:{f:KA},66:{f:ir},77:{},80:{},81:{},82:{},85:{f:ir},89:{},90:{},91:{},92:{f:zA},93:{f:vL},94:{},95:{f:Yt},96:{},97:{},99:{f:Yt},125:{f:vw},128:{f:oL},129:{f:UA},130:{f:ir},131:{f:Yt},132:{f:Yt},133:{f:HA},134:{},140:{f:SL},141:{f:ir},144:{},146:{f:CL},151:{},152:{},153:{},154:{},155:{},156:{f:ir},157:{},158:{},160:{f:FL},161:{f:NL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:nL},190:{f:aL},193:{f:ti},197:{},198:{},199:{},200:{},201:{},202:{f:Yt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ir},220:{},221:{f:Yt},222:{},224:{f:sL},225:{f:BA},226:{f:ti},227:{},229:{f:xL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:VA},253:{f:JA},255:{f:$A},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:fw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Yt},353:{f:ti},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:cL},431:{f:Yt},432:{},433:{},434:{},437:{},438:{f:wL},439:{f:Yt},440:{f:kL},441:{},442:{f:mc},443:{},444:{f:ir},445:{},446:{},448:{f:ti},449:{f:GA,r:2},450:{f:ti},512:{f:C1},513:{f:LL},515:{f:lL},516:{f:QA},517:{f:b1},519:{f:PL},520:{f:WA},523:{},545:{f:F1},549:{f:T1},566:{},574:{f:qA},638:{f:rL},659:{},1048:{},1054:{f:eL},1084:{},1212:{f:hL},2048:{f:EL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:lu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ti},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:bL,r:12},2173:{f:n6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Yt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:dL,r:12},2197:{},2198:{f:YF,r:12},2199:{},2200:{},2201:{},2202:{f:pL,r:12},2203:{f:ti},2204:{},2205:{},2206:{},2207:{},2211:{f:ZA},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ir},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:AL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:TL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:C1},1:{},2:{f:IL},3:{f:ML},4:{f:RL},5:{f:b1},7:{f:DL},8:{},9:{f:lu},11:{},22:{f:ir},30:{f:tL},31:{},32:{},33:{f:F1},36:{},37:{f:T1},50:{f:jL},62:{},52:{},67:{},68:{f:ir},69:{},86:{},126:{},127:{f:OL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BL},223:{},234:{},354:{},421:{},518:{f:fd},521:{f:lu},536:{f:L1},547:{f:A1},561:{},579:{},1030:{f:fd},1033:{f:lu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $n(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&J2(r)&&e.push(r)}}function H1(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,l=i&&i.index||e.length,u=lN(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,m=0,g=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},_=[];for(o=0;o<u.length;++o){var y=u[o].trim(),S=y.slice(0,3).toLowerCase();if(S=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(S!="<td"&&S!="<th")){var k=y.split(/<\/t[dh]>/i);for(l=0;l<k.length;++l){var E=k[l].trim();if(E.match(/<t[dh]/i)){for(var w=E,F=0;w.charAt(0)=="<"&&(F=w.indexOf(">"))>-1;)w=w.slice(F+1);for(var j=0;j<_.length;++j){var D=_[j];D.s.c==h&&D.s.r<f&&f<=D.e.r&&(h=D.e.c+1,j=-1)}var A=Ge(E.slice(0,E.indexOf(">")));g=A.colspan?+A.colspan:1,((m=+A.rowspan)>1||g>1)&&_.push({s:{r:f,c:h},e:{r:f+(m||1)-1,c:h+g-1}});var M=A.t||A["data-t"]||"";if(!w.length){h+=g;continue}if(w=B2(w),x.s.r>f&&(x.s.r=f),x.e.r<f&&(x.e.r=f),x.s.c>h&&(x.s.c=h),x.e.c<h&&(x.e.c=h),!w.length){h+=g;continue}var O={t:"s",v:w};r.raw||!w.trim().length||M=="s"||(w==="TRUE"?O={t:"b",v:!0}:w==="FALSE"?O={t:"b",v:!1}:isNaN(Qn(w))?isNaN(xo(w).getDate())||(O={t:"d",v:vr(w)},r.cellDates||(O={t:"n",v:Xr(O.v)}),O.z=r.dateNF||nt[14]):O={t:"n",v:Qn(w)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=O):n[Qe({r:f,c:h})]=O,h+=g}}}}return n["!ref"]=wt(x),_.length&&(n["!merges"]=_),n}function j8(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>o)&&!(a[f].e.r<r||a[f].e.c<o)){if(a[f].s.r<r||a[f].s.c<o){l=-1;break}l=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(l<0)){var h=Qe({r,c:o}),m=n.dense?(e[r]||[])[o]:e[h],g=m&&m.v!=null&&(m.h||Qp(m.w||(Za(m),m.w)||""))||"",x={};l>1&&(x.rowspan=l),u>1&&(x.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":m&&(x["data-t"]=m&&m.t||"z",m.v!=null&&(x["data-v"]=m.v),m.z!=null&&(x["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),x.id=(n.id||"sjs")+"-"+h,i.push(SN("td",g,x))}}var _="<tr>";return _+i.join("")+"</tr>"}var B8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',z8="</body></html>";function U8(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ri(H1(r[0],t),t);var n=xm();return r.forEach(function(a,i){vm(n,H1(a,t),"Sheet"+(i+1))}),n}function H8(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function V8(e,t){var r=t||{},n=r.header!=null?r.header:B8,a=r.footer!=null?r.footer:z8,i=[n],o=Ao(e["!ref"]);r.dense=Array.isArray(e),i.push(H8(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(j8(e,o,l,r));return i.push("</table>"+a),i.join("")}function $w(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Wr(n.origin):n.origin;a=o.r,i=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Ao(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),a==-1&&(f.e.r=a=h.e.r+1)}var m=[],g=0,x=e["!rows"]||(e["!rows"]=[]),_=0,y=0,S=0,k=0,E=0,w=0;for(e["!cols"]||(e["!cols"]=[]);_<l.length&&y<u;++_){var F=l[_];if(V1(F)){if(n.display)continue;x[y]={hidden:!0}}var j=F.children;for(S=k=0;S<j.length;++S){var D=j[S];if(!(n.display&&V1(D))){var A=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):B2(D.innerHTML),M=D.getAttribute("data-z")||D.getAttribute("z");for(g=0;g<m.length;++g){var O=m[g];O.s.c==k+i&&O.s.r<y+a&&y+a<=O.e.r&&(k=O.e.c+1-i,g=-1)}w=+D.getAttribute("colspan")||1,((E=+D.getAttribute("rowspan")||1)>1||w>1)&&m.push({s:{r:y+a,c:k+i},e:{r:y+a+(E||1)-1,c:k+i+(w||1)-1}});var G={t:"s",v:A},H=D.getAttribute("data-t")||D.getAttribute("t")||"";A!=null&&(A.length==0?G.t=H||"z":n.raw||A.trim().length==0||H=="s"||(A==="TRUE"?G={t:"b",v:!0}:A==="FALSE"?G={t:"b",v:!1}:isNaN(Qn(A))?isNaN(xo(A).getDate())||(G={t:"d",v:vr(A)},n.cellDates||(G={t:"n",v:Xr(G.v)}),G.z=n.dateNF||nt[14]):G={t:"n",v:Qn(A)})),G.z===void 0&&M!=null&&(G.z=M);var W="",fe=D.getElementsByTagName("A");if(fe&&fe.length)for(var Se=0;Se<fe.length&&!(fe[Se].hasAttribute("href")&&(W=fe[Se].getAttribute("href"),W.charAt(0)!="#"));++Se);W&&W.charAt(0)!="#"&&(G.l={Target:W}),n.dense?(e[y+a]||(e[y+a]=[]),e[y+a][k+i]=G):e[Qe({c:k+i,r:y+a})]=G,f.e.c<k+i&&(f.e.c=k+i),k+=w}}++y}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,y-1+a),e["!ref"]=wt(f),y>=u&&(e["!fullref"]=wt((f.e.r=l.length-_+y-1+a,f))),e}function Ww(e,t){var r=t||{},n=r.dense?[]:{};return $w(n,e,t)}function $8(e,t){return Ri(Ww(e,t),t)}function V1(e){var t="",r=W8(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function W8(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Z8(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Et(t.replace(/<[^>]*>/g,""));return[r]}var $1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Zw(e,t){var r=t||{},n=em(e),a=[],i,o,l={name:""},u="",f=0,h,m,g={},x=[],_=r.dense?[]:{},y,S,k={value:""},E="",w=0,F=[],j=-1,D=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,O={},G=[],H={},W=0,fe=0,Se=[],le=1,Y=1,xe=[],re={Names:[]},K={},ie=["",""],he=[],R={},J="",q=0,Z=!1,ae=!1,ye=0;for(Kl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Kl.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?_["!ref"]=wt(A):_["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(_["!fullref"]=_["!ref"],A.e.r=r.sheetRows-1,_["!ref"]=wt(A)),G.length&&(_["!merges"]=G),Se.length&&(_["!rows"]=Se),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),x.push(h.name),g[h.name]=_,ae=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=Ge(y[0],!1),j=D=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,_=r.dense?[]:{},G=[],Se=[],ae=!0);break;case"table-row-group":y[1]==="/"?--M:++M;break;case"table-row":case"":if(y[1]==="/"){j+=le,le=1;break}if(m=Ge(y[0],!1),m.?j=m.-1:j==-1&&(j=0),le=+m["number-rows-repeated"]||1,le<10)for(ye=0;ye<le;++ye)M>0&&(Se[j+ye]={level:M});D=-1;break;case"covered-table-cell":y[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(_[j]||(_[j]=[]),_[j][D]={t:"z"}):_[Qe({r:j,c:D})]={t:"z"}),E="",F=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++D,k=Ge(y[0],!1),Y=parseInt(k["number-columns-repeated"]||"1",10),S={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(S.f=j1(Et(k.formula))),(k.||k["value-type"])=="string"&&(S.t="s",S.v=Et(k["string-value"]||""),r.dense?(_[j]||(_[j]=[]),_[j][D]=S):_[Qe({r:j,c:D})]=S),D+=Y-1;else if(y[1]!=="/"){++D,E="",w=0,F=[],Y=1;var Fe=le?j+le-1:j;if(D>A.e.c&&(A.e.c=D),D<A.s.c&&(A.s.c=D),j<A.s.r&&(A.s.r=j),Fe>A.e.r&&(A.e.r=Fe),k=Ge(y[0],!1),he=[],R={},S={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Et(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(W=parseInt(k["number-matrix-rows-spanned"],10)||0,fe=parseInt(k["number-matrix-columns-spanned"],10)||0,H={s:{r:j,c:D},e:{r:j+W-1,c:D+fe-1}},S.F=wt(H),xe.push([H,S.F])),k.formula)S.f=j1(k.formula);else for(ye=0;ye<xe.length;++ye)j>=xe[ye][0].s.r&&j<=xe[ye][0].e.r&&D>=xe[ye][0].s.c&&D<=xe[ye][0].e.c&&(S.F=xe[ye][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(W=parseInt(k["number-rows-spanned"],10)||0,fe=parseInt(k["number-columns-spanned"],10)||0,H={s:{r:j,c:D},e:{r:j+W-1,c:D+fe-1}},G.push(H)),k["number-columns-repeated"]&&(Y=parseInt(k["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Dt(k["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(k.value);break;case"percentage":S.t="n",S.v=parseFloat(k.value);break;case"currency":S.t="n",S.v=parseFloat(k.value);break;case"date":S.t="d",S.v=vr(k["date-value"]),r.cellDates||(S.t="n",S.v=Xr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=iN(k["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Yf(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(k.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",k["string-value"]!=null&&(E=Et(k["string-value"]),F=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Z=!1,S.t==="s"&&(S.v=E||"",F.length&&(S.R=F),Z=w==0),K.Target&&(S.l=K),he.length>0&&(S.c=he,he=[]),E&&r.cellText!==!1&&(S.w=E),Z&&(S.t="z",delete S.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var be=0;be<le;++be){if(Y=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(_[j+be]||(_[j+be]=[]),_[j+be][D]=be==0?S:Er(S);--Y>0;)_[j+be][D+Y]=Er(S);else for(_[Qe({r:j+be,c:D})]=S;--Y>0;)_[Qe({r:j+be,c:D+Y})]=Er(S);A.e.c<=D&&(A.e.c=D)}Y=parseInt(k["number-columns-repeated"]||"1",10),D+=Y-1,Y=0,S={},E="",F=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i;R.t=E,F.length&&(R.R=F),R.a=J,he.push(R)}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);J="",q=0,E="",w=0,F=[];break;case"creator":y[1]==="/"?J=n.slice(q,y.index):q=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);E="",w=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(O[l.name]=u,(i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(u="",l=Ge(y[0],!1),a.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Ge(y[0],!1),u+=$1[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Ge(y[0],!1),u+=$1[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":o=Ge(y[0],!1),ie=dd(o["cell-range-address"]);var _e={Name:o.name,Ref:ie[0]+"!"+ie[1]};ae&&(_e.Sheet=x.length),re.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var Be=Z8(n.slice(w,y.index));E=(E.length>0?E+`
`:"")+Be[0]}else Ge(y[0],!1),w=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{ie=dd(Ge(y[0])["target-range-address"]),g[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(K=Ge(y[0],!1),!K.href)break;K.Target=Et(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(ie=dd(K.Target.slice(1)),K.Target="#"+ie[0]+"!"+ie[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var V={Sheets:g,SheetNames:x,Workbook:re};return r.bookSheets&&delete V.Sheets,V}function W1(e,t){t=t||{},Cn(e,"META-INF/manifest.xml")&&lA(ar(e,"META-INF/manifest.xml"),t);var r=hn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Zw(Pt(r),t);return Cn(e,"meta.xml")&&(n.Props=iw(ar(e,"meta.xml"))),n}function Z1(e,t){return Zw(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function hm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ah(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pt(vs(e))}function Lh(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function G1(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function G8(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function ec(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function dr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Mr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ec(e,r),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ec(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:l,type:i};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function pm(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function X8(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ec(e,n),i=Mr(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:dr(i[1][0].data),messages:[]};i[2].forEach(function(l){var u=Mr(l.data),f=dr(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=i[3])!=null&&t[0]&&(o.merge=dr(i[3][0].data)>>>0>0),r.push(o)}return r}function q8(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ec(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,f=0;if(i==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,i==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Lh(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(a.push(a[0].slice(-u)),f-=u;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-u,-u+f))}}var h=Lh(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function K8(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(q8(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Lh(t)}function Y8(e,t,r,n){var a=hm(e),i=a.getUint32(4,!0),o=(n>1?12:8)+G1(i&(n>1?3470:398))*4,l=-1,u=-1,f=NaN,h=new Date(2001,0,1);i&512&&(l=a.getUint32(o,!0),o+=4),o+=G1(i&(n>1?12288:4096))*4,i&16&&(u=a.getUint32(o,!0),o+=4),i&32&&(f=a.getFloat64(o,!0),o+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function J8(e,t,r){var n=hm(e),a=n.getUint32(8,!0),i=12,o=-1,l=-1,u=NaN,f=NaN,h=new Date(2001,0,1);a&1&&(u=G8(e,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function Q8(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Y8(e,t,r,e[0]);case 5:return J8(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ei(e){var t=Mr(e);return ec(t[1][0].data)}function X1(e,t){var r=Mr(t.data),n=dr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var l=Mr(o.data),u=dr(l[1][0].data)>>>0;switch(n){case 1:i[u]=Ah(l[3][0].data);break;case 8:{var f=e[Ei(l[9][0].data)][0],h=Mr(f.data),m=e[Ei(h[1][0].data)][0],g=dr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var x=Mr(m.data);i[u]=x[3].map(function(_){return Ah(_.data)}).join("")}break}}),i}function eO(e,t){var r,n,a,i,o,l,u,f,h,m,g,x,_,y,S=Mr(e),k=dr(S[1][0].data)>>>0,E=dr(S[2][0].data)>>>0,w=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&dr(S[8][0].data)>0||!1,F,j;if((i=(a=S[7])==null?void 0:a[0])!=null&&i.data&&t!=0)F=(l=(o=S[7])==null?void 0:o[0])==null?void 0:l.data,j=(f=(u=S[6])==null?void 0:u[0])==null?void 0:f.data;else if((m=(h=S[4])==null?void 0:h[0])!=null&&m.data&&t!=1)F=(x=(g=S[4])==null?void 0:g[0])==null?void 0:x.data,j=(y=(_=S[3])==null?void 0:_[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=w?4:1,A=hm(F),M=[],O=0;O<F.length/2;++O){var G=A.getUint16(O*2,!0);G<65535&&M.push([O,G])}if(M.length!=E)throw"Expected ".concat(E," cells, found ").concat(M.length);var H=[];for(O=0;O<M.length-1;++O)H[M[O][0]]=j.subarray(M[O][1]*D,M[O+1][1]*D);return M.length>=1&&(H[M[M.length-1][0]]=j.subarray(M[M.length-1][1]*D)),{R:k,cells:H}}function tO(e,t){var r,n=Mr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?dr(n[7][0].data)>>>0>0?1:0:-1,i=pm(n[5],function(o){return eO(o,a)});return{nrows:dr(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,f){if(o[l.R][f])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(f));o[l.R][f]=u}),o},[])}}function rO(e,t,r){var n,a=Mr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(dr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(dr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=wt(i);var o=Mr(a[4][0].data),l=X1(e,e[Ei(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?X1(e,e[Ei(o[17][0].data)][0]):[],f=Mr(o[3][0].data),h=0;f[1].forEach(function(m){var g=Mr(m.data),x=e[Ei(g[2][0].data)][0],_=dr(x.meta[1][0].data);if(_!=6002)throw new Error("6001 unexpected reference to ".concat(_));var y=tO(e,x);y.data.forEach(function(S,k){S.forEach(function(E,w){var F=Qe({r:h+k,c:w}),j=Q8(E,l,u);j&&(r[F]=j)})}),h+=y.nrows})}function nO(e,t){var r=Mr(t.data),n={"!ref":"A1"},a=e[Ei(r[2][0].data)],i=dr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return rO(e,a[0],n),n}function aO(e,t){var r,n=Mr(t.data),a={name:(r=n[1])!=null&&r[0]?Ah(n[1][0].data):"",sheets:[]},i=pm(n[2],Ei);return i.forEach(function(o){e[o].forEach(function(l){var u=dr(l.meta[1][0].data);u==6e3&&a.sheets.push(nO(e,l))})}),a}function iO(e,t){var r=xm(),n=Mr(t.data),a=pm(n[1],Ei);if(a.forEach(function(i){e[i].forEach(function(o){var l=dr(o.meta[1][0].data);if(l==2){var u=aO(e,o);u.sheets.forEach(function(f,h){vm(r,f,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function pd(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=K8(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var h;try{h=X8(f)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&dr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(u){i[u].forEach(function(f){var h=dr(f.meta[1][0].data)>>>0;if(h==1)if(!l)l=f;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return iO(i,l)}function sO(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function mm(e){sO([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function oO(e){return Ys.WS.indexOf(e)>-1?"sheet":e==Ys.CS?"chart":e==Ys.DS?"dialog":e==Ys.MS?"macro":e&&e.length?e:"sheet"}function lO(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,oO(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function cO(e,t,r,n,a,i,o,l,u,f,h,m){try{i[n]=kl(hn(e,r,!0),t);var g=ar(e,t),x;switch(l){case"sheet":x=m8(g,t,a,u,i[n],f,h,m);break;case"chart":if(x=g8(g,t,a,u,i[n],f,h,m),!x||!x["!drawel"])break;var _=sl(x["!drawel"].Target,t),y=Sh(_),S=p6(hn(e,_,!0),kl(hn(e,y,!0),_)),k=sl(S,_),E=Sh(k);x=J5(hn(e,k,!0),k,u,kl(hn(e,E,!0),k),f,x);break;case"macro":x=x8(g,t,a,u,i[n],f,h,m);break;case"dialog":x=v8(g,t,a,u,i[n],f,h,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=x;var w=[];i&&i[n]&&va(i[n]).forEach(function(F){var j="";if(i[n][F].Type==Ys.CMNT){j=sl(i[n][F].Target,t);var D=k8(ar(e,j,!0),j,u);if(!D||!D.length)return;O1(x,D,!1)}i[n][F].Type==Ys.TCMNT&&(j=sl(i[n][F].Target,t),w=w.concat(g6(ar(e,j,!0),u)))}),w&&w.length&&O1(x,w,!0,u.people||[])}catch(F){if(u.WTF)throw F}}function Sn(e){return e.charAt(0)=="/"?e.slice(1):e}function uO(e,t){if(L2(),t=t||{},mm(t),Cn(e,"META-INF/manifest.xml")||Cn(e,"objectdata.xml"))return W1(e,t);if(Cn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof pd<"u"){if(e.FileIndex)return pd(e);var r=yt.utils.cfb_new();return s1(e).forEach(function(Se){fN(r,Se,uN(e,Se))}),pd(r)}throw new Error("Unsupported NUMBERS file")}if(!Cn(e,"[Content_Types].xml"))throw Cn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Cn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=s1(e),a=sA(hn(e,"[Content_Types].xml")),i=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",ar(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!ar(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(Tl=[],a.sst)try{Tl=w8(ar(e,Sn(a.sst)),a.sst,t)}catch(Se){if(t.WTF)throw Se}t.cellStyles&&a.themes.length&&(u=y8(hn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=_8(ar(e,Sn(a.style)),a.style,u,t))}a.links.map(function(Se){try{var le=kl(hn(e,Sh(Sn(Se))),Se);return S8(ar(e,Sn(Se)),le,Se,t)}catch{}});var h=p8(ar(e,Sn(a.workbooks[0])),a.workbooks[0],t),m={},g="";a.coreprops.length&&(g=ar(e,Sn(a.coreprops[0]),!0),g&&(m=iw(g)),a.extprops.length!==0&&(g=ar(e,Sn(a.extprops[0]),!0),g&&fA(g,m,t)));var x={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(g=hn(e,Sn(a.custprops[0]),!0),g&&(x=hA(g,t)));var _={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(le){return le.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(_.Props=m,_.Custprops=x),t.bookSheets&&typeof o<"u"&&(_.SheetNames=o),t.bookSheets?_.SheetNames:t.bookProps))return _;o={};var y={};t.bookDeps&&a.calcchain&&(y=E8(ar(e,Sn(a.calcchain)),a.calcchain));var S=0,k={},E,w;{var F=h.Sheets;m.Worksheets=F.length,m.SheetNames=[];for(var j=0;j!=F.length;++j)m.SheetNames[j]=F[j].name}var D=i?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),M=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Cn(e,M)||(M="xl/_rels/workbook."+D+".rels");var O=kl(hn(e,M,!0),M.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=T8(ar(e,Sn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=x6(ar(e,Sn(a.people[0])),t)),O&&(O=lO(O,h.Sheets));var G=ar(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=m.Worksheets;++S){var H="sheet";if(O&&O[S]?(E="xl/"+O[S][1].replace(/[\/]?xl\//,""),Cn(e,E)||(E=O[S][1]),Cn(e,E)||(E=M.replace(/_rels\/.*$/,"")+O[S][1]),H=O[S][2]):(E="xl/worksheets/sheet"+(S+1-G)+"."+D,E=E.replace(/sheet0\./,"sheet.")),w=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(m.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var W=!1,fe=0;fe!=t.sheets.length;++fe)typeof t.sheets[fe]=="number"&&t.sheets[fe]==S&&(W=1),typeof t.sheets[fe]=="string"&&t.sheets[fe].toLowerCase()==m.SheetNames[S].toLowerCase()&&(W=1);if(!W)continue e}}cO(e,E,w,m.SheetNames[S],S,k,o,H,t,h,u,f)}return _={Directory:a,Workbook:h,Props:m,Custprops:x,Deps:y,Sheets:o,SheetNames:m.SheetNames,Strings:Tl,Styles:f,Themes:u,SSF:Er(nt)},t&&t.bookFiles&&(e.files?(_.keys=n,_.files=e.files):(_.keys=[],_.files={},e.FullPaths.forEach(function(Se,le){Se=Se.replace(/^Root Entry[\/]/,""),_.keys.push(Se),_.files[Se]=e.FileIndex[le]}))),t&&t.bookVBA&&(a.vba.length>0?_.vbaraw=ar(e,Sn(a.vba[0]),!0):a.defaults&&a.defaults.bin===w6&&(_.vbaraw=ar(e,"xl/vbaProject.bin",!0))),_}function fO(e,t){var r=t||{},n="Workbook",a=yt.find(e,n);try{if(n="/!DataSpaces/Version",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(nF(a.content),n="/!DataSpaces/DataSpaceMap",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=iF(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=sF(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);lF(a.content)}catch{}if(n="/EncryptionInfo",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=cF(a.content);if(n="/EncryptedPackage",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function gm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=vn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function dO(e,t){return yt.find(e,"EncryptedPackage")?fO(e,t):Vw(e,t)}function hO(e,t){var r,n=e,a=t||{};return a.type||(a.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),r=I2(n,a),uO(r,a)}function Gw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bh(e.slice(r),t);default:break e}return Yl.to_workbook(e,t)}function pO(e,t){var r="",n=gm(e,t);switch(t.type){case"base64":r=vn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ds(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Pt(r)),t.type="binary",Gw(r,t)}function mO(e,t){var r=e;return t.type=="base64"&&(r=vn(r)),r=oi.utils.decode(1200,r.slice(2),"str"),t.type="binary",Gw(r,t)}function gO(e){return e.match(/[^\x00-\x7F]/)?ol(e):e}function md(e,t,r,n){return n?(r.type="string",Yl.to_workbook(e,r)):Yl.to_workbook(t,r)}function Fh(e,t){v2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fh(new Uint8Array(e),(r=Er(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lo={},r.dateNF&&(lo.dateNF=r.dateNF),r.type||(r.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=vt?"buffer":"binary",n=nN(e),typeof Uint8Array<"u"&&!vt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=gO(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Er(r),r.type="array",Fh(Xp(n),r)}switch((a=gm(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return dO(yt.read(n,r),r);break;case 9:if(a[1]<=8)return Vw(n,r);break;case 60:return bh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return $L(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return HL.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?hO(n,r):md(e,n,r,i);case 239:return a[3]===60?bh(n,r):md(e,n,r,i);case 255:if(a[1]===254)return mO(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Sl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Sl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return P1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return wF.to_workbook(n,r);break;case 10:case 13:case 32:return pO(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return zL.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?P1.to_workbook(n,r):md(e,n,r,i)}function xO(e,t,r,n,a,i,o,l){var u=Sr(r),f=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!o||e[r])for(var x=t.s.c;x<=t.e.c;++x){var _=o?e[r][x]:e[n[x]+u];if(_===void 0||_.t===void 0){if(f===void 0)continue;i[x]!=null&&(g[i[x]]=f);continue}var y=_.v;switch(_.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(i[x]!=null){if(y==null)if(_.t=="e"&&y===null)g[i[x]]=null;else if(f!==void 0)g[i[x]]=f;else if(h&&y===null)g[i[x]]=null;else continue;else g[i[x]]=h&&(_.t!=="n"||_.t==="n"&&l.rawNumbers!==!1)?y:Za(_,y,l);y!=null&&(m=!1)}}return{row:g,isempty:m}}function Ph(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":u=qt(h);break;case"number":u=qt(e["!ref"]),u.s.r=h;break;default:u=h}n>0&&(a=0);var m=Sr(u.s.r),g=[],x=[],_=0,y=0,S=Array.isArray(e),k=u.s.r,E=0,w={};S&&!e[k]&&(e[k]=[]);var F=f.skipHidden&&e["!cols"]||[],j=f.skipHidden&&e["!rows"]||[];for(E=u.s.c;E<=u.e.c;++E)if(!(F[E]||{}).hidden)switch(g[E]=fr(E),r=S?e[k][E]:e[g[E]+m],n){case 1:i[E]=E-u.s.c;break;case 2:i[E]=g[E];break;case 3:i[E]=f.header[E-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Za(r,null,f),y=w[o]||0,!y)w[o]=1;else{do l=o+"_"+y++;while(w[l]);w[o]=y,w[l]=1}i[E]=l}for(k=u.s.r+a;k<=u.e.r;++k)if(!(j[k]||{}).hidden){var D=xO(e,u,k,g,n,i,S,f);(D.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(x[_++]=D.row)}return x.length=_,x}var q1=/"/g;function vO(e,t,r,n,a,i,o,l){for(var u=!0,f=[],h="",m=Sr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var x=l.dense?(e[r]||[])[g]:e[n[g]+m];if(x==null)h="";else if(x.v!=null){u=!1,h=""+(l.rawNumbers&&x.t=="n"?x.v:Za(x,null,l));for(var _=0,y=0;_!==h.length;++_)if((y=h.charCodeAt(_))===a||y===i||y===34||l.forceQuotes){h='"'+h.replace(q1,'""')+'"';break}h=="ID"&&(h='"ID"')}else x.f!=null&&!x.F?(u=!1,h="="+x.f,h.indexOf(",")>=0&&(h='"'+h.replace(q1,'""')+'"')):h="";f.push(h)}return l.blankrows===!1&&u?null:f.join(o)}function Xw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=qt(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),h="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],_=a.s.c;_<=a.e.c;++_)(g[_]||{}).hidden||(m[_]=fr(_));for(var y=0,S=a.s.r;S<=a.e.r;++S)(x[S]||{}).hidden||(h=vO(e,a,S,m,o,u,i,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&r.push((y++?l:"")+h)));return delete n.dense,r.join("")}function _O(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Xw(e,t);return r}function yO(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=qt(e["!ref"]),i="",o=[],l,u=[],f=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=fr(l);for(var h=a.s.r;h<=a.e.r;++h)for(i=Sr(h),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+i,r=f?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function qw(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Wr(n.origin):n.origin;o=u.r,l=u.c}var f,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(i["!ref"]){var m=qt(i["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(o=m.e.r+1,h.e.r=o+t.length-1+a)}else o==-1&&(o=0,h.e.r=t.length-1+a);var g=n.header||[],x=0;t.forEach(function(y,S){va(y).forEach(function(k){(x=g.indexOf(k))==-1&&(g[x=g.length]=k);var E=y[k],w="z",F="",j=Qe({c:l+x,r:o+S+a});f=tc(i,j),E&&typeof E=="object"&&!(E instanceof Date)?i[j]=E:(typeof E=="number"?w="n":typeof E=="boolean"?w="b":typeof E=="string"?w="s":E instanceof Date?(w="d",n.cellDates||(w="n",E=Xr(E)),F=n.dateNF||nt[14]):E===null&&n.nullError&&(w="e",E=0),f?(f.t=w,f.v=E,delete f.w,delete f.R,F&&(f.z=F)):i[j]=f={t:w,v:E},F&&(f.z=F))})}),h.e.c=Math.max(h.e.c,l+g.length-1);var _=Sr(o);if(a)for(x=0;x<g.length;++x)i[fr(x+l)+_]={t:"s",v:g[x]};return i["!ref"]=wt(h),i}function wO(e,t){return qw(null,e,t)}function tc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Wr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?tc(e,Qe(t)):tc(e,Qe({r:t,c:r||0}))}function kO(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function xm(){return{SheetNames:[],Sheets:{}}}function vm(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(s8(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function EO(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=kO(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function SO(e,t){return e.z=t,e}function Kw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function TO(e,t,r){return Kw(e,"#"+t,r)}function CO(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function bO(e,t,r,n){for(var a=typeof t!="string"?t:qt(t),i=typeof t=="string"?t:wt(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var u=tc(e,o,l);u.t="n",u.F=i,delete u.v,o==a.s.r&&l==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var NO={encode_col:fr,encode_row:Sr,encode_cell:Qe,encode_range:wt,decode_col:nm,decode_row:rm,split_cell:BN,decode_cell:Wr,decode_range:Ao,format_cell:Za,sheet_add_aoa:ew,sheet_add_json:qw,sheet_add_dom:$w,aoa_to_sheet:Lo,json_to_sheet:wO,table_to_sheet:Ww,table_to_book:$8,sheet_to_csv:Xw,sheet_to_txt:_O,sheet_to_json:Ph,sheet_to_html:V8,sheet_to_formulae:yO,sheet_to_row_object_array:Ph,sheet_get_cell:tc,book_new:xm,book_append_sheet:vm,book_set_sheet_visibility:EO,cell_set_number_format:SO,cell_set_hyperlink:Kw,cell_set_internal_link:TO,cell_add_comment:CO,sheet_set_array_formula:bO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class ll extends Error{}ll.prototype.name="InvalidTokenError";function AO(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function LO(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return AO(t)}catch{return atob(t)}}function FO(e,t){if(typeof e!="string")throw new ll("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new ll(`Invalid token specified: missing part #${r+1}`);let a;try{a=LO(n)}catch(i){throw new ll(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(a)}catch(i){throw new ll(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const PO=e=>{try{const t=FO(e),r=Date.now()/1e3;return t.exp>r}catch{return!1}},Oa=()=>{const e=localStorage.getItem("token");return e?PO(e)?e:(OO(),null):null},OO=()=>{localStorage.removeItem("token")},Yw="http://localhost:8000/api",RO=async(e,t)=>{var r,n;try{return(await We.post(`${Yw}/command/execute/`,{firewall_id:e,command:t},{headers:{Authorization:`Bearer ${Oa()}`,"Content-Type":"application/json"}})).data}catch(a){throw We.isAxiosError(a)?new Error(((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.error)||"Failed to execute command"):a}},MO=async e=>{var t,r;try{return(await We.get(`${Yw}/command/commands/`,{params:{firewall_id:e},headers:{Authorization:`Bearer ${Oa()}`}})).data}catch(n){throw We.isAxiosError(n)?new Error(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.error)||"Failed to fetch command history"):n}},Vi="http://localhost:8000/api",$i=We.create({baseURL:Vi,headers:{"Content-Type":"application/json"},withCredentials:!0});$i.interceptors.request.use(async e=>{var n;const t=Oa();t&&(e.headers.Authorization=`Bearer ${t}`);const r=(n=document.cookie.split("; ").find(a=>a.startsWith("csrftoken=")))==null?void 0:n.split("=")[1];return r&&(e.headers["X-CSRFToken"]=r),e},e=>Promise.reject(e));const IO=[{name:"Name",description:"Template name"},{name:"Source Address",description:"Source IP address or network"},{name:"Source Description",description:"Description of the source"},{name:"Source Interface",description:"Source network interface"},{name:"Destination Address",description:"Destination IP address or network"},{name:"Destination Description",description:"Description of the destination"},{name:"Destination Interface",description:"Destination network interface"},{name:"Service",description:"Network service or port"}];class DO{async getVariables(){try{return(await $i.get("/templates/variables/")).data.results||[]}catch{throw new Error("Failed to fetch variables")}}async getTemplate(t){try{return(await $i.get(`/templates/${t}/`)).data}catch{throw new Error("Failed to fetch template")}}async getTemplates(){try{return(await $i.get("/templates/")).data.results||[]}catch{throw new Error("Failed to fetch templates")}}async createTemplate(t){try{return(await $i.post("/templates/",t)).data}catch{throw new Error("Failed to create template")}}async updateTemplate(t,r){try{return(await $i.patch(`/templates/${t}/`,r)).data}catch{throw new Error("Failed to update template")}}async deleteTemplate(t){try{await $i.delete(`/templates/${t}/`)}catch{throw new Error("Failed to delete template")}}}const Is=new DO,Ds={getVariables:async()=>{var e,t,r;try{const n=Oa();if(!n)return console.error("No authentication token found"),[];let a=[],i=`${Vi}/templates/variables/`;for(;i;){const o=await We.get(i,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(Array.isArray(o.data))a=[...a,...o.data],i=null;else if(o.data.results&&Array.isArray(o.data.results))a=[...a,...o.data.results],i=o.data.next;else{console.error("Unexpected API response format:",o.data);break}}return a}catch(n){return console.error("Error fetching variables:",n),We.isAxiosError(n)&&console.error("Error details:",{status:(e=n.response)==null?void 0:e.status,data:(t=n.response)==null?void 0:t.data,headers:(r=n.response)==null?void 0:r.headers}),[]}},createVariable:async e=>{try{return(await We.post(`${Vi}/templates/variables/`,e,{headers:{Authorization:`Bearer ${Oa()}`,"Content-Type":"application/json"}})).data}catch(t){throw console.error("Error creating variable:",t),t}},updateVariable:async(e,t)=>{try{return(await We.put(`${Vi}/templates/variables/${e}/`,t,{headers:{Authorization:`Bearer ${Oa()}`,"Content-Type":"application/json"}})).data}catch(r){throw console.error("Error updating variable:",r),r}},deleteVariable:async e=>{try{await We.delete(`${Vi}/templates/variables/${e}/`,{headers:{Authorization:`Bearer ${Oa()}`,"Content-Type":"application/json"}})}catch(t){throw console.error("Error deleting variable:",t),t}},addVariableToTemplate:async(e,t)=>{try{await We.post(`${Vi}/templates/${e}/add_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${Oa()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error adding variable to template:",r),r}},removeVariableFromTemplate:async(e,t)=>{try{await We.post(`${Vi}/templates/${e}/remove_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${Oa()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error removing variable from template:",r),r}},async ensureRequiredVariables(){const e=await this.getVariables(),t=new Set(e.map(r=>r.name));for(const r of IO)t.has(r.name)||await this.createVariable(r)}},K1=(e,t)=>{let r;return function(...a){const i=()=>{clearTimeout(r),e(...a)};clearTimeout(r),r=setTimeout(i,t)}},jO=()=>localStorage.getItem("token"),Fa=We.create({baseURL:ta});Fa.interceptors.request.use(e=>{const t=jO();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Fa.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),lf("/login")),Promise.reject(e)));const BO=()=>{var mt,or,Nt,st;const[e,t]=C.useState([]),[r,n]=C.useState(null),[a,i]=C.useState({hostname:"",ipAddress:"",vdom:"",setName:"",srcaddr:"",srcaddrDesc:"",srcintf:"",dstaddr:"",dstaddrDesc:"",dstintf:"",service:""});C.useState(""),C.useState("");const[o,l]=C.useState([]),[u,f]=C.useState([]),[h,m]=C.useState([]),[g,x]=C.useState(null),[_,y]=C.useState(!1),[S,k]=C.useState(""),[E,w]=C.useState(""),[F,j]=C.useState([]),[D,A]=C.useState([]),[M,O]=C.useState([]),[G,H]=C.useState({}),[W,fe]=C.useState(""),[Se,le]=C.useState(""),[Y,xe]=C.useState([]),[re,K]=C.useState(!1),[ie,he]=C.useState(null),[R,J]=C.useState(""),[q,Z]=C.useState([]),[ae,ye]=C.useState(!1),[Fe,be]=C.useState(null);C.useEffect(()=>{(async()=>{try{ye(!0),be(null);const ve=await Is.getTemplates();Z(ve)}catch(ve){console.error("Error loading templates:",ve),be("Failed to load templates")}finally{ye(!1)}})()},[]);const[_e,Be]=C.useState(null),[V,qe]=C.useState(!1),[it,ot]=C.useState(null),[Xe,Ne]=C.useState(null),[St,Wt]=C.useState(!1),[pe,Ae]=C.useState(null),[Pe,Ue]=C.useState([]);C.useEffect(()=>{(async()=>{try{y(!0);const ve=await Fa.get("/datacenters/hierarchy/");Ue(ve.data)}catch(ve){console.error("Error fetching hierarchy:",ve)}finally{y(!1)}})()},[]);const et=()=>{if(!S)return[];const Q=Pe.find(ve=>ve.id===S);return Q?Q.firewall_types:[]},pt=()=>{if(!E)return[];const Q=Pe.find(ze=>ze.id===S);if(!Q)return[];const ve=Q.firewall_types.find(ze=>ze.id===E);return ve?ve.firewalls:[]},Ze=Q=>{const ve=Q.target.value;k(ve),w(""),x(null)},Qt=Q=>{const ve=Q.target.value;w(ve),x(null)},Tt=Q=>{var xt,bt;const ve=Q.target.value,ct=pt().find(Zt=>Zt.id===ve);if(ct){const Zt={id:ct.id,name:ct.name,ip_address:ct.ip_address,data_center:{id:S,name:((xt=Pe.find(er=>er.id===S))==null?void 0:xt.name)||""},firewall_type:{id:E,name:((bt=et().find(er=>er.id===E))==null?void 0:bt.name)||""},config:{id:"",config_data:{}},created_at:new Date().toISOString()};x(Zt)}};C.useEffect(()=>{Bt()},[]);const Bt=async()=>{try{y(!0);let Q=[],ve="/firewalls/firewalls/";for(;ve;){const P=(await Fa.get(ve)).data;Q=[...Q,...P.results||[]],ve=P.next}const[ze,ct]=await Promise.all([Fa.get("/firewalls/firewall-types/"),Fa.get("/datacenters/")]);console.log("API Responses:",{firewallTypes:ze.data,dataCenters:ct.data,firewalls:Q});const bt=(ze.data.results||[]).map(I=>({id:I.id,name:I.name,data_center:I.data_center,attributes_schema:I.attributes_schema||{}}));l(bt);const er=(ct.data.results||[]).map(I=>({id:I.id,name:I.name}));f(er);const ia=Q.map(I=>({id:I.id,name:I.name,ip_address:I.ip_address,data_center:I.data_center&&I.data_center.id&&I.data_center.name?{id:I.data_center.id,name:I.data_center.name}:null,firewall_type:I.firewall_type&&I.firewall_type.id&&I.firewall_type.name?{id:I.firewall_type.id,name:I.firewall_type.name}:null,config:I.config||{id:"",config_data:{}},created_at:I.created_at}));m(ia);const Cr=localStorage.getItem("dataCenter"),De=localStorage.getItem("firewallType"),b=localStorage.getItem("selectedFirewallId");if(Cr&&k(Cr),De&&w(De),b){const I=ia.find(P=>P.id===b);I&&(x(I),i(P=>({...P,ipAddress:I.ip_address})))}}catch(Q){console.error("Error fetching data:",Q)}finally{y(!1)}};C.useEffect(()=>{if(S){const Q=o.filter(ve=>{if(!ve.data_center)return console.log("No data_center for type:",ve),!1;const ze=ve.data_center===S;return console.log("Type matches:",{typeId:ve.id,typeDataCenter:ve.data_center,selectedDataCenter:S,matches:ze}),ze});console.log("Filtered Firewall Types:",{selectedDataCenter:S,allTypes:o,filteredTypes:Q}),j(Q),E&&!Q.some(ve=>ve.id===E)&&(w(""),localStorage.removeItem("firewallType"))}else j([]),w("")},[S,o]),C.useEffect(()=>{var Q;if(E){const ve=F.find(ze=>ze.id===E);if(console.log("Selected Type:",ve),(Q=ve==null?void 0:ve.attributes_schema)!=null&&Q.properties){const ze=Object.entries(ve.attributes_schema.properties).map(([ct,xt])=>({name:ct,label:xt.title||ct,required:xt.required||!1,type:xt.type||"string"}));console.log("Generated Form Fields:",ze),O(ze)}else console.log("No attributes schema found for type:",ve),O([])}else O([])},[E,F]),C.useEffect(()=>{if(E&&S){const Q=h.filter(ve=>{if(!ve.firewall_type||!ve.data_center)return!1;const ze=ve.firewall_type.id===E,ct=ve.data_center.id===S;return console.log("Firewall Filter Check:",{firewallId:ve.id,firewallType:ve.firewall_type.id,dataCenter:ve.data_center.id,selectedType:E,selectedDC:S,matchesType:ze,matchesDataCenter:ct}),ze&&ct});console.log("Filtered Firewalls:",{selectedFirewallType:E,selectedDataCenter:S,allFirewalls:h,filteredFirewalls:Q}),A(Q),g&&!Q.some(ve=>ve.id===g.id)&&(x(null),localStorage.removeItem("selectedFirewallId"))}else A([]),x(null)},[E,S,h]),C.useEffect(()=>{const Q=localStorage.getItem("dataCenter"),ve=localStorage.getItem("firewallType"),ze=localStorage.getItem("selectedFirewallId");if(console.log("Loading saved selections:",{savedDataCenter:Q,savedFirewallType:ve,savedFirewallId:ze}),Q&&k(Q),ve&&w(ve),ze){const ct=h.find(xt=>xt.id===ze);ct&&(x(ct),i(xt=>({...xt,ipAddress:ct.ip_address})))}},[h]);const He=Q=>{var ve;try{const ze=Fh(Q,{type:"array"});if(!ze.SheetNames.length)throw new Error("No sheets found in the Excel file");const ct=ze.SheetNames[0],xt=ze.Sheets[ct],bt=F.find(b=>b.id===E);if(!bt)throw new Error("No firewall type selected");if(!((ve=bt.attributes_schema)!=null&&ve.properties))throw new Error("No attributes defined for the selected firewall type");const Zt=Object.entries(bt.attributes_schema.properties).filter(([b,I])=>I.required).map(([b])=>b),er=NO.sheet_to_json(xt,{raw:!1,header:1});if(!Array.isArray(er)||er.length===0)throw new Error("No data found in the Excel file");const ia=er[0];if(!Array.isArray(ia)||ia.length===0)throw new Error("No headers found in the Excel file");const De=er.slice(1).map((b,I)=>{var U;const P={};Array.isArray(b)&&ia.forEach((ee,me)=>{const ne=b[me];P[ee]=ne});const B=Zt.filter(ee=>!P[ee]);if(B.length>0)throw new Error(`Missing required fields in row ${I+2}: ${B.join(", ")}`);const z={};return(U=bt==null?void 0:bt.attributes_schema)!=null&&U.properties&&Object.entries(bt.attributes_schema.properties).forEach(([ee,me])=>{const ne=Object.keys(P).find(se=>{const oe=se.toLowerCase().replace(/\s+/g,""),ke=ee.toLowerCase().replace(/\s+/g,""),Le={ipaddress:["ip","ipaddress","ipaddr","ip_address","ipaddress","IP Adresse"],sourceaddress:["source","src","sourceaddr","source_address","sourceaddress","source"],destinationinterface:["dstintf","destinationintf","destination_interface","dstinterface","destinationinterface","destination"],name:["name","nom","hostname","device"],vdom:["vdom","virtualdomain"],service:["service","services","protocol"],hostname:["hostname","name","device"],sourcedescription:["sourcedescription","srcdesc","source_desc"],sourceinterface:["sourceinterface","srcintf","source_intf"],destinationaddress:["destinationaddress","dstaddr","destination_addr"],destinationdescription:["destinationdescription","dstdesc","destination_desc"]};return oe===ke?!0:Le[ke]?Le[ke].includes(oe):!1});ne?z[ee]=P[ne]||"":z[ee]=""}),z});t(De),De.length>0&&(n(De[0]),H(De[0])),alert(`${De.length} configurations loaded successfully`)}catch(ze){alert(`Error processing Excel file: ${ze.message}`)}},ce=Q=>{var ze;const ve=(ze=Q.target.files)==null?void 0:ze[0];if(ve){if(!E){alert("Please select a firewall type before uploading the file");return}const ct=new FileReader;ct.onload=xt=>{var Zt;const bt=(Zt=xt.target)==null?void 0:Zt.result;He(bt)},ct.readAsArrayBuffer(ve)}},ge=Pn.useCallback(K1(async Q=>{var ve,ze,ct,xt;if(!(!g||!Q)){qe(!0),ot(null),Be(null);try{const bt=await Fa.post("/analysis/flow-matrix/analyze-ip/",{source_ip:Q,firewall_id:g.id,data_center_name:((ve=g.data_center)==null?void 0:ve.name)||"",firewall_type_name:((ze=g.firewall_type)==null?void 0:ze.name)||""});Be(bt.data)}catch(bt){ot(((xt=(ct=bt.response)==null?void 0:ct.data)==null?void 0:xt.error)||"Failed to search address")}finally{qe(!1)}}},500),[g]),Ee=Pn.useCallback(K1(async Q=>{var ve,ze,ct,xt;if(!(!g||!Q)){Wt(!0),Ae(null),Ne(null);try{const bt=await Fa.post("/analysis/flow-matrix/analyze-ip/",{source_ip:Q,firewall_id:g.id,data_center_name:((ve=g.data_center)==null?void 0:ve.name)||"",firewall_type_name:((ze=g.firewall_type)==null?void 0:ze.name)||""});Ne(bt.data)}catch(bt){Ae(((xt=(ct=bt.response)==null?void 0:ct.data)==null?void 0:xt.error)||"Failed to search address")}finally{Wt(!1)}}},500),[g]),Oe=(Q,ve)=>{H(ze=>({...ze,[Q]:ve})),Q==="SourceAddress"?ge(ve):Q==="DestinationAddress"&&Ee(ve)},Ve=r&&{fields:[{name:"hostname",label:"Hostname",required:!0},{name:"ipAddress",label:"IP Address",required:!0},{name:"vdom",label:"VDOM",required:!0},{name:"setName",label:"Set Name",required:!0},{name:"srcaddr",label:"Source Address",required:!0},{name:"srcaddrDesc",label:"Source Description",required:!1},{name:"srcintf",label:"Source Interface",required:!0},{name:"dstaddr",label:"Destination Address",required:!0},{name:"dstaddrDesc",label:"Destination Description",required:!1},{name:"dstintf",label:"Destination Interface",required:!0},{name:"service",label:"Service",required:!0}]};Ve!=null&&Ve.fields;const Ct=async Q=>{if(!g){ft("Please select a firewall first");return}try{const ve=await RO(g.id,Q);xe(ze=>Array.isArray(ze)?[...ze,ve]:[ve]),fe(""),ft(null)}catch(ve){ft(ve instanceof Error?ve.message:"Failed to execute command")}};C.useEffect(()=>{(async()=>{if(g)try{const ve=await MO(g.id);xe(Array.isArray(ve)?ve:[])}catch(ve){console.error("Error loading command history:",ve),xe([])}})()},[g]);const lt=()=>{if(!R)return;const Q=q.find(Zt=>Zt.name===R);if(!Q)return;const ve=/{{([^}]+)}}/g,ze=new Set;let ct;for(;(ct=ve.exec(Q.content))!==null;){const Zt=ct[1].trim();ze.add(Zt)}const xt={};ze.forEach(Zt=>{const er=G[Zt]||"";xt[`{{ ${Zt} }}`]=er});let bt=Q.content;Object.entries(xt).forEach(([Zt,er])=>{bt=bt.replace(new RegExp(Zt,"g"),er)}),fe(bt)},Ke=async()=>{var Q,ve,ze,ct;if(!g||!G.SourceAddress){ot("Please select a firewall and enter a source address");return}qe(!0),ot(null),Be(null);try{const xt=await Fa.post("/analysis/flow-matrix/analyze-ip/",{source_ip:G.SourceAddress,firewall_id:g.id,data_center_name:((Q=g.data_center)==null?void 0:Q.name)||"",firewall_type_name:((ve=g.firewall_type)==null?void 0:ve.name)||""});Be(xt.data)}catch(xt){ot(((ct=(ze=xt.response)==null?void 0:ze.data)==null?void 0:ct.error)||"Failed to search source address")}finally{qe(!1)}};C.useState(!1);const[Je,ft]=C.useState(null);return C.useState([]),C.useState(!1),C.useState(null),C.useState([]),C.useState([]),C.useState(""),C.useState(""),C.useState(""),d.jsxs("div",{className:"p-8",children:[d.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(Co,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),d.jsxs("select",{value:S,onChange:Ze,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"",children:"All data centers"}),Pe.map(Q=>d.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(Ni,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),d.jsxs("select",{value:E,onChange:Qt,disabled:!S,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${S?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall type"}),et().map(Q=>d.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(bo,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),d.jsxs("select",{value:(g==null?void 0:g.id)||"",onChange:Tt,disabled:!E,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${E?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall"}),pt().map(Q=>d.jsxs("option",{value:Q.id,children:[Q.name," - ",Q.ip_address]},Q.id))]})]})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsx("div",{className:"space-y-6",children:d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Configuration"}),d.jsx("div",{className:"space-y-4",children:M.length>0?M.map(Q=>d.jsxs("div",{className:"mb-6",children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[Q.label,Q.required&&d.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),d.jsx("div",{className:"relative",children:d.jsx("input",{type:Q.type==="string"?"text":Q.type,value:G[Q.name]||"",onChange:ve=>Oe(Q.name,ve.target.value),required:Q.required,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2",placeholder:`Enter ${Q.label.toLowerCase()}`})})]},Q.name)):d.jsx("div",{className:"text-center py-4 text-gray-500",children:E?"No fields defined for this firewall type":"Select a firewall type to see available fields"})})]})}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Slectionner une configuration"}),e.length>0?d.jsxs(d.Fragment,{children:[d.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg mb-4",value:(r==null?void 0:r.hostname)||"",onChange:Q=>{const ve=e.find(ze=>ze.hostname===Q.target.value);if(ve){n(ve),i(ve);const ze={};Object.entries(ve).forEach(([ct,xt])=>{ze[ct]=String(xt)}),H(ze)}},children:[d.jsx("option",{value:"",children:"Choisir une configuration"}),e.map((Q,ve)=>d.jsxs("option",{value:Q.hostname,children:[Q.hostname," - ",Q.ipAddress]},ve))]}),r&&d.jsxs("button",{onClick:()=>{i(r);const Q={};Object.entries(r).forEach(([ve,ze])=>{Q[ve]=String(ze)}),H(Q)},className:"w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 flex items-center justify-center",children:[d.jsx($p,{className:"w-5 h-5 mr-2"}),"Appliquer la configuration"]})]}):d.jsx("div",{className:"text-center py-4 text-gray-500",children:"Aucune configuration disponible. Veuillez importer un fichier Excel ou crer une configuration manuelle."})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Importer une configuration"}),d.jsx("div",{className:"space-y-4",children:E?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-4",children:d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Format Excel requis:"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsx("tr",{children:Object.entries(((or=(mt=F.find(Q=>Q.id===E))==null?void 0:mt.attributes_schema)==null?void 0:or.properties)||{}).map(([Q,ve])=>d.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider border-b border-gray-200",children:[ve.title," ",ve.required&&d.jsx("span",{className:"text-red-500 ml-1",children:"*"})]},Q))})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.jsx("tr",{children:Object.entries(((st=(Nt=F.find(Q=>Q.id===E))==null?void 0:Nt.attributes_schema)==null?void 0:st.properties)||{}).map(([Q,ve])=>d.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 border-b border-gray-200",children:ve.type==="string"?"Texte":ve.type},Q))})})]})}),d.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[d.jsx("span",{className:"text-red-500",children:"*"})," Champs obligatoires"]})]})}),d.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[d.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ce,className:"hidden",id:"file-upload"}),d.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center",children:[d.jsx(m2,{className:"h-12 w-12 text-gray-400 mb-4"}),d.jsx("span",{className:"text-gray-600",children:"Choisir un fichier Excel"}),d.jsx("span",{className:"text-sm text-gray-500 mt-2",children:"Format: .xlsx, .xls"})]})]})]}):d.jsx("div",{className:"text-center py-8",children:d.jsx("p",{className:"text-gray-500",children:"Veuillez slectionner un type de pare-feu pour voir les champs requis"})})})]})]})]}),d.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Source Address Search"}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx("input",{type:"text",value:G.SourceAddress||"",onChange:Q=>Oe("SourceAddress",Q.target.value),placeholder:"Enter source address",className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),d.jsx("button",{onClick:Ke,disabled:V||!g||!G.SourceAddress,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:V?"Searching...":"Search Address"})]}),it&&d.jsx("div",{className:"mt-4 p-4 bg-red-50 text-red-700 rounded-md",children:it}),_e&&d.jsx("div",{className:"mt-4 space-y-4",children:d.jsxs("div",{className:"p-4 bg-green-50 rounded-md",children:[d.jsx("h4",{className:"font-medium text-green-800 mb-4",children:"Search Results"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Source Address"}),d.jsx("p",{className:"font-medium text-gray-900",children:_e.ip})]}),d.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Config Path"}),d.jsx("p",{className:"font-medium text-gray-900",children:_e.config_path})]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Matched Address Objects"}),_e.matches&&_e.matches.length>0?d.jsx("div",{className:"space-y-4",children:_e.matches.map((Q,ve)=>d.jsxs("div",{className:"border-l-4 border-green-500 pl-3",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),d.jsx("span",{className:"font-medium text-gray-900",children:Q.name})]}),Q.comment&&d.jsx("div",{className:"ml-4 mt-1",children:d.jsx("p",{className:"text-xs text-gray-500 italic",children:Q.comment})}),Q.groups&&Q.groups.length>0&&d.jsxs("div",{className:"ml-4 mt-2 text-sm text-blue-600",children:["Groups: ",Q.groups.join(", ")]})]},ve))}):d.jsx("p",{className:"text-gray-500 italic mt-2",children:"No matches found"})]}),_e.matches&&_e.matches.length>0&&d.jsxs("details",{className:"mt-4",children:[d.jsx("summary",{className:"text-sm text-gray-500 cursor-pointer",children:"Debug Information"}),d.jsx("div",{className:"mt-2 space-y-2",children:_e.matches.map((Q,ve)=>d.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"Name:"})," ",Q.name]}),Q.comment&&d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"Comment:"})," ",Q.comment]}),Q.groups&&Q.groups.length>0&&d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"Groups:"})," ",Q.groups.join(", ")]})]},ve))})]})]})})]}),d.jsxs("div",{className:"mt-8 bg-gray-900 rounded-lg shadow-lg p-6",children:[d.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[d.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),d.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),d.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),d.jsx("h2",{className:"text-xl font-semibold text-gray-200 ml-2",children:"Terminal"})]}),d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"text-gray-400",children:"Selected Firewall:"}),d.jsx("span",{className:"text-purple-400",children:g?`${g.name} (${g.ip_address})`:"None"})]}),d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"text-gray-400",children:"Template:"})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsxs("select",{value:R,onChange:Q=>J(Q.target.value),className:"flex-1 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:ae,children:[d.jsx("option",{value:"",children:"Select a template..."}),q.map(Q=>d.jsx("option",{value:Q.name,children:Q.name},Q.id))]}),d.jsx("button",{onClick:lt,disabled:!R||ae,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:ae?"Loading...":"Apply Template"})]}),Fe&&d.jsx("div",{className:"mt-2 text-sm text-red-400",children:Fe})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsxs("div",{className:"flex-1 relative",children:[d.jsx("span",{className:"absolute left-3 top-2 text-green-400",children:"$"}),d.jsx("textarea",{value:W,onChange:Q=>fe(Q.target.value),placeholder:"Enter command...",className:"w-full h-32 pl-8 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm resize-none",onKeyDown:Q=>{Q.key==="Enter"&&!Q.shiftKey&&(Q.preventDefault(),Ct(W))}})]}),d.jsxs("div",{className:"flex flex-col space-y-2",children:[d.jsx("button",{onClick:Q=>{Q.preventDefault(),Ct(W)},disabled:re||!g||!W.trim(),className:`px-4 py-2 rounded-md transition-colors duration-200 ${re?"bg-yellow-600 text-white":!g||!W.trim()?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:re?d.jsxs("div",{className:"flex items-center",children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Executing..."]}):"Execute"}),d.jsx("button",{onClick:()=>fe(""),className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors duration-200",children:"Clear"})]})]})]}),Se&&d.jsxs("div",{className:"mb-4 p-4 bg-gray-800 rounded-md border border-gray-700",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("span",{className:"text-gray-400 text-lg",children:"Output:"}),d.jsx("button",{onClick:()=>le(""),className:"text-gray-500 hover:text-gray-400",children:"Clear"})]}),d.jsx("pre",{className:"text-sm overflow-auto max-h-96 font-mono text-gray-300 p-4 bg-gray-900 rounded-md",children:Se})]}),ie&&d.jsxs("div",{className:"mb-4 p-4 bg-red-900/50 text-red-400 rounded-md border border-red-700",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-red-500 font-semibold",children:"Error:"}),d.jsx("button",{onClick:()=>he(null),className:"text-red-500 hover:text-red-400",children:"Clear"})]}),d.jsx("p",{className:"mt-2",children:ie})]}),Y.length>0&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"text-gray-400",children:"History:"})]}),d.jsx("button",{onClick:()=>xe([]),className:"text-gray-500 hover:text-gray-400 text-sm",children:"Clear History"})]}),d.jsx("div",{className:"space-y-2",children:Y.map((Q,ve)=>d.jsxs("div",{className:"bg-gray-800 rounded-md p-3 border border-gray-700",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"font-mono text-sm text-gray-300",children:Q.command})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:`px-2 py-1 rounded text-xs ${Q.status==="completed"?"bg-green-900 text-green-300":Q.status==="failed"?"bg-red-900 text-red-300":Q.status==="executing"?"bg-yellow-900 text-yellow-300":"bg-gray-900 text-gray-300"}`,children:Q.status}),d.jsx("span",{className:"text-xs text-gray-500",children:new Date(Q.executed_at).toLocaleString()})]})]}),Q.output&&d.jsx("pre",{className:`text-sm overflow-auto max-h-40 font-mono ${Q.status==="completed"?"text-gray-300":"text-red-400"}`,children:Q.output}),Q.error_message&&d.jsxs("div",{className:"mt-2 text-sm text-red-400",children:["Error: ",Q.error_message]})]},`${Q.id}-${Q.executed_at}-${ve}`))})]})]})]})},zO=()=>localStorage.getItem("token"),Ef=We.create({baseURL:ta});Ef.interceptors.request.use(e=>{const t=zO();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ef.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function UO(){_a();const[e,t]=C.useState(""),[r,n]=C.useState("show"),[a,i]=C.useState(!1),[o,l]=C.useState(null),[u,f]=C.useState(null),[h,m]=C.useState([]);C.useState(!1);const[g,x]=C.useState([]),[_,y]=C.useState(""),[S,k]=C.useState(""),[E,w]=C.useState(null);C.useEffect(()=>{(async()=>{try{i(!0),l(null);const W=await Ef.get("/datacenters/hierarchy/");x(W.data)}catch(W){console.error("Error fetching hierarchy:",W),l("Failed to fetch hierarchy data")}finally{i(!1)}})()},[]);const F=()=>{if(!_)return[];const H=g.find(W=>W.id===_);return H?H.firewall_types:[]},j=()=>{if(!S)return[];const H=g.find(fe=>fe.id===_);if(!H)return[];const W=H.firewall_types.find(fe=>fe.id===S);return W?W.firewalls:[]},D=H=>{const W=H.target.value;y(W),k(""),w(null),m([])},A=H=>{const W=H.target.value;k(W),w(null),m([])},M=()=>{const H=j();h.length===H.length?m([]):m(H.map(W=>W.id))},O=H=>{m(W=>W.includes(H)?W.filter(fe=>fe!==H):[...W,H])},G=async()=>{if(!h.length&&!S){l("Please select firewalls or a firewall type");return}i(!0),l(null),f(null);try{const H=h.length>0?j().filter(le=>h.includes(le.id)):j(),W=await Promise.all(H.map(async le=>{try{const Y=await Ef.post("/command/commands/save_config/",{firewall_id:le.id,command:r},{responseType:"blob"}),xe=window.URL.createObjectURL(new Blob([Y.data])),re=document.createElement("a"),K=Y.headers["x-file-name"]||`${le.name}_config.txt`;return re.href=xe,re.setAttribute("download",K),document.body.appendChild(re),re.click(),re.remove(),window.URL.revokeObjectURL(xe),{success:!0,firewall:le.name}}catch(Y){return console.error(`Error saving config for ${le.name}:`,Y),{success:!1,firewall:le.name,error:Y}}})),fe=W.filter(le=>le.success),Se=W.filter(le=>!le.success);fe.length>0&&f(`${fe.length} configurations saved and downloaded successfully`),Se.length>0&&l(`Failed to save ${Se.length} firewalls: ${Se.map(le=>le.firewall).join(", ")}`)}catch(H){console.error("Error during bulk save:",H),l("Failed to save configurations")}finally{i(!1)}};return a?d.jsx("div",{className:"p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),d.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):o?d.jsx("div",{className:"p-8",children:d.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[d.jsx("strong",{className:"font-bold",children:"Error!"}),d.jsxs("span",{className:"block sm:inline",children:[" ",o]})]})}):d.jsxs("div",{className:"p-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall Configuration"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Manage firewall configurations"}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(Co,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),d.jsxs("select",{value:_,onChange:D,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"",children:"All data centers"}),g.map(H=>d.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(Ni,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),d.jsxs("select",{value:S,onChange:A,disabled:!_,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${_?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall type"}),F().map(H=>d.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(bo,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),d.jsxs("div",{className:"mt-1 space-y-2",children:[d.jsx("button",{onClick:M,disabled:!S,className:`w-full px-3 py-1 text-sm rounded-md ${h.length===j().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${S?"":"opacity-50 cursor-not-allowed"}`,children:h.length===j().length?"Deselect All":"Select All"}),d.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:j().map(H=>d.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${h.includes(H.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>O(H.id),children:[d.jsx("input",{type:"checkbox",checked:h.includes(H.id),onChange:()=>O(H.id),className:"mr-2"}),d.jsxs("span",{className:"text-sm",children:[H.name," - ",H.ip_address]})]},H.id))})]})]})]})]})}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP Address"}),d.jsx("input",{type:"text",value:e,onChange:H=>t(H.target.value),placeholder:"e.g., 192.168.1.1",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Command"}),d.jsx("input",{type:"text",value:r,onChange:H=>n(H.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),o&&d.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md",children:o}),u&&d.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md",children:u}),d.jsx("div",{className:"flex space-x-4",children:d.jsxs("button",{onClick:G,disabled:a||!h.length&&!S,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[d.jsx($p,{className:"h-5 w-5 mr-2"}),a?"Saving...":"Save Configuration"]})})]})})]})}const Y1=["Hostname","IP Adresse","VDOM","Name","SourceAddress","SourceDescription","SourceInterface","DestinationAddress","DestinationDescription","DestinationInterface","service"];function HO(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[a,i]=C.useState([]),[o,l]=C.useState({name:"",description:"",location:"",latitude:"",longitude:""}),[u,f]=C.useState({name:"",description:""}),[h,m]=C.useState([]),[g,x]=C.useState({}),[_,y]=C.useState(!1),[S,k]=C.useState(null),[E,w]=C.useState({}),[F,j]=C.useState(""),[D,A]=C.useState(""),[M,O]=C.useState(!1),[G,H]=C.useState(null),[W,fe]=C.useState(null),[Se,le]=C.useState(null);C.useState(1);const[Y,xe]=C.useState(null),[re,K]=C.useState(!1),[ie,he]=C.useState(null),[R,J]=C.useState(!1),[q,Z]=C.useState({name:"",ip_address:"",firewall_type:""}),[ae,ye]=C.useState(!1),[Fe,be]=C.useState(""),_e=()=>{const ce=localStorage.getItem("token");if(!ce)throw new Error("No authentication token found");return ce},Be=We.create({baseURL:ta,headers:{"Content-Type":"application/json"}});Be.interceptors.request.use(ce=>{var ge;try{const Ee=_e();return Ee&&(ce.headers.Authorization=`Bearer ${Ee}`),(ge=ce.url)!=null&&ge.startsWith("/api/")&&(ce.url=ce.url.replace("/api/","/")),ce}catch(Ee){console.error("Authentication error:",Ee),lf("/login")}return ce},ce=>Promise.reject(ce)),Be.interceptors.response.use(ce=>ce,ce=>(ce.response&&ce.response.status===401&&(localStorage.removeItem("token"),lf("/login")),Promise.reject(ce)));const V=async()=>{var ce,ge,Ee;try{y(!0);const[Oe,Ve,Ct]=await Promise.all([Be.get("/firewalls/firewall-types/"),Be.get("/datacenters/"),Be.get("/firewalls/")]),lt=Array.isArray((ce=Oe.data)==null?void 0:ce.results)?Oe.data.results:[],Ke=Array.isArray((ge=Ve.data)==null?void 0:ge.results)?Ve.data.results:[],Je=Array.isArray((Ee=Ct.data)==null?void 0:Ee.results)?Ct.data.results:[],ft=Ke.map(st=>({id:st.id,name:st.name,description:st.description||"",location:st.location||"",latitude:st.latitude?parseFloat(st.latitude):null,longitude:st.longitude?parseFloat(st.longitude):null,owner:st.owner||"",owner_username:st.owner_username||"",created_at:st.created_at,updated_at:st.updated_at,is_active:st.is_active,firewall_count:st.firewall_count||0,firewall_type_count:st.firewall_type_count||0,firewalls:Je.filter(Q=>{var ve;return((ve=Q.data_center)==null?void 0:ve.id)===st.id}),firewall_types:lt.filter(Q=>Q.data_center===st.id)}));t(ft);const mt=localStorage.getItem("selectedFirewallId"),or=localStorage.getItem("firewallType"),Nt=localStorage.getItem("dataCenter");if(mt){const st=Je.find(Q=>Q.id===mt);st&&(k(st),w(Q=>({...Q,ipAddress:st.ip_address})))}or&&j(or),Nt&&A(Nt)}catch{alert("Erreur lors du chargement des donnes. Veuillez rafrachir la page.")}finally{y(!1)}};C.useEffect(()=>{V()},[]);const qe=async()=>{await V()},it=ce=>{n(ge=>ge.includes(ce)?ge.filter(Ee=>Ee!==ce):[...ge,ce])},ot=ce=>{i(ge=>ge.includes(ce)?ge.filter(Ee=>Ee!==ce):[...ge,ce])},Xe=async()=>{var ce,ge,Ee,Oe,Ve,Ct,lt,Ke,Je,ft;if(o.name)try{let mt=null,or=null;if(o.latitude){const Q=parseFloat(o.latitude);if(!isNaN(Q)&&Q>=-90&&Q<=90)mt=Number(Q.toFixed(6));else{alert("La latitude doit tre comprise entre -90 et 90 degrs");return}}if(o.longitude){const Q=parseFloat(o.longitude);if(!isNaN(Q)&&Q>=-180&&Q<=180)or=Number(Q.toFixed(6));else{alert("La longitude doit tre comprise entre -180 et 180 degrs");return}}const Nt={name:o.name.trim(),description:o.description.trim()||null,location:o.location.trim()||null,latitude:mt,longitude:or,is_active:!0};if(Nt.latitude!==null&&Nt.longitude===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(Nt.latitude===null&&Nt.longitude!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}console.log("Sending data to API:",Nt);const st=await Be.post("/datacenters/",Nt);console.log("API Response:",st.data),l({name:"",description:"",location:"",latitude:"",longitude:""}),await qe()}catch(mt){if(console.error("Error creating data center:",mt),console.error("Error response:",(ce=mt.response)==null?void 0:ce.data),(Ee=(ge=mt.response)==null?void 0:ge.data)!=null&&Ee.longitude)alert(`Erreur de longitude: ${mt.response.data.longitude[0]}`);else if((Ve=(Oe=mt.response)==null?void 0:Oe.data)!=null&&Ve.latitude)alert(`Erreur de latitude: ${mt.response.data.latitude[0]}`);else{const or=((lt=(Ct=mt.response)==null?void 0:Ct.data)==null?void 0:lt.detail)||((ft=(Je=(Ke=mt.response)==null?void 0:Ke.data)==null?void 0:Je.non_field_errors)==null?void 0:ft[0])||"Erreur lors de la cration du datacenter. Veuillez ressayer.";alert(or)}}else alert("Le nom du datacenter est requis")},Ne=async ce=>{var Oe,Ve,Ct,lt,Ke,Je;const{name:ge,description:Ee}=u;if(ge)try{const ft=Object.entries(g).filter(([Nt,st])=>st).map(([Nt])=>Nt),mt={name:ge,description:Ee||"",data_center:ce,attributes_schema:{type:"object",properties:ft.reduce((Nt,st)=>{const Q=h.find(ve=>ve.name===st);return Q&&(Nt[st]={type:"string",title:Q.label,required:Q.required}),Nt},{}),required:ft.filter(Nt=>{const st=h.find(Q=>Q.name===Nt);return st==null?void 0:st.required})}};console.log("Creating firewall type with data:",mt);const or=await Be.post("/firewalls/firewall-types/",mt,{headers:{"Content-Type":"application/json",Accept:"application/json"}});console.log("Firewall type created successfully:",or.data),f({name:"",description:""}),x(h.reduce((Nt,st)=>({...Nt,[st.name]:!1}),{})),await qe()}catch(ft){console.error("Error creating firewall type:",ft),console.error("Error response:",(Oe=ft.response)==null?void 0:Oe.data);const mt=((Ct=(Ve=ft.response)==null?void 0:Ve.data)==null?void 0:Ct.detail)||((Je=(Ke=(lt=ft.response)==null?void 0:lt.data)==null?void 0:Ke.owner)==null?void 0:Je[0])||"Erreur lors de la cration du type de pare-feu.";alert(mt)}},St=async ce=>{var ge,Ee;try{await Be.delete(`/datacenters/${ce}/`),await qe()}catch(Oe){console.error("Error deleting data center:",Oe);const Ve=((Ee=(ge=Oe.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||"Erreur lors de la suppression du datacenter.";alert(Ve)}},Wt=async ce=>{var ge,Ee;if(window.confirm("tes-vous sr de vouloir supprimer ce type de pare-feu ?"))try{await Be.delete(`/firewalls/firewall-types/${ce}/`),await qe()}catch(Oe){console.error("Error deleting firewall type:",Oe);const Ve=((Ee=(ge=Oe.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||"Erreur lors de la suppression du type de pare-feu.";alert(Ve)}},pe=C.useCallback(ce=>{ce.preventDefault(),O(!0)},[]),Ae=C.useCallback(ce=>{ce.preventDefault(),O(!1)},[]),Pe=C.useCallback(async(ce,ge)=>{var Ve,Ct;ce.preventDefault(),O(!1),fe(null),H(0);const Oe=Array.from(ce.dataTransfer.files).filter(lt=>lt.type==="text/csv"||lt.name.endsWith(".csv"));if(Oe.length===0){fe("Veuillez dposer uniquement des fichiers CSV");return}for(const lt of Oe)try{const Ke=new FormData;Ke.append("file",lt),Ke.append("firewall_type",ge);const Je=await Be.post("/api/firewalls/upload-csv/",Ke,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:ft=>{const mt=ft.total?Math.round(ft.loaded*100/ft.total):0;H(mt)}});if(Je.data.success)le(`Fichier tlcharg avec succs. ${Je.data.created_count} pare-feu(s) cr(s).`),fe(null),await qe();else{const ft=Je.data.error||"Erreur lors du tlchargement",mt=Je.data.errors||[];fe(`${ft}
${mt.join(`
`)}`)}}catch(Ke){console.error("Error uploading CSV:",Ke);const Je=((Ct=(Ve=Ke.response)==null?void 0:Ve.data)==null?void 0:Ct.error)||"Erreur lors du tlchargement du fichier";fe(Je)}},[qe]),Ue=ce=>{xe(ce),K(!0)},et=async()=>{var ce,ge,Ee,Oe,Ve,Ct,lt;if(Y)try{let Ke=Y.latitude,Je=Y.longitude;if(Ke!==null&&(Ke<-90||Ke>90)){alert("La latitude doit tre comprise entre -90 et 90 degrs");return}if(Je!==null&&(Je<-180||Je>180)){alert("La longitude doit tre comprise entre -180 et 180 degrs");return}if(Ke!==null&&Je===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(Ke===null&&Je!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}const ft={name:Y.name.trim(),description:((ce=Y.description)==null?void 0:ce.trim())||null,location:((ge=Y.location)==null?void 0:ge.trim())||null,latitude:Ke,longitude:Je,is_active:Y.is_active};await Be.put(`/datacenters/${Y.id}/`,ft),K(!1),xe(null),await qe()}catch(Ke){console.error("Error updating data center:",Ke);const Je=((Oe=(Ee=Ke.response)==null?void 0:Ee.data)==null?void 0:Oe.detail)||((lt=(Ct=(Ve=Ke.response)==null?void 0:Ve.data)==null?void 0:Ct.non_field_errors)==null?void 0:lt[0])||"Erreur lors de la mise  jour du datacenter.";alert(Je)}},pt=ce=>{he(ce),J(!0)},Ze=async()=>{var ce,ge,Ee,Oe,Ve,Ct;if(ie)try{const lt=Object.entries(g).filter(([Je,ft])=>ft).map(([Je])=>Je),Ke={name:ie.name.trim(),description:((ce=ie.description)==null?void 0:ce.trim())||"",data_center:ie.data_center,attributes_schema:{type:"object",properties:lt.reduce((Je,ft)=>{const mt=h.find(or=>or.name===ft);return mt&&(Je[ft]={type:"string",title:mt.label,required:mt.required}),Je},{}),required:lt.filter(Je=>{const ft=h.find(mt=>mt.name===Je);return ft==null?void 0:ft.required})}};await Be.put(`/firewalls/firewall-types/${ie.id}/`,Ke),J(!1),he(null),await qe()}catch(lt){console.error("Error updating firewall type:",lt);const Ke=((Ee=(ge=lt.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||((Ct=(Ve=(Oe=lt.response)==null?void 0:Oe.data)==null?void 0:Ve.non_field_errors)==null?void 0:Ct[0])||"Erreur lors de la mise  jour du type de pare-feu.";alert(Ke)}},Qt=async ce=>{var ge,Ee;if(!q.name||!q.ip_address){alert("Le nom et l'adresse IP sont requis");return}try{const Oe=e.flatMap(Je=>Je.firewall_types).find(Je=>Je.id===ce);if(!Oe)throw new Error("Type de firewall non trouv");let Ve;const Ct=localStorage.getItem("userData");if(Ct?Ve=JSON.parse(Ct).id:Ve=(await Be.get("/auth/users/me/")).data.id,!Ve)throw new Error("Impossible de rcuprer l'ID de l'utilisateur");const lt={name:q.name.trim(),ip_address:q.ip_address.trim(),firewall_type:ce,data_center:Oe.data_center,owner:Ve};console.log("Sending data to API:",lt);const Ke=await Be.post("/firewalls/firewalls/",lt);console.log("API Response:",Ke.data),Z({name:"",ip_address:"",firewall_type:""}),ye(!1),await qe()}catch(Oe){console.error("Error creating firewall:",Oe),console.error("Error response:",(ge=Oe.response)==null?void 0:ge.data);let Ve="Erreur lors de la cration du pare-feu.";(Ee=Oe.response)!=null&&Ee.data&&(typeof Oe.response.data=="object"?Ve=`Erreurs de validation:
${Object.entries(Oe.response.data).map(([lt,Ke])=>`${lt}: ${Array.isArray(Ke)?Ke.join(", "):Ke}`).join(`
`)}`:typeof Oe.response.data=="string"?Ve=Oe.response.data:Oe.response.data.detail&&(Ve=Oe.response.data.detail)),alert(Ve)}},Tt=async ce=>{var ge,Ee;if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await Be.delete(`/firewalls/${ce}/`),await qe()}catch(Oe){console.error("Error deleting firewall:",Oe);const Ve=((Ee=(ge=Oe.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||"Erreur lors de la suppression du pare-feu.";alert(Ve)}},Bt=()=>d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Liste des Datacenters et Types de Firewall"}),d.jsx("div",{className:"space-y-4",children:e.map(ce=>{var ge;return d.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[d.jsxs("div",{className:"bg-gray-50 p-4 flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:ce.name}),d.jsx("p",{className:"text-sm text-gray-500",children:ce.location})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:()=>Ue(ce),className:"px-3 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-2",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),d.jsxs("button",{onClick:()=>St(ce.id),className:"px-3 py-1.5 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-2",children:[d.jsx(An,{className:"h-4 w-4"}),"Supprimer"]})]})]}),d.jsxs("div",{className:"p-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Types de Firewall"}),d.jsx("div",{className:"space-y-3",children:(ge=ce.firewall_types)==null?void 0:ge.map(Ee=>{var Oe;return d.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:Ee.name}),d.jsx("p",{className:"text-sm text-gray-500",children:Ee.description}),d.jsxs("div",{className:"mt-2",children:[d.jsx("p",{className:"text-xs text-gray-500",children:"Attributs configurs:"}),d.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:((Oe=Ee.attributes_schema)==null?void 0:Oe.properties)&&Object.entries(Ee.attributes_schema.properties).sort(([Ve],[Ct])=>{const lt=Y1.indexOf(Ve),Ke=Y1.indexOf(Ct);return lt===-1?1:Ke===-1?-1:lt-Ke}).map(([Ve,Ct])=>d.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:Ve},Ve))})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:()=>{be(Ee.id),ye(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[d.jsx(Ks,{className:"h-3 w-3"}),"Ajouter Firewall"]}),d.jsxs("button",{onClick:()=>pt(Ee),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),d.jsxs("button",{onClick:()=>Wt(Ee.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[d.jsx(An,{className:"h-3 w-3"}),"Supprimer"]})]})]})},Ee.id)})})]})]},ce.id)})})]}),He=(ce,ge)=>{var Ee;return d.jsxs("div",{className:"ml-6 mb-4",children:[d.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-md",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{onClick:()=>ot(ge.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:a.includes(ge.id)?d.jsx(cf,{size:20}):d.jsx(wh,{size:20})}),d.jsx("span",{className:"font-medium",children:ge.name})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:()=>{be(ge.id),ye(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[d.jsx(Ks,{className:"h-3 w-3"}),"Ajouter Firewall"]}),d.jsxs("button",{onClick:()=>pt(ge),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),d.jsxs("button",{onClick:()=>Wt(ge.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[d.jsx(An,{className:"h-3 w-3"}),"Supprimer"]})]})]}),a.includes(ge.id)&&d.jsxs("div",{className:"mt-2 p-4 bg-white rounded-md shadow",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pare-feu existants"}),d.jsx("div",{className:"space-y-2",children:(Ee=ge.firewalls)==null?void 0:Ee.map(Oe=>d.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:Oe.name}),d.jsx("p",{className:"text-sm text-gray-500",children:Oe.ip_address})]}),d.jsx("button",{onClick:()=>Tt(Oe.id),className:"text-red-500 hover:text-red-700",children:d.jsx(An,{className:"h-4 w-4"})})]},Oe.id))})]}),d.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center ${M?"border-purple-500 bg-purple-50":"border-gray-300"}`,onDragOver:pe,onDragLeave:Ae,onDrop:Oe=>Pe(Oe,ge.id),children:[d.jsx(m2,{className:"mx-auto h-12 w-12 text-gray-400"}),d.jsxs("div",{className:"mt-4",children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Glissez et dposez vos fichiers CSV ici"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ou cliquez pour slectionner des fichiers"})]}),G!==null&&d.jsxs("div",{className:"mt-4",children:[d.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:d.jsx("div",{className:"bg-purple-600 h-2.5 rounded-full",style:{width:`${G}%`}})}),d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Progression: ",G,"%"]})]}),W&&d.jsx("p",{className:"text-red-500 text-sm mt-2",children:W})]})]})]},ge.id)};return C.useEffect(()=>{(async()=>{try{const Ee=(await Ds.getVariables()).map(Oe=>({name:Oe.name,label:Oe.name,required:!1}));m(Ee),x(Ee.reduce((Oe,Ve)=>({...Oe,[Ve.name]:!1}),{}))}catch(ge){console.error("Error loading variables:",ge)}})()},[]),d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Paramtres CMS"}),d.jsx("p",{className:"text-gray-600",children:"Grez la structure des data centers et leurs types de firewalls"})]}),d.jsxs("button",{onClick:qe,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[d.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Rafrachir"]})]}),_?d.jsx("div",{className:"flex justify-center items-center h-64",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):d.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[Bt(),d.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:d.jsx("div",{className:"space-y-6",children:d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Structure"}),d.jsx("div",{className:"mb-6 p-4 border border-dashed border-gray-300 rounded-lg",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"Nom du Data Center *",value:o.name,onChange:ce=>l(ge=>({...ge,name:ce.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",required:!0}),d.jsx("button",{onClick:Xe,className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:d.jsx(Ks,{className:"w-4 h-4"})})]}),d.jsx("textarea",{placeholder:"Description",value:o.description,onChange:ce=>l(ge=>({...ge,description:ce.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),d.jsx("input",{type:"text",placeholder:"Adresse physique",value:o.location,onChange:ce=>l(ge=>({...ge,location:ce.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("div",{children:[d.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude (-90  90)",value:o.latitude,onChange:ce=>{const ge=ce.target.value;(ge===""||parseFloat(ge)>=-90&&parseFloat(ge)<=90)&&l(Ee=>({...Ee,latitude:ge}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: 33.552084"})]}),d.jsxs("div",{children:[d.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude (-180  180)",value:o.longitude,onChange:ce=>{const ge=ce.target.value;(ge===""||parseFloat(ge)>=-180&&parseFloat(ge)<=180)&&l(Ee=>({...Ee,longitude:ge}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: -7.657616"})]})]})]})}),d.jsx("div",{className:"space-y-2",children:Array.isArray(e)&&e.map(ce=>{var ge;return d.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-t-lg",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{onClick:()=>it(ce.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:r.includes(ce.id)?d.jsx(cf,{className:"w-4 h-4"}):d.jsx(wh,{className:"w-4 h-4"})}),d.jsx("span",{className:"font-medium",children:ce.name})]}),d.jsx("button",{onClick:()=>St(ce.id),className:"text-red-500 hover:text-red-700",children:d.jsx(An,{className:"w-4 h-4"})})]}),r.includes(ce.id)&&d.jsxs("div",{className:"p-4 space-y-4",children:[d.jsx("div",{className:"p-4 border border-dashed border-gray-300 rounded-lg",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"Nom du type de pare-feu",value:u.name,onChange:Ee=>f(Oe=>({...Oe,name:Ee.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm"}),d.jsx("button",{onClick:()=>Ne(ce.id),className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:d.jsx(Ks,{className:"w-4 h-4"})})]}),d.jsx("textarea",{placeholder:"Description",value:u.description,onChange:Ee=>f(Oe=>({...Oe,description:Ee.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:h.map(Ee=>d.jsxs("label",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"checkbox",checked:g[Ee.name],onChange:Oe=>x(Ve=>({...Ve,[Ee.name]:Oe.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:Ee.label})]},Ee.name))})]})}),d.jsx("div",{className:"space-y-2",children:(ge=ce.firewall_types)==null?void 0:ge.map(Ee=>He(ce,Ee))})]})]},ce.id)})})]})})})]}),re&&Y&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Data Center"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),d.jsx("input",{type:"text",value:Y.name,onChange:ce=>xe(ge=>ge?{...ge,name:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),d.jsx("textarea",{value:Y.description||"",onChange:ce=>xe(ge=>ge?{...ge,description:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse physique"}),d.jsx("input",{type:"text",value:Y.location||"",onChange:ce=>xe(ge=>ge?{...ge,location:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude (-90  90)"}),d.jsx("input",{type:"number",step:"0.000001",value:Y.latitude||"",onChange:ce=>{const ge=ce.target.value===""?null:parseFloat(ce.target.value);(ge===null||ge>=-90&&ge<=90)&&xe(Ee=>Ee?{...Ee,latitude:ge}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude (-180  180)"}),d.jsx("input",{type:"number",step:"0.000001",value:Y.longitude||"",onChange:ce=>{const ge=ce.target.value===""?null:parseFloat(ce.target.value);(ge===null||ge>=-180&&ge<=180)&&xe(Ee=>Ee?{...Ee,longitude:ge}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"})]})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:Y.is_active,onChange:ce=>xe(ge=>ge?{...ge,is_active:ce.target.checked}:null),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),d.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Actif"})]})]}),d.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>{K(!1),xe(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),d.jsx("button",{onClick:et,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),R&&ie&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Type de Pare-feu"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),d.jsx("input",{type:"text",value:ie.name,onChange:ce=>he(ge=>ge?{...ge,name:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),d.jsx("textarea",{value:ie.description||"",onChange:ce=>he(ge=>ge?{...ge,description:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attributs de configuration"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:h.map(ce=>d.jsxs("label",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"checkbox",checked:g[ce.name],onChange:ge=>x(Ee=>({...Ee,[ce.name]:ge.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:ce.label})]},ce.name))})]})]}),d.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>{J(!1),he(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),d.jsx("button",{onClick:Ze,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),ae&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ajouter un Pare-feu"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),d.jsx("input",{type:"text",value:q.name,onChange:ce=>Z(ge=>({...ge,name:ce.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP *"}),d.jsx("input",{type:"text",value:q.ip_address,onChange:ce=>Z(ge=>({...ge,ip_address:ce.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0,placeholder:"Ex: 192.168.1.1"})]})]}),d.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>{ye(!1),Z({name:"",ip_address:"",firewall_type:""})},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),d.jsx("button",{onClick:()=>Qt(Fe),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Ajouter"})]})]})})]})}const Zi=We.create({baseURL:ta});Zi.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Zi.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));const J1={getFirewalls:async()=>{try{return(await Zi.get("/firewalls/firewalls/")).data.results||[]}catch(e){throw e}},getFirewall:async e=>{try{return(await Zi.get(`/firewalls/firewalls/${e}/`)).data}catch(t){throw t}},createFirewall:async e=>{try{return(await Zi.post("/firewalls/firewalls/",e)).data}catch(t){throw t}},updateFirewall:async(e,t)=>{try{return(await Zi.put(`/firewalls/firewalls/${e}/`,t)).data}catch(r){throw r}},deleteFirewall:async e=>{try{await Zi.delete(`/firewalls/firewalls/${e}/`)}catch(t){throw t}}},VO=()=>{const[e,t]=C.useState([]),[r,n]=C.useState([]),[a,i]=C.useState(""),[o,l]=C.useState(!0),[u,f]=C.useState(null),[h,m]=C.useState(0);C.useEffect(()=>{(async()=>{try{l(!0);const y=await J1.getFirewalls(),S=Array.isArray(y)?y:y.results||[];t(S),n(S),f(null)}catch(y){f(`Erreur lors de la rcupration des pare-feux: ${y.message||"Erreur inconnue"}`)}finally{l(!1)}})()},[h]),C.useEffect(()=>{if(!a.trim()){n(e);return}const _=a.toLowerCase().trim(),y=e.filter(S=>S.name.toLowerCase().includes(_)||S.ip_address.toLowerCase().includes(_));n(y)},[a,e]);const g=()=>{m(_=>_+1)},x=async _=>{if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await J1.deleteFirewall(_),t(e.filter(y=>y.id!==_))}catch{f("Erreur lors de la suppression du pare-feu")}};return o?d.jsx("div",{className:"flex items-center justify-center h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Liste des Pare-feux"}),d.jsx("p",{className:"text-gray-600",children:"Grez vos pare-feux et leurs configurations"})]}),d.jsxs("button",{onClick:g,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[d.jsx(gb,{className:"w-4 h-4"}),"Rafrachir"]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(xb,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Rechercher par nom ou adresse IP...",value:a,onChange:_=>i(_.target.value)})]}),a&&d.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:[r.length," pare-feu",r.length!==1?"x":""," trouv",r.length!==1?"s":""]})]}),u&&d.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md",children:u}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(_=>{var y;return d.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200",children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Ni,{className:"h-8 w-8 text-purple-600 mr-3"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:_.name}),d.jsx("p",{className:"text-gray-500 text-sm",children:_.ip_address})]})]}),d.jsx("div",{className:"flex space-x-2",children:d.jsx("button",{onClick:()=>x(_.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors duration-200",children:d.jsx(An,{className:"h-5 w-5"})})})]}),d.jsxs("div",{className:"mt-4 space-y-3",children:[d.jsxs("div",{className:"flex items-center text-gray-600",children:[d.jsx(Co,{className:"h-5 w-5 mr-2"}),d.jsxs("span",{children:["Data Center: ",((y=_.data_center_info)==null?void 0:y.name)||"N/A"]})]}),d.jsxs("div",{className:"flex items-center text-gray-600",children:[d.jsx(bo,{className:"h-5 w-5 mr-2"}),d.jsxs("span",{children:["Type: ",typeof _.firewall_type=="object"&&_.firewall_type?_.firewall_type.name:"N/A"]})]})]})]})},_.id)})}),r.length===0&&!o&&d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Ni,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Aucun rsultat trouv":"Aucun pare-feu trouv"}),d.jsx("p",{className:"text-gray-500 mt-2",children:a?"Essayez de modifier votre recherche":"Commencez par ajouter un nouveau pare-feu."})]})]})};function _m(e,t){const r=C.useRef(t);C.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function $O(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const Jw=1;function Qw(e){return Object.freeze({__version:Jw,map:e})}function ym(e,t){return Object.freeze({...e,...t})}const wm=C.createContext(null),km=wm.Provider;function Fo(){const e=C.useContext(wm);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Em(e){function t(r,n){const{instance:a,context:i}=e(r).current;return C.useImperativeHandle(n,()=>a),r.children==null?null:Pn.createElement(km,{value:i},r.children)}return C.forwardRef(t)}function ek(e){function t(r,n){const[a,i]=C.useState(!1),{instance:o}=e(r,i).current;C.useImperativeHandle(n,()=>o),C.useEffect(function(){a&&o.update()},[o,a,r.children]);const l=o._contentNode;return l?Ty.createPortal(r.children,l):null}return C.forwardRef(t)}function Sm(e){function t(r,n){const{instance:a}=e(r).current;return C.useImperativeHandle(n,()=>a),null}return C.forwardRef(t)}function tk(e){return function(r){const n=Fo(),a=e(r,n),{instance:i}=a.current,o=C.useRef(r.position),{position:l}=r;return C.useEffect(function(){return i.addTo(n.map),function(){i.remove()}},[n.map,i]),C.useEffect(function(){l!=null&&l!==o.current&&(i.setPosition(l),o.current=l)},[i,l]),a}}function t0(e,t){const r=C.useRef();C.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function _c(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function rk(e,t){return function(n,a){const i=Fo(),o=e(_c(n,i),i);return _m(i.map,n.attribution),t0(o.current,n.eventHandlers),t(o.current,i,n,a),o}}var Oh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(Ti,function(r){var n="1.9.4";function a(s){var c,p,v,T;for(p=1,v=arguments.length;p<v;p++){T=arguments[p];for(c in T)s[c]=T[c]}return s}var i=Object.create||function(){function s(){}return function(c){return s.prototype=c,new s}}();function o(s,c){var p=Array.prototype.slice;if(s.bind)return s.bind.apply(s,p.call(arguments,1));var v=p.call(arguments,2);return function(){return s.apply(c,v.length?v.concat(p.call(arguments)):arguments)}}var l=0;function u(s){return"_leaflet_id"in s||(s._leaflet_id=++l),s._leaflet_id}function f(s,c,p){var v,T,N,X;return X=function(){v=!1,T&&(N.apply(p,T),T=!1)},N=function(){v?T=arguments:(s.apply(p,arguments),setTimeout(X,c),v=!0)},N}function h(s,c,p){var v=c[1],T=c[0],N=v-T;return s===v&&p?s:((s-T)%N+N)%N+T}function m(){return!1}function g(s,c){if(c===!1)return s;var p=Math.pow(10,c===void 0?6:c);return Math.round(s*p)/p}function x(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function _(s){return x(s).split(/\s+/)}function y(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?i(s.options):{});for(var p in c)s.options[p]=c[p];return s.options}function S(s,c,p){var v=[];for(var T in s)v.push(encodeURIComponent(p?T.toUpperCase():T)+"="+encodeURIComponent(s[T]));return(!c||c.indexOf("?")===-1?"?":"&")+v.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function E(s,c){return s.replace(k,function(p,v){var T=c[v];if(T===void 0)throw new Error("No value provided for variable "+p);return typeof T=="function"&&(T=T(c)),T})}var w=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function F(s,c){for(var p=0;p<s.length;p++)if(s[p]===c)return p;return-1}var j="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function D(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var A=0;function M(s){var c=+new Date,p=Math.max(0,16-(c-A));return A=c+p,window.setTimeout(s,p)}var O=window.requestAnimationFrame||D("RequestAnimationFrame")||M,G=window.cancelAnimationFrame||D("CancelAnimationFrame")||D("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function H(s,c,p){if(p&&O===M)s.call(c);else return O.call(window,o(s,c))}function W(s){s&&G.call(window,s)}var fe={__proto__:null,extend:a,create:i,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:h,falseFn:m,formatNum:g,trim:x,splitWords:_,setOptions:y,getParamString:S,template:E,isArray:w,indexOf:F,emptyImageUrl:j,requestFn:O,cancelFn:G,requestAnimFrame:H,cancelAnimFrame:W};function Se(){}Se.extend=function(s){var c=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=c.__super__=this.prototype,v=i(p);v.constructor=c,c.prototype=v;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return s.statics&&a(c,s.statics),s.includes&&(le(s.includes),a.apply(null,[v].concat(s.includes))),a(v,s),delete v.statics,delete v.includes,v.options&&(v.options=p.options?i(p.options):{},a(v.options,s.options)),v._initHooks=[],v.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var N=0,X=v._initHooks.length;N<X;N++)v._initHooks[N].call(this)}},c},Se.include=function(s){var c=this.prototype.options;return a(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},Se.mergeOptions=function(s){return a(this.prototype.options,s),this},Se.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),p=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function le(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=w(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Y={on:function(s,c,p){if(typeof s=="object")for(var v in s)this._on(v,s[v],c);else{s=_(s);for(var T=0,N=s.length;T<N;T++)this._on(s[T],c,p)}return this},off:function(s,c,p){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var v in s)this._off(v,s[v],c);else{s=_(s);for(var T=arguments.length===1,N=0,X=s.length;N<X;N++)T?this._off(s[N]):this._off(s[N],c,p)}return this},_on:function(s,c,p,v){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,p)===!1){p===this&&(p=void 0);var T={fn:c,ctx:p};v&&(T.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(T)}},_off:function(s,c,p){var v,T,N;if(this._events&&(v=this._events[s],!!v)){if(arguments.length===1){if(this._firingCount)for(T=0,N=v.length;T<N;T++)v[T].fn=m;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var X=this._listens(s,c,p);if(X!==!1){var te=v[X];this._firingCount&&(te.fn=m,this._events[s]=v=v.slice()),v.splice(X,1)}}},fire:function(s,c,p){if(!this.listens(s,p))return this;var v=a({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[s];if(T){this._firingCount=this._firingCount+1||1;for(var N=0,X=T.length;N<X;N++){var te=T[N],ue=te.fn;te.once&&this.off(s,ue,te.ctx),ue.call(te.ctx||this,v)}this._firingCount--}}return p&&this._propagateEvent(v),this},listens:function(s,c,p,v){typeof s!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(v=!!c,T=void 0,p=void 0);var N=this._events&&this._events[s];if(N&&N.length&&this._listens(s,T,p)!==!1)return!0;if(v){for(var X in this._eventParents)if(this._eventParents[X].listens(s,c,p,v))return!0}return!1},_listens:function(s,c,p){if(!this._events)return!1;var v=this._events[s]||[];if(!c)return!!v.length;p===this&&(p=void 0);for(var T=0,N=v.length;T<N;T++)if(v[T].fn===c&&v[T].ctx===p)return T;return!1},once:function(s,c,p){if(typeof s=="object")for(var v in s)this._on(v,s[v],c,!0);else{s=_(s);for(var T=0,N=s.length;T<N;T++)this._on(s[T],c,p,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[u(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[u(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,a({layer:s.target,propagatedFrom:s.target},s),!0)}};Y.addEventListener=Y.on,Y.removeEventListener=Y.clearAllEventListeners=Y.off,Y.addOneTimeEventListener=Y.once,Y.fireEvent=Y.fire,Y.hasEventListeners=Y.listens;var xe=Se.extend(Y);function re(s,c,p){this.x=p?Math.round(s):s,this.y=p?Math.round(c):c}var K=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};re.prototype={clone:function(){return new re(this.x,this.y)},add:function(s){return this.clone()._add(ie(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ie(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new re(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new re(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(s){s=ie(s);var c=s.x-this.x,p=s.y-this.y;return Math.sqrt(c*c+p*p)},equals:function(s){return s=ie(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ie(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function ie(s,c,p){return s instanceof re?s:w(s)?new re(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new re(s.x,s.y):new re(s,c,p)}function he(s,c){if(s)for(var p=c?[s,c]:s,v=0,T=p.length;v<T;v++)this.extend(p[v])}he.prototype={extend:function(s){var c,p;if(!s)return this;if(s instanceof re||typeof s[0]=="number"||"x"in s)c=p=ie(s);else if(s=R(s),c=s.min,p=s.max,!c||!p)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=p.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(s){return ie((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ie(this.min.x,this.max.y)},getTopRight:function(){return ie(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,p;return typeof s[0]=="number"||s instanceof re?s=ie(s):s=R(s),s instanceof he?(c=s.min,p=s.max):c=p=s,c.x>=this.min.x&&p.x<=this.max.x&&c.y>=this.min.y&&p.y<=this.max.y},intersects:function(s){s=R(s);var c=this.min,p=this.max,v=s.min,T=s.max,N=T.x>=c.x&&v.x<=p.x,X=T.y>=c.y&&v.y<=p.y;return N&&X},overlaps:function(s){s=R(s);var c=this.min,p=this.max,v=s.min,T=s.max,N=T.x>c.x&&v.x<p.x,X=T.y>c.y&&v.y<p.y;return N&&X},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,p=this.max,v=Math.abs(c.x-p.x)*s,T=Math.abs(c.y-p.y)*s;return R(ie(c.x-v,c.y-T),ie(p.x+v,p.y+T))},equals:function(s){return s?(s=R(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function R(s,c){return!s||s instanceof he?s:new he(s,c)}function J(s,c){if(s)for(var p=c?[s,c]:s,v=0,T=p.length;v<T;v++)this.extend(p[v])}J.prototype={extend:function(s){var c=this._southWest,p=this._northEast,v,T;if(s instanceof Z)v=s,T=s;else if(s instanceof J){if(v=s._southWest,T=s._northEast,!v||!T)return this}else return s?this.extend(ae(s)||q(s)):this;return!c&&!p?(this._southWest=new Z(v.lat,v.lng),this._northEast=new Z(T.lat,T.lng)):(c.lat=Math.min(v.lat,c.lat),c.lng=Math.min(v.lng,c.lng),p.lat=Math.max(T.lat,p.lat),p.lng=Math.max(T.lng,p.lng)),this},pad:function(s){var c=this._southWest,p=this._northEast,v=Math.abs(c.lat-p.lat)*s,T=Math.abs(c.lng-p.lng)*s;return new J(new Z(c.lat-v,c.lng-T),new Z(p.lat+v,p.lng+T))},getCenter:function(){return new Z((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Z(this.getNorth(),this.getWest())},getSouthEast:function(){return new Z(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Z||"lat"in s?s=ae(s):s=q(s);var c=this._southWest,p=this._northEast,v,T;return s instanceof J?(v=s.getSouthWest(),T=s.getNorthEast()):v=T=s,v.lat>=c.lat&&T.lat<=p.lat&&v.lng>=c.lng&&T.lng<=p.lng},intersects:function(s){s=q(s);var c=this._southWest,p=this._northEast,v=s.getSouthWest(),T=s.getNorthEast(),N=T.lat>=c.lat&&v.lat<=p.lat,X=T.lng>=c.lng&&v.lng<=p.lng;return N&&X},overlaps:function(s){s=q(s);var c=this._southWest,p=this._northEast,v=s.getSouthWest(),T=s.getNorthEast(),N=T.lat>c.lat&&v.lat<p.lat,X=T.lng>c.lng&&v.lng<p.lng;return N&&X},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=q(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function q(s,c){return s instanceof J?s:new J(s,c)}function Z(s,c,p){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,p!==void 0&&(this.alt=+p)}Z.prototype={equals:function(s,c){if(!s)return!1;s=ae(s);var p=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return p<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+g(this.lat,s)+", "+g(this.lng,s)+")"},distanceTo:function(s){return Fe.distance(this,ae(s))},wrap:function(){return Fe.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,p=c/Math.cos(Math.PI/180*this.lat);return q([this.lat-c,this.lng-p],[this.lat+c,this.lng+p])},clone:function(){return new Z(this.lat,this.lng,this.alt)}};function ae(s,c,p){return s instanceof Z?s:w(s)&&typeof s[0]!="object"?s.length===3?new Z(s[0],s[1],s[2]):s.length===2?new Z(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Z(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new Z(s,c,p)}var ye={latLngToPoint:function(s,c){var p=this.projection.project(s),v=this.scale(c);return this.transformation._transform(p,v)},pointToLatLng:function(s,c){var p=this.scale(c),v=this.transformation.untransform(s,p);return this.projection.unproject(v)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,p=this.scale(s),v=this.transformation.transform(c.min,p),T=this.transformation.transform(c.max,p);return new he(v,T)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?h(s.lng,this.wrapLng,!0):s.lng,p=this.wrapLat?h(s.lat,this.wrapLat,!0):s.lat,v=s.alt;return new Z(p,c,v)},wrapLatLngBounds:function(s){var c=s.getCenter(),p=this.wrapLatLng(c),v=c.lat-p.lat,T=c.lng-p.lng;if(v===0&&T===0)return s;var N=s.getSouthWest(),X=s.getNorthEast(),te=new Z(N.lat-v,N.lng-T),ue=new Z(X.lat-v,X.lng-T);return new J(te,ue)}},Fe=a({},ye,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var p=Math.PI/180,v=s.lat*p,T=c.lat*p,N=Math.sin((c.lat-s.lat)*p/2),X=Math.sin((c.lng-s.lng)*p/2),te=N*N+Math.cos(v)*Math.cos(T)*X*X,ue=2*Math.atan2(Math.sqrt(te),Math.sqrt(1-te));return this.R*ue}}),be=6378137,_e={R:be,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,p=this.MAX_LATITUDE,v=Math.max(Math.min(p,s.lat),-p),T=Math.sin(v*c);return new re(this.R*s.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(s){var c=180/Math.PI;return new Z((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:function(){var s=be*Math.PI;return new he([-s,-s],[s,s])}()};function Be(s,c,p,v){if(w(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=p,this._d=v}Be.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new re((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function V(s,c,p,v){return new Be(s,c,p,v)}var qe=a({},Fe,{code:"EPSG:3857",projection:_e,transformation:function(){var s=.5/(Math.PI*_e.R);return V(s,.5,-s,.5)}()}),it=a({},qe,{code:"EPSG:900913"});function ot(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Xe(s,c){var p="",v,T,N,X,te,ue;for(v=0,N=s.length;v<N;v++){for(te=s[v],T=0,X=te.length;T<X;T++)ue=te[T],p+=(T?"L":"M")+ue.x+" "+ue.y;p+=c?De.svg?"z":"x":""}return p||"M0 0"}var Ne=document.documentElement.style,St="ActiveXObject"in window,Wt=St&&!document.addEventListener,pe="msLaunchUri"in navigator&&!("documentMode"in document),Ae=Cr("webkit"),Pe=Cr("android"),Ue=Cr("android 2")||Cr("android 3"),et=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),pt=Pe&&Cr("Google")&&et<537&&!("AudioNode"in window),Ze=!!window.opera,Qt=!pe&&Cr("chrome"),Tt=Cr("gecko")&&!Ae&&!Ze&&!St,Bt=!Qt&&Cr("safari"),He=Cr("phantom"),ce="OTransition"in Ne,ge=navigator.platform.indexOf("Win")===0,Ee=St&&"transition"in Ne,Oe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ue,Ve="MozPerspective"in Ne,Ct=!window.L_DISABLE_3D&&(Ee||Oe||Ve)&&!ce&&!He,lt=typeof orientation<"u"||Cr("mobile"),Ke=lt&&Ae,Je=lt&&Oe,ft=!window.PointerEvent&&window.MSPointerEvent,mt=!!(window.PointerEvent||ft),or="ontouchstart"in window||!!window.TouchEvent,Nt=!window.L_NO_TOUCH&&(or||mt),st=lt&&Ze,Q=lt&&Tt,ve=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ze=function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return s}(),ct=function(){return!!document.createElement("canvas").getContext}(),xt=!!(document.createElementNS&&ot("svg").createSVGRect),bt=!!xt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Zt=!xt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),er=navigator.platform.indexOf("Mac")===0,ia=navigator.platform.indexOf("Linux")===0;function Cr(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var De={ie:St,ielt9:Wt,edge:pe,webkit:Ae,android:Pe,android23:Ue,androidStock:pt,opera:Ze,chrome:Qt,gecko:Tt,safari:Bt,phantom:He,opera12:ce,win:ge,ie3d:Ee,webkit3d:Oe,gecko3d:Ve,any3d:Ct,mobile:lt,mobileWebkit:Ke,mobileWebkit3d:Je,msPointer:ft,pointer:mt,touch:Nt,touchNative:or,mobileOpera:st,mobileGecko:Q,retina:ve,passiveEvents:ze,canvas:ct,svg:xt,vml:Zt,inlineSvg:bt,mac:er,linux:ia},b=De.msPointer?"MSPointerDown":"pointerdown",I=De.msPointer?"MSPointerMove":"pointermove",P=De.msPointer?"MSPointerUp":"pointerup",B=De.msPointer?"MSPointerCancel":"pointercancel",z={touchstart:b,touchmove:I,touchend:P,touchcancel:B},U={touchstart:Re,touchmove:Ce,touchend:Ce,touchcancel:Ce},ee={},me=!1;function ne(s,c,p){return c==="touchstart"&&Ie(),U[c]?(p=U[c].bind(this,p),s.addEventListener(z[c],p,!1),p):(console.warn("wrong event specified:",c),m)}function se(s,c,p){if(!z[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(z[c],p,!1)}function oe(s){ee[s.pointerId]=s}function ke(s){ee[s.pointerId]&&(ee[s.pointerId]=s)}function Le(s){delete ee[s.pointerId]}function Ie(){me||(document.addEventListener(b,oe,!0),document.addEventListener(I,ke,!0),document.addEventListener(P,Le,!0),document.addEventListener(B,Le,!0),me=!0)}function Ce(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var p in ee)c.touches.push(ee[p]);c.changedTouches=[c],s(c)}}function Re(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&_r(c),Ce(s,c)}function Ye(s){var c={},p,v;for(v in s)p=s[v],c[v]=p&&p.bind?p.bind(s):p;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Ot=200;function Rt(s,c){s.addEventListener("dblclick",c);var p=0,v;function T(N){if(N.detail!==1){v=N.detail;return}if(!(N.pointerType==="mouse"||N.sourceCapabilities&&!N.sourceCapabilities.firesTouchEvents)){var X=Fm(N);if(!(X.some(function(ue){return ue instanceof HTMLLabelElement&&ue.attributes.for})&&!X.some(function(ue){return ue instanceof HTMLInputElement||ue instanceof HTMLSelectElement}))){var te=Date.now();te-p<=Ot?(v++,v===2&&c(Ye(N))):v=1,p=te}}}return s.addEventListener("click",T),{dblclick:c,simDblclick:T}}function hr(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var Ea=Sc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Bn=Sc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ya=Bn==="webkitTransition"||Bn==="OTransition"?Bn+"End":"transitionend";function sa(s){return typeof s=="string"?document.getElementById(s):s}function Sa(s,c){var p=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!p||p==="auto")&&document.defaultView){var v=document.defaultView.getComputedStyle(s,null);p=v?v[c]:null}return p==="auto"?null:p}function tt(s,c,p){var v=document.createElement(s);return v.className=c||"",p&&p.appendChild(v),v}function zt(s){var c=s.parentNode;c&&c.removeChild(s)}function kc(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Ss(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function Ts(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function a0(s,c){if(s.classList!==void 0)return s.classList.contains(c);var p=Ec(s);return p.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(p)}function ut(s,c){if(s.classList!==void 0)for(var p=_(c),v=0,T=p.length;v<T;v++)s.classList.add(p[v]);else if(!a0(s,c)){var N=Ec(s);i0(s,(N?N+" ":"")+c)}}function Kt(s,c){s.classList!==void 0?s.classList.remove(c):i0(s,x((" "+Ec(s)+" ").replace(" "+c+" "," ")))}function i0(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function Ec(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function wn(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&Nk(s,c)}function Nk(s,c){var p=!1,v="DXImageTransform.Microsoft.Alpha";try{p=s.filters.item(v)}catch{if(c===1)return}c=Math.round(c*100),p?(p.Enabled=c!==100,p.Opacity=c):s.style.filter+=" progid:"+v+"(opacity="+c+")"}function Sc(s){for(var c=document.documentElement.style,p=0;p<s.length;p++)if(s[p]in c)return s[p];return!1}function Ii(s,c,p){var v=c||new re(0,0);s.style[Ea]=(De.ie3d?"translate("+v.x+"px,"+v.y+"px)":"translate3d("+v.x+"px,"+v.y+"px,0)")+(p?" scale("+p+")":"")}function tr(s,c){s._leaflet_pos=c,De.any3d?Ii(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function Di(s){return s._leaflet_pos||new re(0,0)}var Ro,Mo,s0;if("onselectstart"in document)Ro=function(){rt(window,"selectstart",_r)},Mo=function(){Lt(window,"selectstart",_r)};else{var Io=Sc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ro=function(){if(Io){var s=document.documentElement.style;s0=s[Io],s[Io]="none"}},Mo=function(){Io&&(document.documentElement.style[Io]=s0,s0=void 0)}}function o0(){rt(window,"dragstart",_r)}function l0(){Lt(window,"dragstart",_r)}var Tc,c0;function u0(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Cc(),Tc=s,c0=s.style.outlineStyle,s.style.outlineStyle="none",rt(window,"keydown",Cc))}function Cc(){Tc&&(Tc.style.outlineStyle=c0,Tc=void 0,c0=void 0,Lt(window,"keydown",Cc))}function Am(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function f0(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var Ak={__proto__:null,TRANSFORM:Ea,TRANSITION:Bn,TRANSITION_END:Ya,get:sa,getStyle:Sa,create:tt,remove:zt,empty:kc,toFront:Ss,toBack:Ts,hasClass:a0,addClass:ut,removeClass:Kt,setClass:i0,getClass:Ec,setOpacity:wn,testProp:Sc,setTransform:Ii,setPosition:tr,getPosition:Di,get disableTextSelection(){return Ro},get enableTextSelection(){return Mo},disableImageDrag:o0,enableImageDrag:l0,preventOutline:u0,restoreOutline:Cc,getSizedParentNode:Am,getScale:f0};function rt(s,c,p,v){if(c&&typeof c=="object")for(var T in c)h0(s,T,c[T],p);else{c=_(c);for(var N=0,X=c.length;N<X;N++)h0(s,c[N],p,v)}return this}var oa="_leaflet_events";function Lt(s,c,p,v){if(arguments.length===1)Lm(s),delete s[oa];else if(c&&typeof c=="object")for(var T in c)p0(s,T,c[T],p);else if(c=_(c),arguments.length===2)Lm(s,function(te){return F(c,te)!==-1});else for(var N=0,X=c.length;N<X;N++)p0(s,c[N],p,v);return this}function Lm(s,c){for(var p in s[oa]){var v=p.split(/\d/)[0];(!c||c(v))&&p0(s,v,null,null,p)}}var d0={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function h0(s,c,p,v){var T=c+u(p)+(v?"_"+u(v):"");if(s[oa]&&s[oa][T])return this;var N=function(te){return p.call(v||s,te||window.event)},X=N;!De.touchNative&&De.pointer&&c.indexOf("touch")===0?N=ne(s,c,N):De.touch&&c==="dblclick"?N=Rt(s,N):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(d0[c]||c,N,De.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(N=function(te){te=te||window.event,g0(s,te)&&X(te)},s.addEventListener(d0[c],N,!1)):s.addEventListener(c,X,!1):s.attachEvent("on"+c,N),s[oa]=s[oa]||{},s[oa][T]=N}function p0(s,c,p,v,T){T=T||c+u(p)+(v?"_"+u(v):"");var N=s[oa]&&s[oa][T];if(!N)return this;!De.touchNative&&De.pointer&&c.indexOf("touch")===0?se(s,c,N):De.touch&&c==="dblclick"?hr(s,N):"removeEventListener"in s?s.removeEventListener(d0[c]||c,N,!1):s.detachEvent("on"+c,N),s[oa][T]=null}function ji(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function m0(s){return h0(s,"wheel",ji),this}function Do(s){return rt(s,"mousedown touchstart dblclick contextmenu",ji),s._leaflet_disable_click=!0,this}function _r(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Bi(s){return _r(s),ji(s),this}function Fm(s){if(s.composedPath)return s.composedPath();for(var c=[],p=s.target;p;)c.push(p),p=p.parentNode;return c}function Pm(s,c){if(!c)return new re(s.clientX,s.clientY);var p=f0(c),v=p.boundingClientRect;return new re((s.clientX-v.left)/p.x-c.clientLeft,(s.clientY-v.top)/p.y-c.clientTop)}var Lk=De.linux&&De.chrome?window.devicePixelRatio:De.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Om(s){return De.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Lk:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function g0(s,c){var p=c.relatedTarget;if(!p)return!0;try{for(;p&&p!==s;)p=p.parentNode}catch{return!1}return p!==s}var Fk={__proto__:null,on:rt,off:Lt,stopPropagation:ji,disableScrollPropagation:m0,disableClickPropagation:Do,preventDefault:_r,stop:Bi,getPropagationPath:Fm,getMousePosition:Pm,getWheelDelta:Om,isExternalTarget:g0,addListener:rt,removeListener:Lt},Rm=xe.extend({run:function(s,c,p,v){this.stop(),this._el=s,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(v||.5,.2),this._startPos=Di(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=H(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,p=this._duration*1e3;c<p?this._runFrame(this._easeOut(c/p),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var p=this._startPos.add(this._offset.multiplyBy(s));c&&p._round(),tr(this._el,p),this.fire("step")},_complete:function(){W(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),_t=xe.extend({options:{crs:qe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=y(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(ae(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Bn&&De.any3d&&!De.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,Ya,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,p){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(ae(s),c,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=a({animate:p.animate},p.zoom),p.pan=a({animate:p.animate,duration:p.duration},p.pan));var v=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,p.zoom):this._tryAnimatedPan(s,p.pan);if(v)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,p.pan&&p.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,p){var v=this.getZoomScale(c),T=this.getSize().divideBy(2),N=s instanceof re?s:this.latLngToContainerPoint(s),X=N.subtract(T).multiplyBy(1-1/v),te=this.containerPointToLatLng(T.add(X));return this.setView(te,c,{zoom:p})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():q(s);var p=ie(c.paddingTopLeft||c.padding||[0,0]),v=ie(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(s,!1,p.add(v));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:s.getCenter(),zoom:T};var N=v.subtract(p).divideBy(2),X=this.project(s.getSouthWest(),T),te=this.project(s.getNorthEast(),T),ue=this.unproject(X.add(te).divideBy(2).add(N),T);return{center:ue,zoom:T}},fitBounds:function(s,c){if(s=q(s),!s.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(s,c);return this.setView(p.center,p.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=ie(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Rm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ut(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,p,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,p){if(p=p||{},p.animate===!1||!De.any3d)return this.setView(s,c,p);this._stop();var v=this.project(this.getCenter()),T=this.project(s),N=this.getSize(),X=this._zoom;s=ae(s),c=c===void 0?X:c;var te=Math.max(N.x,N.y),ue=te*this.getZoomScale(X,c),we=T.distanceTo(v)||1,Me=1.42,$e=Me*Me;function dt(rr){var jc=rr?-1:1,_E=rr?ue:te,yE=ue*ue-te*te+jc*$e*$e*we*we,wE=2*_E*$e*we,b0=yE/wE,pg=Math.sqrt(b0*b0+1)-b0,kE=pg<1e-9?-18:Math.log(pg);return kE}function zr(rr){return(Math.exp(rr)-Math.exp(-rr))/2}function pr(rr){return(Math.exp(rr)+Math.exp(-rr))/2}function En(rr){return zr(rr)/pr(rr)}var Yr=dt(0);function Fs(rr){return te*(pr(Yr)/pr(Yr+Me*rr))}function mE(rr){return te*(pr(Yr)*En(Yr+Me*rr)-zr(Yr))/$e}function gE(rr){return 1-Math.pow(1-rr,1.5)}var xE=Date.now(),dg=(dt(1)-Yr)/Me,vE=p.duration?1e3*p.duration:1e3*dg*.8;function hg(){var rr=(Date.now()-xE)/vE,jc=gE(rr)*dg;rr<=1?(this._flyToFrame=H(hg,this),this._move(this.unproject(v.add(T.subtract(v).multiplyBy(mE(jc)/we)),X),this.getScaleZoom(te/Fs(jc),X),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),hg.call(this),this},flyToBounds:function(s,c){var p=this._getBoundsCenterZoom(s,c);return this.flyTo(p.center,p.zoom,c)},setMaxBounds:function(s){return s=q(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var p=this.getCenter(),v=this._limitCenter(p,this._zoom,q(s));return p.equals(v)||this.panTo(v,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var p=ie(c.paddingTopLeft||c.padding||[0,0]),v=ie(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),N=this.project(s),X=this.getPixelBounds(),te=R([X.min.add(p),X.max.subtract(v)]),ue=te.getSize();if(!te.contains(N)){this._enforcingBounds=!0;var we=N.subtract(te.getCenter()),Me=te.extend(N).getSize().subtract(ue);T.x+=we.x<0?-Me.x:Me.x,T.y+=we.y<0?-Me.y:Me.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=a({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),v=c.divideBy(2).round(),T=p.divideBy(2).round(),N=v.subtract(T);return!N.x&&!N.y?this:(s.animate&&s.pan?this.panBy(N):(s.pan&&this._rawPanBy(N),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=a({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),p=o(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,p,s):navigator.geolocation.getCurrentPosition(c,p,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,p=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,p=s.coords.longitude,v=new Z(c,p),T=v.toBounds(s.coords.accuracy*2),N=this._locateOptions;if(N.setView){var X=this.getBoundsZoom(T);this.setView(v,N.maxZoom?Math.min(X,N.maxZoom):X)}var te={latlng:v,bounds:T,timestamp:s.timestamp};for(var ue in s.coords)typeof s.coords[ue]=="number"&&(te[ue]=s.coords[ue]);this.fire("locationfound",te)}},addHandler:function(s,c){if(!c)return this;var p=this[s]=new c(this);return this._handlers.push(p),this.options[s]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),zt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(W(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)zt(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var p="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),v=tt("div",p,c||this._mapPane);return s&&(this._panes[s]=v),v},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),p=this.unproject(s.getTopRight());return new J(c,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,p){s=q(s),p=ie(p||[0,0]);var v=this.getZoom()||0,T=this.getMinZoom(),N=this.getMaxZoom(),X=s.getNorthWest(),te=s.getSouthEast(),ue=this.getSize().subtract(p),we=R(this.project(te,v),this.project(X,v)).getSize(),Me=De.any3d?this.options.zoomSnap:1,$e=ue.x/we.x,dt=ue.y/we.y,zr=c?Math.max($e,dt):Math.min($e,dt);return v=this.getScaleZoom(zr,v),Me&&(v=Math.round(v/(Me/100))*(Me/100),v=c?Math.ceil(v/Me)*Me:Math.floor(v/Me)*Me),Math.max(T,Math.min(N,v))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new re(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var p=this._getTopLeftPoint(s,c);return new he(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var p=this.options.crs;return c=c===void 0?this._zoom:c,p.scale(s)/p.scale(c)},getScaleZoom:function(s,c){var p=this.options.crs;c=c===void 0?this._zoom:c;var v=p.zoom(s*p.scale(c));return isNaN(v)?1/0:v},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(ae(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ie(s),c)},layerPointToLatLng:function(s){var c=ie(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(ae(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(ae(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(q(s))},distance:function(s,c){return this.options.crs.distance(ae(s),ae(c))},containerPointToLayerPoint:function(s){return ie(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ie(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(ie(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ae(s)))},mouseEventToContainerPoint:function(s){return Pm(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=sa(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&De.any3d,ut(s,"leaflet-container"+(De.touch?" leaflet-touch":"")+(De.retina?" leaflet-retina":"")+(De.ielt9?" leaflet-oldie":"")+(De.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Sa(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),tr(this._mapPane,new re(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ut(s.markerPane,"leaflet-zoom-hide"),ut(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,p){tr(this._mapPane,new re(0,0));var v=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,p)._move(s,c)._moveEnd(T),this.fire("viewreset"),v&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,p,v){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),v?p&&p.pinch&&this.fire("zoom",p):((T||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return W(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){tr(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[u(this._container)]=this;var c=s?Lt:rt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),De.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){W(this._resizeRequest),this._resizeRequest=H(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var p=[],v,T=c==="mouseout"||c==="mouseover",N=s.target||s.srcElement,X=!1;N;){if(v=this._targets[u(N)],v&&(c==="click"||c==="preclick")&&this._draggableMoved(v)){X=!0;break}if(v&&v.listens(c,!0)&&(T&&!g0(N,s)||(p.push(v),T))||N===this._container)break;N=N.parentNode}return!p.length&&!X&&!T&&this.listens(c,!0)&&(p=[this]),p},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var p=s.type;p==="mousedown"&&u0(c),this._fireDOMEvent(s,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,p){if(s.type==="click"){var v=a({},s);v.type="preclick",this._fireDOMEvent(v,v.type,p)}var T=this._findEventTargets(s,c);if(p){for(var N=[],X=0;X<p.length;X++)p[X].listens(c,!0)&&N.push(p[X]);T=N.concat(T)}if(T.length){c==="contextmenu"&&_r(s);var te=T[0],ue={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var we=te.getLatLng&&(!te._radius||te._radius<=10);ue.containerPoint=we?this.latLngToContainerPoint(te.getLatLng()):this.mouseEventToContainerPoint(s),ue.layerPoint=this.containerPointToLayerPoint(ue.containerPoint),ue.latlng=we?te.getLatLng():this.layerPointToLatLng(ue.layerPoint)}for(X=0;X<T.length;X++)if(T[X].fire(c,ue,!0),ue.originalEvent._stopped||T[X].options.bubblingMouseEvents===!1&&F(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return Di(this._mapPane)||new re(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var p=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var p=this.getSize()._divideBy(2);return this.project(s,c)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,p){var v=this._getNewPixelOrigin(p,c);return this.project(s,c)._subtract(v)},_latLngBoundsToNewLayerBounds:function(s,c,p){var v=this._getNewPixelOrigin(p,c);return R([this.project(s.getSouthWest(),c)._subtract(v),this.project(s.getNorthWest(),c)._subtract(v),this.project(s.getSouthEast(),c)._subtract(v),this.project(s.getNorthEast(),c)._subtract(v)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,p){if(!p)return s;var v=this.project(s,c),T=this.getSize().divideBy(2),N=new he(v.subtract(T),v.add(T)),X=this._getBoundsOffset(N,p,c);return Math.abs(X.x)<=1&&Math.abs(X.y)<=1?s:this.unproject(v.add(X),c)},_limitOffset:function(s,c){if(!c)return s;var p=this.getPixelBounds(),v=new he(p.min.add(s),p.max.add(s));return s.add(this._getBoundsOffset(v,c))},_getBoundsOffset:function(s,c,p){var v=R(this.project(c.getNorthEast(),p),this.project(c.getSouthWest(),p)),T=v.min.subtract(s.min),N=v.max.subtract(s.max),X=this._rebound(T.x,-N.x),te=this._rebound(T.y,-N.y);return new re(X,te)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),p=this.getMaxZoom(),v=De.any3d?this.options.zoomSnap:1;return v&&(s=Math.round(s/v)*v),Math.max(c,Math.min(p,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Kt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var p=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,c),!0)},_createAnimProxy:function(){var s=this._proxy=tt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var p=Ea,v=this._proxy.style[p];Ii(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),v===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){zt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();Ii(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var v=this.getZoomScale(c),T=this._getCenterOffset(s)._divideBy(1-1/v);return p.animate!==!0&&!this.getSize().contains(T)?!1:(H(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,p,v){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,ut(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:v}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Kt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Pk(s,c){return new _t(s,c)}var zn=Se.extend({options:{position:"topright"},initialize:function(s){y(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),p=this.getPosition(),v=s._controlCorners[p];return ut(c,"leaflet-control"),p.indexOf("bottom")!==-1?v.insertBefore(c,v.firstChild):v.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(zt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),jo=function(s){return new zn(s)};_t.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",p=this._controlContainer=tt("div",c+"control-container",this._container);function v(T,N){var X=c+T+" "+c+N;s[T+N]=tt("div",X,p)}v("top","left"),v("top","right"),v("bottom","left"),v("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)zt(this._controlCorners[s]);zt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Mm=zn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,p,v){return p<v?-1:v<p?1:0}},initialize:function(s,c,p){y(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var v in s)this._addLayer(s[v],v);for(v in c)this._addLayer(c[v],v,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return zn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ut(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(ut(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Kt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Kt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=tt("div",s),p=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Do(c),m0(c);var v=this._section=tt("section",s+"-list");p&&(this._map.on("click",this.collapse,this),rt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=tt("a",s+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),rt(T,{keydown:function(N){N.keyCode===13&&this._expandSafely()},click:function(N){_r(N),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=tt("div",s+"-base",v),this._separator=tt("div",s+"-separator",v),this._overlaysList=tt("div",s+"-overlays",v),c.appendChild(v)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,p){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:p}),this.options.sortLayers&&this._layers.sort(o(function(v,T){return this.options.sortFunction(v.layer,T.layer,v.name,T.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;kc(this._baseLayersList),kc(this._overlaysList),this._layerControlInputs=[];var s,c,p,v,T=0;for(p=0;p<this._layers.length;p++)v=this._layers[p],this._addItem(v),c=c||v.overlay,s=s||!v.overlay,T+=v.overlay?0:1;return this.options.hideSingleBase&&(s=s&&T>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(u(s.target)),p=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;p&&this._map.fire(p,c)},_createRadioElement:function(s,c){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",v=document.createElement("div");return v.innerHTML=p,v.firstChild},_addItem:function(s){var c=document.createElement("label"),p=this._map.hasLayer(s.layer),v;s.overlay?(v=document.createElement("input"),v.type="checkbox",v.className="leaflet-control-layers-selector",v.defaultChecked=p):v=this._createRadioElement("leaflet-base-layers_"+u(this),p),this._layerControlInputs.push(v),v.layerId=u(s.layer),rt(v,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+s.name;var N=document.createElement("span");c.appendChild(N),N.appendChild(v),N.appendChild(T);var X=s.overlay?this._overlaysList:this._baseLayersList;return X.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,p,v=[],T=[];this._handlingClick=!0;for(var N=s.length-1;N>=0;N--)c=s[N],p=this._getLayer(c.layerId).layer,c.checked?v.push(p):c.checked||T.push(p);for(N=0;N<T.length;N++)this._map.hasLayer(T[N])&&this._map.removeLayer(T[N]);for(N=0;N<v.length;N++)this._map.hasLayer(v[N])||this._map.addLayer(v[N]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,p,v=this._map.getZoom(),T=s.length-1;T>=0;T--)c=s[T],p=this._getLayer(c.layerId).layer,c.disabled=p.options.minZoom!==void 0&&v<p.options.minZoom||p.options.maxZoom!==void 0&&v>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,rt(s,"click",_r),this.expand();var c=this;setTimeout(function(){Lt(s,"click",_r),c._preventClick=!1})}}),Ok=function(s,c,p){return new Mm(s,c,p)},x0=zn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",p=tt("div",c+" leaflet-bar"),v=this.options;return this._zoomInButton=this._createButton(v.zoomInText,v.zoomInTitle,c+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(v.zoomOutText,v.zoomOutTitle,c+"-out",p,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,p,v,T){var N=tt("a",p,v);return N.innerHTML=s,N.href="#",N.title=c,N.setAttribute("role","button"),N.setAttribute("aria-label",c),Do(N),rt(N,"click",Bi),rt(N,"click",T,this),rt(N,"click",this._refocusOnMap,this),N},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";Kt(this._zoomInButton,c),Kt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(ut(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(ut(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});_t.mergeOptions({zoomControl:!0}),_t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new x0,this.addControl(this.zoomControl))});var Rk=function(s){return new x0(s)},Im=zn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",p=tt("div",c),v=this.options;return this._addScales(v,c+"-line",p),s.on(v.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),p},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,p){s.metric&&(this._mScale=tt("div",c,p)),s.imperial&&(this._iScale=tt("div",c,p))},_update:function(){var s=this._map,c=s.getSize().y/2,p=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(p)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),p=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,p,c/s)},_updateImperial:function(s){var c=s*3.2808399,p,v,T;c>5280?(p=c/5280,v=this._getRoundNum(p),this._updateScale(this._iScale,v+" mi",v/p)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(s,c,p){s.style.width=Math.round(this.options.maxWidth*p)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),p=s/c;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,c*p}}),Mk=function(s){return new Im(s)},Ik='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',v0=zn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(De.inlineSvg?Ik+" ":"")+"Leaflet</a>"},initialize:function(s){y(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=tt("div","leaflet-control-attribution"),Do(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var p=[];this.options.prefix&&p.push(this.options.prefix),s.length&&p.push(s.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});_t.mergeOptions({attributionControl:!0}),_t.addInitHook(function(){this.options.attributionControl&&new v0().addTo(this)});var Dk=function(s){return new v0(s)};zn.Layers=Mm,zn.Zoom=x0,zn.Scale=Im,zn.Attribution=v0,jo.layers=Ok,jo.zoom=Rk,jo.scale=Mk,jo.attribution=Dk;var la=Se.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});la.addTo=function(s,c){return s.addHandler(c,this),this};var jk={Events:Y},Dm=De.touch?"touchstart mousedown":"mousedown",Ja=xe.extend({options:{clickTolerance:3},initialize:function(s,c,p,v){y(this,v),this._element=s,this._dragStartTarget=c||s,this._preventOutline=p},enable:function(){this._enabled||(rt(this._dragStartTarget,Dm,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ja._dragging===this&&this.finishDrag(!0),Lt(this._dragStartTarget,Dm,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!a0(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Ja._dragging===this&&this.finishDrag();return}if(!(Ja._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Ja._dragging=this,this._preventOutline&&u0(this._element),o0(),Ro(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,p=Am(this._element);this._startPoint=new re(c.clientX,c.clientY),this._startPos=Di(this._element),this._parentScale=f0(p);var v=s.type==="mousedown";rt(document,v?"mousemove":"touchmove",this._onMove,this),rt(document,v?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,p=new re(c.clientX,c.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,_r(s),this._moved||(this.fire("dragstart"),this._moved=!0,ut(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ut(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),tr(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Kt(document.body,"leaflet-dragging"),this._lastTarget&&(Kt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Lt(document,"mousemove touchmove",this._onMove,this),Lt(document,"mouseup touchend touchcancel",this._onUp,this),l0(),Mo();var c=this._moved&&this._moving;this._moving=!1,Ja._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function jm(s,c,p){var v,T=[1,4,2,8],N,X,te,ue,we,Me,$e,dt;for(N=0,Me=s.length;N<Me;N++)s[N]._code=zi(s[N],c);for(te=0;te<4;te++){for($e=T[te],v=[],N=0,Me=s.length,X=Me-1;N<Me;X=N++)ue=s[N],we=s[X],ue._code&$e?we._code&$e||(dt=bc(we,ue,$e,c,p),dt._code=zi(dt,c),v.push(dt)):(we._code&$e&&(dt=bc(we,ue,$e,c,p),dt._code=zi(dt,c),v.push(dt)),v.push(ue));s=v}return s}function Bm(s,c){var p,v,T,N,X,te,ue,we,Me;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var $e=ae([0,0]),dt=q(s),zr=dt.getNorthWest().distanceTo(dt.getSouthWest())*dt.getNorthEast().distanceTo(dt.getNorthWest());zr<1700&&($e=_0(s));var pr=s.length,En=[];for(p=0;p<pr;p++){var Yr=ae(s[p]);En.push(c.project(ae([Yr.lat-$e.lat,Yr.lng-$e.lng])))}for(te=ue=we=0,p=0,v=pr-1;p<pr;v=p++)T=En[p],N=En[v],X=T.y*N.x-N.y*T.x,ue+=(T.x+N.x)*X,we+=(T.y+N.y)*X,te+=X*3;te===0?Me=En[0]:Me=[ue/te,we/te];var Fs=c.unproject(ie(Me));return ae([Fs.lat+$e.lat,Fs.lng+$e.lng])}function _0(s){for(var c=0,p=0,v=0,T=0;T<s.length;T++){var N=ae(s[T]);c+=N.lat,p+=N.lng,v++}return ae([c/v,p/v])}var Bk={__proto__:null,clipPolygon:jm,polygonCenter:Bm,centroid:_0};function zm(s,c){if(!c||!s.length)return s.slice();var p=c*c;return s=Hk(s,p),s=Uk(s,p),s}function Um(s,c,p){return Math.sqrt(Bo(s,c,p,!0))}function zk(s,c,p){return Bo(s,c,p)}function Uk(s,c){var p=s.length,v=typeof Uint8Array<"u"?Uint8Array:Array,T=new v(p);T[0]=T[p-1]=1,y0(s,T,c,0,p-1);var N,X=[];for(N=0;N<p;N++)T[N]&&X.push(s[N]);return X}function y0(s,c,p,v,T){var N=0,X,te,ue;for(te=v+1;te<=T-1;te++)ue=Bo(s[te],s[v],s[T],!0),ue>N&&(X=te,N=ue);N>p&&(c[X]=1,y0(s,c,p,v,X),y0(s,c,p,X,T))}function Hk(s,c){for(var p=[s[0]],v=1,T=0,N=s.length;v<N;v++)Vk(s[v],s[T])>c&&(p.push(s[v]),T=v);return T<N-1&&p.push(s[N-1]),p}var Hm;function Vm(s,c,p,v,T){var N=v?Hm:zi(s,p),X=zi(c,p),te,ue,we;for(Hm=X;;){if(!(N|X))return[s,c];if(N&X)return!1;te=N||X,ue=bc(s,c,te,p,T),we=zi(ue,p),te===N?(s=ue,N=we):(c=ue,X=we)}}function bc(s,c,p,v,T){var N=c.x-s.x,X=c.y-s.y,te=v.min,ue=v.max,we,Me;return p&8?(we=s.x+N*(ue.y-s.y)/X,Me=ue.y):p&4?(we=s.x+N*(te.y-s.y)/X,Me=te.y):p&2?(we=ue.x,Me=s.y+X*(ue.x-s.x)/N):p&1&&(we=te.x,Me=s.y+X*(te.x-s.x)/N),new re(we,Me,T)}function zi(s,c){var p=0;return s.x<c.min.x?p|=1:s.x>c.max.x&&(p|=2),s.y<c.min.y?p|=4:s.y>c.max.y&&(p|=8),p}function Vk(s,c){var p=c.x-s.x,v=c.y-s.y;return p*p+v*v}function Bo(s,c,p,v){var T=c.x,N=c.y,X=p.x-T,te=p.y-N,ue=X*X+te*te,we;return ue>0&&(we=((s.x-T)*X+(s.y-N)*te)/ue,we>1?(T=p.x,N=p.y):we>0&&(T+=X*we,N+=te*we)),X=s.x-T,te=s.y-N,v?X*X+te*te:new re(T,N)}function kn(s){return!w(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function $m(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),kn(s)}function Wm(s,c){var p,v,T,N,X,te,ue,we;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Me=ae([0,0]),$e=q(s),dt=$e.getNorthWest().distanceTo($e.getSouthWest())*$e.getNorthEast().distanceTo($e.getNorthWest());dt<1700&&(Me=_0(s));var zr=s.length,pr=[];for(p=0;p<zr;p++){var En=ae(s[p]);pr.push(c.project(ae([En.lat-Me.lat,En.lng-Me.lng])))}for(p=0,v=0;p<zr-1;p++)v+=pr[p].distanceTo(pr[p+1])/2;if(v===0)we=pr[0];else for(p=0,N=0;p<zr-1;p++)if(X=pr[p],te=pr[p+1],T=X.distanceTo(te),N+=T,N>v){ue=(N-v)/T,we=[te.x-ue*(te.x-X.x),te.y-ue*(te.y-X.y)];break}var Yr=c.unproject(ie(we));return ae([Yr.lat+Me.lat,Yr.lng+Me.lng])}var $k={__proto__:null,simplify:zm,pointToSegmentDistance:Um,closestPointOnSegment:zk,clipSegment:Vm,_getEdgeIntersection:bc,_getBitCode:zi,_sqClosestPointOnSegment:Bo,isFlat:kn,_flat:$m,polylineCenter:Wm},w0={project:function(s){return new re(s.lng,s.lat)},unproject:function(s){return new Z(s.y,s.x)},bounds:new he([-180,-90],[180,90])},k0={R:6378137,R_MINOR:6356752314245179e-9,bounds:new he([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,p=this.R,v=s.lat*c,T=this.R_MINOR/p,N=Math.sqrt(1-T*T),X=N*Math.sin(v),te=Math.tan(Math.PI/4-v/2)/Math.pow((1-X)/(1+X),N/2);return v=-p*Math.log(Math.max(te,1e-10)),new re(s.lng*c*p,v)},unproject:function(s){for(var c=180/Math.PI,p=this.R,v=this.R_MINOR/p,T=Math.sqrt(1-v*v),N=Math.exp(-s.y/p),X=Math.PI/2-2*Math.atan(N),te=0,ue=.1,we;te<15&&Math.abs(ue)>1e-7;te++)we=T*Math.sin(X),we=Math.pow((1-we)/(1+we),T/2),ue=Math.PI/2-2*Math.atan(N*we)-X,X+=ue;return new Z(X*c,s.x*c/p)}},Wk={__proto__:null,LonLat:w0,Mercator:k0,SphericalMercator:_e},Zk=a({},Fe,{code:"EPSG:3395",projection:k0,transformation:function(){var s=.5/(Math.PI*k0.R);return V(s,.5,-s,.5)}()}),Zm=a({},Fe,{code:"EPSG:4326",projection:w0,transformation:V(1/180,1,-1/180,.5)}),Gk=a({},ye,{projection:w0,transformation:V(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var p=c.lng-s.lng,v=c.lat-s.lat;return Math.sqrt(p*p+v*v)},infinite:!0});ye.Earth=Fe,ye.EPSG3395=Zk,ye.EPSG3857=qe,ye.EPSG900913=it,ye.EPSG4326=Zm,ye.Simple=Gk;var Un=xe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[u(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[u(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var p=this.getEvents();c.on(p,this),this.once("remove",function(){c.off(p,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});_t.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=u(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return u(s)in this._layers},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},_addLayers:function(s){s=s?w(s)?s:[s]:[];for(var c=0,p=s.length;c<p;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[u(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=u(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,p=this._getZoomSpan();for(var v in this._zoomBoundLayers){var T=this._zoomBoundLayers[v].options;s=T.minZoom===void 0?s:Math.min(s,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Cs=Un.extend({initialize:function(s,c){y(this,c),this._layers={};var p,v;if(s)for(p=0,v=s.length;p<v;p++)this.addLayer(s[p])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),p,v;for(p in this._layers)v=this._layers[p],v[s]&&v[s].apply(v,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return u(s)}}),Xk=function(s,c){return new Cs(s,c)},Ta=Cs.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Cs.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Cs.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new J;for(var c in this._layers){var p=this._layers[c];s.extend(p.getBounds?p.getBounds():p.getLatLng())}return s}}),qk=function(s,c){return new Ta(s,c)},bs=Se.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){y(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var p=this._getIconUrl(s);if(!p){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var v=this._createImg(p,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(v,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v},_setIconStyles:function(s,c){var p=this.options,v=p[c+"Size"];typeof v=="number"&&(v=[v,v]);var T=ie(v),N=ie(c==="shadow"&&p.shadowAnchor||p.iconAnchor||T&&T.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(p.className||""),N&&(s.style.marginLeft=-N.x+"px",s.style.marginTop=-N.y+"px"),T&&(s.style.width=T.x+"px",s.style.height=T.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return De.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Kk(s){return new bs(s)}var zo=bs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof zo.imagePath!="string"&&(zo.imagePath=this._detectIconPath()),(this.options.imagePath||zo.imagePath)+bs.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(p,v,T){var N=v.exec(p);return N&&N[T]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=tt("div","leaflet-default-icon-path",document.body),c=Sa(s,"background-image")||Sa(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Gm=la.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Ja(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ut(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Kt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,p=c._map,v=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,N=Di(c._icon),X=p.getPixelBounds(),te=p.getPixelOrigin(),ue=R(X.min._subtract(te).add(T),X.max._subtract(te).subtract(T));if(!ue.contains(N)){var we=ie((Math.max(ue.max.x,N.x)-ue.max.x)/(X.max.x-ue.max.x)-(Math.min(ue.min.x,N.x)-ue.min.x)/(X.min.x-ue.min.x),(Math.max(ue.max.y,N.y)-ue.max.y)/(X.max.y-ue.max.y)-(Math.min(ue.min.y,N.y)-ue.min.y)/(X.min.y-ue.min.y)).multiplyBy(v);p.panBy(we,{animate:!1}),this._draggable._newPos._add(we),this._draggable._startPos._add(we),tr(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=H(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(W(this._panRequest),this._panRequest=H(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,p=c._shadow,v=Di(c._icon),T=c._map.layerPointToLatLng(v);p&&tr(p,v),c._latlng=T,s.latlng=T,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){W(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Nc=Un.extend({options:{icon:new zo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){y(this,c),this._latlng=ae(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=ae(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=s.icon.createIcon(this._icon),v=!1;p!==this._icon&&(this._icon&&this._removeIcon(),v=!0,s.title&&(p.title=s.title),p.tagName==="IMG"&&(p.alt=s.alt||"")),ut(p,c),s.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(p,"focus",this._panOnFocus,this);var T=s.icon.createShadow(this._shadow),N=!1;T!==this._shadow&&(this._removeShadow(),N=!0),T&&(ut(T,c),T.alt=""),this._shadow=T,s.opacity<1&&this._updateOpacity(),v&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&N&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Lt(this._icon,"focus",this._panOnFocus,this),zt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&zt(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&tr(this._icon,s),this._shadow&&tr(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ut(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Gm)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Gm(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&wn(this._icon,s),this._shadow&&wn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,p=c.iconSize?ie(c.iconSize):ie(0,0),v=c.iconAnchor?ie(c.iconAnchor):ie(0,0);s.panInside(this._latlng,{paddingTopLeft:v,paddingBottomRight:p.subtract(v)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Yk(s,c){return new Nc(s,c)}var Qa=Un.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return y(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ac=Qa.extend({options:{fill:!0,radius:10},initialize:function(s,c){y(this,c),this._latlng=ae(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=ae(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return Qa.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,p=this._clickTolerance(),v=[s+p,c+p];this._pxBounds=new he(this._point.subtract(v),this._point.add(v))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Jk(s,c){return new Ac(s,c)}var E0=Ac.extend({initialize:function(s,c,p){if(typeof c=="number"&&(c=a({},p,{radius:c})),y(this,c),this._latlng=ae(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new J(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Qa.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,p=this._map,v=p.options.crs;if(v.distance===Fe.distance){var T=Math.PI/180,N=this._mRadius/Fe.R/T,X=p.project([c+N,s]),te=p.project([c-N,s]),ue=X.add(te).divideBy(2),we=p.unproject(ue).lat,Me=Math.acos((Math.cos(N*T)-Math.sin(c*T)*Math.sin(we*T))/(Math.cos(c*T)*Math.cos(we*T)))/T;(isNaN(Me)||Me===0)&&(Me=N/Math.cos(Math.PI/180*c)),this._point=ue.subtract(p.getPixelOrigin()),this._radius=isNaN(Me)?0:ue.x-p.project([we,s-Me]).x,this._radiusY=ue.y-X.y}else{var $e=v.unproject(v.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint($e).x}this._updateBounds()}});function Qk(s,c,p){return new E0(s,c,p)}var Ca=Qa.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){y(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,p=null,v=Bo,T,N,X=0,te=this._parts.length;X<te;X++)for(var ue=this._parts[X],we=1,Me=ue.length;we<Me;we++){T=ue[we-1],N=ue[we];var $e=v(s,T,N,!0);$e<c&&(c=$e,p=v(s,T,N))}return p&&(p.distance=Math.sqrt(c)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Wm(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=ae(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new J,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return kn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],p=kn(s),v=0,T=s.length;v<T;v++)p?(c[v]=ae(s[v]),this._bounds.extend(c[v])):c[v]=this._convertLatLngs(s[v]);return c},_project:function(){var s=new he;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new re(s,s);this._rawPxBounds&&(this._pxBounds=new he([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,p){var v=s[0]instanceof Z,T=s.length,N,X;if(v){for(X=[],N=0;N<T;N++)X[N]=this._map.latLngToLayerPoint(s[N]),p.extend(X[N]);c.push(X)}else for(N=0;N<T;N++)this._projectLatlngs(s[N],c,p)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,p,v,T,N,X,te,ue;for(p=0,T=0,N=this._rings.length;p<N;p++)for(ue=this._rings[p],v=0,X=ue.length;v<X-1;v++)te=Vm(ue[v],ue[v+1],s,v,!0),te&&(c[T]=c[T]||[],c[T].push(te[0]),(te[1]!==ue[v+1]||v===X-2)&&(c[T].push(te[1]),T++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,p=0,v=s.length;p<v;p++)s[p]=zm(s[p],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var p,v,T,N,X,te,ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(p=0,N=this._parts.length;p<N;p++)for(te=this._parts[p],v=0,X=te.length,T=X-1;v<X;T=v++)if(!(!c&&v===0)&&Um(s,te[T],te[v])<=ue)return!0;return!1}});function eE(s,c){return new Ca(s,c)}Ca._flat=$m;var Ns=Ca.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Bm(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=Ca.prototype._convertLatLngs.call(this,s),p=c.length;return p>=2&&c[0]instanceof Z&&c[0].equals(c[p-1])&&c.pop(),c},_setLatLngs:function(s){Ca.prototype._setLatLngs.call(this,s),kn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return kn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,p=new re(c,c);if(s=new he(s.min.subtract(p),s.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var v=0,T=this._rings.length,N;v<T;v++)N=jm(this._rings[v],s,!0),N.length&&this._parts.push(N)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,p,v,T,N,X,te,ue,we;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(N=0,ue=this._parts.length;N<ue;N++)for(p=this._parts[N],X=0,we=p.length,te=we-1;X<we;te=X++)v=p[X],T=p[te],v.y>s.y!=T.y>s.y&&s.x<(T.x-v.x)*(s.y-v.y)/(T.y-v.y)+v.x&&(c=!c);return c||Ca.prototype._containsPoint.call(this,s,!0)}});function tE(s,c){return new Ns(s,c)}var ba=Ta.extend({initialize:function(s,c){y(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=w(s)?s:s.features,p,v,T;if(c){for(p=0,v=c.length;p<v;p++)T=c[p],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var N=this.options;if(N.filter&&!N.filter(s))return this;var X=Lc(s,N);return X?(X.feature=Oc(s),X.defaultOptions=X.options,this.resetStyle(X),N.onEachFeature&&N.onEachFeature(s,X),this.addLayer(X)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=a({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function Lc(s,c){var p=s.type==="Feature"?s.geometry:s,v=p?p.coordinates:null,T=[],N=c&&c.pointToLayer,X=c&&c.coordsToLatLng||S0,te,ue,we,Me;if(!v&&!p)return null;switch(p.type){case"Point":return te=X(v),Xm(N,s,te,c);case"MultiPoint":for(we=0,Me=v.length;we<Me;we++)te=X(v[we]),T.push(Xm(N,s,te,c));return new Ta(T);case"LineString":case"MultiLineString":return ue=Fc(v,p.type==="LineString"?0:1,X),new Ca(ue,c);case"Polygon":case"MultiPolygon":return ue=Fc(v,p.type==="Polygon"?1:2,X),new Ns(ue,c);case"GeometryCollection":for(we=0,Me=p.geometries.length;we<Me;we++){var $e=Lc({geometry:p.geometries[we],type:"Feature",properties:s.properties},c);$e&&T.push($e)}return new Ta(T);case"FeatureCollection":for(we=0,Me=p.features.length;we<Me;we++){var dt=Lc(p.features[we],c);dt&&T.push(dt)}return new Ta(T);default:throw new Error("Invalid GeoJSON object.")}}function Xm(s,c,p,v){return s?s(c,p):new Nc(p,v&&v.markersInheritOptions&&v)}function S0(s){return new Z(s[1],s[0],s[2])}function Fc(s,c,p){for(var v=[],T=0,N=s.length,X;T<N;T++)X=c?Fc(s[T],c-1,p):(p||S0)(s[T]),v.push(X);return v}function T0(s,c){return s=ae(s),s.alt!==void 0?[g(s.lng,c),g(s.lat,c),g(s.alt,c)]:[g(s.lng,c),g(s.lat,c)]}function Pc(s,c,p,v){for(var T=[],N=0,X=s.length;N<X;N++)T.push(c?Pc(s[N],kn(s[N])?0:c-1,p,v):T0(s[N],v));return!c&&p&&T.length>0&&T.push(T[0].slice()),T}function As(s,c){return s.feature?a({},s.feature,{geometry:c}):Oc(c)}function Oc(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var C0={toGeoJSON:function(s){return As(this,{type:"Point",coordinates:T0(this.getLatLng(),s)})}};Nc.include(C0),E0.include(C0),Ac.include(C0),Ca.include({toGeoJSON:function(s){var c=!kn(this._latlngs),p=Pc(this._latlngs,c?1:0,!1,s);return As(this,{type:(c?"Multi":"")+"LineString",coordinates:p})}}),Ns.include({toGeoJSON:function(s){var c=!kn(this._latlngs),p=c&&!kn(this._latlngs[0]),v=Pc(this._latlngs,p?2:c?1:0,!0,s);return c||(v=[v]),As(this,{type:(p?"Multi":"")+"Polygon",coordinates:v})}}),Cs.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(p){c.push(p.toGeoJSON(s).geometry.coordinates)}),As(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var p=c==="GeometryCollection",v=[];return this.eachLayer(function(T){if(T.toGeoJSON){var N=T.toGeoJSON(s);if(p)v.push(N.geometry);else{var X=Oc(N);X.type==="FeatureCollection"?v.push.apply(v,X.features):v.push(X)}}}),p?As(this,{geometries:v,type:"GeometryCollection"}):{type:"FeatureCollection",features:v}}});function qm(s,c){return new ba(s,c)}var rE=qm,Rc=Un.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,p){this._url=s,this._bounds=q(c),y(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ut(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){zt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Ss(this._image),this},bringToBack:function(){return this._map&&Ts(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=q(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:tt("img");if(ut(c,"leaflet-image-layer"),this._zoomAnimated&&ut(c,"leaflet-zoom-animated"),this.options.className&&ut(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;Ii(this._image,p,c)},_reset:function(){var s=this._image,c=new he(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=c.getSize();tr(s,c.min),s.style.width=p.x+"px",s.style.height=p.y+"px"},_updateOpacity:function(){wn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),nE=function(s,c,p){return new Rc(s,c,p)},Km=Rc.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:tt("video");if(ut(c,"leaflet-image-layer"),this._zoomAnimated&&ut(c,"leaflet-zoom-animated"),this.options.className&&ut(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),s){for(var p=c.getElementsByTagName("source"),v=[],T=0;T<p.length;T++)v.push(p[T].src);this._url=p.length>0?v:[c.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var N=0;N<this._url.length;N++){var X=tt("source");X.src=this._url[N],c.appendChild(X)}}});function aE(s,c,p){return new Km(s,c,p)}var Ym=Rc.extend({_initImage:function(){var s=this._image=this._url;ut(s,"leaflet-image-layer"),this._zoomAnimated&&ut(s,"leaflet-zoom-animated"),this.options.className&&ut(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function iE(s,c,p){return new Ym(s,c,p)}var ca=Un.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof Z||w(s))?(this._latlng=ae(s),y(this,c)):(y(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&wn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&wn(this._container,1),this.bringToFront(),this.options.interactive&&(ut(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(wn(this._container,0),this._removeTimeout=setTimeout(o(zt,void 0,this._container),200)):zt(this._container),this.options.interactive&&(Kt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=ae(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ss(this._container),this},bringToBack:function(){return this._map&&Ts(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof Ta){c=null;var p=this._source._layers;for(var v in p)if(p[v]._map){c=p[v];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=ie(this.options.offset),p=this._getAnchor();this._zoomAnimated?tr(this._container,s.add(p)):c=c.add(s).add(p);var v=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=v+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});_t.include({_initOverlay:function(s,c,p,v){var T=c;return T instanceof s||(T=new s(v).setContent(c)),p&&T.setLatLng(p),T}}),Un.include({_initOverlay:function(s,c,p,v){var T=p;return T instanceof s?(y(T,v),T._source=this):(T=c&&!v?c:new s(v,this),T.setContent(p)),T}});var Mc=ca.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,ca.prototype.openOn.call(this,s)},onAdd:function(s){ca.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Qa||this._source.on("preclick",ji))},onRemove:function(s){ca.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Qa||this._source.off("preclick",ji))},getEvents:function(){var s=ca.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=tt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=tt("div",s+"-content-wrapper",c);if(this._contentNode=tt("div",s+"-content",p),Do(c),m0(this._contentNode),rt(c,"contextmenu",ji),this._tipContainer=tt("div",s+"-tip-container",c),this._tip=tt("div",s+"-tip",this._tipContainer),this.options.closeButton){var v=this._closeButton=tt("a",s+"-close-button",c);v.setAttribute("role","button"),v.setAttribute("aria-label","Close popup"),v.href="#close",v.innerHTML='<span aria-hidden="true">&#215;</span>',rt(v,"click",function(T){_r(T),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var p=s.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),c.width=p+1+"px",c.whiteSpace="",c.height="";var v=s.offsetHeight,T=this.options.maxHeight,N="leaflet-popup-scrolled";T&&v>T?(c.height=T+"px",ut(s,N)):Kt(s,N),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),p=this._getAnchor();tr(this._container,c.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(Sa(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+c,v=this._containerWidth,T=new re(this._containerLeft,-p-this._containerBottom);T._add(Di(this._container));var N=s.layerPointToContainerPoint(T),X=ie(this.options.autoPanPadding),te=ie(this.options.autoPanPaddingTopLeft||X),ue=ie(this.options.autoPanPaddingBottomRight||X),we=s.getSize(),Me=0,$e=0;N.x+v+ue.x>we.x&&(Me=N.x+v-we.x+ue.x),N.x-Me-te.x<0&&(Me=N.x-te.x),N.y+p+ue.y>we.y&&($e=N.y+p-we.y+ue.y),N.y-$e-te.y<0&&($e=N.y-te.y),(Me||$e)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Me,$e]))}},_getAnchor:function(){return ie(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),sE=function(s,c){return new Mc(s,c)};_t.mergeOptions({closePopupOnClick:!0}),_t.include({openPopup:function(s,c,p){return this._initOverlay(Mc,s,c,p).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Un.include({bindPopup:function(s,c){return this._popup=this._initOverlay(Mc,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Ta||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Bi(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof Qa)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Ic=ca.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){ca.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){ca.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=ca.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=tt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,p,v=this._map,T=this._container,N=v.latLngToContainerPoint(v.getCenter()),X=v.layerPointToContainerPoint(s),te=this.options.direction,ue=T.offsetWidth,we=T.offsetHeight,Me=ie(this.options.offset),$e=this._getAnchor();te==="top"?(c=ue/2,p=we):te==="bottom"?(c=ue/2,p=0):te==="center"?(c=ue/2,p=we/2):te==="right"?(c=0,p=we/2):te==="left"?(c=ue,p=we/2):X.x<N.x?(te="right",c=0,p=we/2):(te="left",c=ue+(Me.x+$e.x)*2,p=we/2),s=s.subtract(ie(c,p,!0)).add(Me).add($e),Kt(T,"leaflet-tooltip-right"),Kt(T,"leaflet-tooltip-left"),Kt(T,"leaflet-tooltip-top"),Kt(T,"leaflet-tooltip-bottom"),ut(T,"leaflet-tooltip-"+te),tr(T,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&wn(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return ie(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),oE=function(s,c){return new Ic(s,c)};_t.include({openTooltip:function(s,c,p){return this._initOverlay(Ic,s,c,p).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Un.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ic,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[c](p),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Ta||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(rt(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),rt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,p,v;this._tooltip.options.sticky&&s.originalEvent&&(p=this._map.mouseEventToContainerPoint(s.originalEvent),v=this._map.containerPointToLayerPoint(p),c=this._map.layerPointToLatLng(v)),this._tooltip.setLatLng(c)}});var Jm=bs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),p=this.options;if(p.html instanceof Element?(kc(c),c.appendChild(p.html)):c.innerHTML=p.html!==!1?p.html:"",p.bgPos){var v=ie(p.bgPos);c.style.backgroundPosition=-v.x+"px "+-v.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function lE(s){return new Jm(s)}bs.Default=zo;var Uo=Un.extend({options:{tileSize:256,opacity:1,updateWhenIdle:De.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){y(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),zt(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ss(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ts(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof re?s:new re(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,p=-s(-1/0,1/0),v=0,T=c.length,N;v<T;v++)N=c[v].style.zIndex,c[v]!==this._container&&N&&(p=s(p,+N));isFinite(p)&&(this.options.zIndex=p+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!De.ielt9){wn(this._container,this.options.opacity);var s=+new Date,c=!1,p=!1;for(var v in this._tiles){var T=this._tiles[v];if(!(!T.current||!T.loaded)){var N=Math.min(1,(s-T.loaded)/200);wn(T.el,N),N<1?c=!0:(T.active?p=!0:this._onOpaqueTile(T),T.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),c&&(W(this._fadeFrame),this._fadeFrame=H(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=tt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===s?(this._levels[p].el.style.zIndex=c-Math.abs(s-p),this._onUpdateLevel(p)):(zt(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var v=this._levels[s],T=this._map;return v||(v=this._levels[s]={},v.el=tt("div","leaflet-tile-container leaflet-zoom-animated",this._container),v.el.style.zIndex=c,v.origin=T.project(T.unproject(T.getPixelOrigin()),s).round(),v.zoom=s,this._setZoomTransform(v,T.getCenter(),T.getZoom()),m(v.el.offsetWidth),this._onCreateLevel(v)),this._level=v,v}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,c,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var v=c.coords;this._retainParent(v.x,v.y,v.z,v.z-5)||this._retainChildren(v.x,v.y,v.z,v.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)zt(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,p,v){var T=Math.floor(s/2),N=Math.floor(c/2),X=p-1,te=new re(+T,+N);te.z=+X;var ue=this._tileCoordsToKey(te),we=this._tiles[ue];return we&&we.active?(we.retain=!0,!0):(we&&we.loaded&&(we.retain=!0),X>v?this._retainParent(T,N,X,v):!1)},_retainChildren:function(s,c,p,v){for(var T=2*s;T<2*s+2;T++)for(var N=2*c;N<2*c+2;N++){var X=new re(T,N);X.z=p+1;var te=this._tileCoordsToKey(X),ue=this._tiles[te];if(ue&&ue.active){ue.retain=!0;continue}else ue&&ue.loaded&&(ue.retain=!0);p+1<v&&this._retainChildren(T,N,p+1,v)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,p,v){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var N=this.options.updateWhenZooming&&T!==this._tileZoom;(!v||N)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(s),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var p in this._levels)this._setZoomTransform(this._levels[p],s,c)},_setZoomTransform:function(s,c,p){var v=this._map.getZoomScale(p,s.zoom),T=s.origin.multiplyBy(v).subtract(this._map._getNewPixelOrigin(c,p)).round();De.any3d?Ii(s.el,T,v):tr(s.el,T)},_resetGrid:function(){var s=this._map,c=s.options.crs,p=this._tileSize=this.getTileSize(),v=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],v).x/p.x),Math.ceil(s.project([0,c.wrapLng[1]],v).x/p.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],v).y/p.x),Math.ceil(s.project([c.wrapLat[1],0],v).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,p=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),v=c.getZoomScale(p,this._tileZoom),T=c.project(s,this._tileZoom).floor(),N=c.getSize().divideBy(v*2);return new he(T.subtract(N),T.add(N))},_update:function(s){var c=this._map;if(c){var p=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var v=this._getTiledPixelBounds(s),T=this._pxBoundsToTileRange(v),N=T.getCenter(),X=[],te=this.options.keepBuffer,ue=new he(T.getBottomLeft().subtract([te,-te]),T.getTopRight().add([te,-te]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var we in this._tiles){var Me=this._tiles[we].coords;(Me.z!==this._tileZoom||!ue.contains(new re(Me.x,Me.y)))&&(this._tiles[we].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(s,p);return}for(var $e=T.min.y;$e<=T.max.y;$e++)for(var dt=T.min.x;dt<=T.max.x;dt++){var zr=new re(dt,$e);if(zr.z=this._tileZoom,!!this._isValidTile(zr)){var pr=this._tiles[this._tileCoordsToKey(zr)];pr?pr.current=!0:X.push(zr)}}if(X.sort(function(Yr,Fs){return Yr.distanceTo(N)-Fs.distanceTo(N)}),X.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var En=document.createDocumentFragment();for(dt=0;dt<X.length;dt++)this._addTile(X[dt],En);this._level.el.appendChild(En)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var p=this._globalTileRange;if(!c.wrapLng&&(s.x<p.min.x||s.x>p.max.x)||!c.wrapLat&&(s.y<p.min.y||s.y>p.max.y))return!1}if(!this.options.bounds)return!0;var v=this._tileCoordsToBounds(s);return q(this.options.bounds).overlaps(v)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,p=this.getTileSize(),v=s.scaleBy(p),T=v.add(p),N=c.unproject(v,s.z),X=c.unproject(T,s.z);return[N,X]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),p=new J(c[0],c[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),p=new re(+c[0],+c[1]);return p.z=+c[2],p},_removeTile:function(s){var c=this._tiles[s];c&&(zt(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){ut(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=m,s.onmousemove=m,De.ielt9&&this.options.opacity<1&&wn(s,this.options.opacity)},_addTile:function(s,c){var p=this._getTilePos(s),v=this._tileCoordsToKey(s),T=this.createTile(this._wrapCoords(s),o(this._tileReady,this,s));this._initTile(T),this.createTile.length<2&&H(o(this._tileReady,this,s,null,T)),tr(T,p),this._tiles[v]={el:T,coords:s,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:s})},_tileReady:function(s,c,p){c&&this.fire("tileerror",{error:c,tile:p,coords:s});var v=this._tileCoordsToKey(s);p=this._tiles[v],p&&(p.loaded=+new Date,this._map._fadeAnimated?(wn(p.el,0),W(this._fadeFrame),this._fadeFrame=H(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),c||(ut(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),De.ielt9||!this._map._fadeAnimated?H(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new re(this._wrapX?h(s.x,this._wrapX):s.x,this._wrapY?h(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new he(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function cE(s){return new Uo(s)}var Ls=Uo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=y(this,c),c.detectRetina&&De.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var p=document.createElement("img");return rt(p,"load",o(this._tileOnLoad,this,c,p)),rt(p,"error",o(this._tileOnError,this,c,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(s),p},getTileUrl:function(s){var c={r:De.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=p),c["-y"]=p}return E(this._url,a(c,this.options))},_tileOnLoad:function(s,c){De.ielt9?setTimeout(o(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,p){var v=this.options.errorTileUrl;v&&c.getAttribute("src")!==v&&(c.src=v),s(p,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,p=this.options.zoomReverse,v=this.options.zoomOffset;return p&&(s=c-s),s+v},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=m,c.onerror=m,!c.complete)){c.src=j;var p=this._tiles[s].coords;zt(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:p})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",j),Uo.prototype._removeTile.call(this,s)},_tileReady:function(s,c,p){if(!(!this._map||p&&p.getAttribute("src")===j))return Uo.prototype._tileReady.call(this,s,c,p)}});function Qm(s,c){return new Ls(s,c)}var eg=Ls.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var p=a({},this.defaultWmsParams);for(var v in c)v in this.options||(p[v]=c[v]);c=y(this,c);var T=c.detectRetina&&De.retina?2:1,N=this.getTileSize();p.width=N.x*T,p.height=N.y*T,this.wmsParams=p},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Ls.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),p=this._crs,v=R(p.project(c[0]),p.project(c[1])),T=v.min,N=v.max,X=(this._wmsVersion>=1.3&&this._crs===Zm?[T.y,T.x,N.y,N.x]:[T.x,T.y,N.x,N.y]).join(","),te=Ls.prototype.getTileUrl.call(this,s);return te+S(this.wmsParams,te,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+X},setParams:function(s,c){return a(this.wmsParams,s),c||this.redraw(),this}});function uE(s,c){return new eg(s,c)}Ls.WMS=eg,Qm.wms=uE;var Na=Un.extend({options:{padding:.1},initialize:function(s){y(this,s),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ut(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var p=this._map.getZoomScale(c,this._zoom),v=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),N=v.multiplyBy(-p).add(T).subtract(this._map._getNewPixelOrigin(s,c));De.any3d?Ii(this._container,N,p):tr(this._container,N)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),p=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new he(p,p.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),tg=Na.extend({options:{tolerance:0},getEvents:function(){var s=Na.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Na.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");rt(s,"mousemove",this._onMouseMove,this),rt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){W(this._redrawRequest),delete this._ctx,zt(this._container),Lt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Na.prototype._update.call(this);var s=this._bounds,c=this._container,p=s.getSize(),v=De.retina?2:1;tr(c,s.min),c.width=v*p.x,c.height=v*p.y,c.style.width=p.x+"px",c.style.height=p.y+"px",De.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Na.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[u(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,p=c.next,v=c.prev;p?p.prev=v:this._drawLast=v,v?v.next=p:this._drawFirst=p,delete s._order,delete this._layers[u(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),p=[],v,T;for(T=0;T<c.length;T++){if(v=Number(c[T]),isNaN(v))return;p.push(v)}s.options._dashArray=p}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||H(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new he,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var p=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var v=this._drawFirst;v;v=v.next)s=v.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var p,v,T,N,X=s._parts,te=X.length,ue=this._ctx;if(te){for(ue.beginPath(),p=0;p<te;p++){for(v=0,T=X[p].length;v<T;v++)N=X[p][v],ue[v?"lineTo":"moveTo"](N.x,N.y);c&&ue.closePath()}this._fillStroke(ue,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,p=this._ctx,v=Math.max(Math.round(s._radius),1),T=(Math.max(Math.round(s._radiusY),1)||v)/v;T!==1&&(p.save(),p.scale(1,T)),p.beginPath(),p.arc(c.x,c.y/T,v,0,Math.PI*2,!1),T!==1&&p.restore(),this._fillStroke(p,s)}},_fillStroke:function(s,c){var p=c.options;p.fill&&(s.globalAlpha=p.fillOpacity,s.fillStyle=p.fillColor||p.color,s.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=p.opacity,s.lineWidth=p.weight,s.strokeStyle=p.color,s.lineCap=p.lineCap,s.lineJoin=p.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),p,v,T=this._drawFirst;T;T=T.next)p=T.layer,p.options.interactive&&p._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(p))&&(v=p);this._fireEvent(v?[v]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(Kt(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var p,v,T=this._drawFirst;T;T=T.next)p=T.layer,p.options.interactive&&p._containsPoint(c)&&(v=p);v!==this._hoveredLayer&&(this._handleMouseOut(s),v&&(ut(this._container,"leaflet-interactive"),this._fireEvent([v],s,"mouseover"),this._hoveredLayer=v)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,p){this._map._fireDOMEvent(c,p||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var p=c.next,v=c.prev;if(p)p.prev=v;else return;v?v.next=p:p&&(this._drawFirst=p),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var p=c.next,v=c.prev;if(v)v.next=p;else return;p?p.prev=v:v&&(this._drawLast=v),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function rg(s){return De.canvas?new tg(s):null}var Ho=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),fE={_initContainer:function(){this._container=tt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Na.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=Ho("shape");ut(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=Ho("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;zt(c),s.removeInteractiveTarget(c),delete this._layers[u(s)]},_updateStyle:function(s){var c=s._stroke,p=s._fill,v=s.options,T=s._container;T.stroked=!!v.stroke,T.filled=!!v.fill,v.stroke?(c||(c=s._stroke=Ho("stroke")),T.appendChild(c),c.weight=v.weight+"px",c.color=v.color,c.opacity=v.opacity,v.dashArray?c.dashStyle=w(v.dashArray)?v.dashArray.join(" "):v.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=v.lineCap.replace("butt","flat"),c.joinstyle=v.lineJoin):c&&(T.removeChild(c),s._stroke=null),v.fill?(p||(p=s._fill=Ho("fill")),T.appendChild(p),p.color=v.fillColor||v.color,p.opacity=v.fillOpacity):p&&(T.removeChild(p),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),p=Math.round(s._radius),v=Math.round(s._radiusY||p);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+p+","+v+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){Ss(s._container)},_bringToBack:function(s){Ts(s._container)}},Dc=De.vml?Ho:ot,Vo=Na.extend({_initContainer:function(){this._container=Dc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Dc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){zt(this._container),Lt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Na.prototype._update.call(this);var s=this._bounds,c=s.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,p.setAttribute("width",c.x),p.setAttribute("height",c.y)),tr(p,s.min),p.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=Dc("path");s.options.className&&ut(c,s.options.className),s.options.interactive&&ut(c,"leaflet-interactive"),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){zt(s._path),s.removeInteractiveTarget(s._path),delete this._layers[u(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,p=s.options;c&&(p.stroke?(c.setAttribute("stroke",p.color),c.setAttribute("stroke-opacity",p.opacity),c.setAttribute("stroke-width",p.weight),c.setAttribute("stroke-linecap",p.lineCap),c.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?c.setAttribute("stroke-dasharray",p.dashArray):c.removeAttribute("stroke-dasharray"),p.dashOffset?c.setAttribute("stroke-dashoffset",p.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),p.fill?(c.setAttribute("fill",p.fillColor||p.color),c.setAttribute("fill-opacity",p.fillOpacity),c.setAttribute("fill-rule",p.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,Xe(s._parts,c))},_updateCircle:function(s){var c=s._point,p=Math.max(Math.round(s._radius),1),v=Math.max(Math.round(s._radiusY),1)||p,T="a"+p+","+v+" 0 1,0 ",N=s._empty()?"M0 0":"M"+(c.x-p)+","+c.y+T+p*2+",0 "+T+-p*2+",0 ";this._setPath(s,N)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){Ss(s._path)},_bringToBack:function(s){Ts(s._path)}});De.vml&&Vo.include(fE);function ng(s){return De.svg||De.vml?new Vo(s):null}_t.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&rg(s)||ng(s)}});var ag=Ns.extend({initialize:function(s,c){Ns.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=q(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function dE(s,c){return new ag(s,c)}Vo.create=Dc,Vo.pointsToPath=Xe,ba.geometryToLayer=Lc,ba.coordsToLatLng=S0,ba.coordsToLatLngs=Fc,ba.latLngToCoords=T0,ba.latLngsToCoords=Pc,ba.getFeature=As,ba.asFeature=Oc,_t.mergeOptions({boxZoom:!0});var ig=la.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Lt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){zt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ro(),o0(),this._startPoint=this._map.mouseEventToContainerPoint(s),rt(document,{contextmenu:Bi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=tt("div","leaflet-zoom-box",this._container),ut(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new he(this._point,this._startPoint),p=c.getSize();tr(this._box,c.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(zt(this._box),Kt(this._container,"leaflet-crosshair")),Mo(),l0(),Lt(document,{contextmenu:Bi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new J(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});_t.addInitHook("addHandler","boxZoom",ig),_t.mergeOptions({doubleClickZoom:!0});var sg=la.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,p=c.getZoom(),v=c.options.zoomDelta,T=s.originalEvent.shiftKey?p-v:p+v;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(s.containerPoint,T)}});_t.addInitHook("addHandler","doubleClickZoom",sg),_t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var og=la.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Ja(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}ut(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Kt(this._map._container,"leaflet-grab"),Kt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=q(this._map.options.maxBounds);this._offsetLimit=R(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),p=this._initialWorldOffset,v=this._draggable._newPos.x,T=(v-c+p)%s+c-p,N=(v+c+p)%s-c-p,X=Math.abs(T+p)<Math.abs(N+p)?T:N;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=X},_onDragEnd:function(s){var c=this._map,p=c.options,v=!p.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),v)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),N=(this._lastTime-this._times[0])/1e3,X=p.easeLinearity,te=T.multiplyBy(X/N),ue=te.distanceTo([0,0]),we=Math.min(p.inertiaMaxSpeed,ue),Me=te.multiplyBy(we/ue),$e=we/(p.inertiaDeceleration*X),dt=Me.multiplyBy(-$e/2).round();!dt.x&&!dt.y?c.fire("moveend"):(dt=c._limitOffset(dt,c.options.maxBounds),H(function(){c.panBy(dt,{duration:$e,easeLinearity:X,noMoveStart:!0,animate:!0})}))}}});_t.addInitHook("addHandler","dragging",og),_t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var lg=la.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),rt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Lt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,p=s.scrollTop||c.scrollTop,v=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(v,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},p=this.keyCodes,v,T;for(v=0,T=p.left.length;v<T;v++)c[p.left[v]]=[-1*s,0];for(v=0,T=p.right.length;v<T;v++)c[p.right[v]]=[s,0];for(v=0,T=p.down.length;v<T;v++)c[p.down[v]]=[0,s];for(v=0,T=p.up.length;v<T;v++)c[p.up[v]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},p=this.keyCodes,v,T;for(v=0,T=p.zoomIn.length;v<T;v++)c[p.zoomIn[v]]=s;for(v=0,T=p.zoomOut.length;v<T;v++)c[p.zoomOut[v]]=-s},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Lt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,p=this._map,v;if(c in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(v=this._panKeys[c],s.shiftKey&&(v=ie(v).multiplyBy(3)),p.options.maxBounds&&(v=p._limitOffset(ie(v),p.options.maxBounds)),p.options.worldCopyJump){var T=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(v)));p.panTo(T)}else p.panBy(v)}else if(c in this._zoomKeys)p.setZoom(p.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Bi(s)}}});_t.addInitHook("addHandler","keyboard",lg),_t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var cg=la.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Lt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=Om(s),p=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var v=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),v),Bi(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),p=this._map.options.zoomSnap||0;s._stop();var v=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(v))))/Math.LN2,N=p?Math.ceil(T/p)*p:T,X=s._limitZoom(c+(this._delta>0?N:-N))-c;this._delta=0,this._startTime=null,X&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+X):s.setZoomAround(this._lastMousePos,c+X))}});_t.addInitHook("addHandler","scrollWheelZoom",cg);var hE=600;_t.mergeOptions({tapHold:De.touchNative&&De.safari&&De.mobile,tapTolerance:15});var ug=la.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Lt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new re(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",_r),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),hE),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Lt(document,"touchend",_r),Lt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Lt(document,"touchend touchcancel contextmenu",this._cancel,this),Lt(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new re(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var p=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});p._simulated=!0,c.target.dispatchEvent(p)}});_t.addInitHook("addHandler","tapHold",ug),_t.mergeOptions({touchZoom:De.touch,bounceAtZoomLimits:!0});var fg=la.extend({addHooks:function(){ut(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Kt(this._map._container,"leaflet-touch-zoom"),Lt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var p=c.mouseEventToContainerPoint(s.touches[0]),v=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(p.add(v)._divideBy(2))),this._startDist=p.distanceTo(v),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),_r(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,p=c.mouseEventToContainerPoint(s.touches[0]),v=c.mouseEventToContainerPoint(s.touches[1]),T=p.distanceTo(v)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var N=p._add(v)._divideBy(2)._subtract(this._centerPoint);if(T===1&&N.x===0&&N.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(N),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),W(this._animRequest);var X=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=H(X,this,!0),_r(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,W(this._animRequest),Lt(document,"touchmove",this._onTouchMove,this),Lt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});_t.addInitHook("addHandler","touchZoom",fg),_t.BoxZoom=ig,_t.DoubleClickZoom=sg,_t.Drag=og,_t.Keyboard=lg,_t.ScrollWheelZoom=cg,_t.TapHold=ug,_t.TouchZoom=fg,r.Bounds=he,r.Browser=De,r.CRS=ye,r.Canvas=tg,r.Circle=E0,r.CircleMarker=Ac,r.Class=Se,r.Control=zn,r.DivIcon=Jm,r.DivOverlay=ca,r.DomEvent=Fk,r.DomUtil=Ak,r.Draggable=Ja,r.Evented=xe,r.FeatureGroup=Ta,r.GeoJSON=ba,r.GridLayer=Uo,r.Handler=la,r.Icon=bs,r.ImageOverlay=Rc,r.LatLng=Z,r.LatLngBounds=J,r.Layer=Un,r.LayerGroup=Cs,r.LineUtil=$k,r.Map=_t,r.Marker=Nc,r.Mixin=jk,r.Path=Qa,r.Point=re,r.PolyUtil=Bk,r.Polygon=Ns,r.Polyline=Ca,r.Popup=Mc,r.PosAnimation=Rm,r.Projection=Wk,r.Rectangle=ag,r.Renderer=Na,r.SVG=Vo,r.SVGOverlay=Ym,r.TileLayer=Ls,r.Tooltip=Ic,r.Transformation=Be,r.Util=fe,r.VideoOverlay=Km,r.bind=o,r.bounds=R,r.canvas=rg,r.circle=Qk,r.circleMarker=Jk,r.control=jo,r.divIcon=lE,r.extend=a,r.featureGroup=qk,r.geoJSON=qm,r.geoJson=rE,r.gridLayer=cE,r.icon=Kk,r.imageOverlay=nE,r.latLng=ae,r.latLngBounds=q,r.layerGroup=Xk,r.map=Pk,r.marker=Yk,r.point=ie,r.polygon=tE,r.polyline=eE,r.popup=sE,r.rectangle=dE,r.setOptions=y,r.stamp=u,r.svg=ng,r.svgOverlay=iE,r.tileLayer=Qm,r.tooltip=oE,r.transformation=V,r.version=n,r.videoOverlay=aE;var pE=window.L;r.noConflict=function(){return window.L=pE,this},window.L=r})})(Oh,Oh.exports);var ka=Oh.exports;const Fn=dv(ka);function nk(e){return e.split(" ").filter(Boolean)}function ak(e,t){nk(t).forEach(r=>{ka.DomUtil.addClass(e,r)})}function ik(e,t){nk(t).forEach(r=>{ka.DomUtil.removeClass(e,r)})}function WO(e,t,r){e!=null&&r!==t&&(t!=null&&t.length>0&&ik(e,t),r!=null&&r.length>0&&ak(e,r))}function Po(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Oo(e,t){return t==null?function(n,a){const i=C.useRef();return i.current||(i.current=e(n,a)),i}:function(n,a){const i=C.useRef();i.current||(i.current=e(n,a));const o=C.useRef(n),{instance:l}=i.current;return C.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,a]),i}}function Tm(e,t){C.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var i;(i=t.layerContainer)==null||i.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Cm(e){return function(r){const n=Fo(),a=e(_c(r,n),n);return _m(n.map,r.attribution),t0(a.current,r.eventHandlers),Tm(a.current,n),a}}function sk(e,t){const r=C.useRef();C.useEffect(function(){if(t.pathOptions!==r.current){const a=t.pathOptions??{};e.instance.setStyle(a),r.current=a}},[e,t])}function ok(e){return function(r){const n=Fo(),a=e(_c(r,n),n);return t0(a.current,r.eventHandlers),Tm(a.current,n),sk(a.current,r),a}}function ZO(e){function t(a,i){return Po(e(a),i)}const r=Oo(t),n=tk(r);return Sm(n)}function lk(e,t){const r=Oo(e,t),n=Cm(r);return Em(n)}function ck(e,t){const r=Oo(e),n=rk(r,t);return ek(n)}function uk(e,t){const r=Oo(e,t),n=ok(r);return Em(n)}function fk(e,t){const r=Oo(e,t),n=Cm(r);return Sm(n)}function dk(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function GO(e,t,r){t.bounds instanceof ka.LatLngBounds&&t.bounds!==r.bounds&&e.setBounds(t.bounds),t.opacity!=null&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),t.zIndex!=null&&t.zIndex!==r.zIndex&&e.setZIndex(t.zIndex)}const XO=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_VERSION:Jw,LeafletContext:wm,LeafletProvider:km,addClassName:ak,createContainerComponent:Em,createControlComponent:ZO,createControlHook:tk,createDivOverlayComponent:ek,createDivOverlayHook:rk,createElementHook:Oo,createElementObject:Po,createLayerComponent:lk,createLayerHook:Cm,createLeafComponent:Sm,createLeafletContext:Qw,createOverlayComponent:ck,createPathComponent:uk,createPathHook:ok,createTileLayerComponent:fk,extendContext:ym,removeClassName:ik,updateCircle:$O,updateClassName:WO,updateGridLayer:dk,updateMediaOverlay:GO,useAttribution:_m,useEventHandlers:t0,useLayerLifecycle:Tm,useLeafletContext:Fo,usePathOptions:sk,withPane:_c},Symbol.toStringTag,{value:"Module"}));function qO(){return Fo().map}function KO(e){const t=qO();return C.useEffect(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}const YO=uk(function({data:t,...r},n){const a=new ka.GeoJSON(t,r);return Po(a,ym(n,{overlayContainer:a}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function Rh(){return Rh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rh.apply(this,arguments)}function JO({bounds:e,boundsOptions:t,center:r,children:n,className:a,id:i,placeholder:o,style:l,whenReady:u,zoom:f,...h},m){const[g]=C.useState({className:a,id:i,style:l}),[x,_]=C.useState(null);C.useImperativeHandle(m,()=>(x==null?void 0:x.map)??null,[x]);const y=C.useCallback(k=>{if(k!==null&&x===null){const E=new ka.Map(k,h);r!=null&&f!=null?E.setView(r,f):e!=null&&E.fitBounds(e,t),u!=null&&E.whenReady(u),_(Qw(E))}},[]);C.useEffect(()=>()=>{x==null||x.map.remove()},[x]);const S=x?Pn.createElement(km,{value:x},n):o??null;return Pn.createElement("div",Rh({},g,{ref:y}),S)}const QO=C.forwardRef(JO),Q1=lk(function({position:t,...r},n){const a=new ka.Marker(t,r);return Po(a,ym(n,{overlayContainer:a}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),ev=ck(function(t,r){const n=new ka.Popup(t,r.overlayContainer);return Po(n,r)},function(t,r,{position:n},a){C.useEffect(function(){const{instance:o}=t;function l(f){f.popup===o&&(o.update(),a(!0))}function u(f){f.popup===o&&a(!1)}return r.map.on({popupopen:l,popupclose:u}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var h;r.map.off({popupopen:l,popupclose:u}),(h=r.overlayContainer)==null||h.unbindPopup(),r.map.removeLayer(o)}},[t,r,a,n])}),eR=fk(function({url:t,...r},n){const a=new ka.TileLayer(t,_c(r,n));return Po(a,n)},function(t,r,n){dk(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)}),hk=C.createContext({token:null,setToken:()=>{},isAuthenticated:!1,user:null,setUser:()=>{}}),pk=()=>C.useContext(hk),tR=({children:e})=>{const[t,r]=C.useState(localStorage.getItem("token")),[n,a]=C.useState(null),i=!!t;return d.jsx(hk.Provider,{value:{token:t,setToken:r,isAuthenticated:i,user:n,setUser:a},children:e})};var mk={};const rR=Cf(XO);var tv={exports:{}};(function(e,t){(function(r,n){n(t)})(Ti,function(r){var n=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(i){L.Util.setOptions(this,i),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var o=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,o?this._withAnimation:this._noAnimation),this._markerCluster=o?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(i){if(i instanceof L.LayerGroup)return this.addLayers([i]);if(!i.getLatLng)return this._nonPointGroup.addLayer(i),this.fire("layeradd",{layer:i}),this;if(!this._map)return this._needsClustering.push(i),this.fire("layeradd",{layer:i}),this;if(this.hasLayer(i))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(i,this._maxZoom),this.fire("layeradd",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var o=i,l=this._zoom;if(i.__parent)for(;o.__parent._zoom>=l;)o=o.__parent;return this._currentShownBounds.contains(o.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(i,o):this._animationAddLayerNonAnimated(i,o)),this},removeLayer:function(i){return i instanceof L.LayerGroup?this.removeLayers([i]):i.getLatLng?this._map?i.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(i)),this._removeLayer(i,!0),this.fire("layerremove",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),i.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(i)&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,i)&&this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}),this):(this._nonPointGroup.removeLayer(i),this.fire("layerremove",{layer:i}),this)},addLayers:function(i,o){if(!L.Util.isArray(i))return this.addLayer(i);var l=this._featureGroup,u=this._nonPointGroup,f=this.options.chunkedLoading,h=this.options.chunkInterval,m=this.options.chunkProgress,g=i.length,x=0,_=!0,y;if(this._map){var S=new Date().getTime(),k=L.bind(function(){var w=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();x<g;x++){if(f&&x%200===0){var F=new Date().getTime()-w;if(F>h)break}if(y=i[x],y instanceof L.LayerGroup){_&&(i=i.slice(),_=!1),this._extractNonGroupLayers(y,i),g=i.length;continue}if(!y.getLatLng){u.addLayer(y),o||this.fire("layeradd",{layer:y});continue}if(!this.hasLayer(y)&&(this._addLayer(y,this._maxZoom),o||this.fire("layeradd",{layer:y}),y.__parent&&y.__parent.getChildCount()===2)){var j=y.__parent.getAllChildMarkers(),D=j[0]===y?j[1]:j[0];l.removeLayer(D)}}m&&m(x,g,new Date().getTime()-S),x===g?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(k,this.options.chunkDelay)},this);k()}else for(var E=this._needsClustering;x<g;x++){if(y=i[x],y instanceof L.LayerGroup){_&&(i=i.slice(),_=!1),this._extractNonGroupLayers(y,i),g=i.length;continue}if(!y.getLatLng){u.addLayer(y);continue}this.hasLayer(y)||E.push(y)}return this},removeLayers:function(i){var o,l,u=i.length,f=this._featureGroup,h=this._nonPointGroup,m=!0;if(!this._map){for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}this._arraySplice(this._needsClustering,l),h.removeLayer(l),this.hasLayer(l)&&this._needsRemoving.push({layer:l,latlng:l._latlng}),this.fire("layerremove",{layer:l})}return this}if(this._unspiderfy){this._unspiderfy();var g=i.slice(),x=u;for(o=0;o<x;o++){if(l=g[o],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,g),x=g.length;continue}this._unspiderfyLayer(l)}}for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}if(!l.__parent){h.removeLayer(l),this.fire("layerremove",{layer:l});continue}this._removeLayer(l,!0,!0),this.fire("layerremove",{layer:l}),f.hasLayer(l)&&(f.removeLayer(l),l.clusterShow&&l.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(i){i.off(this._childMarkerEventHandlers,this),delete i.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var i=new L.LatLngBounds;this._topClusterLevel&&i.extend(this._topClusterLevel._bounds);for(var o=this._needsClustering.length-1;o>=0;o--)i.extend(this._needsClustering[o].getLatLng());return i.extend(this._nonPointGroup.getBounds()),i},eachLayer:function(i,o){var l=this._needsClustering.slice(),u=this._needsRemoving,f,h,m;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(l),h=l.length-1;h>=0;h--){for(f=!0,m=u.length-1;m>=0;m--)if(u[m].layer===l[h]){f=!1;break}f&&i.call(o,l[h])}this._nonPointGroup.eachLayer(i,o)},getLayers:function(){var i=[];return this.eachLayer(function(o){i.push(o)}),i},getLayer:function(i){var o=null;return i=parseInt(i,10),this.eachLayer(function(l){L.stamp(l)===i&&(o=l)}),o},hasLayer:function(i){if(!i)return!1;var o,l=this._needsClustering;for(o=l.length-1;o>=0;o--)if(l[o]===i)return!0;for(l=this._needsRemoving,o=l.length-1;o>=0;o--)if(l[o].layer===i)return!1;return!!(i.__parent&&i.__parent._group===this)||this._nonPointGroup.hasLayer(i)},zoomToShowLayer:function(i,o){var l=this._map;typeof o!="function"&&(o=function(){});var u=function(){(l.hasLayer(i)||l.hasLayer(i.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),l.hasLayer(i)?o():i.__parent._icon&&(this.once("spiderfied",o,this),i.__parent.spiderfy()))};i._icon&&this._map.getBounds().contains(i.getLatLng())?o():i.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(i.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),i.__parent.zoomToBounds())},onAdd:function(i){this._map=i;var o,l,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(i),this._nonPointGroup.addTo(i),this._gridClusters||this._generateInitialClusters(),this._maxLat=i.options.crs.projection.MAX_LATITUDE,o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),l=this._needsClustering,this._needsClustering=[],this.addLayers(l,!0)},onRemove:function(i){i.off("zoomend",this._zoomEnd,this),i.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(i){for(var o=i;o&&!o._icon;)o=o.__parent;return o||null},_arraySplice:function(i,o){for(var l=i.length-1;l>=0;l--)if(i[l]===o)return i.splice(l,1),!0},_removeFromGridUnclustered:function(i,o){for(var l=this._map,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());o>=f&&u[o].removeObject(i,l.project(i.getLatLng(),o));o--);},_childMarkerDragStart:function(i){i.target.__dragStart=i.target._latlng},_childMarkerMoved:function(i){if(!this._ignoreMove&&!i.target.__dragStart){var o=i.target._popup&&i.target._popup.isOpen();this._moveChild(i.target,i.oldLatLng,i.latlng),o&&i.target.openPopup()}},_moveChild:function(i,o,l){i._latlng=o,this.removeLayer(i),i._latlng=l,this.addLayer(i)},_childMarkerDragEnd:function(i){var o=i.target.__dragStart;delete i.target.__dragStart,o&&this._moveChild(i.target,o,i.target._latlng)},_removeLayer:function(i,o,l){var u=this._gridClusters,f=this._gridUnclustered,h=this._featureGroup,m=this._map,g=Math.floor(this._map.getMinZoom());o&&this._removeFromGridUnclustered(i,this._maxZoom);var x=i.__parent,_=x._markers,y;for(this._arraySplice(_,i);x&&(x._childCount--,x._boundsNeedUpdate=!0,!(x._zoom<g));)o&&x._childCount<=1?(y=x._markers[0]===i?x._markers[1]:x._markers[0],u[x._zoom].removeObject(x,m.project(x._cLatLng,x._zoom)),f[x._zoom].addObject(y,m.project(y.getLatLng(),x._zoom)),this._arraySplice(x.__parent._childClusters,x),x.__parent._markers.push(y),y.__parent=x.__parent,x._icon&&(h.removeLayer(x),l||h.addLayer(y))):x._iconNeedsUpdate=!0,x=x.__parent;delete i.__parent},_isOrIsParent:function(i,o){for(;o;){if(i===o)return!0;o=o.parentNode}return!1},fire:function(i,o,l){if(o&&o.layer instanceof L.MarkerCluster){if(o.originalEvent&&this._isOrIsParent(o.layer._icon,o.originalEvent.relatedTarget))return;i="cluster"+i}L.FeatureGroup.prototype.fire.call(this,i,o,l)},listens:function(i,o){return L.FeatureGroup.prototype.listens.call(this,i,o)||L.FeatureGroup.prototype.listens.call(this,"cluster"+i,o)},_defaultIconCreateFunction:function(i){var o=i.getChildCount(),l=" marker-cluster-";return o<10?l+="small":o<100?l+="medium":l+="large",new L.DivIcon({html:"<div><span>"+o+"</span></div>",className:"marker-cluster"+l,iconSize:new L.Point(40,40)})},_bindEvents:function(){var i=this._map,o=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(o||u||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),i.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(i){var o=i.layer,l=o;if(!(i.type==="clusterkeypress"&&i.originalEvent&&i.originalEvent.keyCode!==13)){for(;l._childClusters.length===1;)l=l._childClusters[0];l._zoom===this._maxZoom&&l._childCount===o._childCount&&this.options.spiderfyOnMaxZoom?o.spiderfy():this.options.zoomToBoundsOnClick&&o.zoomToBounds(),this.options.spiderfyOnEveryZoom&&o.spiderfy(),i.originalEvent&&i.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(i){var o=this._map;this._inZoomAnimation||(this._shownPolygon&&o.removeLayer(this._shownPolygon),i.layer.getChildCount()>2&&i.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(i.layer.getConvexHull(),this.options.polygonOptions),o.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var i=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,f=this._map;(i||l||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var i=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,i),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),i),this._currentShownBounds=i}},_generateInitialClusters:function(){var i=Math.ceil(this._map.getMaxZoom()),o=Math.floor(this._map.getMinZoom()),l=this.options.maxClusterRadius,u=l;typeof l!="function"&&(u=function(){return l}),this.options.disableClusteringAtZoom!==null&&(i=this.options.disableClusteringAtZoom-1),this._maxZoom=i,this._gridClusters={},this._gridUnclustered={};for(var f=i;f>=o;f--)this._gridClusters[f]=new L.DistanceGrid(u(f)),this._gridUnclustered[f]=new L.DistanceGrid(u(f));this._topClusterLevel=new this._markerCluster(this,o-1)},_addLayer:function(i,o){var l=this._gridClusters,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),h,m;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(i),i.on(this._childMarkerEventHandlers,this);o>=f;o--){h=this._map.project(i.getLatLng(),o);var g=l[o].getNearObject(h);if(g){g._addChild(i),i.__parent=g;return}if(g=u[o].getNearObject(h),g){var x=g.__parent;x&&this._removeLayer(g,!1);var _=new this._markerCluster(this,o,g,i);l[o].addObject(_,this._map.project(_._cLatLng,o)),g.__parent=_,i.__parent=_;var y=_;for(m=o-1;m>x._zoom;m--)y=new this._markerCluster(this,m,y),l[m].addObject(y,this._map.project(g.getLatLng(),m));x._addChild(y),this._removeFromGridUnclustered(g,o);return}u[o].addObject(i,h)}this._topClusterLevel._addChild(i),i.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(i){i instanceof L.MarkerCluster&&i._iconNeedsUpdate&&i._updateIcon()})},_enqueue:function(i){this._queue.push(i),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var i=0;i<this._queue.length;i++)this._queue[i].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var i=Math.round(this._map._zoom);this._processQueue(),this._zoom<i&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,i)):this._zoom>i?(this._animationStart(),this._animationZoomOut(this._zoom,i)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(i){var o=this._maxLat;return o!==void 0&&(i.getNorth()>=o&&(i._northEast.lat=1/0),i.getSouth()<=-o&&(i._southWest.lat=-1/0)),i},_animationAddLayerNonAnimated:function(i,o){if(o===i)this._featureGroup.addLayer(i);else if(o._childCount===2){o._addToMap();var l=o.getAllChildMarkers();this._featureGroup.removeLayer(l[0]),this._featureGroup.removeLayer(l[1])}else o._updateIcon()},_extractNonGroupLayers:function(i,o){var l=i.getLayers(),u=0,f;for(o=o||[];u<l.length;u++){if(f=l[u],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,o);continue}o.push(f)}return o},_overrideMarkerIcon:function(i){var o=i.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[i]}});return o}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(i,o){this._animationAddLayerNonAnimated(i,o)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(i,o){var l=this._getExpandedVisibleBounds(),u=this._featureGroup,f=Math.floor(this._map.getMinZoom()),h;this._ignoreMove=!0,this._topClusterLevel._recursively(l,i,f,function(m){var g=m._latlng,x=m._markers,_;for(l.contains(g)||(g=null),m._isSingleParent()&&i+1===o?(u.removeLayer(m),m._recursivelyAddChildrenToMap(null,o,l)):(m.clusterHide(),m._recursivelyAddChildrenToMap(g,o,l)),h=x.length-1;h>=0;h--)_=x[h],l.contains(_._latlng)||u.removeLayer(_)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(l,o),u.eachLayer(function(m){!(m instanceof L.MarkerCluster)&&m._icon&&m.clusterShow()}),this._topClusterLevel._recursively(l,i,o,function(m){m._recursivelyRestoreChildPositions(o)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(l,i,f,function(m){u.removeLayer(m),m.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(i,o){this._animationZoomOutSingle(this._topClusterLevel,i-1,o),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i,this._getExpandedVisibleBounds())},_animationAddLayer:function(i,o){var l=this,u=this._featureGroup;u.addLayer(i),o!==i&&(o._childCount>2?(o._updateIcon(),this._forceLayout(),this._animationStart(),i._setPos(this._map.latLngToLayerPoint(o.getLatLng())),i.clusterHide(),this._enqueue(function(){u.removeLayer(i),i.clusterShow(),l._animationEnd()})):(this._forceLayout(),l._animationStart(),l._animationZoomOutSingle(o,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(i,o,l){var u=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());i._recursivelyAnimateChildrenInAndAddSelfToMap(u,f,o+1,l);var h=this;this._forceLayout(),i._recursivelyBecomeVisible(u,l),this._enqueue(function(){if(i._childCount===1){var m=i._markers[0];this._ignoreMove=!0,m.setLatLng(m.getLatLng()),this._ignoreMove=!1,m.clusterShow&&m.clusterShow()}else i._recursively(u,l,f,function(g){g._recursivelyRemoveChildrenFromMap(u,f,o+1)});h._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(i){return new L.MarkerClusterGroup(i)};var a=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(i,o,l,u){L.Marker.prototype.initialize.call(this,l?l._cLatLng||l.getLatLng():new L.LatLng(0,0),{icon:this,pane:i.options.clusterPane}),this._group=i,this._zoom=o,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,l&&this._addChild(l),u&&this._addChild(u)},getAllChildMarkers:function(i,o){i=i||[];for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l].getAllChildMarkers(i,o);for(var u=this._markers.length-1;u>=0;u--)o&&this._markers[u].__dragStart||i.push(this._markers[u]);return i},getChildCount:function(){return this._childCount},zoomToBounds:function(i){for(var o=this._childClusters.slice(),l=this._group._map,u=l.getBoundsZoom(this._bounds),f=this._zoom+1,h=l.getZoom(),m;o.length>0&&u>f;){f++;var g=[];for(m=0;m<o.length;m++)g=g.concat(o[m]._childClusters);o=g}u>f?this._group._map.setView(this._latlng,f):u<=h?this._group._map.setView(this._latlng,h+1):this._group._map.fitBounds(this._bounds,i)},getBounds:function(){var i=new L.LatLngBounds;return i.extend(this._bounds),i},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(i,o){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(i),i instanceof L.MarkerCluster?(o||(this._childClusters.push(i),i.__parent=this),this._childCount+=i._childCount):(o||this._markers.push(i),this._childCount++),this.__parent&&this.__parent._addChild(i,!0)},_setClusterCenter:function(i){this._cLatLng||(this._cLatLng=i._cLatLng||i._latlng)},_resetBounds:function(){var i=this._bounds;i._southWest&&(i._southWest.lat=1/0,i._southWest.lng=1/0),i._northEast&&(i._northEast.lat=-1/0,i._northEast.lng=-1/0)},_recalculateBounds:function(){var i=this._markers,o=this._childClusters,l=0,u=0,f=this._childCount,h,m,g,x;if(f!==0){for(this._resetBounds(),h=0;h<i.length;h++)g=i[h]._latlng,this._bounds.extend(g),l+=g.lat,u+=g.lng;for(h=0;h<o.length;h++)m=o[h],m._boundsNeedUpdate&&m._recalculateBounds(),this._bounds.extend(m._bounds),g=m._wLatLng,x=m._childCount,l+=g.lat*x,u+=g.lng*x;this._latlng=this._wLatLng=new L.LatLng(l/f,u/f),this._boundsNeedUpdate=!1}},_addToMap:function(i){i&&(this._backupLatlng=this._latlng,this.setLatLng(i)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(i,o,l){this._recursively(i,this._group._map.getMinZoom(),l-1,function(u){var f=u._markers,h,m;for(h=f.length-1;h>=0;h--)m=f[h],m._icon&&(m._setPos(o),m.clusterHide())},function(u){var f=u._childClusters,h,m;for(h=f.length-1;h>=0;h--)m=f[h],m._icon&&(m._setPos(o),m.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(i,o,l,u){this._recursively(i,u,o,function(f){f._recursivelyAnimateChildrenIn(i,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),l),f._isSingleParent()&&l-1===u?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(i,o,l)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(i,o){this._recursively(i,this._group._map.getMinZoom(),o,null,function(l){l.clusterShow()})},_recursivelyAddChildrenToMap:function(i,o,l){this._recursively(l,this._group._map.getMinZoom()-1,o,function(u){if(o!==u._zoom)for(var f=u._markers.length-1;f>=0;f--){var h=u._markers[f];l.contains(h._latlng)&&(i&&(h._backupLatlng=h.getLatLng(),h.setLatLng(i),h.clusterHide&&h.clusterHide()),u._group._featureGroup.addLayer(h))}},function(u){u._addToMap(i)})},_recursivelyRestoreChildPositions:function(i){for(var o=this._markers.length-1;o>=0;o--){var l=this._markers[o];l._backupLatlng&&(l.setLatLng(l._backupLatlng),delete l._backupLatlng)}if(i-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(i)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(i,o,l,u){var f,h;this._recursively(i,o-1,l-1,function(m){for(h=m._markers.length-1;h>=0;h--)f=m._markers[h],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(m){for(h=m._childClusters.length-1;h>=0;h--)f=m._childClusters[h],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(i,o,l,u,f){var h=this._childClusters,m=this._zoom,g,x;if(o<=m&&(u&&u(this),f&&m===l&&f(this)),m<o||m<l)for(g=h.length-1;g>=0;g--)x=h[g],x._boundsNeedUpdate&&x._recalculateBounds(),i.intersects(x._bounds)&&x._recursively(i,o,l,u,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var i=this.options.opacity;return this.setOpacity(0),this.options.opacity=i,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(i){this._cellSize=i,this._sqCellSize=i*i,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,h=f[u]=f[u]||{},m=h[l]=h[l]||[],g=L.Util.stamp(i);this._objectPoint[g]=o,m.push(i)},updateObject:function(i,o){this.removeObject(i),this.addObject(i,o)},removeObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,h=f[u]=f[u]||{},m=h[l]=h[l]||[],g,x;for(delete this._objectPoint[L.Util.stamp(i)],g=0,x=m.length;g<x;g++)if(m[g]===i)return m.splice(g,1),x===1&&delete h[l],!0},eachObject:function(i,o){var l,u,f,h,m,g,x,_=this._grid;for(l in _){m=_[l];for(u in m)for(g=m[u],f=0,h=g.length;f<h;f++)x=i.call(o,g[f]),x&&(f--,h--)}},getNearObject:function(i){var o=this._getCoord(i.x),l=this._getCoord(i.y),u,f,h,m,g,x,_,y,S=this._objectPoint,k=this._sqCellSize,E=null;for(u=l-1;u<=l+1;u++)if(m=this._grid[u],m){for(f=o-1;f<=o+1;f++)if(g=m[f],g)for(h=0,x=g.length;h<x;h++)_=g[h],y=this._sqDist(S[L.Util.stamp(_)],i),(y<k||y<=k&&E===null)&&(k=y,E=_)}return E},_getCoord:function(i){var o=Math.floor(i/this._cellSize);return isFinite(o)?o:i},_sqDist:function(i,o){var l=o.x-i.x,u=o.y-i.y;return l*l+u*u}},function(){L.QuickHull={getDistant:function(i,o){var l=o[1].lat-o[0].lat,u=o[0].lng-o[1].lng;return u*(i.lat-o[0].lat)+l*(i.lng-o[0].lng)},findMostDistantPointFromBaseLine:function(i,o){var l=0,u=null,f=[],h,m,g;for(h=o.length-1;h>=0;h--){if(m=o[h],g=this.getDistant(m,i),g>0)f.push(m);else continue;g>l&&(l=g,u=m)}return{maxPoint:u,newPoints:f}},buildConvexHull:function(i,o){var l=[],u=this.findMostDistantPointFromBaseLine(i,o);return u.maxPoint?(l=l.concat(this.buildConvexHull([i[0],u.maxPoint],u.newPoints)),l=l.concat(this.buildConvexHull([u.maxPoint,i[1]],u.newPoints)),l):[i[0]]},getConvexHull:function(i){var o=!1,l=!1,u=!1,f=!1,h=null,m=null,g=null,x=null,_=null,y=null,S;for(S=i.length-1;S>=0;S--){var k=i[S];(o===!1||k.lat>o)&&(h=k,o=k.lat),(l===!1||k.lat<l)&&(m=k,l=k.lat),(u===!1||k.lng>u)&&(g=k,u=k.lng),(f===!1||k.lng<f)&&(x=k,f=k.lng)}l!==o?(y=m,_=h):(y=x,_=g);var E=[].concat(this.buildConvexHull([y,_],i),this.buildConvexHull([_,y],i));return E}}}(),L.MarkerCluster.include({getConvexHull:function(){var i=this.getAllChildMarkers(),o=[],l,u;for(u=i.length-1;u>=0;u--)l=i[u].getLatLng(),o.push(l);return L.QuickHull.getConvexHull(o)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var i=this.getAllChildMarkers(null,!0),o=this._group,l=o._map,u=l.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(i.length,u):i.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(i.length,u):(u.y+=10,f=this._generatePointsCircle(i.length,u)),this._animationSpiderfy(i,f)}},unspiderfy:function(i){this._group._inZoomAnimation||(this._animationUnspiderfy(i),this._group._spiderfied=null)},_generatePointsCircle:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+i),u=l/this._2PI,f=this._2PI/i,h=[],m,g;for(u=Math.max(u,35),h.length=i,m=0;m<i;m++)g=this._circleStartAngle+m*f,h[m]=new L.Point(o.x+u*Math.cos(g),o.y+u*Math.sin(g))._round();return h},_generatePointsSpiral:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier,u=l*this._spiralLengthStart,f=l*this._spiralFootSeparation,h=l*this._spiralLengthFactor*this._2PI,m=0,g=[],x;for(g.length=i,x=i;x>=0;x--)x<i&&(g[x]=new L.Point(o.x+u*Math.cos(m),o.y+u*Math.sin(m))._round()),m+=f/u+x*5e-4,u+=h/m;return g},_noanimationUnspiderfy:function(){var i=this._group,o=i._map,l=i._featureGroup,u=this.getAllChildMarkers(null,!0),f,h;for(i._ignoreMove=!0,this.setOpacity(1),h=u.length-1;h>=0;h--)f=u[h],l.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(o.removeLayer(f._spiderLeg),delete f._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:u}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(i,o){var l=this._group,u=l._map,f=l._featureGroup,h=this._group.options.spiderLegPolylineOptions,m,g,x,_;for(l._ignoreMove=!0,m=0;m<i.length;m++)_=u.layerPointToLatLng(o[m]),g=i[m],x=new L.Polyline([this._latlng,_],h),u.addLayer(x),g._spiderLeg=x,g._preSpiderfyLatlng=g._latlng,g.setLatLng(_),g.setZIndexOffset&&g.setZIndexOffset(1e6),f.addLayer(g);this.setOpacity(.3),l._ignoreMove=!1,l.fire("spiderfied",{cluster:this,markers:i})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(i,o){var l=this,u=this._group,f=u._map,h=u._featureGroup,m=this._latlng,g=f.latLngToLayerPoint(m),x=L.Path.SVG,_=L.extend({},this._group.options.spiderLegPolylineOptions),y=_.opacity,S,k,E,w,F,j;for(y===void 0&&(y=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),x?(_.opacity=0,_.className=(_.className||"")+" leaflet-cluster-spider-leg"):_.opacity=y,u._ignoreMove=!0,S=0;S<i.length;S++)k=i[S],j=f.layerPointToLatLng(o[S]),E=new L.Polyline([m,j],_),f.addLayer(E),k._spiderLeg=E,x&&(w=E._path,F=w.getTotalLength()+.1,w.style.strokeDasharray=F,w.style.strokeDashoffset=F),k.setZIndexOffset&&k.setZIndexOffset(1e6),k.clusterHide&&k.clusterHide(),h.addLayer(k),k._setPos&&k._setPos(g);for(u._forceLayout(),u._animationStart(),S=i.length-1;S>=0;S--)j=f.layerPointToLatLng(o[S]),k=i[S],k._preSpiderfyLatlng=k._latlng,k.setLatLng(j),k.clusterShow&&k.clusterShow(),x&&(E=k._spiderLeg,w=E._path,w.style.strokeDashoffset=0,E.setStyle({opacity:y}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:l,markers:i})},200)},_animationUnspiderfy:function(i){var o=this,l=this._group,u=l._map,f=l._featureGroup,h=i?u._latLngToNewLayerPoint(this._latlng,i.zoom,i.center):u.latLngToLayerPoint(this._latlng),m=this.getAllChildMarkers(null,!0),g=L.Path.SVG,x,_,y,S,k,E;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),_=m.length-1;_>=0;_--)x=m[_],x._preSpiderfyLatlng&&(x.closePopup(),x.setLatLng(x._preSpiderfyLatlng),delete x._preSpiderfyLatlng,E=!0,x._setPos&&(x._setPos(h),E=!1),x.clusterHide&&(x.clusterHide(),E=!1),E&&f.removeLayer(x),g&&(y=x._spiderLeg,S=y._path,k=S.getTotalLength()+.1,S.style.strokeDashoffset=k,y.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var w=0;for(_=m.length-1;_>=0;_--)x=m[_],x._spiderLeg&&w++;for(_=m.length-1;_>=0;_--)x=m[_],x._spiderLeg&&(x.clusterShow&&x.clusterShow(),x.setZIndexOffset&&x.setZIndexOffset(0),w>1&&f.removeLayer(x),u.removeLayer(x._spiderLeg),delete x._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:o,markers:m})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(i){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(i))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(i){this._spiderfied&&this._spiderfied.unspiderfy(i)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(i){i._spiderLeg&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow(),i.setZIndexOffset&&i.setZIndexOffset(0),this._map.removeLayer(i._spiderLeg),delete i._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(i){return i?i instanceof L.MarkerClusterGroup?i=i._topClusterLevel.getAllChildMarkers():i instanceof L.LayerGroup?i=i._layers:i instanceof L.MarkerCluster?i=i.getAllChildMarkers():i instanceof L.Marker&&(i=[i]):i=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(i),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(i),this},_flagParentsIconsNeedUpdate:function(i){var o,l;for(o in i)for(l=i[o].__parent;l;)l._iconNeedsUpdate=!0,l=l.__parent},_refreshSingleMarkerModeMarkers:function(i){var o,l;for(o in i)l=i[o],this.hasLayer(l)&&l.setIcon(this._overrideMarkerIcon(l))}}),L.Marker.include({refreshIconOptions:function(i,o){var l=this.options.icon;return L.setOptions(l,i),this.setIcon(l),o&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),r.MarkerClusterGroup=n,r.MarkerCluster=a,Object.defineProperty(r,"__esModule",{value:!0})})})(tv,tv.exports);const nR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",aR=Object.freeze(Object.defineProperty({__proto__:null,default:nR},Symbol.toStringTag,{value:"Module"})),iR=Cf(aR),sR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",oR=Object.freeze(Object.defineProperty({__proto__:null,default:sR},Symbol.toStringTag,{value:"Module"})),lR=Cf(oR),cR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",uR=Object.freeze(Object.defineProperty({__proto__:null,default:cR},Symbol.toStringTag,{value:"Module"})),fR=Cf(uR);var Js=Ti&&Ti.__assign||function(){return Js=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Js.apply(this,arguments)},dR=Ti&&Ti.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},hR=Ti&&Ti.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mk,"__esModule",{value:!0});var Mh=rR,bm=hR(ka);delete bm.default.Icon.Default.prototype._getIconUrl;bm.default.Icon.Default.mergeOptions({iconRetinaUrl:iR.default,iconUrl:lR.default,shadowUrl:fR.default});function pR(e){var t={},r={};e.children;var n=dR(e,["children"]);return Object.entries(n).forEach(function(a){var i,o,l=a[0],u=a[1];l.startsWith("on")?r=Js(Js({},r),(i={},i[l]=u,i)):t=Js(Js({},t),(o={},o[l]=u,o))}),{clusterProps:t,clusterEvents:r}}function mR(e,t){var r=pR(e),n=r.clusterProps,a=r.clusterEvents,i=new bm.default.MarkerClusterGroup(n);return Object.entries(a).forEach(function(o){var l=o[0],u=o[1],f="cluster".concat(l.substring(2).toLowerCase());i.on(f,u)}),(0,Mh.createElementObject)(i,(0,Mh.extendContext)(t,{layerContainer:i}))}var gR=function(e,t,r){},xR=(0,Mh.createPathComponent)(mR,gR),vR=mk.default=xR;const Qr=We.create({baseURL:ta,headers:{"Content-Type":"application/json",Accept:"application/json"}});Qr.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Qr.interceptors.response.use(e=>e,e=>{if(e.response){if(e.response.status===401)localStorage.removeItem("token"),window.location.href="/login";else if(e.response.status===404)return console.error("Endpoint not found:",e.response.config.url),Promise.reject(new Error("Endpoint non trouv. Veuillez vrifier la configuration du serveur."))}return Promise.reject(e)});const _R=Fn.icon({iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),yR=Fn.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#22c55e">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),wR=Fn.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#ef4444">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),rv=Fn.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#2563eb">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),kR=Fn.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),ER=Fn.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#ef4444" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),SR=Fn.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#f97316" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),TR=Fn.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#22c55e" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),CR=`
  .custom-camera-icon {
    background: none;
    border: none;
  }
  .custom-camera-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-camera-icon:hover svg {
    transform: scale(1.1);
  }
  .custom-datacenter-icon {
    background: none;
    border: none;
  }
  .custom-datacenter-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-datacenter-icon:hover svg {
    transform: scale(1.1);
  }
  .leaflet-popup-content-wrapper {
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  .leaflet-popup-content {
    margin: 0;
    min-width: 300px;
    max-width: 500px;
  }
  .datacenter-popup-content {
    padding: 1rem;
    min-width: 300px;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    background: white;
    border-radius: 8px;
  }
`,gk=document.createElement("style");gk.innerText=CR;document.head.appendChild(gk);const nv=(e,t)=>{const r=Math.abs(e),n=Math.floor(r),a=Math.floor((r-n)*60),i=((r-n-a/60)*3600).toFixed(1),o=t?e>=0?"N":"S":e>=0?"E":"W";return`${n}${a}'${i}"${o}`},bR=({onClose:e,position:t,onSuccess:r,onError:n,onCamerasUpdate:a})=>{const[i,o]=C.useState({name:"",ip_address:"",location:`${nv(t[0],!0)} ${nv(t[1],!1)}`,latitude:t[0].toString(),longitude:t[1].toString()}),{isAuthenticated:l,token:u}=pk(),f=C.useRef(null),[h,m]=C.useState(!1),g=async _=>{var y,S,k;if(_.preventDefault(),!l||!u){n("Veuillez vous connecter pour ajouter une camra");return}m(!0);try{if((await Qr.post("/cameras/cameras/",i,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}})).status===201){r("Camra ajoute avec succs");const w=await Qr.get("/cameras/cameras/",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(w.data.results||[]),e()}}catch(E){console.error("Error adding camera:",E),We.isAxiosError(E)?((y=E.response)==null?void 0:y.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):n(((k=(S=E.response)==null?void 0:S.data)==null?void 0:k.error)||"Erreur lors de l'ajout de la camra"):n("Erreur lors de l'ajout de la camra")}finally{m(!1)}},x=async _=>{var k,E,w,F,j;if(!l||!u){n("Veuillez vous connecter pour importer des camras");return}const y=(k=_.target.files)==null?void 0:k[0];if(!y)return;if(!y.name.endsWith(".csv")){n("Le fichier doit tre au format CSV");return}m(!0);const S=new FormData;S.append("file",y);try{const D=await Qr.post("/cameras/cameras/upload_csv/",S,{headers:{Authorization:`Bearer ${u}`,Accept:"application/json","Content-Type":"multipart/form-data"}});if(D.status===200){r(`Import russi: ${D.data.created} cres, ${D.data.updated} mises  jour`);const A=await Qr.get("/cameras/cameras/",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(A.data.results||[]),e()}}catch(D){console.error("Error uploading CSV:",D),We.isAxiosError(D)?((E=D.response)==null?void 0:E.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):((w=D.response)==null?void 0:w.status)===400?n(D.response.data.error||"Format de fichier invalide ou donnes manquantes"):n(((j=(F=D.response)==null?void 0:F.data)==null?void 0:j.error)||"Erreur lors de l'importation du fichier CSV"):n("Erreur lors de l'importation du fichier CSV")}finally{m(!1),f.current&&(f.current.value="")}};return d.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white p-4 rounded-t-lg shadow-lg z-50",children:d.jsxs("div",{className:"max-w-4xl mx-auto",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-semibold",children:"Ajouter une camra"}),d.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",disabled:h,children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),d.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom"}),d.jsx("input",{type:"text",value:i.name,onChange:_=>o({...i,name:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:h})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP"}),d.jsx("input",{type:"text",value:i.ip_address,onChange:_=>o({...i,ip_address:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:h})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Emplacement"}),d.jsx("input",{type:"text",value:i.location,onChange:_=>o({...i,location:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Format: Latitude, Longitude",disabled:h})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude"}),d.jsx("input",{type:"text",value:i.latitude,onChange:_=>o({...i,latitude:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:h})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude"}),d.jsx("input",{type:"text",value:i.longitude,onChange:_=>o({...i,longitude:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:h})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("input",{type:"file",ref:f,onChange:x,accept:".csv",className:"hidden",id:"csv-upload",disabled:h}),d.jsx("label",{htmlFor:"csv-upload",className:`px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer ${h?"opacity-50 cursor-not-allowed":""}`,children:h?"Import en cours...":"Importer CSV"}),d.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:h,children:"Annuler"}),d.jsx("button",{type:"submit",className:`px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 ${h?"opacity-50 cursor-not-allowed":""}`,disabled:h,children:h?"Ajout en cours...":"Ajouter"})]})]})]})})},NR=({onMapClick:e})=>(KO({click:t=>{e(t.latlng.lat,t.latlng.lng)}}),null),AR=()=>{const[e,t]=C.useState(null),[r,n]=C.useState([]),[a,i]=C.useState([]),[o,l]=C.useState({}),[u,f]=C.useState({}),[h,m]=C.useState(!1),[g,x]=C.useState([0,0]),[_,y]=C.useState(null),[S,k]=C.useState(null),[E,w]=C.useState({}),[F,j]=C.useState({}),{isAuthenticated:D,token:A}=pk(),M=C.useRef(null),[O,G]=C.useState(!1);C.useState(null);const[H,W]=C.useState("all"),[fe,Se]=C.useState("all"),[le,Y]=C.useState(""),[xe,re]=C.useState(!1),K=C.useRef(null),[ie,he]=C.useState({}),[R,J]=C.useState([]);C.useState(null),C.useState(!1);const q=pe=>{he(Ae=>({...Ae,[pe]:!Ae[pe]}))},Z=async()=>{var pe;try{const Ae=localStorage.getItem("token");if(!Ae){y("Token non trouv. Veuillez vous reconnecter.");return}const Pe=await Qr.get("/datacenters/",{headers:{Authorization:`Bearer ${Ae}`,"Content-Type":"application/json",Accept:"application/json"}});Pe.data.results&&i(Pe.data.results)}catch(Ae){console.error("Error fetching datacenters:",Ae),We.isAxiosError(Ae)&&(((pe=Ae.response)==null?void 0:pe.status)===401?(y("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):y("Erreur lors du chargement des datacenters"))}},ae=async pe=>{try{f(Pe=>({...Pe,[pe]:!0}));const Ae=await Qr.get("/firewalls/firewall-types/",{params:{data_center:pe},headers:{"Content-Type":"application/json",Accept:"application/json"}});Ae.data.results&&l(Pe=>({...Pe,[pe]:Ae.data.results}))}catch(Ae){console.error("Error fetching firewall types:",Ae),y("Erreur lors de la rcupration des types de pare-feu")}finally{f(Ae=>({...Ae,[pe]:!1}))}},ye=pe=>{y(pe),K.current&&clearTimeout(K.current),K.current=window.setTimeout(()=>{window.location.reload()},3e3)};C.useEffect(()=>{const pe=localStorage.getItem("token");if(!pe){ye("Veuillez vous connecter pour accder  cette page");return}return Qr.get(Hx.CAMERAS.LIST,{headers:{Authorization:`Bearer ${pe}`,"Content-Type":"application/json",Accept:"application/json"}}).then(()=>{re(!0)}).catch(Ae=>{var Pe;((Pe=Ae.response)==null?void 0:Pe.status)===401?(ye("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):y("Erreur de connexion au serveur")}),()=>{K.current&&clearTimeout(K.current)}},[]),C.useEffect(()=>{xe&&(Fn.Marker.prototype.options.icon=_R,t(e))},[xe]),C.useEffect(()=>xe?((async()=>{var Ae;try{const Pe=localStorage.getItem("token");if(!Pe){y("Token non trouv. Veuillez vous reconnecter.");return}let Ue=[],et=Hx.CAMERAS.LIST;for(;et;){const pt=await Qr.get(et,{headers:{Authorization:`Bearer ${Pe}`,"Content-Type":"application/json",Accept:"application/json"}});pt.data.results&&(Ue=[...Ue,...pt.data.results]),et=pt.data.next}n(Ue),y(null)}catch(Pe){console.error("Error fetching cameras:",Pe),We.isAxiosError(Pe)&&((Ae=Pe.response)==null?void 0:Ae.status)===401?(y("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):y("Erreur lors du chargement des camras"),n([])}})(),Z(),()=>{Fn.Marker.prototype.options.icon=void 0}):void 0,[xe]),C.useEffect(()=>{(async()=>{try{const Pe=(await Qr.get("/datacenters/")).data.results||[];J(Pe)}catch{y("Erreur lors du chargement des donnes")}})()},[]);const Fe=(pe,Ae)=>{if(!D||!A){ye("Veuillez vous connecter pour ajouter une camra");return}x([pe,Ae]),m(!0)},be=async pe=>{try{w(Ue=>({...Ue,[pe]:{status:"loading",responseTime:null}}));const Pe=await(await fetch(`${ta}/cameras/cameras/${pe}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();w(Ue=>({...Ue,[pe]:{status:Pe.status,responseTime:Pe.response_time,lastUpdate:Date.now()}}))}catch(Ae){console.error("Error pinging camera:",Ae),w(Pe=>({...Pe,[pe]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},_e=async pe=>{try{j(Ue=>({...Ue,[pe]:{status:"loading",responseTime:null}}));const Pe=await(await fetch(`${ta}/firewalls/${pe}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();j(Ue=>({...Ue,[pe]:{status:Pe.status,responseTime:Pe.response_time,lastUpdate:Date.now()}}))}catch(Ae){console.error("Error pinging firewall:",Ae),j(Pe=>({...Pe,[pe]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},Be=async()=>{if(!D){y("Veuillez vous connecter pour effectuer un ping");return}G(!0);try{const pe=await Qr.post("/cameras/cameras/ping_all/"),Ae={};pe.data.results.forEach(Ze=>{Ae[Ze.id]={status:Ze.status,responseTime:Ze.response_time}}),w(Ae);const Pe=await Qr.post("/firewalls/ping-all/"),Ue={};Pe.data.results.forEach(Ze=>{Ue[Ze.id]={status:Ze.status,responseTime:Ze.response_time}}),j(Ue);const et=Object.values(Ae).filter(Ze=>Ze.status==="online").length+Object.values(Ue).filter(Ze=>Ze.status==="online").length,pt=Object.values(Ae).filter(Ze=>Ze.status==="offline"||Ze.status==="error").length+Object.values(Ue).filter(Ze=>Ze.status==="offline"||Ze.status==="error").length;k(`Ping termin: ${et} en ligne, ${pt} hors ligne`)}catch(pe){console.error("Error pinging all elements:",pe),y("Erreur lors du ping des lments")}finally{G(!1)}},V=pe=>{try{return decodeURIComponent(escape(pe))}catch(Ae){return console.warn("Error fixing encoding:",Ae),pe}},qe=pe=>{if(!pe)return!0;const Ae=5*60*1e3;return Date.now()-pe>Ae},it=pe=>{const Ae=E[pe];if(!Ae||qe(Ae.lastUpdate))return rv;switch(Ae.status){case"online":return yR;case"offline":return wR;default:return rv}},ot=()=>{const pe=le.toLowerCase(),Ae=r.filter(Ue=>{var Ze;if(!(H!=="datacenters"&&(Ue.name.toLowerCase().includes(pe)||Ue.ip_address.toLowerCase().includes(pe)||Ue.location.toLowerCase().includes(pe))))return!1;if(fe==="all")return!0;const pt=(Ze=E[Ue.id])==null?void 0:Ze.status;return fe==="online"?pt==="online":fe==="offline"?pt==="offline"||pt==="error":!0}),Pe=a.filter(Ue=>H!=="cameras"&&(Ue.name.toLowerCase().includes(pe)||Ue.location.toLowerCase().includes(pe))?fe==="all"?!0:fe==="online"?Ue.is_active:fe==="offline"?!Ue.is_active:!0:!1);return{cameras:Ae,datacenters:Pe}},{cameras:Xe,datacenters:Ne}=ot(),St=pe=>{var et;let Ae=0,Pe=0,Ue=!1;return(et=o[pe])==null||et.forEach(pt=>{var Ze;(Ze=pt.firewalls)==null||Ze.forEach(Qt=>{const Tt=F[Qt.id];Tt&&!qe(Tt.lastUpdate)?(Ae++,Tt.status==="online"&&Pe++):Ue=!0})}),Ae===0||Ue?kR:Pe===Ae?TR:Pe===0?ER:SR},Wt=async pe=>{var Ae,Pe,Ue;if(!D||!A){y("Veuillez vous connecter pour supprimer une camra");return}try{(await Qr.delete(`/cameras/cameras/${pe}/`,{headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json",Accept:"application/json"}})).status===204&&(k("Camra supprime avec succs"),n(pt=>pt.filter(Ze=>Ze.id!==pe)))}catch(et){console.error("Error deleting camera:",et),We.isAxiosError(et)?((Ae=et.response)==null?void 0:Ae.status)===401?(y("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):y(((Ue=(Pe=et.response)==null?void 0:Pe.data)==null?void 0:Ue.error)||"Erreur lors de la suppression de la camra"):y("Erreur lors de la suppression de la camra")}};return d.jsxs("div",{className:"w-[1270px] h-[550px] rounded-lg overflow-hidden shadow-lg relative",children:[d.jsxs("div",{className:"absolute top-4 right-4 z-[1000] bg-white rounded-lg shadow-lg p-4 space-y-4 w-80",children:[d.jsxs("div",{className:"flex space-x-2 mb-2",children:[d.jsx("button",{onClick:()=>W("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${H==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tout"}),d.jsx("button",{onClick:()=>W("cameras"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${H==="cameras"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Camras"}),d.jsx("button",{onClick:()=>W("datacenters"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${H==="datacenters"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Datacenters"})]}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:le,onChange:pe=>Y(pe.target.value),placeholder:`Rechercher ${H==="all"?"des lments":H==="cameras"?"une camra":"un datacenter"}...`,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),le&&d.jsx("button",{onClick:()=>Y(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:()=>Se("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${fe==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous"}),d.jsx("button",{onClick:()=>Se("online"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${fe==="online"?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"En ligne"}),d.jsx("button",{onClick:()=>Se("offline"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${fe==="offline"?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Hors ligne"})]}),d.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[d.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Statistiques"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Camras:"}),d.jsx("span",{className:"font-semibold",children:Xe.length})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Datacenters:"}),d.jsx("span",{className:"font-semibold",children:Ne.length})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"En ligne:"}),d.jsx("span",{className:"text-green-500 font-semibold",children:Object.values(E).filter(pe=>pe.status==="online").length+Object.values(F).filter(pe=>pe.status==="online").length+Ne.filter(pe=>pe.is_active).length})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Hors ligne:"}),d.jsx("span",{className:"text-red-500 font-semibold",children:Object.values(E).filter(pe=>pe.status==="offline"||pe.status==="error").length+Object.values(F).filter(pe=>pe.status==="offline"||pe.status==="error").length+Ne.filter(pe=>!pe.is_active).length})]})]})]}),d.jsx("button",{onClick:Be,disabled:O,className:`w-full px-4 py-2 rounded-md text-white text-sm flex items-center justify-center gap-2 ${O?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:O?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Test en cours..."]}):d.jsxs(d.Fragment,{children:[d.jsx(pb,{className:"w-4 h-4"}),"Tester tous les lments"]})})]}),d.jsxs(QO,{center:[31.7917,-7.0926],zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,ref:M,children:[d.jsx(eR,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),d.jsx(NR,{onMapClick:Fe}),e&&d.jsx(YO,{data:e,style:{color:"#2563eb",weight:2,fillOpacity:.1,fillColor:"#3b82f6"},onEachFeature:(pe,Ae)=>{var Pe;Ae.bindPopup(`
                <div class="p-2">
                  <h3 class="font-semibold text-lg">${pe.properties.ADMIN}</h3>
                  <p class="text-sm">Population: ${((Pe=pe.properties.POP_EST)==null?void 0:Pe.toLocaleString())||"N/A"}</p>
                </div>
              `)}}),d.jsx(vR,{chunkedLoading:!0,maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:pe=>Fn.divIcon({html:`<div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${pe.getChildCount()}</div>`,className:"custom-cluster-icon",iconSize:Fn.point(32,32)}),children:Xe.map(pe=>{var Ae,Pe,Ue,et,pt,Ze,Qt,Tt;if(pe.latitude&&pe.longitude){const Bt=parseFloat(pe.latitude),He=parseFloat(pe.longitude);if(!isNaN(Bt)&&!isNaN(He))return d.jsx(Q1,{position:[Bt,He],icon:it(pe.id),riseOnHover:!0,children:d.jsx(ev,{children:d.jsxs("div",{className:"p-2 min-w-[200px]",children:[d.jsx("h3",{className:"font-semibold text-lg",children:V(pe.name)}),d.jsxs("p",{className:"text-sm",children:["IP: ",pe.ip_address]}),d.jsxs("p",{className:"text-sm",children:["Latitude: ",Bt]}),d.jsxs("p",{className:"text-sm",children:["Longitude: ",He]}),d.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[d.jsxs("button",{onClick:ce=>{ce.preventDefault(),be(pe.id)},className:`px-3 py-1 rounded-md text-white text-sm flex items-center gap-2 ${((Ae=E[pe.id])==null?void 0:Ae.status)==="loading"?"bg-gray-400":((Pe=E[pe.id])==null?void 0:Pe.status)==="online"?"bg-green-500":((Ue=E[pe.id])==null?void 0:Ue.status)==="offline"?"bg-red-500":"bg-blue-500"}`,disabled:((et=E[pe.id])==null?void 0:et.status)==="loading",children:[((pt=E[pe.id])==null?void 0:pt.status)==="loading"?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((Ze=E[pe.id])==null?void 0:Ze.status)==="online"?d.jsx(Zx,{className:"w-4 h-4"}):((Qt=E[pe.id])==null?void 0:Qt.status)==="offline"?d.jsx(Wx,{className:"w-4 h-4"}):"Ping",((Tt=E[pe.id])==null?void 0:Tt.status)==="online"&&E[pe.id].responseTime&&d.jsxs("span",{children:[Math.round(E[pe.id].responseTime||0),"ms"]})]}),d.jsxs("button",{onClick:ce=>{ce.preventDefault(),window.confirm("tes-vous sr de vouloir supprimer cette camra ?")&&Wt(pe.id)},className:"px-3 py-1 rounded-md text-white text-sm bg-red-500 hover:bg-red-600 flex items-center gap-2",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Supprimer"]})]})]})})},pe.id)}return null})}),Ne.map(pe=>pe.latitude&&pe.longitude?d.jsx(Q1,{position:[pe.latitude,pe.longitude],icon:St(pe.id),riseOnHover:!0,eventHandlers:{click:()=>{o[pe.id]||ae(pe.id)}},children:d.jsx(ev,{children:d.jsxs("div",{className:"datacenter-popup-content",children:[d.jsxs("div",{className:"border-b border-gray-200 pb-3 mb-4",children:[d.jsxs("h3",{className:"font-semibold text-lg text-purple-700 flex items-center gap-2",children:[d.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.5L20 8v8l-8 4-8-4V8l8-3.5z",fill:"currentColor"})}),pe.name]}),pe.location&&d.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[d.jsx("span",{className:"font-medium",children:"Adresse:"})," ",pe.location]}),d.jsx("div",{className:"mt-2",children:d.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${pe.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:pe.is_active?"Actif":"Inactif"})})]}),d.jsxs("div",{className:"mt-4",children:[d.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-3 flex items-center gap-2",children:[d.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),"Types de Firewall"]}),u[pe.id]?d.jsxs("div",{className:"flex items-center justify-center py-4",children:[d.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-purple-500 border-t-transparent"}),d.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Chargement des firewalls..."})]}):o[pe.id]?d.jsx("div",{className:"space-y-3",children:o[pe.id].map(Ae=>d.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[d.jsx("div",{className:"bg-purple-50 p-3 border-b border-purple-100 cursor-pointer hover:bg-purple-100 transition-colors",onClick:()=>q(Ae.id),children:d.jsxs("div",{className:"font-medium text-sm text-purple-700 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),Ae.name]}),d.jsx("svg",{className:`w-4 h-4 transform transition-transform ${ie[Ae.id]?"rotate-180":""}`,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M7 10l5 5 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),ie[Ae.id]&&d.jsx("div",{className:"p-3",children:Ae.firewalls&&Ae.firewalls.length>0?d.jsx("div",{className:"space-y-2",children:Ae.firewalls.map(Pe=>{var Ue,et,pt,Ze,Qt,Tt,Bt,He;return d.jsx("div",{className:"bg-gray-50 rounded-md p-3 hover:bg-gray-100 transition-colors",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm",children:d.jsx("svg",{className:"w-4 h-4 text-purple-600",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-medium text-sm",children:Pe.name}),d.jsx("div",{className:"text-xs text-gray-500 mt-1",children:Pe.ip_address})]})]}),d.jsxs("button",{onClick:ce=>{ce.stopPropagation(),_e(Pe.id)},className:`px-3 py-1.5 rounded-md text-white text-sm flex items-center gap-2 transition-colors ${((Ue=F[Pe.id])==null?void 0:Ue.status)==="loading"?"bg-gray-400":((et=F[Pe.id])==null?void 0:et.status)==="online"?"bg-green-500 hover:bg-green-600":((pt=F[Pe.id])==null?void 0:pt.status)==="offline"?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600"}`,disabled:((Ze=F[Pe.id])==null?void 0:Ze.status)==="loading",children:[((Qt=F[Pe.id])==null?void 0:Qt.status)==="loading"?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((Tt=F[Pe.id])==null?void 0:Tt.status)==="online"?d.jsx(Zx,{className:"w-4 h-4"}):((Bt=F[Pe.id])==null?void 0:Bt.status)==="offline"?d.jsx(Wx,{className:"w-4 h-4"}):"Ping",((He=F[Pe.id])==null?void 0:He.status)==="online"&&F[Pe.id].responseTime&&d.jsxs("span",{children:[Math.round(F[Pe.id].responseTime||0),"ms"]})]})]})},Pe.id)})}):d.jsx("div",{className:"text-sm text-gray-500 italic text-center py-2",children:"Aucun firewall associ"})})]},Ae.id))}):d.jsx("div",{className:"text-sm text-gray-500 text-center py-4",children:"Aucun type de firewall trouv"})]})]})})},`dc-${pe.id}`):null)]}),h&&D&&A&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1000]",onClick:()=>m(!1)}),d.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-[1001]",children:d.jsx(bR,{onClose:()=>m(!1),position:g,onSuccess:pe=>{k(pe),setTimeout(()=>k(null),3e3)},onError:pe=>{y(pe),setTimeout(()=>y(null),3e3)},onCamerasUpdate:n})})]}),_&&d.jsxs("div",{className:"absolute top-4 left-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-[1002] flex items-center justify-between",children:[d.jsx("span",{children:_}),_.includes("connecter")&&d.jsx("button",{onClick:()=>window.location.reload(),className:"ml-4 px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Rafrachir"})]}),S&&d.jsx("div",{className:"absolute top-4 left-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded z-[1002]",children:S})]})};function LR(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function av(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?av(Object(r),!0).forEach(function(n){LR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):av(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FR(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function PR(e,t){if(e==null)return{};var r=FR(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function OR(e,t){return RR(e)||MR(e,t)||IR(e,t)||DR()}function RR(e){if(Array.isArray(e))return e}function MR(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(u){a=!0,i=u}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function IR(e,t){if(e){if(typeof e=="string")return sv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sv(e,t)}}function sv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jR(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ov(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ov(Object(r),!0).forEach(function(n){jR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ov(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BR(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(a,i){return i(a)},n)}}function cl(e){return function t(){for(var r=this,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return a.length>=e.length?e.apply(this,a):function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return t.apply(r,[].concat(a,l))}}}function Sf(e){return{}.toString.call(e).includes("Object")}function zR(e){return!Object.keys(e).length}function rc(e){return typeof e=="function"}function UR(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function HR(e,t){return Sf(t)||Si("changeType"),Object.keys(t).some(function(r){return!UR(e,r)})&&Si("changeField"),t}function VR(e){rc(e)||Si("selectorType")}function $R(e){rc(e)||Sf(e)||Si("handlerType"),Sf(e)&&Object.values(e).some(function(t){return!rc(t)})&&Si("handlersType")}function WR(e){e||Si("initialIsRequired"),Sf(e)||Si("initialType"),zR(e)&&Si("initialContent")}function ZR(e,t){throw new Error(e[t]||e.default)}var GR={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Si=cl(ZR)(GR),du={changes:HR,selector:VR,handler:$R,initial:WR};function XR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};du.initial(e),du.handler(t);var r={current:e},n=cl(YR)(r,t),a=cl(KR)(r),i=cl(du.changes)(e),o=cl(qR)(r);function l(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return du.selector(f),f(r.current)}function u(f){BR(n,a,i,o)(f)}return[l,u]}function qR(e,t){return rc(t)?t(e.current):t}function KR(e,t){return e.current=lv(lv({},e.current),t),t}function YR(e,t,r){return rc(t)?t(e.current):Object.keys(r).forEach(function(n){var a;return(a=t[n])===null||a===void 0?void 0:a.call(t,e.current[n])}),r}var JR={create:XR},QR={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function eM(e){return function t(){for(var r=this,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return a.length>=e.length?e.apply(this,a):function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return t.apply(r,[].concat(a,l))}}}function tM(e){return{}.toString.call(e).includes("Object")}function rM(e){return e||cv("configIsRequired"),tM(e)||cv("configType"),e.urls?(nM(),{paths:{vs:e.urls.monacoBase}}):e}function nM(){console.warn(xk.deprecation)}function aM(e,t){throw new Error(e[t]||e.default)}var xk={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},cv=eM(aM)(xk),iM={config:rM},sM=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(a){return r.reduceRight(function(i,o){return o(i)},a)}};function vk(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],vk(e[r],t[r]))}),iv(iv({},e),t)}var oM={type:"cancelation",msg:"operation is manually canceled"};function gd(e){var t=!1,r=new Promise(function(n,a){e.then(function(i){return t?a(oM):n(i)}),e.catch(a)});return r.cancel=function(){return t=!0},r}var lM=JR.create({config:QR,isInitialized:!1,resolve:null,reject:null,monaco:null}),_k=OR(lM,2),yc=_k[0],r0=_k[1];function cM(e){var t=iM.config(e),r=t.monaco,n=PR(t,["monaco"]);r0(function(a){return{config:vk(a.config,n),monaco:r}})}function uM(){var e=yc(function(t){var r=t.monaco,n=t.isInitialized,a=t.resolve;return{monaco:r,isInitialized:n,resolve:a}});if(!e.isInitialized){if(r0({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),gd(xd);if(window.monaco&&window.monaco.editor)return yk(window.monaco),e.resolve(window.monaco),gd(xd);sM(fM,hM)(pM)}return gd(xd)}function fM(e){return document.body.appendChild(e)}function dM(e){var t=document.createElement("script");return e&&(t.src=e),t}function hM(e){var t=yc(function(n){var a=n.config,i=n.reject;return{config:a,reject:i}}),r=dM("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function pM(){var e=yc(function(r){var n=r.config,a=r.resolve,i=r.reject;return{config:n,resolve:a,reject:i}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){yk(r),e.resolve(r)},function(r){e.reject(r)})}function yk(e){yc().monaco||r0({monaco:e})}function mM(){return yc(function(e){var t=e.monaco;return t})}var xd=new Promise(function(e,t){return r0({resolve:e,reject:t})}),Nm={config:cM,init:uM,__getMonacoInstance:mM},gM={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},vd=gM,xM={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},vM=xM;function _M({children:e}){return Pn.createElement("div",{style:vM.container},e)}var yM=_M,wM=yM;function kM({width:e,height:t,isEditorReady:r,loading:n,_ref:a,className:i,wrapperProps:o}){return Pn.createElement("section",{style:{...vd.wrapper,width:e,height:t},...o},!r&&Pn.createElement(wM,null,n),Pn.createElement("div",{ref:a,style:{...vd.fullWidth,...!r&&vd.hide},className:i}))}var EM=kM,wk=C.memo(EM);function SM(e){C.useEffect(e,[])}var kk=SM;function TM(e,t,r=!0){let n=C.useRef(!0);C.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var fn=TM;function Nl(){}function Qs(e,t,r,n){return CM(e,n)||bM(e,t,r,n)}function CM(e,t){return e.editor.getModel(Ek(e,t))}function bM(e,t,r,n){return e.editor.createModel(t,r,n?Ek(e,n):void 0)}function Ek(e,t){return e.Uri.parse(t)}function NM({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:a,originalModelPath:i,modifiedModelPath:o,keepCurrentOriginalModel:l=!1,keepCurrentModifiedModel:u=!1,theme:f="light",loading:h="Loading...",options:m={},height:g="100%",width:x="100%",className:_,wrapperProps:y={},beforeMount:S=Nl,onMount:k=Nl}){let[E,w]=C.useState(!1),[F,j]=C.useState(!0),D=C.useRef(null),A=C.useRef(null),M=C.useRef(null),O=C.useRef(k),G=C.useRef(S),H=C.useRef(!1);kk(()=>{let le=Nm.init();return le.then(Y=>(A.current=Y)&&j(!1)).catch(Y=>(Y==null?void 0:Y.type)!=="cancelation"&&console.error("Monaco initialization: error:",Y)),()=>D.current?Se():le.cancel()}),fn(()=>{if(D.current&&A.current){let le=D.current.getOriginalEditor(),Y=Qs(A.current,e||"",n||r||"text",i||"");Y!==le.getModel()&&le.setModel(Y)}},[i],E),fn(()=>{if(D.current&&A.current){let le=D.current.getModifiedEditor(),Y=Qs(A.current,t||"",a||r||"text",o||"");Y!==le.getModel()&&le.setModel(Y)}},[o],E),fn(()=>{let le=D.current.getModifiedEditor();le.getOption(A.current.editor.EditorOption.readOnly)?le.setValue(t||""):t!==le.getValue()&&(le.executeEdits("",[{range:le.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),le.pushUndoStop())},[t],E),fn(()=>{var le,Y;(Y=(le=D.current)==null?void 0:le.getModel())==null||Y.original.setValue(e||"")},[e],E),fn(()=>{let{original:le,modified:Y}=D.current.getModel();A.current.editor.setModelLanguage(le,n||r||"text"),A.current.editor.setModelLanguage(Y,a||r||"text")},[r,n,a],E),fn(()=>{var le;(le=A.current)==null||le.editor.setTheme(f)},[f],E),fn(()=>{var le;(le=D.current)==null||le.updateOptions(m)},[m],E);let W=C.useCallback(()=>{var xe;if(!A.current)return;G.current(A.current);let le=Qs(A.current,e||"",n||r||"text",i||""),Y=Qs(A.current,t||"",a||r||"text",o||"");(xe=D.current)==null||xe.setModel({original:le,modified:Y})},[r,t,a,e,n,i,o]),fe=C.useCallback(()=>{var le;!H.current&&M.current&&(D.current=A.current.editor.createDiffEditor(M.current,{automaticLayout:!0,...m}),W(),(le=A.current)==null||le.editor.setTheme(f),w(!0),H.current=!0)},[m,f,W]);C.useEffect(()=>{E&&O.current(D.current,A.current)},[E]),C.useEffect(()=>{!F&&!E&&fe()},[F,E,fe]);function Se(){var Y,xe,re,K;let le=(Y=D.current)==null?void 0:Y.getModel();l||((xe=le==null?void 0:le.original)==null||xe.dispose()),u||((re=le==null?void 0:le.modified)==null||re.dispose()),(K=D.current)==null||K.dispose()}return Pn.createElement(wk,{width:x,height:g,isEditorReady:E,loading:h,_ref:M,className:_,wrapperProps:y})}var AM=NM;C.memo(AM);function LM(e){let t=C.useRef();return C.useEffect(()=>{t.current=e},[e]),t.current}var FM=LM,hu=new Map;function PM({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:a,path:i,theme:o="light",line:l,loading:u="Loading...",options:f={},overrideServices:h={},saveViewState:m=!0,keepCurrentModel:g=!1,width:x="100%",height:_="100%",className:y,wrapperProps:S={},beforeMount:k=Nl,onMount:E=Nl,onChange:w,onValidate:F=Nl}){let[j,D]=C.useState(!1),[A,M]=C.useState(!0),O=C.useRef(null),G=C.useRef(null),H=C.useRef(null),W=C.useRef(E),fe=C.useRef(k),Se=C.useRef(),le=C.useRef(n),Y=FM(i),xe=C.useRef(!1),re=C.useRef(!1);kk(()=>{let he=Nm.init();return he.then(R=>(O.current=R)&&M(!1)).catch(R=>(R==null?void 0:R.type)!=="cancelation"&&console.error("Monaco initialization: error:",R)),()=>G.current?ie():he.cancel()}),fn(()=>{var R,J,q,Z;let he=Qs(O.current,e||n||"",t||a||"",i||r||"");he!==((R=G.current)==null?void 0:R.getModel())&&(m&&hu.set(Y,(J=G.current)==null?void 0:J.saveViewState()),(q=G.current)==null||q.setModel(he),m&&((Z=G.current)==null||Z.restoreViewState(hu.get(i))))},[i],j),fn(()=>{var he;(he=G.current)==null||he.updateOptions(f)},[f],j),fn(()=>{!G.current||n===void 0||(G.current.getOption(O.current.editor.EditorOption.readOnly)?G.current.setValue(n):n!==G.current.getValue()&&(re.current=!0,G.current.executeEdits("",[{range:G.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),G.current.pushUndoStop(),re.current=!1))},[n],j),fn(()=>{var R,J;let he=(R=G.current)==null?void 0:R.getModel();he&&a&&((J=O.current)==null||J.editor.setModelLanguage(he,a))},[a],j),fn(()=>{var he;l!==void 0&&((he=G.current)==null||he.revealLine(l))},[l],j),fn(()=>{var he;(he=O.current)==null||he.editor.setTheme(o)},[o],j);let K=C.useCallback(()=>{var he;if(!(!H.current||!O.current)&&!xe.current){fe.current(O.current);let R=i||r,J=Qs(O.current,n||e||"",t||a||"",R||"");G.current=(he=O.current)==null?void 0:he.editor.create(H.current,{model:J,automaticLayout:!0,...f},h),m&&G.current.restoreViewState(hu.get(R)),O.current.editor.setTheme(o),l!==void 0&&G.current.revealLine(l),D(!0),xe.current=!0}},[e,t,r,n,a,i,f,h,m,o,l]);C.useEffect(()=>{j&&W.current(G.current,O.current)},[j]),C.useEffect(()=>{!A&&!j&&K()},[A,j,K]),le.current=n,C.useEffect(()=>{var he,R;j&&w&&((he=Se.current)==null||he.dispose(),Se.current=(R=G.current)==null?void 0:R.onDidChangeModelContent(J=>{re.current||w(G.current.getValue(),J)}))},[j,w]),C.useEffect(()=>{if(j){let he=O.current.editor.onDidChangeMarkers(R=>{var q;let J=(q=G.current.getModel())==null?void 0:q.uri;if(J&&R.find(Z=>Z.path===J.path)){let Z=O.current.editor.getModelMarkers({resource:J});F==null||F(Z)}});return()=>{he==null||he.dispose()}}return()=>{}},[j,F]);function ie(){var he,R;(he=Se.current)==null||he.dispose(),g?m&&hu.set(i,G.current.saveViewState()):(R=G.current.getModel())==null||R.dispose(),G.current.dispose()}return Pn.createElement(wk,{width:x,height:_,isEditorReady:j,loading:u,_ref:H,className:y,wrapperProps:S})}var OM=PM,RM=C.memo(OM),MM=RM;Nm.config({paths:{vs:"/static/vs"}});window.MonacoEnvironment={getWorkerUrl:function(e,t){const r="/static/vs/",n={json:"language/json/json.worker.js",css:"language/css/css.worker.js",scss:"language/css/css.worker.js",less:"language/css/css.worker.js",html:"language/html/html.worker.js",handlebars:"language/html/html.worker.js",razor:"language/html/html.worker.js",typescript:"language/typescript/ts.worker.js",javascript:"language/typescript/ts.worker.js",editor:"editor/editor.worker.js"},a=n[t]||n.editor;return`${r}${a}`}};function _d(){const{id:e}=P4(),t=_a(),[r,n]=C.useState(""),[a,i]=C.useState(""),[o,l]=C.useState([]),[u,f]=C.useState([]),[h,m]=C.useState({name:"",description:""}),[g,x]=C.useState(null),[_,y]=C.useState(!1),[S,k]=C.useState(null),E=C.useRef(null),[w,F]=C.useState(!1),j=async()=>{try{const Y=await Ds.getVariables();if(Array.isArray(Y)){const xe=Y.sort((re,K)=>re.name.localeCompare(K.name));l(xe)}else l([])}catch{k("Erreur lors du chargement des variables"),l([])}},D=async()=>{try{y(!0);const Y=await Is.getTemplates();Array.isArray(Y)?f(Y):f([])}catch{k("Erreur lors du chargement des templates"),f([])}finally{y(!1)}};C.useEffect(()=>{e&&A(e),j(),D()},[e]);const A=async Y=>{try{y(!0);const xe=await Is.getTemplate(parseInt(Y)),re=await Ds.getVariables();i(xe.name),n(xe.content),l(re)}catch{k("Erreur lors du chargement du template")}finally{y(!1)}},M=(Y,xe)=>{E.current=Y,F(!0),Y.updateOptions({minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0,theme:"vs-dark"}),xe.languages.register({id:"template"}),xe.languages.setMonarchTokensProvider("template",{tokenizer:{root:[[/{{.*?}}/,"variable"],[/[{}]/,"delimiter"]]}})},O=Y=>{if(E.current){const xe=E.current.getSelection(),re={major:1,minor:1},K=`{{ ${Y} }}`,ie={identifier:re,range:xe,text:K,forceMoveMarkers:!0};E.current.executeEdits("my-source",[ie]),E.current.focus()}},G=async()=>{if(!h.name||!h.description){k("Veuillez remplir tous les champs de la variable");return}try{y(!0);const Y=await Ds.createVariable(h);e&&await Ds.addVariableToTemplate(parseInt(e),Y.id),m({name:"",description:""}),await j()}catch{k("Erreur lors de l'ajout de la variable")}finally{y(!1)}},H=async Y=>{try{y(!0),await Ds.deleteVariable(Y),await j()}catch{k("Erreur lors de la suppression de la variable")}finally{y(!1)}},W=async()=>{if(!a){k("Veuillez donner un nom au template");return}try{y(!0);const Y={name:a,content:r};e?await Is.updateTemplate(parseInt(e),Y):await Is.createTemplate({...Y,description:"",variables:[]}),t("/templates")}catch{k("Erreur lors de la sauvegarde du template")}finally{y(!1)}},fe=async Y=>{if(window.confirm("tes-vous sr de vouloir supprimer ce template ?"))try{y(!0),await Is.deleteTemplate(Y),await D()}catch{k("Erreur lors de la suppression du template")}finally{y(!1)}},Se=async Y=>{try{y(!0);const xe=await We.get(`${ta}/templates/${Y}/download_excel/`,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),re=new Blob([xe.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),K=window.URL.createObjectURL(re),ie=document.createElement("a");ie.href=K,ie.download=`template_${Y}_${new Date().toISOString()}.xlsx`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),window.URL.revokeObjectURL(K)}catch(xe){console.error("Error downloading Excel file:",xe),k("Failed to download Excel file")}finally{y(!1)}},le=async()=>{y(!0);try{await Promise.all([j(),D()])}catch{k("Erreur lors du rafrachissement")}finally{y(!1)}};return _?d.jsx("div",{className:"p-8 flex items-center justify-center",children:d.jsx(Os,{className:"w-8 h-8 animate-spin text-purple-600"})}):d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"Modifier le Template":"Nouveau Template"}),d.jsx("p",{className:"text-gray-600",children:"Crez et modifiez vos templates avec des variables dynamiques"})]}),d.jsx("button",{onClick:le,disabled:_,className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",title:"Rafrachir",children:_?d.jsx(Os,{className:"w-5 h-5 animate-spin"}):d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})})]}),S&&d.jsx("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded-md",children:S}),d.jsxs("div",{className:"flex gap-6",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{htmlFor:"templateName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du Template"}),d.jsx("input",{id:"templateName",name:"templateName",type:"text",value:a,onChange:Y=>i(Y.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"Entrez le nom du template"})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[!w&&d.jsx("div",{className:"flex items-center justify-center h-[500px] bg-gray-50",children:d.jsxs("div",{className:"flex flex-col items-center",children:[d.jsx(Os,{className:"w-8 h-8 animate-spin text-purple-600 mb-2"}),d.jsx("p",{className:"text-gray-600",children:"Loading editor..."})]})}),d.jsx(MM,{height:"500px",defaultLanguage:"template",value:r,onChange:Y=>n(Y||""),onMount:M,options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0,theme:"vs-dark"}})]}),d.jsxs("div",{className:"mt-4 flex gap-4",children:[d.jsxs("button",{onClick:W,disabled:_,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:[_?d.jsx(Os,{className:"w-5 h-5 mr-2 animate-spin"}):d.jsx(p2,{className:"w-5 h-5 mr-2"}),_?"Enregistrement...":"Enregistrer"]}),d.jsxs("button",{onClick:()=>t("/templates"),className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[d.jsx(sb,{className:"w-5 h-5 mr-2"}),"Retour"]}),e&&d.jsxs("button",{onClick:()=>fe(parseInt(e)),disabled:_,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:[d.jsx(An,{className:"w-5 h-5 mr-2"}),"Supprimer"]})]})]}),d.jsx("div",{className:"w-80",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Variables Disponibles"}),d.jsx("div",{className:"space-y-4 mb-6",children:o&&o.length>0?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mb-4",children:[d.jsxs("h3",{className:"text-sm font-medium text-purple-600 mb-2 flex items-center",children:[d.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),"Variables Requises"]}),d.jsx("div",{className:"space-y-2",children:o.filter(Y=>["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(Y.name)).map(Y=>d.jsxs("div",{className:"group relative",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 bg-purple-50 hover:bg-purple-100 rounded-md transition-colors duration-200",children:[d.jsx("button",{onClick:()=>O(Y.name),className:"flex-1 text-left flex items-center",children:d.jsx("span",{className:"text-purple-700 font-medium",children:Y.name})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx($x,{className:"w-4 h-4 text-purple-400"}),d.jsx("button",{onClick:()=>H(Y.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(An,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===Y.name&&d.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:Y.description})]},`variable-${Y.id||Y.name}`))})]}),d.jsxs("div",{children:[d.jsxs("h3",{className:"text-sm font-medium text-gray-600 mb-2 flex items-center",children:[d.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),"Variables Personnalises"]}),d.jsx("div",{className:"space-y-2",children:o.filter(Y=>!["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(Y.name)).map(Y=>d.jsxs("div",{className:"group relative",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 hover:bg-gray-100 rounded-md transition-colors duration-200",children:[d.jsx("button",{onClick:()=>O(Y.name),className:"flex-1 text-left flex items-center",children:d.jsx("span",{className:"text-gray-700",children:Y.name})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx($x,{className:"w-4 h-4 text-gray-400"}),d.jsx("button",{onClick:()=>H(Y.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(An,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===Y.name&&d.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:Y.description})]},`variable-${Y.id||Y.name}`))})]})]}):d.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucune variable disponible"})}),d.jsxs("div",{className:"border-t pt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Ajouter une variable"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"variableName",className:"block text-sm text-gray-600 mb-1",children:"Nom de la variable"}),d.jsx("input",{id:"variableName",name:"variableName",type:"text",value:h.name,onChange:Y=>m({...h,name:Y.target.value}),placeholder:"Nom de la variable",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"variableDescription",className:"block text-sm text-gray-600 mb-1",children:"Description"}),d.jsx("input",{id:"variableDescription",name:"variableDescription",type:"text",value:h.description,onChange:Y=>m({...h,description:Y.target.value}),placeholder:"Description",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),d.jsxs("button",{onClick:G,disabled:_,className:"w-full flex items-center justify-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:[_?d.jsx(Os,{className:"w-4 h-4 mr-2 animate-spin"}):d.jsx(Ks,{className:"w-4 h-4 mr-2"}),"Ajouter"]})]})]}),d.jsxs("div",{className:"border-t mt-6 pt-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Templates"}),d.jsxs("button",{onClick:()=>t("/templates/new"),className:"flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm",children:[d.jsx(Ks,{className:"w-4 h-4 mr-1"}),"Nouveau"]})]}),d.jsx("div",{className:"space-y-3",children:_?d.jsx("div",{className:"flex justify-center py-4",children:d.jsx(Os,{className:"w-6 h-6 animate-spin text-purple-600"})}):u&&u.length>0?u.map(Y=>d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 hover:bg-gray-100 rounded-md",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"font-medium text-gray-900",children:Y.name}),d.jsxs("div",{className:"text-sm text-gray-500",children:["Cr le: ",Y.created_at?new Date(Y.created_at).toLocaleDateString():"N/A"]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>t(`/templates/${Y.id}`),className:"p-1 text-blue-500 hover:text-blue-700",title:"Modifier",children:d.jsx(mb,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>Se(Y.id),className:"p-1 text-green-500 hover:text-green-700",title:"Tlcharger Excel",children:d.jsx(cb,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>fe(Y.id),className:"p-1 text-red-500 hover:text-red-700",title:"Supprimer",children:d.jsx(An,{className:"w-4 h-4"})})]})]},`template-${Y.id}`)):d.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucun template disponible"})})]})]})})]})]})}function IM(){const e=_a(),[t,r]=C.useState(null),[n,a]=C.useState(!1),[i,o]=C.useState({}),[l,u]=C.useState(null),[f,h]=C.useState(null),[m,g]=C.useState(null),[x,_]=C.useState(!1),[y,S]=C.useState(null),[k,E]=C.useState(!1),[w,F]=C.useState({current_password:"",new_password:"",confirm_password:""});C.useEffect(()=>{(async()=>{try{console.log("Fetching user profile data...");const O=await rn.get("/auth/users/me/");console.log("User profile response:",O.data),r(O.data),o(O.data),u(null)}catch(O){console.error("Error fetching user profile data:",O),u(O.message)}})()},[]);const j=async M=>{M.preventDefault();try{console.log("Updating user data:",i);const O=await rn.put("/auth/users/update_user_info/",i);console.log("Update response:",O.data),O.data&&(r(O.data.user),a(!1),u(null))}catch(O){console.error("Error updating user data:",O),u(O.message)}},D=async M=>{var O,G;if(M.preventDefault(),h(null),g(null),w.new_password!==w.confirm_password){h("Les mots de passe ne correspondent pas");return}if(w.new_password.length<8){h("Le mot de passe doit contenir au moins 8 caractres");return}try{(await rn.put("/auth/users/update_user_info/",{current_password:w.current_password,password:w.new_password})).data&&(g("Mot de passe mis  jour avec succs"),F({current_password:"",new_password:"",confirm_password:""}))}catch(H){console.error("Error updating password:",H),h(((G=(O=H.response)==null?void 0:O.data)==null?void 0:G.error)||"Erreur lors de la mise  jour du mot de passe")}},A=async()=>{var M,O;E(!0),S(null);try{await rn.delete("/auth/users/me/"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e("/login")}catch(G){console.error("Error deleting profile:",G),S(((O=(M=G.response)==null?void 0:M.data)==null?void 0:O.error)||"Erreur lors de la suppression du profil"),_(!1)}finally{E(!1)}};return l?d.jsx("div",{className:"max-w-2xl mx-auto p-6",children:d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsxs("p",{className:"text-red-600",children:["Error: ",l]})})}):t?d.jsx("div",{className:"max-w-2xl mx-auto p-6",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[d.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[d.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:d.jsx(us,{className:"h-8 w-8 text-purple-600"})}),d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[t.first_name," ",t.last_name]}),d.jsxs("p",{className:"text-gray-600",children:["@",t.username]})]})]}),d.jsxs("form",{onSubmit:j,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(us,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"text",value:i.username||"",onChange:M=>o({...i,username:M.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),d.jsx("input",{type:"text",value:i.first_name||"",onChange:M=>o({...i,first_name:M.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),d.jsx("input",{type:"text",value:i.last_name||"",onChange:M=>o({...i,last_name:M.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(d2,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"email",value:i.email||"",onChange:M=>o({...i,email:M.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(h2,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"tel",value:i.phone_number||"",onChange:M=>o({...i,phone_number:M.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsx("div",{className:"flex justify-end space-x-4 mt-6",children:n?d.jsxs(d.Fragment,{children:[d.jsx("button",{type:"button",onClick:()=>{a(!1),o(t)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[d.jsx(p2,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}):d.jsx("button",{type:"button",onClick:()=>a(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Edit Profile"})})]}),d.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[d.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),d.jsxs("form",{onSubmit:D,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(di,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"password",value:w.current_password,onChange:M=>F({...w,current_password:M.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(di,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"password",value:w.new_password,onChange:M=>F({...w,new_password:M.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(di,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"password",value:w.confirm_password,onChange:M=>F({...w,confirm_password:M.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),f&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsx("p",{className:"text-red-600",children:f})}),m&&d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:d.jsx("p",{className:"text-green-600",children:m})}),d.jsx("div",{className:"flex justify-end",children:d.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[d.jsx(di,{className:"h-4 w-4 mr-2"}),"Change Password"]})})]})]}),d.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[d.jsx("h2",{className:"text-lg font-medium text-red-600 mb-4",children:"Zone de danger"}),d.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[d.jsx("p",{className:"text-red-600 mb-4",children:"La suppression de votre compte est irrversible. Toutes vos donnes seront dfinitivement supprimes."}),d.jsxs("button",{onClick:()=>_(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center",children:[d.jsx(An,{className:"h-4 w-4 mr-2"}),"Supprimer mon compte"]})]})]}),x&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[d.jsx("h3",{className:"text-lg font-medium text-red-600 mb-4",children:"Confirmer la suppression"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"tes-vous sr de vouloir supprimer votre compte ? Cette action est irrversible."}),y&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:d.jsx("p",{className:"text-red-600",children:y})}),d.jsxs("div",{className:"flex justify-end space-x-4",children:[d.jsx("button",{onClick:()=>_(!1),disabled:k,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Annuler"}),d.jsx("button",{onClick:A,disabled:k,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center disabled:opacity-50",children:k?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Suppression en cours..."]}):d.jsxs(d.Fragment,{children:[d.jsx(An,{className:"h-4 w-4 mr-2"}),"Confirmer la suppression"]})})]})]})})]})}):d.jsx("div",{className:"max-w-2xl mx-auto p-6",children:d.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:d.jsxs("div",{className:"animate-pulse",children:[d.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"h-4 bg-gray-200 rounded"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]})})})}const DM=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(!0),[a,i]=C.useState(null),[o,l]=C.useState({}),u=g=>{l(x=>({...x,[g]:!x[g]}))};C.useEffect(()=>{(async()=>{try{n(!0);const x=localStorage.getItem("token");if(!x){i("Session expire. Veuillez vous reconnecter.");return}const _=await fetch("http://localhost:8000/api/history/",{headers:{Authorization:`Bearer ${x}`,"Content-Type":"application/json",Accept:"application/json"}});if(!_.ok)throw new Error(`Erreur lors de la rcupration de l'historique: ${_.status}`);const y=_.headers.get("content-type");if(!y||!y.includes("application/json"))throw new Error("Format de rponse invalide");const S=await _.json();t(S.results||[])}catch(x){i(x.message)}finally{n(!1)}})()},[]);const f=g=>{switch(g){case"firewall":return d.jsx(Ni,{className:"h-5 w-5 text-purple-600"});case"data_center":return d.jsx(Co,{className:"h-5 w-5 text-blue-600"});case"firewall_type":return d.jsx(bo,{className:"h-5 w-5 text-green-600"});default:return null}},h=g=>{const x=new Date(g);return new Intl.DateTimeFormat("fr-FR",{dateStyle:"medium",timeStyle:"short"}).format(x)},m=(g,x)=>{try{const _=JSON.parse(g),y=o[x],S=k=>{if(!k)return k;const E={...k};return delete E.id,delete E.user_id,delete E.owner_id,delete E.firewall_id,delete E.data_center_id,E};return d.jsxs("div",{className:"mt-4 space-y-4",children:[d.jsxs("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:[d.jsx("div",{className:"bg-gray-100 px-4 py-2 border-b border-gray-200",children:d.jsxs("h4",{className:"text-sm font-medium text-gray-700 flex items-center",children:[d.jsx("span",{className:"mr-2",children:""}),"Requte ",_.request.method," ",_.request.path]})}),d.jsxs("div",{className:"p-4",children:[_.request.data&&Object.keys(_.request.data).length>0&&d.jsxs("div",{className:"mb-3",children:[d.jsx("h5",{className:"text-xs font-medium text-gray-500 mb-1",children:"Donnes"}),d.jsx("pre",{className:"text-xs text-gray-600 bg-white p-2 rounded border border-gray-200 overflow-x-auto",children:JSON.stringify(S(_.request.data),null,2)})]}),_.request.query_params&&Object.keys(_.request.query_params).length>0&&d.jsxs("div",{children:[d.jsx("h5",{className:"text-xs font-medium text-gray-500 mb-1",children:"Paramtres"}),d.jsx("pre",{className:"text-xs text-gray-600 bg-white p-2 rounded border border-gray-200 overflow-x-auto",children:JSON.stringify(S(_.request.query_params),null,2)})]})]})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:[d.jsx("div",{className:"bg-gray-100 px-4 py-2 border-b border-gray-200 cursor-pointer hover:bg-gray-200 transition-colors",onClick:()=>u(x),children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h4",{className:"text-sm font-medium text-gray-700 flex items-center",children:[d.jsx("span",{className:"mr-2",children:""}),"Rponse (",_.response.status_code,")"]}),y?d.jsx(lb,{className:"h-4 w-4 text-gray-500"}):d.jsx(cf,{className:"h-4 w-4 text-gray-500"})]})}),y&&d.jsx("div",{className:"p-4",children:_.response.data&&Object.keys(_.response.data).length>0&&d.jsx("pre",{className:"text-xs text-gray-600 bg-white p-2 rounded border border-gray-200 overflow-x-auto",children:JSON.stringify(S(_.response.data),null,2)})})]})]})}catch{return d.jsx("p",{className:"mt-2 text-sm text-gray-600",children:g})}};return r?d.jsx("div",{className:"flex items-center justify-center h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Historique des Actions"}),d.jsx("p",{className:"text-gray-600",children:"Consultez l'historique des modifications sur les pare-feux et les centres de donnes"})]}),a&&d.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md",children:a}),d.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[d.jsx("div",{className:"divide-y divide-gray-200",children:e.map(g=>d.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:d.jsxs("div",{className:"flex items-start space-x-4",children:[d.jsx("div",{className:"flex-shrink-0",children:f(g.entity_type)}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[g.action," - ",g.entity_name||"Entit"]}),d.jsx("p",{className:"text-sm text-gray-500",children:h(g.timestamp)})]}),d.jsxs("div",{className:"mt-1 flex items-center text-sm text-gray-500",children:[d.jsx(us,{className:"h-4 w-4 mr-1"}),d.jsx("span",{children:"Utilisateur"})]}),g.details&&m(g.details,g.id)]})]})},g.id))}),e.length===0&&!r&&d.jsxs("div",{className:"text-center py-12",children:[d.jsx(uf,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Aucun historique disponible"}),d.jsx("p",{className:"text-gray-500 mt-2",children:"Les actions effectues apparatront ici."})]})]})]})},jM=()=>{const[e,t]=C.useState({firewalls:0,datacenters:0,firewallTypes:0,todayActions:0,recentActivity:[],firewallStatus:[]}),[r,n]=C.useState(!0),[a,i]=C.useState(null);return C.useEffect(()=>{(async()=>{try{n(!0);const l=localStorage.getItem("token");if(!l)throw new Error("No authentication token found");const u=await fetch("http://localhost:8000/api/history/dashboard-stats/",{headers:{Authorization:`Bearer ${l}`,Accept:"application/json","Content-Type":"application/json"}});if(u.status===401)throw new Error("Authentication token expired or invalid");if(!u.ok){const h=await u.text();throw console.error("API Error Response:",h),new Error("Failed to fetch dashboard data")}const f=await u.json();t(f)}catch(l){console.error("Error fetching dashboard stats:",l),l.message==="No authentication token found"?i("Veuillez vous connecter pour accder au tableau de bord"):l.message==="Authentication token expired or invalid"?i("Votre session a expir. Veuillez vous reconnecter"):i("Erreur lors du chargement des donnes du tableau de bord")}finally{n(!1)}})()},[]),{stats:e,loading:r,error:a}},uv=()=>{const{stats:e,loading:t,error:r}=jM(),n=i=>{const o=new Date(i);return new Intl.DateTimeFormat("fr-FR",{dateStyle:"medium",timeStyle:"short"}).format(o)},a=i=>{switch(i.toLowerCase()){case"online":return d.jsx(ob,{className:"h-5 w-5 text-green-500"});case"offline":return d.jsx(yb,{className:"h-5 w-5 text-red-500"});default:return d.jsx(ib,{className:"h-5 w-5 text-yellow-500"})}};return t?d.jsx("div",{className:"flex items-center justify-center h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):r?d.jsx("div",{className:"p-8",children:d.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:d.jsxs("p",{children:["Erreur lors du chargement des donnes : ",r]})})}):d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Tableau de Bord"}),d.jsx("p",{className:"text-gray-600",children:"Vue d'ensemble de votre infrastructure"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[d.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600",children:d.jsx(Ni,{className:"h-6 w-6"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("h2",{className:"text-gray-600 text-sm",children:"Pare-feux"}),d.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.firewalls})]})]})}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600",children:d.jsx(Co,{className:"h-6 w-6"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("h2",{className:"text-gray-600 text-sm",children:"Centres de donnes"}),d.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.datacenters})]})]})}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-600",children:d.jsx(bo,{className:"h-6 w-6"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("h2",{className:"text-gray-600 text-sm",children:"Types de pare-feux"}),d.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.firewallTypes})]})]})}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-3 rounded-full bg-yellow-100 text-yellow-600",children:d.jsx(u2,{className:"h-6 w-6"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("h2",{className:"text-gray-600 text-sm",children:"Actions aujourd'hui"}),d.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.todayActions})]})]})})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activit rcente"}),e.recentActivity.length>0?d.jsx("div",{className:"space-y-4",children:e.recentActivity.map(i=>d.jsxs("div",{className:"flex items-start space-x-4 p-3 hover:bg-gray-50 rounded-lg",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx(uf,{className:"h-5 w-5 text-gray-400"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[i.action," - ",i.entity_name]}),d.jsx("p",{className:"text-sm text-gray-500",children:n(i.timestamp)})]})]},i.id))}):d.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucune activit rcente"})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statut des pare-feux"}),e.firewallStatus.length>0?d.jsx("div",{className:"space-y-4",children:e.firewallStatus.map(i=>d.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[a(i.status),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:i.name}),d.jsx("p",{className:"text-xs text-gray-500",children:i.responseTime?`Temps de rponse: ${i.responseTime}ms`:"Non disponible"})]})]}),d.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${i.status==="online"?"bg-green-100 text-green-800":i.status==="offline"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})]},i.id))}):d.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucun pare-feu configur"})]})]})]})};let BM={data:""},zM=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||BM,UM=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,HM=/\/\*[^]*?\*\/|  +/g,fv=/\n+/g,ci=(e,t)=>{let r="",n="",a="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?ci(o,i):i+"{"+ci(o,i[1]=="k"?"":t)+"}":typeof o=="object"?n+=ci(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=ci.p?ci.p(i,o):i+":"+o+";")}return r+(t&&a?t+"{"+a+"}":a)+n},Aa={},Sk=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Sk(e[r]);return t}return e},VM=(e,t,r,n,a)=>{let i=Sk(e),o=Aa[i]||(Aa[i]=(u=>{let f=0,h=11;for(;f<u.length;)h=101*h+u.charCodeAt(f++)>>>0;return"go"+h})(i));if(!Aa[o]){let u=i!==e?e:(f=>{let h,m,g=[{}];for(;h=UM.exec(f.replace(HM,""));)h[4]?g.shift():h[3]?(m=h[3].replace(fv," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][h[1]]=h[2].replace(fv," ").trim();return g[0]})(e);Aa[o]=ci(a?{["@keyframes "+o]:u}:u,r?"":"."+o)}let l=r&&Aa.g?Aa.g:null;return r&&(Aa.g=Aa[o]),((u,f,h,m)=>{m?f.data=f.data.replace(m,u):f.data.indexOf(u)===-1&&(f.data=h?u+f.data:f.data+u)})(Aa[o],t,n,l),o},$M=(e,t,r)=>e.reduce((n,a,i)=>{let o=t[i];if(o&&o.call){let l=o(r),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":ci(l,""):l===!1?"":l}return n+a+(o??"")},"");function n0(e){let t=this||{},r=e.call?e(t.p):e;return VM(r.unshift?r.raw?$M(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,zM(t.target),t.g,t.o,t.k)}let Tk,Ih,Dh;n0.bind({g:1});let Ga=n0.bind({k:1});function WM(e,t,r,n){ci.p=t,Tk=e,Ih=r,Dh=n}function Mi(e,t){let r=this||{};return function(){let n=arguments;function a(i,o){let l=Object.assign({},i),u=l.className||a.className;r.p=Object.assign({theme:Ih&&Ih()},l),r.o=/ *go\d+/.test(u),l.className=n0.apply(r,n)+(u?" "+u:"");let f=e;return e[0]&&(f=l.as||e,delete l.as),Dh&&f[0]&&Dh(l),Tk(f,l)}return a}}var ZM=e=>typeof e=="function",Tf=(e,t)=>ZM(e)?e(t):e,GM=(()=>{let e=0;return()=>(++e).toString()})(),Ck=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),XM=20,bk=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,XM)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return bk(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Pu=[],Ji={toasts:[],pausedAt:void 0},Es=e=>{Ji=bk(Ji,e),Pu.forEach(t=>{t(Ji)})},qM={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},KM=(e={})=>{let[t,r]=C.useState(Ji),n=C.useRef(Ji);C.useEffect(()=>(n.current!==Ji&&r(Ji),Pu.push(r),()=>{let i=Pu.indexOf(r);i>-1&&Pu.splice(i,1)}),[]);let a=t.toasts.map(i=>{var o,l,u;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((o=e[i.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((l=e[i.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||qM[i.type],style:{...e.style,...(u=e[i.type])==null?void 0:u.style,...i.style}}});return{...t,toasts:a}},YM=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||GM()}),wc=e=>(t,r)=>{let n=YM(t,e,r);return Es({type:2,toast:n}),n.id},$r=(e,t)=>wc("blank")(e,t);$r.error=wc("error");$r.success=wc("success");$r.loading=wc("loading");$r.custom=wc("custom");$r.dismiss=e=>{Es({type:3,toastId:e})};$r.remove=e=>Es({type:4,toastId:e});$r.promise=(e,t,r)=>{let n=$r.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?Tf(t.success,a):void 0;return i?$r.success(i,{id:n,...r,...r==null?void 0:r.success}):$r.dismiss(n),a}).catch(a=>{let i=t.error?Tf(t.error,a):void 0;i?$r.error(i,{id:n,...r,...r==null?void 0:r.error}):$r.dismiss(n)}),e};var JM=(e,t)=>{Es({type:1,toast:{id:e,height:t}})},QM=()=>{Es({type:5,time:Date.now()})},Al=new Map,eI=1e3,tI=(e,t=eI)=>{if(Al.has(e))return;let r=setTimeout(()=>{Al.delete(e),Es({type:4,toastId:e})},t);Al.set(e,r)},rI=e=>{let{toasts:t,pausedAt:r}=KM(e);C.useEffect(()=>{if(r)return;let i=Date.now(),o=t.map(l=>{if(l.duration===1/0)return;let u=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(u<0){l.visible&&$r.dismiss(l.id);return}return setTimeout(()=>$r.dismiss(l.id),u)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[t,r]);let n=C.useCallback(()=>{r&&Es({type:6,time:Date.now()})},[r]),a=C.useCallback((i,o)=>{let{reverseOrder:l=!1,gutter:u=8,defaultPosition:f}=o||{},h=t.filter(x=>(x.position||f)===(i.position||f)&&x.height),m=h.findIndex(x=>x.id===i.id),g=h.filter((x,_)=>_<m&&x.visible).length;return h.filter(x=>x.visible).slice(...l?[g+1]:[0,g]).reduce((x,_)=>x+(_.height||0)+u,0)},[t]);return C.useEffect(()=>{t.forEach(i=>{if(i.dismissed)tI(i.id,i.removeDelay);else{let o=Al.get(i.id);o&&(clearTimeout(o),Al.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:JM,startPause:QM,endPause:n,calculateOffset:a}}},nI=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,aI=Ga`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iI=Ga`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,sI=Mi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${nI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${aI} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${iI} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,oI=Ga`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,lI=Mi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${oI} 1s linear infinite;
`,cI=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,uI=Ga`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,fI=Mi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${uI} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,dI=Mi("div")`
  position: absolute;
`,hI=Mi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,pI=Ga`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,mI=Mi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${pI} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gI=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?C.createElement(mI,null,t):t:r==="blank"?null:C.createElement(hI,null,C.createElement(lI,{...n}),r!=="loading"&&C.createElement(dI,null,r==="error"?C.createElement(sI,{...n}):C.createElement(fI,{...n})))},xI=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,vI=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,_I="0%{opacity:0;} 100%{opacity:1;}",yI="0%{opacity:1;} 100%{opacity:0;}",wI=Mi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,kI=Mi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,EI=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=Ck()?[_I,yI]:[xI(r),vI(r)];return{animation:t?`${Ga(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ga(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},SI=C.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?EI(e.position||t||"top-center",e.visible):{opacity:0},i=C.createElement(gI,{toast:e}),o=C.createElement(kI,{...e.ariaProps},Tf(e.message,e));return C.createElement(wI,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:o}):C.createElement(C.Fragment,null,i,o))});WM(C.createElement);var TI=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=C.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(e,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return C.createElement("div",{ref:i,className:t,style:r},a)},CI=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Ck()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},bI=n0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,pu=16,NI=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:u}=rI(r);return C.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:pu,left:pu,right:pu,bottom:pu,pointerEvents:"none",...i},className:o,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(f=>{let h=f.position||t,m=u.calculateOffset(f,{reverseOrder:e,gutter:n,defaultPosition:t}),g=CI(h,m);return C.createElement(TI,{id:f.id,key:f.id,onHeightUpdate:u.updateHeight,className:f.visible?bI:"",style:g},f.type==="custom"?Tf(f.message,f):a?a(f):C.createElement(SI,{toast:f,position:h}))}))};const AI=()=>localStorage.getItem("token"),ai=We.create({baseURL:ta});ai.interceptors.request.use(e=>{const t=AI();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));ai.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function LI(){_a();const[e,t]=C.useState(!1),[r,n]=C.useState(null),[a,i]=C.useState(null),[o,l]=C.useState([]),[u,f]=C.useState([]),[h,m]=C.useState([]),[g,x]=C.useState(""),[_,y]=C.useState("");C.useEffect(()=>{(async()=>{try{t(!0),n(null);const O=await ai.get("/datacenters/hierarchy/");m(O.data)}catch(O){console.error("Error fetching hierarchy:",O),n("Failed to fetch hierarchy data")}finally{t(!1)}})()},[]),C.useEffect(()=>{(async()=>{try{const O=await ai.get("/daily-check/daily-checks/");f(O.data.results||[])}catch(O){console.error("Error fetching daily checks:",O),f([])}})()},[]);const S=()=>{if(!g)return[];const M=h.find(O=>O.id===g);return M?M.firewall_types:[]},k=()=>{if(!_)return[];const M=h.find(G=>G.id===g);if(!M)return[];const O=M.firewall_types.find(G=>G.id===_);return O?O.firewalls:[]},E=M=>{const O=M.target.value;x(O),y(""),l([])},w=M=>{const O=M.target.value;y(O),l([])},F=()=>{const M=k();o.length===M.length?l([]):l(M.map(O=>O.id))},j=M=>{l(O=>O.includes(M)?O.filter(G=>G!==M):[...O,M])},D=async()=>{if(!o.length){n("Please select at least one firewall");return}t(!0),n(null),i(null);try{const M=await Promise.all(o.map(async H=>{try{const W=await ai.post("/daily-check/daily-checks/",{firewall:H}),fe=await ai.post(`/daily-check/daily-checks/${W.data.id}/run_commands/`);return{success:!0,firewall:H,reportUrl:fe.data.report_url}}catch(W){return console.error(`Error running daily check for firewall ${H}:`,W),{success:!1,firewall:H,error:W}}})),O=M.filter(H=>H.success),G=M.filter(H=>!H.success);if(O.length>0){i(`${O.length} daily checks completed successfully`);const H=await ai.get("/daily-check/daily-checks/");f(H.data.results||[])}G.length>0&&n(`Failed to run daily check for ${G.length} firewalls`)}catch(M){console.error("Error during daily check:",M),n("Failed to run daily checks")}finally{t(!1)}},A=async M=>{try{const O=await ai.get(`/daily-check/daily-checks/${M}/download_report/`,{responseType:"blob"}),G=new Blob([O.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),H=window.URL.createObjectURL(G),W=document.createElement("a");W.href=H;const fe=O.headers["content-disposition"];let Se="daily_check_report.xlsx";if(fe){const le=fe.match(/filename="(.+)"/);le&&(Se=le[1])}W.setAttribute("download",Se),document.body.appendChild(W),W.click(),document.body.removeChild(W),window.URL.revokeObjectURL(H)}catch(O){console.error("Error downloading report:",O),$r.error("Failed to download report")}};return e?d.jsx("div",{className:"p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),d.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):d.jsxs("div",{className:"p-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Daily Check"}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(Co,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),d.jsxs("select",{value:g,onChange:E,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"",children:"All data centers"}),h.map(M=>d.jsx("option",{value:M.id,children:M.name},M.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(Ni,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),d.jsxs("select",{value:_,onChange:w,disabled:!g,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${g?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall type"}),S().map(M=>d.jsx("option",{value:M.id,children:M.name},M.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(bo,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),d.jsxs("div",{className:"mt-1 space-y-2",children:[d.jsx("button",{onClick:F,disabled:!_,className:`w-full px-3 py-1 text-sm rounded-md ${o.length===k().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${_?"":"opacity-50 cursor-not-allowed"}`,children:o.length===k().length?"Deselect All":"Select All"}),d.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:k().map(M=>d.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${o.includes(M.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>j(M.id),children:[d.jsx("input",{type:"checkbox",checked:o.includes(M.id),onChange:()=>j(M.id),className:"mr-2"}),d.jsxs("span",{className:"text-sm",children:[M.name," - ",M.ip_address]})]},M.id))})]})]})]})]})}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[r&&d.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md mb-4",children:r}),a&&d.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md mb-4",children:a}),d.jsx("div",{className:"flex space-x-4",children:d.jsxs("button",{onClick:D,disabled:e||!o.length,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[d.jsx($p,{className:"h-5 w-5 mr-2"}),e?"Running...":"Run Daily Check"]})})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Daily Checks History"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Firewall"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(M=>d.jsxs("tr",{children:[d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.firewall.name}),d.jsx("div",{className:"text-sm text-gray-500",children:M.firewall.ip_address})]}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-gray-900",children:new Date(M.check_date).toLocaleString()})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M.status==="SUCCESS"?"bg-green-100 text-green-800":M.status==="FAILED"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:M.status})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:M.excel_report&&d.jsxs("button",{onClick:()=>A(M.id),className:"text-purple-600 hover:text-purple-900 flex items-center",children:[d.jsx(f2,{className:"h-4 w-4 mr-1"}),"Download Report"]})})]},M.id))})]})})]})]})}const ln=({children:e})=>localStorage.getItem("token")?d.jsx(d.Fragment,{children:e}):d.jsx(G4,{to:"/login"}),cn=({children:e})=>{const[t,r]=C.useState(!1),n=_a(),a=async()=>{try{await rn.post("/auth/logout/")}catch(i){console.error("Logout error:",i)}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),delete rn.defaults.headers.common.Authorization,n("/login")}};return t?d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-900"})}):d.jsxs("div",{className:"flex h-screen bg-gray-100",children:[d.jsx(Cb,{onLogout:a}),d.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:d.jsx("main",{className:"flex-1 overflow-y-auto",children:e})})]})},FI=()=>{const[e,t]=C.useState(!1),r=_a();return C.useEffect(()=>{rb(r)},[r]),C.useEffect(()=>{const n=localStorage.getItem("token"),a=localStorage.getItem("refreshToken");n&&a&&(t(!0),rn.defaults.headers.common.Authorization=`Bearer ${n}`)},[]),d.jsxs(q4,{children:[d.jsx(Lr,{path:"/login",element:d.jsx(wb,{onLogin:()=>t(!0)})}),d.jsx(Lr,{path:"/register",element:d.jsx(Tb,{onRegister:()=>t(!0)})}),d.jsx(Lr,{path:"/",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(uv,{})})})}),d.jsx(Lr,{path:"/dashboard",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(uv,{})})})}),d.jsx(Lr,{path:"/firewalls",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(VO,{})})})}),d.jsx(Lr,{path:"/profile",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(IM,{})})})}),d.jsx(Lr,{path:"/templates",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(_d,{})})})}),d.jsx(Lr,{path:"/templates/new",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(_d,{})})})}),d.jsx(Lr,{path:"/templates/:id",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(_d,{})})})}),d.jsx(Lr,{path:"/config",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(UO,{})})})}),d.jsx(Lr,{path:"/matrix",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(BO,{})})})}),d.jsx(Lr,{path:"/map",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(AR,{})})})}),d.jsx(Lr,{path:"/settings",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(HO,{})})})}),d.jsx(Lr,{path:"/history",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(DM,{})})})}),d.jsx(Lr,{path:"/daily-check",element:d.jsx(ln,{children:d.jsx(cn,{children:d.jsx(LI,{})})})})]})};function PI(){return d.jsxs(Z4,{children:[d.jsx(NI,{position:"top-right"}),d.jsx(tR,{children:d.jsx(FI,{})})]})}window.__REACT_DEVTOOLS_GLOBAL_HOOK__={isDisabled:!0};yd.createRoot(document.getElementById("root")).render(d.jsx(Pn.StrictMode,{children:d.jsx(PI,{})}));
