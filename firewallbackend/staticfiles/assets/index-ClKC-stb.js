(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var bi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Cf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var fv={exports:{}},bf={},dv={exports:{}},ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ic=Symbol.for("react.element"),gE=Symbol.for("react.portal"),xE=Symbol.for("react.fragment"),vE=Symbol.for("react.strict_mode"),_E=Symbol.for("react.profiler"),yE=Symbol.for("react.provider"),wE=Symbol.for("react.context"),kE=Symbol.for("react.forward_ref"),EE=Symbol.for("react.suspense"),SE=Symbol.for("react.memo"),TE=Symbol.for("react.lazy"),hg=Symbol.iterator;function CE(e){return e===null||typeof e!="object"?null:(e=hg&&e[hg]||e["@@iterator"],typeof e=="function"?e:null)}var hv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pv=Object.assign,mv={};function So(e,t,r){this.props=e,this.context=t,this.refs=mv,this.updater=r||hv}So.prototype.isReactComponent={};So.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};So.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gv(){}gv.prototype=So.prototype;function jh(e,t,r){this.props=e,this.context=t,this.refs=mv,this.updater=r||hv}var Bh=jh.prototype=new gv;Bh.constructor=jh;pv(Bh,So.prototype);Bh.isPureReactComponent=!0;var pg=Array.isArray,xv=Object.prototype.hasOwnProperty,zh={current:null},vv={key:!0,ref:!0,__self:!0,__source:!0};function _v(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)xv.call(t,n)&&!vv.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var u=Array(l),f=0;f<l;f++)u[f]=arguments[f+2];a.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:ic,type:e,key:i,ref:o,props:a,_owner:zh.current}}function bE(e,t){return{$$typeof:ic,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Uh(e){return typeof e=="object"&&e!==null&&e.$$typeof===ic}function AE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var mg=/\/+/g;function A0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?AE(""+e.key):t.toString(36)}function gu(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ic:case gE:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+A0(o,0):n,pg(a)?(r="",e!=null&&(r=e.replace(mg,"$&/")+"/"),gu(a,t,r,"",function(f){return f})):a!=null&&(Uh(a)&&(a=bE(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(mg,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",pg(e))for(var l=0;l<e.length;l++){i=e[l];var u=n+A0(i,l);o+=gu(i,t,r,u,a)}else if(u=CE(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=n+A0(i,l++),o+=gu(i,t,r,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Hc(e,t,r){if(e==null)return e;var n=[],a=0;return gu(e,n,"","",function(i){return t.call(r,i,a++)}),n}function NE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jr={current:null},xu={transition:null},LE={ReactCurrentDispatcher:Jr,ReactCurrentBatchConfig:xu,ReactCurrentOwner:zh};function yv(){throw Error("act(...) is not supported in production builds of React.")}ht.Children={map:Hc,forEach:function(e,t,r){Hc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Hc(e,function(){t++}),t},toArray:function(e){return Hc(e,function(t){return t})||[]},only:function(e){if(!Uh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ht.Component=So;ht.Fragment=xE;ht.Profiler=_E;ht.PureComponent=jh;ht.StrictMode=vE;ht.Suspense=EE;ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LE;ht.act=yv;ht.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=pv({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=zh.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)xv.call(t,u)&&!vv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var f=0;f<u;f++)l[f]=arguments[f+2];n.children=l}return{$$typeof:ic,type:e.type,key:a,ref:i,props:n,_owner:o}};ht.createContext=function(e){return e={$$typeof:wE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:yE,_context:e},e.Consumer=e};ht.createElement=_v;ht.createFactory=function(e){var t=_v.bind(null,e);return t.type=e,t};ht.createRef=function(){return{current:null}};ht.forwardRef=function(e){return{$$typeof:kE,render:e}};ht.isValidElement=Uh;ht.lazy=function(e){return{$$typeof:TE,_payload:{_status:-1,_result:e},_init:NE}};ht.memo=function(e,t){return{$$typeof:SE,type:e,compare:t===void 0?null:t}};ht.startTransition=function(e){var t=xu.transition;xu.transition={};try{e()}finally{xu.transition=t}};ht.unstable_act=yv;ht.useCallback=function(e,t){return Jr.current.useCallback(e,t)};ht.useContext=function(e){return Jr.current.useContext(e)};ht.useDebugValue=function(){};ht.useDeferredValue=function(e){return Jr.current.useDeferredValue(e)};ht.useEffect=function(e,t){return Jr.current.useEffect(e,t)};ht.useId=function(){return Jr.current.useId()};ht.useImperativeHandle=function(e,t,r){return Jr.current.useImperativeHandle(e,t,r)};ht.useInsertionEffect=function(e,t){return Jr.current.useInsertionEffect(e,t)};ht.useLayoutEffect=function(e,t){return Jr.current.useLayoutEffect(e,t)};ht.useMemo=function(e,t){return Jr.current.useMemo(e,t)};ht.useReducer=function(e,t,r){return Jr.current.useReducer(e,t,r)};ht.useRef=function(e){return Jr.current.useRef(e)};ht.useState=function(e){return Jr.current.useState(e)};ht.useSyncExternalStore=function(e,t,r){return Jr.current.useSyncExternalStore(e,t,r)};ht.useTransition=function(){return Jr.current.useTransition()};ht.version="18.3.1";dv.exports=ht;var A=dv.exports;const ho=uv(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PE=A,FE=Symbol.for("react.element"),OE=Symbol.for("react.fragment"),ME=Object.prototype.hasOwnProperty,RE=PE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DE={key:!0,ref:!0,__self:!0,__source:!0};function wv(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)ME.call(t,n)&&!DE.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:FE,type:e,key:i,ref:o,props:a,_owner:RE.current}}bf.Fragment=OE;bf.jsx=wv;bf.jsxs=wv;fv.exports=bf;var p=fv.exports,xd={},kv={exports:{}},vn={},Ev={exports:{}},Sv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ae,Y){var se=ae.length;ae.push(Y);e:for(;0<se;){var ye=se-1>>>1,R=ae[ye];if(0<a(R,Y))ae[ye]=Y,ae[se]=R,se=ye;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var Y=ae[0],se=ae.pop();if(se!==Y){ae[0]=se;e:for(var ye=0,R=ae.length,J=R>>>1;ye<J;){var q=2*(ye+1)-1,Z=ae[q],ne=q+1,we=ae[ne];if(0>a(Z,se))ne<R&&0>a(we,Z)?(ae[ye]=we,ae[ne]=se,ye=ne):(ae[ye]=Z,ae[q]=se,ye=q);else if(ne<R&&0>a(we,se))ae[ye]=we,ae[ne]=se,ye=ne;else break e}}return Y}function a(ae,Y){var se=ae.sortIndex-Y.sortIndex;return se!==0?se:ae.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],f=[],d=1,m=null,g=3,v=!1,y=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(ae){for(var Y=r(f);Y!==null;){if(Y.callback===null)n(f);else if(Y.startTime<=ae)n(f),Y.sortIndex=Y.expirationTime,t(u,Y);else break;Y=r(f)}}function N(ae){if(_=!1,w(ae),!y)if(r(u)!==null)y=!0,he(I);else{var Y=r(f);Y!==null&&me(N,Y.startTime-ae)}}function I(ae,Y){y=!1,_&&(_=!1,k(V),V=-1),v=!0;var se=g;try{for(w(Y),m=r(u);m!==null&&(!(m.expirationTime>Y)||ae&&!B());){var ye=m.callback;if(typeof ye=="function"){m.callback=null,g=m.priorityLevel;var R=ye(m.expirationTime<=Y);Y=e.unstable_now(),typeof R=="function"?m.callback=R:m===r(u)&&n(u),w(Y)}else n(u);m=r(u)}if(m!==null)var J=!0;else{var q=r(f);q!==null&&me(N,q.startTime-Y),J=!1}return J}finally{m=null,g=se,v=!1}}var D=!1,P=null,V=-1,z=5,W=-1;function B(){return!(e.unstable_now()-W<z)}function G(){if(P!==null){var ae=e.unstable_now();W=ae;var Y=!0;try{Y=P(!0,ae)}finally{Y?K():(D=!1,P=null)}}else D=!1}var K;if(typeof E=="function")K=function(){E(G)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,xe=ve.port2;ve.port1.onmessage=G,K=function(){xe.postMessage(null)}}else K=function(){S(G,0)};function he(ae){P=ae,D||(D=!0,K())}function me(ae,Y){V=S(function(){ae(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,he(I))},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(ae){switch(g){case 1:case 2:case 3:var Y=3;break;default:Y=g}var se=g;g=Y;try{return ae()}finally{g=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ae,Y){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var se=g;g=ae;try{return Y()}finally{g=se}},e.unstable_scheduleCallback=function(ae,Y,se){var ye=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ye+se:ye):se=ye,ae){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=se+R,ae={id:d++,callback:Y,priorityLevel:ae,startTime:se,expirationTime:R,sortIndex:-1},se>ye?(ae.sortIndex=se,t(f,ae),r(u)===null&&ae===r(f)&&(_?(k(V),V=-1):_=!0,me(N,se-ye))):(ae.sortIndex=R,t(u,ae),y||v||(y=!0,he(I))),ae},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(ae){var Y=g;return function(){var se=g;g=Y;try{return ae.apply(this,arguments)}finally{g=se}}}})(Sv);Ev.exports=Sv;var IE=Ev.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jE=A,gn=IE;function Te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Tv=new Set,Fl={};function gs(e,t){po(e,t),po(e+"Capture",t)}function po(e,t){for(Fl[e]=t,e=0;e<t.length;e++)Tv.add(t[e])}var $a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vd=Object.prototype.hasOwnProperty,BE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gg={},xg={};function zE(e){return vd.call(xg,e)?!0:vd.call(gg,e)?!1:BE.test(e)?xg[e]=!0:(gg[e]=!0,!1)}function UE(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function HE(e,t,r,n){if(t===null||typeof t>"u"||UE(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qr(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Ar={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ar[e]=new Qr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ar[t]=new Qr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ar[e]=new Qr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ar[e]=new Qr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ar[e]=new Qr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ar[e]=new Qr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ar[e]=new Qr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ar[e]=new Qr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ar[e]=new Qr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hh=/[\-:]([a-z])/g;function Vh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hh,Vh);Ar[t]=new Qr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hh,Vh);Ar[t]=new Qr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hh,Vh);Ar[t]=new Qr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ar[e]=new Qr(e,1,!1,e.toLowerCase(),null,!1,!1)});Ar.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ar[e]=new Qr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wh(e,t,r,n){var a=Ar.hasOwnProperty(t)?Ar[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(HE(t,r,a,n)&&(r=null),n||a===null?zE(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ja=jE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vc=Symbol.for("react.element"),zs=Symbol.for("react.portal"),Us=Symbol.for("react.fragment"),$h=Symbol.for("react.strict_mode"),_d=Symbol.for("react.profiler"),Cv=Symbol.for("react.provider"),bv=Symbol.for("react.context"),Gh=Symbol.for("react.forward_ref"),yd=Symbol.for("react.suspense"),wd=Symbol.for("react.suspense_list"),Zh=Symbol.for("react.memo"),oi=Symbol.for("react.lazy"),Av=Symbol.for("react.offscreen"),vg=Symbol.iterator;function Zo(e){return e===null||typeof e!="object"?null:(e=vg&&e[vg]||e["@@iterator"],typeof e=="function"?e:null)}var Zt=Object.assign,N0;function al(e){if(N0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);N0=t&&t[1]||""}return`
`+N0+e}var L0=!1;function P0(e,t){if(!e||L0)return"";L0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var a=f.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var u=`
`+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{L0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?al(e):""}function VE(e){switch(e.tag){case 5:return al(e.type);case 16:return al("Lazy");case 13:return al("Suspense");case 19:return al("SuspenseList");case 0:case 2:case 15:return e=P0(e.type,!1),e;case 11:return e=P0(e.type.render,!1),e;case 1:return e=P0(e.type,!0),e;default:return""}}function kd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Us:return"Fragment";case zs:return"Portal";case _d:return"Profiler";case $h:return"StrictMode";case yd:return"Suspense";case wd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bv:return(e.displayName||"Context")+".Consumer";case Cv:return(e._context.displayName||"Context")+".Provider";case Gh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Zh:return t=e.displayName||null,t!==null?t:kd(e.type)||"Memo";case oi:t=e._payload,e=e._init;try{return kd(e(t))}catch{}}return null}function WE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kd(t);case 8:return t===$h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ai(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Nv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $E(e){var t=Nv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wc(e){e._valueTracker||(e._valueTracker=$E(e))}function Lv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Nv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Mu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ed(e,t){var r=t.checked;return Zt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function _g(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ai(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Pv(e,t){t=t.checked,t!=null&&Wh(e,"checked",t,!1)}function Sd(e,t){Pv(e,t);var r=Ai(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Td(e,t.type,r):t.hasOwnProperty("defaultValue")&&Td(e,t.type,Ai(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function yg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Td(e,t,r){(t!=="number"||Mu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var il=Array.isArray;function ro(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ai(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Cd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Te(91));return Zt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function wg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Te(92));if(il(r)){if(1<r.length)throw Error(Te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ai(r)}}function Fv(e,t){var r=Ai(t.value),n=Ai(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function kg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ov(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ov(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $c,Mv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for($c=$c||document.createElement("div"),$c.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=$c.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ol(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var hl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GE=["Webkit","ms","Moz","O"];Object.keys(hl).forEach(function(e){GE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hl[t]=hl[e]})});function Rv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||hl.hasOwnProperty(e)&&hl[e]?(""+t).trim():t+"px"}function Dv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Rv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var ZE=Zt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ad(e,t){if(t){if(ZE[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Te(62))}}function Nd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ld=null;function Xh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pd=null,no=null,ao=null;function Eg(e){if(e=lc(e)){if(typeof Pd!="function")throw Error(Te(280));var t=e.stateNode;t&&(t=Ff(t),Pd(e.stateNode,e.type,t))}}function Iv(e){no?ao?ao.push(e):ao=[e]:no=e}function jv(){if(no){var e=no,t=ao;if(ao=no=null,Eg(e),t)for(e=0;e<t.length;e++)Eg(t[e])}}function Bv(e,t){return e(t)}function zv(){}var F0=!1;function Uv(e,t,r){if(F0)return e(t,r);F0=!0;try{return Bv(e,t,r)}finally{F0=!1,(no!==null||ao!==null)&&(zv(),jv())}}function Ml(e,t){var r=e.stateNode;if(r===null)return null;var n=Ff(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Te(231,t,typeof r));return r}var Fd=!1;if($a)try{var Xo={};Object.defineProperty(Xo,"passive",{get:function(){Fd=!0}}),window.addEventListener("test",Xo,Xo),window.removeEventListener("test",Xo,Xo)}catch{Fd=!1}function XE(e,t,r,n,a,i,o,l,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var pl=!1,Ru=null,Du=!1,Od=null,qE={onError:function(e){pl=!0,Ru=e}};function YE(e,t,r,n,a,i,o,l,u){pl=!1,Ru=null,XE.apply(qE,arguments)}function KE(e,t,r,n,a,i,o,l,u){if(YE.apply(this,arguments),pl){if(pl){var f=Ru;pl=!1,Ru=null}else throw Error(Te(198));Du||(Du=!0,Od=f)}}function xs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Hv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Sg(e){if(xs(e)!==e)throw Error(Te(188))}function JE(e){var t=e.alternate;if(!t){if(t=xs(e),t===null)throw Error(Te(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Sg(a),e;if(i===n)return Sg(a),t;i=i.sibling}throw Error(Te(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(Te(189))}}if(r.alternate!==n)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?e:t}function Vv(e){return e=JE(e),e!==null?Wv(e):null}function Wv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Wv(e);if(t!==null)return t;e=e.sibling}return null}var $v=gn.unstable_scheduleCallback,Tg=gn.unstable_cancelCallback,QE=gn.unstable_shouldYield,eS=gn.unstable_requestPaint,tr=gn.unstable_now,tS=gn.unstable_getCurrentPriorityLevel,qh=gn.unstable_ImmediatePriority,Gv=gn.unstable_UserBlockingPriority,Iu=gn.unstable_NormalPriority,rS=gn.unstable_LowPriority,Zv=gn.unstable_IdlePriority,Af=null,_a=null;function nS(e){if(_a&&typeof _a.onCommitFiberRoot=="function")try{_a.onCommitFiberRoot(Af,e,void 0,(e.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:sS,aS=Math.log,iS=Math.LN2;function sS(e){return e>>>=0,e===0?32:31-(aS(e)/iS|0)|0}var Gc=64,Zc=4194304;function sl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ju(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=sl(l):(i&=o,i!==0&&(n=sl(i)))}else o=r&~a,o!==0?n=sl(o):i!==0&&(n=sl(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Kn(t),a=1<<r,n|=e[r],t&=~a;return n}function oS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Kn(i),l=1<<o,u=a[o];u===-1?(!(l&r)||l&n)&&(a[o]=oS(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function Md(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Xv(){var e=Gc;return Gc<<=1,!(Gc&4194240)&&(Gc=64),e}function O0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function sc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Kn(t),e[t]=r}function cS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Kn(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Yh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Kn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Lt=0;function qv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Yv,Kh,Kv,Jv,Qv,Rd=!1,Xc=[],vi=null,_i=null,yi=null,Rl=new Map,Dl=new Map,ci=[],uS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cg(e,t){switch(e){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Rl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dl.delete(t.pointerId)}}function qo(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=lc(t),t!==null&&Kh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function fS(e,t,r,n,a){switch(t){case"focusin":return vi=qo(vi,e,t,r,n,a),!0;case"dragenter":return _i=qo(_i,e,t,r,n,a),!0;case"mouseover":return yi=qo(yi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Rl.set(i,qo(Rl.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Dl.set(i,qo(Dl.get(i)||null,e,t,r,n,a)),!0}return!1}function e_(e){var t=qi(e.target);if(t!==null){var r=xs(t);if(r!==null){if(t=r.tag,t===13){if(t=Hv(r),t!==null){e.blockedOn=t,Qv(e.priority,function(){Kv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Dd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ld=n,r.target.dispatchEvent(n),Ld=null}else return t=lc(r),t!==null&&Kh(t),e.blockedOn=r,!1;t.shift()}return!0}function bg(e,t,r){vu(e)&&r.delete(t)}function dS(){Rd=!1,vi!==null&&vu(vi)&&(vi=null),_i!==null&&vu(_i)&&(_i=null),yi!==null&&vu(yi)&&(yi=null),Rl.forEach(bg),Dl.forEach(bg)}function Yo(e,t){e.blockedOn===t&&(e.blockedOn=null,Rd||(Rd=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,dS)))}function Il(e){function t(a){return Yo(a,e)}if(0<Xc.length){Yo(Xc[0],e);for(var r=1;r<Xc.length;r++){var n=Xc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(vi!==null&&Yo(vi,e),_i!==null&&Yo(_i,e),yi!==null&&Yo(yi,e),Rl.forEach(t),Dl.forEach(t),r=0;r<ci.length;r++)n=ci[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ci.length&&(r=ci[0],r.blockedOn===null);)e_(r),r.blockedOn===null&&ci.shift()}var io=Ja.ReactCurrentBatchConfig,Bu=!0;function hS(e,t,r,n){var a=Lt,i=io.transition;io.transition=null;try{Lt=1,Jh(e,t,r,n)}finally{Lt=a,io.transition=i}}function pS(e,t,r,n){var a=Lt,i=io.transition;io.transition=null;try{Lt=4,Jh(e,t,r,n)}finally{Lt=a,io.transition=i}}function Jh(e,t,r,n){if(Bu){var a=Dd(e,t,r,n);if(a===null)V0(e,t,n,zu,r),Cg(e,n);else if(fS(a,e,t,r,n))n.stopPropagation();else if(Cg(e,n),t&4&&-1<uS.indexOf(e)){for(;a!==null;){var i=lc(a);if(i!==null&&Yv(i),i=Dd(e,t,r,n),i===null&&V0(e,t,n,zu,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else V0(e,t,n,null,r)}}var zu=null;function Dd(e,t,r,n){if(zu=null,e=Xh(n),e=qi(e),e!==null)if(t=xs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Hv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return zu=e,null}function t_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tS()){case qh:return 1;case Gv:return 4;case Iu:case rS:return 16;case Zv:return 536870912;default:return 16}default:return 16}}var pi=null,Qh=null,_u=null;function r_(){if(_u)return _u;var e,t=Qh,r=t.length,n,a="value"in pi?pi.value:pi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return _u=a.slice(e,1<n?1-n:void 0)}function yu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function qc(){return!0}function Ag(){return!1}function _n(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?qc:Ag,this.isPropagationStopped=Ag,this}return Zt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qc)},persist:function(){},isPersistent:qc}),t}var To={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ep=_n(To),oc=Zt({},To,{view:0,detail:0}),mS=_n(oc),M0,R0,Ko,Nf=Zt({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ko&&(Ko&&e.type==="mousemove"?(M0=e.screenX-Ko.screenX,R0=e.screenY-Ko.screenY):R0=M0=0,Ko=e),M0)},movementY:function(e){return"movementY"in e?e.movementY:R0}}),Ng=_n(Nf),gS=Zt({},Nf,{dataTransfer:0}),xS=_n(gS),vS=Zt({},oc,{relatedTarget:0}),D0=_n(vS),_S=Zt({},To,{animationName:0,elapsedTime:0,pseudoElement:0}),yS=_n(_S),wS=Zt({},To,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kS=_n(wS),ES=Zt({},To,{data:0}),Lg=_n(ES),SS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=CS[e])?!!t[e]:!1}function tp(){return bS}var AS=Zt({},oc,{key:function(e){if(e.key){var t=SS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?TS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tp,charCode:function(e){return e.type==="keypress"?yu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),NS=_n(AS),LS=Zt({},Nf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pg=_n(LS),PS=Zt({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tp}),FS=_n(PS),OS=Zt({},To,{propertyName:0,elapsedTime:0,pseudoElement:0}),MS=_n(OS),RS=Zt({},Nf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),DS=_n(RS),IS=[9,13,27,32],rp=$a&&"CompositionEvent"in window,ml=null;$a&&"documentMode"in document&&(ml=document.documentMode);var jS=$a&&"TextEvent"in window&&!ml,n_=$a&&(!rp||ml&&8<ml&&11>=ml),Fg=" ",Og=!1;function a_(e,t){switch(e){case"keyup":return IS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Hs=!1;function BS(e,t){switch(e){case"compositionend":return i_(t);case"keypress":return t.which!==32?null:(Og=!0,Fg);case"textInput":return e=t.data,e===Fg&&Og?null:e;default:return null}}function zS(e,t){if(Hs)return e==="compositionend"||!rp&&a_(e,t)?(e=r_(),_u=Qh=pi=null,Hs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return n_&&t.locale!=="ko"?null:t.data;default:return null}}var US={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!US[e.type]:t==="textarea"}function s_(e,t,r,n){Iv(n),t=Uu(t,"onChange"),0<t.length&&(r=new ep("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var gl=null,jl=null;function HS(e){x_(e,0)}function Lf(e){var t=$s(e);if(Lv(t))return e}function VS(e,t){if(e==="change")return t}var o_=!1;if($a){var I0;if($a){var j0="oninput"in document;if(!j0){var Rg=document.createElement("div");Rg.setAttribute("oninput","return;"),j0=typeof Rg.oninput=="function"}I0=j0}else I0=!1;o_=I0&&(!document.documentMode||9<document.documentMode)}function Dg(){gl&&(gl.detachEvent("onpropertychange",l_),jl=gl=null)}function l_(e){if(e.propertyName==="value"&&Lf(jl)){var t=[];s_(t,jl,e,Xh(e)),Uv(HS,t)}}function WS(e,t,r){e==="focusin"?(Dg(),gl=t,jl=r,gl.attachEvent("onpropertychange",l_)):e==="focusout"&&Dg()}function $S(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Lf(jl)}function GS(e,t){if(e==="click")return Lf(t)}function ZS(e,t){if(e==="input"||e==="change")return Lf(t)}function XS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ea=typeof Object.is=="function"?Object.is:XS;function Bl(e,t){if(ea(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!vd.call(t,a)||!ea(e[a],t[a]))return!1}return!0}function Ig(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function jg(e,t){var r=Ig(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ig(r)}}function c_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?c_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function u_(){for(var e=window,t=Mu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Mu(e.document)}return t}function np(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qS(e){var t=u_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&c_(r.ownerDocument.documentElement,r)){if(n!==null&&np(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=jg(r,i);var o=jg(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var YS=$a&&"documentMode"in document&&11>=document.documentMode,Vs=null,Id=null,xl=null,jd=!1;function Bg(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;jd||Vs==null||Vs!==Mu(n)||(n=Vs,"selectionStart"in n&&np(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),xl&&Bl(xl,n)||(xl=n,n=Uu(Id,"onSelect"),0<n.length&&(t=new ep("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Vs)))}function Yc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ws={animationend:Yc("Animation","AnimationEnd"),animationiteration:Yc("Animation","AnimationIteration"),animationstart:Yc("Animation","AnimationStart"),transitionend:Yc("Transition","TransitionEnd")},B0={},f_={};$a&&(f_=document.createElement("div").style,"AnimationEvent"in window||(delete Ws.animationend.animation,delete Ws.animationiteration.animation,delete Ws.animationstart.animation),"TransitionEvent"in window||delete Ws.transitionend.transition);function Pf(e){if(B0[e])return B0[e];if(!Ws[e])return e;var t=Ws[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in f_)return B0[e]=t[r];return e}var d_=Pf("animationend"),h_=Pf("animationiteration"),p_=Pf("animationstart"),m_=Pf("transitionend"),g_=new Map,zg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(e,t){g_.set(e,t),gs(t,[e])}for(var z0=0;z0<zg.length;z0++){var U0=zg[z0],KS=U0.toLowerCase(),JS=U0[0].toUpperCase()+U0.slice(1);Oi(KS,"on"+JS)}Oi(d_,"onAnimationEnd");Oi(h_,"onAnimationIteration");Oi(p_,"onAnimationStart");Oi("dblclick","onDoubleClick");Oi("focusin","onFocus");Oi("focusout","onBlur");Oi(m_,"onTransitionEnd");po("onMouseEnter",["mouseout","mouseover"]);po("onMouseLeave",["mouseout","mouseover"]);po("onPointerEnter",["pointerout","pointerover"]);po("onPointerLeave",["pointerout","pointerover"]);gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function Ug(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,KE(n,t,void 0,e),e.currentTarget=null}function x_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,f=l.currentTarget;if(l=l.listener,u!==i&&a.isPropagationStopped())break e;Ug(a,l,f),i=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,f=l.currentTarget,l=l.listener,u!==i&&a.isPropagationStopped())break e;Ug(a,l,f),i=u}}}if(Du)throw e=Od,Du=!1,Od=null,e}function Dt(e,t){var r=t[Vd];r===void 0&&(r=t[Vd]=new Set);var n=e+"__bubble";r.has(n)||(v_(t,e,2,!1),r.add(n))}function H0(e,t,r){var n=0;t&&(n|=4),v_(r,e,n,t)}var Kc="_reactListening"+Math.random().toString(36).slice(2);function zl(e){if(!e[Kc]){e[Kc]=!0,Tv.forEach(function(r){r!=="selectionchange"&&(QS.has(r)||H0(r,!1,e),H0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Kc]||(t[Kc]=!0,H0("selectionchange",!1,t))}}function v_(e,t,r,n){switch(t_(t)){case 1:var a=hS;break;case 4:a=pS;break;default:a=Jh}r=a.bind(null,t,r,e),a=void 0,!Fd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function V0(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;o=o.return}for(;l!==null;){if(o=qi(l),o===null)return;if(u=o.tag,u===5||u===6){n=i=o;continue e}l=l.parentNode}}n=n.return}Uv(function(){var f=i,d=Xh(r),m=[];e:{var g=g_.get(e);if(g!==void 0){var v=ep,y=e;switch(e){case"keypress":if(yu(r)===0)break e;case"keydown":case"keyup":v=NS;break;case"focusin":y="focus",v=D0;break;case"focusout":y="blur",v=D0;break;case"beforeblur":case"afterblur":v=D0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Ng;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=xS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=FS;break;case d_:case h_:case p_:v=yS;break;case m_:v=MS;break;case"scroll":v=mS;break;case"wheel":v=DS;break;case"copy":case"cut":case"paste":v=kS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Pg}var _=(t&4)!==0,S=!_&&e==="scroll",k=_?g!==null?g+"Capture":null:g;_=[];for(var E=f,w;E!==null;){w=E;var N=w.stateNode;if(w.tag===5&&N!==null&&(w=N,k!==null&&(N=Ml(E,k),N!=null&&_.push(Ul(E,N,w)))),S)break;E=E.return}0<_.length&&(g=new v(g,y,null,r,d),m.push({event:g,listeners:_}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",g&&r!==Ld&&(y=r.relatedTarget||r.fromElement)&&(qi(y)||y[Ga]))break e;if((v||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,v?(y=r.relatedTarget||r.toElement,v=f,y=y?qi(y):null,y!==null&&(S=xs(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=f),v!==y)){if(_=Ng,N="onMouseLeave",k="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(_=Pg,N="onPointerLeave",k="onPointerEnter",E="pointer"),S=v==null?g:$s(v),w=y==null?g:$s(y),g=new _(N,E+"leave",v,r,d),g.target=S,g.relatedTarget=w,N=null,qi(d)===f&&(_=new _(k,E+"enter",y,r,d),_.target=w,_.relatedTarget=S,N=_),S=N,v&&y)t:{for(_=v,k=y,E=0,w=_;w;w=Ms(w))E++;for(w=0,N=k;N;N=Ms(N))w++;for(;0<E-w;)_=Ms(_),E--;for(;0<w-E;)k=Ms(k),w--;for(;E--;){if(_===k||k!==null&&_===k.alternate)break t;_=Ms(_),k=Ms(k)}_=null}else _=null;v!==null&&Hg(m,g,v,_,!1),y!==null&&S!==null&&Hg(m,S,y,_,!0)}}e:{if(g=f?$s(f):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var I=VS;else if(Mg(g))if(o_)I=ZS;else{I=$S;var D=WS}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(I=GS);if(I&&(I=I(e,f))){s_(m,I,r,d);break e}D&&D(e,g,f),e==="focusout"&&(D=g._wrapperState)&&D.controlled&&g.type==="number"&&Td(g,"number",g.value)}switch(D=f?$s(f):window,e){case"focusin":(Mg(D)||D.contentEditable==="true")&&(Vs=D,Id=f,xl=null);break;case"focusout":xl=Id=Vs=null;break;case"mousedown":jd=!0;break;case"contextmenu":case"mouseup":case"dragend":jd=!1,Bg(m,r,d);break;case"selectionchange":if(YS)break;case"keydown":case"keyup":Bg(m,r,d)}var P;if(rp)e:{switch(e){case"compositionstart":var V="onCompositionStart";break e;case"compositionend":V="onCompositionEnd";break e;case"compositionupdate":V="onCompositionUpdate";break e}V=void 0}else Hs?a_(e,r)&&(V="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(V="onCompositionStart");V&&(n_&&r.locale!=="ko"&&(Hs||V!=="onCompositionStart"?V==="onCompositionEnd"&&Hs&&(P=r_()):(pi=d,Qh="value"in pi?pi.value:pi.textContent,Hs=!0)),D=Uu(f,V),0<D.length&&(V=new Lg(V,e,null,r,d),m.push({event:V,listeners:D}),P?V.data=P:(P=i_(r),P!==null&&(V.data=P)))),(P=jS?BS(e,r):zS(e,r))&&(f=Uu(f,"onBeforeInput"),0<f.length&&(d=new Lg("onBeforeInput","beforeinput",null,r,d),m.push({event:d,listeners:f}),d.data=P))}x_(m,t)})}function Ul(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Uu(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ml(e,r),i!=null&&n.unshift(Ul(e,i,a)),i=Ml(e,t),i!=null&&n.push(Ul(e,i,a))),e=e.return}return n}function Ms(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Hg(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,f=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&f!==null&&(l=f,a?(u=Ml(r,i),u!=null&&o.unshift(Ul(r,u,l))):a||(u=Ml(r,i),u!=null&&o.push(Ul(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var eT=/\r\n?/g,tT=/\u0000|\uFFFD/g;function Vg(e){return(typeof e=="string"?e:""+e).replace(eT,`
`).replace(tT,"")}function Jc(e,t,r){if(t=Vg(t),Vg(e)!==t&&r)throw Error(Te(425))}function Hu(){}var Bd=null,zd=null;function Ud(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Hd=typeof setTimeout=="function"?setTimeout:void 0,rT=typeof clearTimeout=="function"?clearTimeout:void 0,Wg=typeof Promise=="function"?Promise:void 0,nT=typeof queueMicrotask=="function"?queueMicrotask:typeof Wg<"u"?function(e){return Wg.resolve(null).then(e).catch(aT)}:Hd;function aT(e){setTimeout(function(){throw e})}function W0(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Il(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Il(t)}function wi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $g(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Co=Math.random().toString(36).slice(2),ga="__reactFiber$"+Co,Hl="__reactProps$"+Co,Ga="__reactContainer$"+Co,Vd="__reactEvents$"+Co,iT="__reactListeners$"+Co,sT="__reactHandles$"+Co;function qi(e){var t=e[ga];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ga]||r[ga]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=$g(e);e!==null;){if(r=e[ga])return r;e=$g(e)}return t}e=r,r=e.parentNode}return null}function lc(e){return e=e[ga]||e[Ga],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function $s(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Te(33))}function Ff(e){return e[Hl]||null}var Wd=[],Gs=-1;function Mi(e){return{current:e}}function It(e){0>Gs||(e.current=Wd[Gs],Wd[Gs]=null,Gs--)}function Ft(e,t){Gs++,Wd[Gs]=e.current,e.current=t}var Ni={},Br=Mi(Ni),sn=Mi(!1),ss=Ni;function mo(e,t){var r=e.type.contextTypes;if(!r)return Ni;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function on(e){return e=e.childContextTypes,e!=null}function Vu(){It(sn),It(Br)}function Gg(e,t,r){if(Br.current!==Ni)throw Error(Te(168));Ft(Br,t),Ft(sn,r)}function __(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Te(108,WE(e)||"Unknown",a));return Zt({},r,n)}function Wu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ni,ss=Br.current,Ft(Br,e),Ft(sn,sn.current),!0}function Zg(e,t,r){var n=e.stateNode;if(!n)throw Error(Te(169));r?(e=__(e,t,ss),n.__reactInternalMemoizedMergedChildContext=e,It(sn),It(Br),Ft(Br,e)):It(sn),Ft(sn,r)}var Da=null,Of=!1,$0=!1;function y_(e){Da===null?Da=[e]:Da.push(e)}function oT(e){Of=!0,y_(e)}function Ri(){if(!$0&&Da!==null){$0=!0;var e=0,t=Lt;try{var r=Da;for(Lt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Da=null,Of=!1}catch(a){throw Da!==null&&(Da=Da.slice(e+1)),$v(qh,Ri),a}finally{Lt=t,$0=!1}}return null}var Zs=[],Xs=0,$u=null,Gu=0,An=[],Nn=0,os=null,Ia=1,ja="";function Vi(e,t){Zs[Xs++]=Gu,Zs[Xs++]=$u,$u=e,Gu=t}function w_(e,t,r){An[Nn++]=Ia,An[Nn++]=ja,An[Nn++]=os,os=e;var n=Ia;e=ja;var a=32-Kn(n)-1;n&=~(1<<a),r+=1;var i=32-Kn(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Ia=1<<32-Kn(t)+a|r<<a|n,ja=i+e}else Ia=1<<i|r<<a|n,ja=e}function ap(e){e.return!==null&&(Vi(e,1),w_(e,1,0))}function ip(e){for(;e===$u;)$u=Zs[--Xs],Zs[Xs]=null,Gu=Zs[--Xs],Zs[Xs]=null;for(;e===os;)os=An[--Nn],An[Nn]=null,ja=An[--Nn],An[Nn]=null,Ia=An[--Nn],An[Nn]=null}var pn=null,hn=null,zt=!1,Zn=null;function k_(e,t){var r=Fn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Xg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,pn=e,hn=wi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,pn=e,hn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=os!==null?{id:Ia,overflow:ja}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Fn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,pn=e,hn=null,!0):!1;default:return!1}}function $d(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Gd(e){if(zt){var t=hn;if(t){var r=t;if(!Xg(e,t)){if($d(e))throw Error(Te(418));t=wi(r.nextSibling);var n=pn;t&&Xg(e,t)?k_(n,r):(e.flags=e.flags&-4097|2,zt=!1,pn=e)}}else{if($d(e))throw Error(Te(418));e.flags=e.flags&-4097|2,zt=!1,pn=e}}}function qg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;pn=e}function Qc(e){if(e!==pn)return!1;if(!zt)return qg(e),zt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ud(e.type,e.memoizedProps)),t&&(t=hn)){if($d(e))throw E_(),Error(Te(418));for(;t;)k_(e,t),t=wi(t.nextSibling)}if(qg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){hn=wi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}hn=null}}else hn=pn?wi(e.stateNode.nextSibling):null;return!0}function E_(){for(var e=hn;e;)e=wi(e.nextSibling)}function go(){hn=pn=null,zt=!1}function sp(e){Zn===null?Zn=[e]:Zn.push(e)}var lT=Ja.ReactCurrentBatchConfig;function Jo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var n=r.stateNode}if(!n)throw Error(Te(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,e))}return e}function eu(e,t){throw e=Object.prototype.toString.call(t),Error(Te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yg(e){var t=e._init;return t(e._payload)}function S_(e){function t(k,E){if(e){var w=k.deletions;w===null?(k.deletions=[E],k.flags|=16):w.push(E)}}function r(k,E){if(!e)return null;for(;E!==null;)t(k,E),E=E.sibling;return null}function n(k,E){for(k=new Map;E!==null;)E.key!==null?k.set(E.key,E):k.set(E.index,E),E=E.sibling;return k}function a(k,E){return k=Ti(k,E),k.index=0,k.sibling=null,k}function i(k,E,w){return k.index=w,e?(w=k.alternate,w!==null?(w=w.index,w<E?(k.flags|=2,E):w):(k.flags|=2,E)):(k.flags|=1048576,E)}function o(k){return e&&k.alternate===null&&(k.flags|=2),k}function l(k,E,w,N){return E===null||E.tag!==6?(E=J0(w,k.mode,N),E.return=k,E):(E=a(E,w),E.return=k,E)}function u(k,E,w,N){var I=w.type;return I===Us?d(k,E,w.props.children,N,w.key):E!==null&&(E.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===oi&&Yg(I)===E.type)?(N=a(E,w.props),N.ref=Jo(k,E,w),N.return=k,N):(N=bu(w.type,w.key,w.props,null,k.mode,N),N.ref=Jo(k,E,w),N.return=k,N)}function f(k,E,w,N){return E===null||E.tag!==4||E.stateNode.containerInfo!==w.containerInfo||E.stateNode.implementation!==w.implementation?(E=Q0(w,k.mode,N),E.return=k,E):(E=a(E,w.children||[]),E.return=k,E)}function d(k,E,w,N,I){return E===null||E.tag!==7?(E=rs(w,k.mode,N,I),E.return=k,E):(E=a(E,w),E.return=k,E)}function m(k,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return E=J0(""+E,k.mode,w),E.return=k,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Vc:return w=bu(E.type,E.key,E.props,null,k.mode,w),w.ref=Jo(k,null,E),w.return=k,w;case zs:return E=Q0(E,k.mode,w),E.return=k,E;case oi:var N=E._init;return m(k,N(E._payload),w)}if(il(E)||Zo(E))return E=rs(E,k.mode,w,null),E.return=k,E;eu(k,E)}return null}function g(k,E,w,N){var I=E!==null?E.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return I!==null?null:l(k,E,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Vc:return w.key===I?u(k,E,w,N):null;case zs:return w.key===I?f(k,E,w,N):null;case oi:return I=w._init,g(k,E,I(w._payload),N)}if(il(w)||Zo(w))return I!==null?null:d(k,E,w,N,null);eu(k,w)}return null}function v(k,E,w,N,I){if(typeof N=="string"&&N!==""||typeof N=="number")return k=k.get(w)||null,l(E,k,""+N,I);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Vc:return k=k.get(N.key===null?w:N.key)||null,u(E,k,N,I);case zs:return k=k.get(N.key===null?w:N.key)||null,f(E,k,N,I);case oi:var D=N._init;return v(k,E,w,D(N._payload),I)}if(il(N)||Zo(N))return k=k.get(w)||null,d(E,k,N,I,null);eu(E,N)}return null}function y(k,E,w,N){for(var I=null,D=null,P=E,V=E=0,z=null;P!==null&&V<w.length;V++){P.index>V?(z=P,P=null):z=P.sibling;var W=g(k,P,w[V],N);if(W===null){P===null&&(P=z);break}e&&P&&W.alternate===null&&t(k,P),E=i(W,E,V),D===null?I=W:D.sibling=W,D=W,P=z}if(V===w.length)return r(k,P),zt&&Vi(k,V),I;if(P===null){for(;V<w.length;V++)P=m(k,w[V],N),P!==null&&(E=i(P,E,V),D===null?I=P:D.sibling=P,D=P);return zt&&Vi(k,V),I}for(P=n(k,P);V<w.length;V++)z=v(P,k,V,w[V],N),z!==null&&(e&&z.alternate!==null&&P.delete(z.key===null?V:z.key),E=i(z,E,V),D===null?I=z:D.sibling=z,D=z);return e&&P.forEach(function(B){return t(k,B)}),zt&&Vi(k,V),I}function _(k,E,w,N){var I=Zo(w);if(typeof I!="function")throw Error(Te(150));if(w=I.call(w),w==null)throw Error(Te(151));for(var D=I=null,P=E,V=E=0,z=null,W=w.next();P!==null&&!W.done;V++,W=w.next()){P.index>V?(z=P,P=null):z=P.sibling;var B=g(k,P,W.value,N);if(B===null){P===null&&(P=z);break}e&&P&&B.alternate===null&&t(k,P),E=i(B,E,V),D===null?I=B:D.sibling=B,D=B,P=z}if(W.done)return r(k,P),zt&&Vi(k,V),I;if(P===null){for(;!W.done;V++,W=w.next())W=m(k,W.value,N),W!==null&&(E=i(W,E,V),D===null?I=W:D.sibling=W,D=W);return zt&&Vi(k,V),I}for(P=n(k,P);!W.done;V++,W=w.next())W=v(P,k,V,W.value,N),W!==null&&(e&&W.alternate!==null&&P.delete(W.key===null?V:W.key),E=i(W,E,V),D===null?I=W:D.sibling=W,D=W);return e&&P.forEach(function(G){return t(k,G)}),zt&&Vi(k,V),I}function S(k,E,w,N){if(typeof w=="object"&&w!==null&&w.type===Us&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Vc:e:{for(var I=w.key,D=E;D!==null;){if(D.key===I){if(I=w.type,I===Us){if(D.tag===7){r(k,D.sibling),E=a(D,w.props.children),E.return=k,k=E;break e}}else if(D.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===oi&&Yg(I)===D.type){r(k,D.sibling),E=a(D,w.props),E.ref=Jo(k,D,w),E.return=k,k=E;break e}r(k,D);break}else t(k,D);D=D.sibling}w.type===Us?(E=rs(w.props.children,k.mode,N,w.key),E.return=k,k=E):(N=bu(w.type,w.key,w.props,null,k.mode,N),N.ref=Jo(k,E,w),N.return=k,k=N)}return o(k);case zs:e:{for(D=w.key;E!==null;){if(E.key===D)if(E.tag===4&&E.stateNode.containerInfo===w.containerInfo&&E.stateNode.implementation===w.implementation){r(k,E.sibling),E=a(E,w.children||[]),E.return=k,k=E;break e}else{r(k,E);break}else t(k,E);E=E.sibling}E=Q0(w,k.mode,N),E.return=k,k=E}return o(k);case oi:return D=w._init,S(k,E,D(w._payload),N)}if(il(w))return y(k,E,w,N);if(Zo(w))return _(k,E,w,N);eu(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,E!==null&&E.tag===6?(r(k,E.sibling),E=a(E,w),E.return=k,k=E):(r(k,E),E=J0(w,k.mode,N),E.return=k,k=E),o(k)):r(k,E)}return S}var xo=S_(!0),T_=S_(!1),Zu=Mi(null),Xu=null,qs=null,op=null;function lp(){op=qs=Xu=null}function cp(e){var t=Zu.current;It(Zu),e._currentValue=t}function Zd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function so(e,t){Xu=e,op=qs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(nn=!0),e.firstContext=null)}function Mn(e){var t=e._currentValue;if(op!==e)if(e={context:e,memoizedValue:t,next:null},qs===null){if(Xu===null)throw Error(Te(308));qs=e,Xu.dependencies={lanes:0,firstContext:e}}else qs=qs.next=e;return t}var Yi=null;function up(e){Yi===null?Yi=[e]:Yi.push(e)}function C_(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,up(t)):(r.next=a.next,a.next=r),t.interleaved=r,Za(e,n)}function Za(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var li=!1;function fp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function b_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ua(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ki(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,wt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Za(e,r)}return a=n.interleaved,a===null?(t.next=t,up(n)):(t.next=a.next,a.next=t),n.interleaved=t,Za(e,r)}function wu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Yh(e,r)}}function Kg(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function qu(e,t,r,n){var a=e.updateQueue;li=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var u=l,f=u.next;u.next=null,o===null?i=f:o.next=f,o=u;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=f:l.next=f,d.lastBaseUpdate=u))}if(i!==null){var m=a.baseState;o=0,d=f=u=null,l=i;do{var g=l.lane,v=l.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,_=l;switch(g=t,v=r,_.tag){case 1:if(y=_.payload,typeof y=="function"){m=y.call(v,m,g);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,g=typeof y=="function"?y.call(v,m,g):y,g==null)break e;m=Zt({},m,g);break e;case 2:li=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=a.effects,g===null?a.effects=[l]:g.push(l))}else v={eventTime:v,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(f=d=v,u=m):d=d.next=v,o|=g;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;g=l,l=g.next,g.next=null,a.lastBaseUpdate=g,a.shared.pending=null}}while(!0);if(d===null&&(u=m),a.baseState=u,a.firstBaseUpdate=f,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);cs|=o,e.lanes=o,e.memoizedState=m}}function Jg(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Te(191,a));a.call(n)}}}var cc={},ya=Mi(cc),Vl=Mi(cc),Wl=Mi(cc);function Ki(e){if(e===cc)throw Error(Te(174));return e}function dp(e,t){switch(Ft(Wl,t),Ft(Vl,e),Ft(ya,cc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bd(t,e)}It(ya),Ft(ya,t)}function vo(){It(ya),It(Vl),It(Wl)}function A_(e){Ki(Wl.current);var t=Ki(ya.current),r=bd(t,e.type);t!==r&&(Ft(Vl,e),Ft(ya,r))}function hp(e){Vl.current===e&&(It(ya),It(Vl))}var Vt=Mi(0);function Yu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var G0=[];function pp(){for(var e=0;e<G0.length;e++)G0[e]._workInProgressVersionPrimary=null;G0.length=0}var ku=Ja.ReactCurrentDispatcher,Z0=Ja.ReactCurrentBatchConfig,ls=0,$t=null,fr=null,vr=null,Ku=!1,vl=!1,$l=0,cT=0;function Lr(){throw Error(Te(321))}function mp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ea(e[r],t[r]))return!1;return!0}function gp(e,t,r,n,a,i){if(ls=i,$t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ku.current=e===null||e.memoizedState===null?hT:pT,e=r(n,a),vl){i=0;do{if(vl=!1,$l=0,25<=i)throw Error(Te(301));i+=1,vr=fr=null,t.updateQueue=null,ku.current=mT,e=r(n,a)}while(vl)}if(ku.current=Ju,t=fr!==null&&fr.next!==null,ls=0,vr=fr=$t=null,Ku=!1,t)throw Error(Te(300));return e}function xp(){var e=$l!==0;return $l=0,e}function pa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vr===null?$t.memoizedState=vr=e:vr=vr.next=e,vr}function Rn(){if(fr===null){var e=$t.alternate;e=e!==null?e.memoizedState:null}else e=fr.next;var t=vr===null?$t.memoizedState:vr.next;if(t!==null)vr=t,fr=e;else{if(e===null)throw Error(Te(310));fr=e,e={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},vr===null?$t.memoizedState=vr=e:vr=vr.next=e}return vr}function Gl(e,t){return typeof t=="function"?t(e):t}function X0(e){var t=Rn(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=fr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,u=null,f=i;do{var d=f.lane;if((ls&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var m={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,$t.lanes|=d,cs|=d}f=f.next}while(f!==null&&f!==i);u===null?o=n:u.next=l,ea(n,t.memoizedState)||(nn=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,$t.lanes|=i,cs|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function q0(e){var t=Rn(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);ea(i,t.memoizedState)||(nn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function N_(){}function L_(e,t){var r=$t,n=Rn(),a=t(),i=!ea(n.memoizedState,a);if(i&&(n.memoizedState=a,nn=!0),n=n.queue,vp(O_.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||vr!==null&&vr.memoizedState.tag&1){if(r.flags|=2048,Zl(9,F_.bind(null,r,n,a,t),void 0,null),_r===null)throw Error(Te(349));ls&30||P_(r,t,a)}return a}function P_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=$t.updateQueue,t===null?(t={lastEffect:null,stores:null},$t.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function F_(e,t,r,n){t.value=r,t.getSnapshot=n,M_(t)&&R_(e)}function O_(e,t,r){return r(function(){M_(t)&&R_(e)})}function M_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ea(e,r)}catch{return!0}}function R_(e){var t=Za(e,1);t!==null&&Jn(t,e,1,-1)}function Qg(e){var t=pa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:e},t.queue=e,e=e.dispatch=dT.bind(null,$t,e),[t.memoizedState,e]}function Zl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=$t.updateQueue,t===null?(t={lastEffect:null,stores:null},$t.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function D_(){return Rn().memoizedState}function Eu(e,t,r,n){var a=pa();$t.flags|=e,a.memoizedState=Zl(1|t,r,void 0,n===void 0?null:n)}function Mf(e,t,r,n){var a=Rn();n=n===void 0?null:n;var i=void 0;if(fr!==null){var o=fr.memoizedState;if(i=o.destroy,n!==null&&mp(n,o.deps)){a.memoizedState=Zl(t,r,i,n);return}}$t.flags|=e,a.memoizedState=Zl(1|t,r,i,n)}function e1(e,t){return Eu(8390656,8,e,t)}function vp(e,t){return Mf(2048,8,e,t)}function I_(e,t){return Mf(4,2,e,t)}function j_(e,t){return Mf(4,4,e,t)}function B_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function z_(e,t,r){return r=r!=null?r.concat([e]):null,Mf(4,4,B_.bind(null,t,e),r)}function _p(){}function U_(e,t){var r=Rn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&mp(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function H_(e,t){var r=Rn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&mp(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function V_(e,t,r){return ls&21?(ea(r,t)||(r=Xv(),$t.lanes|=r,cs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,nn=!0),e.memoizedState=r)}function uT(e,t){var r=Lt;Lt=r!==0&&4>r?r:4,e(!0);var n=Z0.transition;Z0.transition={};try{e(!1),t()}finally{Lt=r,Z0.transition=n}}function W_(){return Rn().memoizedState}function fT(e,t,r){var n=Si(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},$_(e))G_(t,r);else if(r=C_(e,t,r,n),r!==null){var a=qr();Jn(r,e,n,a),Z_(r,t,n)}}function dT(e,t,r){var n=Si(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if($_(e))G_(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,ea(l,o)){var u=t.interleaved;u===null?(a.next=a,up(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}r=C_(e,t,a,n),r!==null&&(a=qr(),Jn(r,e,n,a),Z_(r,t,n))}}function $_(e){var t=e.alternate;return e===$t||t!==null&&t===$t}function G_(e,t){vl=Ku=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Z_(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Yh(e,r)}}var Ju={readContext:Mn,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},hT={readContext:Mn,useCallback:function(e,t){return pa().memoizedState=[e,t===void 0?null:t],e},useContext:Mn,useEffect:e1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Eu(4194308,4,B_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Eu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Eu(4,2,e,t)},useMemo:function(e,t){var r=pa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=pa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=fT.bind(null,$t,e),[n.memoizedState,e]},useRef:function(e){var t=pa();return e={current:e},t.memoizedState=e},useState:Qg,useDebugValue:_p,useDeferredValue:function(e){return pa().memoizedState=e},useTransition:function(){var e=Qg(!1),t=e[0];return e=uT.bind(null,e[1]),pa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=$t,a=pa();if(zt){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=t(),_r===null)throw Error(Te(349));ls&30||P_(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,e1(O_.bind(null,n,i,e),[e]),n.flags|=2048,Zl(9,F_.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=pa(),t=_r.identifierPrefix;if(zt){var r=ja,n=Ia;r=(n&~(1<<32-Kn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=$l++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=cT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},pT={readContext:Mn,useCallback:U_,useContext:Mn,useEffect:vp,useImperativeHandle:z_,useInsertionEffect:I_,useLayoutEffect:j_,useMemo:H_,useReducer:X0,useRef:D_,useState:function(){return X0(Gl)},useDebugValue:_p,useDeferredValue:function(e){var t=Rn();return V_(t,fr.memoizedState,e)},useTransition:function(){var e=X0(Gl)[0],t=Rn().memoizedState;return[e,t]},useMutableSource:N_,useSyncExternalStore:L_,useId:W_,unstable_isNewReconciler:!1},mT={readContext:Mn,useCallback:U_,useContext:Mn,useEffect:vp,useImperativeHandle:z_,useInsertionEffect:I_,useLayoutEffect:j_,useMemo:H_,useReducer:q0,useRef:D_,useState:function(){return q0(Gl)},useDebugValue:_p,useDeferredValue:function(e){var t=Rn();return fr===null?t.memoizedState=e:V_(t,fr.memoizedState,e)},useTransition:function(){var e=q0(Gl)[0],t=Rn().memoizedState;return[e,t]},useMutableSource:N_,useSyncExternalStore:L_,useId:W_,unstable_isNewReconciler:!1};function $n(e,t){if(e&&e.defaultProps){t=Zt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Xd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Zt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Rf={isMounted:function(e){return(e=e._reactInternals)?xs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qr(),a=Si(e),i=Ua(n,a);i.payload=t,r!=null&&(i.callback=r),t=ki(e,i,a),t!==null&&(Jn(t,e,a,n),wu(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qr(),a=Si(e),i=Ua(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ki(e,i,a),t!==null&&(Jn(t,e,a,n),wu(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qr(),n=Si(e),a=Ua(r,n);a.tag=2,t!=null&&(a.callback=t),t=ki(e,a,n),t!==null&&(Jn(t,e,n,r),wu(t,e,n))}};function t1(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Bl(r,n)||!Bl(a,i):!0}function X_(e,t,r){var n=!1,a=Ni,i=t.contextType;return typeof i=="object"&&i!==null?i=Mn(i):(a=on(t)?ss:Br.current,n=t.contextTypes,i=(n=n!=null)?mo(e,a):Ni),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Rf,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function r1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Rf.enqueueReplaceState(t,t.state,null)}function qd(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},fp(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Mn(i):(i=on(t)?ss:Br.current,a.context=mo(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Xd(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Rf.enqueueReplaceState(a,a.state,null),qu(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function _o(e,t){try{var r="",n=t;do r+=VE(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Y0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Yd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var gT=typeof WeakMap=="function"?WeakMap:Map;function q_(e,t,r){r=Ua(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ef||(ef=!0,sh=n),Yd(e,t)},r}function Y_(e,t,r){r=Ua(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Yd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Yd(e,t),typeof n!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function n1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new gT;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=LT.bind(null,e,t,r),t.then(e,e))}function a1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function i1(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ua(-1,1),t.tag=2,ki(r,t,1))),r.lanes|=1),e)}var xT=Ja.ReactCurrentOwner,nn=!1;function Wr(e,t,r,n){t.child=e===null?T_(t,null,r,n):xo(t,e.child,r,n)}function s1(e,t,r,n,a){r=r.render;var i=t.ref;return so(t,a),n=gp(e,t,r,n,i,a),r=xp(),e!==null&&!nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xa(e,t,a)):(zt&&r&&ap(t),t.flags|=1,Wr(e,t,n,a),t.child)}function o1(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!bp(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,K_(e,t,i,n,a)):(e=bu(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Bl,r(o,n)&&e.ref===t.ref)return Xa(e,t,a)}return t.flags|=1,e=Ti(i,n),e.ref=t.ref,e.return=t,t.child=e}function K_(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Bl(i,n)&&e.ref===t.ref)if(nn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(nn=!0);else return t.lanes=e.lanes,Xa(e,t,a)}return Kd(e,t,r,n,a)}function J_(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ft(Ks,un),un|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ft(Ks,un),un|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Ft(Ks,un),un|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Ft(Ks,un),un|=n;return Wr(e,t,a,r),t.child}function Q_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Kd(e,t,r,n,a){var i=on(r)?ss:Br.current;return i=mo(t,i),so(t,a),r=gp(e,t,r,n,i,a),n=xp(),e!==null&&!nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xa(e,t,a)):(zt&&n&&ap(t),t.flags|=1,Wr(e,t,r,a),t.child)}function l1(e,t,r,n,a){if(on(r)){var i=!0;Wu(t)}else i=!1;if(so(t,a),t.stateNode===null)Su(e,t),X_(t,r,n),qd(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,f=r.contextType;typeof f=="object"&&f!==null?f=Mn(f):(f=on(r)?ss:Br.current,f=mo(t,f));var d=r.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==f)&&r1(t,o,n,f),li=!1;var g=t.memoizedState;o.state=g,qu(t,n,o,a),u=t.memoizedState,l!==n||g!==u||sn.current||li?(typeof d=="function"&&(Xd(t,r,d,n),u=t.memoizedState),(l=li||t1(t,r,l,n,g,u,f))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=f,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,b_(e,t),l=t.memoizedProps,f=t.type===t.elementType?l:$n(t.type,l),o.props=f,m=t.pendingProps,g=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=Mn(u):(u=on(r)?ss:Br.current,u=mo(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==u)&&r1(t,o,n,u),li=!1,g=t.memoizedState,o.state=g,qu(t,n,o,a);var y=t.memoizedState;l!==m||g!==y||sn.current||li?(typeof v=="function"&&(Xd(t,r,v,n),y=t.memoizedState),(f=li||t1(t,r,f,n,g,y,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=u,n=f):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return Jd(e,t,r,n,i,a)}function Jd(e,t,r,n,a,i){Q_(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&Zg(t,r,!1),Xa(e,t,i);n=t.stateNode,xT.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=xo(t,e.child,null,i),t.child=xo(t,null,l,i)):Wr(e,t,l,i),t.memoizedState=n.state,a&&Zg(t,r,!0),t.child}function ey(e){var t=e.stateNode;t.pendingContext?Gg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Gg(e,t.context,!1),dp(e,t.containerInfo)}function c1(e,t,r,n,a){return go(),sp(a),t.flags|=256,Wr(e,t,r,n),t.child}var Qd={dehydrated:null,treeContext:null,retryLane:0};function eh(e){return{baseLanes:e,cachePool:null,transitions:null}}function ty(e,t,r){var n=t.pendingProps,a=Vt.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ft(Vt,a&1),e===null)return Gd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=jf(o,n,0,null),e=rs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=eh(r),t.memoizedState=Qd,e):yp(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return vT(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Ti(a,u),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Ti(l,i):(i=rs(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?eh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Qd,n}return i=e.child,e=i.sibling,n=Ti(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function yp(e,t){return t=jf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function tu(e,t,r,n){return n!==null&&sp(n),xo(t,e.child,null,r),e=yp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function vT(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=Y0(Error(Te(422))),tu(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=jf({mode:"visible",children:n.children},a,0,null),i=rs(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&xo(t,e.child,null,o),t.child.memoizedState=eh(o),t.memoizedState=Qd,i);if(!(t.mode&1))return tu(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Te(419)),n=Y0(i,n,void 0),tu(e,t,o,n)}if(l=(o&e.childLanes)!==0,nn||l){if(n=_r,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Za(e,a),Jn(n,e,a,-1))}return Cp(),n=Y0(Error(Te(421))),tu(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=PT.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,hn=wi(a.nextSibling),pn=t,zt=!0,Zn=null,e!==null&&(An[Nn++]=Ia,An[Nn++]=ja,An[Nn++]=os,Ia=e.id,ja=e.overflow,os=t),t=yp(t,n.children),t.flags|=4096,t)}function u1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Zd(e.return,t,r)}function K0(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function ry(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Wr(e,t,n.children,r),n=Vt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&u1(e,r,t);else if(e.tag===19)u1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ft(Vt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Yu(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),K0(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Yu(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}K0(t,!0,r,null,i);break;case"together":K0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Su(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),cs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Te(153));if(t.child!==null){for(e=t.child,r=Ti(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ti(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function _T(e,t,r){switch(t.tag){case 3:ey(t),go();break;case 5:A_(t);break;case 1:on(t.type)&&Wu(t);break;case 4:dp(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Ft(Zu,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ft(Vt,Vt.current&1),t.flags|=128,null):r&t.child.childLanes?ty(e,t,r):(Ft(Vt,Vt.current&1),e=Xa(e,t,r),e!==null?e.sibling:null);Ft(Vt,Vt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return ry(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ft(Vt,Vt.current),n)break;return null;case 22:case 23:return t.lanes=0,J_(e,t,r)}return Xa(e,t,r)}var ny,th,ay,iy;ny=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};th=function(){};ay=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ki(ya.current);var i=null;switch(r){case"input":a=Ed(e,a),n=Ed(e,n),i=[];break;case"select":a=Zt({},a,{value:void 0}),n=Zt({},n,{value:void 0}),i=[];break;case"textarea":a=Cd(e,a),n=Cd(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Hu)}Ad(r,n);var o;r=null;for(f in a)if(!n.hasOwnProperty(f)&&a.hasOwnProperty(f)&&a[f]!=null)if(f==="style"){var l=a[f];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Fl.hasOwnProperty(f)?i||(i=[]):(i=i||[]).push(f,null));for(f in n){var u=n[f];if(l=a!=null?a[f]:void 0,n.hasOwnProperty(f)&&u!==l&&(u!=null||l!=null))if(f==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(i||(i=[]),i.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Fl.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Dt("scroll",e),i||l===u||(i=[])):(i=i||[]).push(f,u))}r&&(i=i||[]).push("style",r);var f=i;(t.updateQueue=f)&&(t.flags|=4)}};iy=function(e,t,r,n){r!==n&&(t.flags|=4)};function Qo(e,t){if(!zt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Pr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function yT(e,t,r){var n=t.pendingProps;switch(ip(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pr(t),null;case 1:return on(t.type)&&Vu(),Pr(t),null;case 3:return n=t.stateNode,vo(),It(sn),It(Br),pp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Qc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Zn!==null&&(ch(Zn),Zn=null))),th(e,t),Pr(t),null;case 5:hp(t);var a=Ki(Wl.current);if(r=t.type,e!==null&&t.stateNode!=null)ay(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Te(166));return Pr(t),null}if(e=Ki(ya.current),Qc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ga]=t,n[Hl]=i,e=(t.mode&1)!==0,r){case"dialog":Dt("cancel",n),Dt("close",n);break;case"iframe":case"object":case"embed":Dt("load",n);break;case"video":case"audio":for(a=0;a<ol.length;a++)Dt(ol[a],n);break;case"source":Dt("error",n);break;case"img":case"image":case"link":Dt("error",n),Dt("load",n);break;case"details":Dt("toggle",n);break;case"input":_g(n,i),Dt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Dt("invalid",n);break;case"textarea":wg(n,i),Dt("invalid",n)}Ad(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Jc(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Jc(n.textContent,l,e),a=["children",""+l]):Fl.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Dt("scroll",n)}switch(r){case"input":Wc(n),yg(n,i,!0);break;case"textarea":Wc(n),kg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Hu)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ov(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[ga]=t,e[Hl]=n,ny(e,t,!1,!1),t.stateNode=e;e:{switch(o=Nd(r,n),r){case"dialog":Dt("cancel",e),Dt("close",e),a=n;break;case"iframe":case"object":case"embed":Dt("load",e),a=n;break;case"video":case"audio":for(a=0;a<ol.length;a++)Dt(ol[a],e);a=n;break;case"source":Dt("error",e),a=n;break;case"img":case"image":case"link":Dt("error",e),Dt("load",e),a=n;break;case"details":Dt("toggle",e),a=n;break;case"input":_g(e,n),a=Ed(e,n),Dt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Zt({},n,{value:void 0}),Dt("invalid",e);break;case"textarea":wg(e,n),a=Cd(e,n),Dt("invalid",e);break;default:a=n}Ad(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Dv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Mv(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Ol(e,u):typeof u=="number"&&Ol(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fl.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Dt("scroll",e):u!=null&&Wh(e,i,u,o))}switch(r){case"input":Wc(e),yg(e,n,!1);break;case"textarea":Wc(e),kg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ai(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?ro(e,!!n.multiple,i,!1):n.defaultValue!=null&&ro(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Hu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Pr(t),null;case 6:if(e&&t.stateNode!=null)iy(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Te(166));if(r=Ki(Wl.current),Ki(ya.current),Qc(t)){if(n=t.stateNode,r=t.memoizedProps,n[ga]=t,(i=n.nodeValue!==r)&&(e=pn,e!==null))switch(e.tag){case 3:Jc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Jc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ga]=t,t.stateNode=n}return Pr(t),null;case 13:if(It(Vt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(zt&&hn!==null&&t.mode&1&&!(t.flags&128))E_(),go(),t.flags|=98560,i=!1;else if(i=Qc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Te(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Te(317));i[ga]=t}else go(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Pr(t),i=!1}else Zn!==null&&(ch(Zn),Zn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Vt.current&1?dr===0&&(dr=3):Cp())),t.updateQueue!==null&&(t.flags|=4),Pr(t),null);case 4:return vo(),th(e,t),e===null&&zl(t.stateNode.containerInfo),Pr(t),null;case 10:return cp(t.type._context),Pr(t),null;case 17:return on(t.type)&&Vu(),Pr(t),null;case 19:if(It(Vt),i=t.memoizedState,i===null)return Pr(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Qo(i,!1);else{if(dr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Yu(e),o!==null){for(t.flags|=128,Qo(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ft(Vt,Vt.current&1|2),t.child}e=e.sibling}i.tail!==null&&tr()>yo&&(t.flags|=128,n=!0,Qo(i,!1),t.lanes=4194304)}else{if(!n)if(e=Yu(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Qo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!zt)return Pr(t),null}else 2*tr()-i.renderingStartTime>yo&&r!==1073741824&&(t.flags|=128,n=!0,Qo(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=tr(),t.sibling=null,r=Vt.current,Ft(Vt,n?r&1|2:r&1),t):(Pr(t),null);case 22:case 23:return Tp(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?un&1073741824&&(Pr(t),t.subtreeFlags&6&&(t.flags|=8192)):Pr(t),null;case 24:return null;case 25:return null}throw Error(Te(156,t.tag))}function wT(e,t){switch(ip(t),t.tag){case 1:return on(t.type)&&Vu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return vo(),It(sn),It(Br),pp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return hp(t),null;case 13:if(It(Vt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Te(340));go()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return It(Vt),null;case 4:return vo(),null;case 10:return cp(t.type._context),null;case 22:case 23:return Tp(),null;case 24:return null;default:return null}}var ru=!1,Mr=!1,kT=typeof WeakSet=="function"?WeakSet:Set,je=null;function Ys(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Yt(e,t,n)}else r.current=null}function rh(e,t,r){try{r()}catch(n){Yt(e,t,n)}}var f1=!1;function ET(e,t){if(Bd=Bu,e=u_(),np(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,f=0,d=0,m=e,g=null;t:for(;;){for(var v;m!==r||a!==0&&m.nodeType!==3||(l=o+a),m!==i||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===e)break t;if(g===r&&++f===a&&(l=o),g===i&&++d===n&&(u=o),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(zd={focusedElem:e,selectionRange:r},Bu=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,S=y.memoizedState,k=t.stateNode,E=k.getSnapshotBeforeUpdate(t.elementType===t.type?_:$n(t.type,_),S);k.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(N){Yt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return y=f1,f1=!1,y}function _l(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&rh(t,r,i)}a=a.next}while(a!==n)}}function Df(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function nh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function sy(e){var t=e.alternate;t!==null&&(e.alternate=null,sy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ga],delete t[Hl],delete t[Vd],delete t[iT],delete t[sT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function oy(e){return e.tag===5||e.tag===3||e.tag===4}function d1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||oy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ah(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Hu));else if(n!==4&&(e=e.child,e!==null))for(ah(e,t,r),e=e.sibling;e!==null;)ah(e,t,r),e=e.sibling}function ih(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(ih(e,t,r),e=e.sibling;e!==null;)ih(e,t,r),e=e.sibling}var kr=null,Gn=!1;function ai(e,t,r){for(r=r.child;r!==null;)ly(e,t,r),r=r.sibling}function ly(e,t,r){if(_a&&typeof _a.onCommitFiberUnmount=="function")try{_a.onCommitFiberUnmount(Af,r)}catch{}switch(r.tag){case 5:Mr||Ys(r,t);case 6:var n=kr,a=Gn;kr=null,ai(e,t,r),kr=n,Gn=a,kr!==null&&(Gn?(e=kr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):kr.removeChild(r.stateNode));break;case 18:kr!==null&&(Gn?(e=kr,r=r.stateNode,e.nodeType===8?W0(e.parentNode,r):e.nodeType===1&&W0(e,r),Il(e)):W0(kr,r.stateNode));break;case 4:n=kr,a=Gn,kr=r.stateNode.containerInfo,Gn=!0,ai(e,t,r),kr=n,Gn=a;break;case 0:case 11:case 14:case 15:if(!Mr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&rh(r,t,o),a=a.next}while(a!==n)}ai(e,t,r);break;case 1:if(!Mr&&(Ys(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Yt(r,t,l)}ai(e,t,r);break;case 21:ai(e,t,r);break;case 22:r.mode&1?(Mr=(n=Mr)||r.memoizedState!==null,ai(e,t,r),Mr=n):ai(e,t,r);break;default:ai(e,t,r)}}function h1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new kT),t.forEach(function(n){var a=FT.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Hn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:kr=l.stateNode,Gn=!1;break e;case 3:kr=l.stateNode.containerInfo,Gn=!0;break e;case 4:kr=l.stateNode.containerInfo,Gn=!0;break e}l=l.return}if(kr===null)throw Error(Te(160));ly(i,o,a),kr=null,Gn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(f){Yt(a,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)cy(t,e),t=t.sibling}function cy(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Hn(t,e),ua(e),n&4){try{_l(3,e,e.return),Df(3,e)}catch(_){Yt(e,e.return,_)}try{_l(5,e,e.return)}catch(_){Yt(e,e.return,_)}}break;case 1:Hn(t,e),ua(e),n&512&&r!==null&&Ys(r,r.return);break;case 5:if(Hn(t,e),ua(e),n&512&&r!==null&&Ys(r,r.return),e.flags&32){var a=e.stateNode;try{Ol(a,"")}catch(_){Yt(e,e.return,_)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Pv(a,i),Nd(l,o);var f=Nd(l,i);for(o=0;o<u.length;o+=2){var d=u[o],m=u[o+1];d==="style"?Dv(a,m):d==="dangerouslySetInnerHTML"?Mv(a,m):d==="children"?Ol(a,m):Wh(a,d,m,f)}switch(l){case"input":Sd(a,i);break;case"textarea":Fv(a,i);break;case"select":var g=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?ro(a,!!i.multiple,v,!1):g!==!!i.multiple&&(i.defaultValue!=null?ro(a,!!i.multiple,i.defaultValue,!0):ro(a,!!i.multiple,i.multiple?[]:"",!1))}a[Hl]=i}catch(_){Yt(e,e.return,_)}}break;case 6:if(Hn(t,e),ua(e),n&4){if(e.stateNode===null)throw Error(Te(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(_){Yt(e,e.return,_)}}break;case 3:if(Hn(t,e),ua(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Il(t.containerInfo)}catch(_){Yt(e,e.return,_)}break;case 4:Hn(t,e),ua(e);break;case 13:Hn(t,e),ua(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Ep=tr())),n&4&&h1(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Mr=(f=Mr)||d,Hn(t,e),Mr=f):Hn(t,e),ua(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for(je=e,d=e.child;d!==null;){for(m=je=d;je!==null;){switch(g=je,v=g.child,g.tag){case 0:case 11:case 14:case 15:_l(4,g,g.return);break;case 1:Ys(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(_){Yt(n,r,_)}}break;case 5:Ys(g,g.return);break;case 22:if(g.memoizedState!==null){m1(m);continue}}v!==null?(v.return=g,je=v):m1(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{a=m.stateNode,f?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Rv("display",o))}catch(_){Yt(e,e.return,_)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(_){Yt(e,e.return,_)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Hn(t,e),ua(e),n&4&&h1(e);break;case 21:break;default:Hn(t,e),ua(e)}}function ua(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(oy(r)){var n=r;break e}r=r.return}throw Error(Te(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ol(a,""),n.flags&=-33);var i=d1(e);ih(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=d1(e);ah(e,l,o);break;default:throw Error(Te(161))}}catch(u){Yt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ST(e,t,r){je=e,uy(e)}function uy(e,t,r){for(var n=(e.mode&1)!==0;je!==null;){var a=je,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||ru;if(!o){var l=a.alternate,u=l!==null&&l.memoizedState!==null||Mr;l=ru;var f=Mr;if(ru=o,(Mr=u)&&!f)for(je=a;je!==null;)o=je,u=o.child,o.tag===22&&o.memoizedState!==null?g1(a):u!==null?(u.return=o,je=u):g1(a);for(;i!==null;)je=i,uy(i),i=i.sibling;je=a,ru=l,Mr=f}p1(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,je=i):p1(e)}}function p1(e){for(;je!==null;){var t=je;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mr||Df(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Mr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:$n(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Jg(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Jg(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Il(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}Mr||t.flags&512&&nh(t)}catch(g){Yt(t,t.return,g)}}if(t===e){je=null;break}if(r=t.sibling,r!==null){r.return=t.return,je=r;break}je=t.return}}function m1(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var r=t.sibling;if(r!==null){r.return=t.return,je=r;break}je=t.return}}function g1(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Df(4,t)}catch(u){Yt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(u){Yt(t,a,u)}}var i=t.return;try{nh(t)}catch(u){Yt(t,i,u)}break;case 5:var o=t.return;try{nh(t)}catch(u){Yt(t,o,u)}}}catch(u){Yt(t,t.return,u)}if(t===e){je=null;break}var l=t.sibling;if(l!==null){l.return=t.return,je=l;break}je=t.return}}var TT=Math.ceil,Qu=Ja.ReactCurrentDispatcher,wp=Ja.ReactCurrentOwner,On=Ja.ReactCurrentBatchConfig,wt=0,_r=null,lr=null,Tr=0,un=0,Ks=Mi(0),dr=0,Xl=null,cs=0,If=0,kp=0,yl=null,rn=null,Ep=0,yo=1/0,Oa=null,ef=!1,sh=null,Ei=null,nu=!1,mi=null,tf=0,wl=0,oh=null,Tu=-1,Cu=0;function qr(){return wt&6?tr():Tu!==-1?Tu:Tu=tr()}function Si(e){return e.mode&1?wt&2&&Tr!==0?Tr&-Tr:lT.transition!==null?(Cu===0&&(Cu=Xv()),Cu):(e=Lt,e!==0||(e=window.event,e=e===void 0?16:t_(e.type)),e):1}function Jn(e,t,r,n){if(50<wl)throw wl=0,oh=null,Error(Te(185));sc(e,r,n),(!(wt&2)||e!==_r)&&(e===_r&&(!(wt&2)&&(If|=r),dr===4&&ui(e,Tr)),ln(e,n),r===1&&wt===0&&!(t.mode&1)&&(yo=tr()+500,Of&&Ri()))}function ln(e,t){var r=e.callbackNode;lS(e,t);var n=ju(e,e===_r?Tr:0);if(n===0)r!==null&&Tg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Tg(r),t===1)e.tag===0?oT(x1.bind(null,e)):y_(x1.bind(null,e)),nT(function(){!(wt&6)&&Ri()}),r=null;else{switch(qv(n)){case 1:r=qh;break;case 4:r=Gv;break;case 16:r=Iu;break;case 536870912:r=Zv;break;default:r=Iu}r=vy(r,fy.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function fy(e,t){if(Tu=-1,Cu=0,wt&6)throw Error(Te(327));var r=e.callbackNode;if(oo()&&e.callbackNode!==r)return null;var n=ju(e,e===_r?Tr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=rf(e,n);else{t=n;var a=wt;wt|=2;var i=hy();(_r!==e||Tr!==t)&&(Oa=null,yo=tr()+500,ts(e,t));do try{AT();break}catch(l){dy(e,l)}while(!0);lp(),Qu.current=i,wt=a,lr!==null?t=0:(_r=null,Tr=0,t=dr)}if(t!==0){if(t===2&&(a=Md(e),a!==0&&(n=a,t=lh(e,a))),t===1)throw r=Xl,ts(e,0),ui(e,n),ln(e,tr()),r;if(t===6)ui(e,n);else{if(a=e.current.alternate,!(n&30)&&!CT(a)&&(t=rf(e,n),t===2&&(i=Md(e),i!==0&&(n=i,t=lh(e,i))),t===1))throw r=Xl,ts(e,0),ui(e,n),ln(e,tr()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Te(345));case 2:Wi(e,rn,Oa);break;case 3:if(ui(e,n),(n&130023424)===n&&(t=Ep+500-tr(),10<t)){if(ju(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){qr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Hd(Wi.bind(null,e,rn,Oa),t);break}Wi(e,rn,Oa);break;case 4:if(ui(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Kn(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=tr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*TT(n/1960))-n,10<n){e.timeoutHandle=Hd(Wi.bind(null,e,rn,Oa),n);break}Wi(e,rn,Oa);break;case 5:Wi(e,rn,Oa);break;default:throw Error(Te(329))}}}return ln(e,tr()),e.callbackNode===r?fy.bind(null,e):null}function lh(e,t){var r=yl;return e.current.memoizedState.isDehydrated&&(ts(e,t).flags|=256),e=rf(e,t),e!==2&&(t=rn,rn=r,t!==null&&ch(t)),e}function ch(e){rn===null?rn=e:rn.push.apply(rn,e)}function CT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!ea(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ui(e,t){for(t&=~kp,t&=~If,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Kn(t),n=1<<r;e[r]=-1,t&=~n}}function x1(e){if(wt&6)throw Error(Te(327));oo();var t=ju(e,0);if(!(t&1))return ln(e,tr()),null;var r=rf(e,t);if(e.tag!==0&&r===2){var n=Md(e);n!==0&&(t=n,r=lh(e,n))}if(r===1)throw r=Xl,ts(e,0),ui(e,t),ln(e,tr()),r;if(r===6)throw Error(Te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Wi(e,rn,Oa),ln(e,tr()),null}function Sp(e,t){var r=wt;wt|=1;try{return e(t)}finally{wt=r,wt===0&&(yo=tr()+500,Of&&Ri())}}function us(e){mi!==null&&mi.tag===0&&!(wt&6)&&oo();var t=wt;wt|=1;var r=On.transition,n=Lt;try{if(On.transition=null,Lt=1,e)return e()}finally{Lt=n,On.transition=r,wt=t,!(wt&6)&&Ri()}}function Tp(){un=Ks.current,It(Ks)}function ts(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,rT(r)),lr!==null)for(r=lr.return;r!==null;){var n=r;switch(ip(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Vu();break;case 3:vo(),It(sn),It(Br),pp();break;case 5:hp(n);break;case 4:vo();break;case 13:It(Vt);break;case 19:It(Vt);break;case 10:cp(n.type._context);break;case 22:case 23:Tp()}r=r.return}if(_r=e,lr=e=Ti(e.current,null),Tr=un=t,dr=0,Xl=null,kp=If=cs=0,rn=yl=null,Yi!==null){for(t=0;t<Yi.length;t++)if(r=Yi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Yi=null}return e}function dy(e,t){do{var r=lr;try{if(lp(),ku.current=Ju,Ku){for(var n=$t.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Ku=!1}if(ls=0,vr=fr=$t=null,vl=!1,$l=0,wp.current=null,r===null||r.return===null){dr=1,Xl=t,lr=null;break}e:{var i=e,o=r.return,l=r,u=t;if(t=Tr,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=a1(o);if(v!==null){v.flags&=-257,i1(v,o,l,i,t),v.mode&1&&n1(i,f,t),t=v,u=f;var y=t.updateQueue;if(y===null){var _=new Set;_.add(u),t.updateQueue=_}else y.add(u);break e}else{if(!(t&1)){n1(i,f,t),Cp();break e}u=Error(Te(426))}}else if(zt&&l.mode&1){var S=a1(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),i1(S,o,l,i,t),sp(_o(u,l));break e}}i=u=_o(u,l),dr!==4&&(dr=2),yl===null?yl=[i]:yl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var k=q_(i,u,t);Kg(i,k);break e;case 1:l=u;var E=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ei===null||!Ei.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=Y_(i,l,t);Kg(i,N);break e}}i=i.return}while(i!==null)}my(r)}catch(I){t=I,lr===r&&r!==null&&(lr=r=r.return);continue}break}while(!0)}function hy(){var e=Qu.current;return Qu.current=Ju,e===null?Ju:e}function Cp(){(dr===0||dr===3||dr===2)&&(dr=4),_r===null||!(cs&268435455)&&!(If&268435455)||ui(_r,Tr)}function rf(e,t){var r=wt;wt|=2;var n=hy();(_r!==e||Tr!==t)&&(Oa=null,ts(e,t));do try{bT();break}catch(a){dy(e,a)}while(!0);if(lp(),wt=r,Qu.current=n,lr!==null)throw Error(Te(261));return _r=null,Tr=0,dr}function bT(){for(;lr!==null;)py(lr)}function AT(){for(;lr!==null&&!QE();)py(lr)}function py(e){var t=xy(e.alternate,e,un);e.memoizedProps=e.pendingProps,t===null?my(e):lr=t,wp.current=null}function my(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=wT(r,t),r!==null){r.flags&=32767,lr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{dr=6,lr=null;return}}else if(r=yT(r,t,un),r!==null){lr=r;return}if(t=t.sibling,t!==null){lr=t;return}lr=t=e}while(t!==null);dr===0&&(dr=5)}function Wi(e,t,r){var n=Lt,a=On.transition;try{On.transition=null,Lt=1,NT(e,t,r,n)}finally{On.transition=a,Lt=n}return null}function NT(e,t,r,n){do oo();while(mi!==null);if(wt&6)throw Error(Te(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Te(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(cS(e,i),e===_r&&(lr=_r=null,Tr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||nu||(nu=!0,vy(Iu,function(){return oo(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=On.transition,On.transition=null;var o=Lt;Lt=1;var l=wt;wt|=4,wp.current=null,ET(e,r),cy(r,e),qS(zd),Bu=!!Bd,zd=Bd=null,e.current=r,ST(r),eS(),wt=l,Lt=o,On.transition=i}else e.current=r;if(nu&&(nu=!1,mi=e,tf=a),i=e.pendingLanes,i===0&&(Ei=null),nS(r.stateNode),ln(e,tr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(ef)throw ef=!1,e=sh,sh=null,e;return tf&1&&e.tag!==0&&oo(),i=e.pendingLanes,i&1?e===oh?wl++:(wl=0,oh=e):wl=0,Ri(),null}function oo(){if(mi!==null){var e=qv(tf),t=On.transition,r=Lt;try{if(On.transition=null,Lt=16>e?16:e,mi===null)var n=!1;else{if(e=mi,mi=null,tf=0,wt&6)throw Error(Te(331));var a=wt;for(wt|=4,je=e.current;je!==null;){var i=je,o=i.child;if(je.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var f=l[u];for(je=f;je!==null;){var d=je;switch(d.tag){case 0:case 11:case 15:_l(8,d,i)}var m=d.child;if(m!==null)m.return=d,je=m;else for(;je!==null;){d=je;var g=d.sibling,v=d.return;if(sy(d),d===f){je=null;break}if(g!==null){g.return=v,je=g;break}je=v}}}var y=i.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var S=_.sibling;_.sibling=null,_=S}while(_!==null)}}je=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,je=o;else e:for(;je!==null;){if(i=je,i.flags&2048)switch(i.tag){case 0:case 11:case 15:_l(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,je=k;break e}je=i.return}}var E=e.current;for(je=E;je!==null;){o=je;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,je=w;else e:for(o=E;je!==null;){if(l=je,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Df(9,l)}}catch(I){Yt(l,l.return,I)}if(l===o){je=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,je=N;break e}je=l.return}}if(wt=a,Ri(),_a&&typeof _a.onPostCommitFiberRoot=="function")try{_a.onPostCommitFiberRoot(Af,e)}catch{}n=!0}return n}finally{Lt=r,On.transition=t}}return!1}function v1(e,t,r){t=_o(r,t),t=q_(e,t,1),e=ki(e,t,1),t=qr(),e!==null&&(sc(e,1,t),ln(e,t))}function Yt(e,t,r){if(e.tag===3)v1(e,e,r);else for(;t!==null;){if(t.tag===3){v1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ei===null||!Ei.has(n))){e=_o(r,e),e=Y_(t,e,1),t=ki(t,e,1),e=qr(),t!==null&&(sc(t,1,e),ln(t,e));break}}t=t.return}}function LT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=qr(),e.pingedLanes|=e.suspendedLanes&r,_r===e&&(Tr&r)===r&&(dr===4||dr===3&&(Tr&130023424)===Tr&&500>tr()-Ep?ts(e,0):kp|=r),ln(e,t)}function gy(e,t){t===0&&(e.mode&1?(t=Zc,Zc<<=1,!(Zc&130023424)&&(Zc=4194304)):t=1);var r=qr();e=Za(e,t),e!==null&&(sc(e,t,r),ln(e,r))}function PT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),gy(e,r)}function FT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Te(314))}n!==null&&n.delete(t),gy(e,r)}var xy;xy=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||sn.current)nn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return nn=!1,_T(e,t,r);nn=!!(e.flags&131072)}else nn=!1,zt&&t.flags&1048576&&w_(t,Gu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Su(e,t),e=t.pendingProps;var a=mo(t,Br.current);so(t,r),a=gp(null,t,n,e,a,r);var i=xp();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,on(n)?(i=!0,Wu(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,fp(t),a.updater=Rf,t.stateNode=a,a._reactInternals=t,qd(t,n,e,r),t=Jd(null,t,n,!0,i,r)):(t.tag=0,zt&&i&&ap(t),Wr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Su(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=MT(n),e=$n(n,e),a){case 0:t=Kd(null,t,n,e,r);break e;case 1:t=l1(null,t,n,e,r);break e;case 11:t=s1(null,t,n,e,r);break e;case 14:t=o1(null,t,n,$n(n.type,e),r);break e}throw Error(Te(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$n(n,a),Kd(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$n(n,a),l1(e,t,n,a,r);case 3:e:{if(ey(t),e===null)throw Error(Te(387));n=t.pendingProps,i=t.memoizedState,a=i.element,b_(e,t),qu(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=_o(Error(Te(423)),t),t=c1(e,t,n,r,a);break e}else if(n!==a){a=_o(Error(Te(424)),t),t=c1(e,t,n,r,a);break e}else for(hn=wi(t.stateNode.containerInfo.firstChild),pn=t,zt=!0,Zn=null,r=T_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(go(),n===a){t=Xa(e,t,r);break e}Wr(e,t,n,r)}t=t.child}return t;case 5:return A_(t),e===null&&Gd(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,Ud(n,a)?o=null:i!==null&&Ud(n,i)&&(t.flags|=32),Q_(e,t),Wr(e,t,o,r),t.child;case 6:return e===null&&Gd(t),null;case 13:return ty(e,t,r);case 4:return dp(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=xo(t,null,n,r):Wr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$n(n,a),s1(e,t,n,a,r);case 7:return Wr(e,t,t.pendingProps,r),t.child;case 8:return Wr(e,t,t.pendingProps.children,r),t.child;case 12:return Wr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Ft(Zu,n._currentValue),n._currentValue=o,i!==null)if(ea(i.value,o)){if(i.children===a.children&&!sn.current){t=Xa(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=Ua(-1,r&-r),u.tag=2;var f=i.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Zd(i.return,r,t),l.lanes|=r;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Te(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Zd(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Wr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,so(t,r),a=Mn(a),n=n(a),t.flags|=1,Wr(e,t,n,r),t.child;case 14:return n=t.type,a=$n(n,t.pendingProps),a=$n(n.type,a),o1(e,t,n,a,r);case 15:return K_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$n(n,a),Su(e,t),t.tag=1,on(n)?(e=!0,Wu(t)):e=!1,so(t,r),X_(t,n,a),qd(t,n,a,r),Jd(null,t,n,!0,e,r);case 19:return ry(e,t,r);case 22:return J_(e,t,r)}throw Error(Te(156,t.tag))};function vy(e,t){return $v(e,t)}function OT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(e,t,r,n){return new OT(e,t,r,n)}function bp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function MT(e){if(typeof e=="function")return bp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gh)return 11;if(e===Zh)return 14}return 2}function Ti(e,t){var r=e.alternate;return r===null?(r=Fn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function bu(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")bp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Us:return rs(r.children,a,i,t);case $h:o=8,a|=8;break;case _d:return e=Fn(12,r,t,a|2),e.elementType=_d,e.lanes=i,e;case yd:return e=Fn(13,r,t,a),e.elementType=yd,e.lanes=i,e;case wd:return e=Fn(19,r,t,a),e.elementType=wd,e.lanes=i,e;case Av:return jf(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Cv:o=10;break e;case bv:o=9;break e;case Gh:o=11;break e;case Zh:o=14;break e;case oi:o=16,n=null;break e}throw Error(Te(130,e==null?e:typeof e,""))}return t=Fn(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function rs(e,t,r,n){return e=Fn(7,e,n,t),e.lanes=r,e}function jf(e,t,r,n){return e=Fn(22,e,n,t),e.elementType=Av,e.lanes=r,e.stateNode={isHidden:!1},e}function J0(e,t,r){return e=Fn(6,e,null,t),e.lanes=r,e}function Q0(e,t,r){return t=Fn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function RT(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=O0(0),this.expirationTimes=O0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ap(e,t,r,n,a,i,o,l,u){return e=new RT(e,t,r,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Fn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},fp(i),e}function DT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function _y(e){if(!e)return Ni;e=e._reactInternals;e:{if(xs(e)!==e||e.tag!==1)throw Error(Te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(on(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Te(171))}if(e.tag===1){var r=e.type;if(on(r))return __(e,r,t)}return t}function yy(e,t,r,n,a,i,o,l,u){return e=Ap(r,n,!0,e,a,i,o,l,u),e.context=_y(null),r=e.current,n=qr(),a=Si(r),i=Ua(n,a),i.callback=t??null,ki(r,i,a),e.current.lanes=a,sc(e,a,n),ln(e,n),e}function Bf(e,t,r,n){var a=t.current,i=qr(),o=Si(a);return r=_y(r),t.context===null?t.context=r:t.pendingContext=r,t=Ua(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ki(a,t,o),e!==null&&(Jn(e,a,o,i),wu(e,a,o)),o}function nf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Np(e,t){_1(e,t),(e=e.alternate)&&_1(e,t)}function IT(){return null}var wy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lp(e){this._internalRoot=e}zf.prototype.render=Lp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Te(409));Bf(e,t,null,null)};zf.prototype.unmount=Lp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;us(function(){Bf(null,e,null,null)}),t[Ga]=null}};function zf(e){this._internalRoot=e}zf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Jv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ci.length&&t!==0&&t<ci[r].priority;r++);ci.splice(r,0,e),r===0&&e_(e)}};function Pp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Uf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function y1(){}function jT(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var f=nf(o);i.call(f)}}var o=yy(t,n,e,0,null,!1,!1,"",y1);return e._reactRootContainer=o,e[Ga]=o.current,zl(e.nodeType===8?e.parentNode:e),us(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var f=nf(u);l.call(f)}}var u=Ap(e,0,!1,null,null,!1,!1,"",y1);return e._reactRootContainer=u,e[Ga]=u.current,zl(e.nodeType===8?e.parentNode:e),us(function(){Bf(t,u,r,n)}),u}function Hf(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var u=nf(o);l.call(u)}}Bf(t,o,e,a)}else o=jT(r,t,e,a,n);return nf(o)}Yv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=sl(t.pendingLanes);r!==0&&(Yh(t,r|1),ln(t,tr()),!(wt&6)&&(yo=tr()+500,Ri()))}break;case 13:us(function(){var n=Za(e,1);if(n!==null){var a=qr();Jn(n,e,1,a)}}),Np(e,1)}};Kh=function(e){if(e.tag===13){var t=Za(e,134217728);if(t!==null){var r=qr();Jn(t,e,134217728,r)}Np(e,134217728)}};Kv=function(e){if(e.tag===13){var t=Si(e),r=Za(e,t);if(r!==null){var n=qr();Jn(r,e,t,n)}Np(e,t)}};Jv=function(){return Lt};Qv=function(e,t){var r=Lt;try{return Lt=e,t()}finally{Lt=r}};Pd=function(e,t,r){switch(t){case"input":if(Sd(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Ff(n);if(!a)throw Error(Te(90));Lv(n),Sd(n,a)}}}break;case"textarea":Fv(e,r);break;case"select":t=r.value,t!=null&&ro(e,!!r.multiple,t,!1)}};Bv=Sp;zv=us;var BT={usingClientEntryPoint:!1,Events:[lc,$s,Ff,Iv,jv,Sp]},el={findFiberByHostInstance:qi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zT={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ja.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Vv(e),e===null?null:e.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||IT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{Af=au.inject(zT),_a=au}catch{}}vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BT;vn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pp(t))throw Error(Te(200));return DT(e,t,null,r)};vn.createRoot=function(e,t){if(!Pp(e))throw Error(Te(299));var r=!1,n="",a=wy;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Ap(e,1,!1,null,null,r,!1,n,a),e[Ga]=t.current,zl(e.nodeType===8?e.parentNode:e),new Lp(t)};vn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Te(188)):(e=Object.keys(e).join(","),Error(Te(268,e)));return e=Vv(t),e=e===null?null:e.stateNode,e};vn.flushSync=function(e){return us(e)};vn.hydrate=function(e,t,r){if(!Uf(t))throw Error(Te(200));return Hf(null,e,t,!0,r)};vn.hydrateRoot=function(e,t,r){if(!Pp(e))throw Error(Te(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=wy;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=yy(t,null,e,1,r??null,a,!1,i,o),e[Ga]=t.current,zl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new zf(t)};vn.render=function(e,t,r){if(!Uf(t))throw Error(Te(200));return Hf(null,e,t,!1,r)};vn.unmountComponentAtNode=function(e){if(!Uf(e))throw Error(Te(40));return e._reactRootContainer?(us(function(){Hf(null,null,e,!1,function(){e._reactRootContainer=null,e[Ga]=null})}),!0):!1};vn.unstable_batchedUpdates=Sp;vn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Uf(r))throw Error(Te(200));if(e==null||e._reactInternals===void 0)throw Error(Te(38));return Hf(e,t,r,!1,n)};vn.version="18.3.1-next-f1338f8080-20240426";function ky(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ky)}catch(e){console.error(e)}}ky(),kv.exports=vn;var Ey=kv.exports,w1=Ey;xd.createRoot=w1.createRoot,xd.hydrateRoot=w1.hydrateRoot;var Fp={};Object.defineProperty(Fp,"__esModule",{value:!0});Fp.parse=ZT;Fp.serialize=XT;const UT=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,HT=/^[\u0021-\u003A\u003C-\u007E]*$/,VT=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,WT=/^[\u0020-\u003A\u003D-\u007E]*$/,$T=Object.prototype.toString,GT=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function ZT(e,t){const r=new GT,n=e.length;if(n<2)return r;const a=(t==null?void 0:t.decode)||qT;let i=0;do{const o=e.indexOf("=",i);if(o===-1)break;const l=e.indexOf(";",i),u=l===-1?n:l;if(o>u){i=e.lastIndexOf(";",o-1)+1;continue}const f=k1(e,i,o),d=E1(e,o,f),m=e.slice(f,d);if(r[m]===void 0){let g=k1(e,o+1,u),v=E1(e,u,g);const y=a(e.slice(g,v));r[m]=y}i=u+1}while(i<n);return r}function k1(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function E1(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function XT(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!UT.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=n(t);if(!HT.test(a))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+a;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!VT.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!WT.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!YT(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function qT(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function YT(e){return $T.call(e)==="[object Date]"}/**
 * react-router v7.5.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function KT(e={}){let{initialEntries:t=["/"],initialIndex:r,v5Compat:n=!1}=e,a;a=t.map((v,y)=>d(v,typeof v=="string"?null:v.state,y===0?"default":void 0));let i=u(r??a.length-1),o="POP",l=null;function u(v){return Math.min(Math.max(v,0),a.length-1)}function f(){return a[i]}function d(v,y=null,_){let S=QT(a?f().pathname:"/",v,y,_);return Dn(S.pathname.charAt(0)==="/",`relative pathnames are not supported in memory history: ${JSON.stringify(v)}`),S}function m(v){return typeof v=="string"?v:af(v)}return{get index(){return i},get action(){return o},get location(){return f()},createHref:m,createURL(v){return new URL(m(v),"http://localhost")},encodeLocation(v){let y=typeof v=="string"?vs(v):v;return{pathname:y.pathname||"",search:y.search||"",hash:y.hash||""}},push(v,y){o="PUSH";let _=d(v,y);i+=1,a.splice(i,a.length,_),n&&l&&l({action:o,location:_,delta:1})},replace(v,y){o="REPLACE";let _=d(v,y);a[i]=_,n&&l&&l({action:o,location:_,delta:0})},go(v){o="POP";let y=u(i+v),_=a[y];i=y,l&&l({action:o,location:_,delta:v})},listen(v){return l=v,()=>{l=null}}}}function Gt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Dn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function JT(){return Math.random().toString(36).substring(2,10)}function QT(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?vs(t):t,state:r,key:t&&t.key||n||JT()}}function af({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function vs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function Sy(e,t,r="/"){return e4(e,t,r,!1)}function e4(e,t,r,n){let a=typeof t=="string"?vs(t):t,i=qa(a.pathname||"/",r);if(i==null)return null;let o=Ty(e);t4(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let f=d4(i);l=u4(o[u],f,n)}return l}function Ty(e,t=[],r=[],n=""){let a=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Gt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let f=Ha([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(Gt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Ty(i.children,t,d,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:l4(f,i.index),routesMeta:d})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let u of Cy(i.path))a(i,o,u)}),t}function Cy(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Cy(n.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function t4(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:c4(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var r4=/^:[\w-]+$/,n4=3,a4=2,i4=1,s4=10,o4=-2,S1=e=>e==="*";function l4(e,t){let r=e.split("/"),n=r.length;return r.some(S1)&&(n+=o4),t&&(n+=a4),r.filter(a=>!S1(a)).reduce((a,i)=>a+(r4.test(i)?n4:i===""?i4:s4),n)}function c4(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function u4(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],f=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",m=sf({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},d),g=u.route;if(!m&&f&&r&&!n[n.length-1].route.index&&(m=sf({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!m)return null;Object.assign(a,m.params),o.push({params:a,pathname:Ha([i,m.pathname]),pathnameBase:g4(Ha([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=Ha([i,m.pathnameBase]))}return o}function sf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=f4(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:m},g)=>{if(d==="*"){let y=l[g]||"";o=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const v=l[g];return m&&!v?f[d]=void 0:f[d]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:o,pattern:e}}function f4(e,t=!1,r=!0){Dn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function d4(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Dn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function qa(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function h4(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?vs(e):e;return{pathname:r?r.startsWith("/")?r:p4(r,t):t,search:x4(n),hash:v4(a)}}function p4(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ed(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function m4(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Op(e){let t=m4(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Mp(e,t,r,n=!1){let a;typeof e=="string"?a=vs(e):(a={...e},Gt(!a.pathname||!a.pathname.includes("?"),ed("?","pathname","search",a)),Gt(!a.pathname||!a.pathname.includes("#"),ed("#","pathname","hash",a)),Gt(!a.search||!a.search.includes("#"),ed("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;a.pathname=g.join("/")}l=m>=0?t[m]:"/"}let u=h4(a,l),f=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||d)&&(u.pathname+="/"),u}var Ha=e=>e.join("/").replace(/\/\/+/g,"/"),g4=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),x4=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,v4=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function _4(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var by=["POST","PUT","PATCH","DELETE"];new Set(by);var y4=["GET",...by];new Set(y4);var bo=A.createContext(null);bo.displayName="DataRouter";var Vf=A.createContext(null);Vf.displayName="DataRouterState";var Ay=A.createContext({isTransitioning:!1});Ay.displayName="ViewTransition";var w4=A.createContext(new Map);w4.displayName="Fetchers";var k4=A.createContext(null);k4.displayName="Await";var ta=A.createContext(null);ta.displayName="Navigation";var uc=A.createContext(null);uc.displayName="Location";var ra=A.createContext({outlet:null,matches:[],isDataRoute:!1});ra.displayName="Route";var Rp=A.createContext(null);Rp.displayName="RouteError";function E4(e,{relative:t}={}){Gt(Ao(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=A.useContext(ta),{hash:a,pathname:i,search:o}=fc(e,{relative:t}),l=i;return r!=="/"&&(l=i==="/"?r:Ha([r,i])),n.createHref({pathname:l,search:o,hash:a})}function Ao(){return A.useContext(uc)!=null}function Qa(){return Gt(Ao(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(uc).location}var Ny="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ly(e){A.useContext(ta).static||A.useLayoutEffect(e)}function ka(){let{isDataRoute:e}=A.useContext(ra);return e?I4():S4()}function S4(){Gt(Ao(),"useNavigate() may be used only in the context of a <Router> component.");let e=A.useContext(bo),{basename:t,navigator:r}=A.useContext(ta),{matches:n}=A.useContext(ra),{pathname:a}=Qa(),i=JSON.stringify(Op(n)),o=A.useRef(!1);return Ly(()=>{o.current=!0}),A.useCallback((u,f={})=>{if(Dn(o.current,Ny),!o.current)return;if(typeof u=="number"){r.go(u);return}let d=Mp(u,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ha([t,d.pathname])),(f.replace?r.replace:r.push)(d,f.state,f)},[t,r,i,a,e])}A.createContext(null);function T4(){let{matches:e}=A.useContext(ra),t=e[e.length-1];return t?t.params:{}}function fc(e,{relative:t}={}){let{matches:r}=A.useContext(ra),{pathname:n}=Qa(),a=JSON.stringify(Op(r));return A.useMemo(()=>Mp(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function C4(e,t){return Py(e,t)}function Py(e,t,r,n){var E;Gt(Ao(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=A.useContext(ta),{matches:o}=A.useContext(ra),l=o[o.length-1],u=l?l.params:{},f=l?l.pathname:"/",d=l?l.pathnameBase:"/",m=l&&l.route;{let w=m&&m.path||"";Fy(f,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let g=Qa(),v;if(t){let w=typeof t=="string"?vs(t):t;Gt(d==="/"||((E=w.pathname)==null?void 0:E.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${w.pathname}" was given in the \`location\` prop.`),v=w}else v=g;let y=v.pathname||"/",_=y;if(d!=="/"){let w=d.replace(/^\//,"").split("/");_="/"+y.replace(/^\//,"").split("/").slice(w.length).join("/")}let S=!i&&r&&r.matches&&r.matches.length>0?r.matches:Sy(e,{pathname:_});Dn(m||S!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Dn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=P4(S&&S.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:Ha([d,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:Ha([d,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n);return t&&k?A.createElement(uc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},k):k}function b4(){let e=D4(),t=_4(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:i},"ErrorBoundary")," or"," ",A.createElement("code",{style:i},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},t),r?A.createElement("pre",{style:a},r):null,o)}var A4=A.createElement(b4,null),N4=class extends A.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?A.createElement(ra.Provider,{value:this.props.routeContext},A.createElement(Rp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function L4({routeContext:e,match:t,children:r}){let n=A.useContext(bo);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),A.createElement(ra.Provider,{value:e},r)}function P4(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let u=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);Gt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,l=-1;if(r)for(let u=0;u<a.length;u++){let f=a[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=u),f.route.id){let{loaderData:d,errors:m}=r,g=f.route.loader&&!d.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((u,f,d)=>{let m,g=!1,v=null,y=null;r&&(m=i&&f.route.id?i[f.route.id]:void 0,v=f.route.errorElement||A4,o&&(l<0&&d===0?(Fy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,y=null):l===d&&(g=!0,y=f.route.hydrateFallbackElement||null)));let _=t.concat(a.slice(0,d+1)),S=()=>{let k;return m?k=v:g?k=y:f.route.Component?k=A.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=u,A.createElement(L4,{match:f,routeContext:{outlet:u,matches:_,isDataRoute:r!=null},children:k})};return r&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?A.createElement(N4,{location:r.location,revalidation:r.revalidation,component:v,error:m,children:S(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):S()},null)}function Dp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function F4(e){let t=A.useContext(bo);return Gt(t,Dp(e)),t}function O4(e){let t=A.useContext(Vf);return Gt(t,Dp(e)),t}function M4(e){let t=A.useContext(ra);return Gt(t,Dp(e)),t}function Ip(e){let t=M4(e),r=t.matches[t.matches.length-1];return Gt(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function R4(){return Ip("useRouteId")}function D4(){var n;let e=A.useContext(Rp),t=O4("useRouteError"),r=Ip("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function I4(){let{router:e}=F4("useNavigate"),t=Ip("useNavigate"),r=A.useRef(!1);return Ly(()=>{r.current=!0}),A.useCallback(async(a,i={})=>{Dn(r.current,Ny),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var T1={};function Fy(e,t,r){!t&&!T1[e]&&(T1[e]=!0,Dn(!1,r))}A.memo(j4);function j4({routes:e,future:t,state:r}){return Py(e,void 0,r,t)}function B4({basename:e,children:t,initialEntries:r,initialIndex:n}){let a=A.useRef();a.current==null&&(a.current=KT({initialEntries:r,initialIndex:n,v5Compat:!0}));let i=a.current,[o,l]=A.useState({action:i.action,location:i.location}),u=A.useCallback(f=>{A.startTransition(()=>l(f))},[l]);return A.useLayoutEffect(()=>i.listen(u),[i,u]),A.createElement(U4,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i})}function z4({to:e,replace:t,state:r,relative:n}){Gt(Ao(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=A.useContext(ta);Dn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=A.useContext(ra),{pathname:o}=Qa(),l=ka(),u=Mp(e,Op(i),o,n==="path"),f=JSON.stringify(u);return A.useEffect(()=>{l(JSON.parse(f),{replace:t,state:r,relative:n})},[l,f,n,t,r]),null}function Vr(e){Gt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function U4({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){Gt(!Ao(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=A.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof r=="string"&&(r=vs(r));let{pathname:u="/",search:f="",hash:d="",state:m=null,key:g="default"}=r,v=A.useMemo(()=>{let y=qa(u,o);return y==null?null:{location:{pathname:y,search:f,hash:d,state:m,key:g},navigationType:n}},[o,u,f,d,m,g,n]);return Dn(v!=null,`<Router basename="${o}"> is not able to match the URL "${u}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:A.createElement(ta.Provider,{value:l},A.createElement(uc.Provider,{children:t,value:v}))}function H4({children:e,location:t}){return C4(uh(e),t)}function uh(e,t=[]){let r=[];return A.Children.forEach(e,(n,a)=>{if(!A.isValidElement(n))return;let i=[...t,a];if(n.type===A.Fragment){r.push.apply(r,uh(n.props.children,i));return}Gt(n.type===Vr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=uh(n.props.children,i)),r.push(o)}),r}var Au="get",Nu="application/x-www-form-urlencoded";function Wf(e){return e!=null&&typeof e.tagName=="string"}function V4(e){return Wf(e)&&e.tagName.toLowerCase()==="button"}function W4(e){return Wf(e)&&e.tagName.toLowerCase()==="form"}function $4(e){return Wf(e)&&e.tagName.toLowerCase()==="input"}function G4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Z4(e,t){return e.button===0&&(!t||t==="_self")&&!G4(e)}var iu=null;function X4(){if(iu===null)try{new FormData(document.createElement("form"),0),iu=!1}catch{iu=!0}return iu}var q4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function td(e){return e!=null&&!q4.has(e)?(Dn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Nu}"`),null):e}function Y4(e,t){let r,n,a,i,o;if(W4(e)){let l=e.getAttribute("action");n=l?qa(l,t):null,r=e.getAttribute("method")||Au,a=td(e.getAttribute("enctype"))||Nu,i=new FormData(e)}else if(V4(e)||$4(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||l.getAttribute("action");if(n=u?qa(u,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||Au,a=td(e.getAttribute("formenctype"))||td(l.getAttribute("enctype"))||Nu,i=new FormData(l,e),!X4()){let{name:f,type:d,value:m}=e;if(d==="image"){let g=f?`${f}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else f&&i.append(f,m)}}else{if(Wf(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Au,n=null,a=Nu,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}function jp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function K4(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function J4(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Q4(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let o=await K4(i,r);return o.links?o.links():[]}return[]}));return nC(n.flat(1).filter(J4).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function C1(e,t,r,n,a,i){let o=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,l=(u,f)=>{var d;return r[f].pathname!==u.pathname||((d=r[f].route.path)==null?void 0:d.endsWith("*"))&&r[f].params["*"]!==u.params["*"]};return i==="assets"?t.filter((u,f)=>o(u,f)||l(u,f)):i==="data"?t.filter((u,f)=>{var m;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,f)||l(u,f))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function eC(e,t,{includeHydrateFallback:r}={}){return tC(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function tC(e){return[...new Set(e)]}function rC(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function nC(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(rC(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}var aC=new Set([100,101,204,205]);function iC(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&qa(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function Oy(){let e=A.useContext(bo);return jp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function sC(){let e=A.useContext(Vf);return jp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Bp=A.createContext(void 0);Bp.displayName="FrameworkContext";function My(){let e=A.useContext(Bp);return jp(e,"You must render this element inside a <HydratedRouter> element"),e}function oC(e,t){let r=A.useContext(Bp),[n,a]=A.useState(!1),[i,o]=A.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:f,onMouseLeave:d,onTouchStart:m}=t,g=A.useRef(null);A.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let _=k=>{k.forEach(E=>{o(E.isIntersecting)})},S=new IntersectionObserver(_,{threshold:.5});return g.current&&S.observe(g.current),()=>{S.disconnect()}}},[e]),A.useEffect(()=>{if(n){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[n]);let v=()=>{a(!0)},y=()=>{a(!1),o(!1)};return r?e!=="intent"?[i,g,{}]:[i,g,{onFocus:tl(l,v),onBlur:tl(u,y),onMouseEnter:tl(f,v),onMouseLeave:tl(d,y),onTouchStart:tl(m,v)}]:[!1,g,{}]}function tl(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function lC({page:e,...t}){let{router:r}=Oy(),n=A.useMemo(()=>Sy(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?A.createElement(uC,{page:e,matches:n,...t}):null}function cC(e){let{manifest:t,routeModules:r}=My(),[n,a]=A.useState([]);return A.useEffect(()=>{let i=!1;return Q4(e,t,r).then(o=>{i||a(o)}),()=>{i=!0}},[e,t,r]),n}function uC({page:e,matches:t,...r}){let n=Qa(),{manifest:a,routeModules:i}=My(),{basename:o}=Oy(),{loaderData:l,matches:u}=sC(),f=A.useMemo(()=>C1(e,t,u,a,n,"data"),[e,t,u,a,n]),d=A.useMemo(()=>C1(e,t,u,a,n,"assets"),[e,t,u,a,n]),m=A.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let y=new Set,_=!1;if(t.forEach(k=>{var w;let E=a.routes[k.route.id];!E||!E.hasLoader||(!f.some(N=>N.route.id===k.route.id)&&k.route.id in l&&((w=i[k.route.id])!=null&&w.shouldRevalidate)||E.hasClientLoader?_=!0:y.add(k.route.id))}),y.size===0)return[];let S=iC(e,o);return _&&y.size>0&&S.searchParams.set("_routes",t.filter(k=>y.has(k.route.id)).map(k=>k.route.id).join(",")),[S.pathname+S.search]},[o,l,n,a,f,t,e,i]),g=A.useMemo(()=>eC(d,a),[d,a]),v=cC(d);return A.createElement(A.Fragment,null,m.map(y=>A.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),g.map(y=>A.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),v.map(({key:y,link:_})=>A.createElement("link",{key:y,..._})))}function fC(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Ry=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Ry&&(window.__reactRouterVersion="7.5.1")}catch{}var Dy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dc=A.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:l,target:u,to:f,preventScrollReset:d,viewTransition:m,...g},v){let{basename:y}=A.useContext(ta),_=typeof f=="string"&&Dy.test(f),S,k=!1;if(typeof f=="string"&&_&&(S=f,Ry))try{let z=new URL(window.location.href),W=f.startsWith("//")?new URL(z.protocol+f):new URL(f),B=qa(W.pathname,y);W.origin===z.origin&&B!=null?f=B+W.search+W.hash:k=!0}catch{Dn(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=E4(f,{relative:a}),[w,N,I]=oC(n,g),D=mC(f,{replace:o,state:l,target:u,preventScrollReset:d,relative:a,viewTransition:m});function P(z){t&&t(z),z.defaultPrevented||D(z)}let V=A.createElement("a",{...g,...I,href:S||E,onClick:k||i?t:P,ref:fC(v,N),target:u,"data-discover":!_&&r==="render"?"true":void 0});return w&&!_?A.createElement(A.Fragment,null,V,A.createElement(lC,{page:E})):V});dc.displayName="Link";var dC=A.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:l,children:u,...f},d){let m=fc(o,{relative:f.relative}),g=Qa(),v=A.useContext(Vf),{navigator:y,basename:_}=A.useContext(ta),S=v!=null&&yC(m)&&l===!0,k=y.encodeLocation?y.encodeLocation(m).pathname:m.pathname,E=g.pathname,w=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(E=E.toLowerCase(),w=w?w.toLowerCase():null,k=k.toLowerCase()),w&&_&&(w=qa(w,_)||w);const N=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let I=E===k||!a&&E.startsWith(k)&&E.charAt(N)==="/",D=w!=null&&(w===k||!a&&w.startsWith(k)&&w.charAt(k.length)==="/"),P={isActive:I,isPending:D,isTransitioning:S},V=I?t:void 0,z;typeof n=="function"?z=n(P):z=[n,I?"active":null,D?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let W=typeof i=="function"?i(P):i;return A.createElement(dc,{...f,"aria-current":V,className:z,ref:d,style:W,to:o,viewTransition:l},typeof u=="function"?u(P):u)});dC.displayName="NavLink";var hC=A.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Au,action:l,onSubmit:u,relative:f,preventScrollReset:d,viewTransition:m,...g},v)=>{let y=vC(),_=_C(l,{relative:f}),S=o.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&Dy.test(l),E=w=>{if(u&&u(w),w.defaultPrevented)return;w.preventDefault();let N=w.nativeEvent.submitter,I=(N==null?void 0:N.getAttribute("formmethod"))||o;y(N||w.currentTarget,{fetcherKey:t,method:I,navigate:r,replace:a,state:i,relative:f,preventScrollReset:d,viewTransition:m})};return A.createElement("form",{ref:v,method:S,action:_,onSubmit:n?u:E,...g,"data-discover":!k&&e==="render"?"true":void 0})});hC.displayName="Form";function pC(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Iy(e){let t=A.useContext(bo);return Gt(t,pC(e)),t}function mC(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o}={}){let l=ka(),u=Qa(),f=fc(e,{relative:i});return A.useCallback(d=>{if(Z4(d,t)){d.preventDefault();let m=r!==void 0?r:af(u)===af(f);l(e,{replace:m,state:n,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,f,r,n,t,e,a,i,o])}var gC=0,xC=()=>`__${String(++gC)}__`;function vC(){let{router:e}=Iy("useSubmit"),{basename:t}=A.useContext(ta),r=R4();return A.useCallback(async(n,a={})=>{let{action:i,method:o,encType:l,formData:u,body:f}=Y4(n,t);if(a.navigate===!1){let d=a.fetcherKey||xC();await e.fetch(d,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function _C(e,{relative:t}={}){let{basename:r}=A.useContext(ta),n=A.useContext(ra);Gt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...fc(e||".",{relative:t})},o=Qa();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(d=>d==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let d=l.toString();i.search=d?`?${d}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Ha([r,i.pathname])),af(i)}function yC(e,t={}){let r=A.useContext(Ay);Gt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Iy("useViewTransitionState"),a=fc(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=qa(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=qa(r.nextLocation.pathname,n)||r.nextLocation.pathname;return sf(a.pathname,o)!=null||sf(a.pathname,i)!=null}new TextEncoder;[...aC];function jy(e,t){return function(){return e.apply(t,arguments)}}const{toString:wC}=Object.prototype,{getPrototypeOf:zp}=Object,$f=(e=>t=>{const r=wC.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),na=e=>(e=e.toLowerCase(),t=>$f(t)===e),Gf=e=>t=>typeof t===e,{isArray:No}=Array,ql=Gf("undefined");function kC(e){return e!==null&&!ql(e)&&e.constructor!==null&&!ql(e.constructor)&&mn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const By=na("ArrayBuffer");function EC(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&By(e.buffer),t}const SC=Gf("string"),mn=Gf("function"),zy=Gf("number"),Zf=e=>e!==null&&typeof e=="object",TC=e=>e===!0||e===!1,Lu=e=>{if($f(e)!=="object")return!1;const t=zp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},CC=na("Date"),bC=na("File"),AC=na("Blob"),NC=na("FileList"),LC=e=>Zf(e)&&mn(e.pipe),PC=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||mn(e.append)&&((t=$f(e))==="formdata"||t==="object"&&mn(e.toString)&&e.toString()==="[object FormData]"))},FC=na("URLSearchParams"),[OC,MC,RC,DC]=["ReadableStream","Request","Response","Headers"].map(na),IC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),No(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,e[l],l,e)}}function Uy(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Ji=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Hy=e=>!ql(e)&&e!==Ji;function fh(){const{caseless:e}=Hy(this)&&this||{},t={},r=(n,a)=>{const i=e&&Uy(t,a)||a;Lu(t[i])&&Lu(n)?t[i]=fh(t[i],n):Lu(n)?t[i]=fh({},n):No(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&hc(arguments[n],r);return t}const jC=(e,t,r,{allOwnKeys:n}={})=>(hc(t,(a,i)=>{r&&mn(a)?e[i]=jy(a,r):e[i]=a},{allOwnKeys:n}),e),BC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),zC=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},UC=(e,t,r,n)=>{let a,i,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&zp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},HC=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},VC=e=>{if(!e)return null;if(No(e))return e;let t=e.length;if(!zy(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},WC=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&zp(Uint8Array)),$C=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},GC=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},ZC=na("HTMLFormElement"),XC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),b1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),qC=na("RegExp"),Vy=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};hc(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},YC=e=>{Vy(e,(t,r)=>{if(mn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(mn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},KC=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return No(e)?n(e):n(String(e).split(t)),r},JC=()=>{},QC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function e3(e){return!!(e&&mn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const t3=e=>{const t=new Array(10),r=(n,a)=>{if(Zf(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=No(n)?[]:{};return hc(n,(o,l)=>{const u=r(o,a+1);!ql(u)&&(i[l]=u)}),t[a]=void 0,i}}return n};return r(e,0)},r3=na("AsyncFunction"),n3=e=>e&&(Zf(e)||mn(e))&&mn(e.then)&&mn(e.catch),Wy=((e,t)=>e?setImmediate:t?((r,n)=>(Ji.addEventListener("message",({source:a,data:i})=>{a===Ji&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Ji.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",mn(Ji.postMessage)),a3=typeof queueMicrotask<"u"?queueMicrotask.bind(Ji):typeof process<"u"&&process.nextTick||Wy,ue={isArray:No,isArrayBuffer:By,isBuffer:kC,isFormData:PC,isArrayBufferView:EC,isString:SC,isNumber:zy,isBoolean:TC,isObject:Zf,isPlainObject:Lu,isReadableStream:OC,isRequest:MC,isResponse:RC,isHeaders:DC,isUndefined:ql,isDate:CC,isFile:bC,isBlob:AC,isRegExp:qC,isFunction:mn,isStream:LC,isURLSearchParams:FC,isTypedArray:WC,isFileList:NC,forEach:hc,merge:fh,extend:jC,trim:IC,stripBOM:BC,inherits:zC,toFlatObject:UC,kindOf:$f,kindOfTest:na,endsWith:HC,toArray:VC,forEachEntry:$C,matchAll:GC,isHTMLForm:ZC,hasOwnProperty:b1,hasOwnProp:b1,reduceDescriptors:Vy,freezeMethods:YC,toObjectSet:KC,toCamelCase:XC,noop:JC,toFiniteNumber:QC,findKey:Uy,global:Ji,isContextDefined:Hy,isSpecCompliantForm:e3,toJSONObject:t3,isAsyncFn:r3,isThenable:n3,setImmediate:Wy,asap:a3};function rt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}ue.inherits(rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ue.toJSONObject(this.config),code:this.code,status:this.status}}});const $y=rt.prototype,Gy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Gy[e]={value:e}});Object.defineProperties(rt,Gy);Object.defineProperty($y,"isAxiosError",{value:!0});rt.from=(e,t,r,n,a,i)=>{const o=Object.create($y);return ue.toFlatObject(e,o,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),rt.call(o,e.message,t,r,n,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const i3=null;function dh(e){return ue.isPlainObject(e)||ue.isArray(e)}function Zy(e){return ue.endsWith(e,"[]")?e.slice(0,-2):e}function A1(e,t,r){return e?e.concat(t).map(function(a,i){return a=Zy(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function s3(e){return ue.isArray(e)&&!e.some(dh)}const o3=ue.toFlatObject(ue,{},null,function(t){return/^is[A-Z]/.test(t)});function Xf(e,t,r){if(!ue.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ue.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,S){return!ue.isUndefined(S[_])});const n=r.metaTokens,a=r.visitor||d,i=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&ue.isSpecCompliantForm(t);if(!ue.isFunction(a))throw new TypeError("visitor must be a function");function f(y){if(y===null)return"";if(ue.isDate(y))return y.toISOString();if(!u&&ue.isBlob(y))throw new rt("Blob is not supported. Use a Buffer instead.");return ue.isArrayBuffer(y)||ue.isTypedArray(y)?u&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function d(y,_,S){let k=y;if(y&&!S&&typeof y=="object"){if(ue.endsWith(_,"{}"))_=n?_:_.slice(0,-2),y=JSON.stringify(y);else if(ue.isArray(y)&&s3(y)||(ue.isFileList(y)||ue.endsWith(_,"[]"))&&(k=ue.toArray(y)))return _=Zy(_),k.forEach(function(w,N){!(ue.isUndefined(w)||w===null)&&t.append(o===!0?A1([_],N,i):o===null?_:_+"[]",f(w))}),!1}return dh(y)?!0:(t.append(A1(S,_,i),f(y)),!1)}const m=[],g=Object.assign(o3,{defaultVisitor:d,convertValue:f,isVisitable:dh});function v(y,_){if(!ue.isUndefined(y)){if(m.indexOf(y)!==-1)throw Error("Circular reference detected in "+_.join("."));m.push(y),ue.forEach(y,function(k,E){(!(ue.isUndefined(k)||k===null)&&a.call(t,k,ue.isString(E)?E.trim():E,_,g))===!0&&v(k,_?_.concat(E):[E])}),m.pop()}}if(!ue.isObject(e))throw new TypeError("data must be an object");return v(e),t}function N1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Up(e,t){this._pairs=[],e&&Xf(e,this,t)}const Xy=Up.prototype;Xy.append=function(t,r){this._pairs.push([t,r])};Xy.toString=function(t){const r=t?function(n){return t.call(this,n,N1)}:N1;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function l3(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function qy(e,t,r){if(!t)return e;const n=r&&r.encode||l3;ue.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=ue.isURLSearchParams(t)?t.toString():new Up(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class L1{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ue.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Yy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},c3=typeof URLSearchParams<"u"?URLSearchParams:Up,u3=typeof FormData<"u"?FormData:null,f3=typeof Blob<"u"?Blob:null,d3={isBrowser:!0,classes:{URLSearchParams:c3,FormData:u3,Blob:f3},protocols:["http","https","file","blob","url","data"]},Hp=typeof window<"u"&&typeof document<"u",hh=typeof navigator=="object"&&navigator||void 0,h3=Hp&&(!hh||["ReactNative","NativeScript","NS"].indexOf(hh.product)<0),p3=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",m3=Hp&&window.location.href||"http://localhost",g3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Hp,hasStandardBrowserEnv:h3,hasStandardBrowserWebWorkerEnv:p3,navigator:hh,origin:m3},Symbol.toStringTag,{value:"Module"})),Rr={...g3,...d3};function x3(e,t){return Xf(e,new Rr.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Rr.isNode&&ue.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function v3(e){return ue.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function _3(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function Ky(e){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=i>=r.length;return o=!o&&ue.isArray(a)?a.length:o,u?(ue.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!ue.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&ue.isArray(a[o])&&(a[o]=_3(a[o])),!l)}if(ue.isFormData(e)&&ue.isFunction(e.entries)){const r={};return ue.forEachEntry(e,(n,a)=>{t(v3(n),a,r,0)}),r}return null}function y3(e,t,r){if(ue.isString(e))try{return(t||JSON.parse)(e),ue.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const pc={transitional:Yy,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=ue.isObject(t);if(i&&ue.isHTMLForm(t)&&(t=new FormData(t)),ue.isFormData(t))return a?JSON.stringify(Ky(t)):t;if(ue.isArrayBuffer(t)||ue.isBuffer(t)||ue.isStream(t)||ue.isFile(t)||ue.isBlob(t)||ue.isReadableStream(t))return t;if(ue.isArrayBufferView(t))return t.buffer;if(ue.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return x3(t,this.formSerializer).toString();if((l=ue.isFileList(t))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Xf(l?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),y3(t)):t}],transformResponse:[function(t){const r=this.transitional||pc.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(ue.isResponse(t)||ue.isReadableStream(t))return t;if(t&&ue.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?rt.from(l,rt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rr.classes.FormData,Blob:Rr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ue.forEach(["delete","get","head","post","put","patch"],e=>{pc.headers[e]={}});const w3=ue.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),k3=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&w3[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},P1=Symbol("internals");function rl(e){return e&&String(e).trim().toLowerCase()}function Pu(e){return e===!1||e==null?e:ue.isArray(e)?e.map(Pu):String(e)}function E3(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const S3=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function rd(e,t,r,n,a){if(ue.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!ue.isString(t)){if(ue.isString(n))return t.indexOf(n)!==-1;if(ue.isRegExp(n))return n.test(t)}}function T3(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function C3(e,t){const r=ue.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}class cn{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(l,u,f){const d=rl(u);if(!d)throw new Error("header name must be a non-empty string");const m=ue.findKey(a,d);(!m||a[m]===void 0||f===!0||f===void 0&&a[m]!==!1)&&(a[m||u]=Pu(l))}const o=(l,u)=>ue.forEach(l,(f,d)=>i(f,d,u));if(ue.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(ue.isString(t)&&(t=t.trim())&&!S3(t))o(k3(t),r);else if(ue.isHeaders(t))for(const[l,u]of t.entries())i(u,l,n);else t!=null&&i(r,t,n);return this}get(t,r){if(t=rl(t),t){const n=ue.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return E3(a);if(ue.isFunction(r))return r.call(this,a,n);if(ue.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=rl(t),t){const n=ue.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||rd(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=rl(o),o){const l=ue.findKey(n,o);l&&(!r||rd(n,n[l],l,r))&&(delete n[l],a=!0)}}return ue.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||rd(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return ue.forEach(this,(a,i)=>{const o=ue.findKey(n,i);if(o){r[o]=Pu(a),delete r[i];return}const l=t?T3(i):String(i).trim();l!==i&&delete r[i],r[l]=Pu(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ue.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&ue.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[P1]=this[P1]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=rl(o);n[l]||(C3(a,o),n[l]=!0)}return ue.isArray(t)?t.forEach(i):i(t),this}}cn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ue.reduceDescriptors(cn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});ue.freezeMethods(cn);function nd(e,t){const r=this||pc,n=t||r,a=cn.from(n.headers);let i=n.data;return ue.forEach(e,function(l){i=l.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function Jy(e){return!!(e&&e.__CANCEL__)}function Lo(e,t,r){rt.call(this,e??"canceled",rt.ERR_CANCELED,t,r),this.name="CanceledError"}ue.inherits(Lo,rt,{__CANCEL__:!0});function Qy(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new rt("Request failed with status code "+r.status,[rt.ERR_BAD_REQUEST,rt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function b3(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function A3(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(u){const f=Date.now(),d=n[i];o||(o=f),r[a]=u,n[a]=f;let m=i,g=0;for(;m!==a;)g+=r[m++],m=m%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),f-o<t)return;const v=d&&f-d;return v?Math.round(g*1e3/v):void 0}}function N3(e,t){let r=0,n=1e3/t,a,i;const o=(f,d=Date.now())=>{r=d,a=null,i&&(clearTimeout(i),i=null),e.apply(null,f)};return[(...f)=>{const d=Date.now(),m=d-r;m>=n?o(f,d):(a=f,i||(i=setTimeout(()=>{i=null,o(a)},n-m)))},()=>a&&o(a)]}const of=(e,t,r=3)=>{let n=0;const a=A3(50,250);return N3(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,u=o-n,f=a(u),d=o<=l;n=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:f||void 0,estimated:f&&l&&d?(l-o)/f:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},F1=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},O1=e=>(...t)=>ue.asap(()=>e(...t)),L3=Rr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Rr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Rr.origin),Rr.navigator&&/(msie|trident)/i.test(Rr.navigator.userAgent)):()=>!0,P3=Rr.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];ue.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),ue.isString(n)&&o.push("path="+n),ue.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function F3(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function O3(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function e2(e,t,r){let n=!F3(t);return e&&(n||r==!1)?O3(e,t):t}const M1=e=>e instanceof cn?{...e}:e;function fs(e,t){t=t||{};const r={};function n(f,d,m,g){return ue.isPlainObject(f)&&ue.isPlainObject(d)?ue.merge.call({caseless:g},f,d):ue.isPlainObject(d)?ue.merge({},d):ue.isArray(d)?d.slice():d}function a(f,d,m,g){if(ue.isUndefined(d)){if(!ue.isUndefined(f))return n(void 0,f,m,g)}else return n(f,d,m,g)}function i(f,d){if(!ue.isUndefined(d))return n(void 0,d)}function o(f,d){if(ue.isUndefined(d)){if(!ue.isUndefined(f))return n(void 0,f)}else return n(void 0,d)}function l(f,d,m){if(m in t)return n(f,d);if(m in e)return n(void 0,f)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(f,d,m)=>a(M1(f),M1(d),m,!0)};return ue.forEach(Object.keys(Object.assign({},e,t)),function(d){const m=u[d]||a,g=m(e[d],t[d],d);ue.isUndefined(g)&&m!==l||(r[d]=g)}),r}const t2=e=>{const t=fs({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=t;t.headers=o=cn.from(o),t.url=qy(e2(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let u;if(ue.isFormData(r)){if(Rr.hasStandardBrowserEnv||Rr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[f,...d]=u?u.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([f||"multipart/form-data",...d].join("; "))}}if(Rr.hasStandardBrowserEnv&&(n&&ue.isFunction(n)&&(n=n(t)),n||n!==!1&&L3(t.url))){const f=a&&i&&P3.read(i);f&&o.set(a,f)}return t},M3=typeof XMLHttpRequest<"u",R3=M3&&function(e){return new Promise(function(r,n){const a=t2(e);let i=a.data;const o=cn.from(a.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:f}=a,d,m,g,v,y;function _(){v&&v(),y&&y(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let S=new XMLHttpRequest;S.open(a.method.toUpperCase(),a.url,!0),S.timeout=a.timeout;function k(){if(!S)return;const w=cn.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),I={data:!l||l==="text"||l==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:w,config:e,request:S};Qy(function(P){r(P),_()},function(P){n(P),_()},I),S=null}"onloadend"in S?S.onloadend=k:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(k)},S.onabort=function(){S&&(n(new rt("Request aborted",rt.ECONNABORTED,e,S)),S=null)},S.onerror=function(){n(new rt("Network Error",rt.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let N=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const I=a.transitional||Yy;a.timeoutErrorMessage&&(N=a.timeoutErrorMessage),n(new rt(N,I.clarifyTimeoutError?rt.ETIMEDOUT:rt.ECONNABORTED,e,S)),S=null},i===void 0&&o.setContentType(null),"setRequestHeader"in S&&ue.forEach(o.toJSON(),function(N,I){S.setRequestHeader(I,N)}),ue.isUndefined(a.withCredentials)||(S.withCredentials=!!a.withCredentials),l&&l!=="json"&&(S.responseType=a.responseType),f&&([g,y]=of(f,!0),S.addEventListener("progress",g)),u&&S.upload&&([m,v]=of(u),S.upload.addEventListener("progress",m),S.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(d=w=>{S&&(n(!w||w.type?new Lo(null,e,S):w),S.abort(),S=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const E=b3(a.url);if(E&&Rr.protocols.indexOf(E)===-1){n(new rt("Unsupported protocol "+E+":",rt.ERR_BAD_REQUEST,e));return}S.send(i||null)})},D3=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(f){if(!a){a=!0,l();const d=f instanceof Error?f:this.reason;n.abort(d instanceof rt?d:new Lo(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new rt(`timeout ${t} of ms exceeded`,rt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),e=null)};e.forEach(f=>f.addEventListener("abort",i));const{signal:u}=n;return u.unsubscribe=()=>ue.asap(l),u}},I3=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},j3=async function*(e,t){for await(const r of B3(e))yield*I3(r,t)},B3=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},R1=(e,t,r,n)=>{const a=j3(e,t);let i=0,o,l=u=>{o||(o=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:f,value:d}=await a.next();if(f){l(),u.close();return}let m=d.byteLength;if(r){let g=i+=m;r(g)}u.enqueue(new Uint8Array(d))}catch(f){throw l(f),f}},cancel(u){return l(u),a.return()}},{highWaterMark:2})},qf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",r2=qf&&typeof ReadableStream=="function",z3=qf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),n2=(e,...t)=>{try{return!!e(...t)}catch{return!1}},U3=r2&&n2(()=>{let e=!1;const t=new Request(Rr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),D1=64*1024,ph=r2&&n2(()=>ue.isReadableStream(new Response("").body)),lf={stream:ph&&(e=>e.body)};qf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!lf[t]&&(lf[t]=ue.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new rt(`Response type '${t}' is not supported`,rt.ERR_NOT_SUPPORT,n)})})})(new Response);const H3=async e=>{if(e==null)return 0;if(ue.isBlob(e))return e.size;if(ue.isSpecCompliantForm(e))return(await new Request(Rr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ue.isArrayBufferView(e)||ue.isArrayBuffer(e))return e.byteLength;if(ue.isURLSearchParams(e)&&(e=e+""),ue.isString(e))return(await z3(e)).byteLength},V3=async(e,t)=>{const r=ue.toFiniteNumber(e.getContentLength());return r??H3(t)},W3=qf&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:u,responseType:f,headers:d,withCredentials:m="same-origin",fetchOptions:g}=t2(e);f=f?(f+"").toLowerCase():"text";let v=D3([a,i&&i.toAbortSignal()],o),y;const _=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let S;try{if(u&&U3&&r!=="get"&&r!=="head"&&(S=await V3(d,n))!==0){let I=new Request(t,{method:"POST",body:n,duplex:"half"}),D;if(ue.isFormData(n)&&(D=I.headers.get("content-type"))&&d.setContentType(D),I.body){const[P,V]=F1(S,of(O1(u)));n=R1(I.body,D1,P,V)}}ue.isString(m)||(m=m?"include":"omit");const k="credentials"in Request.prototype;y=new Request(t,{...g,signal:v,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:k?m:void 0});let E=await fetch(y);const w=ph&&(f==="stream"||f==="response");if(ph&&(l||w&&_)){const I={};["status","statusText","headers"].forEach(z=>{I[z]=E[z]});const D=ue.toFiniteNumber(E.headers.get("content-length")),[P,V]=l&&F1(D,of(O1(l),!0))||[];E=new Response(R1(E.body,D1,P,()=>{V&&V(),_&&_()}),I)}f=f||"text";let N=await lf[ue.findKey(lf,f)||"text"](E,e);return!w&&_&&_(),await new Promise((I,D)=>{Qy(I,D,{data:N,headers:cn.from(E.headers),status:E.status,statusText:E.statusText,config:e,request:y})})}catch(k){throw _&&_(),k&&k.name==="TypeError"&&/fetch/i.test(k.message)?Object.assign(new rt("Network Error",rt.ERR_NETWORK,e,y),{cause:k.cause||k}):rt.from(k,k&&k.code,e,y)}}),mh={http:i3,xhr:R3,fetch:W3};ue.forEach(mh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const I1=e=>`- ${e}`,$3=e=>ue.isFunction(e)||e===null||e===!1,a2={getAdapter:e=>{e=ue.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!$3(r)&&(n=mh[(o=String(r)).toLowerCase()],n===void 0))throw new rt(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(I1).join(`
`):" "+I1(i[0]):"as no adapter specified";throw new rt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:mh};function ad(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Lo(null,e)}function j1(e){return ad(e),e.headers=cn.from(e.headers),e.data=nd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),a2.getAdapter(e.adapter||pc.adapter)(e).then(function(n){return ad(e),n.data=nd.call(e,e.transformResponse,n),n.headers=cn.from(n.headers),n},function(n){return Jy(n)||(ad(e),n&&n.response&&(n.response.data=nd.call(e,e.transformResponse,n.response),n.response.headers=cn.from(n.response.headers))),Promise.reject(n)})}const i2="1.8.4",Yf={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Yf[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const B1={};Yf.transitional=function(t,r,n){function a(i,o){return"[Axios v"+i2+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new rt(a(o," has been removed"+(r?" in "+r:"")),rt.ERR_DEPRECATED);return r&&!B1[o]&&(B1[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};Yf.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function G3(e,t,r){if(typeof e!="object")throw new rt("options must be an object",rt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const l=e[i],u=l===void 0||o(l,i,e);if(u!==!0)throw new rt("option "+i+" must be "+u,rt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new rt("Unknown option "+i,rt.ERR_BAD_OPTION)}}const Fu={assertOptions:G3,validators:Yf},fa=Fu.validators;class ns{constructor(t){this.defaults=t,this.interceptors={request:new L1,response:new L1}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=fs(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Fu.assertOptions(n,{silentJSONParsing:fa.transitional(fa.boolean),forcedJSONParsing:fa.transitional(fa.boolean),clarifyTimeoutError:fa.transitional(fa.boolean)},!1),a!=null&&(ue.isFunction(a)?r.paramsSerializer={serialize:a}:Fu.assertOptions(a,{encode:fa.function,serialize:fa.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Fu.assertOptions(r,{baseUrl:fa.spelling("baseURL"),withXsrfToken:fa.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&ue.merge(i.common,i[r.method]);i&&ue.forEach(["delete","get","head","post","put","patch","common"],y=>{delete i[y]}),r.headers=cn.concat(o,i);const l=[];let u=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(r)===!1||(u=u&&_.synchronous,l.unshift(_.fulfilled,_.rejected))});const f=[];this.interceptors.response.forEach(function(_){f.push(_.fulfilled,_.rejected)});let d,m=0,g;if(!u){const y=[j1.bind(this),void 0];for(y.unshift.apply(y,l),y.push.apply(y,f),g=y.length,d=Promise.resolve(r);m<g;)d=d.then(y[m++],y[m++]);return d}g=l.length;let v=r;for(m=0;m<g;){const y=l[m++],_=l[m++];try{v=y(v)}catch(S){_.call(this,S);break}}try{d=j1.call(this,v)}catch(y){return Promise.reject(y)}for(m=0,g=f.length;m<g;)d=d.then(f[m++],f[m++]);return d}getUri(t){t=fs(this.defaults,t);const r=e2(t.baseURL,t.url,t.allowAbsoluteUrls);return qy(r,t.params,t.paramsSerializer)}}ue.forEach(["delete","get","head","options"],function(t){ns.prototype[t]=function(r,n){return this.request(fs(n||{},{method:t,url:r,data:(n||{}).data}))}});ue.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(fs(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ns.prototype[t]=r(),ns.prototype[t+"Form"]=r(!0)});class Vp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new Lo(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Vp(function(a){t=a}),cancel:t}}}function Z3(e){return function(r){return e.apply(null,r)}}function X3(e){return ue.isObject(e)&&e.isAxiosError===!0}const gh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(gh).forEach(([e,t])=>{gh[t]=e});function s2(e){const t=new ns(e),r=jy(ns.prototype.request,t);return ue.extend(r,ns.prototype,t,{allOwnKeys:!0}),ue.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return s2(fs(e,a))},r}const $e=s2(pc);$e.Axios=ns;$e.CanceledError=Lo;$e.CancelToken=Vp;$e.isCancel=Jy;$e.VERSION=i2;$e.toFormData=Xf;$e.AxiosError=rt;$e.Cancel=$e.CanceledError;$e.all=function(t){return Promise.all(t)};$e.spread=Z3;$e.isAxiosError=X3;$e.mergeConfig=fs;$e.AxiosHeaders=cn;$e.formToJSON=e=>Ky(ue.isHTMLForm(e)?new FormData(e):e);$e.getAdapter=a2.getAdapter;$e.HttpStatusCode=gh;$e.default=$e;const Wt="http://127.0.0.1:8000/api",z1={CAMERAS:{LIST:"/cameras/cameras/",UPLOAD:"/cameras/cameras/upload_csv/",DETAIL:e=>`/cameras/cameras/${e}/`},COMMANDS:{SAVE_CONFIG:"/command/commands/save_config/",EXECUTE:"/command/execute/"},AUTH:{LOGIN:"/auth/token/",REFRESH:"/auth/token/refresh/"}};function o2(e){var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null}let xh=null;const q3=e=>{xh=e},cf=e=>{xh?xh(e):window.location.href=e},Zr=$e.create({baseURL:Wt,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});Zr.interceptors.request.use(e=>{var t;if(["post","put","patch","delete"].includes(((t=e.method)==null?void 0:t.toLowerCase())||"")){const r=o2("csrftoken");r&&(e.headers["X-CSRFToken"]=r)}return e});Zr.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refreshToken");if(n){const a=await $e.post(`${Wt}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"X-CSRFToken":o2("csrftoken")}}),{access:i}=a.data;return localStorage.setItem("token",i),Zr.defaults.headers.common.Authorization=`Bearer ${i}`,t.headers.Authorization=`Bearer ${i}`,Zr(t)}}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),cf("/login")}}return Promise.reject(e)});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Y3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),yt=(e,t)=>{const r=A.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,...f},d)=>A.createElement("svg",{ref:d,...Y3,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${K3(e)}`,l].join(" "),...f},[...t.map(([m,g])=>A.createElement(m,g)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=yt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=yt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=yt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=yt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=yt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=yt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=yt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=yt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=yt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=yt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=yt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=yt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=yt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=yt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=yt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=yt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=yt("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=yt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=yt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=yt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=yt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=yt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=yt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=yt("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=yt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=yt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=yt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=yt("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=yt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=yt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=yt("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V1=yt("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);function ub({onLogin:e}){const t=ka(),[r,n]=A.useState(""),[a,i]=A.useState(""),[o,l]=A.useState(""),[u,f]=A.useState(!1);A.useEffect(()=>{(async()=>{try{await Zr.get("/auth/csrf/")}catch(g){console.error("Error initializing CSRF:",g)}})()},[]);const d=async m=>{var g,v;m.preventDefault(),f(!0),l("");try{const y={username:r,password:a},_=await Zr.post("/auth/login/",y);localStorage.setItem("token",_.data.access),localStorage.setItem("refreshToken",_.data.refresh),Zr.defaults.headers.common.Authorization=`Bearer ${_.data.access}`,e(),t("/")}catch(y){console.error("Login error details:",y),(v=(g=y.response)==null?void 0:g.data)!=null&&v.detail?l(y.response.data.detail):l("Nom d'utilisateur ou mot de passe incorrect")}finally{f(!1)}};return p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:p.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[p.jsxs("div",{className:"flex items-center justify-center mb-8",children:[p.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:p.jsx(Ba,{className:"h-8 w-8 text-purple-600"})}),p.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),o&&p.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:o}),p.jsxs("form",{onSubmit:d,className:"space-y-6",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(wo,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",value:r,onChange:m=>n(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(Ba,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"password",value:a,onChange:m=>i(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),p.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50",children:u?p.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Se connecter"}),p.jsx("div",{className:"text-center mt-4",children:p.jsxs("p",{className:"text-sm text-gray-600",children:["Pas encore de compte ?"," ",p.jsx(dc,{to:"/register",className:"font-medium text-purple-600 hover:text-purple-500",children:"S'inscrire"})]})})]}),p.jsx("div",{className:"mt-6 text-center",children:p.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}$e.defaults.withCredentials=!0;const df=$e.create({baseURL:Wt,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}}),fb=e=>{var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null},d2=()=>fb("csrftoken"),db=async()=>{try{return(await $e.get(`${Wt}/auth/csrf/`,{withCredentials:!0,headers:{Accept:"application/json"}})).data.token}catch(e){throw console.error("Error fetching CSRF token:",e),e}};let id=null;const hb=async()=>(id||(id=db()),id);df.interceptors.request.use(async e=>{var n;if(((n=e.method)==null?void 0:n.toLowerCase())==="get")return e;let t=d2();if(!t)try{if(t=await hb(),!t)throw new Error("Failed to get CSRF token")}catch(a){throw console.error("Failed to fetch CSRF token:",a),a}t&&(e.headers["X-CSRFToken"]=t);const r=localStorage.getItem("access_token");return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));df.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refresh_token");if(n){const a=await $e.post(`${Wt}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"Content-Type":"application/json","X-CSRFToken":d2()}});if(a.data.access)return localStorage.setItem("access_token",a.data.access),t.headers.Authorization=`Bearer ${a.data.access}`,df(t)}}catch(n){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(n)}}return Promise.reject(e)});function pb({onRegister:e}){const t=ka(),[r,n]=A.useState({username:"",email:"",phone_number:"",password:"",confirmPassword:"",first_name:"",last_name:""}),[a,i]=A.useState(""),[o,l]=A.useState(!1),u=d=>{const{name:m,value:g}=d.target;n(v=>({...v,[m]:g}))},f=async d=>{var m,g,v,y,_;if(d.preventDefault(),i(""),l(!0),r.password!==r.confirmPassword){i("Les mots de passe ne correspondent pas"),l(!1);return}try{const S=await df.post("/auth/register/",{username:r.username,email:r.email,phone_number:r.phone_number,password:r.password,first_name:r.first_name,last_name:r.last_name});S.data.access&&(localStorage.setItem("access_token",S.data.access),S.data.refresh&&localStorage.setItem("refresh_token",S.data.refresh),e?e():t("/"))}catch(S){console.error("Registration error:",S),(g=(m=S.response)==null?void 0:m.data)!=null&&g.error?i(S.response.data.error):(y=(v=S.response)==null?void 0:v.data)!=null&&y.username?i("Ce nom d'utilisateur est dj pris"):((_=S.response)==null?void 0:_.status)===403?i("Erreur CORS: Vrifiez la configuration du serveur"):i("Une erreur est survenue lors de l'inscription. Veuillez ressayer.")}finally{l(!1)}};return p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:p.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[p.jsxs("div",{className:"flex items-center justify-center mb-8",children:[p.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:p.jsx(wo,{className:"h-8 w-8 text-purple-600"})}),p.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),a&&p.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:a}),p.jsxs("form",{onSubmit:f,className:"space-y-6",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(wo,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",name:"username",value:r.username,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(U1,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Prnom",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(U1,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom",required:!0})]})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(l2,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"email",name:"email",value:r.email,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Email",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(c2,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"tel",name:"phone_number",value:r.phone_number,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Numro de tlphone",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(Ba,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"password",name:"password",value:r.password,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(Ba,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Confirmer le mot de passe",required:!0})]}),p.jsx("div",{children:p.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:o?"Inscription en cours...":"S'inscrire"})}),p.jsx("div",{className:"text-center",children:p.jsxs("p",{className:"text-sm text-gray-600",children:["Dj un compte ?"," ",p.jsx(dc,{to:"/login",className:"font-medium text-purple-600 hover:text-purple-500",children:"Se connecter"})]})})]}),p.jsx("div",{className:"mt-6 text-center",children:p.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}const mb=({onLogout:e})=>{const t=Qa(),[r,n]=A.useState({main:!0,firewall:!0,tools:!0}),a=l=>{n(u=>({...u,[l]:!u[l]}))},i=l=>t.pathname===l,o=[{title:"Main",items:[{path:"/firewalls",icon:ds,label:"Pare-feux"},{path:"/profile",icon:wo,label:"Profile"}]},{title:"crer dc/fw",items:[{path:"/settings",icon:wh,label:"Paramtres"}]},{title:"ma carte",items:[{path:"/map",icon:ab,label:"Carte de devices"}]},{title:"Firewall",items:[{path:"/templates",icon:_h,label:"Templates des configurations"},{path:"/daily-check",icon:ff,label:"Daily Check"},{path:"/config",icon:rb,label:"Sauvegarde commande firewall"},{path:"/matrix",icon:J3,label:"Configuration dynamique firewall"}]},{title:"Tools",items:[{path:"/history",icon:ff,label:"Historique"}]}];return p.jsxs("div",{className:"w-64 bg-purple-900 text-white p-6 h-screen flex flex-col",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-8",children:[p.jsx(lb,{className:"h-6 w-6"}),p.jsx("h1",{className:"text-2xl font-bold",children:"INWI"})]}),p.jsx("nav",{className:"space-y-6 flex-grow overflow-y-auto custom-sidebar-scrollbar",children:o.map(l=>p.jsxs("div",{className:"space-y-2",children:[p.jsxs("button",{onClick:()=>a(l.title.toLowerCase()),className:"flex items-center justify-between w-full p-2 rounded-lg hover:bg-purple-800",children:[p.jsx("span",{className:"font-semibold",children:l.title}),r[l.title.toLowerCase()]?p.jsx(uf,{className:"h-4 w-4"}):p.jsx(vh,{className:"h-4 w-4"})]}),r[l.title.toLowerCase()]&&p.jsx("div",{className:"space-y-1 pl-2",children:l.items.map(u=>{const f=u.icon;return p.jsxs(dc,{to:u.path,className:`flex items-center space-x-2 w-full p-2 rounded-lg transition-colors duration-200 ${i(u.path)?"bg-purple-700 text-white":"hover:bg-purple-800 text-purple-100"}`,children:[p.jsx(f,{className:"h-5 w-5"}),p.jsx("span",{children:u.label})]},u.path)})})]},l.title))}),p.jsxs("button",{onClick:e,className:"flex items-center space-x-2 w-full p-2 rounded-lg hover:bg-purple-800 mt-auto",children:[p.jsx(nb,{className:"h-5 w-5"}),p.jsx("span",{children:"Logout"})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var h2=1252,gb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$p={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Gp=function(e){gb.indexOf(e)!=-1&&(h2=$p[0]=e)};function xb(){Gp(1252)}var qn=function(e){Gp(e)};function p2(){qn(1200),xb()}function W1(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function vb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function m2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ll=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?vb(e.slice(2)):t==254&&r==255?m2(e.slice(2)):t==65279?e.slice(1):e},su=function(t){return String.fromCharCode(t)},$1=function(t){return String.fromCharCode(t)},fi,gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function G1(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),i=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,a=e.charCodeAt(f++),l=(n&15)<<2|a>>6,u=a&63,isNaN(n)?l=u=64:isNaN(a)&&(u=64),t+=gi.charAt(i)+gi.charAt(o)+gi.charAt(l)+gi.charAt(u);return t}function xn(e){var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=gi.indexOf(e.charAt(f++)),o=gi.indexOf(e.charAt(f++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=gi.indexOf(e.charAt(f++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=gi.indexOf(e.charAt(f++)),a=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),_s=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Li(e){return gt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Z1(e){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Xn=function(t){return gt?_s(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ys(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Zp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Zp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var di=gt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:_s(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function _b(e){for(var t=[],r=0,n=e.length+250,a=Li(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Li(65535),n=65530)}return t.push(a.slice(0,r)),di(t)}var Yr=/\u0000/g,cl=/[\u0001-\u0006]/g;function lo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yn(e,t){var r=""+e;return r.length>=t?r:Kt("0",t-r.length)+r}function Xp(e,t){var r=""+e;return r.length>=t?r:Kt(" ",t-r.length)+r}function hf(e,t){var r=""+e;return r.length>=t?r:r+Kt(" ",t-r.length)}function yb(e,t){var r=""+Math.round(e);return r.length>=t?r:Kt("0",t-r.length)+r}function wb(e,t){var r=""+e;return r.length>=t?r:Kt("0",t-r.length)+r}var X1=Math.pow(2,32);function Rs(e,t){if(e>X1||e<-X1)return yb(e,t);var r=Math.round(e);return wb(r,t)}function pf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var q1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function kb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var tt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Y1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Eb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mf(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,u=1,f=0,d=0,m=Math.floor(a);f<t&&(m=Math.floor(a),l=m*o+i,d=m*f+u,!(a-m<5e-8));)a=1/(a-m),i=o,o=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=i):(d=f,l=o)),!r)return[0,n*l,d];var g=Math.floor(n*l/d);return[g,n*l-g*d,d]}function Qi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=Nb(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var g2=new Date(1899,11,31,0,0,0),Sb=g2.getTime(),Tb=new Date(1900,2,1,0,0,0);function x2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Tb&&(r+=24*60*60*1e3),(r-(Sb+(e.getTimezoneOffset()-g2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function qp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Cb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function bb(e){var t=e<0?12:11,r=qp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ab(e){var t=qp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Yl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=bb(e):t===10?r=e.toFixed(10).substr(0,12):r=Ab(e),qp(Cb(r.toUpperCase()))}function hs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return In(14,x2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Nb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Lb(e,t,r,n){var a="",i=0,o=0,l=r.y,u,f=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return sd[r.m-1][1];case 5:return sd[r.m-1][0];default:return sd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return q1[r.q][0];default:return q1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Yn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=Yn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?Yn(u,f):"";return d}function xi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var v2=/%/g;function Pb(e,t,r){var n=t.replace(v2,""),a=t.length-n.length;return Va(e,n,r*Math.pow(10,2*a))+Kt("%",a)}function Fb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Va(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var y2=/# (\?+)( ?)\/( ?)(\d+)/;function Ob(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?Kt(" ",e[1].length+1+e[4].length):Xp(o,e[1].length)+e[2]+"/"+e[3]+Yn(l,e[4].length))}function Mb(e,t,r){return r+(t===0?"":""+t)+Kt(" ",e[1].length+2+e[4].length)}var w2=/^#*0*\.([0#]+)/,k2=/\).*[0#]/,E2=/\(###\) ###\\?-####/;function $r(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function K1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function J1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Rb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Db(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Cn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(k2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cn("n",n,r):"("+Cn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Fb(e,t,r);if(t.indexOf("%")!==-1)return Pb(e,t,r);if(t.indexOf("E")!==-1)return _2(t,r);if(t.charCodeAt(0)===36)return"$"+Cn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Rs(u,t.length);if(t.match(/^[#?]+$/))return a=Rs(r,0),a==="0"&&(a=""),a.length>t.length?a:$r(t.substr(0,t.length-a.length))+a;if(i=t.match(y2))return Ob(i,u,f);if(t.match(/^#+0+$/))return f+Rs(u,t.length-t.indexOf("0"));if(i=t.match(w2))return a=K1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+$r(i[1])).replace(/\.$/,"."+$r(i[1])).replace(/\.(\d*)$/,function(y,_){return"."+_+Kt("0",$r(i[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+K1(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+xi(Rs(u,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cn(e,t,-r):xi(""+(Math.floor(r)+Rb(r,i[1].length)))+"."+Yn(J1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Cn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=lo(Cn(e,t.replace(/[\\-]/g,""),r)),o=0,lo(lo(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(t.match(E2))return a=Cn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=mf(u,Math.pow(10,o)-1,!1),a=""+f,d=Va("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=hf(l[2],o),d.length<i[4].length&&(d=$r(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=mf(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Xp(l[1],o)+i[2]+"/"+i[3]+hf(l[2],o):Kt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Rs(r,0),t.length<=a.length?a:$r(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return $r(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=J1(r,i[1].length),r<0?"-"+Cn(e,t,-r):xi(Db(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Yn(0,3-y.length):"")+y})+"."+Yn(o,i[1].length);switch(t){case"###,##0.00":return Cn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=xi(Rs(u,0));return v!=="0"?f+v:"";case"###,###.00":return Cn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Cn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ib(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Va(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function jb(e,t,r){var n=t.replace(v2,""),a=t.length-n.length;return Va(e,n,r*Math.pow(10,2*a))+Kt("%",a)}function S2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ha(e,t,r){if(e.charCodeAt(0)===40&&!t.match(k2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ha("n",n,r):"("+ha("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ib(e,t,r);if(t.indexOf("%")!==-1)return jb(e,t,r);if(t.indexOf("E")!==-1)return S2(t,r);if(t.charCodeAt(0)===36)return"$"+ha(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Yn(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:$r(t.substr(0,t.length-a.length))+a;if(i=t.match(y2))return Mb(i,u,f);if(t.match(/^#+0+$/))return f+Yn(u,t.length-t.indexOf("0"));if(i=t.match(w2))return a=(""+r).replace(/^([^\.]+)$/,"$1."+$r(i[1])).replace(/\.$/,"."+$r(i[1])),a=a.replace(/\.(\d*)$/,function(y,_){return"."+_+Kt("0",$r(i[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+xi(""+u);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ha(e,t,-r):xi(""+r)+"."+Kt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ha(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=lo(ha(e,t.replace(/[\\-]/g,""),r)),o=0,lo(lo(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(t.match(E2))return a=ha(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=mf(u,Math.pow(10,o)-1,!1),a=""+f,d=Va("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=hf(l[2],o),d.length<i[4].length&&(d=$r(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=mf(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Xp(l[1],o)+i[2]+"/"+i[3]+hf(l[2],o):Kt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:$r(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return $r(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ha(e,t,-r):xi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Yn(0,3-y.length):"")+y})+"."+Yn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=xi(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return ha(e,t.slice(0,t.lastIndexOf(".")),r)+$r(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Va(e,t,r){return(r|0)===r?ha(e,t,r):Cn(e,t,r)}function Bb(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var T2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Po(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":pf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(T2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function zb(e,t,r,n){for(var a=[],i="",o=0,l="",u="t",f,d,m,g="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!pf(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++o;break;case"\\":var v=e.charAt(++o),y=v==="("||v===")"?v:"t";a[a.length]={t:y,v},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=Qi(t,r,e.charAt(o+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Qi(t,r),f==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),a[a.length]={t:l,v:i},u=l;break;case"A":case"a":case"":var _={t:l,v:l};if(f==null&&(f=Qi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(_.v=f.H>=12?"":""),_.t="T",o+=5,g="h"):(_.t="t",++o),f==null&&_.t==="T")return"";a[a.length]=_,u=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(T2)){if(f==null&&(f=Qi(t,r),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Po(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var S=0,k=0,E;for(o=a.length-1,u="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=g,u="h",S<1&&(S=1);break;case"s":(E=a[o].v.match(/\.0+$/))&&(k=Math.max(k,E[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":u=a[o].t;break;case"m":u==="s"&&(a[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[o].v.match(/[Hh]/)&&(S=1),S<2&&a[o].v.match(/[Mm]/)&&(S=2),S<3&&a[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var w="",N;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=Lb(a[o].t.charCodeAt(0),a[o].v,f,k),a[o].t="t";break;case"n":case"?":for(N=o+1;a[N]!=null&&((l=a[N].t)==="?"||l==="D"||(l===" "||l==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[o].v+=a[N].v,a[N]={v:"",t:";"},++N;w+=a[o].v,o=N-1;break;case"G":a[o].t="t",a[o].v=hs(t,r);break}var I="",D,P;if(w.length>0){w.charCodeAt(0)==40?(D=t<0&&w.charCodeAt(0)===45?-t:t,P=Va("n",w,D)):(D=t<0&&n>1?-t:t,P=Va("n",w,D),D<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),N=P.length-1;var V=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){V=o;break}var z=a.length;if(V===a.length&&P.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(N>=a[o].v.length-1?(N-=a[o].v.length,a[o].v=P.substr(N+1,a[o].v.length)):N<0?a[o].v="":(a[o].v=P.substr(0,N+1),N=-1),a[o].t="t",z=o);N>=0&&z<a.length&&(a[z].v=P.substr(0,N+1)+a[z].v)}else if(V!==a.length&&P.indexOf("E")===-1){for(N=P.indexOf(".")-1,o=V;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===V?a[o].v.indexOf(".")-1:a[o].v.length-1,I=a[o].v.substr(d+1);d>=0;--d)N>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(I=P.charAt(N--)+I);a[o].v=I,a[o].t="t",z=o}for(N>=0&&z<a.length&&(a[z].v=P.substr(0,N+1)+a[z].v),N=P.indexOf(".")+1,o=V;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==V)){for(d=a[o].v.indexOf(".")>-1&&o===V?a[o].v.indexOf(".")+1:0,I=a[o].v.substr(0,d);d<a[o].v.length;++d)N<P.length&&(I+=P.charAt(N++));a[o].v=I,a[o].t="t",z=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(D=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Va(a[o].t,a[o].v,D),a[o].t="t");var W="";for(o=0;o!==a.length;++o)a[o]!=null&&(W+=a[o].v);return W}var Q1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ex(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Ub(e,t){var r=Bb(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Q1),l=r[1].match(Q1);return ex(t,o)?[n,r[0]]:ex(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function In(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:tt)[e],n==null&&(n=r.table&&r.table[Y1[e]]||tt[Y1[e]]),n==null&&(n=Eb[e]||"General");break}if(pf(n,0))return hs(t,r);t instanceof Date&&(t=x2(t,r.date1904));var a=Ub(n,t);if(pf(a[1]))return hs(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return zb(a[1],t,r,a[0])}function as(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(tt[r]==null){t<0&&(t=r);continue}if(tt[r]==e){t=r;break}}t<0&&(t=391)}return tt[t]=e,t}function C2(){tt=kb()}var Hb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},b2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Vb(e){var t=typeof e=="number"?tt[e]:e;return t=t.replace(b2,"(\\d+)"),new RegExp("^"+t+"$")}function Wb(e,t,r){var n=-1,a=-1,i=-1,o=-1,l=-1,u=-1;(t.match(b2)||[]).forEach(function(m,g){var v=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=v;break;case"d":i=v;break;case"h":o=v;break;case"s":u=v;break;case"m":o>=0?l=v:a=v;break}}),u>=0&&l==-1&&a>=0&&(l=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?f:n==-1&&a==-1&&i==-1?d:f+"T"+d}var $b=function(){var e={};e.version="1.2.0";function t(){for(var P=0,V=new Array(256),z=0;z!=256;++z)P=z,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,V[z]=P;return typeof Int32Array<"u"?new Int32Array(V):V}var r=t();function n(P){var V=0,z=0,W=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)B[W]=P[W];for(W=0;W!=256;++W)for(z=P[W],V=256+W;V<4096;V+=256)z=B[V]=z>>>8^P[z&255];var G=[];for(W=1;W!=16;++W)G[W-1]=typeof Int32Array<"u"?B.subarray(W*256,W*256+256):B.slice(W*256,W*256+256);return G}var a=n(r),i=a[0],o=a[1],l=a[2],u=a[3],f=a[4],d=a[5],m=a[6],g=a[7],v=a[8],y=a[9],_=a[10],S=a[11],k=a[12],E=a[13],w=a[14];function N(P,V){for(var z=V^-1,W=0,B=P.length;W<B;)z=z>>>8^r[(z^P.charCodeAt(W++))&255];return~z}function I(P,V){for(var z=V^-1,W=P.length-15,B=0;B<W;)z=w[P[B++]^z&255]^E[P[B++]^z>>8&255]^k[P[B++]^z>>16&255]^S[P[B++]^z>>>24]^_[P[B++]]^y[P[B++]]^v[P[B++]]^g[P[B++]]^m[P[B++]]^d[P[B++]]^f[P[B++]]^u[P[B++]]^l[P[B++]]^o[P[B++]]^i[P[B++]]^r[P[B++]];for(W+=15;B<W;)z=z>>>8^r[(z^P[B++])&255];return~z}function D(P,V){for(var z=V^-1,W=0,B=P.length,G=0,K=0;W<B;)G=P.charCodeAt(W++),G<128?z=z>>>8^r[(z^G)&255]:G<2048?(z=z>>>8^r[(z^(192|G>>6&31))&255],z=z>>>8^r[(z^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,K=P.charCodeAt(W++)&1023,z=z>>>8^r[(z^(240|G>>8&7))&255],z=z>>>8^r[(z^(128|G>>2&63))&255],z=z>>>8^r[(z^(128|K>>6&15|(G&3)<<4))&255],z=z>>>8^r[(z^(128|K&63))&255]):(z=z>>>8^r[(z^(224|G>>12&15))&255],z=z>>>8^r[(z^(128|G>>6&63))&255],z=z>>>8^r[(z^(128|G&63))&255]);return~z}return e.table=r,e.bstr=N,e.buf=I,e.str=D,e}(),vt=function(){var t={};t.version="1.2.1";function r(C,O){for(var F=C.split("/"),M=O.split("/"),j=0,U=0,ee=Math.min(F.length,M.length);j<ee;++j){if(U=F[j].length-M[j].length)return U;if(F[j]!=M[j])return F[j]<M[j]?-1:1}return F.length-M.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var O=C.lastIndexOf("/");return O===-1?C:C.slice(0,O+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var O=C.lastIndexOf("/");return O===-1?C:C.slice(O+1)}function i(C,O){typeof O=="string"&&(O=new Date(O));var F=O.getHours();F=F<<6|O.getMinutes(),F=F<<5|O.getSeconds()>>>1,C.write_shift(2,F);var M=O.getFullYear()-1980;M=M<<4|O.getMonth()+1,M=M<<5|O.getDate(),C.write_shift(2,M)}function o(C){var O=C.read_shift(2)&65535,F=C.read_shift(2)&65535,M=new Date,j=F&31;F>>>=5;var U=F&15;F>>>=4,M.setMilliseconds(0),M.setFullYear(F+1980),M.setMonth(U-1),M.setDate(j);var ee=O&31;O>>>=5;var fe=O&63;return O>>>=6,M.setHours(O),M.setMinutes(fe),M.setSeconds(ee<<1),M}function l(C){Er(C,0);for(var O={},F=0;C.l<=C.length-4;){var M=C.read_shift(2),j=C.read_shift(2),U=C.l+j,ee={};switch(M){case 21589:F=C.read_shift(1),F&1&&(ee.mtime=C.read_shift(4)),j>5&&(F&2&&(ee.atime=C.read_shift(4)),F&4&&(ee.ctime=C.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}C.l=U,O[M]=ee}return O}var u;function f(){return u||(u={})}function d(C,O){if(C[0]==80&&C[1]==75)return ct(C,O);if((C[0]|32)==109&&(C[1]|32)==105)return mt(C,O);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var F=3,M=512,j=0,U=0,ee=0,fe=0,re=0,ie=[],oe=C.slice(0,512);Er(oe,0);var Ee=m(oe);switch(F=Ee[0],F){case 3:M=512;break;case 4:M=4096;break;case 0:if(Ee[1]==0)return ct(C,O);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}M!==512&&(oe=C.slice(0,M),Er(oe,28));var Ne=C.slice(0,M);g(oe,F);var De=oe.read_shift(4,"i");if(F===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);oe.l+=4,ee=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),fe=oe.read_shift(4,"i"),j=oe.read_shift(4,"i"),re=oe.read_shift(4,"i"),U=oe.read_shift(4,"i");for(var Ce=-1,Me=0;Me<109&&(Ce=oe.read_shift(4,"i"),!(Ce<0));++Me)ie[Me]=Ce;var qe=v(C,M);S(re,U,qe,M,ie);var Mt=E(qe,ee,ie,M);Mt[ee].name="!Directory",j>0&&fe!==K&&(Mt[fe].name="!MiniFAT"),Mt[ie[0]].name="!FAT",Mt.fat_addrs=ie,Mt.ssz=M;var Rt={},mr=[],Ca=[],Bn=[];w(ee,Mt,qe,mr,j,Rt,Ca,fe),y(Ca,Bn,mr),mr.shift();var ti={FileIndex:Ca,FullPaths:Bn};return O&&O.raw&&(ti.raw={header:Ne,sectors:qe}),ti}function m(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(ve,"Header Signature: "),C.l+=16;var O=C.read_shift(2,"u");return[C.read_shift(2,"u"),O]}function g(C,O){var F=9;switch(C.l+=2,F=C.read_shift(2)){case 9:if(O!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(O!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function v(C,O){for(var F=Math.ceil(C.length/O)-1,M=[],j=1;j<F;++j)M[j-1]=C.slice(j*O,(j+1)*O);return M[F-1]=C.slice(F*O),M}function y(C,O,F){for(var M=0,j=0,U=0,ee=0,fe=0,re=F.length,ie=[],oe=[];M<re;++M)ie[M]=oe[M]=M,O[M]=F[M];for(;fe<oe.length;++fe)M=oe[fe],j=C[M].L,U=C[M].R,ee=C[M].C,ie[M]===M&&(j!==-1&&ie[j]!==j&&(ie[M]=ie[j]),U!==-1&&ie[U]!==U&&(ie[M]=ie[U])),ee!==-1&&(ie[ee]=M),j!==-1&&M!=ie[M]&&(ie[j]=ie[M],oe.lastIndexOf(j)<fe&&oe.push(j)),U!==-1&&M!=ie[M]&&(ie[U]=ie[M],oe.lastIndexOf(U)<fe&&oe.push(U));for(M=1;M<re;++M)ie[M]===M&&(U!==-1&&ie[U]!==U?ie[M]=ie[U]:j!==-1&&ie[j]!==j&&(ie[M]=ie[j]));for(M=1;M<re;++M)if(C[M].type!==0){if(fe=M,fe!=ie[fe])do fe=ie[fe],O[M]=O[fe]+"/"+O[M];while(fe!==0&&ie[fe]!==-1&&fe!=ie[fe]);ie[M]=-1}for(O[0]+="/",M=1;M<re;++M)C[M].type!==2&&(O[M]+="/")}function _(C,O,F){for(var M=C.start,j=C.size,U=[],ee=M;F&&j>0&&ee>=0;)U.push(O.slice(ee*G,ee*G+G)),j-=G,ee=Zi(F,ee*4);return U.length===0?ur(0):di(U).slice(0,C.size)}function S(C,O,F,M,j){var U=K;if(C===K){if(O!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ee=F[C],fe=(M>>>2)-1;if(!ee)return;for(var re=0;re<fe&&(U=Zi(ee,re*4))!==K;++re)j.push(U);S(Zi(ee,M-4),O-1,F,M,j)}}function k(C,O,F,M,j){var U=[],ee=[];j||(j=[]);var fe=M-1,re=0,ie=0;for(re=O;re>=0;){j[re]=!0,U[U.length]=re,ee.push(C[re]);var oe=F[Math.floor(re*4/M)];if(ie=re*4&fe,M<4+ie)throw new Error("FAT boundary crossed: "+re+" 4 "+M);if(!C[oe])break;re=Zi(C[oe],ie)}return{nodes:U,data:ux([ee])}}function E(C,O,F,M){var j=C.length,U=[],ee=[],fe=[],re=[],ie=M-1,oe=0,Ee=0,Ne=0,De=0;for(oe=0;oe<j;++oe)if(fe=[],Ne=oe+O,Ne>=j&&(Ne-=j),!ee[Ne]){re=[];var Ce=[];for(Ee=Ne;Ee>=0;){Ce[Ee]=!0,ee[Ee]=!0,fe[fe.length]=Ee,re.push(C[Ee]);var Me=F[Math.floor(Ee*4/M)];if(De=Ee*4&ie,M<4+De)throw new Error("FAT boundary crossed: "+Ee+" 4 "+M);if(!C[Me]||(Ee=Zi(C[Me],De),Ce[Ee]))break}U[Ne]={nodes:fe,data:ux([re])}}return U}function w(C,O,F,M,j,U,ee,fe){for(var re=0,ie=M.length?2:0,oe=O[C].data,Ee=0,Ne=0,De;Ee<oe.length;Ee+=128){var Ce=oe.slice(Ee,Ee+128);Er(Ce,64),Ne=Ce.read_shift(2),De=em(Ce,0,Ne-ie),M.push(De);var Me={name:De,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},qe=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);qe!==0&&(Me.ct=N(Ce,Ce.l-8));var Mt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Mt!==0&&(Me.mt=N(Ce,Ce.l-8)),Me.start=Ce.read_shift(4,"i"),Me.size=Ce.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=K,Me.name=""),Me.type===5?(re=Me.start,j>0&&re!==K&&(O[re].name="!StreamData")):Me.size>=4096?(Me.storage="fat",O[Me.start]===void 0&&(O[Me.start]=k(F,Me.start,O.fat_addrs,O.ssz)),O[Me.start].name=Me.name,Me.content=O[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:re!==K&&Me.start!==K&&O[re]&&(Me.content=_(Me,O[re].data,(O[fe]||{}).data))),Me.content&&Er(Me.content,0),U[De]=Me,ee.push(Me)}}function N(C,O){return new Date((fn(C,O+4)/1e7*Math.pow(2,32)+fn(C,O)/1e7-11644473600)*1e3)}function I(C,O){return f(),d(u.readFileSync(C),O)}function D(C,O){var F=O&&O.type;switch(F||gt&&Buffer.isBuffer(C)&&(F="buffer"),F||"base64"){case"file":return I(C,O);case"base64":return d(Xn(xn(C)),O);case"binary":return d(Xn(C),O)}return d(C,O)}function P(C,O){var F=O||{},M=F.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=M+"/",C.FileIndex[0]={name:M,type:5}),F.CLSID&&(C.FileIndex[0].clsid=F.CLSID),V(C)}function V(C){var O="Sh33tJ5";if(!vt.find(C,"/"+O)){var F=ur(4);F[0]=55,F[1]=F[3]=50,F[2]=54,C.FileIndex.push({name:O,type:2,content:F,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+O),z(C)}}function z(C,O){P(C);for(var F=!1,M=!1,j=C.FullPaths.length-1;j>=0;--j){var U=C.FileIndex[j];switch(U.type){case 0:M?F=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(U.R*U.L*U.C)&&(F=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!O)){var ee=new Date(1987,1,19),fe=0,re=Object.create?Object.create(null):{},ie=[];for(j=0;j<C.FullPaths.length;++j)re[C.FullPaths[j]]=!0,C.FileIndex[j].type!==0&&ie.push([C.FullPaths[j],C.FileIndex[j]]);for(j=0;j<ie.length;++j){var oe=n(ie[j][0]);M=re[oe],M||(ie.push([oe,{name:a(oe).replace("/",""),type:1,clsid:he,ct:ee,mt:ee,content:null}]),re[oe]=!0)}for(ie.sort(function(De,Ce){return r(De[0],Ce[0])}),C.FullPaths=[],C.FileIndex=[],j=0;j<ie.length;++j)C.FullPaths[j]=ie[j][0],C.FileIndex[j]=ie[j][1];for(j=0;j<ie.length;++j){var Ee=C.FileIndex[j],Ne=C.FullPaths[j];if(Ee.name=a(Ne).replace("/",""),Ee.L=Ee.R=Ee.C=-(Ee.color=1),Ee.size=Ee.content?Ee.content.length:0,Ee.start=0,Ee.clsid=Ee.clsid||he,j===0)Ee.C=ie.length>1?1:-1,Ee.size=0,Ee.type=5;else if(Ne.slice(-1)=="/"){for(fe=j+1;fe<ie.length&&n(C.FullPaths[fe])!=Ne;++fe);for(Ee.C=fe>=ie.length?-1:fe,fe=j+1;fe<ie.length&&n(C.FullPaths[fe])!=n(Ne);++fe);Ee.R=fe>=ie.length?-1:fe,Ee.type=1}else n(C.FullPaths[j+1]||"")==n(Ne)&&(Ee.R=j+1),Ee.type=2}}}function W(C,O){var F=O||{};if(F.fileType=="mad")return Ct(C,F);switch(z(C),F.fileType){case"zip":return cr(C,F)}var M=function(De){for(var Ce=0,Me=0,qe=0;qe<De.FileIndex.length;++qe){var Mt=De.FileIndex[qe];if(Mt.content){var Rt=Mt.content.length;Rt>0&&(Rt<4096?Ce+=Rt+63>>6:Me+=Rt+511>>9)}}for(var mr=De.FullPaths.length+3>>2,Ca=Ce+7>>3,Bn=Ce+127>>7,ti=Ca+Me+mr+Bn,sa=ti+127>>7,ba=sa<=109?0:Math.ceil((sa-109)/127);ti+sa+ba+127>>7>sa;)ba=++sa<=109?0:Math.ceil((sa-109)/127);var Qe=[1,ba,sa,Bn,mr,Me,Ce,0];return De.FileIndex[0].size=Ce<<6,Qe[7]=(De.FileIndex[0].start=Qe[0]+Qe[1]+Qe[2]+Qe[3]+Qe[4]+Qe[5])+(Qe[6]+7>>3),Qe}(C),j=ur(M[7]<<9),U=0,ee=0;{for(U=0;U<8;++U)j.write_shift(1,xe[U]);for(U=0;U<8;++U)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),U=0;U<3;++U)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,M[2]),j.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:K),j.write_shift(4,M[3]),j.write_shift(-4,M[1]?M[0]-1:K),j.write_shift(4,M[1]),U=0;U<109;++U)j.write_shift(-4,U<M[2]?M[1]+U:-1)}if(M[1])for(ee=0;ee<M[1];++ee){for(;U<236+ee*127;++U)j.write_shift(-4,U<M[2]?M[1]+U:-1);j.write_shift(-4,ee===M[1]-1?K:ee+1)}var fe=function(De){for(ee+=De;U<ee-1;++U)j.write_shift(-4,U+1);De&&(++U,j.write_shift(-4,K))};for(ee=U=0,ee+=M[1];U<ee;++U)j.write_shift(-4,me.DIFSECT);for(ee+=M[2];U<ee;++U)j.write_shift(-4,me.FATSECT);fe(M[3]),fe(M[4]);for(var re=0,ie=0,oe=C.FileIndex[0];re<C.FileIndex.length;++re)oe=C.FileIndex[re],oe.content&&(ie=oe.content.length,!(ie<4096)&&(oe.start=ee,fe(ie+511>>9)));for(fe(M[6]+7>>3);j.l&511;)j.write_shift(-4,me.ENDOFCHAIN);for(ee=U=0,re=0;re<C.FileIndex.length;++re)oe=C.FileIndex[re],oe.content&&(ie=oe.content.length,!(!ie||ie>=4096)&&(oe.start=ee,fe(ie+63>>6)));for(;j.l&511;)j.write_shift(-4,me.ENDOFCHAIN);for(U=0;U<M[4]<<2;++U){var Ee=C.FullPaths[U];if(!Ee||Ee.length===0){for(re=0;re<17;++re)j.write_shift(4,0);for(re=0;re<3;++re)j.write_shift(4,-1);for(re=0;re<12;++re)j.write_shift(4,0);continue}oe=C.FileIndex[U],U===0&&(oe.start=oe.size?oe.start-1:K);var Ne=U===0&&F.root||oe.name;if(ie=2*(Ne.length+1),j.write_shift(64,Ne,"utf16le"),j.write_shift(2,ie),j.write_shift(1,oe.type),j.write_shift(1,oe.color),j.write_shift(-4,oe.L),j.write_shift(-4,oe.R),j.write_shift(-4,oe.C),oe.clsid)j.write_shift(16,oe.clsid,"hex");else for(re=0;re<4;++re)j.write_shift(4,0);j.write_shift(4,oe.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,oe.start),j.write_shift(4,oe.size),j.write_shift(4,0)}for(U=1;U<C.FileIndex.length;++U)if(oe=C.FileIndex[U],oe.size>=4096)if(j.l=oe.start+1<<9,gt&&Buffer.isBuffer(oe.content))oe.content.copy(j,j.l,0,oe.size),j.l+=oe.size+511&-512;else{for(re=0;re<oe.size;++re)j.write_shift(1,oe.content[re]);for(;re&511;++re)j.write_shift(1,0)}for(U=1;U<C.FileIndex.length;++U)if(oe=C.FileIndex[U],oe.size>0&&oe.size<4096)if(gt&&Buffer.isBuffer(oe.content))oe.content.copy(j,j.l,0,oe.size),j.l+=oe.size+63&-64;else{for(re=0;re<oe.size;++re)j.write_shift(1,oe.content[re]);for(;re&63;++re)j.write_shift(1,0)}if(gt)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function B(C,O){var F=C.FullPaths.map(function(re){return re.toUpperCase()}),M=F.map(function(re){var ie=re.split("/");return ie[ie.length-(re.slice(-1)=="/"?2:1)]}),j=!1;O.charCodeAt(0)===47?(j=!0,O=F[0].slice(0,-1)+O):j=O.indexOf("/")!==-1;var U=O.toUpperCase(),ee=j===!0?F.indexOf(U):M.indexOf(U);if(ee!==-1)return C.FileIndex[ee];var fe=!U.match(cl);for(U=U.replace(Yr,""),fe&&(U=U.replace(cl,"!")),ee=0;ee<F.length;++ee)if((fe?F[ee].replace(cl,"!"):F[ee]).replace(Yr,"")==U||(fe?M[ee].replace(cl,"!"):M[ee]).replace(Yr,"")==U)return C.FileIndex[ee];return null}var G=64,K=-2,ve="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(C,O,F){f();var M=W(C,F);u.writeFileSync(O,M)}function Y(C){for(var O=new Array(C.length),F=0;F<C.length;++F)O[F]=String.fromCharCode(C[F]);return O.join("")}function se(C,O){var F=W(C,O);switch(O&&O.type||"buffer"){case"file":return f(),u.writeFileSync(O.filename,F),F;case"binary":return typeof F=="string"?F:Y(F);case"base64":return G1(typeof F=="string"?F:Y(F));case"buffer":if(gt)return Buffer.isBuffer(F)?F:_s(F);case"array":return typeof F=="string"?Xn(F):F}return F}var ye;function R(C){try{var O=C.InflateRaw,F=new O;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)ye=C;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function J(C,O){if(!ye)return Xe(C,O);var F=ye.InflateRaw,M=new F,j=M._processChunk(C.slice(C.l),M._finishFlushFlag);return C.l+=M.bytesRead,j}function q(C){return ye?ye.deflateRawSync(C):He(C)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(C){var O=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(O>>16|O>>8|O)&255}for(var be=typeof Uint8Array<"u",_e=be?new Uint8Array(256):[],Be=0;Be<256;++Be)_e[Be]=Le(Be);function H(C,O){var F=_e[C&255];return O<=8?F>>>8-O:(F=F<<8|_e[C>>8&255],O<=16?F>>>16-O:(F=F<<8|_e[C>>16&255],F>>>24-O))}function Ye(C,O){var F=O&7,M=O>>>3;return(C[M]|(F<=6?0:C[M+1]<<8))>>>F&3}function nt(C,O){var F=O&7,M=O>>>3;return(C[M]|(F<=5?0:C[M+1]<<8))>>>F&7}function it(C,O){var F=O&7,M=O>>>3;return(C[M]|(F<=4?0:C[M+1]<<8))>>>F&15}function Ze(C,O){var F=O&7,M=O>>>3;return(C[M]|(F<=3?0:C[M+1]<<8))>>>F&31}function Ae(C,O){var F=O&7,M=O>>>3;return(C[M]|(F<=1?0:C[M+1]<<8))>>>F&127}function Et(C,O,F){var M=O&7,j=O>>>3,U=(1<<F)-1,ee=C[j]>>>M;return F<8-M||(ee|=C[j+1]<<8-M,F<16-M)||(ee|=C[j+2]<<16-M,F<24-M)||(ee|=C[j+3]<<24-M),ee&U}function pe(C,O,F){var M=O&7,j=O>>>3;return M<=5?C[j]|=(F&7)<<M:(C[j]|=F<<M&255,C[j+1]=(F&7)>>8-M),O+3}function Pe(C,O,F){var M=O&7,j=O>>>3;return F=(F&1)<<M,C[j]|=F,O+1}function Fe(C,O,F){var M=O&7,j=O>>>3;return F<<=M,C[j]|=F&255,F>>>=8,C[j+1]=F,O+8}function Ve(C,O,F){var M=O&7,j=O>>>3;return F<<=M,C[j]|=F&255,F>>>=8,C[j+1]=F&255,C[j+2]=F>>>8,O+16}function pt(C,O){var F=C.length,M=2*F>O?2*F:O+5,j=0;if(F>=O)return C;if(gt){var U=Z1(M);if(C.copy)C.copy(U);else for(;j<C.length;++j)U[j]=C[j];return U}else if(be){var ee=new Uint8Array(M);if(ee.set)ee.set(C);else for(;j<F;++j)ee[j]=C[j];return ee}return C.length=M,C}function ut(C){for(var O=new Array(C),F=0;F<C;++F)O[F]=0;return O}function St(C,O,F){var M=1,j=0,U=0,ee=0,fe=0,re=C.length,ie=be?new Uint16Array(32):ut(32);for(U=0;U<32;++U)ie[U]=0;for(U=re;U<F;++U)C[U]=0;re=C.length;var oe=be?new Uint16Array(re):ut(re);for(U=0;U<re;++U)ie[j=C[U]]++,M<j&&(M=j),oe[U]=0;for(ie[0]=0,U=1;U<=M;++U)ie[U+16]=fe=fe+ie[U-1]<<1;for(U=0;U<re;++U)fe=C[U],fe!=0&&(oe[U]=ie[fe+16]++);var Ee=0;for(U=0;U<re;++U)if(Ee=C[U],Ee!=0)for(fe=H(oe[U],M)>>M-Ee,ee=(1<<M+4-Ee)-1;ee>=0;--ee)O[fe|ee<<Ee]=Ee&15|U<<4;return M}var jt=be?new Uint16Array(512):ut(512),Xt=be?new Uint16Array(32):ut(32);if(!be){for(var bt=0;bt<512;++bt)jt[bt]=0;for(bt=0;bt<32;++bt)Xt[bt]=0}(function(){for(var C=[],O=0;O<32;O++)C.push(5);St(C,Xt,32);var F=[];for(O=0;O<=143;O++)F.push(8);for(;O<=255;O++)F.push(9);for(;O<=279;O++)F.push(7);for(;O<=287;O++)F.push(8);St(F,jt,288)})();var Ut=function(){for(var O=be?new Uint8Array(32768):[],F=0,M=0;F<we.length-1;++F)for(;M<we[F+1];++M)O[M]=F;for(;M<32768;++M)O[M]=29;var j=be?new Uint8Array(259):[];for(F=0,M=0;F<ne.length-1;++F)for(;M<ne[F+1];++M)j[M]=F;function U(fe,re){for(var ie=0;ie<fe.length;){var oe=Math.min(65535,fe.length-ie),Ee=ie+oe==fe.length;for(re.write_shift(1,+Ee),re.write_shift(2,oe),re.write_shift(2,~oe&65535);oe-- >0;)re[re.l++]=fe[ie++]}return re.l}function ee(fe,re){for(var ie=0,oe=0,Ee=be?new Uint16Array(32768):[];oe<fe.length;){var Ne=Math.min(65535,fe.length-oe);if(Ne<10){for(ie=pe(re,ie,+(oe+Ne==fe.length)),ie&7&&(ie+=8-(ie&7)),re.l=ie/8|0,re.write_shift(2,Ne),re.write_shift(2,~Ne&65535);Ne-- >0;)re[re.l++]=fe[oe++];ie=re.l*8;continue}ie=pe(re,ie,+(oe+Ne==fe.length)+2);for(var De=0;Ne-- >0;){var Ce=fe[oe];De=(De<<5^Ce)&32767;var Me=-1,qe=0;if((Me=Ee[De])&&(Me|=oe&-32768,Me>oe&&(Me-=32768),Me<oe))for(;fe[Me+qe]==fe[oe+qe]&&qe<250;)++qe;if(qe>2){Ce=j[qe],Ce<=22?ie=Fe(re,ie,_e[Ce+1]>>1)-1:(Fe(re,ie,3),ie+=5,Fe(re,ie,_e[Ce-23]>>5),ie+=3);var Mt=Ce<8?0:Ce-4>>2;Mt>0&&(Ve(re,ie,qe-ne[Ce]),ie+=Mt),Ce=O[oe-Me],ie=Fe(re,ie,_e[Ce]>>3),ie-=3;var Rt=Ce<4?0:Ce-2>>1;Rt>0&&(Ve(re,ie,oe-Me-we[Ce]),ie+=Rt);for(var mr=0;mr<qe;++mr)Ee[De]=oe&32767,De=(De<<5^fe[oe])&32767,++oe;Ne-=qe-1}else Ce<=143?Ce=Ce+48:ie=Pe(re,ie,1),ie=Fe(re,ie,_e[Ce]),Ee[De]=oe&32767,++oe}ie=Fe(re,ie,0)-1}return re.l=(ie+7)/8|0,re.l}return function(re,ie){return re.length<8?U(re,ie):ee(re,ie)}}();function He(C){var O=ur(50+Math.floor(C.length*1.1)),F=Ut(C,O);return O.slice(0,F)}var ce=be?new Uint16Array(32768):ut(32768),de=be?new Uint16Array(32768):ut(32768),Se=be?new Uint16Array(128):ut(128),Oe=1,Ue=1;function Tt(C,O){var F=Ze(C,O)+257;O+=5;var M=Ze(C,O)+1;O+=5;var j=it(C,O)+4;O+=4;for(var U=0,ee=be?new Uint8Array(19):ut(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,ie=be?new Uint8Array(8):ut(8),oe=be?new Uint8Array(8):ut(8),Ee=ee.length,Ne=0;Ne<j;++Ne)ee[Z[Ne]]=U=nt(C,O),re<U&&(re=U),ie[U]++,O+=3;var De=0;for(ie[0]=0,Ne=1;Ne<=re;++Ne)oe[Ne]=De=De+ie[Ne-1]<<1;for(Ne=0;Ne<Ee;++Ne)(De=ee[Ne])!=0&&(fe[Ne]=oe[De]++);var Ce=0;for(Ne=0;Ne<Ee;++Ne)if(Ce=ee[Ne],Ce!=0){De=_e[fe[Ne]]>>8-Ce;for(var Me=(1<<7-Ce)-1;Me>=0;--Me)Se[De|Me<<Ce]=Ce&7|Ne<<3}var qe=[];for(re=1;qe.length<F+M;)switch(De=Se[Ae(C,O)],O+=De&7,De>>>=3){case 16:for(U=3+Ye(C,O),O+=2,De=qe[qe.length-1];U-- >0;)qe.push(De);break;case 17:for(U=3+nt(C,O),O+=3;U-- >0;)qe.push(0);break;case 18:for(U=11+Ae(C,O),O+=7;U-- >0;)qe.push(0);break;default:qe.push(De),re<De&&(re=De);break}var Mt=qe.slice(0,F),Rt=qe.slice(F);for(Ne=F;Ne<286;++Ne)Mt[Ne]=0;for(Ne=M;Ne<30;++Ne)Rt[Ne]=0;return Oe=St(Mt,ce,286),Ue=St(Rt,de,30),O}function st(C,O){if(C[0]==3&&!(C[1]&3))return[Li(O),2];for(var F=0,M=0,j=Z1(O||1<<18),U=0,ee=j.length>>>0,fe=0,re=0;!(M&1);){if(M=nt(C,F),F+=3,M>>>1)M>>1==1?(fe=9,re=5):(F=Tt(C,F),fe=Oe,re=Ue);else{F&7&&(F+=8-(F&7));var ie=C[F>>>3]|C[(F>>>3)+1]<<8;if(F+=32,ie>0)for(!O&&ee<U+ie&&(j=pt(j,U+ie),ee=j.length);ie-- >0;)j[U++]=C[F>>>3],F+=8;continue}for(;;){!O&&ee<U+32767&&(j=pt(j,U+32767),ee=j.length);var oe=Et(C,F,fe),Ee=M>>>1==1?jt[oe]:ce[oe];if(F+=Ee&15,Ee>>>=4,!(Ee>>>8&255))j[U++]=Ee;else{if(Ee==256)break;Ee-=257;var Ne=Ee<8?0:Ee-4>>2;Ne>5&&(Ne=0);var De=U+ne[Ee];Ne>0&&(De+=Et(C,F,Ne),F+=Ne),oe=Et(C,F,re),Ee=M>>>1==1?Xt[oe]:de[oe],F+=Ee&15,Ee>>>=4;var Ce=Ee<4?0:Ee-2>>1,Me=we[Ee];for(Ce>0&&(Me+=Et(C,F,Ce),F+=Ce),!O&&ee<De&&(j=pt(j,De+100),ee=j.length);U<De;)j[U]=j[U-Me],++U}}}return O?[j,F+7>>>3]:[j.slice(0,U),F+7>>>3]}function Xe(C,O){var F=C.slice(C.l||0),M=st(F,O);return C.l+=M[1],M[0]}function Ke(C,O){if(C)typeof console<"u"&&console.error(O);else throw new Error(O)}function ct(C,O){var F=C;Er(F,0);var M=[],j=[],U={FileIndex:M,FullPaths:j};P(U,{root:O.root});for(var ee=F.length-4;(F[ee]!=80||F[ee+1]!=75||F[ee+2]!=5||F[ee+3]!=6)&&ee>=0;)--ee;F.l=ee+4,F.l+=4;var fe=F.read_shift(2);F.l+=6;var re=F.read_shift(4);for(F.l=re,ee=0;ee<fe;++ee){F.l+=20;var ie=F.read_shift(4),oe=F.read_shift(4),Ee=F.read_shift(2),Ne=F.read_shift(2),De=F.read_shift(2);F.l+=8;var Ce=F.read_shift(4),Me=l(F.slice(F.l+Ee,F.l+Ee+Ne));F.l+=Ee+Ne+De;var qe=F.l;F.l=Ce+4,dt(F,ie,oe,U,Me),F.l=qe}return U}function dt(C,O,F,M,j){C.l+=2;var U=C.read_shift(2),ee=C.read_shift(2),fe=o(C);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var re=C.read_shift(4),ie=C.read_shift(4),oe=C.read_shift(4),Ee=C.read_shift(2),Ne=C.read_shift(2),De="",Ce=0;Ce<Ee;++Ce)De+=String.fromCharCode(C[C.l++]);if(Ne){var Me=l(C.slice(C.l,C.l+Ne));(Me[21589]||{}).mt&&(fe=Me[21589].mt),((j||{})[21589]||{}).mt&&(fe=j[21589].mt)}C.l+=Ne;var qe=C.slice(C.l,C.l+ie);switch(ee){case 8:qe=J(C,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var Mt=!1;U&8&&(re=C.read_shift(4),re==134695760&&(re=C.read_shift(4),Mt=!0),ie=C.read_shift(4),oe=C.read_shift(4)),ie!=O&&Ke(Mt,"Bad compressed size: "+O+" != "+ie),oe!=F&&Ke(Mt,"Bad uncompressed size: "+F+" != "+oe),rr(M,De,qe,{unsafe:!0,mt:fe})}function cr(C,O){var F=O||{},M=[],j=[],U=ur(1),ee=F.compression?8:0,fe=0,re=0,ie=0,oe=0,Ee=0,Ne=C.FullPaths[0],De=Ne,Ce=C.FileIndex[0],Me=[],qe=0;for(re=1;re<C.FullPaths.length;++re)if(De=C.FullPaths[re].slice(Ne.length),Ce=C.FileIndex[re],!(!Ce.size||!Ce.content||De=="Sh33tJ5")){var Mt=oe,Rt=ur(De.length);for(ie=0;ie<De.length;++ie)Rt.write_shift(1,De.charCodeAt(ie)&127);Rt=Rt.slice(0,Rt.l),Me[Ee]=$b.buf(Ce.content,0);var mr=Ce.content;ee==8&&(mr=q(mr)),U=ur(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,fe),U.write_shift(2,ee),Ce.mt?i(U,Ce.mt):U.write_shift(4,0),U.write_shift(-4,Me[Ee]),U.write_shift(4,mr.length),U.write_shift(4,Ce.content.length),U.write_shift(2,Rt.length),U.write_shift(2,0),oe+=U.length,M.push(U),oe+=Rt.length,M.push(Rt),oe+=mr.length,M.push(mr),U=ur(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,fe),U.write_shift(2,ee),U.write_shift(4,0),U.write_shift(-4,Me[Ee]),U.write_shift(4,mr.length),U.write_shift(4,Ce.content.length),U.write_shift(2,Rt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,Mt),qe+=U.l,j.push(U),qe+=Rt.length,j.push(Rt),++Ee}return U=ur(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,Ee),U.write_shift(2,Ee),U.write_shift(4,qe),U.write_shift(4,oe),U.write_shift(2,0),di([di(M),di(j),U])}var At={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function at(C,O){if(C.ctype)return C.ctype;var F=C.name||"",M=F.match(/\.([^\.]+)$/);return M&&At[M[1]]||O&&(M=(F=O).match(/[\.\\]([^\.\\])+$/),M&&At[M[1]])?At[M[1]]:"application/octet-stream"}function Q(C){for(var O=G1(C),F=[],M=0;M<O.length;M+=76)F.push(O.slice(M,M+76));return F.join(`\r
`)+`\r
`}function ge(C){var O=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ie){var oe=ie.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});O=O.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),O.charAt(0)==`
`&&(O="=0D"+O.slice(1)),O=O.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],M=O.split(`\r
`),j=0;j<M.length;++j){var U=M[j];if(U.length==0){F.push("");continue}for(var ee=0;ee<U.length;){var fe=76,re=U.slice(ee,ee+fe);re.charAt(fe-1)=="="?fe--:re.charAt(fe-2)=="="?fe-=2:re.charAt(fe-3)=="="&&(fe-=3),re=U.slice(ee,ee+fe),ee+=fe,ee<U.length&&(re+="="),F.push(re)}}return F.join(`\r
`)}function ze(C){for(var O=[],F=0;F<C.length;++F){for(var M=C[F];F<=C.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+C[++F];O.push(M)}for(var j=0;j<O.length;++j)O[j]=O[j].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Xn(O.join(`\r
`))}function ot(C,O,F){for(var M="",j="",U="",ee,fe=0;fe<10;++fe){var re=O[fe];if(!re||re.match(/^\s*$/))break;var ie=re.match(/^(.*?):\s*([^\s].*)$/);if(ie)switch(ie[1].toLowerCase()){case"content-location":M=ie[2].trim();break;case"content-type":U=ie[2].trim();break;case"content-transfer-encoding":j=ie[2].trim();break}}switch(++fe,j.toLowerCase()){case"base64":ee=Xn(xn(O.slice(fe).join("")));break;case"quoted-printable":ee=ze(O.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var oe=rr(C,M.slice(F.length),ee,{unsafe:!0});U&&(oe.ctype=U)}function mt(C,O){if(Y(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=O&&O.root||"",M=(gt&&Buffer.isBuffer(C)?C.toString("binary"):Y(C)).split(`\r
`),j=0,U="";for(j=0;j<M.length;++j)if(U=M[j],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),F||(F=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),U.slice(0,F.length)!=F););var ee=(M[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var fe="--"+(ee[1]||""),re=[],ie=[],oe={FileIndex:re,FullPaths:ie};P(oe);var Ee,Ne=0;for(j=0;j<M.length;++j){var De=M[j];De!==fe&&De!==fe+"--"||(Ne++&&ot(oe,M.slice(Ee,j),F),Ee=j)}return oe}function Ct(C,O){var F=O||{},M=F.boundary||"SheetJS";M="------="+M;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],U=C.FullPaths[0],ee=U,fe=C.FileIndex[0],re=1;re<C.FullPaths.length;++re)if(ee=C.FullPaths[re].slice(U.length),fe=C.FileIndex[re],!(!fe.size||!fe.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var ie=fe.content,oe=gt&&Buffer.isBuffer(ie)?ie.toString("binary"):Y(ie),Ee=0,Ne=Math.min(1024,oe.length),De=0,Ce=0;Ce<=Ne;++Ce)(De=oe.charCodeAt(Ce))>=32&&De<128&&++Ee;var Me=Ee>=Ne*4/5;j.push(M),j.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+ee),j.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),j.push("Content-Type: "+at(fe,ee)),j.push(""),j.push(Me?ge(oe):Q(oe))}return j.push(M+`--\r
`),j.join(`\r
`)}function qt(C){var O={};return P(O,C),O}function rr(C,O,F,M){var j=M&&M.unsafe;j||P(C);var U=!j&&vt.find(C,O);if(!U){var ee=C.FullPaths[0];O.slice(0,ee.length)==ee?ee=O:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+O).replace("//","/")),U={name:a(O),type:2},C.FileIndex.push(U),C.FullPaths.push(ee),j||vt.utils.cfb_gc(C)}return U.content=F,U.size=F?F.length:0,M&&(M.CLSID&&(U.clsid=M.CLSID),M.mt&&(U.mt=M.mt),M.ct&&(U.ct=M.ct)),U}function ia(C,O){P(C);var F=vt.find(C,O);if(F){for(var M=0;M<C.FileIndex.length;++M)if(C.FileIndex[M]==F)return C.FileIndex.splice(M,1),C.FullPaths.splice(M,1),!0}return!1}function Nr(C,O,F){P(C);var M=vt.find(C,O);if(M){for(var j=0;j<C.FileIndex.length;++j)if(C.FileIndex[j]==M)return C.FileIndex[j].name=a(F),C.FullPaths[j]=F,!0}return!1}function Ie(C){z(C,!0)}return t.find=B,t.read=D,t.parse=d,t.write=se,t.writeFile=ae,t.utils={cfb_new:qt,cfb_add:rr,cfb_del:ia,cfb_mov:Nr,cfb_gc:Ie,ReadShift:kl,CheckField:q2,prep_blob:Er,bconcat:di,use_zlib:R,_deflateRaw:He,_inflateRaw:Xe,consts:me},t}();function Gb(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function wa(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Yp(e){for(var t=[],r=wa(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var gf=new Date(1899,11,30,0,0,0);function Kr(e,t){var r=e.getTime(),n=gf.getTime()+(e.getTimezoneOffset()-gf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var A2=new Date,Zb=gf.getTime()+(A2.getTimezoneOffset()-gf.getTimezoneOffset())*6e4,tx=A2.getTimezoneOffset();function Kf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Zb),t.getTimezoneOffset()!==tx&&t.setTime(t.getTime()+(t.getTimezoneOffset()-tx)*6e4),t}function Xb(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var rx=new Date("2017-02-19T19:06:09.000Z"),N2=isNaN(rx.getFullYear())?new Date("2/19/17"):rx,qb=N2.getFullYear()==2017;function yr(e,t){var r=new Date(e);if(qb)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(N2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ps(e,t){if(gt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return fl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return fl(m2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return fl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return fl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Cr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Cr(e[r]));return t}function Kt(e,t){for(var r="";r.length<t;)r+=e;return r}function Qn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Yb=["january","february","march","april","may","june","july","august","september","october","november","december"];function ko(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Yb.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Kb=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(a),o.push(i[l]);return o}}();function L2(e){return e?e.content&&e.type?ps(e.content,!0):e.data?ll(e.data):e.asNodeBuffer&&gt?ll(e.asNodeBuffer().toString("binary")):e.asBinary?ll(e.asBinary()):e._data&&e._data.getContent?ll(ps(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function P2(e){if(!e)return null;if(e.data)return W1(e.data);if(e.asNodeBuffer&&gt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?W1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Jb(e){return e&&e.name.slice(-4)===".bin"?P2(e):L2(e)}function bn(e,t){for(var r=e.FullPaths||wa(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Kp(e,t){var r=bn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function sr(e,t,r){if(!r)return Jb(Kp(e,t));if(!t)return null;try{return sr(e,t)}catch{return null}}function dn(e,t,r){if(!r)return L2(Kp(e,t));if(!t)return null;try{return dn(e,t)}catch{return null}}function Qb(e,t,r){return P2(Kp(e,t))}function nx(e){for(var t=e.FullPaths||wa(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function eA(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return gt?n=_s(r):n=_b(r),vt.utils.cfb_add(e,t,n)}vt.utils.cfb_add(e,t,r)}else e.file(t,r)}function F2(e,t){switch(t.type){case"base64":return vt.read(e,{type:"base64"});case"binary":return vt.read(e,{type:"binary"});case"buffer":case"array":return vt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ul(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var O2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,tA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ax=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,rA=/<[^>]*>/g,Ur=O2.match(ax)?ax:rA,nA=/<\w*:/,aA=/<(\/?)\w+:/;function Ge(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(tA),l=0,u="",f=0,d="",m="",g=1;if(o)for(f=0;f!=o.length;++f){for(m=o[f],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(d=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(g=(a=m.charCodeAt(i+1))==34||a==39?1:0,u=m.slice(i+1+g,m.length-g),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var v=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[v]&&d.slice(l-3,l)=="ext")continue;n[v]=u,n[v.toLowerCase()]=u}}return n}function Ea(e){return e.replace(aA,"<$1")}var M2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},iA=Yp(M2),kt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,u){return M2[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),sA=/[&<>'"]/g,oA=/[\u0000-\u001f]/g;function Jp(e){var t=e+"";return t.replace(sA,function(r){return iA[r]}).replace(/\n/g,"<br/>").replace(oA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var ix=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function od(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function sx(e){var t=Li(2*e.length),r,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function ox(e){return _s(e,"binary").toString("utf8")}var ou="foo bar baz",Ot=gt&&(ox(ou)==od(ou)&&ox||sx(ou)==od(ou)&&sx)||od,fl=gt?function(e){return _s(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Kl=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),R2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),lA=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),cA=/<\/?(?:vt:)?variant>/g,uA=/<(?:vt:)([^>]*)>([\s\S]*)</;function lx(e,t){var r=Ge(e),n=e.match(lA(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(cA,"").match(uA);o&&a.push({v:Ot(o[2]),t:o[1]})}),a}var fA=/(^\s|\s$|\n)/;function dA(e){return wa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function hA(e,t,r){return"<"+e+(r!=null?dA(r):"")+(t!=null?(t.match(fA)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Qp(e){if(gt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ot(ys(Zp(e)));throw new Error("Bad input format: expected Buffer or string")}var Jl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,pA={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},mA=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function gA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function xA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var cx=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},ux=gt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:_s(t)})):cx(e)}:cx,fx=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(za(e,a)));return n.join("").replace(Yr,"")},em=gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Yr,""):fx(e,t,r)}:fx,dx=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},D2=gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):dx(e,t,r)}:dx,hx=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Is(e,a)));return n.join("")},xc=gt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):hx(t,r,n)}:hx,I2=function(e,t){var r=fn(e,t);return r>0?xc(e,t+4,t+4+r-1):""},j2=I2,B2=function(e,t){var r=fn(e,t);return r>0?xc(e,t+4,t+4+r-1):""},z2=B2,U2=function(e,t){var r=2*fn(e,t);return r>0?xc(e,t+4,t+4+r-1):""},H2=U2,V2=function(t,r){var n=fn(t,r);return n>0?em(t,r+4,r+4+n):""},W2=V2,$2=function(e,t){var r=fn(e,t);return r>0?xc(e,t+4,t+4+r):""},G2=$2,Z2=function(e,t){return gA(e,t)},xf=Z2,X2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};gt&&(j2=function(t,r){if(!Buffer.isBuffer(t))return I2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},z2=function(t,r){if(!Buffer.isBuffer(t))return B2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},H2=function(t,r){if(!Buffer.isBuffer(t))return U2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},W2=function(t,r){if(!Buffer.isBuffer(t))return V2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},G2=function(t,r){if(!Buffer.isBuffer(t))return $2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},xf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Z2(t,r)},X2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Is=function(e,t){return e[t]},za=function(e,t){return e[t+1]*256+e[t]},vA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},_A=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kl(e,t){var r="",n,a,i=[],o,l,u,f;switch(t){case"dbcs":if(f=this.l,gt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(za(this,f)),f+=2;e*=2;break;case"utf8":r=xc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=em(this,this.l,this.l+e);break;case"wstr":return kl.call(this,e,"dbcs");case"lpstr-ansi":r=j2(this,this.l),e=4+fn(this,this.l);break;case"lpstr-cp":r=z2(this,this.l),e=4+fn(this,this.l);break;case"lpwstr":r=H2(this,this.l),e=4+2*fn(this,this.l);break;case"lpp4":e=4+fn(this,this.l),r=W2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fn(this,this.l),r=G2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Is(this,this.l+e++))!==0;)i.push(su(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=za(this,this.l+e))!==0;)i.push(su(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Is(this,f),this.l=f+1,l=kl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(su(za(this,f))),f+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Is(this,f),this.l=f+1,l=kl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(su(Is(this,f))),f+=1}r=i.join("");break;default:switch(e){case 1:return n=Is(this,this.l),this.l++,n;case 2:return n=(t==="i"?vA:za)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Zi:_A)(this,this.l),this.l+=4,n):(a=fn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=xf(this,this.l):a=xf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=D2(this,this.l,e);break}}return this.l+=e,r}var yA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},wA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},kA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function EA(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)kA(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,yA(this,t,this.l);break;case 8:if(n=8,r==="f"){xA(this,t,this.l);break}case 16:break;case-4:n=4,wA(this,t,this.l);break}return this.l+=n,this}function q2(e,t){var r=D2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Er(e,t){e.l=t,e.read_shift=kl,e.chk=q2,e.write_shift=EA}function zr(e,t){e.l+=t}function ur(e){var t=Li(e);return Er(t,0),t}function ei(e,t,r){if(e){var n,a,i;Er(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var f=Ef[l]||Ef[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;u=e.l+i;var d=f.f&&f.f(e,i,r);if(e.l=u,t(d,f,l))return}}}function kh(){var e=[],t=gt?256:2048,r=function(f){var d=ur(f);return Er(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},o=function(){return a(),di(e)},l=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function El(e,t,r){var n=Cr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function px(e,t,r){var n=Cr(e);return n.s=El(n.s,t.s,r),n.e=El(n.e,t.s,r),n}function Sl(e,t){if(e.cRel&&e.c<0)for(e=Cr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Cr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Je(e);return!e.cRel&&e.cRel!=null&&(r=CA(r)),!e.rRel&&e.rRel!=null&&(r=SA(r)),r}function ld(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+hr(e.s.c)+":"+(e.e.cRel?"":"$")+hr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+br(e.s.r)+":"+(e.e.rRel?"":"$")+br(e.e.r):Sl(e.s,t.biff)+":"+Sl(e.e,t.biff)}function tm(e){return parseInt(TA(e),10)-1}function br(e){return""+(e+1)}function SA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function TA(e){return e.replace(/\$(\d+)$/,"$1")}function rm(e){for(var t=bA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function hr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function CA(e){return e.replace(/^([A-Z])/,"$$$1")}function bA(e){return e.replace(/^\$([A-Z])/,"$1")}function AA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Je(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Fo(e){var t=e.indexOf(":");return t==-1?{s:Xr(e),e:Xr(e)}:{s:Xr(e.slice(0,t)),e:Xr(e.slice(t+1))}}function _t(e,t){return typeof t>"u"||typeof t=="number"?_t(e.s,e.e):(typeof e!="string"&&(e=Je(e)),typeof t!="string"&&(t=Je(t)),e==t?e:e+":"+t)}function Jt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function mx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=In(e.z,r?Kr(t):t)}catch{}try{return e.w=In((e.XF||{}).numFmtId||(r?14:0),r?Kr(t):t)}catch{return""+t}}function Ya(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Es[e.v]||e.v:t==null?mx(e,e.v):mx(e,t))}function Di(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Y2(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Xr(n.origin):n.origin;o=u.r,l=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Jt(i["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),o==-1&&(f.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var v={v:t[m][g]},y=o+m,_=l+g;if(f.s.r>y&&(f.s.r=y),f.s.c>_&&(f.s.c=_),f.e.r<y&&(f.e.r=y),f.e.c<_&&(f.e.c=_),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))v=t[m][g];else if(Array.isArray(v.v)&&(v.f=t[m][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||tt[14],n.cellDates?(v.t="d",v.w=In(v.z,Kr(v.v))):(v.t="n",v.v=Kr(v.v),v.w=In(v.z,v.v))):v.t="s";if(a)i[y]||(i[y]=[]),i[y][_]&&i[y][_].z&&(v.z=i[y][_].z),i[y][_]=v;else{var S=Je({c:_,r:y});i[S]&&i[S].z&&(v.z=i[S].z),i[S]=v}}}return f.s.c<1e7&&(i["!ref"]=_t(f)),i}function Oo(e,t){return Y2(null,e,t)}function NA(e){return e.read_shift(4,"i")}function jr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function LA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function nm(e,t){var r=e.l,n=e.read_shift(1),a=jr(e),i=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)i.push(LA(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var PA=nm;function jn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ws(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var FA=jr;function am(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var OA=jr,Eh=am;function im(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?xf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zi(t,0)>>2;return r?a/100:a}function K2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ks=K2;function Dr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function MA(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=is[a];f&&(t.rgb=ec(f));break;case 2:t.rgb=ec([o,l,u]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function RA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function J2(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function DA(e){return J2(e,1)}function IA(e){return J2(e,2)}var sm=2,tn=3,lu=11,gx=12,vf=19,cu=64,jA=65,BA=71,zA=4108,UA=4126,xr=80,Q2=81,HA=[xr,Q2],VA={1:{n:"CodePage",t:sm},2:{n:"Category",t:xr},3:{n:"PresentationFormat",t:xr},4:{n:"ByteCount",t:tn},5:{n:"LineCount",t:tn},6:{n:"ParagraphCount",t:tn},7:{n:"SlideCount",t:tn},8:{n:"NoteCount",t:tn},9:{n:"HiddenCount",t:tn},10:{n:"MultimediaClipCount",t:tn},11:{n:"ScaleCrop",t:lu},12:{n:"HeadingPairs",t:zA},13:{n:"TitlesOfParts",t:UA},14:{n:"Manager",t:xr},15:{n:"Company",t:xr},16:{n:"LinksUpToDate",t:lu},17:{n:"CharacterCount",t:tn},19:{n:"SharedDoc",t:lu},22:{n:"HyperlinksChanged",t:lu},23:{n:"AppVersion",t:tn,p:"version"},24:{n:"DigSig",t:jA},26:{n:"ContentType",t:xr},27:{n:"ContentStatus",t:xr},28:{n:"Language",t:xr},29:{n:"Version",t:xr},255:{},2147483648:{n:"Locale",t:vf},2147483651:{n:"Behavior",t:vf},1919054434:{}},WA={1:{n:"CodePage",t:sm},2:{n:"Title",t:xr},3:{n:"Subject",t:xr},4:{n:"Author",t:xr},5:{n:"Keywords",t:xr},6:{n:"Comments",t:xr},7:{n:"Template",t:xr},8:{n:"LastAuthor",t:xr},9:{n:"RevNumber",t:xr},10:{n:"EditTime",t:cu},11:{n:"LastPrinted",t:cu},12:{n:"CreatedDate",t:cu},13:{n:"ModifiedDate",t:cu},14:{n:"PageCount",t:tn},15:{n:"WordCount",t:tn},16:{n:"CharCount",t:tn},17:{n:"Thumbnail",t:BA},18:{n:"Application",t:xr},19:{n:"DocSecurity",t:tn},255:{},2147483648:{n:"Locale",t:vf},2147483651:{n:"Behavior",t:vf},1919054434:{}},xx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},$A=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function GA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ZA=GA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),is=Cr(ZA),Es={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ew={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},vx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function XA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qA(e){var t=XA();if(!e||!e.match)return t;var r={};if((e.match(Ur)||[]).forEach(function(n){var a=Ge(n);switch(a[0].replace(nA,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[vx[a.ContentType]]!==void 0&&t[vx[a.ContentType]].push(a.PartName);break}}),t.xmlns!==pA.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Qs={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Tl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ur)||[]).forEach(function(a){var i=Ge(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:ul(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}var YA="application/vnd.oasis.opendocument.spreadsheet";function KA(e,t){for(var r=Qp(e),n,a;n=Jl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ge(n[0],!1),a.path=="/"&&a.type!==YA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Cl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],JA=function(){for(var e=new Array(Cl.length),t=0;t<Cl.length;++t){var r=Cl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function tw(e){var t={};e=Ot(e);for(var r=0;r<Cl.length;++r){var n=Cl[r],a=e.match(JA[r]);a!=null&&a.length>0&&(t[n[1]]=kt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=yr(t[n[1]]))}return t}var QA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function rw(e,t,r,n){var a=[];if(typeof e=="string")a=lx(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(d){return{v:d}}));var o=typeof t=="string"?lx(t,n).map(function(d){return d.v}):t,l=0,u=0;if(o.length>0)for(var f=0;f!==a.length;f+=2){switch(u=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function eN(e,t,r){var n={};return t||(t={}),e=Ot(e),QA.forEach(function(a){var i=(e.match(Kl(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=kt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&rw(n.HeadingPairs,n.TitlesOfParts,t,r),t}var tN=/<[^>]+>[^<]*/g;function rN(e,t){var r={},n="",a=e.match(tN);if(a)for(var i=0;i!=a.length;++i){var o=a[i],l=Ge(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=kt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=kt(d);break;case"bool":r[n]=Bt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=yr(d);break;case"cy":case"error":r[n]=kt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var nN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},cd;function aN(e,t,r){cd||(cd=Yp(nN)),t=cd[t]||t,e[t]=r}function om(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function nw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function aw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function iw(e,t,r){return t===31?aw(e):nw(e,t,r)}function Th(e,t,r){return iw(e,t,r===!1?0:4)}function iN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return iw(e,t,0)}function sN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Yr,""),e.l-a&2&&(e.l+=2)}return r}function oN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Yr,"");return r}function lN(e){var t=e.l,r=_f(e,Q2);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=_f(e,tn);return[r,n]}function cN(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(lN(e));return r}function _x(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Yr,"").replace(cl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function sw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function uN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function _f(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==gx&&n!==t&&HA.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===gx?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return nw(e,n,4).replace(Yr,"");case 31:return aw(e);case 64:return om(e);case 65:return sw(e);case 71:return uN(e);case 80:return Th(e,n,!i.raw).replace(Yr,"");case 81:return iN(e,n).replace(Yr,"");case 4108:return cN(e);case 4126:case 4127:return n==4127?sN(e):oN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function yx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,l=0,u=-1,f={};for(o=0;o!=a;++o){var d=e.read_shift(4),m=e.read_shift(4);i[o]=[d,m+r]}i.sort(function(E,w){return E[1]-w[1]});var g={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var v=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,v=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],v=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],v=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(v=!1,e.l=i[o][1]),v)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var y=t[i[o][0]];if(g[y.n]=_f(e,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qn(l=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(i[o][0]===1){if(l=g.CodePage=_f(e,sm),qn(l),u!==-1){var _=e.l;e.l=i[u][1],f=_x(e,l),e.l=_}}else if(i[o][0]===0){if(l===0){u=o,e.l=i[o+1][1];continue}f=_x(e,l)}else{var S=f[i[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=sw(e);break;case 30:e.l+=4,k=Th(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Th(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=er(e,4);break;case 64:e.l+=4,k=yr(om(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[S]=k}}return e.l=r+n,g}function wx(e,t,r){var n=e.content;if(!n)return{};Er(n,0);var a,i,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==vt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=yx(n,t),g={SystemIdentifier:f};for(var v in m)g[v]=m[v];if(g.FMTID=i,a===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var y;try{y=yx(n,null)}catch{}for(v in y)g[v]=y[v];return g.FMTID=[i,o],g}function ii(e,t){return e.read_shift(t),null}function fN(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function er(e,t){return e.read_shift(t)===1}function or(e){return e.read_shift(2,"u")}function ow(e,t){return fN(e,t,or)}function dN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function vc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function hN(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,l,u={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*o),n&&(e.l+=l),u.t=d,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function ms(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function _c(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ms(e,n,r)}function Ss(e,t,r){if(r.biff>5)return _c(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function pN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function mN(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Yr,"");return n&&(e.l+=24),a}function gN(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Yr,"");return r+o}function xN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return mN(e);case"0303000000000000c000000000000046":return gN(e);default:throw new Error("Unsupported Moniker "+r)}}function uu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Yr,""):"";return r}function vN(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,l,u,f="",d,m;a&16&&(i=uu(e,r-e.l)),a&128&&(o=uu(e,r-e.l)),(a&257)===257&&(l=uu(e,r-e.l)),(a&257)===1&&(u=xN(e,r-e.l)),a&8&&(f=uu(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(m=om(e)),e.l=r;var g=o||l||u||"";g&&f&&(g+="#"+f),g||(g="#"+f),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return d&&(v.guid=d),m&&(v.time=m),i&&(v.Tooltip=i),v}function lw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function cw(e,t){var r=lw(e);return r[3]=0,r}function Sa(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function _N(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function yN(e,t,r){return t===0?"":Ss(e,t,r)}function wN(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function uw(e){var t=e.read_shift(2),r=im(e);return[t,r]}function kN(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=vc(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Jf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function fw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var EN=fw;function dw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function SN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function TN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Fr(e){e.l+=2,e.l+=e.read_shift(2)}var CN={0:Fr,4:Fr,5:Fr,6:Fr,7:TN,8:Fr,9:Fr,10:Fr,11:Fr,12:Fr,13:SN,14:Fr,15:Fr,16:Fr,17:Fr,18:Fr,19:Fr,20:Fr,21:dw};function bN(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(CN[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function fu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function AN(e,t){return t===0||e.read_shift(2),1200}function NN(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ss(e,0,r);return e.read_shift(t+n-e.l),a}function LN(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function PN(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=vc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function FN(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(hN(e));return i.Count=n,i.Unique=a,i}function ON(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function MN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function RN(e){var t=_N(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function DN(e){return e.read_shift(2),e.read_shift(4)}function kx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function IN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:l,Selected:u,TabRatio:f}}function jN(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function BN(){}function zN(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=vc(e,0,r),n}function UN(e){var t=Sa(e);return t.isst=e.read_shift(4),t}function HN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Sa(e);r.biff==2&&e.l++;var i=_c(e,n-e.l,r);return a.val=i,a}function VN(e,t,r){var n=e.read_shift(2),a=Ss(e,0,r);return[n,a]}var WN=Ss;function Ex(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c:u}}}function $N(e){var t=e.read_shift(2),r=e.read_shift(2),n=uw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function GN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(uw(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function ZN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function XN(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return a.patternType=$A[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function qN(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=XN(e,t,n.fStyle,r),n}function YN(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Sx(e,t,r){var n=Sa(e);(r.biff==2||t==9)&&++e.l;var a=dN(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function KN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Sa(e),a=Dr(e);return n.val=a,n}var Tx=yN;function JN(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=ms(e,i),l=[];n>e.l;)l.push(_c(e));return[i,a,o,l]}function Cx(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=kN(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var QN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function bx(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=ms(e,o,r);a&32&&(f=QN[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var m=n==e.l||l===0||!(d>0)?[]:M6(e,d,r,l);return{chKey:i,Name:f,itab:u,rgce:m}}function hw(e,t,r){if(r.biff<8)return eL(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(wN(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function eL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=vc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function tL(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=ms(e,n,r),o=ms(e,a,r);return[i,o]}function rL(e,t,r){var n=fw(e);e.l++;var a=e.read_shift(1);return t-=8,[R6(e,t,r),a,n]}function Ax(e,t,r){var n=EN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,F6(e,t,r)]}function nL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function aL(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Ss(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,i]}}function iL(e,t,r){return aL(e,t,r)}function sL(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Jf(e));return r}function oL(e,t,r){if(r&&r.biff<8)return cL(e,t,r);var n=dw(e),a=bN(e,t-22,n[1]);return{cmo:n,ft:a}}var lL={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function cL(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((lL[n]||zr)(e,t,r)),{cmo:[a,n,i],ft:o}}function uL(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=pN(e,6,r);var l=e.read_shift(2);e.read_shift(2),or(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],m=ms(e,e.lens[f+1]-e.lens[f]-1);if(a+=m,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function fL(e,t){var r=Jf(e);e.l+=16;var n=vN(e,t-24);return[r,n]}function dL(e,t){e.read_shift(2);var r=Jf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Yr,""),[r,n]}function hL(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=xx[r]||r,r=e.read_shift(2),t[1]=xx[r]||r,t}function pL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(cw(e));return r}function mL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(cw(e));return r}function gL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function pw(e,t,r){if(!r.cellStyles)return zr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function xL(e,t){var r={};return t<32||(e.l+=16,r.header=Dr(e),r.footer=Dr(e),e.l+=2),r}function vL(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var _L=Sa,yL=ow,wL=_c;function kL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function EL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Sa(e);++e.l;var a=Ss(e,t-7,r);return n.t="str",n.val=a,n}function SL(e){var t=Sa(e);++e.l;var r=Dr(e);return t.t="n",t.val=r,t}function TL(e){var t=Sa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function CL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function bL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function AL(e,t,r){var n=e.l+t,a=Sa(e),i=e.read_shift(2),o=ms(e,i,r);return e.l=n,a.t="str",a.val=o,a}var NL=[2,3,48,49,131,139,140,245],Nx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var f=[],d=Li(1);switch(u.type){case"base64":d=Xn(xn(l));break;case"binary":d=Xn(l);break;case"buffer":case"array":d=l;break}Er(d,0);var m=d.read_shift(1),g=!!(m&136),v=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var _=0,S=521;m==2&&(_=d.read_shift(2)),d.l+=3,m!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),m!=2&&(S=d.read_shift(2));var k=d.read_shift(2),E=u.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(E=e[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var w=[],N={},I=Math.min(d.length,m==2?521:S-10-(v?264:0)),D=y?32:11;d.l<I&&d[d.l]!=13;)switch(N={},N.name=fi.utils.decode(E,d.slice(d.l,d.l+D)).replace(/[\u0000\r\n].*$/g,""),d.l+=D,N.type=String.fromCharCode(d.read_shift(1)),m!=2&&!y&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),m==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&w.push(N),m!=2&&(d.l+=y?13:14),N.type){case"B":(!v||N.len!=8)&&u.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=S-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=S;var P=0,V=0;for(f[0]=[],V=0;V!=w.length;++V)f[0][V]=w[V].name;for(;_-- >0;){if(d[d.l]===42){d.l+=k;continue}for(++d.l,f[++P]=[],V=0,V=0;V!=w.length;++V){var z=d.slice(d.l,d.l+w[V].len);d.l+=w[V].len,Er(z,0);var W=fi.utils.decode(E,z);switch(w[V].type){case"C":W.trim().length&&(f[P][V]=W.replace(/\s+$/,""));break;case"D":W.length===8?f[P][V]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):f[P][V]=W;break;case"F":f[P][V]=parseFloat(W.trim());break;case"+":case"I":f[P][V]=y?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":f[P][V]=!0;break;case"N":case"F":f[P][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[P][V]="##MEMO##"+(y?parseInt(W.trim(),10):z.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(f[P][V]=+W||0);break;case"@":f[P][V]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":f[P][V]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":f[P][V]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[P][V]=-z.read_shift(-8,"f");break;case"B":if(v&&w[V].len==8){f[P][V]=z.read_shift(8,"f");break}case"G":case"P":z.l+=w[V].len;break;case"0":if(w[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[V].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=w,f}function n(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=Oo(r(l,f),f);return d["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,d}function a(l,u){try{return Di(n(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var f=u||{};if(+f.codepage>=0&&qn(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=kh(),m=Fh(l,{header:1,raw:!0,cellDates:!0}),g=m[0],v=m.slice(1),y=l["!cols"]||[],_=0,S=0,k=0,E=1;for(_=0;_<g.length;++_){if(((y[_]||{}).DBF||{}).name){g[_]=y[_].DBF.name,++k;continue}if(g[_]!=null){if(++k,typeof g[_]=="number"&&(g[_]=g[_].toString(10)),typeof g[_]!="string")throw new Error("DBF Invalid column name "+g[_]+" |"+typeof g[_]+"|");if(g.indexOf(g[_])!==_){for(S=0;S<1024;++S)if(g.indexOf(g[_]+"_"+S)==-1){g[_]+="_"+S;break}}}}var w=Jt(l["!ref"]),N=[],I=[],D=[];for(_=0;_<=w.e.c-w.s.c;++_){var P="",V="",z=0,W=[];for(S=0;S<v.length;++S)v[S][_]!=null&&W.push(v[S][_]);if(W.length==0||g[_]==null){N[_]="?";continue}for(S=0;S<W.length;++S){switch(typeof W[S]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=W[S]instanceof Date?"D":"C";break;default:V="C"}z=Math.max(z,String(W[S]).length),P=P&&P!=V?"C":V}z>250&&(z=250),V=((y[_]||{}).DBF||{}).type,V=="C"&&y[_].DBF.len>z&&(z=y[_].DBF.len),P=="B"&&V=="N"&&(P="N",D[_]=y[_].DBF.dec,z=y[_].DBF.len),I[_]=P=="C"||V=="N"?z:i[P]||0,E+=I[_],N[_]=P}var B=d.next(32);for(B.write_shift(4,318902576),B.write_shift(4,v.length),B.write_shift(2,296+32*k),B.write_shift(2,E),_=0;_<4;++_)B.write_shift(4,0);for(B.write_shift(4,0|(+t[h2]||3)<<8),_=0,S=0;_<g.length;++_)if(g[_]!=null){var G=d.next(32),K=(g[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,K,"sbcs"),G.write_shift(1,N[_]=="?"?"C":N[_],"sbcs"),G.write_shift(4,S),G.write_shift(1,I[_]||i[N[_]]||0),G.write_shift(1,D[_]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),S+=I[_]||i[N[_]]||0}var ve=d.next(264);for(ve.write_shift(4,13),_=0;_<65;++_)ve.write_shift(4,0);for(_=0;_<v.length;++_){var xe=d.next(E);for(xe.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(N[S]){case"L":xe.write_shift(1,v[_][S]==null?63:v[_][S]?84:70);break;case"B":xe.write_shift(8,v[_][S]||0,"f");break;case"N":var he="0";for(typeof v[_][S]=="number"&&(he=v[_][S].toFixed(D[S]||0)),k=0;k<I[S]-he.length;++k)xe.write_shift(1,32);xe.write_shift(1,he,"sbcs");break;case"D":v[_][S]?(xe.write_shift(4,("0000"+v[_][S].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(v[_][S].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+v[_][S].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var me=String(v[_][S]!=null?v[_][S]:"").slice(0,I[S]);for(xe.write_shift(1,me,"sbcs"),k=0;k<I[S]-me.length;++k)xe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),LL=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,v){var y=e[v];return typeof y=="number"?$1(y):y},n=function(g,v,y){var _=v.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return _==59?g:$1(_)};e["|"]=254;function a(g,v){switch(v.type){case"base64":return i(xn(g),v);case"binary":return i(g,v);case"buffer":return i(gt&&Buffer.isBuffer(g)?g.toString("binary"):ys(g),v);case"array":return i(ps(g),v)}throw new Error("Unrecognized type "+v.type)}function i(g,v){var y=g.split(/[\n\r]+/),_=-1,S=-1,k=0,E=0,w=[],N=[],I=null,D={},P=[],V=[],z=[],W=0,B;for(+v.codepage>=0&&qn(+v.codepage);k!==y.length;++k){W=0;var G=y[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),K=G.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),ve=K[0],xe;if(G.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&N.push(G.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,me=!1,ae=!1,Y=!1,se=-1,ye=-1;for(E=1;E<K.length;++E)switch(K[E].charAt(0)){case"A":break;case"X":S=parseInt(K[E].slice(1))-1,me=!0;break;case"Y":for(_=parseInt(K[E].slice(1))-1,me||(S=0),B=w.length;B<=_;++B)w[B]=[];break;case"K":xe=K[E].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(Qn(xe))?isNaN(ko(xe).getDate())||(xe=yr(xe)):(xe=Qn(xe),I!==null&&Po(I)&&(xe=Kf(xe))),he=!0;break;case"E":Y=!0;var R=co(K[E].slice(1),{r:_,c:S});w[_][S]=[w[_][S],R];break;case"S":ae=!0,w[_][S]=[w[_][S],"S5S"];break;case"G":break;case"R":se=parseInt(K[E].slice(1))-1;break;case"C":ye=parseInt(K[E].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}if(he&&(w[_][S]&&w[_][S].length==2?w[_][S][0]=xe:w[_][S]=xe,I=null),ae){if(Y)throw new Error("SYLK shared formula cannot have own formula");var J=se>-1&&w[se][ye];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");w[_][S][1]=Sw(J[1],{r:_-se,c:S-ye})}break;case"F":var q=0;for(E=1;E<K.length;++E)switch(K[E].charAt(0)){case"X":S=parseInt(K[E].slice(1))-1,++q;break;case"Y":for(_=parseInt(K[E].slice(1))-1,B=w.length;B<=_;++B)w[B]=[];break;case"M":W=parseInt(K[E].slice(1))/20;break;case"F":break;case"G":break;case"P":I=N[parseInt(K[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=K[E].slice(1).split(" "),B=parseInt(z[0],10);B<=parseInt(z[1],10);++B)W=parseInt(z[2],10),V[B-1]=W===0?{hidden:!0}:{wch:W},Eo(V[B-1]);break;case"C":S=parseInt(K[E].slice(1))-1,V[S]||(V[S]={});break;case"R":_=parseInt(K[E].slice(1))-1,P[_]||(P[_]={}),W>0?(P[_].hpt=W,P[_].hpx=tc(W)):W===0&&(P[_].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}q<1&&(I=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}}return P.length>0&&(D["!rows"]=P),V.length>0&&(D["!cols"]=V),v&&v.sheetRows&&(w=w.slice(0,v.sheetRows)),[w,D]}function o(g,v){var y=a(g,v),_=y[0],S=y[1],k=Oo(_,v);return wa(S).forEach(function(E){k[E]=S[E]}),k}function l(g,v){return Di(o(g,v),v)}function u(g,v,y,_){var S="C;Y"+(y+1)+";X"+(_+1)+";K";switch(g.t){case"n":S+=g.v||0,g.f&&!g.F&&(S+=";E"+gF(g.f,{r:y,c:_}));break;case"b":S+=g.v?"TRUE":"FALSE";break;case"e":S+=g.w||g.v;break;case"d":S+='"'+(g.w||g.v)+'"';break;case"s":S+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(g,v){v.forEach(function(y,_){var S="F;W"+(_+1)+" "+(_+1)+" ";y.hidden?S+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=wf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=kf(y.wpx)),typeof y.wch=="number"&&(S+=Math.round(y.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function d(g,v){v.forEach(function(y,_){var S="F;";y.hidden?S+="M0;":y.hpt?S+="M"+20*y.hpt+";":y.hpx&&(S+="M"+20*ww(y.hpx)+";"),S.length>2&&g.push(S+"R"+(_+1))})}function m(g,v){var y=["ID;PWXL;N;E"],_=[],S=Jt(g["!ref"]),k,E=Array.isArray(g),w=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&f(y,g["!cols"]),g["!rows"]&&d(y,g["!rows"]),y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var N=S.s.r;N<=S.e.r;++N)for(var I=S.s.c;I<=S.e.c;++I){var D=Je({r:N,c:I});k=E?(g[N]||[])[I]:g[D],!(!k||k.v==null&&(!k.f||k.F))&&_.push(u(k,g,N,I))}return y.join(w)+w+_.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),PL=function(){function e(i,o){switch(o.type){case"base64":return t(xn(i),o);case"binary":return t(i,o);case"buffer":return t(gt&&Buffer.isBuffer(i)?i.toString("binary"):ys(i),o);case"array":return t(ps(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),u=-1,f=-1,d=0,m=[];d!==l.length;++d){if(l[d].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var g=l[d].trim().split(","),v=g[0],y=g[1];++d;for(var _=l[d]||"";(_.match(/["]/g)||[]).length&1&&d<l.length-1;)_+=`
`+l[++d];switch(_=_.trim(),+v){case-1:if(_==="BOT"){m[++u]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?m[u][f]=!0:_==="FALSE"?m[u][f]=!1:isNaN(Qn(y))?isNaN(ko(y).getDate())?m[u][f]=y:m[u][f]=yr(y):m[u][f]=Qn(y),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),m[u][f++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return Oo(e(i,o),o)}function n(i,o){return Di(r(i,o),o)}var a=function(){var i=function(u,f,d,m,g){u.push(f),u.push(d+","+m),u.push('"'+g.replace(/"/g,'""')+'"')},o=function(u,f,d,m){u.push(f+","+d),u.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var f=[],d=Jt(u["!ref"]),m,g=Array.isArray(u);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,d.e.r-d.s.r+1,""),i(f,"TUPLES",0,d.e.c-d.s.c+1,""),i(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){o(f,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var _=Je({r:v,c:y});if(m=g?(u[v]||[])[y]:u[_],!m){o(f,1,0,"");continue}switch(m.t){case"n":var S=m.w;!S&&m.v!=null&&(S=m.v),S==null?m.f&&!m.F?o(f,1,0,"="+m.f):o(f,1,0,""):o(f,0,S,"V");break;case"b":o(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=In(m.z||tt[14],Kr(yr(m.v)))),o(f,0,m.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var k=`\r
`,E=f.join(k);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),FL=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var v=m.split(`
`),y=-1,_=-1,S=0,k=[];S!==v.length;++S){var E=v[S].trim().split(":");if(E[0]==="cell"){var w=Xr(E[1]);if(k.length<=w.r)for(y=k.length;y<=w.r;++y)k[y]||(k[y]=[]);switch(y=w.r,_=w.c,E[2]){case"t":k[y][_]=e(E[3]);break;case"v":k[y][_]=+E[3];break;case"vtf":var N=E[E.length-1];case"vtc":switch(E[3]){case"nl":k[y][_]=!!+E[4];break;default:k[y][_]=+E[4];break}E[2]=="vtf"&&(k[y][_]=[k[y][_],N])}}}return g&&g.sheetRows&&(k=k.slice(0,g.sheetRows)),k}function n(m,g){return Oo(r(m,g),g)}function a(m,g){return Di(n(m,g),g)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var g=[],v=[],y,_="",S=Fo(m["!ref"]),k=Array.isArray(m),E=S.s.r;E<=S.e.r;++E)for(var w=S.s.c;w<=S.e.c;++w)if(_=Je({r:E,c:w}),y=k?(m[E]||[])[w]:m[_],!(!y||y.v==null||y.t==="z")){switch(v=["cell",_,"t"],y.t){case"s":case"str":v.push(t(y.v));break;case"n":y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=t(y.f)):(v[2]="v",v[3]=y.v);break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var N=Kr(yr(y.v));v[2]="vtc",v[3]="nd",v[4]=""+N,v[5]=y.w||In(y.z||tt[14],N);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(m){return[i,o,l,o,f(m),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Ql=function(){function e(d,m,g,v,y){y.raw?m[g][v]=d:d===""||(d==="TRUE"?m[g][v]=!0:d==="FALSE"?m[g][v]=!1:isNaN(Qn(d))?isNaN(ko(d).getDate())?m[g][v]=d:m[g][v]=yr(d):m[g][v]=Qn(d))}function t(d,m){var g=m||{},v=[];if(!d||d.length===0)return v;for(var y=d.split(/[\r\n]/),_=y.length-1;_>=0&&y[_].length===0;)--_;for(var S=10,k=0,E=0;E<=_;++E)k=y[E].indexOf(" "),k==-1?k=y[E].length:k++,S=Math.max(S,k);for(E=0;E<=_;++E){v[E]=[];var w=0;for(e(y[E].slice(0,S).trim(),v,E,w,g),w=1;w<=(y[E].length-S)/10+1;++w)e(y[E].slice(S+(w-1)*10,S+w*10).trim(),v,E,w,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var m={},g=!1,v=0,y=0;v<d.length;++v)(y=d.charCodeAt(v))==34?g=!g:!g&&y in r&&(m[y]=(m[y]||0)+1);y=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&y.push([m[v],v]);if(!y.length){m=n;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&y.push([m[v],v])}return y.sort(function(_,S){return _[0]-S[0]||n[_[1]]-n[S[1]]}),r[y.pop()[1]]||44}function i(d,m){var g=m||{},v="",y=g.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=a(d.slice(0,1024)):g&&g.FS?v=g.FS:v=a(d.slice(0,1024));var S=0,k=0,E=0,w=0,N=0,I=v.charCodeAt(0),D=!1,P=0,V=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var z=g.dateNF!=null?Vb(g.dateNF):null;function W(){var B=d.slice(w,N),G={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)G.t="z";else if(g.raw)G.t="s",G.v=B;else if(B.trim().length===0)G.t="s",G.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(G.t="s",G.v=B.slice(2,-1).replace(/""/g,'"')):vF(B)?(G.t="n",G.f=B.slice(1)):(G.t="s",G.v=B);else if(B=="TRUE")G.t="b",G.v=!0;else if(B=="FALSE")G.t="b",G.v=!1;else if(!isNaN(E=Qn(B)))G.t="n",g.cellText!==!1&&(G.w=B),G.v=E;else if(!isNaN(ko(B).getDate())||z&&B.match(z)){G.z=g.dateNF||tt[14];var K=0;z&&B.match(z)&&(B=Wb(B,g.dateNF,B.match(z)||[]),K=1),g.cellDates?(G.t="d",G.v=yr(B,K)):(G.t="n",G.v=Kr(yr(B,K))),g.cellText!==!1&&(G.w=In(G.z,G.v instanceof Date?Kr(G.v):G.v)),g.cellNF||delete G.z}else G.t="s",G.v=B;if(G.t=="z"||(g.dense?(y[S]||(y[S]=[]),y[S][k]=G):y[Je({c:k,r:S})]=G),w=N+1,V=d.charCodeAt(w),_.e.c<k&&(_.e.c=k),_.e.r<S&&(_.e.r=S),P==I)++k;else if(k=0,++S,g.sheetRows&&g.sheetRows<=S)return!0}e:for(;N<d.length;++N)switch(P=d.charCodeAt(N)){case 34:V===34&&(D=!D);break;case I:case 10:case 13:if(!D&&W())break e;break}return N-w>0&&W(),y["!ref"]=_t(_),y}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,m):Oo(t(d,m),m)}function l(d,m){var g="",v=m.type=="string"?[0,0,0,0]:mm(d,m);switch(m.type){case"base64":g=xn(d);break;case"binary":g=d;break;case"buffer":m.codepage==65001?g=d.toString("utf8"):m.codepage&&typeof fi<"u"?g=fi.utils.decode(m.codepage,d):g=gt&&Buffer.isBuffer(d)?d.toString("binary"):ys(d);break;case"array":g=ps(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=Ot(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=Ot(g):m.type=="binary"&&typeof fi<"u"&&m.codepage&&(g=fi.utils.decode(m.codepage,fi.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?FL.to_sheet(m.type=="string"?g:Ot(g),m):o(g,m)}function u(d,m){return Di(l(d,m),m)}function f(d){for(var m=[],g=Jt(d["!ref"]),v,y=Array.isArray(d),_=g.s.r;_<=g.e.r;++_){for(var S=[],k=g.s.c;k<=g.e.c;++k){var E=Je({r:_,c:k});if(v=y?(d[_]||[])[k]:d[E],!v||v.v==null){S.push("          ");continue}for(var w=(v.w||(Ya(v),v.w)||"").slice(0,10);w.length<10;)w+=" ";S.push(w+(k===0?" ":""))}m.push(S.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}();function OL(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=LL.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Ql.to_workbook(e,t)}}var bl=function(){function e(R,J,q){if(R){Er(R,R.l||0);for(var Z=q.Enum||se;R.l<R.length;){var ne=R.read_shift(2),we=Z[ne]||Z[65535],Le=R.read_shift(2),be=R.l+Le,_e=we.f&&we.f(R,Le,q);if(R.l=be,J(_e,we,ne))return}}}function t(R,J){switch(J.type){case"base64":return r(Xn(xn(R)),J);case"binary":return r(Xn(R),J);case"buffer":case"array":return r(R,J)}throw"Unsupported type "+J.type}function r(R,J){if(!R)return R;var q=J||{},Z=q.dense?[]:{},ne="Sheet1",we="",Le=0,be={},_e=[],Be=[],H={s:{r:0,c:0},e:{r:0,c:0}},Ye=q.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)q.Enum=se,e(R,function(Ae,Et,pe){switch(pe){case 0:q.vers=Ae,Ae>=4096&&(q.qpro=!0);break;case 6:H=Ae;break;case 204:Ae&&(we=Ae);break;case 222:we=Ae;break;case 15:case 51:q.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:pe==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=q.dateNF||tt[14],q.cellDates&&(Ae[1].t="d",Ae[1].v=Kf(Ae[1].v))),q.qpro&&Ae[3]>Le&&(Z["!ref"]=_t(H),be[ne]=Z,_e.push(ne),Z=q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Le=Ae[3],ne=we||"Sheet"+(Le+1),we="");var Pe=q.dense?(Z[Ae[0].r]||[])[Ae[0].c]:Z[Je(Ae[0])];if(Pe){Pe.t=Ae[1].t,Pe.v=Ae[1].v,Ae[1].z!=null&&(Pe.z=Ae[1].z),Ae[1].f!=null&&(Pe.f=Ae[1].f);break}q.dense?(Z[Ae[0].r]||(Z[Ae[0].r]=[]),Z[Ae[0].r][Ae[0].c]=Ae[1]):Z[Je(Ae[0])]=Ae[1];break}},q);else if(R[2]==26||R[2]==14)q.Enum=ye,R[2]==14&&(q.qpro=!0,R.l=0),e(R,function(Ae,Et,pe){switch(pe){case 204:ne=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Le&&(Z["!ref"]=_t(H),be[ne]=Z,_e.push(ne),Z=q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Le=Ae[3],ne="Sheet"+(Le+1)),Ye>0&&Ae[0].r>=Ye)break;q.dense?(Z[Ae[0].r]||(Z[Ae[0].r]=[]),Z[Ae[0].r][Ae[0].c]=Ae[1]):Z[Je(Ae[0])]=Ae[1],H.e.c<Ae[0].c&&(H.e.c=Ae[0].c),H.e.r<Ae[0].r&&(H.e.r=Ae[0].r);break;case 27:Ae[14e3]&&(Be[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:Be[Ae[0]]=Ae[1],Ae[0]==Le&&(ne=Ae[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(Z["!ref"]=_t(H),be[we||ne]=Z,_e.push(we||ne),!Be.length)return{SheetNames:_e,Sheets:be};for(var nt={},it=[],Ze=0;Ze<Be.length;++Ze)be[_e[Ze]]?(it.push(Be[Ze]||_e[Ze]),nt[Be[Ze]]=be[Be[Ze]]||be[_e[Ze]]):(it.push(Be[Ze]),nt[Be[Ze]]={"!ref":"A1"});return{SheetNames:it,Sheets:nt}}function n(R,J){var q=J||{};if(+q.codepage>=0&&qn(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=kh(),ne=Jt(R["!ref"]),we=Array.isArray(R),Le=[];Wn(Z,0,i(1030)),Wn(Z,6,u(ne));for(var be=Math.min(ne.e.r,8191),_e=ne.s.r;_e<=be;++_e)for(var Be=br(_e),H=ne.s.c;H<=ne.e.c;++H){_e===ne.s.r&&(Le[H]=hr(H));var Ye=Le[H]+Be,nt=we?(R[_e]||[])[H]:R[Ye];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?Wn(Z,13,v(_e,H,nt.v)):Wn(Z,14,_(_e,H,nt.v));else{var it=Ya(nt);Wn(Z,15,m(_e,H,it.slice(0,239)))}}return Wn(Z,1),Z.end()}function a(R,J){var q=J||{};if(+q.codepage>=0&&qn(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=kh();Wn(Z,0,o(R));for(var ne=0,we=0;ne<R.SheetNames.length;++ne)(R.Sheets[R.SheetNames[ne]]||{})["!ref"]&&Wn(Z,27,Y(R.SheetNames[ne],we++));var Le=0;for(ne=0;ne<R.SheetNames.length;++ne){var be=R.Sheets[R.SheetNames[ne]];if(!(!be||!be["!ref"])){for(var _e=Jt(be["!ref"]),Be=Array.isArray(be),H=[],Ye=Math.min(_e.e.r,8191),nt=_e.s.r;nt<=Ye;++nt)for(var it=br(nt),Ze=_e.s.c;Ze<=_e.e.c;++Ze){nt===_e.s.r&&(H[Ze]=hr(Ze));var Ae=H[Ze]+it,Et=Be?(be[nt]||[])[Ze]:be[Ae];if(!(!Et||Et.t=="z"))if(Et.t=="n")Wn(Z,23,W(nt,Ze,Le,Et.v));else{var pe=Ya(Et);Wn(Z,22,P(nt,Ze,Le,pe.slice(0,239)))}}++Le}}return Wn(Z,1),Z.end()}function i(R){var J=ur(2);return J.write_shift(2,R),J}function o(R){var J=ur(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var q=0,Z=0,ne=0,we=0;we<R.SheetNames.length;++we){var Le=R.SheetNames[we],be=R.Sheets[Le];if(!(!be||!be["!ref"])){++ne;var _e=Fo(be["!ref"]);q<_e.e.r&&(q=_e.e.r),Z<_e.e.c&&(Z=_e.e.c)}}return q>8191&&(q=8191),J.write_shift(2,q),J.write_shift(1,ne),J.write_shift(1,Z),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function l(R,J,q){var Z={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&q.qpro?(Z.s.c=R.read_shift(1),R.l++,Z.s.r=R.read_shift(2),Z.e.c=R.read_shift(1),R.l++,Z.e.r=R.read_shift(2),Z):(Z.s.c=R.read_shift(2),Z.s.r=R.read_shift(2),J==12&&q.qpro&&(R.l+=2),Z.e.c=R.read_shift(2),Z.e.r=R.read_shift(2),J==12&&q.qpro&&(R.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function u(R){var J=ur(8);return J.write_shift(2,R.s.c),J.write_shift(2,R.s.r),J.write_shift(2,R.e.c),J.write_shift(2,R.e.r),J}function f(R,J,q){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Z[0].c=R.read_shift(1),Z[3]=R.read_shift(1),Z[0].r=R.read_shift(2),R.l+=2):(Z[2]=R.read_shift(1),Z[0].c=R.read_shift(2),Z[0].r=R.read_shift(2)),Z}function d(R,J,q){var Z=R.l+J,ne=f(R,J,q);if(ne[1].t="s",q.vers==20768){R.l++;var we=R.read_shift(1);return ne[1].v=R.read_shift(we,"utf8"),ne}return q.qpro&&R.l++,ne[1].v=R.read_shift(Z-R.l,"cstr"),ne}function m(R,J,q){var Z=ur(7+q.length);Z.write_shift(1,255),Z.write_shift(2,J),Z.write_shift(2,R),Z.write_shift(1,39);for(var ne=0;ne<Z.length;++ne){var we=q.charCodeAt(ne);Z.write_shift(1,we>=128?95:we)}return Z.write_shift(1,0),Z}function g(R,J,q){var Z=f(R,J,q);return Z[1].v=R.read_shift(2,"i"),Z}function v(R,J,q){var Z=ur(7);return Z.write_shift(1,255),Z.write_shift(2,J),Z.write_shift(2,R),Z.write_shift(2,q,"i"),Z}function y(R,J,q){var Z=f(R,J,q);return Z[1].v=R.read_shift(8,"f"),Z}function _(R,J,q){var Z=ur(13);return Z.write_shift(1,255),Z.write_shift(2,J),Z.write_shift(2,R),Z.write_shift(8,q,"f"),Z}function S(R,J,q){var Z=R.l+J,ne=f(R,J,q);if(ne[1].v=R.read_shift(8,"f"),q.qpro)R.l=Z;else{var we=R.read_shift(2);N(R.slice(R.l,R.l+we),ne),R.l+=we}return ne}function k(R,J,q){var Z=J&32768;return J&=-32769,J=(Z?R:0)+(J>=8192?J-16384:J),(Z?"":"$")+(q?hr(J):br(J))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(R,J){Er(R,0);for(var q=[],Z=0,ne="",we="",Le="",be="";R.l<R.length;){var _e=R[R.l++];switch(_e){case 0:q.push(R.read_shift(8,"f"));break;case 1:we=k(J[0].c,R.read_shift(2),!0),ne=k(J[0].r,R.read_shift(2),!1),q.push(we+ne);break;case 2:{var Be=k(J[0].c,R.read_shift(2),!0),H=k(J[0].r,R.read_shift(2),!1);we=k(J[0].c,R.read_shift(2),!0),ne=k(J[0].r,R.read_shift(2),!1),q.push(Be+H+":"+we+ne)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(R.read_shift(2));break;case 6:{for(var Ye="";_e=R[R.l++];)Ye+=String.fromCharCode(_e);q.push('"'+Ye.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:be=q.pop(),Le=q.pop(),q.push(["AND","OR"][_e-20]+"("+Le+","+be+")");break;default:if(_e<32&&w[_e])be=q.pop(),Le=q.pop(),q.push(Le+w[_e]+be);else if(E[_e]){if(Z=E[_e][1],Z==69&&(Z=R[R.l++]),Z>q.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+q.join("|")+"|");return}var nt=q.slice(-Z);q.length-=Z,q.push(E[_e][0]+"("+nt.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}q.length==1?J[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function I(R){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=R.read_shift(2),J[3]=R[R.l++],J[0].c=R[R.l++],J}function D(R,J){var q=I(R);return q[1].t="s",q[1].v=R.read_shift(J-4,"cstr"),q}function P(R,J,q,Z){var ne=ur(6+Z.length);ne.write_shift(2,R),ne.write_shift(1,q),ne.write_shift(1,J),ne.write_shift(1,39);for(var we=0;we<Z.length;++we){var Le=Z.charCodeAt(we);ne.write_shift(1,Le>=128?95:Le)}return ne.write_shift(1,0),ne}function V(R,J){var q=I(R);q[1].v=R.read_shift(2);var Z=q[1].v>>1;if(q[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return q[1].v=Z,q}function z(R,J){var q=I(R),Z=R.read_shift(4),ne=R.read_shift(4),we=R.read_shift(2);if(we==65535)return Z===0&&ne===3221225472?(q[1].t="e",q[1].v=15):Z===0&&ne===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Le=we&32768;return we=(we&32767)-16446,q[1].v=(1-Le*2)*(ne*Math.pow(2,we+32)+Z*Math.pow(2,we)),q}function W(R,J,q,Z){var ne=ur(14);if(ne.write_shift(2,R),ne.write_shift(1,q),ne.write_shift(1,J),Z==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var we=0,Le=0,be=0,_e=0;return Z<0&&(we=1,Z=-Z),Le=Math.log2(Z)|0,Z/=Math.pow(2,Le-31),_e=Z>>>0,_e&2147483648||(Z/=2,++Le,_e=Z>>>0),Z-=_e,_e|=2147483648,_e>>>=0,Z*=Math.pow(2,32),be=Z>>>0,ne.write_shift(4,be),ne.write_shift(4,_e),Le+=16383+(we?32768:0),ne.write_shift(2,Le),ne}function B(R,J){var q=z(R);return R.l+=J-14,q}function G(R,J){var q=I(R),Z=R.read_shift(4);return q[1].v=Z>>6,q}function K(R,J){var q=I(R),Z=R.read_shift(8,"f");return q[1].v=Z,q}function ve(R,J){var q=K(R);return R.l+=J-10,q}function xe(R,J){return R[R.l+J-1]==0?R.read_shift(J,"cstr"):""}function he(R,J){var q=R[R.l++];q>J-1&&(q=J-1);for(var Z="";Z.length<q;)Z+=String.fromCharCode(R[R.l++]);return Z}function me(R,J,q){if(!(!q.qpro||J<21)){var Z=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var ne=R.read_shift(J-21,"cstr");return[Z,ne]}}function ae(R,J){for(var q={},Z=R.l+J;R.l<Z;){var ne=R.read_shift(2);if(ne==14e3){for(q[ne]=[0,""],q[ne][0]=R.read_shift(2);R[R.l];)q[ne][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return q}function Y(R,J){var q=ur(5+R.length);q.write_shift(2,14e3),q.write_shift(2,J);for(var Z=0;Z<R.length;++Z){var ne=R.charCodeAt(Z);q[q.l++]=ne>127?95:ne}return q[q.l++]=0,q}var se={0:{n:"BOF",f:or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function ML(e){var t={},r=e.match(Ur),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Ge(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=$p[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var RL=function(){var e=Kl("t"),t=Kl("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:kt(o[1])},u=i.match(t);return u&&(l.s=ML(u[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),DL=function(){var t=/(\r\n|\n)/g;function r(a,i,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),IL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,jL=/<(?:\w+:)?r>/,BL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function lm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=kt(Ot(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ot(e),r&&(n.h=Jp(n.t))):e.match(jL)&&(n.r=Ot(e),n.t=kt(Ot((e.replace(BL,"").match(IL)||[]).join("").replace(Ur,""))),r&&(n.h=DL(RL(n.r)))),n):{t:""}}var zL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,UL=/<(?:\w+:)?(?:si|sstItem)>/g,HL=/<\/(?:\w+:)?(?:si|sstItem)>/;function VL(e,t){var r=[],n="";if(!e)return r;var a=e.match(zL);if(a){n=a[2].replace(UL,"").split(HL);for(var i=0;i!=n.length;++i){var o=lm(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=Ge(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function WL(e){return[e.read_shift(4),e.read_shift(4)]}function $L(e,t){var r=[],n=!1;return ei(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function mw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Wa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function GL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Wa(e,4),t.U=Wa(e,4),t.W=Wa(e,4),t}function ZL(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function XL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(ZL(e));return t}function qL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function YL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Wa(e,4),t.U=Wa(e,4),t.W=Wa(e,4),t}function KL(e){var t=YL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function gw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function xw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function JL(e){var t=Wa(e);switch(t.Minor){case 2:return[t.Minor,QL(e)];case 3:return[t.Minor,eP()];case 4:return[t.Minor,tP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function QL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=gw(e,r),a=xw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function eP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function tP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ur,function(i){var o=Ge(i);switch(Ea(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function rP(e,t){var r={},n=r.EncryptionVersionInfo=Wa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=gw(e,a),t-=a,r.EncryptionVerifier=xw(e,t),r}function nP(e){var t={},r=t.EncryptionVersionInfo=Wa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function aP(e){var t=0,r,n=mw(e),a=n.length+1,i,o,l,u,f;for(r=Li(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],l=t&16384?1:0,u=t<<1&32767,f=l|u,t=f^o;return t^52811}var vw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],u=104,f=o.length-1;f>=0;--f)for(var d=o[f],m=0;m!=7;++m)d&64&&(l^=r[u]),d*=2,--u;return l};return function(o){for(var l=mw(o),u=i(l),f=l.length,d=Li(16),m=0;m!=16;++m)d[m]=0;var g,v,y;for((f&1)===1&&(g=u>>8,d[f]=a(e[0],g),--f,g=u&255,v=l[l.length-1],d[f]=a(v,g));f>0;)--f,g=u>>8,d[f]=a(l[f],g),--f,g=u&255,d[f]=a(l[f],g);for(f=15,y=15-l.length;y>0;)g=u>>8,d[f]=a(e[y],g),--f,--y,g=u&255,d[f]=a(l[f],g),--f,--y;return d}}(),iP=function(e,t,r,n,a){a||(a=t),n||(n=vw(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},sP=function(e){var t=0,r=vw(e);return function(n){var a=iP("",n,t,r);return t=a[1],a[0]}};function oP(e,t,r,n){var a={key:or(e),verificationBytes:or(e)};return r.password&&(a.verifier=aP(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=sP(r.password)),a}function lP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=nP(e):n.Data=rP(e,t),n}function cP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?lP(e,t-2,n):oP(e,r.biff>=8?t:t-2,r,n),n}var uP=function(){function e(a,i){switch(i.type){case"base64":return t(xn(a),i);case"binary":return t(a,i);case"buffer":return t(gt&&Buffer.isBuffer(a)?a.toString("binary"):ys(a),i);case"array":return t(ps(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},l=o.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,m){Array.isArray(l)&&(l[m]=[]);for(var g=/\\\w+\b/g,v=0,y,_=-1;y=g.exec(d);){switch(y[0]){case"\\cell":var S=d.slice(v,g.lastIndex-y[0].length);if(S[0]==" "&&(S=S.slice(1)),++_,S.length){var k={v:S,t:"s"};Array.isArray(l)?l[m][_]=k:l[Je({r:m,c:_})]=k}break}v=g.lastIndex}_>f.e.c&&(f.e.c=_)}),l["!ref"]=_t(f),l}function r(a,i){return Di(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=Jt(a["!ref"]),l,u=Array.isArray(a),f=o.s.r;f<=o.e.r;++f){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=Je({r:f,c:d});l=u?(a[f]||[])[d]:a[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Ya(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function fP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ec(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function dP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var l=0,u=0,f=a+i;switch(u=o/(f>1?2-f:f),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,f/2]}function hP(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=a*l,o[0]+=a,o[1]+=u;break;case 1:u=a*(2-l),o[0]+=u,o[1]+=a;break;case 2:u=a*(l-2),o[1]+=a,o[2]+=u;break;case 3:u=a*(4-l),o[1]+=u,o[2]+=a;break;case 4:u=a*(l-4),o[2]+=a,o[0]+=u;break;case 5:u=a*(6-l),o[2]+=u,o[0]+=a;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function yf(e,t){if(t===0)return e;var r=dP(fP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ec(hP(r))}var _w=6,pP=15,mP=1,Gr=_w;function wf(e){return Math.floor((e+Math.round(128/Gr)/256)*Gr)}function kf(e){return Math.floor((e-5)/Gr*100+.5)/100}function Ch(e){return Math.round((e*Gr+5)/Gr*256)/256}function ud(e){return Ch(kf(wf(e)))}function cm(e){var t=Math.abs(e-ud(e)),r=Gr;if(t>.005)for(Gr=mP;Gr<pP;++Gr)Math.abs(e-ud(e))<=t&&(t=Math.abs(e-ud(e)),r=Gr);Gr=r}function Eo(e){e.width?(e.wpx=wf(e.width),e.wch=kf(e.wpx),e.MDW=Gr):e.wpx?(e.wch=kf(e.wpx),e.width=Ch(e.wch),e.MDW=Gr):typeof e.wch=="number"&&(e.width=Ch(e.wch),e.wpx=wf(e.width),e.MDW=Gr),e.customWidth&&delete e.customWidth}var gP=96,yw=gP;function ww(e){return e*96/yw}function tc(e){return e*yw/96}var xP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function vP(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Ur)||[]).forEach(function(o){var l=Ge(o);switch(Ea(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Bt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Bt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function _P(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Ur)||[]).forEach(function(o){var l=Ge(o);switch(Ea(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function yP(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Ur)||[]).forEach(function(o){var l=Ge(o);switch(Ea(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Ot(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Bt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Bt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Bt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Bt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Bt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Bt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Bt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=$p[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Bt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var u=is[a.color.index];a.color.index==81&&(u=is[1]),u||(u=is[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=yf(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function wP(e,t,r){t.NumberFmt=[];for(var n=wa(tt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=tt[n[a]];var i=e[0].match(Ur);if(i)for(a=0;a<i.length;++a){var o=Ge(i[a]);switch(Ea(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=kt(Ot(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}as(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var du=["numFmtId","fillId","fontId","borderId","xfId"],hu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function kP(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Ur)||[]).forEach(function(i){var o=Ge(i),l=0;switch(Ea(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<du.length;++l)n[du[l]]&&(n[du[l]]=parseInt(n[du[l]],10));for(l=0;l<hu.length;++l)n[hu[l]]&&(n[hu[l]]=Bt(n[hu[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Bt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var EP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,f){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&wP(m,d,f),(m=l.match(a))&&yP(m,d,u,f),(m=l.match(n))&&_P(m,d,u,f),(m=l.match(i))&&vP(m,d,u,f),(m=l.match(r))&&kP(m,d,f),d}}();function SP(e,t){var r=e.read_shift(2),n=jr(e);return[r,n]}function TP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=RA(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=MA(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jr(e),n}var CP=zr;function bP(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var AP=zr;function NP(e,t,r){var n={};n.NumberFmt=[];for(var a in tt)n.NumberFmt[a]=tt[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return ei(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],as(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=yf(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(f.T>0)i.push(d);else if(f.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var LP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function PP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ur)||[]).forEach(function(a){var i=Ge(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[LP.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function FP(){}function OP(){}var MP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,RP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,DP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function IP(e,t,r){t.themeElements={};var n;[["clrScheme",MP,PP],["fontScheme",RP,FP],["fmtScheme",DP,OP]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var jP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function kw(e,t){(!e||e.length===0)&&(e=BP());var r,n={};if(!(r=e.match(jP)))throw new Error("themeElements not found in theme");return IP(r[0],n,t),n.raw=e,n}function BP(e,t){var r=[O2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function zP(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=F2(i,{type:"array"})}catch{return}var l=dn(o,"theme/theme/theme1.xml",!0);if(l)return kw(l,r)}}function UP(e){return e.read_shift(4)}function HP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=VP(e,4);break;case 2:t.xclrValue=lw(e);break;case 3:t.xclrValue=UP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function VP(e,t){return zr(e,t)}function WP(e,t){return zr(e,t)}function $P(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=HP(e);break;case 6:n[1]=WP(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function GP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push($P(e,r-e.l));return{ixfe:n,ext:i}}function ZP(e,t){t.forEach(function(r){switch(r[0]){}})}function XP(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jr(e)}}function qP(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function YP(e){return e.l+=4,e.read_shift(4)!=0}function KP(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,l=2;return ei(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!f.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function JP(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(Ur,function(l){var u=Ge(l);switch(Ea(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(o=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):i==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function QP(e){var t=[];if(!e)return t;var r=1;return(e.match(Ur)||[]).forEach(function(n){var a=Ge(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function eF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Je(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function tF(e,t,r){var n=[];return ei(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function rF(e,t,r,n){if(!e)return e;var a=n||{},i=!1;ei(e,function(l,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function nF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Lx(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var l=Xr(o.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[o.ref]=i;var u=Jt(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var f=_t(u);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(d.a==n[m].id){d.a=n[m].name||d.a;break}}i.c.push(d)})}function aF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Ge(l[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Xr(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&lm(m[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function iF(e,t){var r=[],n=!1,a={},i=0;return e.replace(Ur,function(l,u){var f=Ge(l);switch(Ea(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=u+l.length;break;case"</text>":a.t=e.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return l}),r}function sF(e,t){var r=[],n=!1;return e.replace(Ur,function(i){var o=Ge(i);switch(Ea(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function oF(e){var t={};t.iauthor=e.read_shift(4);var r=ks(e);return t.rfx=r.s,t.ref=Je(r.s),e.l+=16,t}var lF=jr;function cF(e,t){var r=[],n=[],a={},i=!1;return ei(e,function(l,u,f){switch(f){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var uF="application/vnd.ms-office.vbaProject";function fF(e){var t=vt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),vt.write(t)}function dF(){return{"!type":"dialog"}}function hF(){return{"!type":"dialog"}}function pF(){return{"!type":"macro"}}function mF(){return{"!type":"macro"}}var co=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var l=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,a+(l?"":"$")+hr(d)+(u?"":"$")+br(f)}return function(a,i){return t=i,a.replace(e,r)}}(),Ew=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gF=function(){return function(t,r){return t.replace(Ew,function(n,a,i,o,l,u){var f=rm(o)-(i?0:r.c),d=tm(u)-(l?0:r.r),m=d==0?"":l?d+1:"["+d+"]",g=f==0?"":i?f+1:"["+f+"]";return a+"R"+m+"C"+g})}}();function Sw(e,t){return e.replace(Ew,function(r,n,a,i,o,l){return n+(a=="$"?a+i:hr(rm(i)+t.c))+(o=="$"?o+l:br(tm(l)+t.r))})}function xF(e,t,r){var n=Fo(t),a=n.s,i=Xr(r),o={r:i.r-a.r,c:i.c-a.c};return Sw(e,o)}function vF(e){return e.length!=1}function Px(e){return e.replace(/_xlfn\./g,"")}function ir(e){e.l+=1}function Pi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Tw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Cw(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Pi(e),l=Pi(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Cw(e){var t=Pi(e),r=Pi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function _F(e,t,r){if(r.biff<8)return Cw(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Pi(e),o=Pi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function bw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return yF(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Pi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function yF(e){var t=Pi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function wF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function kF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EF(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function EF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function SF(e,t,r){var n=(e[e.l++]&96)>>5,a=Tw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function TF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=Tw(e,i,r);return[n,a,o]}function CF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function bF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function AF(e,t,r){var n=(e[e.l++]&96)>>5,a=_F(e,t-1,r);return[n,a]}function NF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Fx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function LF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function PF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function FF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function MF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Aw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function RF(e){return e.read_shift(2),Aw(e)}function DF(e){return e.read_shift(2),Aw(e)}function IF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=bw(e,0,r);return[n,a]}function jF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=kF(e,0,r);return[n,a]}function BF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=bw(e,0,r);return[n,a,i]}function zF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[U6[a],Pw[a],n]}function UF(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:HF(e);return[a,(i[0]===0?Pw:z6)[i[1]]]}function HF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function VF(e,t,r){e.l+=r&&r.biff==2?3:4}function WF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function $F(e){return e.l++,Es[e.read_shift(1)]}function GF(e){return e.l++,e.read_shift(2)}function ZF(e){return e.l++,e.read_shift(1)!==0}function XF(e){return e.l++,Dr(e)}function qF(e,t,r){return e.l++,vc(e,t-1,r)}function YF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=er(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Es[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Dr(e);break;case 2:r[1]=Ss(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function KF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?ks:Jf)(e));return a}function JF(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=YF(e,r.biff);return o}function QF(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function e6(e,t,r){if(r.biff==5)return t6(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function t6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function r6(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function n6(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function a6(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function i6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var s6=zr,o6=zr,l6=zr;function yc(e,t,r){return e.l+=2,[wF(e)]}function um(e){return e.l+=6,[]}var c6=yc,u6=um,f6=um,d6=yc;function Nw(e){return e.l+=2,[or(e),e.read_shift(2)&1]}var h6=yc,p6=Nw,m6=um,g6=yc,x6=yc,v6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function _6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=v6[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function y6(e){return e.l+=2,[e.read_shift(4)]}function w6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function k6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function E6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function S6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function T6(e){return e.l+=4,[0,0]}var Ox={1:{n:"PtgExp",f:WF},2:{n:"PtgTbl",f:l6},3:{n:"PtgAdd",f:ir},4:{n:"PtgSub",f:ir},5:{n:"PtgMul",f:ir},6:{n:"PtgDiv",f:ir},7:{n:"PtgPower",f:ir},8:{n:"PtgConcat",f:ir},9:{n:"PtgLt",f:ir},10:{n:"PtgLe",f:ir},11:{n:"PtgEq",f:ir},12:{n:"PtgGe",f:ir},13:{n:"PtgGt",f:ir},14:{n:"PtgNe",f:ir},15:{n:"PtgIsect",f:ir},16:{n:"PtgUnion",f:ir},17:{n:"PtgRange",f:ir},18:{n:"PtgUplus",f:ir},19:{n:"PtgUminus",f:ir},20:{n:"PtgPercent",f:ir},21:{n:"PtgParen",f:ir},22:{n:"PtgMissArg",f:ir},23:{n:"PtgStr",f:qF},26:{n:"PtgSheet",f:w6},27:{n:"PtgEndSheet",f:k6},28:{n:"PtgErr",f:$F},29:{n:"PtgBool",f:ZF},30:{n:"PtgInt",f:GF},31:{n:"PtgNum",f:XF},32:{n:"PtgArray",f:NF},33:{n:"PtgFunc",f:zF},34:{n:"PtgFuncVar",f:UF},35:{n:"PtgName",f:QF},36:{n:"PtgRef",f:IF},37:{n:"PtgArea",f:SF},38:{n:"PtgMemArea",f:r6},39:{n:"PtgMemErr",f:s6},40:{n:"PtgMemNoMem",f:o6},41:{n:"PtgMemFunc",f:n6},42:{n:"PtgRefErr",f:a6},43:{n:"PtgAreaErr",f:CF},44:{n:"PtgRefN",f:jF},45:{n:"PtgAreaN",f:AF},46:{n:"PtgMemAreaN",f:E6},47:{n:"PtgMemNoMemN",f:S6},57:{n:"PtgNameX",f:e6},58:{n:"PtgRef3d",f:BF},59:{n:"PtgArea3d",f:TF},60:{n:"PtgRefErr3d",f:i6},61:{n:"PtgAreaErr3d",f:bF},255:{}},C6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},b6={1:{n:"PtgElfLel",f:Nw},2:{n:"PtgElfRw",f:g6},3:{n:"PtgElfCol",f:c6},6:{n:"PtgElfRwV",f:x6},7:{n:"PtgElfColV",f:d6},10:{n:"PtgElfRadical",f:h6},11:{n:"PtgElfRadicalS",f:m6},13:{n:"PtgElfColS",f:u6},15:{n:"PtgElfColSV",f:f6},16:{n:"PtgElfRadicalLel",f:p6},25:{n:"PtgList",f:_6},29:{n:"PtgSxName",f:y6},255:{}},A6={0:{n:"PtgAttrNoop",f:T6},1:{n:"PtgAttrSemi",f:MF},2:{n:"PtgAttrIf",f:FF},4:{n:"PtgAttrChoose",f:LF},8:{n:"PtgAttrGoto",f:PF},16:{n:"PtgAttrSum",f:VF},32:{n:"PtgAttrBaxcel",f:Fx},33:{n:"PtgAttrBaxcel",f:Fx},64:{n:"PtgAttrSpace",f:RF},65:{n:"PtgAttrSpaceSemi",f:DF},128:{n:"PtgAttrIfError",f:OF},255:{}};function wc(e,t,r,n){if(n.biff<8)return zr(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=JF(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=KF(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(zr(e,t)),i}function kc(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Ox[i]||Ox[C6[i]],(i===24||i===25)&&(a=(i===24?b6:A6)[e[e.l+1]]),!a||!a.f?zr(e,t):o.push([a.n,a.f(e,t,r)]);return o}function N6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var L6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function P6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Lw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Mx(e,t,r){var n=Lw(e,t,r);return n=="#REF"?n:P6(n,r)}function Or(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],u,f,d,m=0,g=0,v,y="";if(!e[0]||!e[0][0])return"";for(var _=-1,S="",k=0,E=e[0].length;k<E;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),_>=0){switch(e[0][_][1][0]){case 0:S=Kt(" ",e[0][_][1][1]);break;case 1:S=Kt("\r",e[0][_][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}f=f+S,_=-1}l.push(f+L6[w[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=El(w[1][1],o,a),l.push(Sl(d,i));break;case"PtgRefN":d=r?El(w[1][1],r,a):w[1][1],l.push(Sl(d,i));break;case"PtgRef3d":m=w[1][1],d=El(w[1][2],o,a),y=Mx(n,m,a),l.push(y+"!"+Sl(d,i));break;case"PtgFunc":case"PtgFuncVar":var N=w[1][0],I=w[1][1];N||(N=0),N&=127;var D=N==0?[]:l.slice(-N);l.length-=N,I==="User"&&(I=D.shift()),l.push(I+"("+D.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":v=px(w[1][1],r?{s:r}:o,a),l.push(ld(v,a));break;case"PtgArea":v=px(w[1][1],o,a),l.push(ld(v,a));break;case"PtgArea3d":m=w[1][1],v=w[1][2],y=Mx(n,m,a),l.push(y+"!"+ld(v,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=w[1][2];var P=(n.names||[])[g-1]||(n[0]||[])[g],V=P?P.Name:"SH33TJSNAME"+String(g);V&&V.slice(0,6)=="_xlfn."&&!a.xlfn&&(V=V.slice(6)),l.push(V);break;case"PtgNameX":var z=w[1][1];g=w[1][2];var W;if(a.biff<=5)z<0&&(z=-z),n[z]&&(W=n[z][g]);else{var B="";if(((n[z]||[])[0]||[])[0]==14849||(((n[z]||[])[0]||[])[0]==1025?n[z][g]&&n[z][g].itab>0&&(B=n.SheetNames[n[z][g].itab-1]+"!"):B=n.SheetNames[g-1]+"!"),n[z]&&n[z][g])B+=n[z][g].Name;else if(n[0]&&n[0][g])B+=n[0][g].Name;else{var G=(Lw(n,z,a)||"").split(";;");G[g-1]?B=G[g-1]:B+="SH33TJSERRX"}l.push(B);break}W||(W={Name:"SH33TJSERRY"}),l.push(W.Name);break;case"PtgParen":var K="(",ve=")";if(_>=0){switch(S="",e[0][_][1][0]){case 2:K=Kt(" ",e[0][_][1][1])+K;break;case 3:K=Kt("\r",e[0][_][1][1])+K;break;case 4:ve=Kt(" ",e[0][_][1][1])+ve;break;case 5:ve=Kt("\r",e[0][_][1][1])+ve;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}l.push(K+l.pop()+ve);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var xe={c:r.c,r:r.r};if(n.sharedf[Je(d)]){var he=n.sharedf[Je(d)];l.push(Or(he,o,xe,n,a))}else{var me=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(Or(f[1],o,xe,n,a)),me=!0;break}me||l.push(w[1])}break;case"PtgArray":l.push("{"+N6(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&_>=0&&ae.indexOf(e[0][k][0])==-1){w=e[0][_];var Y=!0;switch(w[1][0]){case 4:Y=!1;case 0:S=Kt(" ",w[1][1]);break;case 5:Y=!1;case 1:S=Kt("\r",w[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((Y?S:"")+l.pop()+(Y?"":S)),_=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function F6(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],zr(e,t-2)];var l=kc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function O6(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],zr(e,t-2)];var l=kc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function M6(e,t,r,n){var a=e.l+t,i=kc(e,n,r),o;return a!==e.l&&(o=wc(e,a-e.l,i,r)),[i,o]}function R6(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=kc(e,i,r);return i==65535?[[],zr(e,t-2)]:(t!==i+2&&(a=wc(e,n-i-2,o,r)),[o,a])}function D6(e){var t;if(za(e,e.l+6)!==65535)return[Dr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function fd(e,t,r){var n=e.l+t,a=Sa(e);r.biff==2&&++e.l;var i=D6(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=O6(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function Qf(e,t,r){var n=e.read_shift(4),a=kc(e,n,r),i=e.read_shift(4),o=i>0?wc(e,i,a,r):null;return[a,o]}var I6=Qf,e0=Qf,j6=Qf,B6=Qf,z6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Pw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},U6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Rx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function dd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Al={},uo={};function Nl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Fw(e,t,r,n,a,i){try{n.cellNF&&(e.z=tt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=yr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(tt[t]==null&&as(Hb[t]||"General",t),e.t==="e")e.w=e.w||Es[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v);else if(e.t==="d"){var o=Kr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Yl(o)}else{if(e.v===void 0)return"";e.w=hs(e.v,uo)}else e.t==="d"?e.w=In(t,Kr(e.v),uo):e.w=In(t,e.v,uo)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=yf(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=yf(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function H6(e,t){var r=Jt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=_t(r))}var V6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,W6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$6=/<(?:\w:)?hyperlink [^>]*>/mg,G6=/"(\w*:\w*)"/,Z6=/<(?:\w:)?col\b[^>]*[\/]?>/g,X6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,q6=/<(?:\w:)?pageMargins[^>]*\/>/g,Ow=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Y6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,K6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function J6(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",m=e.match(W6);m?(f=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):f=d=e;var g=f.match(Ow);g?fm(g[0],l,a,r):(g=f.match(Y6))&&Q6(g[0],g[1]||"",l,a,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var y=f.slice(v,v+50).match(G6);y&&H6(l,y[1])}var _=f.match(K6);_&&_[1]&&i5(_[1],a);var S=[];if(t.cellStyles){var k=f.match(Z6);k&&r5(S,k)}m&&s5(m[1],l,t,u,i,o);var E=d.match(X6);E&&(l["!autofilter"]=n5(E[0]));var w=[],N=d.match(V6);if(N)for(v=0;v!=N.length;++v)w[v]=Jt(N[v].slice(N[v].indexOf('"')+1));var I=d.match($6);I&&e5(l,I,n);var D=d.match(q6);if(D&&(l["!margins"]=t5(Ge(D[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=_t(u)),t.sheetRows>0&&l["!ref"]){var P=Jt(l["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>u.e.r&&(P.e.r=u.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>u.e.c&&(P.e.c=u.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),l["!fullref"]=l["!ref"],l["!ref"]=_t(P))}return S.length>0&&(l["!cols"]=S),w.length>0&&(l["!merges"]=w),l}function fm(e,t,r,n){var a=Ge(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=kt(Ot(a.codeName)))}function Q6(e,t,r,n,a){fm(e.slice(0,e.indexOf(">")),r,n,a)}function e5(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Ge(Ot(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+kt(i.location))):(i.Target="#"+kt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=Jt(i.ref),u=l.s.r;u<=l.e.r;++u)for(var f=l.s.c;f<=l.e.c;++f){var d=Je({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function t5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function r5(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ge(t[n],!0);a.hidden&&(a.hidden=Bt(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,cm(a.width)),Eo(a);i<=o;)e[i++]=Cr(a)}}function n5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var a5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function i5(e,t){t.Views||(t.Views=[{}]),(e.match(a5)||[]).forEach(function(r,n){var a=Ge(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Bt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var s5=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Kl("v"),o=Kl("f");return function(u,f,d,m,g,v){for(var y=0,_="",S=[],k=[],E=0,w=0,N=0,I="",D,P,V=0,z=0,W,B,G=0,K=0,ve=Array.isArray(v.CellXf),xe,he=[],me=[],ae=Array.isArray(f),Y=[],se={},ye=!1,R=!!d.sheetStubs,J=u.split(t),q=0,Z=J.length;q!=Z;++q){_=J[q].trim();var ne=_.length;if(ne!==0){var we=0;e:for(y=0;y<ne;++y)switch(_[y]){case">":if(_[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(P=Ge(_.slice(we,y),!0),V=P.r!=null?parseInt(P.r,10):V+1,z=-1,d.sheetRows&&d.sheetRows<V)continue;se={},ye=!1,P.ht&&(ye=!0,se.hpt=parseFloat(P.ht),se.hpx=tc(se.hpt)),P.hidden=="1"&&(ye=!0,se.hidden=!0),P.outlineLevel!=null&&(ye=!0,se.level=+P.outlineLevel),ye&&(Y[V-1]=se)}break;case"<":we=y;break}if(we>=y)break;if(P=Ge(_.slice(we,y),!0),V=P.r!=null?parseInt(P.r,10):V+1,z=-1,!(d.sheetRows&&d.sheetRows<V)){m.s.r>V-1&&(m.s.r=V-1),m.e.r<V-1&&(m.e.r=V-1),d&&d.cellStyles&&(se={},ye=!1,P.ht&&(ye=!0,se.hpt=parseFloat(P.ht),se.hpx=tc(se.hpt)),P.hidden=="1"&&(ye=!0,se.hidden=!0),P.outlineLevel!=null&&(ye=!0,se.level=+P.outlineLevel),ye&&(Y[V-1]=se)),S=_.slice(y).split(e);for(var Le=0;Le!=S.length&&S[Le].trim().charAt(0)=="<";++Le);for(S=S.slice(Le),y=0;y!=S.length;++y)if(_=S[y].trim(),_.length!==0){if(k=_.match(r),E=y,w=0,N=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,k!=null&&k.length===2){for(E=0,I=k[1],w=0;w!=I.length&&!((N=I.charCodeAt(w)-64)<1||N>26);++w)E=26*E+N;--E,z=E}else++z;for(w=0;w!=_.length&&_.charCodeAt(w)!==62;++w);if(++w,P=Ge(_.slice(0,w),!0),P.r||(P.r=Je({r:V-1,c:z})),I=_.slice(w),D={t:""},(k=I.match(i))!=null&&k[1]!==""&&(D.v=kt(k[1])),d.cellFormula){if((k=I.match(o))!=null&&k[1]!==""){if(D.f=kt(Ot(k[1])).replace(/\r\n/g,`
`),d.xlfn||(D.f=Px(D.f)),k[0].indexOf('t="array"')>-1)D.F=(I.match(a)||[])[1],D.F.indexOf(":")>-1&&he.push([Jt(D.F),D.F]);else if(k[0].indexOf('t="shared"')>-1){B=Ge(k[0]);var be=kt(Ot(k[1]));d.xlfn||(be=Px(be)),me[parseInt(B.si,10)]=[B,be,P.r]}}else(k=I.match(/<f[^>]*\/>/))&&(B=Ge(k[0]),me[B.si]&&(D.f=xF(me[B.si][1],me[B.si][2],P.r)));var _e=Xr(P.r);for(w=0;w<he.length;++w)_e.r>=he[w][0].s.r&&_e.r<=he[w][0].e.r&&_e.c>=he[w][0].s.c&&_e.c<=he[w][0].e.c&&(D.F=he[w][1])}if(P.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(R)D.t="z";else continue;else D.t=P.t||"n";switch(m.s.c>z&&(m.s.c=z),m.e.c<z&&(m.e.c=z),D.t){case"n":if(D.v==""||D.v==null){if(!R)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!R)continue;D.t="z"}else W=Al[parseInt(D.v,10)],D.v=W.t,D.r=W.r,d.cellHTML&&(D.h=W.h);break;case"str":D.t="s",D.v=D.v!=null?Ot(D.v):"",d.cellHTML&&(D.h=Jp(D.v));break;case"inlineStr":k=I.match(n),D.t="s",k!=null&&(W=lm(k[1]))?(D.v=W.t,d.cellHTML&&(D.h=W.h)):D.v="";break;case"b":D.v=Bt(D.v);break;case"d":d.cellDates?D.v=yr(D.v,1):(D.v=Kr(yr(D.v,1)),D.t="n");break;case"e":(!d||d.cellText!==!1)&&(D.w=D.v),D.v=ew[D.v];break}if(G=K=0,xe=null,ve&&P.s!==void 0&&(xe=v.CellXf[P.s],xe!=null&&(xe.numFmtId!=null&&(G=xe.numFmtId),d.cellStyles&&xe.fillId!=null&&(K=xe.fillId))),Fw(D,G,K,d,g,v),d.cellDates&&ve&&D.t=="n"&&Po(tt[G])&&(D.t="d",D.v=Kf(D.v)),P.cm&&d.xlmeta){var Be=(d.xlmeta.Cell||[])[+P.cm-1];Be&&Be.type=="XLDAPR"&&(D.D=!0)}if(ae){var H=Xr(P.r);f[H.r]||(f[H.r]=[]),f[H.r][H.c]=D}else f[P.r]=D}}}}Y.length>0&&(f["!rows"]=Y)}}();function o5(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var l5=ks;function c5(){}function u5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=FA(e),r}function f5(e){var t=jn(e);return[t]}function d5(e){var t=ws(e);return[t]}function h5(e){var t=jn(e),r=e.read_shift(1);return[t,r,"b"]}function p5(e){var t=ws(e),r=e.read_shift(1);return[t,r,"b"]}function m5(e){var t=jn(e),r=e.read_shift(1);return[t,r,"e"]}function g5(e){var t=ws(e),r=e.read_shift(1);return[t,r,"e"]}function x5(e){var t=jn(e),r=e.read_shift(4);return[t,r,"s"]}function v5(e){var t=ws(e),r=e.read_shift(4);return[t,r,"s"]}function _5(e){var t=jn(e),r=Dr(e);return[t,r,"n"]}function Mw(e){var t=ws(e),r=Dr(e);return[t,r,"n"]}function y5(e){var t=jn(e),r=im(e);return[t,r,"n"]}function w5(e){var t=ws(e),r=im(e);return[t,r,"n"]}function k5(e){var t=jn(e),r=nm(e);return[t,r,"is"]}function E5(e){var t=jn(e),r=jr(e);return[t,r,"str"]}function S5(e){var t=ws(e),r=jr(e);return[t,r,"str"]}function T5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Or(l,null,a,r.supbooks,r)}else e.l=n;return o}function C5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Or(l,null,a,r.supbooks,r)}else e.l=n;return o}function b5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=Dr(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Or(l,null,a,r.supbooks,r)}else e.l=n;return o}function A5(e,t,r){var n=e.l+t,a=jn(e);a.r=r["!row"];var i=jr(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=e0(e,n-e.l,r);o[3]=Or(l,null,a,r.supbooks,r)}else e.l=n;return o}var N5=ks;function L5(e,t){var r=e.l+t,n=ks(e),a=am(e),i=jr(e),o=jr(e),l=jr(e);e.l=r;var u={rfx:n,relId:a,loc:i,display:l};return o&&(u.Tooltip=o),u}function P5(){}function F5(e,t,r){var n=e.l+t,a=K2(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var l=I6(e,n-e.l,r);o[1]=l}else e.l=n;return o}function O5(e,t,r){var n=e.l+t,a=ks(e),i=[a];if(r.cellFormula){var o=B6(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}var M5=["left","right","top","bottom","header","footer"];function R5(e){var t={};return M5.forEach(function(r){t[r]=Dr(e)}),t}function D5(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function I5(){}function j5(){}function B5(e,t,r,n,a,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,v,y,_,S,k,E,w,N,I,D=[];l.biff=12,l["!row"]=0;var P=0,V=!1,z=[],W={},B=l.supbooks||a.supbooks||[[]];if(B.sharedf=W,B.arrayf=z,B.SheetNames=a.SheetNames||a.Sheets.map(function(ae){return ae.name}),!l.supbooks&&(l.supbooks=B,a.Names))for(var G=0;G<a.Names.length;++G)B[0][G+1]=a.Names[G];var K=[],ve=[],xe=!1;Ef[16]={n:"BrtShortReal",f:Mw};var he;if(ei(e,function(Y,se,ye){if(!g)switch(ye){case 148:f=Y;break;case 0:v=Y,l.sheetRows&&l.sheetRows<=v.r&&(g=!0),N=br(S=v.r),l["!row"]=v.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=tc(Y.hpt)),ve[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Y[2]},Y[2]){case"n":y.v=Y[1];break;case"s":w=Al[Y[1]],y.v=w.t,y.r=w.r;break;case"b":y.v=!!Y[1];break;case"e":y.v=Y[1],l.cellText!==!1&&(y.w=Es[y.v]);break;case"str":y.t="s",y.v=Y[1];break;case"is":y.t="s",y.v=Y[1].t;break}if((_=o.CellXf[Y[0].iStyleRef])&&Fw(y,_.numFmtId,null,l,i,o),k=Y[0].c==-1?k+1:Y[0].c,l.dense?(u[S]||(u[S]=[]),u[S][k]=y):u[hr(k)+N]=y,l.cellFormula){for(V=!1,P=0;P<z.length;++P){var R=z[P];v.r>=R[0].s.r&&v.r<=R[0].e.r&&k>=R[0].s.c&&k<=R[0].e.c&&(y.F=_t(R[0]),V=!0)}!V&&Y.length>3&&(y.f=Y[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>k&&(d.s.c=k),d.e.r<v.r&&(d.e.r=v.r),d.e.c<k&&(d.e.c=k),l.cellDates&&_&&y.t=="n"&&Po(tt[_.numFmtId])){var J=Qi(y.v);J&&(y.t="d",y.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}he&&(he.type=="XLDAPR"&&(y.D=!0),he=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;y={t:"z",v:void 0},k=Y[0].c==-1?k+1:Y[0].c,l.dense?(u[S]||(u[S]=[]),u[S][k]=y):u[hr(k)+N]=y,d.s.r>v.r&&(d.s.r=v.r),d.s.c>k&&(d.s.c=k),d.e.r<v.r&&(d.e.r=v.r),d.e.c<k&&(d.e.c=k),he&&(he.type=="XLDAPR"&&(y.D=!0),he=void 0);break;case 176:D.push(Y);break;case 49:he=((l.xlmeta||{}).Cell||[])[Y-1];break;case 494:var q=n["!id"][Y.relId];for(q?(Y.Target=q.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=q):Y.relId==""&&(Y.Target="#"+Y.loc),S=Y.rfx.s.r;S<=Y.rfx.e.r;++S)for(k=Y.rfx.s.c;k<=Y.rfx.e.c;++k)l.dense?(u[S]||(u[S]=[]),u[S][k]||(u[S][k]={t:"z",v:void 0}),u[S][k].l=Y):(E=Je({c:k,r:S}),u[E]||(u[E]={t:"z",v:void 0}),u[E].l=Y);break;case 426:if(!l.cellFormula)break;z.push(Y),I=l.dense?u[S][k]:u[hr(k)+N],I.f=Or(Y[1],d,{r:v.r,c:k},B,l),I.F=_t(Y[0]);break;case 427:if(!l.cellFormula)break;W[Je(Y[0].s)]=Y[1],I=l.dense?u[S][k]:u[hr(k)+N],I.f=Or(Y[1],d,{r:v.r,c:k},B,l);break;case 60:if(!l.cellStyles)break;for(;Y.e>=Y.s;)K[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},xe||(xe=!0,cm(Y.w/256)),Eo(K[Y.e+1]);break;case 161:u["!autofilter"]={ref:_t(Y)};break;case 476:u["!margins"]=Y;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),Y.name&&(a.Sheets[r].CodeName=Y.name),(Y.above||Y.left)&&(u["!outline"]={above:Y.above,left:Y.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Y.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!se.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+ye.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=_t(f||d)),l.sheetRows&&u["!ref"]){var me=Jt(u["!ref"]);l.sheetRows<=+me.e.r&&(me.e.r=l.sheetRows-1,me.e.r>d.e.r&&(me.e.r=d.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>d.e.c&&(me.e.c=d.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),u["!fullref"]=u["!ref"],u["!ref"]=_t(me))}return D.length>0&&(u["!merges"]=D),K.length>0&&(u["!cols"]=K),ve.length>0&&(u["!rows"]=ve),u}function z5(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=kt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function U5(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=z5(m);d.s.r=d.s.c=0,d.e.c=l,f=hr(l),g[0].forEach(function(v,y){o[f+br(y)]={t:"n",v,z:g[1]},u=y}),d.e.r<u&&(d.e.r=u),++l}),l>0&&(o["!ref"]=_t(d)),o}function H5(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Ow);return l&&fm(l[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function V5(e,t){e.l+=10;var r=jr(e);return{name:r}}function W5(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ei(e,function(u,f,d){switch(d){case 550:i["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Rw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],G5=[],Z5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Dx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Bt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Ix(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Dw(e){Ix(e.WBProps,Rw),Ix(e.CalcPr,Z5),Dx(e.WBView,$5),Dx(e.Sheets,G5),uo.date1904=Bt(e.WBProps.date1904)}var X5="][*?/\\".split("");function q5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return X5.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Y5=/<\w+:workbook/;function K5(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(Ur,function(u,f){var d=Ge(u);switch(Ea(d[0])){case"<?xml":break;case"<workbook":u.match(Y5)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Rw.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Bt(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=Ot(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=kt(Ot(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ot(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),Bt(d.hidden||"0")&&(i.Hidden=!0),o=f+u.length;break;case"</definedName>":i.Ref=kt(Ot(e.slice(o,f))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),mA.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Dw(r),r}function J5(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Eh(e),r.name=jr(e),r}function Q5(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?jr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function e8(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function t8(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=OA(e),o=j6(e,0,r),l=am(e);e.l=n;var u={Name:i,Ptg:o};return a<268435455&&(u.Sheet=a),l&&(u.Comment=l),u}function r8(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Ef[16]={n:"BrtFRTArchID$",f:e8},ei(e,function(u,f,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Or(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),Dw(r),r.Names=i,r.supbooks=o,r}function n8(e,t,r){return t.slice(-4)===".bin"?r8(e,r):K5(e,r)}function a8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?B5(e,n,r,a,i,o,l):J6(e,n,r,a,i,o,l)}function i8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?W5(e,n,r,a,i):H5(e,n,r,a,i)}function s8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?pF():mF()}function o8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?dF():hF()}function l8(e,t,r,n){return t.slice(-4)===".bin"?NP(e,r,n):EP(e,r,n)}function c8(e,t,r){return kw(e,r)}function u8(e,t,r){return t.slice(-4)===".bin"?$L(e,r):VL(e,r)}function f8(e,t,r){return t.slice(-4)===".bin"?cF(e,r):aF(e,r)}function d8(e,t,r){return t.slice(-4)===".bin"?tF(e):QP(e)}function h8(e,t,r,n){return r.slice(-4)===".bin"?rF(e,t,r,n):void 0}function p8(e,t,r){return t.slice(-4)===".bin"?KP(e,t,r):JP(e,t,r)}var Iw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,jw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Iw),i,o,l,u;if(a)for(u=0;u!=a.length;++u)i=a[u].match(jw),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function m8(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Iw),a,i,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(jw),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Ll;function g8(e,t){var r=Ll[e]||kt(e);return r==="General"?hs(t):In(r,t)}function x8(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Bt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=yr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[kt(t)]=a}function v8(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=hs(e.v):e.w=g8(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Ll[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Po(n)){var a=Qi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function _8(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=xP[n.Pattern]||n.Pattern)}e[t.ID]=t}function y8(e,t,r,n,a,i,o,l,u,f){var d="General",m=n.StyleID,g={};f=f||{};var v=[],y=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(d=i[m].nf),i[m].Interior&&v.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Bt(e);break;case"String":n.t="s",n.r=ix(kt(e)),n.v=e.indexOf("<")>-1?kt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(yr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=kt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ew[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=ix(t||e));break}if(v8(n,d,f),f.cellFormula!==!1)if(n.Formula){var _=kt(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=co(_,a),delete n.Formula,n.ArrayRange=="RC"?n.F=co("RC:RC",a):n.ArrayRange&&(n.F=co(n.ArrayRange,a),u.push([Jt(n.F),n.F]))}else for(y=0;y<u.length;++y)a.r>=u[y][0].s.r&&a.r<=u[y][0].e.r&&a.c>=u[y][0].s.c&&a.c<=u[y][0].e.c&&(n.F=u[y][1]);f.cellStyles&&(v.forEach(function(S){!g.patternType&&S.patternType&&(g.patternType=S.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function w8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function hd(e,t){var r=t||{};C2();var n=ll(Qp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ot(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Cr(r);return o.type="string",Ql.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Et){a.indexOf("<"+Et)>=0&&(i=!0)}),i)return L8(n,r);Ll={"General Number":"General","General Date":tt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":tt[15],"Short Date":tt[14],"Long Time":tt[19],"Medium Time":tt[18],"Short Time":tt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:tt[2],Standard:tt[4],Percent:tt[10],Scientific:tt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],f,d={},m=[],g=r.dense?[]:{},v="",y={},_={},S=Vn('<Data ss:Type="String">'),k=0,E=0,w=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},D={},P="",V=0,z=[],W={},B={},G=0,K=[],ve=[],xe={},he=[],me,ae=!1,Y=[],se=[],ye={},R=0,J=0,q={Sheets:[],WBProps:{date1904:!1}},Z={};Jl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";l=Jl.exec(n);)switch(l[3]=(ne=l[3]).toLowerCase()){case"data":if(ne=="data"){if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?y8(n.slice(k,l.index),P,S,u[u.length-1][0]=="comment"?xe:y,{c:E,r:w},I,he[E],_,Y,r):(P="",S=Vn(l[0]),k=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(ve.length>0&&(y.c=ve),(!r.sheetRows||r.sheetRows>w)&&y.v!==void 0&&(r.dense?(g[w]||(g[w]=[]),g[w][E]=y):g[hr(E)+br(w)]=y),y.HRef&&(y.l={Target:kt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(R=E+(parseInt(y.MergeAcross,10)|0),J=w+(parseInt(y.MergeDown,10)|0),z.push({s:{c:E,r:w},e:{c:R,r:J}})),!r.sheetStubs)y.MergeAcross?E=R+1:++E;else if(y.MergeAcross||y.MergeDown){for(var we=E;we<=R;++we)for(var Le=w;Le<=J;++Le)(we>E||Le>w)&&(r.dense?(g[Le]||(g[Le]=[]),g[Le][we]={t:"z"}):g[hr(we)+br(Le)]={t:"z"});E=R+1}else++E;else y=m8(l[0]),y.Index&&(E=+y.Index-1),E<N.s.c&&(N.s.c=E),E>N.e.c&&(N.e.c=E),l[0].slice(-2)==="/>"&&++E,ve=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<N.s.r&&(N.s.r=w),w>N.e.r&&(N.e.r=w),l[0].slice(-2)==="/>"&&(_=Vn(l[0]),_.Index&&(w=+_.Index-1)),E=0,++w):(_=Vn(l[0]),_.Index&&(w=+_.Index-1),ye={},(_.AutoFitHeight=="0"||_.Height)&&(ye.hpx=parseInt(_.Height,10),ye.hpt=ww(ye.hpx),se[w]=ye),_.Hidden=="1"&&(ye.hidden=!0,se[w]=ye));break;case"worksheet":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));m.push(v),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(g["!ref"]=_t(N),r.sheetRows&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=_t(N))),z.length&&(g["!merges"]=z),he.length>0&&(g["!cols"]=he),se.length>0&&(g["!rows"]=se),d[v]=g}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=E=0,u.push([l[3],!1]),f=Vn(l[0]),v=kt(f.Name),g=r.dense?[]:{},z=[],Y=[],se=[],Z={name:v,Hidden:0},q.Sheets.push(Z);break;case"table":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),he=[],ae=!1}break;case"style":l[1]==="/"?_8(I,D,r):D=Vn(l[0]);break;case"numberformat":D.nf=kt(Vn(l[0]).Format||"General"),Ll[D.nf]&&(D.nf=Ll[D.nf]);for(var be=0;be!=392&&tt[be]!=D.nf;++be);if(be==392){for(be=57;be!=392;++be)if(tt[be]==null){as(D.nf,be);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(me=Vn(l[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!ae&&me.wpx>10){ae=!0,Gr=_w;for(var _e=0;_e<he.length;++_e)he[_e]&&Eo(he[_e])}ae&&Eo(me),he[me.Index-1||he.length]=me;for(var Be=0;Be<+me.Span;++Be)he[he.length]=Cr(me);break;case"namedrange":if(l[1]==="/")break;q.Names||(q.Names=[]);var H=Ge(l[0]),Ye={Name:H.Name,Ref:co(H.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(Ye.Sheet=q.Sheets.length-1),q.Names.push(Ye);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?P+=n.slice(V,l.index):V=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Vn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?aN(W,ne,n.slice(G,l.index)):G=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));w8(xe),ve.push(xe)}else u.push([l[3],!1]),f=Vn(l[0]),xe={a:f.Author};break;case"autofilter":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var nt=Vn(l[0]);g["!autofilter"]={ref:co(nt.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return Vx(n,r);var it=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:it=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:it=!1}break;case"excelworkbook":switch(l[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:it=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:it=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(G,l.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else G=l.index+l[0].length;break;case"header":g["!margins"]||Nl(g["!margins"]={},"xlml"),isNaN(+Ge(l[0]).Margin)||(g["!margins"].header=+Ge(l[0]).Margin);break;case"footer":g["!margins"]||Nl(g["!margins"]={},"xlml"),isNaN(+Ge(l[0]).Margin)||(g["!margins"].footer=+Ge(l[0]).Margin);break;case"pagemargins":var Ze=Ge(l[0]);g["!margins"]||Nl(g["!margins"]={},"xlml"),isNaN(+Ze.Top)||(g["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(g["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(g["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(g["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:it=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:it=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:it=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:it=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:it=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:it=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:it=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:it=!1}break;case"smarttags":break;default:it=!1;break}if(it||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?x8(B,ne,K,n.slice(G,l.index)):(K=l,G=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=d),Ae.SheetNames=m,Ae.Workbook=q,Ae.SSF=Cr(tt),Ae.Props=W,Ae.Custprops=B,Ae}function bh(e,t){switch(pm(t=t||{}),t.type||"base64"){case"base64":return hd(xn(e),t);case"binary":case"buffer":case"file":return hd(e,t);case"array":return hd(ys(e),t)}}function k8(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=DA(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=IA(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var E8=[60,1084,2066,2165,2175];function S8(e,t,r,n,a){var i=n,o=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=i;for(var u=za(r,r.l),f=Ah[u],d=0;f!=null&&E8.indexOf(u)>-1;)i=za(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),l=r.slice(d,r.l+4+i),o.push(l),r.l+=4+i,f=Ah[u=za(r,r.l)];var m=di(o);Er(m,0);var g=0;m.lens=[];for(var v=0;v<o.length;++v)m.lens.push(g),g+=o[v].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function da(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=tt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=hs(e.v):e.w=In(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Po(tt[n]||String(n))){var a=Qi(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function pu(e,t,r){return{v:e,ixfe:t,t:r}}function T8(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},l=null,u=[],f="",d={},m,g="",v,y,_,S,k={},E=[],w,N,I=[],D=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},z=function(He){return He<8?is[He]:He<64&&D[He-8]||is[He]},W=function(He,ce,de){var Se=ce.XF.data;if(!(!Se||!Se.patternType||!de||!de.cellStyles)){ce.s={},ce.s.patternType=Se.patternType;var Oe;(Oe=ec(z(Se.icvFore)))&&(ce.s.fgColor={rgb:Oe}),(Oe=ec(z(Se.icvBack)))&&(ce.s.bgColor={rgb:Oe})}},B=function(He,ce,de){if(!(ye>1)&&!(de.sheetRows&&He.r>=de.sheetRows)){if(de.cellStyles&&ce.XF&&ce.XF.data&&W(He,ce,de),delete ce.ixfe,delete ce.XF,m=He,g=Je(He),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),He.r<o.s.r&&(o.s.r=He.r),He.c<o.s.c&&(o.s.c=He.c),He.r+1>o.e.r&&(o.e.r=He.r+1),He.c+1>o.e.c&&(o.e.c=He.c+1),de.cellFormula&&ce.f){for(var Se=0;Se<E.length;++Se)if(!(E[Se][0].s.c>He.c||E[Se][0].s.r>He.r)&&!(E[Se][0].e.c<He.c||E[Se][0].e.r<He.r)){ce.F=_t(E[Se][0]),(E[Se][0].s.c!=He.c||E[Se][0].s.r!=He.r)&&delete ce.f,ce.f&&(ce.f=""+Or(E[Se][1],o,He,Y,G));break}}de.dense?(a[He.r]||(a[He.r]=[]),a[He.r][He.c]=ce):a[g]=ce}},G={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(G.password=t.password);var K,ve=[],xe=[],he=[],me=[],ae=!1,Y=[];Y.SheetNames=G.snames,Y.sharedf=G.sharedf,Y.arrayf=G.arrayf,Y.names=[],Y.XTI=[];var se=0,ye=0,R=0,J=[],q=[],Z;G.codepage=1200,qn(1200);for(var ne=!1;e.l<e.length-1;){var we=e.l,Le=e.read_shift(2);if(Le===0&&se===10)break;var be=e.l===e.length?0:e.read_shift(2),_e=Ah[Le];if(_e&&_e.f){if(t.bookSheets&&se===133&&Le!==133)break;if(se=Le,_e.r===2||_e.r==12){var Be=e.read_shift(2);if(be-=2,!G.enc&&Be!==Le&&((Be&255)<<8|Be>>8)!==Le)throw new Error("rt mismatch: "+Be+"!="+Le);_e.r==12&&(e.l+=10,be-=10)}var H={};if(Le===10?H=_e.f(e,be,G):H=S8(Le,_e,e,be,G),ye==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(Le){case 34:r.opts.Date1904=P.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(G.enc||(e.l=0),G.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:G.lastuser=H;break;case 66:var Ye=Number(H);switch(Ye){case 21010:Ye=1200;break;case 32768:Ye=1e4;break;case 32769:Ye=1252;break}qn(G.codepage=Ye),ne=!0;break;case 317:G.rrtabid=H;break;case 25:G.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:G.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(a["!type"]="dialog"),H.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),H.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(H);break;case 430:Y.push([H]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(H);break;case 24:case 536:Z={Name:H.Name,Ref:Or(H.rgce,o,null,Y,G)},H.itab>0&&(Z.Sheet=H.itab-1),Y.names.push(Z),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(q[H.itab-1]={ref:_t(H.rgce[0][0][1][2])});break;case 22:G.ExternCount=H;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(H),Y.XTI=Y.XTI.concat(H);break;case 2196:if(G.biff<8)break;Z!=null&&(Z.Comment=H[1]);break;case 18:a["!protect"]=H;break;case 19:H!==0&&G.WTF&&console.error("Password verifier: "+H);break;case 133:i[H.pos]=H,G.snames.push(H.name);break;case 10:{if(--ye)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=_t(o),t.sheetRows&&t.sheetRows<=o.e.r){var nt=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=_t(o),o.e.r=nt}o.e.r++,o.e.c++}ve.length>0&&(a["!merges"]=ve),xe.length>0&&(a["!objects"]=xe),he.length>0&&(a["!cols"]=he),me.length>0&&(a["!rows"]=me),P.Sheets.push(V)}f===""?d=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(G.biff===8&&(G.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),G.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(G.biff=5,ne=!0,qn(G.codepage=28591)),G.biff==8&&H.BIFFVer==0&&H.dt==16&&(G.biff=2),ye++)break;if(a=t.dense?[]:{},G.biff<8&&!ne&&(ne=!0,qn(G.codepage=t.codepage||1252)),G.biff<5||H.BIFFVer==0&&H.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var it={pos:e.l-be,name:f};i[it.pos]=it,G.snames.push(f)}else f=(i[we]||{name:""}).name;H.dt==32&&(a["!type"]="chart"),H.dt==64&&(a["!type"]="macro"),ve=[],xe=[],G.arrayf=E=[],he=[],me=[],ae=!1,V={Hidden:(i[we]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[H.r]||[])[H.c]:a[Je({c:H.c,r:H.r})])&&++H.c,w={ixfe:H.ixfe,XF:I[H.ixfe]||{},v:H.val,t:"n"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:H.c,r:H.r},w,t);break;case 5:case 517:w={ixfe:H.ixfe,XF:I[H.ixfe],v:H.val,t:H.t},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:H.c,r:H.r},w,t);break;case 638:w={ixfe:H.ixfe,XF:I[H.ixfe],v:H.rknum,t:"n"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:H.c,r:H.r},w,t);break;case 189:for(var Ze=H.c;Ze<=H.C;++Ze){var Ae=H.rkrec[Ze-H.c][0];w={ixfe:Ae,XF:I[Ae],v:H.rkrec[Ze-H.c][1],t:"n"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:Ze,r:H.r},w,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){l=H;break}if(w=pu(H.val,H.cell.ixfe,H.tt),w.XF=I[w.ixfe],t.cellFormula){var Et=H.formula;if(Et&&Et[0]&&Et[0][0]&&Et[0][0][0]=="PtgExp"){var pe=Et[0][0][1][0],Pe=Et[0][0][1][1],Fe=Je({r:pe,c:Pe});k[Fe]?w.f=""+Or(H.formula,o,H.cell,Y,G):w.F=((t.dense?(a[pe]||[])[Pe]:a[Fe])||{}).F}else w.f=""+Or(H.formula,o,H.cell,Y,G)}R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B(H.cell,w,t),l=H}break;case 7:case 519:if(l)l.val=H,w=pu(H,l.cell.ixfe,"s"),w.XF=I[w.ixfe],t.cellFormula&&(w.f=""+Or(l.formula,o,l.cell,Y,G)),R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(H);var Ve=Je(H[0].s);if(v=t.dense?(a[H[0].s.r]||[])[H[0].s.c]:a[Ve],t.cellFormula&&v){if(!l||!Ve||!v)break;v.f=""+Or(H[1],o,H[0],Y,G),v.F=_t(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!l)break;k[Je(l.cell)]=H[0],v=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Je(l.cell)],(v||{}).f=""+Or(H[0],o,m,Y,G)}}break;case 253:w=pu(u[H.isst].t,H.ixfe,"s"),u[H.isst].h&&(w.h=u[H.isst].h),w.XF=I[w.ixfe],R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:H.c,r:H.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:H.ixfe,XF:I[H.ixfe],t:"z"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:H.c,r:H.r},w,t));break;case 190:if(t.sheetStubs)for(var pt=H.c;pt<=H.C;++pt){var ut=H.ixfe[pt-H.c];w={ixfe:ut,XF:I[ut],t:"z"},R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:pt,r:H.r},w,t)}break;case 214:case 516:case 4:w=pu(H.val,H.ixfe,"s"),w.XF=I[w.ixfe],R>0&&(w.z=J[w.ixfe>>8&63]),da(w,t,r.opts.Date1904),B({c:H.c,r:H.r},w,t);break;case 0:case 512:ye===1&&(o=H);break;case 252:u=H;break;case 1054:if(G.biff==4){J[R++]=H[1];for(var St=0;St<R+163&&tt[St]!=H[1];++St);St>=163&&as(H[1],R+163)}else as(H[1],H[0]);break;case 30:{J[R++]=H;for(var jt=0;jt<R+163&&tt[jt]!=H;++jt);jt>=163&&as(H,R+163)}break;case 229:ve=ve.concat(H);break;case 93:xe[H.cmo[0]]=G.lastobj=H;break;case 438:G.lastobj.TxO=H;break;case 127:G.lastobj.ImData=H;break;case 440:for(S=H[0].s.r;S<=H[0].e.r;++S)for(_=H[0].s.c;_<=H[0].e.c;++_)v=t.dense?(a[S]||[])[_]:a[Je({c:_,r:S})],v&&(v.l=H[1]);break;case 2048:for(S=H[0].s.r;S<=H[0].e.r;++S)for(_=H[0].s.c;_<=H[0].e.c;++_)v=t.dense?(a[S]||[])[_]:a[Je({c:_,r:S})],v&&v.l&&(v.l.Tooltip=H[1]);break;case 28:{if(G.biff<=5&&G.biff>=2)break;v=t.dense?(a[H[0].r]||[])[H[0].c]:a[Je(H[0])];var Xt=xe[H[2]];v||(t.dense?(a[H[0].r]||(a[H[0].r]=[]),v=a[H[0].r][H[0].c]={t:"z"}):v=a[Je(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),v.c||(v.c=[]),y={a:H[1],t:Xt.TxO.t},v.c.push(y)}break;case 2173:ZP(I[H.ixfe],H.ext);break;case 125:{if(!G.cellStyles)break;for(;H.e>=H.s;)he[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},ae||(ae=!0,cm(H.w/256)),Eo(he[H.e+1])}break;case 520:{var bt={};H.level!=null&&(me[H.r]=bt,bt.level=H.level),H.hidden&&(me[H.r]=bt,bt.hidden=!0),H.hpt&&(me[H.r]=bt,bt.hpt=H.hpt,bt.hpx=tc(H.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Nl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=H;break;case 161:a["!margins"]||Nl(a["!margins"]={}),a["!margins"].header=H.header,a["!margins"].footer=H.footer;break;case 574:H.RTL&&(P.Views[0].RTL=!0);break;case 146:D=H;break;case 2198:K=H;break;case 140:N=H;break;case 442:f?V.CodeName=H||V.name:P.WBProps.CodeName=H||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),e.l+=be}return r.SheetNames=wa(i).sort(function(Ut,He){return Number(Ut)-Number(He)}).map(function(Ut){return i[Ut].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(Ut,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=Ut}),r.Strings=u,r.SSF=Cr(tt),G.enc&&(r.Encryption=G.enc),K&&(r.Themes=K),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),Y.names.length>0&&(P.Names=Y.names),r.Workbook=P,r}var jx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function C8(e,t,r){var n=vt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=wx(n,VA,jx.DSI);for(var i in a)t[i]=a[i]}catch(f){if(r.WTF)throw f}var o=vt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=wx(o,WA,jx.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(rw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Bw(e,t){t||(t={}),pm(t),p2(),t.codepage&&Gp(t.codepage);var r,n;if(e.FullPaths){if(vt.find(e,"/encryption"))throw new Error("File is password-protected");r=vt.find(e,"!CompObj"),n=vt.find(e,"/Workbook")||vt.find(e,"/Book")}else{switch(t.type){case"base64":e=Xn(xn(e));break;case"binary":e=Xn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Er(e,0),n={content:e}}var a,i;if(r&&k8(r),t.bookProps&&!t.bookSheets)a={};else{var o=gt?"buffer":"array";if(n&&n.content)a=T8(n.content,t);else if((i=vt.find(e,"PerfectOffice_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=o,t));else if((i=vt.find(e,"NativeContent_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=o,t));else throw(i=vt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&vt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=fF(e))}var l={};return e.FullPaths&&C8(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}var Ef={0:{f:o5},1:{f:f5},2:{f:y5},3:{f:m5},4:{f:h5},5:{f:_5},6:{f:E5},7:{f:x5},8:{f:A5},9:{f:b5},10:{f:T5},11:{f:C5},12:{f:d5},13:{f:w5},14:{f:g5},15:{f:p5},16:{f:Mw},17:{f:S5},18:{f:v5},19:{f:nm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:t8},40:{},42:{},43:{f:TP},44:{f:SP},45:{f:CP},46:{f:AP},47:{f:bP},48:{},49:{f:NA},50:{},51:{f:qP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:pw},62:{f:k5},63:{f:eF},64:{f:I5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:D5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:u5},148:{f:l5,p:16},151:{f:P5},152:{},153:{f:Q5},154:{},155:{},156:{f:J5},157:{},158:{},159:{T:1,f:WL},160:{T:-1},161:{T:1,f:ks},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:N5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:XP},336:{T:-1},337:{f:YP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Eh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:F5},427:{f:O5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:R5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:c5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:L5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Eh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lF},633:{T:1},634:{T:-1},635:{T:1,f:oF},636:{T:-1},637:{f:PA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:V5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:j5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ah={6:{f:fd},10:{f:ii},12:{f:or},13:{f:or},14:{f:er},15:{f:er},16:{f:Dr},17:{f:er},18:{f:er},19:{f:or},20:{f:Tx},21:{f:Tx},23:{f:hw},24:{f:bx},25:{f:er},26:{},27:{},28:{f:iL},29:{},34:{f:er},35:{f:Cx},38:{f:Dr},39:{f:Dr},40:{f:Dr},41:{f:Dr},42:{f:er},43:{f:er},47:{f:cP},49:{f:zN},51:{f:or},60:{},61:{f:IN},64:{f:er},65:{f:BN},66:{f:or},77:{},80:{},81:{},82:{},85:{f:or},89:{},90:{},91:{},92:{f:NN},93:{f:oL},94:{},95:{f:er},96:{},97:{},99:{f:er},125:{f:pw},128:{f:YN},129:{f:LN},130:{f:or},131:{f:er},132:{f:er},133:{f:PN},134:{},140:{f:hL},141:{f:or},144:{},146:{f:mL},151:{},152:{},153:{},154:{},155:{},156:{f:or},157:{},158:{},160:{f:yL},161:{f:xL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:GN},190:{f:ZN},193:{f:ii},197:{},198:{},199:{},200:{},201:{},202:{f:er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:or},220:{},221:{f:er},222:{},224:{f:qN},225:{f:AN},226:{f:ii},227:{},229:{f:sL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:FN},253:{f:UN},255:{f:ON},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ow},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:er},353:{f:ii},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:JN},431:{f:er},432:{},433:{},434:{},437:{},438:{f:uL},439:{f:er},440:{f:fL},441:{},442:{f:_c},443:{},444:{f:or},445:{},446:{},448:{f:ii},449:{f:DN,r:2},450:{f:ii},512:{f:Ex},513:{f:_L},515:{f:KN},516:{f:HN},517:{f:Sx},519:{f:wL},520:{f:MN},523:{},545:{f:Ax},549:{f:kx},566:{},574:{f:jN},638:{f:$N},659:{},1048:{},1054:{f:VN},1084:{},1212:{f:rL},2048:{f:dL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ii},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:gL,r:12},2173:{f:GP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:tL,r:12},2197:{},2198:{f:zP,r:12},2199:{},2200:{},2201:{},2202:{f:nL,r:12},2203:{f:ii},2204:{},2205:{},2206:{},2207:{},2211:{f:RN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:pL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ex},1:{},2:{f:TL},3:{f:SL},4:{f:EL},5:{f:Sx},7:{f:CL},8:{},9:{f:fu},11:{},22:{f:or},30:{f:WN},31:{},32:{},33:{f:Ax},36:{},37:{f:kx},50:{f:bL},62:{},52:{},67:{},68:{f:or},69:{},86:{},126:{},127:{f:kL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:AL},223:{},234:{},354:{},421:{},518:{f:fd},521:{f:fu},536:{f:bx},547:{f:Cx},561:{},579:{},1030:{f:fd},1033:{f:fu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wn(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&X2(r)&&e.push(r)}}function Bx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,l=i&&i.index||e.length,u=Kb(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,m=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<u.length;++o){var _=u[o].trim(),S=_.slice(0,3).toLowerCase();if(S=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(S!="<td"&&S!="<th")){var k=_.split(/<\/t[dh]>/i);for(l=0;l<k.length;++l){var E=k[l].trim();if(E.match(/<t[dh]/i)){for(var w=E,N=0;w.charAt(0)=="<"&&(N=w.indexOf(">"))>-1;)w=w.slice(N+1);for(var I=0;I<y.length;++I){var D=y[I];D.s.c==d&&D.s.r<f&&f<=D.e.r&&(d=D.e.c+1,I=-1)}var P=Ge(E.slice(0,E.indexOf(">")));g=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||g>1)&&y.push({s:{r:f,c:d},e:{r:f+(m||1)-1,c:d+g-1}});var V=P.t||P["data-t"]||"";if(!w.length){d+=g;continue}if(w=R2(w),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!w.length){d+=g;continue}var z={t:"s",v:w};r.raw||!w.trim().length||V=="s"||(w==="TRUE"?z={t:"b",v:!0}:w==="FALSE"?z={t:"b",v:!1}:isNaN(Qn(w))?isNaN(ko(w).getDate())||(z={t:"d",v:yr(w)},r.cellDates||(z={t:"n",v:Kr(z.v)}),z.z=r.dateNF||tt[14]):z={t:"n",v:Qn(w)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=z):n[Je({r:f,c:d})]=z,d+=g}}}}return n["!ref"]=_t(v),y.length&&(n["!merges"]=y),n}function b8(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>o)&&!(a[f].e.r<r||a[f].e.c<o)){if(a[f].s.r<r||a[f].s.c<o){l=-1;break}l=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(l<0)){var d=Je({r,c:o}),m=n.dense?(e[r]||[])[o]:e[d],g=m&&m.v!=null&&(m.h||Jp(m.w||(Ya(m),m.w)||""))||"",v={};l>1&&(v.rowspan=l),u>1&&(v.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),v.id=(n.id||"sjs")+"-"+d,i.push(hA("td",g,v))}}var y="<tr>";return y+i.join("")+"</tr>"}var A8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',N8="</body></html>";function L8(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Di(Bx(r[0],t),t);var n=gm();return r.forEach(function(a,i){xm(n,Bx(a,t),"Sheet"+(i+1))}),n}function P8(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function F8(e,t){var r=t||{},n=r.header!=null?r.header:A8,a=r.footer!=null?r.footer:N8,i=[n],o=Fo(e["!ref"]);r.dense=Array.isArray(e),i.push(P8(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(b8(e,o,l,r));return i.push("</table>"+a),i.join("")}function zw(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Xr(n.origin):n.origin;a=o.r,i=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var d=Fo(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),a==-1&&(f.e.r=a=d.e.r+1)}var m=[],g=0,v=e["!rows"]||(e["!rows"]=[]),y=0,_=0,S=0,k=0,E=0,w=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&_<u;++y){var N=l[y];if(zx(N)){if(n.display)continue;v[_]={hidden:!0}}var I=N.children;for(S=k=0;S<I.length;++S){var D=I[S];if(!(n.display&&zx(D))){var P=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):R2(D.innerHTML),V=D.getAttribute("data-z")||D.getAttribute("z");for(g=0;g<m.length;++g){var z=m[g];z.s.c==k+i&&z.s.r<_+a&&_+a<=z.e.r&&(k=z.e.c+1-i,g=-1)}w=+D.getAttribute("colspan")||1,((E=+D.getAttribute("rowspan")||1)>1||w>1)&&m.push({s:{r:_+a,c:k+i},e:{r:_+a+(E||1)-1,c:k+i+(w||1)-1}});var W={t:"s",v:P},B=D.getAttribute("data-t")||D.getAttribute("t")||"";P!=null&&(P.length==0?W.t=B||"z":n.raw||P.trim().length==0||B=="s"||(P==="TRUE"?W={t:"b",v:!0}:P==="FALSE"?W={t:"b",v:!1}:isNaN(Qn(P))?isNaN(ko(P).getDate())||(W={t:"d",v:yr(P)},n.cellDates||(W={t:"n",v:Kr(W.v)}),W.z=n.dateNF||tt[14]):W={t:"n",v:Qn(P)})),W.z===void 0&&V!=null&&(W.z=V);var G="",K=D.getElementsByTagName("A");if(K&&K.length)for(var ve=0;ve<K.length&&!(K[ve].hasAttribute("href")&&(G=K[ve].getAttribute("href"),G.charAt(0)!="#"));++ve);G&&G.charAt(0)!="#"&&(W.l={Target:G}),n.dense?(e[_+a]||(e[_+a]=[]),e[_+a][k+i]=W):e[Je({c:k+i,r:_+a})]=W,f.e.c<k+i&&(f.e.c=k+i),k+=w}}++_}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,_-1+a),e["!ref"]=_t(f),_>=u&&(e["!fullref"]=_t((f.e.r=l.length-y+_-1+a,f))),e}function Uw(e,t){var r=t||{},n=r.dense?[]:{};return zw(n,e,t)}function O8(e,t){return Di(Uw(e,t),t)}function zx(e){var t="",r=M8(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function M8(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function R8(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=kt(t.replace(/<[^>]*>/g,""));return[r]}var Ux={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Hw(e,t){var r=t||{},n=Qp(e),a=[],i,o,l={name:""},u="",f=0,d,m,g={},v=[],y=r.dense?[]:{},_,S,k={value:""},E="",w=0,N=[],I=-1,D=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,z={},W=[],B={},G=0,K=0,ve=[],xe=1,he=1,me=[],ae={Names:[]},Y={},se=["",""],ye=[],R={},J="",q=0,Z=!1,ne=!1,we=0;for(Jl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=Jl.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?y["!ref"]=_t(P):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(y["!fullref"]=y["!ref"],P.e.r=r.sheetRows-1,y["!ref"]=_t(P)),W.length&&(y["!merges"]=W),ve.length&&(y["!rows"]=ve),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),g[d.name]=y,ne=!1):_[0].charAt(_[0].length-2)!=="/"&&(d=Ge(_[0],!1),I=D=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,y=r.dense?[]:{},W=[],ve=[],ne=!0);break;case"table-row-group":_[1]==="/"?--V:++V;break;case"table-row":case"":if(_[1]==="/"){I+=xe,xe=1;break}if(m=Ge(_[0],!1),m.?I=m.-1:I==-1&&(I=0),xe=+m["number-rows-repeated"]||1,xe<10)for(we=0;we<xe;++we)V>0&&(ve[I+we]={level:V});D=-1;break;case"covered-table-cell":_[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(y[I]||(y[I]=[]),y[I][D]={t:"z"}):y[Je({r:I,c:D})]={t:"z"}),E="",N=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++D,k=Ge(_[0],!1),he=parseInt(k["number-columns-repeated"]||"1",10),S={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(S.f=Rx(kt(k.formula))),(k.||k["value-type"])=="string"&&(S.t="s",S.v=kt(k["string-value"]||""),r.dense?(y[I]||(y[I]=[]),y[I][D]=S):y[Je({r:I,c:D})]=S),D+=he-1;else if(_[1]!=="/"){++D,E="",w=0,N=[],he=1;var Le=xe?I+xe-1:I;if(D>P.e.c&&(P.e.c=D),D<P.s.c&&(P.s.c=D),I<P.s.r&&(P.s.r=I),Le>P.e.r&&(P.e.r=Le),k=Ge(_[0],!1),ye=[],R={},S={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=kt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(G=parseInt(k["number-matrix-rows-spanned"],10)||0,K=parseInt(k["number-matrix-columns-spanned"],10)||0,B={s:{r:I,c:D},e:{r:I+G-1,c:D+K-1}},S.F=_t(B),me.push([B,S.F])),k.formula)S.f=Rx(k.formula);else for(we=0;we<me.length;++we)I>=me[we][0].s.r&&I<=me[we][0].e.r&&D>=me[we][0].s.c&&D<=me[we][0].e.c&&(S.F=me[we][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(G=parseInt(k["number-rows-spanned"],10)||0,K=parseInt(k["number-columns-spanned"],10)||0,B={s:{r:I,c:D},e:{r:I+G-1,c:D+K-1}},W.push(B)),k["number-columns-repeated"]&&(he=parseInt(k["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Bt(k["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(k.value);break;case"percentage":S.t="n",S.v=parseFloat(k.value);break;case"currency":S.t="n",S.v=parseFloat(k.value);break;case"date":S.t="d",S.v=yr(k["date-value"]),r.cellDates||(S.t="n",S.v=Kr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=Xb(k["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Kf(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(k.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",k["string-value"]!=null&&(E=kt(k["string-value"]),N=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Z=!1,S.t==="s"&&(S.v=E||"",N.length&&(S.R=N),Z=w==0),Y.Target&&(S.l=Y),ye.length>0&&(S.c=ye,ye=[]),E&&r.cellText!==!1&&(S.w=E),Z&&(S.t="z",delete S.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var be=0;be<xe;++be){if(he=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(y[I+be]||(y[I+be]=[]),y[I+be][D]=be==0?S:Cr(S);--he>0;)y[I+be][D+he]=Cr(S);else for(y[Je({r:I+be,c:D})]=S;--he>0;)y[Je({r:I+be,c:D+he})]=Cr(S);P.e.c<=D&&(P.e.c=D)}he=parseInt(k["number-columns-repeated"]||"1",10),D+=he-1,he=0,S={},E="",N=[]}Y={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((i=a.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((i=a.pop())[0]!==_[3])throw"Bad state: "+i;R.t=E,N.length&&(R.R=N),R.a=J,ye.push(R)}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!1]);J="",q=0,E="",w=0,N=[];break;case"creator":_[1]==="/"?J=n.slice(q,_.index):q=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((i=a.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!1]);E="",w=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(z[l.name]=u,(i=a.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&(u="",l=Ge(_[0],!1),a.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Ge(_[0],!1),u+=Ux[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Ge(_[0],!1),u+=Ux[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,_.index);break}else f=_.index+_[0].length;break;case"named-range":o=Ge(_[0],!1),se=dd(o["cell-range-address"]);var _e={Name:o.name,Ref:se[0]+"!"+se[1]};ne&&(_e.Sheet=v.length),ae.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(_[1]==="/"&&(!k||!k["string-value"])){var Be=R8(n.slice(w,_.index));E=(E.length>0?E+`
`:"")+Be[0]}else Ge(_[0],!1),w=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{se=dd(Ge(_[0])["target-range-address"]),g[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(Y=Ge(_[0],!1),!Y.href)break;Y.Target=kt(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(se=dd(Y.Target.slice(1)),Y.Target="#"+se[0]+"!"+se[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var H={Sheets:g,SheetNames:v,Workbook:ae};return r.bookSheets&&delete H.Sheets,H}function Hx(e,t){t=t||{},bn(e,"META-INF/manifest.xml")&&KA(sr(e,"META-INF/manifest.xml"),t);var r=dn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Hw(Ot(r),t);return bn(e,"meta.xml")&&(n.Props=tw(sr(e,"meta.xml"))),n}function Vx(e,t){return Hw(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Nh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ot(ys(e))}function Lh(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Wx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function D8(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function rc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function pr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ir(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=rc(e,r),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=rc(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:l,type:i};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function hm(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function I8(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=rc(e,n),i=Ir(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:pr(i[1][0].data),messages:[]};i[2].forEach(function(l){var u=Ir(l.data),f=pr(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=i[3])!=null&&t[0]&&(o.merge=pr(i[3][0].data)>>>0>0),r.push(o)}return r}function j8(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=rc(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,f=0;if(i==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,i==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Lh(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(a.push(a[0].slice(-u)),f-=u;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-u,-u+f))}}var d=Lh(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function B8(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(j8(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Lh(t)}function z8(e,t,r,n){var a=dm(e),i=a.getUint32(4,!0),o=(n>1?12:8)+Wx(i&(n>1?3470:398))*4,l=-1,u=-1,f=NaN,d=new Date(2001,0,1);i&512&&(l=a.getUint32(o,!0),o+=4),o+=Wx(i&(n>1?12288:4096))*4,i&16&&(u=a.getUint32(o,!0),o+=4),i&32&&(f=a.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function U8(e,t,r){var n=dm(e),a=n.getUint32(8,!0),i=12,o=-1,l=-1,u=NaN,f=NaN,d=new Date(2001,0,1);a&1&&(u=D8(e,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function H8(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return z8(e,t,r,e[0]);case 5:return U8(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ci(e){var t=Ir(e);return rc(t[1][0].data)}function $x(e,t){var r=Ir(t.data),n=pr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var l=Ir(o.data),u=pr(l[1][0].data)>>>0;switch(n){case 1:i[u]=Nh(l[3][0].data);break;case 8:{var f=e[Ci(l[9][0].data)][0],d=Ir(f.data),m=e[Ci(d[1][0].data)][0],g=pr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=Ir(m.data);i[u]=v[3].map(function(y){return Nh(y.data)}).join("")}break}}),i}function V8(e,t){var r,n,a,i,o,l,u,f,d,m,g,v,y,_,S=Ir(e),k=pr(S[1][0].data)>>>0,E=pr(S[2][0].data)>>>0,w=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&pr(S[8][0].data)>0||!1,N,I;if((i=(a=S[7])==null?void 0:a[0])!=null&&i.data&&t!=0)N=(l=(o=S[7])==null?void 0:o[0])==null?void 0:l.data,I=(f=(u=S[6])==null?void 0:u[0])==null?void 0:f.data;else if((m=(d=S[4])==null?void 0:d[0])!=null&&m.data&&t!=1)N=(v=(g=S[4])==null?void 0:g[0])==null?void 0:v.data,I=(_=(y=S[3])==null?void 0:y[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=w?4:1,P=dm(N),V=[],z=0;z<N.length/2;++z){var W=P.getUint16(z*2,!0);W<65535&&V.push([z,W])}if(V.length!=E)throw"Expected ".concat(E," cells, found ").concat(V.length);var B=[];for(z=0;z<V.length-1;++z)B[V[z][0]]=I.subarray(V[z][1]*D,V[z+1][1]*D);return V.length>=1&&(B[V[V.length-1][0]]=I.subarray(V[V.length-1][1]*D)),{R:k,cells:B}}function W8(e,t){var r,n=Ir(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?pr(n[7][0].data)>>>0>0?1:0:-1,i=hm(n[5],function(o){return V8(o,a)});return{nrows:pr(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,f){if(o[l.R][f])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(f));o[l.R][f]=u}),o},[])}}function $8(e,t,r){var n,a=Ir(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(pr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(pr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=_t(i);var o=Ir(a[4][0].data),l=$x(e,e[Ci(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?$x(e,e[Ci(o[17][0].data)][0]):[],f=Ir(o[3][0].data),d=0;f[1].forEach(function(m){var g=Ir(m.data),v=e[Ci(g[2][0].data)][0],y=pr(v.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var _=W8(e,v);_.data.forEach(function(S,k){S.forEach(function(E,w){var N=Je({r:d+k,c:w}),I=H8(E,l,u);I&&(r[N]=I)})}),d+=_.nrows})}function G8(e,t){var r=Ir(t.data),n={"!ref":"A1"},a=e[Ci(r[2][0].data)],i=pr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return $8(e,a[0],n),n}function Z8(e,t){var r,n=Ir(t.data),a={name:(r=n[1])!=null&&r[0]?Nh(n[1][0].data):"",sheets:[]},i=hm(n[2],Ci);return i.forEach(function(o){e[o].forEach(function(l){var u=pr(l.meta[1][0].data);u==6e3&&a.sheets.push(G8(e,l))})}),a}function X8(e,t){var r=gm(),n=Ir(t.data),a=hm(n[1],Ci);if(a.forEach(function(i){e[i].forEach(function(o){var l=pr(o.meta[1][0].data);if(l==2){var u=Z8(e,o);u.sheets.forEach(function(f,d){xm(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function pd(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=B8(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var d;try{d=I8(f)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&pr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(u){i[u].forEach(function(f){var d=pr(f.meta[1][0].data)>>>0;if(d==1)if(!l)l=f;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return X8(i,l)}function q8(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function pm(e){q8([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Y8(e){return Qs.WS.indexOf(e)>-1?"sheet":e==Qs.CS?"chart":e==Qs.DS?"dialog":e==Qs.MS?"macro":e&&e.length?e:"sheet"}function K8(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Y8(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function J8(e,t,r,n,a,i,o,l,u,f,d,m){try{i[n]=Tl(dn(e,r,!0),t);var g=sr(e,t),v;switch(l){case"sheet":v=a8(g,t,a,u,i[n],f,d,m);break;case"chart":if(v=i8(g,t,a,u,i[n],f,d,m),!v||!v["!drawel"])break;var y=ul(v["!drawel"].Target,t),_=Sh(y),S=nF(dn(e,y,!0),Tl(dn(e,_,!0),y)),k=ul(S,y),E=Sh(k);v=U5(dn(e,k,!0),k,u,Tl(dn(e,E,!0),k),f,v);break;case"macro":v=s8(g,t,a,u,i[n],f,d,m);break;case"dialog":v=o8(g,t,a,u,i[n],f,d,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=v;var w=[];i&&i[n]&&wa(i[n]).forEach(function(N){var I="";if(i[n][N].Type==Qs.CMNT){I=ul(i[n][N].Target,t);var D=f8(sr(e,I,!0),I,u);if(!D||!D.length)return;Lx(v,D,!1)}i[n][N].Type==Qs.TCMNT&&(I=ul(i[n][N].Target,t),w=w.concat(iF(sr(e,I,!0),u)))}),w&&w.length&&Lx(v,w,!0,u.people||[])}catch(N){if(u.WTF)throw N}}function En(e){return e.charAt(0)=="/"?e.slice(1):e}function Q8(e,t){if(C2(),t=t||{},pm(t),bn(e,"META-INF/manifest.xml")||bn(e,"objectdata.xml"))return Hx(e,t);if(bn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof pd<"u"){if(e.FileIndex)return pd(e);var r=vt.utils.cfb_new();return nx(e).forEach(function(ve){eA(r,ve,Qb(e,ve))}),pd(r)}throw new Error("Unsupported NUMBERS file")}if(!bn(e,"[Content_Types].xml"))throw bn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=nx(e),a=qA(dn(e,"[Content_Types].xml")),i=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",sr(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!sr(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(Al=[],a.sst)try{Al=u8(sr(e,En(a.sst)),a.sst,t)}catch(ve){if(t.WTF)throw ve}t.cellStyles&&a.themes.length&&(u=c8(dn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=l8(sr(e,En(a.style)),a.style,u,t))}a.links.map(function(ve){try{var xe=Tl(dn(e,Sh(En(ve))),ve);return h8(sr(e,En(ve)),xe,ve,t)}catch{}});var d=n8(sr(e,En(a.workbooks[0])),a.workbooks[0],t),m={},g="";a.coreprops.length&&(g=sr(e,En(a.coreprops[0]),!0),g&&(m=tw(g)),a.extprops.length!==0&&(g=sr(e,En(a.extprops[0]),!0),g&&eN(g,m,t)));var v={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(g=dn(e,En(a.custprops[0]),!0),g&&(v=rN(g,t)));var y={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(xe){return xe.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(y.Props=m,y.Custprops=v),t.bookSheets&&typeof o<"u"&&(y.SheetNames=o),t.bookSheets?y.SheetNames:t.bookProps))return y;o={};var _={};t.bookDeps&&a.calcchain&&(_=d8(sr(e,En(a.calcchain)),a.calcchain));var S=0,k={},E,w;{var N=d.Sheets;m.Worksheets=N.length,m.SheetNames=[];for(var I=0;I!=N.length;++I)m.SheetNames[I]=N[I].name}var D=i?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),V=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");bn(e,V)||(V="xl/_rels/workbook."+D+".rels");var z=Tl(dn(e,V,!0),V.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=p8(sr(e,En(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=sF(sr(e,En(a.people[0])),t)),z&&(z=K8(z,d.Sheets));var W=sr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=m.Worksheets;++S){var B="sheet";if(z&&z[S]?(E="xl/"+z[S][1].replace(/[\/]?xl\//,""),bn(e,E)||(E=z[S][1]),bn(e,E)||(E=V.replace(/_rels\/.*$/,"")+z[S][1]),B=z[S][2]):(E="xl/worksheets/sheet"+(S+1-W)+"."+D,E=E.replace(/sheet0\./,"sheet.")),w=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(m.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var G=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==S&&(G=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==m.SheetNames[S].toLowerCase()&&(G=1);if(!G)continue e}}J8(e,E,w,m.SheetNames[S],S,k,o,B,t,d,u,f)}return y={Directory:a,Workbook:d,Props:m,Custprops:v,Deps:_,Sheets:o,SheetNames:m.SheetNames,Strings:Al,Styles:f,Themes:u,SSF:Cr(tt)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(ve,xe){ve=ve.replace(/^Root Entry[\/]/,""),y.keys.push(ve),y.files[ve]=e.FileIndex[xe]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=sr(e,En(a.vba[0]),!0):a.defaults&&a.defaults.bin===uF&&(y.vbaraw=sr(e,"xl/vbaProject.bin",!0))),y}function eO(e,t){var r=t||{},n="Workbook",a=vt.find(e,n);try{if(n="/!DataSpaces/Version",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(GL(a.content),n="/!DataSpaces/DataSpaceMap",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=XL(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=qL(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);KL(a.content)}catch{}if(n="/EncryptionInfo",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=JL(a.content);if(n="/EncryptedPackage",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function mm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function tO(e,t){return vt.find(e,"EncryptedPackage")?eO(e,t):Bw(e,t)}function rO(e,t){var r,n=e,a=t||{};return a.type||(a.type=gt&&Buffer.isBuffer(e)?"buffer":"base64"),r=F2(n,a),Q8(r,a)}function Vw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bh(e.slice(r),t);default:break e}return Ql.to_workbook(e,t)}function nO(e,t){var r="",n=mm(e,t);switch(t.type){case"base64":r=xn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ps(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ot(r)),t.type="binary",Vw(r,t)}function aO(e,t){var r=e;return t.type=="base64"&&(r=xn(r)),r=fi.utils.decode(1200,r.slice(2),"str"),t.type="binary",Vw(r,t)}function iO(e){return e.match(/[^\x00-\x7F]/)?fl(e):e}function md(e,t,r,n){return n?(r.type="string",Ql.to_workbook(e,r)):Ql.to_workbook(t,r)}function Ph(e,t){p2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ph(new Uint8Array(e),(r=Cr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),uo={},r.dateNF&&(uo.dateNF=r.dateNF),r.type||(r.type=gt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=gt?"buffer":"binary",n=Gb(e),typeof Uint8Array<"u"&&!gt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=iO(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Cr(r),r.type="array",Ph(Zp(n),r)}switch((a=mm(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return tO(vt.read(n,r),r);break;case 9:if(a[1]<=8)return Bw(n,r);break;case 60:return bh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return OL(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return PL.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?rO(n,r):md(e,n,r,i);case 239:return a[3]===60?bh(n,r):md(e,n,r,i);case 255:if(a[1]===254)return aO(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return bl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return bl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Nx.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return uP.to_workbook(n,r);break;case 10:case 13:case 32:return nO(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return NL.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Nx.to_workbook(n,r):md(e,n,r,i)}function sO(e,t,r,n,a,i,o,l){var u=br(r),f=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!o||e[r])for(var v=t.s.c;v<=t.e.c;++v){var y=o?e[r][v]:e[n[v]+u];if(y===void 0||y.t===void 0){if(f===void 0)continue;i[v]!=null&&(g[i[v]]=f);continue}var _=y.v;switch(y.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[v]!=null){if(_==null)if(y.t=="e"&&_===null)g[i[v]]=null;else if(f!==void 0)g[i[v]]=f;else if(d&&_===null)g[i[v]]=null;else continue;else g[i[v]]=d&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?_:Ya(y,_,l);_!=null&&(m=!1)}}return{row:g,isempty:m}}function Fh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=Jt(d);break;case"number":u=Jt(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(a=0);var m=br(u.s.r),g=[],v=[],y=0,_=0,S=Array.isArray(e),k=u.s.r,E=0,w={};S&&!e[k]&&(e[k]=[]);var N=f.skipHidden&&e["!cols"]||[],I=f.skipHidden&&e["!rows"]||[];for(E=u.s.c;E<=u.e.c;++E)if(!(N[E]||{}).hidden)switch(g[E]=hr(E),r=S?e[k][E]:e[g[E]+m],n){case 1:i[E]=E-u.s.c;break;case 2:i[E]=g[E];break;case 3:i[E]=f.header[E-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ya(r,null,f),_=w[o]||0,!_)w[o]=1;else{do l=o+"_"+_++;while(w[l]);w[o]=_,w[l]=1}i[E]=l}for(k=u.s.r+a;k<=u.e.r;++k)if(!(I[k]||{}).hidden){var D=sO(e,u,k,g,n,i,S,f);(D.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[y++]=D.row)}return v.length=y,v}var Gx=/"/g;function oO(e,t,r,n,a,i,o,l){for(var u=!0,f=[],d="",m=br(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=l.dense?(e[r]||[])[g]:e[n[g]+m];if(v==null)d="";else if(v.v!=null){u=!1,d=""+(l.rawNumbers&&v.t=="n"?v.v:Ya(v,null,l));for(var y=0,_=0;y!==d.length;++y)if((_=d.charCodeAt(y))===a||_===i||_===34||l.forceQuotes){d='"'+d.replace(Gx,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(u=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(Gx,'""')+'"')):d="";f.push(d)}return l.blankrows===!1&&u?null:f.join(o)}function Ww(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Jt(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),d="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(g[y]||{}).hidden||(m[y]=hr(y));for(var _=0,S=a.s.r;S<=a.e.r;++S)(v[S]||{}).hidden||(d=oO(e,a,S,m,o,u,i,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((_++?l:"")+d)));return delete n.dense,r.join("")}function lO(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ww(e,t);return r}function cO(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Jt(e["!ref"]),i="",o=[],l,u=[],f=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=hr(l);for(var d=a.s.r;d<=a.e.r;++d)for(i=br(d),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+i,r=f?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function $w(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Xr(n.origin):n.origin;o=u.r,l=u.c}var f,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(i["!ref"]){var m=Jt(i["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+a)}else o==-1&&(o=0,d.e.r=t.length-1+a);var g=n.header||[],v=0;t.forEach(function(_,S){wa(_).forEach(function(k){(v=g.indexOf(k))==-1&&(g[v=g.length]=k);var E=_[k],w="z",N="",I=Je({c:l+v,r:o+S+a});f=nc(i,I),E&&typeof E=="object"&&!(E instanceof Date)?i[I]=E:(typeof E=="number"?w="n":typeof E=="boolean"?w="b":typeof E=="string"?w="s":E instanceof Date?(w="d",n.cellDates||(w="n",E=Kr(E)),N=n.dateNF||tt[14]):E===null&&n.nullError&&(w="e",E=0),f?(f.t=w,f.v=E,delete f.w,delete f.R,N&&(f.z=N)):i[I]=f={t:w,v:E},N&&(f.z=N))})}),d.e.c=Math.max(d.e.c,l+g.length-1);var y=br(o);if(a)for(v=0;v<g.length;++v)i[hr(v+l)+y]={t:"s",v:g[v]};return i["!ref"]=_t(d),i}function uO(e,t){return $w(null,e,t)}function nc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Xr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?nc(e,Je(t)):nc(e,Je({r:t,c:r||0}))}function fO(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function gm(){return{SheetNames:[],Sheets:{}}}function xm(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(q5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dO(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=fO(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function hO(e,t){return e.z=t,e}function Gw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function pO(e,t,r){return Gw(e,"#"+t,r)}function mO(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function gO(e,t,r,n){for(var a=typeof t!="string"?t:Jt(t),i=typeof t=="string"?t:_t(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var u=nc(e,o,l);u.t="n",u.F=i,delete u.v,o==a.s.r&&l==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var xO={encode_col:hr,encode_row:br,encode_cell:Je,encode_range:_t,decode_col:rm,decode_row:tm,split_cell:AA,decode_cell:Xr,decode_range:Fo,format_cell:Ya,sheet_add_aoa:Y2,sheet_add_json:$w,sheet_add_dom:zw,aoa_to_sheet:Oo,json_to_sheet:uO,table_to_sheet:Uw,table_to_book:O8,sheet_to_csv:Ww,sheet_to_txt:lO,sheet_to_json:Fh,sheet_to_html:F8,sheet_to_formulae:cO,sheet_to_row_object_array:Fh,sheet_get_cell:nc,book_new:gm,book_append_sheet:xm,book_set_sheet_visibility:dO,cell_set_number_format:hO,cell_set_hyperlink:Gw,cell_set_internal_link:pO,cell_add_comment:mO,sheet_set_array_formula:gO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class dl extends Error{}dl.prototype.name="InvalidTokenError";function vO(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function _O(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return vO(t)}catch{return atob(t)}}function yO(e,t){if(typeof e!="string")throw new dl("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new dl(`Invalid token specified: missing part #${r+1}`);let a;try{a=_O(n)}catch(i){throw new dl(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(a)}catch(i){throw new dl(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const wO=e=>{try{const t=yO(e),r=Date.now()/1e3;return t.exp>r}catch{return!1}},ma=()=>{const e=localStorage.getItem("token");return e?wO(e)?e:(kO(),null):null},kO=()=>{localStorage.removeItem("token")},EO=async(e,t)=>{var r,n;try{return(await $e.post(`${Wt}/command/execute/`,{firewall_id:e,command:t},{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})).data}catch(a){throw $e.isAxiosError(a)?new Error(((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.error)||"Failed to execute command"):a}},SO=async e=>{var t,r;try{return(await $e.get(`${Wt}/command/commands/`,{params:{firewall_id:e},headers:{Authorization:`Bearer ${ma()}`}})).data}catch(n){throw $e.isAxiosError(n)?new Error(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.error)||"Failed to fetch command history"):n}},$i=$e.create({baseURL:Wt,headers:{"Content-Type":"application/json"},withCredentials:!0});$i.interceptors.request.use(async e=>{var n;const t=ma();t&&(e.headers.Authorization=`Bearer ${t}`);const r=(n=document.cookie.split("; ").find(a=>a.startsWith("csrftoken=")))==null?void 0:n.split("=")[1];return r&&(e.headers["X-CSRFToken"]=r),e},e=>Promise.reject(e));const TO=[{name:"Name",description:"Template name"},{name:"Source Address",description:"Source IP address or network"},{name:"Source Description",description:"Description of the source"},{name:"Source Interface",description:"Source network interface"},{name:"Destination Address",description:"Destination IP address or network"},{name:"Destination Description",description:"Description of the destination"},{name:"Destination Interface",description:"Destination network interface"},{name:"Service",description:"Network service or port"}];class CO{async getVariables(){try{return(await $i.get("/templates/variables/")).data.results||[]}catch{throw new Error("Failed to fetch variables")}}async getTemplate(t){try{return(await $i.get(`/templates/${t}/`)).data}catch{throw new Error("Failed to fetch template")}}async getTemplates(){try{return(await $i.get("/templates/")).data.results||[]}catch{throw new Error("Failed to fetch templates")}}async createTemplate(t){try{return(await $i.post("/templates/",t)).data}catch{throw new Error("Failed to create template")}}async updateTemplate(t,r){try{return(await $i.patch(`/templates/${t}/`,r)).data}catch{throw new Error("Failed to update template")}}async deleteTemplate(t){try{await $i.delete(`/templates/${t}/`)}catch{throw new Error("Failed to delete template")}}}const js=new CO,Bs={getVariables:async()=>{var e,t,r;try{const n=ma();if(!n)return console.error("No authentication token found"),[];let a=[],i=`${Wt}/templates/variables/`;for(;i;){const o=await $e.get(i,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(Array.isArray(o.data))a=[...a,...o.data],i=null;else if(o.data.results&&Array.isArray(o.data.results))a=[...a,...o.data.results],i=o.data.next;else{console.error("Unexpected API response format:",o.data);break}}return a}catch(n){return console.error("Error fetching variables:",n),$e.isAxiosError(n)&&console.error("Error details:",{status:(e=n.response)==null?void 0:e.status,data:(t=n.response)==null?void 0:t.data,headers:(r=n.response)==null?void 0:r.headers}),[]}},createVariable:async e=>{try{return(await $e.post(`${Wt}/templates/variables/`,e,{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})).data}catch(t){throw console.error("Error creating variable:",t),t}},updateVariable:async(e,t)=>{try{return(await $e.put(`${Wt}/templates/variables/${e}/`,t,{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})).data}catch(r){throw console.error("Error updating variable:",r),r}},deleteVariable:async e=>{try{await $e.delete(`${Wt}/templates/variables/${e}/`,{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})}catch(t){throw console.error("Error deleting variable:",t),t}},addVariableToTemplate:async(e,t)=>{try{await $e.post(`${Wt}/templates/${e}/add_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error adding variable to template:",r),r}},removeVariableFromTemplate:async(e,t)=>{try{await $e.post(`${Wt}/templates/${e}/remove_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error removing variable from template:",r),r}},async ensureRequiredVariables(){const e=await this.getVariables(),t=new Set(e.map(r=>r.name));for(const r of TO)t.has(r.name)||await this.createVariable(r)}},Zx=(e,t)=>{let r;return function(...a){const i=()=>{clearTimeout(r),e(...a)};clearTimeout(r),r=setTimeout(i,t)}},bO=()=>localStorage.getItem("token"),Ma=$e.create({baseURL:Wt});Ma.interceptors.request.use(e=>{const t=bO();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ma.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),cf("/login")),Promise.reject(e)));const AO=()=>{var dt,cr,At,at;const[e,t]=A.useState([]),[r,n]=A.useState(null),[a,i]=A.useState({hostname:"",ipAddress:"",vdom:"",setName:"",srcaddr:"",srcaddrDesc:"",srcintf:"",dstaddr:"",dstaddrDesc:"",dstintf:"",service:""});A.useState(""),A.useState("");const[o,l]=A.useState([]),[u,f]=A.useState([]),[d,m]=A.useState([]),[g,v]=A.useState(null),[y,_]=A.useState(!1),[S,k]=A.useState(""),[E,w]=A.useState(""),[N,I]=A.useState([]),[D,P]=A.useState([]),[V,z]=A.useState([]),[W,B]=A.useState({}),[G,K]=A.useState(""),[ve,xe]=A.useState(""),[he,me]=A.useState([]),[ae,Y]=A.useState(!1),[se,ye]=A.useState(null),[R,J]=A.useState(""),[q,Z]=A.useState([]),[ne,we]=A.useState(!1),[Le,be]=A.useState(null);A.useEffect(()=>{(async()=>{try{we(!0),be(null);const ge=await js.getTemplates();Z(ge)}catch(ge){console.error("Error loading templates:",ge),be("Failed to load templates")}finally{we(!1)}})()},[]);const[_e,Be]=A.useState(null),[H,Ye]=A.useState(!1),[nt,it]=A.useState(null),[Ze,Ae]=A.useState(null),[Et,pe]=A.useState(!1),[Pe,Fe]=A.useState(null),[Ve,pt]=A.useState([]);A.useEffect(()=>{(async()=>{try{_(!0);const ge=await Ma.get("/datacenters/hierarchy/");pt(ge.data)}catch(ge){console.error("Error fetching hierarchy:",ge)}finally{_(!1)}})()},[]);const ut=()=>{if(!S)return[];const Q=Ve.find(ge=>ge.id===S);return Q?Q.firewall_types:[]},St=()=>{if(!E)return[];const Q=Ve.find(ze=>ze.id===S);if(!Q)return[];const ge=Q.firewall_types.find(ze=>ze.id===E);return ge?ge.firewalls:[]},jt=Q=>{const ge=Q.target.value;k(ge),w(""),v(null)},Xt=Q=>{const ge=Q.target.value;w(ge),v(null)},bt=Q=>{var mt,Ct;const ge=Q.target.value,ot=St().find(qt=>qt.id===ge);if(ot){const qt={id:ot.id,name:ot.name,ip_address:ot.ip_address,data_center:{id:S,name:((mt=Ve.find(rr=>rr.id===S))==null?void 0:mt.name)||""},firewall_type:{id:E,name:((Ct=ut().find(rr=>rr.id===E))==null?void 0:Ct.name)||""},config:{id:"",config_data:{}},created_at:new Date().toISOString()};v(qt)}};A.useEffect(()=>{Ut()},[]);const Ut=async()=>{try{_(!0);let Q=[],ge="/firewalls/firewalls/";for(;ge;){const F=(await Ma.get(ge)).data;Q=[...Q,...F.results||[]],ge=F.next}const[ze,ot]=await Promise.all([Ma.get("/firewalls/firewall-types/"),Ma.get("/datacenters/")]);console.log("API Responses:",{firewallTypes:ze.data,dataCenters:ot.data,firewalls:Q});const Ct=(ze.data.results||[]).map(O=>({id:O.id,name:O.name,data_center:O.data_center,attributes_schema:O.attributes_schema||{}}));l(Ct);const rr=(ot.data.results||[]).map(O=>({id:O.id,name:O.name}));f(rr);const ia=Q.map(O=>({id:O.id,name:O.name,ip_address:O.ip_address,data_center:O.data_center&&O.data_center.id&&O.data_center.name?{id:O.data_center.id,name:O.data_center.name}:null,firewall_type:O.firewall_type&&O.firewall_type.id&&O.firewall_type.name?{id:O.firewall_type.id,name:O.firewall_type.name}:null,config:O.config||{id:"",config_data:{}},created_at:O.created_at}));m(ia);const Nr=localStorage.getItem("dataCenter"),Ie=localStorage.getItem("firewallType"),C=localStorage.getItem("selectedFirewallId");if(Nr&&k(Nr),Ie&&w(Ie),C){const O=ia.find(F=>F.id===C);O&&(v(O),i(F=>({...F,ipAddress:O.ip_address})))}}catch(Q){console.error("Error fetching data:",Q)}finally{_(!1)}};A.useEffect(()=>{if(S){const Q=o.filter(ge=>{if(!ge.data_center)return console.log("No data_center for type:",ge),!1;const ze=ge.data_center===S;return console.log("Type matches:",{typeId:ge.id,typeDataCenter:ge.data_center,selectedDataCenter:S,matches:ze}),ze});console.log("Filtered Firewall Types:",{selectedDataCenter:S,allTypes:o,filteredTypes:Q}),I(Q),E&&!Q.some(ge=>ge.id===E)&&(w(""),localStorage.removeItem("firewallType"))}else I([]),w("")},[S,o]),A.useEffect(()=>{var Q;if(E){const ge=N.find(ze=>ze.id===E);if(console.log("Selected Type:",ge),(Q=ge==null?void 0:ge.attributes_schema)!=null&&Q.properties){const ze=Object.entries(ge.attributes_schema.properties).map(([ot,mt])=>({name:ot,label:mt.title||ot,required:mt.required||!1,type:mt.type||"string"}));console.log("Generated Form Fields:",ze),z(ze)}else console.log("No attributes schema found for type:",ge),z([])}else z([])},[E,N]),A.useEffect(()=>{if(E&&S){const Q=d.filter(ge=>{if(!ge.firewall_type||!ge.data_center)return!1;const ze=ge.firewall_type.id===E,ot=ge.data_center.id===S;return console.log("Firewall Filter Check:",{firewallId:ge.id,firewallType:ge.firewall_type.id,dataCenter:ge.data_center.id,selectedType:E,selectedDC:S,matchesType:ze,matchesDataCenter:ot}),ze&&ot});console.log("Filtered Firewalls:",{selectedFirewallType:E,selectedDataCenter:S,allFirewalls:d,filteredFirewalls:Q}),P(Q),g&&!Q.some(ge=>ge.id===g.id)&&(v(null),localStorage.removeItem("selectedFirewallId"))}else P([]),v(null)},[E,S,d]),A.useEffect(()=>{const Q=localStorage.getItem("dataCenter"),ge=localStorage.getItem("firewallType"),ze=localStorage.getItem("selectedFirewallId");if(console.log("Loading saved selections:",{savedDataCenter:Q,savedFirewallType:ge,savedFirewallId:ze}),Q&&k(Q),ge&&w(ge),ze){const ot=d.find(mt=>mt.id===ze);ot&&(v(ot),i(mt=>({...mt,ipAddress:ot.ip_address})))}},[d]);const He=Q=>{var ge;try{const ze=Ph(Q,{type:"array"});if(!ze.SheetNames.length)throw new Error("No sheets found in the Excel file");const ot=ze.SheetNames[0],mt=ze.Sheets[ot],Ct=N.find(C=>C.id===E);if(!Ct)throw new Error("No firewall type selected");if(!((ge=Ct.attributes_schema)!=null&&ge.properties))throw new Error("No attributes defined for the selected firewall type");const qt=Object.entries(Ct.attributes_schema.properties).filter(([C,O])=>O.required).map(([C])=>C),rr=xO.sheet_to_json(mt,{raw:!1,header:1});if(!Array.isArray(rr)||rr.length===0)throw new Error("No data found in the Excel file");const ia=rr[0];if(!Array.isArray(ia)||ia.length===0)throw new Error("No headers found in the Excel file");const Ie=rr.slice(1).map((C,O)=>{var U;const F={};Array.isArray(C)&&ia.forEach((ee,fe)=>{const re=C[fe];F[ee]=re});const M=qt.filter(ee=>!F[ee]);if(M.length>0)throw new Error(`Missing required fields in row ${O+2}: ${M.join(", ")}`);const j={};return(U=Ct==null?void 0:Ct.attributes_schema)!=null&&U.properties&&Object.entries(Ct.attributes_schema.properties).forEach(([ee,fe])=>{const re=Object.keys(F).find(ie=>{const oe=ie.toLowerCase().replace(/\s+/g,""),Ee=ee.toLowerCase().replace(/\s+/g,""),Ne={ipaddress:["ip","ipaddress","ipaddr","ip_address","ipaddress","IP Adresse"],sourceaddress:["source","src","sourceaddr","source_address","sourceaddress","source"],destinationinterface:["dstintf","destinationintf","destination_interface","dstinterface","destinationinterface","destination"],name:["name","nom","hostname","device"],vdom:["vdom","virtualdomain"],service:["service","services","protocol"],hostname:["hostname","name","device"],sourcedescription:["sourcedescription","srcdesc","source_desc"],sourceinterface:["sourceinterface","srcintf","source_intf"],destinationaddress:["destinationaddress","dstaddr","destination_addr"],destinationdescription:["destinationdescription","dstdesc","destination_desc"]};return oe===Ee?!0:Ne[Ee]?Ne[Ee].includes(oe):!1});re?j[ee]=F[re]||"":j[ee]=""}),j});t(Ie),Ie.length>0&&(n(Ie[0]),B(Ie[0])),alert(`${Ie.length} configurations loaded successfully`)}catch(ze){alert(`Error processing Excel file: ${ze.message}`)}},ce=Q=>{var ze;const ge=(ze=Q.target.files)==null?void 0:ze[0];if(ge){if(!E){alert("Please select a firewall type before uploading the file");return}const ot=new FileReader;ot.onload=mt=>{var qt;const Ct=(qt=mt.target)==null?void 0:qt.result;He(Ct)},ot.readAsArrayBuffer(ge)}},de=ho.useCallback(Zx(async Q=>{var ge,ze,ot,mt;if(!(!g||!Q)){Ye(!0),it(null),Be(null);try{const Ct=await Ma.post("/analysis/flow-matrix/analyze-ip/",{source_ip:Q,firewall_id:g.id,data_center_name:((ge=g.data_center)==null?void 0:ge.name)||"",firewall_type_name:((ze=g.firewall_type)==null?void 0:ze.name)||""});Be(Ct.data)}catch(Ct){it(((mt=(ot=Ct.response)==null?void 0:ot.data)==null?void 0:mt.error)||"Failed to search address")}finally{Ye(!1)}}},500),[g]),Se=ho.useCallback(Zx(async Q=>{var ge,ze,ot,mt;if(!(!g||!Q)){pe(!0),Fe(null),Ae(null);try{const Ct=await Ma.post("/analysis/flow-matrix/analyze-ip/",{source_ip:Q,firewall_id:g.id,data_center_name:((ge=g.data_center)==null?void 0:ge.name)||"",firewall_type_name:((ze=g.firewall_type)==null?void 0:ze.name)||""});Ae(Ct.data)}catch(Ct){Fe(((mt=(ot=Ct.response)==null?void 0:ot.data)==null?void 0:mt.error)||"Failed to search address")}finally{pe(!1)}}},500),[g]),Oe=(Q,ge)=>{B(ze=>({...ze,[Q]:ge})),Q==="SourceAddress"?de(ge):Q==="DestinationAddress"&&Se(ge)},Ue=r&&{fields:[{name:"hostname",label:"Hostname",required:!0},{name:"ipAddress",label:"IP Address",required:!0},{name:"vdom",label:"VDOM",required:!0},{name:"setName",label:"Set Name",required:!0},{name:"srcaddr",label:"Source Address",required:!0},{name:"srcaddrDesc",label:"Source Description",required:!1},{name:"srcintf",label:"Source Interface",required:!0},{name:"dstaddr",label:"Destination Address",required:!0},{name:"dstaddrDesc",label:"Destination Description",required:!1},{name:"dstintf",label:"Destination Interface",required:!0},{name:"service",label:"Service",required:!0}]};Ue!=null&&Ue.fields;const Tt=async Q=>{if(!g){ct("Please select a firewall first");return}try{const ge=await EO(g.id,Q);me(ze=>Array.isArray(ze)?[...ze,ge]:[ge]),K(""),ct(null)}catch(ge){ct(ge instanceof Error?ge.message:"Failed to execute command")}};A.useEffect(()=>{(async()=>{if(g)try{const ge=await SO(g.id);me(Array.isArray(ge)?ge:[])}catch(ge){console.error("Error loading command history:",ge),me([])}})()},[g]);const st=()=>{if(!R)return;const Q=q.find(qt=>qt.name===R);if(!Q)return;const ge=/{{([^}]+)}}/g,ze=new Set;let ot;for(;(ot=ge.exec(Q.content))!==null;){const qt=ot[1].trim();ze.add(qt)}const mt={};ze.forEach(qt=>{const rr=W[qt]||"";mt[`{{ ${qt} }}`]=rr});let Ct=Q.content;Object.entries(mt).forEach(([qt,rr])=>{Ct=Ct.replace(new RegExp(qt,"g"),rr)}),K(Ct)},Xe=async()=>{var Q,ge,ze,ot;if(!g||!W.SourceAddress){it("Please select a firewall and enter a source address");return}Ye(!0),it(null),Be(null);try{const mt=await Ma.post("/analysis/flow-matrix/analyze-ip/",{source_ip:W.SourceAddress,firewall_id:g.id,data_center_name:((Q=g.data_center)==null?void 0:Q.name)||"",firewall_type_name:((ge=g.firewall_type)==null?void 0:ge.name)||""});Be(mt.data)}catch(mt){it(((ot=(ze=mt.response)==null?void 0:ze.data)==null?void 0:ot.error)||"Failed to search source address")}finally{Ye(!1)}};A.useState(!1);const[Ke,ct]=A.useState(null);return A.useState([]),A.useState(!1),A.useState(null),A.useState([]),A.useState([]),A.useState(""),A.useState(""),A.useState(""),p.jsxs("div",{className:"p-8",children:[p.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:p.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(mc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),p.jsxs("select",{value:S,onChange:jt,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[p.jsx("option",{value:"",children:"All data centers"}),Ve.map(Q=>p.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(ds,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),p.jsxs("select",{value:E,onChange:Xt,disabled:!S,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${S?"":"bg-gray-100"}`,children:[p.jsx("option",{value:"",children:"Select a firewall type"}),ut().map(Q=>p.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(gc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),p.jsxs("select",{value:(g==null?void 0:g.id)||"",onChange:bt,disabled:!E,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${E?"":"bg-gray-100"}`,children:[p.jsx("option",{value:"",children:"Select a firewall"}),St().map(Q=>p.jsxs("option",{value:Q.id,children:[Q.name," - ",Q.ip_address]},Q.id))]})]})]})]})}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Configuration"}),p.jsx("div",{className:"space-y-4",children:V.length>0?V.map(Q=>p.jsxs("div",{className:"mb-6",children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[Q.label,Q.required&&p.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),p.jsx("div",{className:"relative",children:p.jsx("input",{type:Q.type==="string"?"text":Q.type,value:W[Q.name]||"",onChange:ge=>Oe(Q.name,ge.target.value),required:Q.required,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2",placeholder:`Enter ${Q.label.toLowerCase()}`})})]},Q.name)):p.jsx("div",{className:"text-center py-4 text-gray-500",children:E?"No fields defined for this firewall type":"Select a firewall type to see available fields"})})]})}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Slectionner une configuration"}),e.length>0?p.jsxs(p.Fragment,{children:[p.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg mb-4",value:(r==null?void 0:r.hostname)||"",onChange:Q=>{const ge=e.find(ze=>ze.hostname===Q.target.value);if(ge){n(ge),i(ge);const ze={};Object.entries(ge).forEach(([ot,mt])=>{ze[ot]=String(mt)}),B(ze)}},children:[p.jsx("option",{value:"",children:"Choisir une configuration"}),e.map((Q,ge)=>p.jsxs("option",{value:Q.hostname,children:[Q.hostname," - ",Q.ipAddress]},ge))]}),r&&p.jsxs("button",{onClick:()=>{i(r);const Q={};Object.entries(r).forEach(([ge,ze])=>{Q[ge]=String(ze)}),B(Q)},className:"w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 flex items-center justify-center",children:[p.jsx(Wp,{className:"w-5 h-5 mr-2"}),"Appliquer la configuration"]})]}):p.jsx("div",{className:"text-center py-4 text-gray-500",children:"Aucune configuration disponible. Veuillez importer un fichier Excel ou crer une configuration manuelle."})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Importer une configuration"}),p.jsx("div",{className:"space-y-4",children:E?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"mb-4",children:p.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Format Excel requis:"}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[p.jsx("thead",{className:"bg-gray-50",children:p.jsx("tr",{children:Object.entries(((cr=(dt=N.find(Q=>Q.id===E))==null?void 0:dt.attributes_schema)==null?void 0:cr.properties)||{}).map(([Q,ge])=>p.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider border-b border-gray-200",children:[ge.title," ",ge.required&&p.jsx("span",{className:"text-red-500 ml-1",children:"*"})]},Q))})}),p.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.jsx("tr",{children:Object.entries(((at=(At=N.find(Q=>Q.id===E))==null?void 0:At.attributes_schema)==null?void 0:at.properties)||{}).map(([Q,ge])=>p.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 border-b border-gray-200",children:ge.type==="string"?"Texte":ge.type},Q))})})]})}),p.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[p.jsx("span",{className:"text-red-500",children:"*"})," Champs obligatoires"]})]})}),p.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[p.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ce,className:"hidden",id:"file-upload"}),p.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center",children:[p.jsx(f2,{className:"h-12 w-12 text-gray-400 mb-4"}),p.jsx("span",{className:"text-gray-600",children:"Choisir un fichier Excel"}),p.jsx("span",{className:"text-sm text-gray-500 mt-2",children:"Format: .xlsx, .xls"})]})]})]}):p.jsx("div",{className:"text-center py-8",children:p.jsx("p",{className:"text-gray-500",children:"Veuillez slectionner un type de pare-feu pour voir les champs requis"})})})]})]})]}),p.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Source Address Search"}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("input",{type:"text",value:W.SourceAddress||"",onChange:Q=>Oe("SourceAddress",Q.target.value),placeholder:"Enter source address",className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),p.jsx("button",{onClick:Xe,disabled:H||!g||!W.SourceAddress,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:H?"Searching...":"Search Address"})]}),nt&&p.jsx("div",{className:"mt-4 p-4 bg-red-50 text-red-700 rounded-md",children:nt}),_e&&p.jsx("div",{className:"mt-4 space-y-4",children:p.jsxs("div",{className:"p-4 bg-green-50 rounded-md",children:[p.jsx("h4",{className:"font-medium text-green-800 mb-4",children:"Search Results"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Source Address"}),p.jsx("p",{className:"font-medium text-gray-900",children:_e.ip})]}),p.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Config Path"}),p.jsx("p",{className:"font-medium text-gray-900",children:_e.config_path})]})]}),p.jsxs("div",{className:"mt-6",children:[p.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Matched Address Objects"}),_e.matches&&_e.matches.length>0?p.jsx("div",{className:"space-y-4",children:_e.matches.map((Q,ge)=>p.jsxs("div",{className:"border-l-4 border-green-500 pl-3",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),p.jsx("span",{className:"font-medium text-gray-900",children:Q.name})]}),Q.comment&&p.jsx("div",{className:"ml-4 mt-1",children:p.jsx("p",{className:"text-xs text-gray-500 italic",children:Q.comment})}),Q.groups&&Q.groups.length>0&&p.jsxs("div",{className:"ml-4 mt-2 text-sm text-blue-600",children:["Groups: ",Q.groups.join(", ")]})]},ge))}):p.jsx("p",{className:"text-gray-500 italic mt-2",children:"No matches found"})]}),_e.matches&&_e.matches.length>0&&p.jsxs("details",{className:"mt-4",children:[p.jsx("summary",{className:"text-sm text-gray-500 cursor-pointer",children:"Debug Information"}),p.jsx("div",{className:"mt-2 space-y-2",children:_e.matches.map((Q,ge)=>p.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[p.jsxs("p",{children:[p.jsx("span",{className:"text-gray-500",children:"Name:"})," ",Q.name]}),Q.comment&&p.jsxs("p",{children:[p.jsx("span",{className:"text-gray-500",children:"Comment:"})," ",Q.comment]}),Q.groups&&Q.groups.length>0&&p.jsxs("p",{children:[p.jsx("span",{className:"text-gray-500",children:"Groups:"})," ",Q.groups.join(", ")]})]},ge))})]})]})})]}),p.jsxs("div",{className:"mt-8 bg-gray-900 rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[p.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),p.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),p.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),p.jsx("h2",{className:"text-xl font-semibold text-gray-200 ml-2",children:"Terminal"})]}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"text-gray-400",children:"Selected Firewall:"}),p.jsx("span",{className:"text-purple-400",children:g?`${g.name} (${g.ip_address})`:"None"})]}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"text-gray-400",children:"Template:"})]}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsxs("select",{value:R,onChange:Q=>J(Q.target.value),className:"flex-1 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:ne,children:[p.jsx("option",{value:"",children:"Select a template..."}),q.map(Q=>p.jsx("option",{value:Q.name,children:Q.name},Q.id))]}),p.jsx("button",{onClick:st,disabled:!R||ne,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:ne?"Loading...":"Apply Template"})]}),Le&&p.jsx("div",{className:"mt-2 text-sm text-red-400",children:Le})]}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsxs("div",{className:"flex-1 relative",children:[p.jsx("span",{className:"absolute left-3 top-2 text-green-400",children:"$"}),p.jsx("textarea",{value:G,onChange:Q=>K(Q.target.value),placeholder:"Enter command...",className:"w-full h-32 pl-8 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm resize-none",onKeyDown:Q=>{Q.key==="Enter"&&!Q.shiftKey&&(Q.preventDefault(),Tt(G))}})]}),p.jsxs("div",{className:"flex flex-col space-y-2",children:[p.jsx("button",{onClick:Q=>{Q.preventDefault(),Tt(G)},disabled:ae||!g||!G.trim(),className:`px-4 py-2 rounded-md transition-colors duration-200 ${ae?"bg-yellow-600 text-white":!g||!G.trim()?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:ae?p.jsxs("div",{className:"flex items-center",children:[p.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Executing..."]}):"Execute"}),p.jsx("button",{onClick:()=>K(""),className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors duration-200",children:"Clear"})]})]})]}),ve&&p.jsxs("div",{className:"mb-4 p-4 bg-gray-800 rounded-md border border-gray-700",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("span",{className:"text-gray-400 text-lg",children:"Output:"}),p.jsx("button",{onClick:()=>xe(""),className:"text-gray-500 hover:text-gray-400",children:"Clear"})]}),p.jsx("pre",{className:"text-sm overflow-auto max-h-96 font-mono text-gray-300 p-4 bg-gray-900 rounded-md",children:ve})]}),se&&p.jsxs("div",{className:"mb-4 p-4 bg-red-900/50 text-red-400 rounded-md border border-red-700",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-red-500 font-semibold",children:"Error:"}),p.jsx("button",{onClick:()=>ye(null),className:"text-red-500 hover:text-red-400",children:"Clear"})]}),p.jsx("p",{className:"mt-2",children:se})]}),he.length>0&&p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"text-gray-400",children:"History:"})]}),p.jsx("button",{onClick:()=>me([]),className:"text-gray-500 hover:text-gray-400 text-sm",children:"Clear History"})]}),p.jsx("div",{className:"space-y-2",children:he.map((Q,ge)=>p.jsxs("div",{className:"bg-gray-800 rounded-md p-3 border border-gray-700",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"font-mono text-sm text-gray-300",children:Q.command})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:`px-2 py-1 rounded text-xs ${Q.status==="completed"?"bg-green-900 text-green-300":Q.status==="failed"?"bg-red-900 text-red-300":Q.status==="executing"?"bg-yellow-900 text-yellow-300":"bg-gray-900 text-gray-300"}`,children:Q.status}),p.jsx("span",{className:"text-xs text-gray-500",children:new Date(Q.executed_at).toLocaleString()})]})]}),Q.output&&p.jsx("pre",{className:`text-sm overflow-auto max-h-40 font-mono ${Q.status==="completed"?"text-gray-300":"text-red-400"}`,children:Q.output}),Q.error_message&&p.jsxs("div",{className:"mt-2 text-sm text-red-400",children:["Error: ",Q.error_message]})]},`${Q.id}-${Q.executed_at}-${ge}`))})]})]})]})};let NO={data:""},LO=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||NO,PO=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,FO=/\/\*[^]*?\*\/|  +/g,Xx=/\n+/g,hi=(e,t)=>{let r="",n="",a="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?hi(o,i):i+"{"+hi(o,i[1]=="k"?"":t)+"}":typeof o=="object"?n+=hi(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=hi.p?hi.p(i,o):i+":"+o+";")}return r+(t&&a?t+"{"+a+"}":a)+n},Fa={},Zw=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Zw(e[r]);return t}return e},OO=(e,t,r,n,a)=>{let i=Zw(e),o=Fa[i]||(Fa[i]=(u=>{let f=0,d=11;for(;f<u.length;)d=101*d+u.charCodeAt(f++)>>>0;return"go"+d})(i));if(!Fa[o]){let u=i!==e?e:(f=>{let d,m,g=[{}];for(;d=PO.exec(f.replace(FO,""));)d[4]?g.shift():d[3]?(m=d[3].replace(Xx," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][d[1]]=d[2].replace(Xx," ").trim();return g[0]})(e);Fa[o]=hi(a?{["@keyframes "+o]:u}:u,r?"":"."+o)}let l=r&&Fa.g?Fa.g:null;return r&&(Fa.g=Fa[o]),((u,f,d,m)=>{m?f.data=f.data.replace(m,u):f.data.indexOf(u)===-1&&(f.data=d?u+f.data:f.data+u)})(Fa[o],t,n,l),o},MO=(e,t,r)=>e.reduce((n,a,i)=>{let o=t[i];if(o&&o.call){let l=o(r),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":hi(l,""):l===!1?"":l}return n+a+(o??"")},"");function t0(e){let t=this||{},r=e.call?e(t.p):e;return OO(r.unshift?r.raw?MO(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,LO(t.target),t.g,t.o,t.k)}let Xw,Oh,Mh;t0.bind({g:1});let Ka=t0.bind({k:1});function RO(e,t,r,n){hi.p=t,Xw=e,Oh=r,Mh=n}function Ii(e,t){let r=this||{};return function(){let n=arguments;function a(i,o){let l=Object.assign({},i),u=l.className||a.className;r.p=Object.assign({theme:Oh&&Oh()},l),r.o=/ *go\d+/.test(u),l.className=t0.apply(r,n)+(u?" "+u:"");let f=e;return e[0]&&(f=l.as||e,delete l.as),Mh&&f[0]&&Mh(l),Xw(f,l)}return a}}var DO=e=>typeof e=="function",Sf=(e,t)=>DO(e)?e(t):e,IO=(()=>{let e=0;return()=>(++e).toString()})(),qw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),jO=20,Yw=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,jO)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return Yw(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Ou=[],es={toasts:[],pausedAt:void 0},Ts=e=>{es=Yw(es,e),Ou.forEach(t=>{t(es)})},BO={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},zO=(e={})=>{let[t,r]=A.useState(es),n=A.useRef(es);A.useEffect(()=>(n.current!==es&&r(es),Ou.push(r),()=>{let i=Ou.indexOf(r);i>-1&&Ou.splice(i,1)}),[]);let a=t.toasts.map(i=>{var o,l,u;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((o=e[i.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((l=e[i.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||BO[i.type],style:{...e.style,...(u=e[i.type])==null?void 0:u.style,...i.style}}});return{...t,toasts:a}},UO=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||IO()}),Ec=e=>(t,r)=>{let n=UO(t,e,r);return Ts({type:2,toast:n}),n.id},Sr=(e,t)=>Ec("blank")(e,t);Sr.error=Ec("error");Sr.success=Ec("success");Sr.loading=Ec("loading");Sr.custom=Ec("custom");Sr.dismiss=e=>{Ts({type:3,toastId:e})};Sr.remove=e=>Ts({type:4,toastId:e});Sr.promise=(e,t,r)=>{let n=Sr.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?Sf(t.success,a):void 0;return i?Sr.success(i,{id:n,...r,...r==null?void 0:r.success}):Sr.dismiss(n),a}).catch(a=>{let i=t.error?Sf(t.error,a):void 0;i?Sr.error(i,{id:n,...r,...r==null?void 0:r.error}):Sr.dismiss(n)}),e};var HO=(e,t)=>{Ts({type:1,toast:{id:e,height:t}})},VO=()=>{Ts({type:5,time:Date.now()})},Pl=new Map,WO=1e3,$O=(e,t=WO)=>{if(Pl.has(e))return;let r=setTimeout(()=>{Pl.delete(e),Ts({type:4,toastId:e})},t);Pl.set(e,r)},GO=e=>{let{toasts:t,pausedAt:r}=zO(e);A.useEffect(()=>{if(r)return;let i=Date.now(),o=t.map(l=>{if(l.duration===1/0)return;let u=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(u<0){l.visible&&Sr.dismiss(l.id);return}return setTimeout(()=>Sr.dismiss(l.id),u)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[t,r]);let n=A.useCallback(()=>{r&&Ts({type:6,time:Date.now()})},[r]),a=A.useCallback((i,o)=>{let{reverseOrder:l=!1,gutter:u=8,defaultPosition:f}=o||{},d=t.filter(v=>(v.position||f)===(i.position||f)&&v.height),m=d.findIndex(v=>v.id===i.id),g=d.filter((v,y)=>y<m&&v.visible).length;return d.filter(v=>v.visible).slice(...l?[g+1]:[0,g]).reduce((v,y)=>v+(y.height||0)+u,0)},[t]);return A.useEffect(()=>{t.forEach(i=>{if(i.dismissed)$O(i.id,i.removeDelay);else{let o=Pl.get(i.id);o&&(clearTimeout(o),Pl.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:HO,startPause:VO,endPause:n,calculateOffset:a}}},ZO=Ka`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,XO=Ka`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,qO=Ka`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,YO=Ii("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ZO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${XO} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${qO} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,KO=Ka`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,JO=Ii("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${KO} 1s linear infinite;
`,QO=Ka`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,eM=Ka`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,tM=Ii("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${QO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${eM} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,rM=Ii("div")`
  position: absolute;
`,nM=Ii("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,aM=Ka`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iM=Ii("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${aM} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,sM=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?A.createElement(iM,null,t):t:r==="blank"?null:A.createElement(nM,null,A.createElement(JO,{...n}),r!=="loading"&&A.createElement(rM,null,r==="error"?A.createElement(YO,{...n}):A.createElement(tM,{...n})))},oM=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,lM=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,cM="0%{opacity:0;} 100%{opacity:1;}",uM="0%{opacity:1;} 100%{opacity:0;}",fM=Ii("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,dM=Ii("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,hM=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=qw()?[cM,uM]:[oM(r),lM(r)];return{animation:t?`${Ka(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ka(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},pM=A.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?hM(e.position||t||"top-center",e.visible):{opacity:0},i=A.createElement(sM,{toast:e}),o=A.createElement(dM,{...e.ariaProps},Sf(e.message,e));return A.createElement(fM,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:o}):A.createElement(A.Fragment,null,i,o))});RO(A.createElement);var mM=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=A.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(e,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return A.createElement("div",{ref:i,className:t,style:r},a)},gM=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:qw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},xM=t0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,mu=16,vM=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:u}=GO(r);return A.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:mu,left:mu,right:mu,bottom:mu,pointerEvents:"none",...i},className:o,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(f=>{let d=f.position||t,m=u.calculateOffset(f,{reverseOrder:e,gutter:n,defaultPosition:t}),g=gM(d,m);return A.createElement(mM,{id:f.id,key:f.id,onHeightUpdate:u.updateHeight,className:f.visible?xM:"",style:g},f.type==="custom"?Sf(f.message,f):a?a(f):A.createElement(pM,{toast:f,position:d}))}))};const _M=()=>localStorage.getItem("token"),eo=$e.create({baseURL:Wt});eo.interceptors.request.use(e=>{const t=_M();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));eo.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function yM(){ka();const[e,t]=A.useState(""),[r,n]=A.useState("show"),[a,i]=A.useState(!1),[o,l]=A.useState(null),[u,f]=A.useState(null),[d,m]=A.useState([]);A.useState(!1);const[g,v]=A.useState([]),[y,_]=A.useState(""),[S,k]=A.useState(""),[E,w]=A.useState(null);A.useEffect(()=>{(async()=>{try{i(!0),l(null);const G=await eo.get("/datacenters/hierarchy/");v(G.data)}catch(G){console.error("Error fetching hierarchy:",G),l("Failed to fetch hierarchy data")}finally{i(!1)}})()},[]);const N=()=>{if(!y)return[];const B=g.find(G=>G.id===y);return B?B.firewall_types:[]},I=()=>{if(!S)return[];const B=g.find(K=>K.id===y);if(!B)return[];const G=B.firewall_types.find(K=>K.id===S);return G?G.firewalls:[]},D=B=>{const G=B.target.value;_(G),k(""),w(null),m([])},P=B=>{const G=B.target.value;k(G),w(null),m([])},V=()=>{const B=I();d.length===B.length?m([]):m(B.map(G=>G.id))},z=B=>{m(G=>G.includes(B)?G.filter(K=>K!==B):[...G,B])},W=async()=>{if(!d.length&&!S){l("Please select firewalls or a firewall type");return}i(!0),l(null),f(null);try{const B=d.length>0?I().filter(K=>d.includes(K.id)):I(),G=await eo.post("/command/commands/save_bulk_config/",{firewall_ids:B.map(K=>K.id),command:r});if(G.data.status==="success"){f("Configuration save started. You can leave this page, the saves will continue in the background.");const K=G.data.task_id,ve=setInterval(async()=>{try{const he=(await eo.get(`/command/commands/check_task_status/?task_id=${K}`)).data;if(f(`${he.message} (${he.progress}%)`),he.status==="completed"){if(clearInterval(ve),f("All configurations saved successfully"),he.results&&he.results.length>0){const me=he.results.filter(Y=>Y.status==="success"&&Y.filepath),ae=he.results.filter(Y=>Y.status==="failed");for(const Y of me)try{const se=await eo.get("/command/commands/download_config_file/",{responseType:"blob",params:{filepath:Y.filepath}}),ye=new Blob([se.data],{type:"text/plain"}),R=window.URL.createObjectURL(ye),J=document.createElement("a");J.href=R,J.setAttribute("download",`${Y.firewall_name}_config.txt`),document.body.appendChild(J),J.click(),document.body.removeChild(J),window.URL.revokeObjectURL(R)}catch(se){console.error(`Error downloading config for ${Y.firewall_name}:`,se),Sr.error(`Failed to download configuration for ${Y.firewall_name}`)}me.length>0&&f(`${me.length} configurations saved and downloaded successfully`),ae.length>0&&l(`Failed to save ${ae.length} configurations: ${ae.map(Y=>Y.firewall_name).join(", ")}`)}}else he.status==="failed"&&(clearInterval(ve),l(`Configuration save failed: ${he.message}`))}catch(xe){console.error("Error checking task status:",xe),clearInterval(ve),l("Failed to check task status")}},2e3);return()=>clearInterval(ve)}else l("Failed to start configuration save")}catch(B){console.error("Error during bulk save:",B),l("Failed to save configurations")}finally{i(!1)}};return a?p.jsx("div",{className:"p-8",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),p.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):o?p.jsx("div",{className:"p-8",children:p.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[p.jsx("strong",{className:"font-bold",children:"Error!"}),p.jsxs("span",{className:"block sm:inline",children:[" ",o]})]})}):p.jsxs("div",{className:"p-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall Configuration"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"Manage firewall configurations"}),p.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:p.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(mc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),p.jsxs("select",{value:y,onChange:D,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[p.jsx("option",{value:"",children:"All data centers"}),g.map(B=>p.jsx("option",{value:B.id,children:B.name},B.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(ds,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),p.jsxs("select",{value:S,onChange:P,disabled:!y,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${y?"":"bg-gray-100"}`,children:[p.jsx("option",{value:"",children:"Select a firewall type"}),N().map(B=>p.jsx("option",{value:B.id,children:B.name},B.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(gc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),p.jsxs("div",{className:"mt-1 space-y-2",children:[p.jsx("button",{onClick:V,disabled:!S,className:`w-full px-3 py-1 text-sm rounded-md ${d.length===I().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${S?"":"opacity-50 cursor-not-allowed"}`,children:d.length===I().length?"Deselect All":"Select All"}),p.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:I().map(B=>p.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${d.includes(B.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>z(B.id),children:[p.jsx("input",{type:"checkbox",checked:d.includes(B.id),onChange:()=>z(B.id),className:"mr-2"}),p.jsxs("span",{className:"text-sm",children:[B.name," - ",B.ip_address]})]},B.id))})]})]})]})]})}),p.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP Address"}),p.jsx("input",{type:"text",value:e,onChange:B=>t(B.target.value),placeholder:"e.g., 192.168.1.1",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Command"}),p.jsx("input",{type:"text",value:r,onChange:B=>n(B.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),o&&p.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md",children:o}),u&&p.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md",children:u}),p.jsx("div",{className:"flex space-x-4",children:p.jsxs("button",{onClick:W,disabled:a||!d.length&&!S,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[p.jsx(Wp,{className:"h-5 w-5 mr-2"}),a?"Saving...":"Save Configuration"]})})]})})]})}const qx=["Hostname","IP Adresse","VDOM","Name","SourceAddress","SourceDescription","SourceInterface","DestinationAddress","DestinationDescription","DestinationInterface","service"];function wM(){const[e,t]=A.useState([]),[r,n]=A.useState([]),[a,i]=A.useState([]),[o,l]=A.useState({name:"",description:"",location:"",latitude:"",longitude:""}),[u,f]=A.useState({name:"",description:""}),[d,m]=A.useState([]),[g,v]=A.useState({}),[y,_]=A.useState(!1),[S,k]=A.useState(null),[E,w]=A.useState({}),[N,I]=A.useState(""),[D,P]=A.useState(""),[V,z]=A.useState(!1),[W,B]=A.useState(null),[G,K]=A.useState(null),[ve,xe]=A.useState(null);A.useState(1);const[he,me]=A.useState(null),[ae,Y]=A.useState(!1),[se,ye]=A.useState(null),[R,J]=A.useState(!1),[q,Z]=A.useState({name:"",ip_address:"",firewall_type:""}),[ne,we]=A.useState(!1),[Le,be]=A.useState(""),_e=()=>{const ce=localStorage.getItem("token");if(!ce)throw new Error("No authentication token found");return ce},Be=$e.create({baseURL:Wt,headers:{"Content-Type":"application/json"}});Be.interceptors.request.use(ce=>{var de;try{const Se=_e();return Se&&(ce.headers.Authorization=`Bearer ${Se}`),(de=ce.url)!=null&&de.startsWith("/api/")&&(ce.url=ce.url.replace("/api/","/")),ce}catch(Se){console.error("Authentication error:",Se),cf("/login")}return ce},ce=>Promise.reject(ce)),Be.interceptors.response.use(ce=>ce,ce=>(ce.response&&ce.response.status===401&&(localStorage.removeItem("token"),cf("/login")),Promise.reject(ce)));const H=async()=>{var ce,de,Se;try{_(!0);const[Oe,Ue,Tt]=await Promise.all([Be.get("/firewalls/firewall-types/"),Be.get("/datacenters/"),Be.get("/firewalls/")]),st=Array.isArray((ce=Oe.data)==null?void 0:ce.results)?Oe.data.results:[],Xe=Array.isArray((de=Ue.data)==null?void 0:de.results)?Ue.data.results:[],Ke=Array.isArray((Se=Tt.data)==null?void 0:Se.results)?Tt.data.results:[],ct=Xe.map(at=>({id:at.id,name:at.name,description:at.description||"",location:at.location||"",latitude:at.latitude?parseFloat(at.latitude):null,longitude:at.longitude?parseFloat(at.longitude):null,owner:at.owner||"",owner_username:at.owner_username||"",created_at:at.created_at,updated_at:at.updated_at,is_active:at.is_active,firewall_count:at.firewall_count||0,firewall_type_count:at.firewall_type_count||0,firewalls:Ke.filter(Q=>{var ge;return((ge=Q.data_center)==null?void 0:ge.id)===at.id}),firewall_types:st.filter(Q=>Q.data_center===at.id)}));t(ct);const dt=localStorage.getItem("selectedFirewallId"),cr=localStorage.getItem("firewallType"),At=localStorage.getItem("dataCenter");if(dt){const at=Ke.find(Q=>Q.id===dt);at&&(k(at),w(Q=>({...Q,ipAddress:at.ip_address})))}cr&&I(cr),At&&P(At)}catch{alert("Erreur lors du chargement des donnes. Veuillez rafrachir la page.")}finally{_(!1)}};A.useEffect(()=>{H()},[]);const Ye=async()=>{await H()},nt=ce=>{n(de=>de.includes(ce)?de.filter(Se=>Se!==ce):[...de,ce])},it=ce=>{i(de=>de.includes(ce)?de.filter(Se=>Se!==ce):[...de,ce])},Ze=async()=>{var ce,de,Se,Oe,Ue,Tt,st,Xe,Ke,ct;if(o.name)try{let dt=null,cr=null;if(o.latitude){const Q=parseFloat(o.latitude);if(!isNaN(Q)&&Q>=-90&&Q<=90)dt=Number(Q.toFixed(6));else{alert("La latitude doit tre comprise entre -90 et 90 degrs");return}}if(o.longitude){const Q=parseFloat(o.longitude);if(!isNaN(Q)&&Q>=-180&&Q<=180)cr=Number(Q.toFixed(6));else{alert("La longitude doit tre comprise entre -180 et 180 degrs");return}}const At={name:o.name.trim(),description:o.description.trim()||null,location:o.location.trim()||null,latitude:dt,longitude:cr,is_active:!0};if(At.latitude!==null&&At.longitude===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(At.latitude===null&&At.longitude!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}console.log("Sending data to API:",At);const at=await Be.post("/datacenters/",At);console.log("API Response:",at.data),l({name:"",description:"",location:"",latitude:"",longitude:""}),await Ye()}catch(dt){if(console.error("Error creating data center:",dt),console.error("Error response:",(ce=dt.response)==null?void 0:ce.data),(Se=(de=dt.response)==null?void 0:de.data)!=null&&Se.longitude)alert(`Erreur de longitude: ${dt.response.data.longitude[0]}`);else if((Ue=(Oe=dt.response)==null?void 0:Oe.data)!=null&&Ue.latitude)alert(`Erreur de latitude: ${dt.response.data.latitude[0]}`);else{const cr=((st=(Tt=dt.response)==null?void 0:Tt.data)==null?void 0:st.detail)||((ct=(Ke=(Xe=dt.response)==null?void 0:Xe.data)==null?void 0:Ke.non_field_errors)==null?void 0:ct[0])||"Erreur lors de la cration du datacenter. Veuillez ressayer.";alert(cr)}}else alert("Le nom du datacenter est requis")},Ae=async ce=>{var Oe,Ue,Tt,st,Xe,Ke;const{name:de,description:Se}=u;if(de)try{const ct=Object.entries(g).filter(([At,at])=>at).map(([At])=>At),dt={name:de,description:Se||"",data_center:ce,attributes_schema:{type:"object",properties:ct.reduce((At,at)=>{const Q=d.find(ge=>ge.name===at);return Q&&(At[at]={type:"string",title:Q.label,required:Q.required}),At},{}),required:ct.filter(At=>{const at=d.find(Q=>Q.name===At);return at==null?void 0:at.required})}};console.log("Creating firewall type with data:",dt);const cr=await Be.post("/firewalls/firewall-types/",dt,{headers:{"Content-Type":"application/json",Accept:"application/json"}});console.log("Firewall type created successfully:",cr.data),f({name:"",description:""}),v(d.reduce((At,at)=>({...At,[at.name]:!1}),{})),await Ye()}catch(ct){console.error("Error creating firewall type:",ct),console.error("Error response:",(Oe=ct.response)==null?void 0:Oe.data);const dt=((Tt=(Ue=ct.response)==null?void 0:Ue.data)==null?void 0:Tt.detail)||((Ke=(Xe=(st=ct.response)==null?void 0:st.data)==null?void 0:Xe.owner)==null?void 0:Ke[0])||"Erreur lors de la cration du type de pare-feu.";alert(dt)}},Et=async ce=>{var de,Se;try{await Be.delete(`/datacenters/${ce}/`),await Ye()}catch(Oe){console.error("Error deleting data center:",Oe);const Ue=((Se=(de=Oe.response)==null?void 0:de.data)==null?void 0:Se.detail)||"Erreur lors de la suppression du datacenter.";alert(Ue)}},pe=async ce=>{var de,Se;if(window.confirm("tes-vous sr de vouloir supprimer ce type de pare-feu ?"))try{await Be.delete(`/firewalls/firewall-types/${ce}/`),await Ye()}catch(Oe){console.error("Error deleting firewall type:",Oe);const Ue=((Se=(de=Oe.response)==null?void 0:de.data)==null?void 0:Se.detail)||"Erreur lors de la suppression du type de pare-feu.";alert(Ue)}},Pe=A.useCallback(ce=>{ce.preventDefault(),z(!0)},[]),Fe=A.useCallback(ce=>{ce.preventDefault(),z(!1)},[]),Ve=A.useCallback(async(ce,de)=>{var Ue,Tt;ce.preventDefault(),z(!1),K(null),B(0);const Oe=Array.from(ce.dataTransfer.files).filter(st=>st.type==="text/csv"||st.name.endsWith(".csv"));if(Oe.length===0){K("Veuillez dposer uniquement des fichiers CSV");return}for(const st of Oe)try{const Xe=new FormData;Xe.append("file",st),Xe.append("firewall_type",de);const Ke=await Be.post("/api/firewalls/upload-csv/",Xe,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:ct=>{const dt=ct.total?Math.round(ct.loaded*100/ct.total):0;B(dt)}});if(Ke.data.success)xe(`Fichier tlcharg avec succs. ${Ke.data.created_count} pare-feu(s) cr(s).`),K(null),await Ye();else{const ct=Ke.data.error||"Erreur lors du tlchargement",dt=Ke.data.errors||[];K(`${ct}
${dt.join(`
`)}`)}}catch(Xe){console.error("Error uploading CSV:",Xe);const Ke=((Tt=(Ue=Xe.response)==null?void 0:Ue.data)==null?void 0:Tt.error)||"Erreur lors du tlchargement du fichier";K(Ke)}},[Ye]),pt=ce=>{me(ce),Y(!0)},ut=async()=>{var ce,de,Se,Oe,Ue,Tt,st;if(he)try{let Xe=he.latitude,Ke=he.longitude;if(Xe!==null&&(Xe<-90||Xe>90)){alert("La latitude doit tre comprise entre -90 et 90 degrs");return}if(Ke!==null&&(Ke<-180||Ke>180)){alert("La longitude doit tre comprise entre -180 et 180 degrs");return}if(Xe!==null&&Ke===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(Xe===null&&Ke!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}const ct={name:he.name.trim(),description:((ce=he.description)==null?void 0:ce.trim())||null,location:((de=he.location)==null?void 0:de.trim())||null,latitude:Xe,longitude:Ke,is_active:he.is_active};await Be.put(`/datacenters/${he.id}/`,ct),Y(!1),me(null),await Ye()}catch(Xe){console.error("Error updating data center:",Xe);const Ke=((Oe=(Se=Xe.response)==null?void 0:Se.data)==null?void 0:Oe.detail)||((st=(Tt=(Ue=Xe.response)==null?void 0:Ue.data)==null?void 0:Tt.non_field_errors)==null?void 0:st[0])||"Erreur lors de la mise  jour du datacenter.";alert(Ke)}},St=ce=>{ye(ce),J(!0)},jt=async()=>{var ce,de,Se,Oe,Ue,Tt;if(se)try{const st=Object.entries(g).filter(([Ke,ct])=>ct).map(([Ke])=>Ke),Xe={name:se.name.trim(),description:((ce=se.description)==null?void 0:ce.trim())||"",data_center:se.data_center,attributes_schema:{type:"object",properties:st.reduce((Ke,ct)=>{const dt=d.find(cr=>cr.name===ct);return dt&&(Ke[ct]={type:"string",title:dt.label,required:dt.required}),Ke},{}),required:st.filter(Ke=>{const ct=d.find(dt=>dt.name===Ke);return ct==null?void 0:ct.required})}};await Be.put(`/firewalls/firewall-types/${se.id}/`,Xe),J(!1),ye(null),await Ye()}catch(st){console.error("Error updating firewall type:",st);const Xe=((Se=(de=st.response)==null?void 0:de.data)==null?void 0:Se.detail)||((Tt=(Ue=(Oe=st.response)==null?void 0:Oe.data)==null?void 0:Ue.non_field_errors)==null?void 0:Tt[0])||"Erreur lors de la mise  jour du type de pare-feu.";alert(Xe)}},Xt=async ce=>{var de,Se;if(!q.name||!q.ip_address){alert("Le nom et l'adresse IP sont requis");return}try{const Oe=e.flatMap(Ke=>Ke.firewall_types).find(Ke=>Ke.id===ce);if(!Oe)throw new Error("Type de firewall non trouv");let Ue;const Tt=localStorage.getItem("userData");if(Tt?Ue=JSON.parse(Tt).id:Ue=(await Be.get("/auth/users/me/")).data.id,!Ue)throw new Error("Impossible de rcuprer l'ID de l'utilisateur");const st={name:q.name.trim(),ip_address:q.ip_address.trim(),firewall_type:ce,data_center:Oe.data_center,owner:Ue};console.log("Sending data to API:",st);const Xe=await Be.post("/firewalls/firewalls/",st);console.log("API Response:",Xe.data),Z({name:"",ip_address:"",firewall_type:""}),we(!1),await Ye()}catch(Oe){console.error("Error creating firewall:",Oe),console.error("Error response:",(de=Oe.response)==null?void 0:de.data);let Ue="Erreur lors de la cration du pare-feu.";(Se=Oe.response)!=null&&Se.data&&(typeof Oe.response.data=="object"?Ue=`Erreurs de validation:
${Object.entries(Oe.response.data).map(([st,Xe])=>`${st}: ${Array.isArray(Xe)?Xe.join(", "):Xe}`).join(`
`)}`:typeof Oe.response.data=="string"?Ue=Oe.response.data:Oe.response.data.detail&&(Ue=Oe.response.data.detail)),alert(Ue)}},bt=async ce=>{var de,Se;if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await Be.delete(`/firewalls/${ce}/`),await Ye()}catch(Oe){console.error("Error deleting firewall:",Oe);const Ue=((Se=(de=Oe.response)==null?void 0:de.data)==null?void 0:Se.detail)||"Erreur lors de la suppression du pare-feu.";alert(Ue)}},Ut=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Liste des Datacenters et Types de Firewall"}),p.jsx("div",{className:"space-y-4",children:e.map(ce=>{var de;return p.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[p.jsxs("div",{className:"bg-gray-50 p-4 flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:ce.name}),p.jsx("p",{className:"text-sm text-gray-500",children:ce.location})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("button",{onClick:()=>pt(ce),className:"px-3 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-2",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),p.jsxs("button",{onClick:()=>Et(ce.id),className:"px-3 py-1.5 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-2",children:[p.jsx(Pn,{className:"h-4 w-4"}),"Supprimer"]})]})]}),p.jsxs("div",{className:"p-4",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Types de Firewall"}),p.jsx("div",{className:"space-y-3",children:(de=ce.firewall_types)==null?void 0:de.map(Se=>{var Oe;return p.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-gray-900",children:Se.name}),p.jsx("p",{className:"text-sm text-gray-500",children:Se.description}),p.jsxs("div",{className:"mt-2",children:[p.jsx("p",{className:"text-xs text-gray-500",children:"Attributs configurs:"}),p.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:((Oe=Se.attributes_schema)==null?void 0:Oe.properties)&&Object.entries(Se.attributes_schema.properties).sort(([Ue],[Tt])=>{const st=qx.indexOf(Ue),Xe=qx.indexOf(Tt);return st===-1?1:Xe===-1?-1:st-Xe}).map(([Ue,Tt])=>p.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:Ue},Ue))})]})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("button",{onClick:()=>{be(Se.id),we(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[p.jsx(Js,{className:"h-3 w-3"}),"Ajouter Firewall"]}),p.jsxs("button",{onClick:()=>St(Se),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),p.jsxs("button",{onClick:()=>pe(Se.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[p.jsx(Pn,{className:"h-3 w-3"}),"Supprimer"]})]})]})},Se.id)})})]})]},ce.id)})})]}),He=(ce,de)=>{var Se;return p.jsxs("div",{className:"ml-6 mb-4",children:[p.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-md",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:()=>it(de.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:a.includes(de.id)?p.jsx(uf,{size:20}):p.jsx(vh,{size:20})}),p.jsx("span",{className:"font-medium",children:de.name})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("button",{onClick:()=>{be(de.id),we(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[p.jsx(Js,{className:"h-3 w-3"}),"Ajouter Firewall"]}),p.jsxs("button",{onClick:()=>St(de),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),p.jsxs("button",{onClick:()=>pe(de.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[p.jsx(Pn,{className:"h-3 w-3"}),"Supprimer"]})]})]}),a.includes(de.id)&&p.jsxs("div",{className:"mt-2 p-4 bg-white rounded-md shadow",children:[p.jsxs("div",{className:"mb-4",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pare-feu existants"}),p.jsx("div",{className:"space-y-2",children:(Se=de.firewalls)==null?void 0:Se.map(Oe=>p.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-gray-900",children:Oe.name}),p.jsx("p",{className:"text-sm text-gray-500",children:Oe.ip_address})]}),p.jsx("button",{onClick:()=>bt(Oe.id),className:"text-red-500 hover:text-red-700",children:p.jsx(Pn,{className:"h-4 w-4"})})]},Oe.id))})]}),p.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center ${V?"border-purple-500 bg-purple-50":"border-gray-300"}`,onDragOver:Pe,onDragLeave:Fe,onDrop:Oe=>Ve(Oe,de.id),children:[p.jsx(f2,{className:"mx-auto h-12 w-12 text-gray-400"}),p.jsxs("div",{className:"mt-4",children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Glissez et dposez vos fichiers CSV ici"}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ou cliquez pour slectionner des fichiers"})]}),W!==null&&p.jsxs("div",{className:"mt-4",children:[p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:p.jsx("div",{className:"bg-purple-600 h-2.5 rounded-full",style:{width:`${W}%`}})}),p.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Progression: ",W,"%"]})]}),G&&p.jsx("p",{className:"text-red-500 text-sm mt-2",children:G})]})]})]},de.id)};return A.useEffect(()=>{(async()=>{try{const Se=(await Bs.getVariables()).map(Oe=>({name:Oe.name,label:Oe.name,required:!1}));m(Se),v(Se.reduce((Oe,Ue)=>({...Oe,[Ue.name]:!1}),{}))}catch(de){console.error("Error loading variables:",de)}})()},[]),p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Paramtres CMS"}),p.jsx("p",{className:"text-gray-600",children:"Grez la structure des data centers et leurs types de firewalls"})]}),p.jsxs("button",{onClick:Ye,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Rafrachir"]})]}),y?p.jsx("div",{className:"flex justify-center items-center h-64",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):p.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[Ut(),p.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Structure"}),p.jsx("div",{className:"mb-6 p-4 border border-dashed border-gray-300 rounded-lg",children:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"text",placeholder:"Nom du Data Center *",value:o.name,onChange:ce=>l(de=>({...de,name:ce.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",required:!0}),p.jsx("button",{onClick:Ze,className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:p.jsx(Js,{className:"w-4 h-4"})})]}),p.jsx("textarea",{placeholder:"Description",value:o.description,onChange:ce=>l(de=>({...de,description:ce.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),p.jsx("input",{type:"text",placeholder:"Adresse physique",value:o.location,onChange:ce=>l(de=>({...de,location:ce.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm"}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("div",{children:[p.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude (-90  90)",value:o.latitude,onChange:ce=>{const de=ce.target.value;(de===""||parseFloat(de)>=-90&&parseFloat(de)<=90)&&l(Se=>({...Se,latitude:de}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: 33.552084"})]}),p.jsxs("div",{children:[p.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude (-180  180)",value:o.longitude,onChange:ce=>{const de=ce.target.value;(de===""||parseFloat(de)>=-180&&parseFloat(de)<=180)&&l(Se=>({...Se,longitude:de}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: -7.657616"})]})]})]})}),p.jsx("div",{className:"space-y-2",children:Array.isArray(e)&&e.map(ce=>{var de;return p.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[p.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-t-lg",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:()=>nt(ce.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:r.includes(ce.id)?p.jsx(uf,{className:"w-4 h-4"}):p.jsx(vh,{className:"w-4 h-4"})}),p.jsx("span",{className:"font-medium",children:ce.name})]}),p.jsx("button",{onClick:()=>Et(ce.id),className:"text-red-500 hover:text-red-700",children:p.jsx(Pn,{className:"w-4 h-4"})})]}),r.includes(ce.id)&&p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsx("div",{className:"p-4 border border-dashed border-gray-300 rounded-lg",children:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"text",placeholder:"Nom du type de pare-feu",value:u.name,onChange:Se=>f(Oe=>({...Oe,name:Se.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm"}),p.jsx("button",{onClick:()=>Ae(ce.id),className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:p.jsx(Js,{className:"w-4 h-4"})})]}),p.jsx("textarea",{placeholder:"Description",value:u.description,onChange:Se=>f(Oe=>({...Oe,description:Se.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(Se=>p.jsxs("label",{className:"flex items-center space-x-2",children:[p.jsx("input",{type:"checkbox",checked:g[Se.name],onChange:Oe=>v(Ue=>({...Ue,[Se.name]:Oe.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),p.jsx("span",{className:"text-sm text-gray-700",children:Se.label})]},Se.name))})]})}),p.jsx("div",{className:"space-y-2",children:(de=ce.firewall_types)==null?void 0:de.map(Se=>He(ce,Se))})]})]},ce.id)})})]})})})]}),ae&&he&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Data Center"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),p.jsx("input",{type:"text",value:he.name,onChange:ce=>me(de=>de?{...de,name:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),p.jsx("textarea",{value:he.description||"",onChange:ce=>me(de=>de?{...de,description:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse physique"}),p.jsx("input",{type:"text",value:he.location||"",onChange:ce=>me(de=>de?{...de,location:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm"})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude (-90  90)"}),p.jsx("input",{type:"number",step:"0.000001",value:he.latitude||"",onChange:ce=>{const de=ce.target.value===""?null:parseFloat(ce.target.value);(de===null||de>=-90&&de<=90)&&me(Se=>Se?{...Se,latitude:de}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude (-180  180)"}),p.jsx("input",{type:"number",step:"0.000001",value:he.longitude||"",onChange:ce=>{const de=ce.target.value===""?null:parseFloat(ce.target.value);(de===null||de>=-180&&de<=180)&&me(Se=>Se?{...Se,longitude:de}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"})]})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx("input",{type:"checkbox",checked:he.is_active,onChange:ce=>me(de=>de?{...de,is_active:ce.target.checked}:null),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),p.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Actif"})]})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx("button",{onClick:()=>{Y(!1),me(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),p.jsx("button",{onClick:ut,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),R&&se&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Type de Pare-feu"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),p.jsx("input",{type:"text",value:se.name,onChange:ce=>ye(de=>de?{...de,name:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),p.jsx("textarea",{value:se.description||"",onChange:ce=>ye(de=>de?{...de,description:ce.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attributs de configuration"}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(ce=>p.jsxs("label",{className:"flex items-center space-x-2",children:[p.jsx("input",{type:"checkbox",checked:g[ce.name],onChange:de=>v(Se=>({...Se,[ce.name]:de.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),p.jsx("span",{className:"text-sm text-gray-700",children:ce.label})]},ce.name))})]})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx("button",{onClick:()=>{J(!1),ye(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),p.jsx("button",{onClick:jt,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),ne&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ajouter un Pare-feu"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),p.jsx("input",{type:"text",value:q.name,onChange:ce=>Z(de=>({...de,name:ce.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP *"}),p.jsx("input",{type:"text",value:q.ip_address,onChange:ce=>Z(de=>({...de,ip_address:ce.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0,placeholder:"Ex: 192.168.1.1"})]})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx("button",{onClick:()=>{we(!1),Z({name:"",ip_address:"",firewall_type:""})},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),p.jsx("button",{onClick:()=>Xt(Le),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Ajouter"})]})]})})]})}const Xi=$e.create({baseURL:Wt});Xi.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Xi.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));const Yx={getFirewalls:async()=>{try{return(await Xi.get("/firewalls/firewalls/")).data.results||[]}catch(e){throw e}},getFirewall:async e=>{try{return(await Xi.get(`/firewalls/firewalls/${e}/`)).data}catch(t){throw t}},createFirewall:async e=>{try{return(await Xi.post("/firewalls/firewalls/",e)).data}catch(t){throw t}},updateFirewall:async(e,t)=>{try{return(await Xi.put(`/firewalls/firewalls/${e}/`,t)).data}catch(r){throw r}},deleteFirewall:async e=>{try{await Xi.delete(`/firewalls/firewalls/${e}/`)}catch(t){throw t}}},Kx=()=>{const[e,t]=A.useState([]),[r,n]=A.useState([]),[a,i]=A.useState(""),[o,l]=A.useState(!0),[u,f]=A.useState(null),[d,m]=A.useState(0);A.useEffect(()=>{(async()=>{try{l(!0);const _=await Yx.getFirewalls(),S=Array.isArray(_)?_:_.results||[];t(S),n(S),f(null)}catch(_){f(`Erreur lors de la rcupration des pare-feux: ${_.message||"Erreur inconnue"}`)}finally{l(!1)}})()},[d]),A.useEffect(()=>{if(!a.trim()){n(e);return}const y=a.toLowerCase().trim(),_=e.filter(S=>S.name.toLowerCase().includes(y)||S.ip_address.toLowerCase().includes(y));n(_)},[a,e]);const g=()=>{m(y=>y+1)},v=async y=>{if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await Yx.deleteFirewall(y),t(e.filter(_=>_.id!==y))}catch{f("Erreur lors de la suppression du pare-feu")}};return o?p.jsx("div",{className:"flex items-center justify-center h-screen",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Liste des Pare-feux"}),p.jsx("p",{className:"text-gray-600",children:"Grez vos pare-feux et leurs configurations"})]}),p.jsxs("button",{onClick:g,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[p.jsx(sb,{className:"w-4 h-4"}),"Rafrachir"]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(ob,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Rechercher par nom ou adresse IP...",value:a,onChange:y=>i(y.target.value)})]}),a&&p.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:[r.length," pare-feu",r.length!==1?"x":""," trouv",r.length!==1?"s":""]})]}),u&&p.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md",children:u}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(y=>{var _;return p.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200",children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex items-start justify-between",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx(ds,{className:"h-8 w-8 text-purple-600 mr-3"}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:y.name}),p.jsx("p",{className:"text-gray-500 text-sm",children:y.ip_address})]})]}),p.jsx("div",{className:"flex space-x-2",children:p.jsx("button",{onClick:()=>v(y.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors duration-200",children:p.jsx(Pn,{className:"h-5 w-5"})})})]}),p.jsxs("div",{className:"mt-4 space-y-3",children:[p.jsxs("div",{className:"flex items-center text-gray-600",children:[p.jsx(mc,{className:"h-5 w-5 mr-2"}),p.jsxs("span",{children:["Data Center: ",((_=y.data_center_info)==null?void 0:_.name)||"N/A"]})]}),p.jsxs("div",{className:"flex items-center text-gray-600",children:[p.jsx(gc,{className:"h-5 w-5 mr-2"}),p.jsxs("span",{children:["Type: ",typeof y.firewall_type=="object"&&y.firewall_type?y.firewall_type.name:"N/A"]})]})]})]})},y.id)})}),r.length===0&&!o&&p.jsxs("div",{className:"text-center py-12",children:[p.jsx(ds,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Aucun rsultat trouv":"Aucun pare-feu trouv"}),p.jsx("p",{className:"text-gray-500 mt-2",children:a?"Essayez de modifier votre recherche":"Commencez par ajouter un nouveau pare-feu."})]})]})};function vm(e,t){const r=A.useRef(t);A.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function kM(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const Kw=1;function Jw(e){return Object.freeze({__version:Kw,map:e})}function _m(e,t){return Object.freeze({...e,...t})}const ym=A.createContext(null),wm=ym.Provider;function Mo(){const e=A.useContext(ym);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function km(e){function t(r,n){const{instance:a,context:i}=e(r).current;return A.useImperativeHandle(n,()=>a),r.children==null?null:ho.createElement(wm,{value:i},r.children)}return A.forwardRef(t)}function Qw(e){function t(r,n){const[a,i]=A.useState(!1),{instance:o}=e(r,i).current;A.useImperativeHandle(n,()=>o),A.useEffect(function(){a&&o.update()},[o,a,r.children]);const l=o._contentNode;return l?Ey.createPortal(r.children,l):null}return A.forwardRef(t)}function Em(e){function t(r,n){const{instance:a}=e(r).current;return A.useImperativeHandle(n,()=>a),null}return A.forwardRef(t)}function ek(e){return function(r){const n=Mo(),a=e(r,n),{instance:i}=a.current,o=A.useRef(r.position),{position:l}=r;return A.useEffect(function(){return i.addTo(n.map),function(){i.remove()}},[n.map,i]),A.useEffect(function(){l!=null&&l!==o.current&&(i.setPosition(l),o.current=l)},[i,l]),a}}function r0(e,t){const r=A.useRef();A.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function Sc(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function tk(e,t){return function(n,a){const i=Mo(),o=e(Sc(n,i),i);return vm(i.map,n.attribution),r0(o.current,n.eventHandlers),t(o.current,i,n,a),o}}var Rh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(bi,function(r){var n="1.9.4";function a(s){var c,h,x,T;for(h=1,x=arguments.length;h<x;h++){T=arguments[h];for(c in T)s[c]=T[c]}return s}var i=Object.create||function(){function s(){}return function(c){return s.prototype=c,new s}}();function o(s,c){var h=Array.prototype.slice;if(s.bind)return s.bind.apply(s,h.call(arguments,1));var x=h.call(arguments,2);return function(){return s.apply(c,x.length?x.concat(h.call(arguments)):arguments)}}var l=0;function u(s){return"_leaflet_id"in s||(s._leaflet_id=++l),s._leaflet_id}function f(s,c,h){var x,T,b,X;return X=function(){x=!1,T&&(b.apply(h,T),T=!1)},b=function(){x?T=arguments:(s.apply(h,arguments),setTimeout(X,c),x=!0)},b}function d(s,c,h){var x=c[1],T=c[0],b=x-T;return s===x&&h?s:((s-T)%b+b)%b+T}function m(){return!1}function g(s,c){if(c===!1)return s;var h=Math.pow(10,c===void 0?6:c);return Math.round(s*h)/h}function v(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function y(s){return v(s).split(/\s+/)}function _(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?i(s.options):{});for(var h in c)s.options[h]=c[h];return s.options}function S(s,c,h){var x=[];for(var T in s)x.push(encodeURIComponent(h?T.toUpperCase():T)+"="+encodeURIComponent(s[T]));return(!c||c.indexOf("?")===-1?"?":"&")+x.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function E(s,c){return s.replace(k,function(h,x){var T=c[x];if(T===void 0)throw new Error("No value provided for variable "+h);return typeof T=="function"&&(T=T(c)),T})}var w=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function N(s,c){for(var h=0;h<s.length;h++)if(s[h]===c)return h;return-1}var I="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function D(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var P=0;function V(s){var c=+new Date,h=Math.max(0,16-(c-P));return P=c+h,window.setTimeout(s,h)}var z=window.requestAnimationFrame||D("RequestAnimationFrame")||V,W=window.cancelAnimationFrame||D("CancelAnimationFrame")||D("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function B(s,c,h){if(h&&z===V)s.call(c);else return z.call(window,o(s,c))}function G(s){s&&W.call(window,s)}var K={__proto__:null,extend:a,create:i,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:d,falseFn:m,formatNum:g,trim:v,splitWords:y,setOptions:_,getParamString:S,template:E,isArray:w,indexOf:N,emptyImageUrl:I,requestFn:z,cancelFn:W,requestAnimFrame:B,cancelAnimFrame:G};function ve(){}ve.extend=function(s){var c=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,x=i(h);x.constructor=c,c.prototype=x;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return s.statics&&a(c,s.statics),s.includes&&(xe(s.includes),a.apply(null,[x].concat(s.includes))),a(x,s),delete x.statics,delete x.includes,x.options&&(x.options=h.options?i(h.options):{},a(x.options,s.options)),x._initHooks=[],x.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var b=0,X=x._initHooks.length;b<X;b++)x._initHooks[b].call(this)}},c},ve.include=function(s){var c=this.prototype.options;return a(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},ve.mergeOptions=function(s){return a(this.prototype.options,s),this},ve.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),h=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function xe(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=w(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var he={on:function(s,c,h){if(typeof s=="object")for(var x in s)this._on(x,s[x],c);else{s=y(s);for(var T=0,b=s.length;T<b;T++)this._on(s[T],c,h)}return this},off:function(s,c,h){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var x in s)this._off(x,s[x],c);else{s=y(s);for(var T=arguments.length===1,b=0,X=s.length;b<X;b++)T?this._off(s[b]):this._off(s[b],c,h)}return this},_on:function(s,c,h,x){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,h)===!1){h===this&&(h=void 0);var T={fn:c,ctx:h};x&&(T.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(T)}},_off:function(s,c,h){var x,T,b;if(this._events&&(x=this._events[s],!!x)){if(arguments.length===1){if(this._firingCount)for(T=0,b=x.length;T<b;T++)x[T].fn=m;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var X=this._listens(s,c,h);if(X!==!1){var te=x[X];this._firingCount&&(te.fn=m,this._events[s]=x=x.slice()),x.splice(X,1)}}},fire:function(s,c,h){if(!this.listens(s,h))return this;var x=a({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[s];if(T){this._firingCount=this._firingCount+1||1;for(var b=0,X=T.length;b<X;b++){var te=T[b],le=te.fn;te.once&&this.off(s,le,te.ctx),le.call(te.ctx||this,x)}this._firingCount--}}return h&&this._propagateEvent(x),this},listens:function(s,c,h,x){typeof s!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(x=!!c,T=void 0,h=void 0);var b=this._events&&this._events[s];if(b&&b.length&&this._listens(s,T,h)!==!1)return!0;if(x){for(var X in this._eventParents)if(this._eventParents[X].listens(s,c,h,x))return!0}return!1},_listens:function(s,c,h){if(!this._events)return!1;var x=this._events[s]||[];if(!c)return!!x.length;h===this&&(h=void 0);for(var T=0,b=x.length;T<b;T++)if(x[T].fn===c&&x[T].ctx===h)return T;return!1},once:function(s,c,h){if(typeof s=="object")for(var x in s)this._on(x,s[x],c,!0);else{s=y(s);for(var T=0,b=s.length;T<b;T++)this._on(s[T],c,h,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[u(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[u(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,a({layer:s.target,propagatedFrom:s.target},s),!0)}};he.addEventListener=he.on,he.removeEventListener=he.clearAllEventListeners=he.off,he.addOneTimeEventListener=he.once,he.fireEvent=he.fire,he.hasEventListeners=he.listens;var me=ve.extend(he);function ae(s,c,h){this.x=h?Math.round(s):s,this.y=h?Math.round(c):c}var Y=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};ae.prototype={clone:function(){return new ae(this.x,this.y)},add:function(s){return this.clone()._add(se(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(se(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new ae(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new ae(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Y(this.x),this.y=Y(this.y),this},distanceTo:function(s){s=se(s);var c=s.x-this.x,h=s.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(s){return s=se(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=se(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function se(s,c,h){return s instanceof ae?s:w(s)?new ae(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new ae(s.x,s.y):new ae(s,c,h)}function ye(s,c){if(s)for(var h=c?[s,c]:s,x=0,T=h.length;x<T;x++)this.extend(h[x])}ye.prototype={extend:function(s){var c,h;if(!s)return this;if(s instanceof ae||typeof s[0]=="number"||"x"in s)c=h=se(s);else if(s=R(s),c=s.min,h=s.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(s){return se((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return se(this.min.x,this.max.y)},getTopRight:function(){return se(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,h;return typeof s[0]=="number"||s instanceof ae?s=se(s):s=R(s),s instanceof ye?(c=s.min,h=s.max):c=h=s,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(s){s=R(s);var c=this.min,h=this.max,x=s.min,T=s.max,b=T.x>=c.x&&x.x<=h.x,X=T.y>=c.y&&x.y<=h.y;return b&&X},overlaps:function(s){s=R(s);var c=this.min,h=this.max,x=s.min,T=s.max,b=T.x>c.x&&x.x<h.x,X=T.y>c.y&&x.y<h.y;return b&&X},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,h=this.max,x=Math.abs(c.x-h.x)*s,T=Math.abs(c.y-h.y)*s;return R(se(c.x-x,c.y-T),se(h.x+x,h.y+T))},equals:function(s){return s?(s=R(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function R(s,c){return!s||s instanceof ye?s:new ye(s,c)}function J(s,c){if(s)for(var h=c?[s,c]:s,x=0,T=h.length;x<T;x++)this.extend(h[x])}J.prototype={extend:function(s){var c=this._southWest,h=this._northEast,x,T;if(s instanceof Z)x=s,T=s;else if(s instanceof J){if(x=s._southWest,T=s._northEast,!x||!T)return this}else return s?this.extend(ne(s)||q(s)):this;return!c&&!h?(this._southWest=new Z(x.lat,x.lng),this._northEast=new Z(T.lat,T.lng)):(c.lat=Math.min(x.lat,c.lat),c.lng=Math.min(x.lng,c.lng),h.lat=Math.max(T.lat,h.lat),h.lng=Math.max(T.lng,h.lng)),this},pad:function(s){var c=this._southWest,h=this._northEast,x=Math.abs(c.lat-h.lat)*s,T=Math.abs(c.lng-h.lng)*s;return new J(new Z(c.lat-x,c.lng-T),new Z(h.lat+x,h.lng+T))},getCenter:function(){return new Z((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Z(this.getNorth(),this.getWest())},getSouthEast:function(){return new Z(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Z||"lat"in s?s=ne(s):s=q(s);var c=this._southWest,h=this._northEast,x,T;return s instanceof J?(x=s.getSouthWest(),T=s.getNorthEast()):x=T=s,x.lat>=c.lat&&T.lat<=h.lat&&x.lng>=c.lng&&T.lng<=h.lng},intersects:function(s){s=q(s);var c=this._southWest,h=this._northEast,x=s.getSouthWest(),T=s.getNorthEast(),b=T.lat>=c.lat&&x.lat<=h.lat,X=T.lng>=c.lng&&x.lng<=h.lng;return b&&X},overlaps:function(s){s=q(s);var c=this._southWest,h=this._northEast,x=s.getSouthWest(),T=s.getNorthEast(),b=T.lat>c.lat&&x.lat<h.lat,X=T.lng>c.lng&&x.lng<h.lng;return b&&X},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=q(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function q(s,c){return s instanceof J?s:new J(s,c)}function Z(s,c,h){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,h!==void 0&&(this.alt=+h)}Z.prototype={equals:function(s,c){if(!s)return!1;s=ne(s);var h=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return h<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+g(this.lat,s)+", "+g(this.lng,s)+")"},distanceTo:function(s){return Le.distance(this,ne(s))},wrap:function(){return Le.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,h=c/Math.cos(Math.PI/180*this.lat);return q([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new Z(this.lat,this.lng,this.alt)}};function ne(s,c,h){return s instanceof Z?s:w(s)&&typeof s[0]!="object"?s.length===3?new Z(s[0],s[1],s[2]):s.length===2?new Z(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Z(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new Z(s,c,h)}var we={latLngToPoint:function(s,c){var h=this.projection.project(s),x=this.scale(c);return this.transformation._transform(h,x)},pointToLatLng:function(s,c){var h=this.scale(c),x=this.transformation.untransform(s,h);return this.projection.unproject(x)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(s),x=this.transformation.transform(c.min,h),T=this.transformation.transform(c.max,h);return new ye(x,T)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?d(s.lng,this.wrapLng,!0):s.lng,h=this.wrapLat?d(s.lat,this.wrapLat,!0):s.lat,x=s.alt;return new Z(h,c,x)},wrapLatLngBounds:function(s){var c=s.getCenter(),h=this.wrapLatLng(c),x=c.lat-h.lat,T=c.lng-h.lng;if(x===0&&T===0)return s;var b=s.getSouthWest(),X=s.getNorthEast(),te=new Z(b.lat-x,b.lng-T),le=new Z(X.lat-x,X.lng-T);return new J(te,le)}},Le=a({},we,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var h=Math.PI/180,x=s.lat*h,T=c.lat*h,b=Math.sin((c.lat-s.lat)*h/2),X=Math.sin((c.lng-s.lng)*h/2),te=b*b+Math.cos(x)*Math.cos(T)*X*X,le=2*Math.atan2(Math.sqrt(te),Math.sqrt(1-te));return this.R*le}}),be=6378137,_e={R:be,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,h=this.MAX_LATITUDE,x=Math.max(Math.min(h,s.lat),-h),T=Math.sin(x*c);return new ae(this.R*s.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(s){var c=180/Math.PI;return new Z((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:function(){var s=be*Math.PI;return new ye([-s,-s],[s,s])}()};function Be(s,c,h,x){if(w(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=h,this._d=x}Be.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new ae((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function H(s,c,h,x){return new Be(s,c,h,x)}var Ye=a({},Le,{code:"EPSG:3857",projection:_e,transformation:function(){var s=.5/(Math.PI*_e.R);return H(s,.5,-s,.5)}()}),nt=a({},Ye,{code:"EPSG:900913"});function it(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Ze(s,c){var h="",x,T,b,X,te,le;for(x=0,b=s.length;x<b;x++){for(te=s[x],T=0,X=te.length;T<X;T++)le=te[T],h+=(T?"L":"M")+le.x+" "+le.y;h+=c?Ie.svg?"z":"x":""}return h||"M0 0"}var Ae=document.documentElement.style,Et="ActiveXObject"in window,pe=Et&&!document.addEventListener,Pe="msLaunchUri"in navigator&&!("documentMode"in document),Fe=Nr("webkit"),Ve=Nr("android"),pt=Nr("android 2")||Nr("android 3"),ut=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),St=Ve&&Nr("Google")&&ut<537&&!("AudioNode"in window),jt=!!window.opera,Xt=!Pe&&Nr("chrome"),bt=Nr("gecko")&&!Fe&&!jt&&!Et,Ut=!Xt&&Nr("safari"),He=Nr("phantom"),ce="OTransition"in Ae,de=navigator.platform.indexOf("Win")===0,Se=Et&&"transition"in Ae,Oe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!pt,Ue="MozPerspective"in Ae,Tt=!window.L_DISABLE_3D&&(Se||Oe||Ue)&&!ce&&!He,st=typeof orientation<"u"||Nr("mobile"),Xe=st&&Fe,Ke=st&&Oe,ct=!window.PointerEvent&&window.MSPointerEvent,dt=!!(window.PointerEvent||ct),cr="ontouchstart"in window||!!window.TouchEvent,At=!window.L_NO_TOUCH&&(cr||dt),at=st&&jt,Q=st&&bt,ge=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ze=function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return s}(),ot=function(){return!!document.createElement("canvas").getContext}(),mt=!!(document.createElementNS&&it("svg").createSVGRect),Ct=!!mt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),qt=!mt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),rr=navigator.platform.indexOf("Mac")===0,ia=navigator.platform.indexOf("Linux")===0;function Nr(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Ie={ie:Et,ielt9:pe,edge:Pe,webkit:Fe,android:Ve,android23:pt,androidStock:St,opera:jt,chrome:Xt,gecko:bt,safari:Ut,phantom:He,opera12:ce,win:de,ie3d:Se,webkit3d:Oe,gecko3d:Ue,any3d:Tt,mobile:st,mobileWebkit:Xe,mobileWebkit3d:Ke,msPointer:ct,pointer:dt,touch:At,touchNative:cr,mobileOpera:at,mobileGecko:Q,retina:ge,passiveEvents:ze,canvas:ot,svg:mt,vml:qt,inlineSvg:Ct,mac:rr,linux:ia},C=Ie.msPointer?"MSPointerDown":"pointerdown",O=Ie.msPointer?"MSPointerMove":"pointermove",F=Ie.msPointer?"MSPointerUp":"pointerup",M=Ie.msPointer?"MSPointerCancel":"pointercancel",j={touchstart:C,touchmove:O,touchend:F,touchcancel:M},U={touchstart:Me,touchmove:Ce,touchend:Ce,touchcancel:Ce},ee={},fe=!1;function re(s,c,h){return c==="touchstart"&&De(),U[c]?(h=U[c].bind(this,h),s.addEventListener(j[c],h,!1),h):(console.warn("wrong event specified:",c),m)}function ie(s,c,h){if(!j[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(j[c],h,!1)}function oe(s){ee[s.pointerId]=s}function Ee(s){ee[s.pointerId]&&(ee[s.pointerId]=s)}function Ne(s){delete ee[s.pointerId]}function De(){fe||(document.addEventListener(C,oe,!0),document.addEventListener(O,Ee,!0),document.addEventListener(F,Ne,!0),document.addEventListener(M,Ne,!0),fe=!0)}function Ce(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in ee)c.touches.push(ee[h]);c.changedTouches=[c],s(c)}}function Me(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&wr(c),Ce(s,c)}function qe(s){var c={},h,x;for(x in s)h=s[x],c[x]=h&&h.bind?h.bind(s):h;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Mt=200;function Rt(s,c){s.addEventListener("dblclick",c);var h=0,x;function T(b){if(b.detail!==1){x=b.detail;return}if(!(b.pointerType==="mouse"||b.sourceCapabilities&&!b.sourceCapabilities.firesTouchEvents)){var X=Nm(b);if(!(X.some(function(le){return le instanceof HTMLLabelElement&&le.attributes.for})&&!X.some(function(le){return le instanceof HTMLInputElement||le instanceof HTMLSelectElement}))){var te=Date.now();te-h<=Mt?(x++,x===2&&c(qe(b))):x=1,h=te}}}return s.addEventListener("click",T),{dblclick:c,simDblclick:T}}function mr(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var Ca=bc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Bn=bc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ti=Bn==="webkitTransition"||Bn==="OTransition"?Bn+"End":"transitionend";function sa(s){return typeof s=="string"?document.getElementById(s):s}function ba(s,c){var h=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var x=document.defaultView.getComputedStyle(s,null);h=x?x[c]:null}return h==="auto"?null:h}function Qe(s,c,h){var x=document.createElement(s);return x.className=c||"",h&&h.appendChild(x),x}function Ht(s){var c=s.parentNode;c&&c.removeChild(s)}function Tc(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Cs(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function bs(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function a0(s,c){if(s.classList!==void 0)return s.classList.contains(c);var h=Cc(s);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function lt(s,c){if(s.classList!==void 0)for(var h=y(c),x=0,T=h.length;x<T;x++)s.classList.add(h[x]);else if(!a0(s,c)){var b=Cc(s);i0(s,(b?b+" ":"")+c)}}function Qt(s,c){s.classList!==void 0?s.classList.remove(c):i0(s,v((" "+Cc(s)+" ").replace(" "+c+" "," ")))}function i0(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function Cc(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function yn(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&wk(s,c)}function wk(s,c){var h=!1,x="DXImageTransform.Microsoft.Alpha";try{h=s.filters.item(x)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):s.style.filter+=" progid:"+x+"(opacity="+c+")"}function bc(s){for(var c=document.documentElement.style,h=0;h<s.length;h++)if(s[h]in c)return s[h];return!1}function ji(s,c,h){var x=c||new ae(0,0);s.style[Ca]=(Ie.ie3d?"translate("+x.x+"px,"+x.y+"px)":"translate3d("+x.x+"px,"+x.y+"px,0)")+(h?" scale("+h+")":"")}function nr(s,c){s._leaflet_pos=c,Ie.any3d?ji(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function Bi(s){return s._leaflet_pos||new ae(0,0)}var Io,jo,s0;if("onselectstart"in document)Io=function(){et(window,"selectstart",wr)},jo=function(){Pt(window,"selectstart",wr)};else{var Bo=bc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Io=function(){if(Bo){var s=document.documentElement.style;s0=s[Bo],s[Bo]="none"}},jo=function(){Bo&&(document.documentElement.style[Bo]=s0,s0=void 0)}}function o0(){et(window,"dragstart",wr)}function l0(){Pt(window,"dragstart",wr)}var Ac,c0;function u0(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Nc(),Ac=s,c0=s.style.outlineStyle,s.style.outlineStyle="none",et(window,"keydown",Nc))}function Nc(){Ac&&(Ac.style.outlineStyle=c0,Ac=void 0,c0=void 0,Pt(window,"keydown",Nc))}function bm(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function f0(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var kk={__proto__:null,TRANSFORM:Ca,TRANSITION:Bn,TRANSITION_END:ti,get:sa,getStyle:ba,create:Qe,remove:Ht,empty:Tc,toFront:Cs,toBack:bs,hasClass:a0,addClass:lt,removeClass:Qt,setClass:i0,getClass:Cc,setOpacity:yn,testProp:bc,setTransform:ji,setPosition:nr,getPosition:Bi,get disableTextSelection(){return Io},get enableTextSelection(){return jo},disableImageDrag:o0,enableImageDrag:l0,preventOutline:u0,restoreOutline:Nc,getSizedParentNode:bm,getScale:f0};function et(s,c,h,x){if(c&&typeof c=="object")for(var T in c)h0(s,T,c[T],h);else{c=y(c);for(var b=0,X=c.length;b<X;b++)h0(s,c[b],h,x)}return this}var oa="_leaflet_events";function Pt(s,c,h,x){if(arguments.length===1)Am(s),delete s[oa];else if(c&&typeof c=="object")for(var T in c)p0(s,T,c[T],h);else if(c=y(c),arguments.length===2)Am(s,function(te){return N(c,te)!==-1});else for(var b=0,X=c.length;b<X;b++)p0(s,c[b],h,x);return this}function Am(s,c){for(var h in s[oa]){var x=h.split(/\d/)[0];(!c||c(x))&&p0(s,x,null,null,h)}}var d0={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function h0(s,c,h,x){var T=c+u(h)+(x?"_"+u(x):"");if(s[oa]&&s[oa][T])return this;var b=function(te){return h.call(x||s,te||window.event)},X=b;!Ie.touchNative&&Ie.pointer&&c.indexOf("touch")===0?b=re(s,c,b):Ie.touch&&c==="dblclick"?b=Rt(s,b):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(d0[c]||c,b,Ie.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(b=function(te){te=te||window.event,g0(s,te)&&X(te)},s.addEventListener(d0[c],b,!1)):s.addEventListener(c,X,!1):s.attachEvent("on"+c,b),s[oa]=s[oa]||{},s[oa][T]=b}function p0(s,c,h,x,T){T=T||c+u(h)+(x?"_"+u(x):"");var b=s[oa]&&s[oa][T];if(!b)return this;!Ie.touchNative&&Ie.pointer&&c.indexOf("touch")===0?ie(s,c,b):Ie.touch&&c==="dblclick"?mr(s,b):"removeEventListener"in s?s.removeEventListener(d0[c]||c,b,!1):s.detachEvent("on"+c,b),s[oa][T]=null}function zi(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function m0(s){return h0(s,"wheel",zi),this}function zo(s){return et(s,"mousedown touchstart dblclick contextmenu",zi),s._leaflet_disable_click=!0,this}function wr(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Ui(s){return wr(s),zi(s),this}function Nm(s){if(s.composedPath)return s.composedPath();for(var c=[],h=s.target;h;)c.push(h),h=h.parentNode;return c}function Lm(s,c){if(!c)return new ae(s.clientX,s.clientY);var h=f0(c),x=h.boundingClientRect;return new ae((s.clientX-x.left)/h.x-c.clientLeft,(s.clientY-x.top)/h.y-c.clientTop)}var Ek=Ie.linux&&Ie.chrome?window.devicePixelRatio:Ie.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Pm(s){return Ie.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Ek:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function g0(s,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==s;)h=h.parentNode}catch{return!1}return h!==s}var Sk={__proto__:null,on:et,off:Pt,stopPropagation:zi,disableScrollPropagation:m0,disableClickPropagation:zo,preventDefault:wr,stop:Ui,getPropagationPath:Nm,getMousePosition:Lm,getWheelDelta:Pm,isExternalTarget:g0,addListener:et,removeListener:Pt},Fm=me.extend({run:function(s,c,h,x){this.stop(),this._el=s,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(x||.5,.2),this._startPos=Bi(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=B(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var h=this._startPos.add(this._offset.multiplyBy(s));c&&h._round(),nr(this._el,h),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),xt=me.extend({options:{crs:Ye,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=_(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(ne(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Bn&&Ie.any3d&&!Ie.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),et(this._proxy,ti,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(ne(s),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=a({animate:h.animate},h.zoom),h.pan=a({animate:h.animate,duration:h.duration},h.pan));var x=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,h.zoom):this._tryAnimatedPan(s,h.pan);if(x)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,h){var x=this.getZoomScale(c),T=this.getSize().divideBy(2),b=s instanceof ae?s:this.latLngToContainerPoint(s),X=b.subtract(T).multiplyBy(1-1/x),te=this.containerPointToLatLng(T.add(X));return this.setView(te,c,{zoom:h})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():q(s);var h=se(c.paddingTopLeft||c.padding||[0,0]),x=se(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(s,!1,h.add(x));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:s.getCenter(),zoom:T};var b=x.subtract(h).divideBy(2),X=this.project(s.getSouthWest(),T),te=this.project(s.getNorthEast(),T),le=this.unproject(X.add(te).divideBy(2).add(b),T);return{center:le,zoom:T}},fitBounds:function(s,c){if(s=q(s),!s.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(s,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=se(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Fm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){lt(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,h){if(h=h||{},h.animate===!1||!Ie.any3d)return this.setView(s,c,h);this._stop();var x=this.project(this.getCenter()),T=this.project(s),b=this.getSize(),X=this._zoom;s=ne(s),c=c===void 0?X:c;var te=Math.max(b.x,b.y),le=te*this.getZoomScale(X,c),ke=T.distanceTo(x)||1,Re=1.42,We=Re*Re;function ft(ar){var Uc=ar?-1:1,dE=ar?le:te,hE=le*le-te*te+Uc*We*We*ke*ke,pE=2*dE*We*ke,b0=hE/pE,dg=Math.sqrt(b0*b0+1)-b0,mE=dg<1e-9?-18:Math.log(dg);return mE}function Hr(ar){return(Math.exp(ar)-Math.exp(-ar))/2}function gr(ar){return(Math.exp(ar)+Math.exp(-ar))/2}function kn(ar){return Hr(ar)/gr(ar)}var en=ft(0);function Os(ar){return te*(gr(en)/gr(en+Re*ar))}function lE(ar){return te*(gr(en)*kn(en+Re*ar)-Hr(en))/We}function cE(ar){return 1-Math.pow(1-ar,1.5)}var uE=Date.now(),ug=(ft(1)-en)/Re,fE=h.duration?1e3*h.duration:1e3*ug*.8;function fg(){var ar=(Date.now()-uE)/fE,Uc=cE(ar)*ug;ar<=1?(this._flyToFrame=B(fg,this),this._move(this.unproject(x.add(T.subtract(x).multiplyBy(lE(Uc)/ke)),X),this.getScaleZoom(te/Os(Uc),X),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),fg.call(this),this},flyToBounds:function(s,c){var h=this._getBoundsCenterZoom(s,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(s){return s=q(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var h=this.getCenter(),x=this._limitCenter(h,this._zoom,q(s));return h.equals(x)||this.panTo(x,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var h=se(c.paddingTopLeft||c.padding||[0,0]),x=se(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),b=this.project(s),X=this.getPixelBounds(),te=R([X.min.add(h),X.max.subtract(x)]),le=te.getSize();if(!te.contains(b)){this._enforcingBounds=!0;var ke=b.subtract(te.getCenter()),Re=te.extend(b).getSize().subtract(le);T.x+=ke.x<0?-Re.x:Re.x,T.y+=ke.y<0?-Re.y:Re.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=a({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),x=c.divideBy(2).round(),T=h.divideBy(2).round(),b=x.subtract(T);return!b.x&&!b.y?this:(s.animate&&s.pan?this.panBy(b):(s.pan&&this._rawPanBy(b),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=a({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),h=o(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,s):navigator.geolocation.getCurrentPosition(c,h,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,h=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,h=s.coords.longitude,x=new Z(c,h),T=x.toBounds(s.coords.accuracy*2),b=this._locateOptions;if(b.setView){var X=this.getBoundsZoom(T);this.setView(x,b.maxZoom?Math.min(X,b.maxZoom):X)}var te={latlng:x,bounds:T,timestamp:s.timestamp};for(var le in s.coords)typeof s.coords[le]=="number"&&(te[le]=s.coords[le]);this.fire("locationfound",te)}},addHandler:function(s,c){if(!c)return this;var h=this[s]=new c(this);return this._handlers.push(h),this.options[s]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ht(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Ht(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var h="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),x=Qe("div",h,c||this._mapPane);return s&&(this._panes[s]=x),x},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),h=this.unproject(s.getTopRight());return new J(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,h){s=q(s),h=se(h||[0,0]);var x=this.getZoom()||0,T=this.getMinZoom(),b=this.getMaxZoom(),X=s.getNorthWest(),te=s.getSouthEast(),le=this.getSize().subtract(h),ke=R(this.project(te,x),this.project(X,x)).getSize(),Re=Ie.any3d?this.options.zoomSnap:1,We=le.x/ke.x,ft=le.y/ke.y,Hr=c?Math.max(We,ft):Math.min(We,ft);return x=this.getScaleZoom(Hr,x),Re&&(x=Math.round(x/(Re/100))*(Re/100),x=c?Math.ceil(x/Re)*Re:Math.floor(x/Re)*Re),Math.max(T,Math.min(b,x))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ae(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var h=this._getTopLeftPoint(s,c);return new ye(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(s)/h.scale(c)},getScaleZoom:function(s,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var x=h.zoom(s*h.scale(c));return isNaN(x)?1/0:x},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(ne(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(se(s),c)},layerPointToLatLng:function(s){var c=se(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(ne(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(ne(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(q(s))},distance:function(s,c){return this.options.crs.distance(ne(s),ne(c))},containerPointToLayerPoint:function(s){return se(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return se(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(se(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ne(s)))},mouseEventToContainerPoint:function(s){return Lm(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=sa(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");et(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ie.any3d,lt(s,"leaflet-container"+(Ie.touch?" leaflet-touch":"")+(Ie.retina?" leaflet-retina":"")+(Ie.ielt9?" leaflet-oldie":"")+(Ie.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=ba(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),nr(this._mapPane,new ae(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(lt(s.markerPane,"leaflet-zoom-hide"),lt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,h){nr(this._mapPane,new ae(0,0));var x=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,h)._move(s,c)._moveEnd(T),this.fire("viewreset"),x&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,h,x){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),x?h&&h.pinch&&this.fire("zoom",h):((T||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){nr(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[u(this._container)]=this;var c=s?Pt:et;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Ie.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=B(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var h=[],x,T=c==="mouseout"||c==="mouseover",b=s.target||s.srcElement,X=!1;b;){if(x=this._targets[u(b)],x&&(c==="click"||c==="preclick")&&this._draggableMoved(x)){X=!0;break}if(x&&x.listens(c,!0)&&(T&&!g0(b,s)||(h.push(x),T))||b===this._container)break;b=b.parentNode}return!h.length&&!X&&!T&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var h=s.type;h==="mousedown"&&u0(c),this._fireDOMEvent(s,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,h){if(s.type==="click"){var x=a({},s);x.type="preclick",this._fireDOMEvent(x,x.type,h)}var T=this._findEventTargets(s,c);if(h){for(var b=[],X=0;X<h.length;X++)h[X].listens(c,!0)&&b.push(h[X]);T=b.concat(T)}if(T.length){c==="contextmenu"&&wr(s);var te=T[0],le={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ke=te.getLatLng&&(!te._radius||te._radius<=10);le.containerPoint=ke?this.latLngToContainerPoint(te.getLatLng()):this.mouseEventToContainerPoint(s),le.layerPoint=this.containerPointToLayerPoint(le.containerPoint),le.latlng=ke?te.getLatLng():this.layerPointToLatLng(le.layerPoint)}for(X=0;X<T.length;X++)if(T[X].fire(c,le,!0),le.originalEvent._stopped||T[X].options.bubblingMouseEvents===!1&&N(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return Bi(this._mapPane)||new ae(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var h=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var h=this.getSize()._divideBy(2);return this.project(s,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,h){var x=this._getNewPixelOrigin(h,c);return this.project(s,c)._subtract(x)},_latLngBoundsToNewLayerBounds:function(s,c,h){var x=this._getNewPixelOrigin(h,c);return R([this.project(s.getSouthWest(),c)._subtract(x),this.project(s.getNorthWest(),c)._subtract(x),this.project(s.getSouthEast(),c)._subtract(x),this.project(s.getNorthEast(),c)._subtract(x)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,h){if(!h)return s;var x=this.project(s,c),T=this.getSize().divideBy(2),b=new ye(x.subtract(T),x.add(T)),X=this._getBoundsOffset(b,h,c);return Math.abs(X.x)<=1&&Math.abs(X.y)<=1?s:this.unproject(x.add(X),c)},_limitOffset:function(s,c){if(!c)return s;var h=this.getPixelBounds(),x=new ye(h.min.add(s),h.max.add(s));return s.add(this._getBoundsOffset(x,c))},_getBoundsOffset:function(s,c,h){var x=R(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),T=x.min.subtract(s.min),b=x.max.subtract(s.max),X=this._rebound(T.x,-b.x),te=this._rebound(T.y,-b.y);return new ae(X,te)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),h=this.getMaxZoom(),x=Ie.any3d?this.options.zoomSnap:1;return x&&(s=Math.round(s/x)*x),Math.max(c,Math.min(h,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Qt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var h=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var s=this._proxy=Qe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var h=Ca,x=this._proxy.style[h];ji(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),x===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ht(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();ji(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var x=this.getZoomScale(c),T=this._getCenterOffset(s)._divideBy(1-1/x);return h.animate!==!0&&!this.getSize().contains(T)?!1:(B(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,h,x){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,lt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:x}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Qt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Tk(s,c){return new xt(s,c)}var zn=ve.extend({options:{position:"topright"},initialize:function(s){_(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),h=this.getPosition(),x=s._controlCorners[h];return lt(c,"leaflet-control"),h.indexOf("bottom")!==-1?x.insertBefore(c,x.firstChild):x.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ht(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Uo=function(s){return new zn(s)};xt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",h=this._controlContainer=Qe("div",c+"control-container",this._container);function x(T,b){var X=c+T+" "+c+b;s[T+b]=Qe("div",X,h)}x("top","left"),x("top","right"),x("bottom","left"),x("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Ht(this._controlCorners[s]);Ht(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Om=zn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,h,x){return h<x?-1:x<h?1:0}},initialize:function(s,c,h){_(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var x in s)this._addLayer(s[x],x);for(x in c)this._addLayer(c[x],x,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return zn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){lt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(lt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Qt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Qt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=Qe("div",s),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),zo(c),m0(c);var x=this._section=Qe("section",s+"-list");h&&(this._map.on("click",this.collapse,this),et(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=Qe("a",s+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),et(T,{keydown:function(b){b.keyCode===13&&this._expandSafely()},click:function(b){wr(b),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=Qe("div",s+"-base",x),this._separator=Qe("div",s+"-separator",x),this._overlaysList=Qe("div",s+"-overlays",x),c.appendChild(x)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,h){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(o(function(x,T){return this.options.sortFunction(x.layer,T.layer,x.name,T.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Tc(this._baseLayersList),Tc(this._overlaysList),this._layerControlInputs=[];var s,c,h,x,T=0;for(h=0;h<this._layers.length;h++)x=this._layers[h],this._addItem(x),c=c||x.overlay,s=s||!x.overlay,T+=x.overlay?0:1;return this.options.hideSingleBase&&(s=s&&T>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(u(s.target)),h=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(s,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",x=document.createElement("div");return x.innerHTML=h,x.firstChild},_addItem:function(s){var c=document.createElement("label"),h=this._map.hasLayer(s.layer),x;s.overlay?(x=document.createElement("input"),x.type="checkbox",x.className="leaflet-control-layers-selector",x.defaultChecked=h):x=this._createRadioElement("leaflet-base-layers_"+u(this),h),this._layerControlInputs.push(x),x.layerId=u(s.layer),et(x,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+s.name;var b=document.createElement("span");c.appendChild(b),b.appendChild(x),b.appendChild(T);var X=s.overlay?this._overlaysList:this._baseLayersList;return X.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,h,x=[],T=[];this._handlingClick=!0;for(var b=s.length-1;b>=0;b--)c=s[b],h=this._getLayer(c.layerId).layer,c.checked?x.push(h):c.checked||T.push(h);for(b=0;b<T.length;b++)this._map.hasLayer(T[b])&&this._map.removeLayer(T[b]);for(b=0;b<x.length;b++)this._map.hasLayer(x[b])||this._map.addLayer(x[b]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,h,x=this._map.getZoom(),T=s.length-1;T>=0;T--)c=s[T],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&x<h.options.minZoom||h.options.maxZoom!==void 0&&x>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,et(s,"click",wr),this.expand();var c=this;setTimeout(function(){Pt(s,"click",wr),c._preventClick=!1})}}),Ck=function(s,c,h){return new Om(s,c,h)},x0=zn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",h=Qe("div",c+" leaflet-bar"),x=this.options;return this._zoomInButton=this._createButton(x.zoomInText,x.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(x.zoomOutText,x.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,h,x,T){var b=Qe("a",h,x);return b.innerHTML=s,b.href="#",b.title=c,b.setAttribute("role","button"),b.setAttribute("aria-label",c),zo(b),et(b,"click",Ui),et(b,"click",T,this),et(b,"click",this._refocusOnMap,this),b},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";Qt(this._zoomInButton,c),Qt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(lt(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(lt(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});xt.mergeOptions({zoomControl:!0}),xt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new x0,this.addControl(this.zoomControl))});var bk=function(s){return new x0(s)},Mm=zn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",h=Qe("div",c),x=this.options;return this._addScales(x,c+"-line",h),s.on(x.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),h},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,h){s.metric&&(this._mScale=Qe("div",c,h)),s.imperial&&(this._iScale=Qe("div",c,h))},_update:function(){var s=this._map,c=s.getSize().y/2,h=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/s)},_updateImperial:function(s){var c=s*3.2808399,h,x,T;c>5280?(h=c/5280,x=this._getRoundNum(h),this._updateScale(this._iScale,x+" mi",x/h)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(s,c,h){s.style.width=Math.round(this.options.maxWidth*h)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),h=s/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),Ak=function(s){return new Mm(s)},Nk='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',v0=zn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ie.inlineSvg?Nk+" ":"")+"Leaflet</a>"},initialize:function(s){_(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Qe("div","leaflet-control-attribution"),zo(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),s.length&&h.push(s.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});xt.mergeOptions({attributionControl:!0}),xt.addInitHook(function(){this.options.attributionControl&&new v0().addTo(this)});var Lk=function(s){return new v0(s)};zn.Layers=Om,zn.Zoom=x0,zn.Scale=Mm,zn.Attribution=v0,Uo.layers=Ck,Uo.zoom=bk,Uo.scale=Ak,Uo.attribution=Lk;var la=ve.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});la.addTo=function(s,c){return s.addHandler(c,this),this};var Pk={Events:he},Rm=Ie.touch?"touchstart mousedown":"mousedown",ri=me.extend({options:{clickTolerance:3},initialize:function(s,c,h,x){_(this,x),this._element=s,this._dragStartTarget=c||s,this._preventOutline=h},enable:function(){this._enabled||(et(this._dragStartTarget,Rm,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ri._dragging===this&&this.finishDrag(!0),Pt(this._dragStartTarget,Rm,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!a0(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){ri._dragging===this&&this.finishDrag();return}if(!(ri._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(ri._dragging=this,this._preventOutline&&u0(this._element),o0(),Io(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,h=bm(this._element);this._startPoint=new ae(c.clientX,c.clientY),this._startPos=Bi(this._element),this._parentScale=f0(h);var x=s.type==="mousedown";et(document,x?"mousemove":"touchmove",this._onMove,this),et(document,x?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,h=new ae(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,wr(s),this._moved||(this.fire("dragstart"),this._moved=!0,lt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),lt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),nr(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Qt(document.body,"leaflet-dragging"),this._lastTarget&&(Qt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Pt(document,"mousemove touchmove",this._onMove,this),Pt(document,"mouseup touchend touchcancel",this._onUp,this),l0(),jo();var c=this._moved&&this._moving;this._moving=!1,ri._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Dm(s,c,h){var x,T=[1,4,2,8],b,X,te,le,ke,Re,We,ft;for(b=0,Re=s.length;b<Re;b++)s[b]._code=Hi(s[b],c);for(te=0;te<4;te++){for(We=T[te],x=[],b=0,Re=s.length,X=Re-1;b<Re;X=b++)le=s[b],ke=s[X],le._code&We?ke._code&We||(ft=Lc(ke,le,We,c,h),ft._code=Hi(ft,c),x.push(ft)):(ke._code&We&&(ft=Lc(ke,le,We,c,h),ft._code=Hi(ft,c),x.push(ft)),x.push(le));s=x}return s}function Im(s,c){var h,x,T,b,X,te,le,ke,Re;if(!s||s.length===0)throw new Error("latlngs not passed");wn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var We=ne([0,0]),ft=q(s),Hr=ft.getNorthWest().distanceTo(ft.getSouthWest())*ft.getNorthEast().distanceTo(ft.getNorthWest());Hr<1700&&(We=_0(s));var gr=s.length,kn=[];for(h=0;h<gr;h++){var en=ne(s[h]);kn.push(c.project(ne([en.lat-We.lat,en.lng-We.lng])))}for(te=le=ke=0,h=0,x=gr-1;h<gr;x=h++)T=kn[h],b=kn[x],X=T.y*b.x-b.y*T.x,le+=(T.x+b.x)*X,ke+=(T.y+b.y)*X,te+=X*3;te===0?Re=kn[0]:Re=[le/te,ke/te];var Os=c.unproject(se(Re));return ne([Os.lat+We.lat,Os.lng+We.lng])}function _0(s){for(var c=0,h=0,x=0,T=0;T<s.length;T++){var b=ne(s[T]);c+=b.lat,h+=b.lng,x++}return ne([c/x,h/x])}var Fk={__proto__:null,clipPolygon:Dm,polygonCenter:Im,centroid:_0};function jm(s,c){if(!c||!s.length)return s.slice();var h=c*c;return s=Rk(s,h),s=Mk(s,h),s}function Bm(s,c,h){return Math.sqrt(Ho(s,c,h,!0))}function Ok(s,c,h){return Ho(s,c,h)}function Mk(s,c){var h=s.length,x=typeof Uint8Array<"u"?Uint8Array:Array,T=new x(h);T[0]=T[h-1]=1,y0(s,T,c,0,h-1);var b,X=[];for(b=0;b<h;b++)T[b]&&X.push(s[b]);return X}function y0(s,c,h,x,T){var b=0,X,te,le;for(te=x+1;te<=T-1;te++)le=Ho(s[te],s[x],s[T],!0),le>b&&(X=te,b=le);b>h&&(c[X]=1,y0(s,c,h,x,X),y0(s,c,h,X,T))}function Rk(s,c){for(var h=[s[0]],x=1,T=0,b=s.length;x<b;x++)Dk(s[x],s[T])>c&&(h.push(s[x]),T=x);return T<b-1&&h.push(s[b-1]),h}var zm;function Um(s,c,h,x,T){var b=x?zm:Hi(s,h),X=Hi(c,h),te,le,ke;for(zm=X;;){if(!(b|X))return[s,c];if(b&X)return!1;te=b||X,le=Lc(s,c,te,h,T),ke=Hi(le,h),te===b?(s=le,b=ke):(c=le,X=ke)}}function Lc(s,c,h,x,T){var b=c.x-s.x,X=c.y-s.y,te=x.min,le=x.max,ke,Re;return h&8?(ke=s.x+b*(le.y-s.y)/X,Re=le.y):h&4?(ke=s.x+b*(te.y-s.y)/X,Re=te.y):h&2?(ke=le.x,Re=s.y+X*(le.x-s.x)/b):h&1&&(ke=te.x,Re=s.y+X*(te.x-s.x)/b),new ae(ke,Re,T)}function Hi(s,c){var h=0;return s.x<c.min.x?h|=1:s.x>c.max.x&&(h|=2),s.y<c.min.y?h|=4:s.y>c.max.y&&(h|=8),h}function Dk(s,c){var h=c.x-s.x,x=c.y-s.y;return h*h+x*x}function Ho(s,c,h,x){var T=c.x,b=c.y,X=h.x-T,te=h.y-b,le=X*X+te*te,ke;return le>0&&(ke=((s.x-T)*X+(s.y-b)*te)/le,ke>1?(T=h.x,b=h.y):ke>0&&(T+=X*ke,b+=te*ke)),X=s.x-T,te=s.y-b,x?X*X+te*te:new ae(T,b)}function wn(s){return!w(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Hm(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),wn(s)}function Vm(s,c){var h,x,T,b,X,te,le,ke;if(!s||s.length===0)throw new Error("latlngs not passed");wn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Re=ne([0,0]),We=q(s),ft=We.getNorthWest().distanceTo(We.getSouthWest())*We.getNorthEast().distanceTo(We.getNorthWest());ft<1700&&(Re=_0(s));var Hr=s.length,gr=[];for(h=0;h<Hr;h++){var kn=ne(s[h]);gr.push(c.project(ne([kn.lat-Re.lat,kn.lng-Re.lng])))}for(h=0,x=0;h<Hr-1;h++)x+=gr[h].distanceTo(gr[h+1])/2;if(x===0)ke=gr[0];else for(h=0,b=0;h<Hr-1;h++)if(X=gr[h],te=gr[h+1],T=X.distanceTo(te),b+=T,b>x){le=(b-x)/T,ke=[te.x-le*(te.x-X.x),te.y-le*(te.y-X.y)];break}var en=c.unproject(se(ke));return ne([en.lat+Re.lat,en.lng+Re.lng])}var Ik={__proto__:null,simplify:jm,pointToSegmentDistance:Bm,closestPointOnSegment:Ok,clipSegment:Um,_getEdgeIntersection:Lc,_getBitCode:Hi,_sqClosestPointOnSegment:Ho,isFlat:wn,_flat:Hm,polylineCenter:Vm},w0={project:function(s){return new ae(s.lng,s.lat)},unproject:function(s){return new Z(s.y,s.x)},bounds:new ye([-180,-90],[180,90])},k0={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ye([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,h=this.R,x=s.lat*c,T=this.R_MINOR/h,b=Math.sqrt(1-T*T),X=b*Math.sin(x),te=Math.tan(Math.PI/4-x/2)/Math.pow((1-X)/(1+X),b/2);return x=-h*Math.log(Math.max(te,1e-10)),new ae(s.lng*c*h,x)},unproject:function(s){for(var c=180/Math.PI,h=this.R,x=this.R_MINOR/h,T=Math.sqrt(1-x*x),b=Math.exp(-s.y/h),X=Math.PI/2-2*Math.atan(b),te=0,le=.1,ke;te<15&&Math.abs(le)>1e-7;te++)ke=T*Math.sin(X),ke=Math.pow((1-ke)/(1+ke),T/2),le=Math.PI/2-2*Math.atan(b*ke)-X,X+=le;return new Z(X*c,s.x*c/h)}},jk={__proto__:null,LonLat:w0,Mercator:k0,SphericalMercator:_e},Bk=a({},Le,{code:"EPSG:3395",projection:k0,transformation:function(){var s=.5/(Math.PI*k0.R);return H(s,.5,-s,.5)}()}),Wm=a({},Le,{code:"EPSG:4326",projection:w0,transformation:H(1/180,1,-1/180,.5)}),zk=a({},we,{projection:w0,transformation:H(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var h=c.lng-s.lng,x=c.lat-s.lat;return Math.sqrt(h*h+x*x)},infinite:!0});we.Earth=Le,we.EPSG3395=Bk,we.EPSG3857=Ye,we.EPSG900913=nt,we.EPSG4326=Wm,we.Simple=zk;var Un=me.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[u(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[u(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});xt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=u(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return u(s)in this._layers},eachLayer:function(s,c){for(var h in this._layers)s.call(c,this._layers[h]);return this},_addLayers:function(s){s=s?w(s)?s:[s]:[];for(var c=0,h=s.length;c<h;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[u(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=u(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,h=this._getZoomSpan();for(var x in this._zoomBoundLayers){var T=this._zoomBoundLayers[x].options;s=T.minZoom===void 0?s:Math.min(s,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var As=Un.extend({initialize:function(s,c){_(this,c),this._layers={};var h,x;if(s)for(h=0,x=s.length;h<x;h++)this.addLayer(s[h])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),h,x;for(h in this._layers)x=this._layers[h],x[s]&&x[s].apply(x,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var h in this._layers)s.call(c,this._layers[h]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return u(s)}}),Uk=function(s,c){return new As(s,c)},Aa=As.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),As.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),As.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new J;for(var c in this._layers){var h=this._layers[c];s.extend(h.getBounds?h.getBounds():h.getLatLng())}return s}}),Hk=function(s,c){return new Aa(s,c)},Ns=ve.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){_(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var h=this._getIconUrl(s);if(!h){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var x=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(x,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),x},_setIconStyles:function(s,c){var h=this.options,x=h[c+"Size"];typeof x=="number"&&(x=[x,x]);var T=se(x),b=se(c==="shadow"&&h.shadowAnchor||h.iconAnchor||T&&T.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(h.className||""),b&&(s.style.marginLeft=-b.x+"px",s.style.marginTop=-b.y+"px"),T&&(s.style.width=T.x+"px",s.style.height=T.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return Ie.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Vk(s){return new Ns(s)}var Vo=Ns.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Vo.imagePath!="string"&&(Vo.imagePath=this._detectIconPath()),(this.options.imagePath||Vo.imagePath)+Ns.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(h,x,T){var b=x.exec(h);return b&&b[T]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Qe("div","leaflet-default-icon-path",document.body),c=ba(s,"background-image")||ba(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),$m=la.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new ri(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),lt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Qt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,h=c._map,x=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,b=Bi(c._icon),X=h.getPixelBounds(),te=h.getPixelOrigin(),le=R(X.min._subtract(te).add(T),X.max._subtract(te).subtract(T));if(!le.contains(b)){var ke=se((Math.max(le.max.x,b.x)-le.max.x)/(X.max.x-le.max.x)-(Math.min(le.min.x,b.x)-le.min.x)/(X.min.x-le.min.x),(Math.max(le.max.y,b.y)-le.max.y)/(X.max.y-le.max.y)-(Math.min(le.min.y,b.y)-le.min.y)/(X.min.y-le.min.y)).multiplyBy(x);h.panBy(ke,{animate:!1}),this._draggable._newPos._add(ke),this._draggable._startPos._add(ke),nr(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=B(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=B(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,h=c._shadow,x=Bi(c._icon),T=c._map.layerPointToLatLng(x);h&&nr(h,x),c._latlng=T,s.latlng=T,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Pc=Un.extend({options:{icon:new Vo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){_(this,c),this._latlng=ne(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=ne(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=s.icon.createIcon(this._icon),x=!1;h!==this._icon&&(this._icon&&this._removeIcon(),x=!0,s.title&&(h.title=s.title),h.tagName==="IMG"&&(h.alt=s.alt||"")),lt(h,c),s.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&et(h,"focus",this._panOnFocus,this);var T=s.icon.createShadow(this._shadow),b=!1;T!==this._shadow&&(this._removeShadow(),b=!0),T&&(lt(T,c),T.alt=""),this._shadow=T,s.opacity<1&&this._updateOpacity(),x&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&b&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Pt(this._icon,"focus",this._panOnFocus,this),Ht(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ht(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&nr(this._icon,s),this._shadow&&nr(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(lt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),$m)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new $m(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&yn(this._icon,s),this._shadow&&yn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,h=c.iconSize?se(c.iconSize):se(0,0),x=c.iconAnchor?se(c.iconAnchor):se(0,0);s.panInside(this._latlng,{paddingTopLeft:x,paddingBottomRight:h.subtract(x)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Wk(s,c){return new Pc(s,c)}var ni=Un.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return _(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Fc=ni.extend({options:{fill:!0,radius:10},initialize:function(s,c){_(this,c),this._latlng=ne(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=ne(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return ni.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,h=this._clickTolerance(),x=[s+h,c+h];this._pxBounds=new ye(this._point.subtract(x),this._point.add(x))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function $k(s,c){return new Fc(s,c)}var E0=Fc.extend({initialize:function(s,c,h){if(typeof c=="number"&&(c=a({},h,{radius:c})),_(this,c),this._latlng=ne(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new J(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:ni.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,h=this._map,x=h.options.crs;if(x.distance===Le.distance){var T=Math.PI/180,b=this._mRadius/Le.R/T,X=h.project([c+b,s]),te=h.project([c-b,s]),le=X.add(te).divideBy(2),ke=h.unproject(le).lat,Re=Math.acos((Math.cos(b*T)-Math.sin(c*T)*Math.sin(ke*T))/(Math.cos(c*T)*Math.cos(ke*T)))/T;(isNaN(Re)||Re===0)&&(Re=b/Math.cos(Math.PI/180*c)),this._point=le.subtract(h.getPixelOrigin()),this._radius=isNaN(Re)?0:le.x-h.project([ke,s-Re]).x,this._radiusY=le.y-X.y}else{var We=x.unproject(x.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(We).x}this._updateBounds()}});function Gk(s,c,h){return new E0(s,c,h)}var Na=ni.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){_(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,h=null,x=Ho,T,b,X=0,te=this._parts.length;X<te;X++)for(var le=this._parts[X],ke=1,Re=le.length;ke<Re;ke++){T=le[ke-1],b=le[ke];var We=x(s,T,b,!0);We<c&&(c=We,h=x(s,T,b))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vm(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=ne(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new J,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return wn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],h=wn(s),x=0,T=s.length;x<T;x++)h?(c[x]=ne(s[x]),this._bounds.extend(c[x])):c[x]=this._convertLatLngs(s[x]);return c},_project:function(){var s=new ye;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new ae(s,s);this._rawPxBounds&&(this._pxBounds=new ye([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,h){var x=s[0]instanceof Z,T=s.length,b,X;if(x){for(X=[],b=0;b<T;b++)X[b]=this._map.latLngToLayerPoint(s[b]),h.extend(X[b]);c.push(X)}else for(b=0;b<T;b++)this._projectLatlngs(s[b],c,h)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,x,T,b,X,te,le;for(h=0,T=0,b=this._rings.length;h<b;h++)for(le=this._rings[h],x=0,X=le.length;x<X-1;x++)te=Um(le[x],le[x+1],s,x,!0),te&&(c[T]=c[T]||[],c[T].push(te[0]),(te[1]!==le[x+1]||x===X-2)&&(c[T].push(te[1]),T++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,h=0,x=s.length;h<x;h++)s[h]=jm(s[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var h,x,T,b,X,te,le=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(h=0,b=this._parts.length;h<b;h++)for(te=this._parts[h],x=0,X=te.length,T=X-1;x<X;T=x++)if(!(!c&&x===0)&&Bm(s,te[T],te[x])<=le)return!0;return!1}});function Zk(s,c){return new Na(s,c)}Na._flat=Hm;var Ls=Na.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Im(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=Na.prototype._convertLatLngs.call(this,s),h=c.length;return h>=2&&c[0]instanceof Z&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(s){Na.prototype._setLatLngs.call(this,s),wn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return wn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,h=new ae(c,c);if(s=new ye(s.min.subtract(h),s.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var x=0,T=this._rings.length,b;x<T;x++)b=Dm(this._rings[x],s,!0),b.length&&this._parts.push(b)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,h,x,T,b,X,te,le,ke;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(b=0,le=this._parts.length;b<le;b++)for(h=this._parts[b],X=0,ke=h.length,te=ke-1;X<ke;te=X++)x=h[X],T=h[te],x.y>s.y!=T.y>s.y&&s.x<(T.x-x.x)*(s.y-x.y)/(T.y-x.y)+x.x&&(c=!c);return c||Na.prototype._containsPoint.call(this,s,!0)}});function Xk(s,c){return new Ls(s,c)}var La=Aa.extend({initialize:function(s,c){_(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=w(s)?s:s.features,h,x,T;if(c){for(h=0,x=c.length;h<x;h++)T=c[h],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var b=this.options;if(b.filter&&!b.filter(s))return this;var X=Oc(s,b);return X?(X.feature=Dc(s),X.defaultOptions=X.options,this.resetStyle(X),b.onEachFeature&&b.onEachFeature(s,X),this.addLayer(X)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=a({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function Oc(s,c){var h=s.type==="Feature"?s.geometry:s,x=h?h.coordinates:null,T=[],b=c&&c.pointToLayer,X=c&&c.coordsToLatLng||S0,te,le,ke,Re;if(!x&&!h)return null;switch(h.type){case"Point":return te=X(x),Gm(b,s,te,c);case"MultiPoint":for(ke=0,Re=x.length;ke<Re;ke++)te=X(x[ke]),T.push(Gm(b,s,te,c));return new Aa(T);case"LineString":case"MultiLineString":return le=Mc(x,h.type==="LineString"?0:1,X),new Na(le,c);case"Polygon":case"MultiPolygon":return le=Mc(x,h.type==="Polygon"?1:2,X),new Ls(le,c);case"GeometryCollection":for(ke=0,Re=h.geometries.length;ke<Re;ke++){var We=Oc({geometry:h.geometries[ke],type:"Feature",properties:s.properties},c);We&&T.push(We)}return new Aa(T);case"FeatureCollection":for(ke=0,Re=h.features.length;ke<Re;ke++){var ft=Oc(h.features[ke],c);ft&&T.push(ft)}return new Aa(T);default:throw new Error("Invalid GeoJSON object.")}}function Gm(s,c,h,x){return s?s(c,h):new Pc(h,x&&x.markersInheritOptions&&x)}function S0(s){return new Z(s[1],s[0],s[2])}function Mc(s,c,h){for(var x=[],T=0,b=s.length,X;T<b;T++)X=c?Mc(s[T],c-1,h):(h||S0)(s[T]),x.push(X);return x}function T0(s,c){return s=ne(s),s.alt!==void 0?[g(s.lng,c),g(s.lat,c),g(s.alt,c)]:[g(s.lng,c),g(s.lat,c)]}function Rc(s,c,h,x){for(var T=[],b=0,X=s.length;b<X;b++)T.push(c?Rc(s[b],wn(s[b])?0:c-1,h,x):T0(s[b],x));return!c&&h&&T.length>0&&T.push(T[0].slice()),T}function Ps(s,c){return s.feature?a({},s.feature,{geometry:c}):Dc(c)}function Dc(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var C0={toGeoJSON:function(s){return Ps(this,{type:"Point",coordinates:T0(this.getLatLng(),s)})}};Pc.include(C0),E0.include(C0),Fc.include(C0),Na.include({toGeoJSON:function(s){var c=!wn(this._latlngs),h=Rc(this._latlngs,c?1:0,!1,s);return Ps(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),Ls.include({toGeoJSON:function(s){var c=!wn(this._latlngs),h=c&&!wn(this._latlngs[0]),x=Rc(this._latlngs,h?2:c?1:0,!0,s);return c||(x=[x]),Ps(this,{type:(h?"Multi":"")+"Polygon",coordinates:x})}}),As.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(s).geometry.coordinates)}),Ps(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var h=c==="GeometryCollection",x=[];return this.eachLayer(function(T){if(T.toGeoJSON){var b=T.toGeoJSON(s);if(h)x.push(b.geometry);else{var X=Dc(b);X.type==="FeatureCollection"?x.push.apply(x,X.features):x.push(X)}}}),h?Ps(this,{geometries:x,type:"GeometryCollection"}):{type:"FeatureCollection",features:x}}});function Zm(s,c){return new La(s,c)}var qk=Zm,Ic=Un.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,h){this._url=s,this._bounds=q(c),_(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(lt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ht(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Cs(this._image),this},bringToBack:function(){return this._map&&bs(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=q(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:Qe("img");if(lt(c,"leaflet-image-layer"),this._zoomAnimated&&lt(c,"leaflet-zoom-animated"),this.options.className&&lt(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;ji(this._image,h,c)},_reset:function(){var s=this._image,c=new ye(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();nr(s,c.min),s.style.width=h.x+"px",s.style.height=h.y+"px"},_updateOpacity:function(){yn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Yk=function(s,c,h){return new Ic(s,c,h)},Xm=Ic.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:Qe("video");if(lt(c,"leaflet-image-layer"),this._zoomAnimated&&lt(c,"leaflet-zoom-animated"),this.options.className&&lt(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),s){for(var h=c.getElementsByTagName("source"),x=[],T=0;T<h.length;T++)x.push(h[T].src);this._url=h.length>0?x:[c.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var b=0;b<this._url.length;b++){var X=Qe("source");X.src=this._url[b],c.appendChild(X)}}});function Kk(s,c,h){return new Xm(s,c,h)}var qm=Ic.extend({_initImage:function(){var s=this._image=this._url;lt(s,"leaflet-image-layer"),this._zoomAnimated&&lt(s,"leaflet-zoom-animated"),this.options.className&&lt(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function Jk(s,c,h){return new qm(s,c,h)}var ca=Un.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof Z||w(s))?(this._latlng=ne(s),_(this,c)):(_(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&yn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&yn(this._container,1),this.bringToFront(),this.options.interactive&&(lt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(yn(this._container,0),this._removeTimeout=setTimeout(o(Ht,void 0,this._container),200)):Ht(this._container),this.options.interactive&&(Qt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=ne(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Cs(this._container),this},bringToBack:function(){return this._map&&bs(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof Aa){c=null;var h=this._source._layers;for(var x in h)if(h[x]._map){c=h[x];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=se(this.options.offset),h=this._getAnchor();this._zoomAnimated?nr(this._container,s.add(h)):c=c.add(s).add(h);var x=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=x+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});xt.include({_initOverlay:function(s,c,h,x){var T=c;return T instanceof s||(T=new s(x).setContent(c)),h&&T.setLatLng(h),T}}),Un.include({_initOverlay:function(s,c,h,x){var T=h;return T instanceof s?(_(T,x),T._source=this):(T=c&&!x?c:new s(x,this),T.setContent(h)),T}});var jc=ca.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,ca.prototype.openOn.call(this,s)},onAdd:function(s){ca.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ni||this._source.on("preclick",zi))},onRemove:function(s){ca.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ni||this._source.off("preclick",zi))},getEvents:function(){var s=ca.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=Qe("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=Qe("div",s+"-content-wrapper",c);if(this._contentNode=Qe("div",s+"-content",h),zo(c),m0(this._contentNode),et(c,"contextmenu",zi),this._tipContainer=Qe("div",s+"-tip-container",c),this._tip=Qe("div",s+"-tip",this._tipContainer),this.options.closeButton){var x=this._closeButton=Qe("a",s+"-close-button",c);x.setAttribute("role","button"),x.setAttribute("aria-label","Close popup"),x.href="#close",x.innerHTML='<span aria-hidden="true">&#215;</span>',et(x,"click",function(T){wr(T),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var h=s.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var x=s.offsetHeight,T=this.options.maxHeight,b="leaflet-popup-scrolled";T&&x>T?(c.height=T+"px",lt(s,b)):Qt(s,b),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),h=this._getAnchor();nr(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(ba(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,x=this._containerWidth,T=new ae(this._containerLeft,-h-this._containerBottom);T._add(Bi(this._container));var b=s.layerPointToContainerPoint(T),X=se(this.options.autoPanPadding),te=se(this.options.autoPanPaddingTopLeft||X),le=se(this.options.autoPanPaddingBottomRight||X),ke=s.getSize(),Re=0,We=0;b.x+x+le.x>ke.x&&(Re=b.x+x-ke.x+le.x),b.x-Re-te.x<0&&(Re=b.x-te.x),b.y+h+le.y>ke.y&&(We=b.y+h-ke.y+le.y),b.y-We-te.y<0&&(We=b.y-te.y),(Re||We)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Re,We]))}},_getAnchor:function(){return se(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Qk=function(s,c){return new jc(s,c)};xt.mergeOptions({closePopupOnClick:!0}),xt.include({openPopup:function(s,c,h){return this._initOverlay(jc,s,c,h).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Un.include({bindPopup:function(s,c){return this._popup=this._initOverlay(jc,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Aa||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Ui(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof ni)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Bc=ca.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){ca.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){ca.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=ca.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Qe("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,h,x=this._map,T=this._container,b=x.latLngToContainerPoint(x.getCenter()),X=x.layerPointToContainerPoint(s),te=this.options.direction,le=T.offsetWidth,ke=T.offsetHeight,Re=se(this.options.offset),We=this._getAnchor();te==="top"?(c=le/2,h=ke):te==="bottom"?(c=le/2,h=0):te==="center"?(c=le/2,h=ke/2):te==="right"?(c=0,h=ke/2):te==="left"?(c=le,h=ke/2):X.x<b.x?(te="right",c=0,h=ke/2):(te="left",c=le+(Re.x+We.x)*2,h=ke/2),s=s.subtract(se(c,h,!0)).add(Re).add(We),Qt(T,"leaflet-tooltip-right"),Qt(T,"leaflet-tooltip-left"),Qt(T,"leaflet-tooltip-top"),Qt(T,"leaflet-tooltip-bottom"),lt(T,"leaflet-tooltip-"+te),nr(T,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&yn(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return se(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),eE=function(s,c){return new Bc(s,c)};xt.include({openTooltip:function(s,c,h){return this._initOverlay(Bc,s,c,h).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Un.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Bc,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Aa||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(et(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),et(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,h,x;this._tooltip.options.sticky&&s.originalEvent&&(h=this._map.mouseEventToContainerPoint(s.originalEvent),x=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(x)),this._tooltip.setLatLng(c)}});var Ym=Ns.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Tc(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var x=se(h.bgPos);c.style.backgroundPosition=-x.x+"px "+-x.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function tE(s){return new Ym(s)}Ns.Default=Vo;var Wo=Un.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ie.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){_(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Ht(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Cs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(bs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof ae?s:new ae(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,h=-s(-1/0,1/0),x=0,T=c.length,b;x<T;x++)b=c[x].style.zIndex,c[x]!==this._container&&b&&(h=s(h,+b));isFinite(h)&&(this.options.zIndex=h+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ie.ielt9){yn(this._container,this.options.opacity);var s=+new Date,c=!1,h=!1;for(var x in this._tiles){var T=this._tiles[x];if(!(!T.current||!T.loaded)){var b=Math.min(1,(s-T.loaded)/200);yn(T.el,b),b<1?c=!0:(T.active?h=!0:this._onOpaqueTile(T),T.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(G(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=Qe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===s?(this._levels[h].el.style.zIndex=c-Math.abs(s-h),this._onUpdateLevel(h)):(Ht(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var x=this._levels[s],T=this._map;return x||(x=this._levels[s]={},x.el=Qe("div","leaflet-tile-container leaflet-zoom-animated",this._container),x.el.style.zIndex=c,x.origin=T.project(T.unproject(T.getPixelOrigin()),s).round(),x.zoom=s,this._setZoomTransform(x,T.getCenter(),T.getZoom()),m(x.el.offsetWidth),this._onCreateLevel(x)),this._level=x,x}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var x=c.coords;this._retainParent(x.x,x.y,x.z,x.z-5)||this._retainChildren(x.x,x.y,x.z,x.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Ht(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,h,x){var T=Math.floor(s/2),b=Math.floor(c/2),X=h-1,te=new ae(+T,+b);te.z=+X;var le=this._tileCoordsToKey(te),ke=this._tiles[le];return ke&&ke.active?(ke.retain=!0,!0):(ke&&ke.loaded&&(ke.retain=!0),X>x?this._retainParent(T,b,X,x):!1)},_retainChildren:function(s,c,h,x){for(var T=2*s;T<2*s+2;T++)for(var b=2*c;b<2*c+2;b++){var X=new ae(T,b);X.z=h+1;var te=this._tileCoordsToKey(X),le=this._tiles[te];if(le&&le.active){le.retain=!0;continue}else le&&le.loaded&&(le.retain=!0);h+1<x&&this._retainChildren(T,b,h+1,x)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,h,x){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var b=this.options.updateWhenZooming&&T!==this._tileZoom;(!x||b)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(s),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],s,c)},_setZoomTransform:function(s,c,h){var x=this._map.getZoomScale(h,s.zoom),T=s.origin.multiplyBy(x).subtract(this._map._getNewPixelOrigin(c,h)).round();Ie.any3d?ji(s.el,T,x):nr(s.el,T)},_resetGrid:function(){var s=this._map,c=s.options.crs,h=this._tileSize=this.getTileSize(),x=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],x).x/h.x),Math.ceil(s.project([0,c.wrapLng[1]],x).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],x).y/h.x),Math.ceil(s.project([c.wrapLat[1],0],x).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),x=c.getZoomScale(h,this._tileZoom),T=c.project(s,this._tileZoom).floor(),b=c.getSize().divideBy(x*2);return new ye(T.subtract(b),T.add(b))},_update:function(s){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var x=this._getTiledPixelBounds(s),T=this._pxBoundsToTileRange(x),b=T.getCenter(),X=[],te=this.options.keepBuffer,le=new ye(T.getBottomLeft().subtract([te,-te]),T.getTopRight().add([te,-te]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ke in this._tiles){var Re=this._tiles[ke].coords;(Re.z!==this._tileZoom||!le.contains(new ae(Re.x,Re.y)))&&(this._tiles[ke].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(s,h);return}for(var We=T.min.y;We<=T.max.y;We++)for(var ft=T.min.x;ft<=T.max.x;ft++){var Hr=new ae(ft,We);if(Hr.z=this._tileZoom,!!this._isValidTile(Hr)){var gr=this._tiles[this._tileCoordsToKey(Hr)];gr?gr.current=!0:X.push(Hr)}}if(X.sort(function(en,Os){return en.distanceTo(b)-Os.distanceTo(b)}),X.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var kn=document.createDocumentFragment();for(ft=0;ft<X.length;ft++)this._addTile(X[ft],kn);this._level.el.appendChild(kn)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(s.x<h.min.x||s.x>h.max.x)||!c.wrapLat&&(s.y<h.min.y||s.y>h.max.y))return!1}if(!this.options.bounds)return!0;var x=this._tileCoordsToBounds(s);return q(this.options.bounds).overlaps(x)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,h=this.getTileSize(),x=s.scaleBy(h),T=x.add(h),b=c.unproject(x,s.z),X=c.unproject(T,s.z);return[b,X]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),h=new J(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),h=new ae(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(s){var c=this._tiles[s];c&&(Ht(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){lt(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=m,s.onmousemove=m,Ie.ielt9&&this.options.opacity<1&&yn(s,this.options.opacity)},_addTile:function(s,c){var h=this._getTilePos(s),x=this._tileCoordsToKey(s),T=this.createTile(this._wrapCoords(s),o(this._tileReady,this,s));this._initTile(T),this.createTile.length<2&&B(o(this._tileReady,this,s,null,T)),nr(T,h),this._tiles[x]={el:T,coords:s,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:s})},_tileReady:function(s,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:s});var x=this._tileCoordsToKey(s);h=this._tiles[x],h&&(h.loaded=+new Date,this._map._fadeAnimated?(yn(h.el,0),G(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(lt(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ie.ielt9||!this._map._fadeAnimated?B(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new ae(this._wrapX?d(s.x,this._wrapX):s.x,this._wrapY?d(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new ye(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function rE(s){return new Wo(s)}var Fs=Wo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=_(this,c),c.detectRetina&&Ie.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var h=document.createElement("img");return et(h,"load",o(this._tileOnLoad,this,c,h)),et(h,"error",o(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(s),h},getTileUrl:function(s){var c={r:Ie.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=h),c["-y"]=h}return E(this._url,a(c,this.options))},_tileOnLoad:function(s,c){Ie.ielt9?setTimeout(o(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,h){var x=this.options.errorTileUrl;x&&c.getAttribute("src")!==x&&(c.src=x),s(h,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,x=this.options.zoomOffset;return h&&(s=c-s),s+x},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=m,c.onerror=m,!c.complete)){c.src=I;var h=this._tiles[s].coords;Ht(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",I),Wo.prototype._removeTile.call(this,s)},_tileReady:function(s,c,h){if(!(!this._map||h&&h.getAttribute("src")===I))return Wo.prototype._tileReady.call(this,s,c,h)}});function Km(s,c){return new Fs(s,c)}var Jm=Fs.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var h=a({},this.defaultWmsParams);for(var x in c)x in this.options||(h[x]=c[x]);c=_(this,c);var T=c.detectRetina&&Ie.retina?2:1,b=this.getTileSize();h.width=b.x*T,h.height=b.y*T,this.wmsParams=h},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Fs.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),h=this._crs,x=R(h.project(c[0]),h.project(c[1])),T=x.min,b=x.max,X=(this._wmsVersion>=1.3&&this._crs===Wm?[T.y,T.x,b.y,b.x]:[T.x,T.y,b.x,b.y]).join(","),te=Fs.prototype.getTileUrl.call(this,s);return te+S(this.wmsParams,te,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+X},setParams:function(s,c){return a(this.wmsParams,s),c||this.redraw(),this}});function nE(s,c){return new Jm(s,c)}Fs.WMS=Jm,Km.wms=nE;var Pa=Un.extend({options:{padding:.1},initialize:function(s){_(this,s),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),lt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var h=this._map.getZoomScale(c,this._zoom),x=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),b=x.multiplyBy(-h).add(T).subtract(this._map._getNewPixelOrigin(s,c));Ie.any3d?ji(this._container,b,h):nr(this._container,b)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new ye(h,h.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Qm=Pa.extend({options:{tolerance:0},getEvents:function(){var s=Pa.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Pa.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");et(s,"mousemove",this._onMouseMove,this),et(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),et(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,Ht(this._container),Pt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pa.prototype._update.call(this);var s=this._bounds,c=this._container,h=s.getSize(),x=Ie.retina?2:1;nr(c,s.min),c.width=x*h.x,c.height=x*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",Ie.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Pa.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[u(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,h=c.next,x=c.prev;h?h.prev=x:this._drawLast=x,x?x.next=h:this._drawFirst=h,delete s._order,delete this._layers[u(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),h=[],x,T;for(T=0;T<c.length;T++){if(x=Number(c[T]),isNaN(x))return;h.push(x)}s.options._dashArray=h}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||B(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ye,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var x=this._drawFirst;x;x=x.next)s=x.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var h,x,T,b,X=s._parts,te=X.length,le=this._ctx;if(te){for(le.beginPath(),h=0;h<te;h++){for(x=0,T=X[h].length;x<T;x++)b=X[h][x],le[x?"lineTo":"moveTo"](b.x,b.y);c&&le.closePath()}this._fillStroke(le,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,h=this._ctx,x=Math.max(Math.round(s._radius),1),T=(Math.max(Math.round(s._radiusY),1)||x)/x;T!==1&&(h.save(),h.scale(1,T)),h.beginPath(),h.arc(c.x,c.y/T,x,0,Math.PI*2,!1),T!==1&&h.restore(),this._fillStroke(h,s)}},_fillStroke:function(s,c){var h=c.options;h.fill&&(s.globalAlpha=h.fillOpacity,s.fillStyle=h.fillColor||h.color,s.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=h.opacity,s.lineWidth=h.weight,s.strokeStyle=h.color,s.lineCap=h.lineCap,s.lineJoin=h.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),h,x,T=this._drawFirst;T;T=T.next)h=T.layer,h.options.interactive&&h._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(h))&&(x=h);this._fireEvent(x?[x]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(Qt(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var h,x,T=this._drawFirst;T;T=T.next)h=T.layer,h.options.interactive&&h._containsPoint(c)&&(x=h);x!==this._hoveredLayer&&(this._handleMouseOut(s),x&&(lt(this._container,"leaflet-interactive"),this._fireEvent([x],s,"mouseover"),this._hoveredLayer=x)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,h){this._map._fireDOMEvent(c,h||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var h=c.next,x=c.prev;if(h)h.prev=x;else return;x?x.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var h=c.next,x=c.prev;if(x)x.next=h;else return;h?h.prev=x:x&&(this._drawLast=x),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function eg(s){return Ie.canvas?new Qm(s):null}var $o=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),aE={_initContainer:function(){this._container=Qe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Pa.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=$o("shape");lt(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=$o("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;Ht(c),s.removeInteractiveTarget(c),delete this._layers[u(s)]},_updateStyle:function(s){var c=s._stroke,h=s._fill,x=s.options,T=s._container;T.stroked=!!x.stroke,T.filled=!!x.fill,x.stroke?(c||(c=s._stroke=$o("stroke")),T.appendChild(c),c.weight=x.weight+"px",c.color=x.color,c.opacity=x.opacity,x.dashArray?c.dashStyle=w(x.dashArray)?x.dashArray.join(" "):x.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=x.lineCap.replace("butt","flat"),c.joinstyle=x.lineJoin):c&&(T.removeChild(c),s._stroke=null),x.fill?(h||(h=s._fill=$o("fill")),T.appendChild(h),h.color=x.fillColor||x.color,h.opacity=x.fillOpacity):h&&(T.removeChild(h),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),h=Math.round(s._radius),x=Math.round(s._radiusY||h);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+x+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){Cs(s._container)},_bringToBack:function(s){bs(s._container)}},zc=Ie.vml?$o:it,Go=Pa.extend({_initContainer:function(){this._container=zc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=zc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ht(this._container),Pt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pa.prototype._update.call(this);var s=this._bounds,c=s.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),nr(h,s.min),h.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=zc("path");s.options.className&&lt(c,s.options.className),s.options.interactive&&lt(c,"leaflet-interactive"),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Ht(s._path),s.removeInteractiveTarget(s._path),delete this._layers[u(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,h=s.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,Ze(s._parts,c))},_updateCircle:function(s){var c=s._point,h=Math.max(Math.round(s._radius),1),x=Math.max(Math.round(s._radiusY),1)||h,T="a"+h+","+x+" 0 1,0 ",b=s._empty()?"M0 0":"M"+(c.x-h)+","+c.y+T+h*2+",0 "+T+-h*2+",0 ";this._setPath(s,b)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){Cs(s._path)},_bringToBack:function(s){bs(s._path)}});Ie.vml&&Go.include(aE);function tg(s){return Ie.svg||Ie.vml?new Go(s):null}xt.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&eg(s)||tg(s)}});var rg=Ls.extend({initialize:function(s,c){Ls.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=q(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function iE(s,c){return new rg(s,c)}Go.create=zc,Go.pointsToPath=Ze,La.geometryToLayer=Oc,La.coordsToLatLng=S0,La.coordsToLatLngs=Mc,La.latLngToCoords=T0,La.latLngsToCoords=Rc,La.getFeature=Ps,La.asFeature=Dc,xt.mergeOptions({boxZoom:!0});var ng=la.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){et(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Pt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ht(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Io(),o0(),this._startPoint=this._map.mouseEventToContainerPoint(s),et(document,{contextmenu:Ui,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Qe("div","leaflet-zoom-box",this._container),lt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new ye(this._point,this._startPoint),h=c.getSize();nr(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(Ht(this._box),Qt(this._container,"leaflet-crosshair")),jo(),l0(),Pt(document,{contextmenu:Ui,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new J(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});xt.addInitHook("addHandler","boxZoom",ng),xt.mergeOptions({doubleClickZoom:!0});var ag=la.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,h=c.getZoom(),x=c.options.zoomDelta,T=s.originalEvent.shiftKey?h-x:h+x;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(s.containerPoint,T)}});xt.addInitHook("addHandler","doubleClickZoom",ag),xt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ig=la.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new ri(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}lt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Qt(this._map._container,"leaflet-grab"),Qt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=q(this._map.options.maxBounds);this._offsetLimit=R(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),h=this._initialWorldOffset,x=this._draggable._newPos.x,T=(x-c+h)%s+c-h,b=(x+c+h)%s-c-h,X=Math.abs(T+h)<Math.abs(b+h)?T:b;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=X},_onDragEnd:function(s){var c=this._map,h=c.options,x=!h.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),x)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),b=(this._lastTime-this._times[0])/1e3,X=h.easeLinearity,te=T.multiplyBy(X/b),le=te.distanceTo([0,0]),ke=Math.min(h.inertiaMaxSpeed,le),Re=te.multiplyBy(ke/le),We=ke/(h.inertiaDeceleration*X),ft=Re.multiplyBy(-We/2).round();!ft.x&&!ft.y?c.fire("moveend"):(ft=c._limitOffset(ft,c.options.maxBounds),B(function(){c.panBy(ft,{duration:We,easeLinearity:X,noMoveStart:!0,animate:!0})}))}}});xt.addInitHook("addHandler","dragging",ig),xt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var sg=la.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),et(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Pt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,h=s.scrollTop||c.scrollTop,x=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(x,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},h=this.keyCodes,x,T;for(x=0,T=h.left.length;x<T;x++)c[h.left[x]]=[-1*s,0];for(x=0,T=h.right.length;x<T;x++)c[h.right[x]]=[s,0];for(x=0,T=h.down.length;x<T;x++)c[h.down[x]]=[0,s];for(x=0,T=h.up.length;x<T;x++)c[h.up[x]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},h=this.keyCodes,x,T;for(x=0,T=h.zoomIn.length;x<T;x++)c[h.zoomIn[x]]=s;for(x=0,T=h.zoomOut.length;x<T;x++)c[h.zoomOut[x]]=-s},_addHooks:function(){et(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Pt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,h=this._map,x;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(x=this._panKeys[c],s.shiftKey&&(x=se(x).multiplyBy(3)),h.options.maxBounds&&(x=h._limitOffset(se(x),h.options.maxBounds)),h.options.worldCopyJump){var T=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(x)));h.panTo(T)}else h.panBy(x)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Ui(s)}}});xt.addInitHook("addHandler","keyboard",sg),xt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var og=la.extend({addHooks:function(){et(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Pt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=Pm(s),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var x=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),x),Ui(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),h=this._map.options.zoomSnap||0;s._stop();var x=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(x))))/Math.LN2,b=h?Math.ceil(T/h)*h:T,X=s._limitZoom(c+(this._delta>0?b:-b))-c;this._delta=0,this._startTime=null,X&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+X):s.setZoomAround(this._lastMousePos,c+X))}});xt.addInitHook("addHandler","scrollWheelZoom",og);var sE=600;xt.mergeOptions({tapHold:Ie.touchNative&&Ie.safari&&Ie.mobile,tapTolerance:15});var lg=la.extend({addHooks:function(){et(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Pt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new ae(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(et(document,"touchend",wr),et(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),sE),et(document,"touchend touchcancel contextmenu",this._cancel,this),et(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Pt(document,"touchend",wr),Pt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Pt(document,"touchend touchcancel contextmenu",this._cancel,this),Pt(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new ae(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var h=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});xt.addInitHook("addHandler","tapHold",lg),xt.mergeOptions({touchZoom:Ie.touch,bounceAtZoomLimits:!0});var cg=la.extend({addHooks:function(){lt(this._map._container,"leaflet-touch-zoom"),et(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Qt(this._map._container,"leaflet-touch-zoom"),Pt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(s.touches[0]),x=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(x)._divideBy(2))),this._startDist=h.distanceTo(x),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),et(document,"touchmove",this._onTouchMove,this),et(document,"touchend touchcancel",this._onTouchEnd,this),wr(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(s.touches[0]),x=c.mouseEventToContainerPoint(s.touches[1]),T=h.distanceTo(x)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var b=h._add(x)._divideBy(2)._subtract(this._centerPoint);if(T===1&&b.x===0&&b.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(b),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var X=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=B(X,this,!0),wr(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),Pt(document,"touchmove",this._onTouchMove,this),Pt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});xt.addInitHook("addHandler","touchZoom",cg),xt.BoxZoom=ng,xt.DoubleClickZoom=ag,xt.Drag=ig,xt.Keyboard=sg,xt.ScrollWheelZoom=og,xt.TapHold=lg,xt.TouchZoom=cg,r.Bounds=ye,r.Browser=Ie,r.CRS=we,r.Canvas=Qm,r.Circle=E0,r.CircleMarker=Fc,r.Class=ve,r.Control=zn,r.DivIcon=Ym,r.DivOverlay=ca,r.DomEvent=Sk,r.DomUtil=kk,r.Draggable=ri,r.Evented=me,r.FeatureGroup=Aa,r.GeoJSON=La,r.GridLayer=Wo,r.Handler=la,r.Icon=Ns,r.ImageOverlay=Ic,r.LatLng=Z,r.LatLngBounds=J,r.Layer=Un,r.LayerGroup=As,r.LineUtil=Ik,r.Map=xt,r.Marker=Pc,r.Mixin=Pk,r.Path=ni,r.Point=ae,r.PolyUtil=Fk,r.Polygon=Ls,r.Polyline=Na,r.Popup=jc,r.PosAnimation=Fm,r.Projection=jk,r.Rectangle=rg,r.Renderer=Pa,r.SVG=Go,r.SVGOverlay=qm,r.TileLayer=Fs,r.Tooltip=Bc,r.Transformation=Be,r.Util=K,r.VideoOverlay=Xm,r.bind=o,r.bounds=R,r.canvas=eg,r.circle=Gk,r.circleMarker=$k,r.control=Uo,r.divIcon=tE,r.extend=a,r.featureGroup=Hk,r.geoJSON=Zm,r.geoJson=qk,r.gridLayer=rE,r.icon=Vk,r.imageOverlay=Yk,r.latLng=ne,r.latLngBounds=q,r.layerGroup=Uk,r.map=Tk,r.marker=Wk,r.point=se,r.polygon=Xk,r.polyline=Zk,r.popup=Qk,r.rectangle=iE,r.setOptions=_,r.stamp=u,r.svg=tg,r.svgOverlay=Jk,r.tileLayer=Km,r.tooltip=eE,r.transformation=H,r.version=n,r.videoOverlay=Kk;var oE=window.L;r.noConflict=function(){return window.L=oE,this},window.L=r})})(Rh,Rh.exports);var Ta=Rh.exports;const an=uv(Ta);function rk(e){return e.split(" ").filter(Boolean)}function nk(e,t){rk(t).forEach(r=>{Ta.DomUtil.addClass(e,r)})}function ak(e,t){rk(t).forEach(r=>{Ta.DomUtil.removeClass(e,r)})}function EM(e,t,r){e!=null&&r!==t&&(t!=null&&t.length>0&&ak(e,t),r!=null&&r.length>0&&nk(e,r))}function Ro(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Do(e,t){return t==null?function(n,a){const i=A.useRef();return i.current||(i.current=e(n,a)),i}:function(n,a){const i=A.useRef();i.current||(i.current=e(n,a));const o=A.useRef(n),{instance:l}=i.current;return A.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,a]),i}}function Sm(e,t){A.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var i;(i=t.layerContainer)==null||i.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Tm(e){return function(r){const n=Mo(),a=e(Sc(r,n),n);return vm(n.map,r.attribution),r0(a.current,r.eventHandlers),Sm(a.current,n),a}}function ik(e,t){const r=A.useRef();A.useEffect(function(){if(t.pathOptions!==r.current){const a=t.pathOptions??{};e.instance.setStyle(a),r.current=a}},[e,t])}function sk(e){return function(r){const n=Mo(),a=e(Sc(r,n),n);return r0(a.current,r.eventHandlers),Sm(a.current,n),ik(a.current,r),a}}function SM(e){function t(a,i){return Ro(e(a),i)}const r=Do(t),n=ek(r);return Em(n)}function ok(e,t){const r=Do(e,t),n=Tm(r);return km(n)}function lk(e,t){const r=Do(e),n=tk(r,t);return Qw(n)}function ck(e,t){const r=Do(e,t),n=sk(r);return km(n)}function uk(e,t){const r=Do(e,t),n=Tm(r);return Em(n)}function fk(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function TM(e,t,r){t.bounds instanceof Ta.LatLngBounds&&t.bounds!==r.bounds&&e.setBounds(t.bounds),t.opacity!=null&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),t.zIndex!=null&&t.zIndex!==r.zIndex&&e.setZIndex(t.zIndex)}const CM=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_VERSION:Kw,LeafletContext:ym,LeafletProvider:wm,addClassName:nk,createContainerComponent:km,createControlComponent:SM,createControlHook:ek,createDivOverlayComponent:Qw,createDivOverlayHook:tk,createElementHook:Do,createElementObject:Ro,createLayerComponent:ok,createLayerHook:Tm,createLeafComponent:Em,createLeafletContext:Jw,createOverlayComponent:lk,createPathComponent:ck,createPathHook:sk,createTileLayerComponent:uk,extendContext:_m,removeClassName:ak,updateCircle:kM,updateClassName:EM,updateGridLayer:fk,updateMediaOverlay:TM,useAttribution:vm,useEventHandlers:r0,useLayerLifecycle:Sm,useLeafletContext:Mo,usePathOptions:ik,withPane:Sc},Symbol.toStringTag,{value:"Module"}));function bM(){return Mo().map}function AM(e){const t=bM();return A.useEffect(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}const NM=ck(function({data:t,...r},n){const a=new Ta.GeoJSON(t,r);return Ro(a,_m(n,{overlayContainer:a}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function Dh(){return Dh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dh.apply(this,arguments)}function LM({bounds:e,boundsOptions:t,center:r,children:n,className:a,id:i,placeholder:o,style:l,whenReady:u,zoom:f,...d},m){const[g]=A.useState({className:a,id:i,style:l}),[v,y]=A.useState(null);A.useImperativeHandle(m,()=>(v==null?void 0:v.map)??null,[v]);const _=A.useCallback(k=>{if(k!==null&&v===null){const E=new Ta.Map(k,d);r!=null&&f!=null?E.setView(r,f):e!=null&&E.fitBounds(e,t),u!=null&&E.whenReady(u),y(Jw(E))}},[]);A.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const S=v?ho.createElement(wm,{value:v},n):o??null;return ho.createElement("div",Dh({},g,{ref:_}),S)}const PM=A.forwardRef(LM),Jx=ok(function({position:t,...r},n){const a=new Ta.Marker(t,r);return Ro(a,_m(n,{overlayContainer:a}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),Qx=lk(function(t,r){const n=new Ta.Popup(t,r.overlayContainer);return Ro(n,r)},function(t,r,{position:n},a){A.useEffect(function(){const{instance:o}=t;function l(f){f.popup===o&&(o.update(),a(!0))}function u(f){f.popup===o&&a(!1)}return r.map.on({popupopen:l,popupclose:u}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var d;r.map.off({popupopen:l,popupclose:u}),(d=r.overlayContainer)==null||d.unbindPopup(),r.map.removeLayer(o)}},[t,r,a,n])}),FM=uk(function({url:t,...r},n){const a=new Ta.TileLayer(t,Sc(r,n));return Ro(a,n)},function(t,r,n){fk(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)}),dk=A.createContext({token:null,setToken:()=>{},isAuthenticated:!1,user:null,setUser:()=>{}}),hk=()=>A.useContext(dk),OM=({children:e})=>{const[t,r]=A.useState(localStorage.getItem("token")),[n,a]=A.useState(null),i=!!t;return p.jsx(dk.Provider,{value:{token:t,setToken:r,isAuthenticated:i,user:n,setUser:a},children:e})};var pk={};const MM=Cf(CM);var ev={exports:{}};(function(e,t){(function(r,n){n(t)})(bi,function(r){var n=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(i){L.Util.setOptions(this,i),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var o=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,o?this._withAnimation:this._noAnimation),this._markerCluster=o?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(i){if(i instanceof L.LayerGroup)return this.addLayers([i]);if(!i.getLatLng)return this._nonPointGroup.addLayer(i),this.fire("layeradd",{layer:i}),this;if(!this._map)return this._needsClustering.push(i),this.fire("layeradd",{layer:i}),this;if(this.hasLayer(i))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(i,this._maxZoom),this.fire("layeradd",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var o=i,l=this._zoom;if(i.__parent)for(;o.__parent._zoom>=l;)o=o.__parent;return this._currentShownBounds.contains(o.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(i,o):this._animationAddLayerNonAnimated(i,o)),this},removeLayer:function(i){return i instanceof L.LayerGroup?this.removeLayers([i]):i.getLatLng?this._map?i.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(i)),this._removeLayer(i,!0),this.fire("layerremove",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),i.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(i)&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,i)&&this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}),this):(this._nonPointGroup.removeLayer(i),this.fire("layerremove",{layer:i}),this)},addLayers:function(i,o){if(!L.Util.isArray(i))return this.addLayer(i);var l=this._featureGroup,u=this._nonPointGroup,f=this.options.chunkedLoading,d=this.options.chunkInterval,m=this.options.chunkProgress,g=i.length,v=0,y=!0,_;if(this._map){var S=new Date().getTime(),k=L.bind(function(){var w=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();v<g;v++){if(f&&v%200===0){var N=new Date().getTime()-w;if(N>d)break}if(_=i[v],_ instanceof L.LayerGroup){y&&(i=i.slice(),y=!1),this._extractNonGroupLayers(_,i),g=i.length;continue}if(!_.getLatLng){u.addLayer(_),o||this.fire("layeradd",{layer:_});continue}if(!this.hasLayer(_)&&(this._addLayer(_,this._maxZoom),o||this.fire("layeradd",{layer:_}),_.__parent&&_.__parent.getChildCount()===2)){var I=_.__parent.getAllChildMarkers(),D=I[0]===_?I[1]:I[0];l.removeLayer(D)}}m&&m(v,g,new Date().getTime()-S),v===g?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(k,this.options.chunkDelay)},this);k()}else for(var E=this._needsClustering;v<g;v++){if(_=i[v],_ instanceof L.LayerGroup){y&&(i=i.slice(),y=!1),this._extractNonGroupLayers(_,i),g=i.length;continue}if(!_.getLatLng){u.addLayer(_);continue}this.hasLayer(_)||E.push(_)}return this},removeLayers:function(i){var o,l,u=i.length,f=this._featureGroup,d=this._nonPointGroup,m=!0;if(!this._map){for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}this._arraySplice(this._needsClustering,l),d.removeLayer(l),this.hasLayer(l)&&this._needsRemoving.push({layer:l,latlng:l._latlng}),this.fire("layerremove",{layer:l})}return this}if(this._unspiderfy){this._unspiderfy();var g=i.slice(),v=u;for(o=0;o<v;o++){if(l=g[o],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,g),v=g.length;continue}this._unspiderfyLayer(l)}}for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}if(!l.__parent){d.removeLayer(l),this.fire("layerremove",{layer:l});continue}this._removeLayer(l,!0,!0),this.fire("layerremove",{layer:l}),f.hasLayer(l)&&(f.removeLayer(l),l.clusterShow&&l.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(i){i.off(this._childMarkerEventHandlers,this),delete i.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var i=new L.LatLngBounds;this._topClusterLevel&&i.extend(this._topClusterLevel._bounds);for(var o=this._needsClustering.length-1;o>=0;o--)i.extend(this._needsClustering[o].getLatLng());return i.extend(this._nonPointGroup.getBounds()),i},eachLayer:function(i,o){var l=this._needsClustering.slice(),u=this._needsRemoving,f,d,m;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(l),d=l.length-1;d>=0;d--){for(f=!0,m=u.length-1;m>=0;m--)if(u[m].layer===l[d]){f=!1;break}f&&i.call(o,l[d])}this._nonPointGroup.eachLayer(i,o)},getLayers:function(){var i=[];return this.eachLayer(function(o){i.push(o)}),i},getLayer:function(i){var o=null;return i=parseInt(i,10),this.eachLayer(function(l){L.stamp(l)===i&&(o=l)}),o},hasLayer:function(i){if(!i)return!1;var o,l=this._needsClustering;for(o=l.length-1;o>=0;o--)if(l[o]===i)return!0;for(l=this._needsRemoving,o=l.length-1;o>=0;o--)if(l[o].layer===i)return!1;return!!(i.__parent&&i.__parent._group===this)||this._nonPointGroup.hasLayer(i)},zoomToShowLayer:function(i,o){var l=this._map;typeof o!="function"&&(o=function(){});var u=function(){(l.hasLayer(i)||l.hasLayer(i.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),l.hasLayer(i)?o():i.__parent._icon&&(this.once("spiderfied",o,this),i.__parent.spiderfy()))};i._icon&&this._map.getBounds().contains(i.getLatLng())?o():i.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(i.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),i.__parent.zoomToBounds())},onAdd:function(i){this._map=i;var o,l,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(i),this._nonPointGroup.addTo(i),this._gridClusters||this._generateInitialClusters(),this._maxLat=i.options.crs.projection.MAX_LATITUDE,o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),l=this._needsClustering,this._needsClustering=[],this.addLayers(l,!0)},onRemove:function(i){i.off("zoomend",this._zoomEnd,this),i.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(i){for(var o=i;o&&!o._icon;)o=o.__parent;return o||null},_arraySplice:function(i,o){for(var l=i.length-1;l>=0;l--)if(i[l]===o)return i.splice(l,1),!0},_removeFromGridUnclustered:function(i,o){for(var l=this._map,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());o>=f&&u[o].removeObject(i,l.project(i.getLatLng(),o));o--);},_childMarkerDragStart:function(i){i.target.__dragStart=i.target._latlng},_childMarkerMoved:function(i){if(!this._ignoreMove&&!i.target.__dragStart){var o=i.target._popup&&i.target._popup.isOpen();this._moveChild(i.target,i.oldLatLng,i.latlng),o&&i.target.openPopup()}},_moveChild:function(i,o,l){i._latlng=o,this.removeLayer(i),i._latlng=l,this.addLayer(i)},_childMarkerDragEnd:function(i){var o=i.target.__dragStart;delete i.target.__dragStart,o&&this._moveChild(i.target,o,i.target._latlng)},_removeLayer:function(i,o,l){var u=this._gridClusters,f=this._gridUnclustered,d=this._featureGroup,m=this._map,g=Math.floor(this._map.getMinZoom());o&&this._removeFromGridUnclustered(i,this._maxZoom);var v=i.__parent,y=v._markers,_;for(this._arraySplice(y,i);v&&(v._childCount--,v._boundsNeedUpdate=!0,!(v._zoom<g));)o&&v._childCount<=1?(_=v._markers[0]===i?v._markers[1]:v._markers[0],u[v._zoom].removeObject(v,m.project(v._cLatLng,v._zoom)),f[v._zoom].addObject(_,m.project(_.getLatLng(),v._zoom)),this._arraySplice(v.__parent._childClusters,v),v.__parent._markers.push(_),_.__parent=v.__parent,v._icon&&(d.removeLayer(v),l||d.addLayer(_))):v._iconNeedsUpdate=!0,v=v.__parent;delete i.__parent},_isOrIsParent:function(i,o){for(;o;){if(i===o)return!0;o=o.parentNode}return!1},fire:function(i,o,l){if(o&&o.layer instanceof L.MarkerCluster){if(o.originalEvent&&this._isOrIsParent(o.layer._icon,o.originalEvent.relatedTarget))return;i="cluster"+i}L.FeatureGroup.prototype.fire.call(this,i,o,l)},listens:function(i,o){return L.FeatureGroup.prototype.listens.call(this,i,o)||L.FeatureGroup.prototype.listens.call(this,"cluster"+i,o)},_defaultIconCreateFunction:function(i){var o=i.getChildCount(),l=" marker-cluster-";return o<10?l+="small":o<100?l+="medium":l+="large",new L.DivIcon({html:"<div><span>"+o+"</span></div>",className:"marker-cluster"+l,iconSize:new L.Point(40,40)})},_bindEvents:function(){var i=this._map,o=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(o||u||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),i.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(i){var o=i.layer,l=o;if(!(i.type==="clusterkeypress"&&i.originalEvent&&i.originalEvent.keyCode!==13)){for(;l._childClusters.length===1;)l=l._childClusters[0];l._zoom===this._maxZoom&&l._childCount===o._childCount&&this.options.spiderfyOnMaxZoom?o.spiderfy():this.options.zoomToBoundsOnClick&&o.zoomToBounds(),this.options.spiderfyOnEveryZoom&&o.spiderfy(),i.originalEvent&&i.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(i){var o=this._map;this._inZoomAnimation||(this._shownPolygon&&o.removeLayer(this._shownPolygon),i.layer.getChildCount()>2&&i.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(i.layer.getConvexHull(),this.options.polygonOptions),o.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var i=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,f=this._map;(i||l||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var i=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,i),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),i),this._currentShownBounds=i}},_generateInitialClusters:function(){var i=Math.ceil(this._map.getMaxZoom()),o=Math.floor(this._map.getMinZoom()),l=this.options.maxClusterRadius,u=l;typeof l!="function"&&(u=function(){return l}),this.options.disableClusteringAtZoom!==null&&(i=this.options.disableClusteringAtZoom-1),this._maxZoom=i,this._gridClusters={},this._gridUnclustered={};for(var f=i;f>=o;f--)this._gridClusters[f]=new L.DistanceGrid(u(f)),this._gridUnclustered[f]=new L.DistanceGrid(u(f));this._topClusterLevel=new this._markerCluster(this,o-1)},_addLayer:function(i,o){var l=this._gridClusters,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),d,m;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(i),i.on(this._childMarkerEventHandlers,this);o>=f;o--){d=this._map.project(i.getLatLng(),o);var g=l[o].getNearObject(d);if(g){g._addChild(i),i.__parent=g;return}if(g=u[o].getNearObject(d),g){var v=g.__parent;v&&this._removeLayer(g,!1);var y=new this._markerCluster(this,o,g,i);l[o].addObject(y,this._map.project(y._cLatLng,o)),g.__parent=y,i.__parent=y;var _=y;for(m=o-1;m>v._zoom;m--)_=new this._markerCluster(this,m,_),l[m].addObject(_,this._map.project(g.getLatLng(),m));v._addChild(_),this._removeFromGridUnclustered(g,o);return}u[o].addObject(i,d)}this._topClusterLevel._addChild(i),i.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(i){i instanceof L.MarkerCluster&&i._iconNeedsUpdate&&i._updateIcon()})},_enqueue:function(i){this._queue.push(i),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var i=0;i<this._queue.length;i++)this._queue[i].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var i=Math.round(this._map._zoom);this._processQueue(),this._zoom<i&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,i)):this._zoom>i?(this._animationStart(),this._animationZoomOut(this._zoom,i)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(i){var o=this._maxLat;return o!==void 0&&(i.getNorth()>=o&&(i._northEast.lat=1/0),i.getSouth()<=-o&&(i._southWest.lat=-1/0)),i},_animationAddLayerNonAnimated:function(i,o){if(o===i)this._featureGroup.addLayer(i);else if(o._childCount===2){o._addToMap();var l=o.getAllChildMarkers();this._featureGroup.removeLayer(l[0]),this._featureGroup.removeLayer(l[1])}else o._updateIcon()},_extractNonGroupLayers:function(i,o){var l=i.getLayers(),u=0,f;for(o=o||[];u<l.length;u++){if(f=l[u],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,o);continue}o.push(f)}return o},_overrideMarkerIcon:function(i){var o=i.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[i]}});return o}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(i,o){this._animationAddLayerNonAnimated(i,o)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(i,o){var l=this._getExpandedVisibleBounds(),u=this._featureGroup,f=Math.floor(this._map.getMinZoom()),d;this._ignoreMove=!0,this._topClusterLevel._recursively(l,i,f,function(m){var g=m._latlng,v=m._markers,y;for(l.contains(g)||(g=null),m._isSingleParent()&&i+1===o?(u.removeLayer(m),m._recursivelyAddChildrenToMap(null,o,l)):(m.clusterHide(),m._recursivelyAddChildrenToMap(g,o,l)),d=v.length-1;d>=0;d--)y=v[d],l.contains(y._latlng)||u.removeLayer(y)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(l,o),u.eachLayer(function(m){!(m instanceof L.MarkerCluster)&&m._icon&&m.clusterShow()}),this._topClusterLevel._recursively(l,i,o,function(m){m._recursivelyRestoreChildPositions(o)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(l,i,f,function(m){u.removeLayer(m),m.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(i,o){this._animationZoomOutSingle(this._topClusterLevel,i-1,o),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i,this._getExpandedVisibleBounds())},_animationAddLayer:function(i,o){var l=this,u=this._featureGroup;u.addLayer(i),o!==i&&(o._childCount>2?(o._updateIcon(),this._forceLayout(),this._animationStart(),i._setPos(this._map.latLngToLayerPoint(o.getLatLng())),i.clusterHide(),this._enqueue(function(){u.removeLayer(i),i.clusterShow(),l._animationEnd()})):(this._forceLayout(),l._animationStart(),l._animationZoomOutSingle(o,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(i,o,l){var u=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());i._recursivelyAnimateChildrenInAndAddSelfToMap(u,f,o+1,l);var d=this;this._forceLayout(),i._recursivelyBecomeVisible(u,l),this._enqueue(function(){if(i._childCount===1){var m=i._markers[0];this._ignoreMove=!0,m.setLatLng(m.getLatLng()),this._ignoreMove=!1,m.clusterShow&&m.clusterShow()}else i._recursively(u,l,f,function(g){g._recursivelyRemoveChildrenFromMap(u,f,o+1)});d._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(i){return new L.MarkerClusterGroup(i)};var a=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(i,o,l,u){L.Marker.prototype.initialize.call(this,l?l._cLatLng||l.getLatLng():new L.LatLng(0,0),{icon:this,pane:i.options.clusterPane}),this._group=i,this._zoom=o,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,l&&this._addChild(l),u&&this._addChild(u)},getAllChildMarkers:function(i,o){i=i||[];for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l].getAllChildMarkers(i,o);for(var u=this._markers.length-1;u>=0;u--)o&&this._markers[u].__dragStart||i.push(this._markers[u]);return i},getChildCount:function(){return this._childCount},zoomToBounds:function(i){for(var o=this._childClusters.slice(),l=this._group._map,u=l.getBoundsZoom(this._bounds),f=this._zoom+1,d=l.getZoom(),m;o.length>0&&u>f;){f++;var g=[];for(m=0;m<o.length;m++)g=g.concat(o[m]._childClusters);o=g}u>f?this._group._map.setView(this._latlng,f):u<=d?this._group._map.setView(this._latlng,d+1):this._group._map.fitBounds(this._bounds,i)},getBounds:function(){var i=new L.LatLngBounds;return i.extend(this._bounds),i},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(i,o){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(i),i instanceof L.MarkerCluster?(o||(this._childClusters.push(i),i.__parent=this),this._childCount+=i._childCount):(o||this._markers.push(i),this._childCount++),this.__parent&&this.__parent._addChild(i,!0)},_setClusterCenter:function(i){this._cLatLng||(this._cLatLng=i._cLatLng||i._latlng)},_resetBounds:function(){var i=this._bounds;i._southWest&&(i._southWest.lat=1/0,i._southWest.lng=1/0),i._northEast&&(i._northEast.lat=-1/0,i._northEast.lng=-1/0)},_recalculateBounds:function(){var i=this._markers,o=this._childClusters,l=0,u=0,f=this._childCount,d,m,g,v;if(f!==0){for(this._resetBounds(),d=0;d<i.length;d++)g=i[d]._latlng,this._bounds.extend(g),l+=g.lat,u+=g.lng;for(d=0;d<o.length;d++)m=o[d],m._boundsNeedUpdate&&m._recalculateBounds(),this._bounds.extend(m._bounds),g=m._wLatLng,v=m._childCount,l+=g.lat*v,u+=g.lng*v;this._latlng=this._wLatLng=new L.LatLng(l/f,u/f),this._boundsNeedUpdate=!1}},_addToMap:function(i){i&&(this._backupLatlng=this._latlng,this.setLatLng(i)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(i,o,l){this._recursively(i,this._group._map.getMinZoom(),l-1,function(u){var f=u._markers,d,m;for(d=f.length-1;d>=0;d--)m=f[d],m._icon&&(m._setPos(o),m.clusterHide())},function(u){var f=u._childClusters,d,m;for(d=f.length-1;d>=0;d--)m=f[d],m._icon&&(m._setPos(o),m.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(i,o,l,u){this._recursively(i,u,o,function(f){f._recursivelyAnimateChildrenIn(i,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),l),f._isSingleParent()&&l-1===u?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(i,o,l)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(i,o){this._recursively(i,this._group._map.getMinZoom(),o,null,function(l){l.clusterShow()})},_recursivelyAddChildrenToMap:function(i,o,l){this._recursively(l,this._group._map.getMinZoom()-1,o,function(u){if(o!==u._zoom)for(var f=u._markers.length-1;f>=0;f--){var d=u._markers[f];l.contains(d._latlng)&&(i&&(d._backupLatlng=d.getLatLng(),d.setLatLng(i),d.clusterHide&&d.clusterHide()),u._group._featureGroup.addLayer(d))}},function(u){u._addToMap(i)})},_recursivelyRestoreChildPositions:function(i){for(var o=this._markers.length-1;o>=0;o--){var l=this._markers[o];l._backupLatlng&&(l.setLatLng(l._backupLatlng),delete l._backupLatlng)}if(i-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(i)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(i,o,l,u){var f,d;this._recursively(i,o-1,l-1,function(m){for(d=m._markers.length-1;d>=0;d--)f=m._markers[d],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(m){for(d=m._childClusters.length-1;d>=0;d--)f=m._childClusters[d],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(i,o,l,u,f){var d=this._childClusters,m=this._zoom,g,v;if(o<=m&&(u&&u(this),f&&m===l&&f(this)),m<o||m<l)for(g=d.length-1;g>=0;g--)v=d[g],v._boundsNeedUpdate&&v._recalculateBounds(),i.intersects(v._bounds)&&v._recursively(i,o,l,u,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var i=this.options.opacity;return this.setOpacity(0),this.options.opacity=i,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(i){this._cellSize=i,this._sqCellSize=i*i,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,d=f[u]=f[u]||{},m=d[l]=d[l]||[],g=L.Util.stamp(i);this._objectPoint[g]=o,m.push(i)},updateObject:function(i,o){this.removeObject(i),this.addObject(i,o)},removeObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,d=f[u]=f[u]||{},m=d[l]=d[l]||[],g,v;for(delete this._objectPoint[L.Util.stamp(i)],g=0,v=m.length;g<v;g++)if(m[g]===i)return m.splice(g,1),v===1&&delete d[l],!0},eachObject:function(i,o){var l,u,f,d,m,g,v,y=this._grid;for(l in y){m=y[l];for(u in m)for(g=m[u],f=0,d=g.length;f<d;f++)v=i.call(o,g[f]),v&&(f--,d--)}},getNearObject:function(i){var o=this._getCoord(i.x),l=this._getCoord(i.y),u,f,d,m,g,v,y,_,S=this._objectPoint,k=this._sqCellSize,E=null;for(u=l-1;u<=l+1;u++)if(m=this._grid[u],m){for(f=o-1;f<=o+1;f++)if(g=m[f],g)for(d=0,v=g.length;d<v;d++)y=g[d],_=this._sqDist(S[L.Util.stamp(y)],i),(_<k||_<=k&&E===null)&&(k=_,E=y)}return E},_getCoord:function(i){var o=Math.floor(i/this._cellSize);return isFinite(o)?o:i},_sqDist:function(i,o){var l=o.x-i.x,u=o.y-i.y;return l*l+u*u}},function(){L.QuickHull={getDistant:function(i,o){var l=o[1].lat-o[0].lat,u=o[0].lng-o[1].lng;return u*(i.lat-o[0].lat)+l*(i.lng-o[0].lng)},findMostDistantPointFromBaseLine:function(i,o){var l=0,u=null,f=[],d,m,g;for(d=o.length-1;d>=0;d--){if(m=o[d],g=this.getDistant(m,i),g>0)f.push(m);else continue;g>l&&(l=g,u=m)}return{maxPoint:u,newPoints:f}},buildConvexHull:function(i,o){var l=[],u=this.findMostDistantPointFromBaseLine(i,o);return u.maxPoint?(l=l.concat(this.buildConvexHull([i[0],u.maxPoint],u.newPoints)),l=l.concat(this.buildConvexHull([u.maxPoint,i[1]],u.newPoints)),l):[i[0]]},getConvexHull:function(i){var o=!1,l=!1,u=!1,f=!1,d=null,m=null,g=null,v=null,y=null,_=null,S;for(S=i.length-1;S>=0;S--){var k=i[S];(o===!1||k.lat>o)&&(d=k,o=k.lat),(l===!1||k.lat<l)&&(m=k,l=k.lat),(u===!1||k.lng>u)&&(g=k,u=k.lng),(f===!1||k.lng<f)&&(v=k,f=k.lng)}l!==o?(_=m,y=d):(_=v,y=g);var E=[].concat(this.buildConvexHull([_,y],i),this.buildConvexHull([y,_],i));return E}}}(),L.MarkerCluster.include({getConvexHull:function(){var i=this.getAllChildMarkers(),o=[],l,u;for(u=i.length-1;u>=0;u--)l=i[u].getLatLng(),o.push(l);return L.QuickHull.getConvexHull(o)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var i=this.getAllChildMarkers(null,!0),o=this._group,l=o._map,u=l.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(i.length,u):i.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(i.length,u):(u.y+=10,f=this._generatePointsCircle(i.length,u)),this._animationSpiderfy(i,f)}},unspiderfy:function(i){this._group._inZoomAnimation||(this._animationUnspiderfy(i),this._group._spiderfied=null)},_generatePointsCircle:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+i),u=l/this._2PI,f=this._2PI/i,d=[],m,g;for(u=Math.max(u,35),d.length=i,m=0;m<i;m++)g=this._circleStartAngle+m*f,d[m]=new L.Point(o.x+u*Math.cos(g),o.y+u*Math.sin(g))._round();return d},_generatePointsSpiral:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier,u=l*this._spiralLengthStart,f=l*this._spiralFootSeparation,d=l*this._spiralLengthFactor*this._2PI,m=0,g=[],v;for(g.length=i,v=i;v>=0;v--)v<i&&(g[v]=new L.Point(o.x+u*Math.cos(m),o.y+u*Math.sin(m))._round()),m+=f/u+v*5e-4,u+=d/m;return g},_noanimationUnspiderfy:function(){var i=this._group,o=i._map,l=i._featureGroup,u=this.getAllChildMarkers(null,!0),f,d;for(i._ignoreMove=!0,this.setOpacity(1),d=u.length-1;d>=0;d--)f=u[d],l.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(o.removeLayer(f._spiderLeg),delete f._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:u}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(i,o){var l=this._group,u=l._map,f=l._featureGroup,d=this._group.options.spiderLegPolylineOptions,m,g,v,y;for(l._ignoreMove=!0,m=0;m<i.length;m++)y=u.layerPointToLatLng(o[m]),g=i[m],v=new L.Polyline([this._latlng,y],d),u.addLayer(v),g._spiderLeg=v,g._preSpiderfyLatlng=g._latlng,g.setLatLng(y),g.setZIndexOffset&&g.setZIndexOffset(1e6),f.addLayer(g);this.setOpacity(.3),l._ignoreMove=!1,l.fire("spiderfied",{cluster:this,markers:i})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(i,o){var l=this,u=this._group,f=u._map,d=u._featureGroup,m=this._latlng,g=f.latLngToLayerPoint(m),v=L.Path.SVG,y=L.extend({},this._group.options.spiderLegPolylineOptions),_=y.opacity,S,k,E,w,N,I;for(_===void 0&&(_=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),v?(y.opacity=0,y.className=(y.className||"")+" leaflet-cluster-spider-leg"):y.opacity=_,u._ignoreMove=!0,S=0;S<i.length;S++)k=i[S],I=f.layerPointToLatLng(o[S]),E=new L.Polyline([m,I],y),f.addLayer(E),k._spiderLeg=E,v&&(w=E._path,N=w.getTotalLength()+.1,w.style.strokeDasharray=N,w.style.strokeDashoffset=N),k.setZIndexOffset&&k.setZIndexOffset(1e6),k.clusterHide&&k.clusterHide(),d.addLayer(k),k._setPos&&k._setPos(g);for(u._forceLayout(),u._animationStart(),S=i.length-1;S>=0;S--)I=f.layerPointToLatLng(o[S]),k=i[S],k._preSpiderfyLatlng=k._latlng,k.setLatLng(I),k.clusterShow&&k.clusterShow(),v&&(E=k._spiderLeg,w=E._path,w.style.strokeDashoffset=0,E.setStyle({opacity:_}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:l,markers:i})},200)},_animationUnspiderfy:function(i){var o=this,l=this._group,u=l._map,f=l._featureGroup,d=i?u._latLngToNewLayerPoint(this._latlng,i.zoom,i.center):u.latLngToLayerPoint(this._latlng),m=this.getAllChildMarkers(null,!0),g=L.Path.SVG,v,y,_,S,k,E;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),y=m.length-1;y>=0;y--)v=m[y],v._preSpiderfyLatlng&&(v.closePopup(),v.setLatLng(v._preSpiderfyLatlng),delete v._preSpiderfyLatlng,E=!0,v._setPos&&(v._setPos(d),E=!1),v.clusterHide&&(v.clusterHide(),E=!1),E&&f.removeLayer(v),g&&(_=v._spiderLeg,S=_._path,k=S.getTotalLength()+.1,S.style.strokeDashoffset=k,_.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var w=0;for(y=m.length-1;y>=0;y--)v=m[y],v._spiderLeg&&w++;for(y=m.length-1;y>=0;y--)v=m[y],v._spiderLeg&&(v.clusterShow&&v.clusterShow(),v.setZIndexOffset&&v.setZIndexOffset(0),w>1&&f.removeLayer(v),u.removeLayer(v._spiderLeg),delete v._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:o,markers:m})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(i){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(i))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(i){this._spiderfied&&this._spiderfied.unspiderfy(i)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(i){i._spiderLeg&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow(),i.setZIndexOffset&&i.setZIndexOffset(0),this._map.removeLayer(i._spiderLeg),delete i._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(i){return i?i instanceof L.MarkerClusterGroup?i=i._topClusterLevel.getAllChildMarkers():i instanceof L.LayerGroup?i=i._layers:i instanceof L.MarkerCluster?i=i.getAllChildMarkers():i instanceof L.Marker&&(i=[i]):i=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(i),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(i),this},_flagParentsIconsNeedUpdate:function(i){var o,l;for(o in i)for(l=i[o].__parent;l;)l._iconNeedsUpdate=!0,l=l.__parent},_refreshSingleMarkerModeMarkers:function(i){var o,l;for(o in i)l=i[o],this.hasLayer(l)&&l.setIcon(this._overrideMarkerIcon(l))}}),L.Marker.include({refreshIconOptions:function(i,o){var l=this.options.icon;return L.setOptions(l,i),this.setIcon(l),o&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),r.MarkerClusterGroup=n,r.MarkerCluster=a,Object.defineProperty(r,"__esModule",{value:!0})})})(ev,ev.exports);const RM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",DM=Object.freeze(Object.defineProperty({__proto__:null,default:RM},Symbol.toStringTag,{value:"Module"})),IM=Cf(DM),jM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",BM=Object.freeze(Object.defineProperty({__proto__:null,default:jM},Symbol.toStringTag,{value:"Module"})),zM=Cf(BM),UM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",HM=Object.freeze(Object.defineProperty({__proto__:null,default:UM},Symbol.toStringTag,{value:"Module"})),VM=Cf(HM);var to=bi&&bi.__assign||function(){return to=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},to.apply(this,arguments)},WM=bi&&bi.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},$M=bi&&bi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pk,"__esModule",{value:!0});var Ih=MM,Cm=$M(Ta);delete Cm.default.Icon.Default.prototype._getIconUrl;Cm.default.Icon.Default.mergeOptions({iconRetinaUrl:IM.default,iconUrl:zM.default,shadowUrl:VM.default});function GM(e){var t={},r={};e.children;var n=WM(e,["children"]);return Object.entries(n).forEach(function(a){var i,o,l=a[0],u=a[1];l.startsWith("on")?r=to(to({},r),(i={},i[l]=u,i)):t=to(to({},t),(o={},o[l]=u,o))}),{clusterProps:t,clusterEvents:r}}function ZM(e,t){var r=GM(e),n=r.clusterProps,a=r.clusterEvents,i=new Cm.default.MarkerClusterGroup(n);return Object.entries(a).forEach(function(o){var l=o[0],u=o[1],f="cluster".concat(l.substring(2).toLowerCase());i.on(f,u)}),(0,Ih.createElementObject)(i,(0,Ih.extendContext)(t,{layerContainer:i}))}var XM=function(e,t,r){},qM=(0,Ih.createPathComponent)(ZM,XM),YM=pk.default=qM;delete an.Icon.Default.prototype._getIconUrl;an.Icon.Default.mergeOptions({iconRetinaUrl:"/map-tiles/marker-icon-2x.png",iconUrl:"/map-tiles/marker-icon.png",shadowUrl:"/map-tiles/marker-shadow.png"});const Ln=$e.create({baseURL:Wt,headers:{"Content-Type":"application/json",Accept:"application/json"}});Ln.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ln.interceptors.response.use(e=>e,e=>{if(e.response){if(e.response.status===401)localStorage.removeItem("token"),window.location.href="/login";else if(e.response.status===404)return console.error("Endpoint not found:",e.response.config.url),Promise.reject(new Error("Endpoint non trouv. Veuillez vrifier la configuration du serveur."))}return Promise.reject(e)});const KM=an.icon({iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),JM=an.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#22c55e">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),QM=an.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#ef4444">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),tv=an.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#2563eb">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),eR=an.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),tR=an.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#ef4444" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),rR=an.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#f97316" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),nR=an.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#22c55e" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),aR=`
  .custom-camera-icon {
    background: none;
    border: none;
  }
  .custom-camera-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-camera-icon:hover svg {
    transform: scale(1.1);
  }
  .custom-datacenter-icon {
    background: none;
    border: none;
  }
  .custom-datacenter-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-datacenter-icon:hover svg {
    transform: scale(1.1);
  }
  .leaflet-popup-content-wrapper {
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  .leaflet-popup-content {
    margin: 0;
    min-width: 300px;
    max-width: 500px;
  }
  .datacenter-popup-content {
    padding: 1rem;
    min-width: 300px;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    background: white;
    border-radius: 8px;
  }
`,mk=document.createElement("style");mk.innerText=aR;document.head.appendChild(mk);const rv=(e,t)=>{const r=Math.abs(e),n=Math.floor(r),a=Math.floor((r-n)*60),i=((r-n-a/60)*3600).toFixed(1),o=t?e>=0?"N":"S":e>=0?"E":"W";return`${n}${a}'${i}"${o}`},iR=({onClose:e,position:t,onSuccess:r,onError:n,onCamerasUpdate:a})=>{const[i,o]=A.useState({name:"",ip_address:"",location:`${rv(t[0],!0)} ${rv(t[1],!1)}`,latitude:t[0].toString(),longitude:t[1].toString()}),{isAuthenticated:l,token:u}=hk(),f=A.useRef(null),[d,m]=A.useState(!1),g=async y=>{var _,S,k;if(y.preventDefault(),!l||!u){n("Veuillez vous connecter pour ajouter une camra");return}m(!0);try{if((await Ln.post("/cameras/cameras/",i,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}})).status===201){r("Camra ajoute avec succs");const w=await Ln.get("/cameras/cameras/",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(w.data.results||[]),e()}}catch(E){console.error("Error adding camera:",E),$e.isAxiosError(E)?((_=E.response)==null?void 0:_.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):n(((k=(S=E.response)==null?void 0:S.data)==null?void 0:k.error)||"Erreur lors de l'ajout de la camra"):n("Erreur lors de l'ajout de la camra")}finally{m(!1)}},v=async y=>{var k,E,w,N,I;if(!l||!u){n("Veuillez vous connecter pour importer des camras");return}const _=(k=y.target.files)==null?void 0:k[0];if(!_)return;if(!_.name.endsWith(".csv")){n("Le fichier doit tre au format CSV");return}m(!0);const S=new FormData;S.append("file",_);try{const D=await Ln.post("/cameras/cameras/upload_csv/",S,{headers:{Authorization:`Bearer ${u}`,Accept:"application/json","Content-Type":"multipart/form-data"}});if(D.status===200){r(`Import russi: ${D.data.created} cres, ${D.data.updated} mises  jour`);const P=await Ln.get("/cameras/cameras/",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(P.data.results||[]),e()}}catch(D){console.error("Error uploading CSV:",D),$e.isAxiosError(D)?((E=D.response)==null?void 0:E.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):((w=D.response)==null?void 0:w.status)===400?n(D.response.data.error||"Format de fichier invalide ou donnes manquantes"):n(((I=(N=D.response)==null?void 0:N.data)==null?void 0:I.error)||"Erreur lors de l'importation du fichier CSV"):n("Erreur lors de l'importation du fichier CSV")}finally{m(!1),f.current&&(f.current.value="")}};return p.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white p-4 rounded-t-lg shadow-lg z-50",children:p.jsxs("div",{className:"max-w-4xl mx-auto",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h3",{className:"text-lg font-semibold",children:"Ajouter une camra"}),p.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",disabled:d,children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom"}),p.jsx("input",{type:"text",value:i.name,onChange:y=>o({...i,name:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP"}),p.jsx("input",{type:"text",value:i.ip_address,onChange:y=>o({...i,ip_address:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Emplacement"}),p.jsx("input",{type:"text",value:i.location,onChange:y=>o({...i,location:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Format: Latitude, Longitude",disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude"}),p.jsx("input",{type:"text",value:i.latitude,onChange:y=>o({...i,latitude:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude"}),p.jsx("input",{type:"text",value:i.longitude,onChange:y=>o({...i,longitude:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("input",{type:"file",ref:f,onChange:v,accept:".csv",className:"hidden",id:"csv-upload",disabled:d}),p.jsx("label",{htmlFor:"csv-upload",className:`px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer ${d?"opacity-50 cursor-not-allowed":""}`,children:d?"Import en cours...":"Importer CSV"}),p.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:d,children:"Annuler"}),p.jsx("button",{type:"submit",className:`px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 ${d?"opacity-50 cursor-not-allowed":""}`,disabled:d,children:d?"Ajout en cours...":"Ajouter"})]})]})]})})},sR=({onMapClick:e})=>(AM({click:t=>{e(t.latlng.lat,t.latlng.lng)}}),null),oR=()=>{const[e,t]=A.useState(null),[r,n]=A.useState([]),[a,i]=A.useState([]),[o,l]=A.useState({}),[u,f]=A.useState({}),[d,m]=A.useState(!1),[g,v]=A.useState([0,0]),[y,_]=A.useState(null),[S,k]=A.useState(null),[E,w]=A.useState({}),[N,I]=A.useState({}),{isAuthenticated:D,token:P}=hk(),V=A.useRef(null);A.useState(!1),A.useState(null);const[z,W]=A.useState("all"),[B,G]=A.useState("all"),[K,ve]=A.useState(""),[xe,he]=A.useState(!1),me=A.useRef(null),[ae,Y]=A.useState({}),[se,ye]=A.useState([]);A.useState(null),A.useState(!1);const[R,J]=A.useState(!1),q=pe=>{Y(Pe=>({...Pe,[pe]:!Pe[pe]}))},Z=async()=>{var pe;try{const Pe=localStorage.getItem("token");if(!Pe){_("Token non trouv. Veuillez vous reconnecter.");return}const Fe=await Ln.get("/datacenters/",{headers:{Authorization:`Bearer ${Pe}`,"Content-Type":"application/json",Accept:"application/json"}});Fe.data.results&&i(Fe.data.results)}catch(Pe){console.error("Error fetching datacenters:",Pe),$e.isAxiosError(Pe)&&(((pe=Pe.response)==null?void 0:pe.status)===401?(_("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):_("Erreur lors du chargement des datacenters"))}},ne=async pe=>{try{f(Fe=>({...Fe,[pe]:!0}));const Pe=await Ln.get("/firewalls/firewall-types/",{params:{data_center:pe},headers:{"Content-Type":"application/json",Accept:"application/json"}});Pe.data.results&&l(Fe=>({...Fe,[pe]:Pe.data.results}))}catch(Pe){console.error("Error fetching firewall types:",Pe),_("Erreur lors de la rcupration des types de pare-feu")}finally{f(Pe=>({...Pe,[pe]:!1}))}},we=pe=>{_(pe),me.current&&clearTimeout(me.current),me.current=window.setTimeout(()=>{window.location.reload()},3e3)};A.useEffect(()=>{const pe=localStorage.getItem("token");if(!pe){we("Veuillez vous connecter pour accder  cette page");return}return Ln.get(z1.CAMERAS.LIST,{headers:{Authorization:`Bearer ${pe}`,"Content-Type":"application/json",Accept:"application/json"}}).then(()=>{he(!0)}).catch(Pe=>{var Fe;((Fe=Pe.response)==null?void 0:Fe.status)===401?(we("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):_("Erreur de connexion au serveur")}),()=>{me.current&&clearTimeout(me.current)}},[]),A.useEffect(()=>{xe&&(an.Marker.prototype.options.icon=KM,t(e))},[xe]),A.useEffect(()=>xe?((async()=>{var Pe;try{const Fe=localStorage.getItem("token");if(!Fe){_("Token non trouv. Veuillez vous reconnecter.");return}let Ve=[],pt=z1.CAMERAS.LIST;for(;pt;){const ut=await Ln.get(pt,{headers:{Authorization:`Bearer ${Fe}`,"Content-Type":"application/json",Accept:"application/json"}});ut.data.results&&(Ve=[...Ve,...ut.data.results]),pt=ut.data.next}n(Ve),_(null)}catch(Fe){console.error("Error fetching cameras:",Fe),$e.isAxiosError(Fe)&&((Pe=Fe.response)==null?void 0:Pe.status)===401?(_("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):_("Erreur lors du chargement des camras"),n([])}})(),Z(),()=>{an.Marker.prototype.options.icon=void 0}):void 0,[xe]),A.useEffect(()=>{(async()=>{try{const Fe=(await Ln.get("/datacenters/")).data.results||[];ye(Fe)}catch{_("Erreur lors du chargement des donnes")}})()},[]);const Le=(pe,Pe)=>{if(!D||!P){we("Veuillez vous connecter pour ajouter une camra");return}v([pe,Pe]),m(!0)},be=async pe=>{try{w(Ve=>({...Ve,[pe]:{status:"loading",responseTime:null}}));const Fe=await(await fetch(`${Wt}/cameras/cameras/${pe}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();w(Ve=>({...Ve,[pe]:{status:Fe.status,responseTime:Fe.response_time,lastUpdate:Date.now()}}))}catch(Pe){console.error("Error pinging camera:",Pe),w(Fe=>({...Fe,[pe]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},_e=async pe=>{try{I(Ve=>({...Ve,[pe]:{status:"loading",responseTime:null}}));const Fe=await(await fetch(`${Wt}/firewalls/${pe}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();I(Ve=>({...Ve,[pe]:{status:Fe.status,responseTime:Fe.response_time,lastUpdate:Date.now()}}))}catch(Pe){console.error("Error pinging firewall:",Pe),I(Fe=>({...Fe,[pe]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},Be=pe=>{try{return decodeURIComponent(escape(pe))}catch(Pe){return console.warn("Error fixing encoding:",Pe),pe}},H=pe=>{if(!pe)return!0;const Pe=5*60*1e3;return Date.now()-pe>Pe},Ye=pe=>{const Pe=E[pe];if(!Pe||H(Pe.lastUpdate))return tv;switch(Pe.status){case"online":return JM;case"offline":return QM;default:return tv}},nt=()=>{const pe=K.toLowerCase(),Pe=r.filter(Ve=>{var St;if(!(z!=="datacenters"&&(Ve.name.toLowerCase().includes(pe)||Ve.ip_address.toLowerCase().includes(pe)||Ve.location.toLowerCase().includes(pe))))return!1;if(B==="all")return!0;const ut=(St=E[Ve.id])==null?void 0:St.status;return B==="online"?ut==="online":B==="offline"?ut==="offline"||ut==="error":!0}),Fe=a.filter(Ve=>z!=="cameras"&&(Ve.name.toLowerCase().includes(pe)||Ve.location.toLowerCase().includes(pe))?B==="all"?!0:B==="online"?Ve.is_active:B==="offline"?!Ve.is_active:!0:!1);return{cameras:Pe,datacenters:Fe}},{cameras:it,datacenters:Ze}=nt(),Ae=pe=>{var pt;let Pe=0,Fe=0,Ve=!1;return(pt=o[pe])==null||pt.forEach(ut=>{var St;(St=ut.firewalls)==null||St.forEach(jt=>{const Xt=N[jt.id];Xt&&!H(Xt.lastUpdate)?(Pe++,Xt.status==="online"&&Fe++):Ve=!0})}),Pe===0||Ve?eR:Fe===Pe?nR:Fe===0?tR:rR},Et=async pe=>{var Pe,Fe,Ve;if(!D||!P){_("Veuillez vous connecter pour supprimer une camra");return}try{(await Ln.delete(`/cameras/cameras/${pe}/`,{headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json",Accept:"application/json"}})).status===204&&(k("Camra supprime avec succs"),n(ut=>ut.filter(St=>St.id!==pe)))}catch(pt){console.error("Error deleting camera:",pt),$e.isAxiosError(pt)?((Pe=pt.response)==null?void 0:Pe.status)===401?(_("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):_(((Ve=(Fe=pt.response)==null?void 0:Fe.data)==null?void 0:Ve.error)||"Erreur lors de la suppression de la camra"):_("Erreur lors de la suppression de la camra")}};return p.jsxs("div",{className:"relative h-full w-full",children:[y&&p.jsx("div",{className:"absolute top-4 left-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50",children:p.jsx("p",{children:y})}),R&&p.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})}),p.jsxs(PM,{center:[31.7917,-7.0926],zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,ref:V,attributionControl:!0,zoomControl:!0,children:[p.jsx(FM,{url:"/map-tiles/{z}/{x}/{y}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,minZoom:2,errorTileUrl:"/map-tiles/error-tile.png",tileSize:256,noWrap:!0,bounds:[[27.6621,-13.1684],[35.9228,-.9984]]}),p.jsx(sR,{onMapClick:Le}),e&&p.jsx(NM,{data:e,style:{color:"#2563eb",weight:2,fillOpacity:.1,fillColor:"#3b82f6"},onEachFeature:(pe,Pe)=>{var Fe;Pe.bindPopup(`
                <div class="p-2">
                  <h3 class="font-semibold text-lg">${pe.properties.ADMIN}</h3>
                  <p class="text-sm">Population: ${((Fe=pe.properties.POP_EST)==null?void 0:Fe.toLocaleString())||"N/A"}</p>
                </div>
              `)}}),p.jsx(YM,{chunkedLoading:!0,maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:pe=>an.divIcon({html:`<div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${pe.getChildCount()}</div>`,className:"custom-cluster-icon",iconSize:an.point(32,32)}),children:it.map(pe=>{var Pe,Fe,Ve,pt,ut,St,jt,Xt;if(pe.latitude&&pe.longitude){const bt=parseFloat(pe.latitude),Ut=parseFloat(pe.longitude);if(!isNaN(bt)&&!isNaN(Ut))return p.jsx(Jx,{position:[bt,Ut],icon:Ye(pe.id),riseOnHover:!0,children:p.jsx(Qx,{children:p.jsxs("div",{className:"p-2 min-w-[200px]",children:[p.jsx("h3",{className:"font-semibold text-lg",children:Be(pe.name)}),p.jsxs("p",{className:"text-sm",children:["IP: ",pe.ip_address]}),p.jsxs("p",{className:"text-sm",children:["Latitude: ",bt]}),p.jsxs("p",{className:"text-sm",children:["Longitude: ",Ut]}),p.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[p.jsxs("button",{onClick:He=>{He.preventDefault(),be(pe.id)},className:`px-3 py-1 rounded-md text-white text-sm flex items-center gap-2 ${((Pe=E[pe.id])==null?void 0:Pe.status)==="loading"?"bg-gray-400":((Fe=E[pe.id])==null?void 0:Fe.status)==="online"?"bg-green-500":((Ve=E[pe.id])==null?void 0:Ve.status)==="offline"?"bg-red-500":"bg-blue-500"}`,disabled:((pt=E[pe.id])==null?void 0:pt.status)==="loading",children:[((ut=E[pe.id])==null?void 0:ut.status)==="loading"?p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((St=E[pe.id])==null?void 0:St.status)==="online"?p.jsx(V1,{className:"w-4 h-4"}):((jt=E[pe.id])==null?void 0:jt.status)==="offline"?p.jsx(H1,{className:"w-4 h-4"}):"Ping",((Xt=E[pe.id])==null?void 0:Xt.status)==="online"&&E[pe.id].responseTime&&p.jsxs("span",{children:[Math.round(E[pe.id].responseTime||0),"ms"]})]}),p.jsxs("button",{onClick:He=>{He.preventDefault(),window.confirm("tes-vous sr de vouloir supprimer cette camra ?")&&Et(pe.id)},className:"px-3 py-1 rounded-md text-white text-sm bg-red-500 hover:bg-red-600 flex items-center gap-2",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Supprimer"]})]})]})})},pe.id)}return null})}),Ze.map(pe=>pe.latitude&&pe.longitude?p.jsx(Jx,{position:[pe.latitude,pe.longitude],icon:Ae(pe.id),riseOnHover:!0,eventHandlers:{click:()=>{o[pe.id]||ne(pe.id)}},children:p.jsx(Qx,{children:p.jsxs("div",{className:"datacenter-popup-content",children:[p.jsxs("div",{className:"border-b border-gray-200 pb-3 mb-4",children:[p.jsxs("h3",{className:"font-semibold text-lg text-purple-700 flex items-center gap-2",children:[p.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.5L20 8v8l-8 4-8-4V8l8-3.5z",fill:"currentColor"})}),pe.name]}),pe.location&&p.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[p.jsx("span",{className:"font-medium",children:"Adresse:"})," ",pe.location]}),p.jsx("div",{className:"mt-2",children:p.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${pe.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:pe.is_active?"Actif":"Inactif"})})]}),p.jsxs("div",{className:"mt-4",children:[p.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-3 flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),"Types de Firewall"]}),u[pe.id]?p.jsxs("div",{className:"flex items-center justify-center py-4",children:[p.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-purple-500 border-t-transparent"}),p.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Chargement des firewalls..."})]}):o[pe.id]?p.jsx("div",{className:"space-y-3",children:o[pe.id].map(Pe=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[p.jsx("div",{className:"bg-purple-50 p-3 border-b border-purple-100 cursor-pointer hover:bg-purple-100 transition-colors",onClick:()=>q(Pe.id),children:p.jsxs("div",{className:"font-medium text-sm text-purple-700 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),Pe.name]}),p.jsx("svg",{className:`w-4 h-4 transform transition-transform ${ae[Pe.id]?"rotate-180":""}`,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M7 10l5 5 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),ae[Pe.id]&&p.jsx("div",{className:"p-3",children:Pe.firewalls&&Pe.firewalls.length>0?p.jsx("div",{className:"space-y-2",children:Pe.firewalls.map(Fe=>{var Ve,pt,ut,St,jt,Xt,bt,Ut;return p.jsx("div",{className:"bg-gray-50 rounded-md p-3 hover:bg-gray-100 transition-colors",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm",children:p.jsx("svg",{className:"w-4 h-4 text-purple-600",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})})}),p.jsxs("div",{children:[p.jsx("div",{className:"font-medium text-sm",children:Fe.name}),p.jsx("div",{className:"text-xs text-gray-500 mt-1",children:Fe.ip_address})]})]}),p.jsxs("button",{onClick:He=>{He.stopPropagation(),_e(Fe.id)},className:`px-3 py-1.5 rounded-md text-white text-sm flex items-center gap-2 transition-colors ${((Ve=N[Fe.id])==null?void 0:Ve.status)==="loading"?"bg-gray-400":((pt=N[Fe.id])==null?void 0:pt.status)==="online"?"bg-green-500 hover:bg-green-600":((ut=N[Fe.id])==null?void 0:ut.status)==="offline"?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600"}`,disabled:((St=N[Fe.id])==null?void 0:St.status)==="loading",children:[((jt=N[Fe.id])==null?void 0:jt.status)==="loading"?p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((Xt=N[Fe.id])==null?void 0:Xt.status)==="online"?p.jsx(V1,{className:"w-4 h-4"}):((bt=N[Fe.id])==null?void 0:bt.status)==="offline"?p.jsx(H1,{className:"w-4 h-4"}):"Ping",((Ut=N[Fe.id])==null?void 0:Ut.status)==="online"&&N[Fe.id].responseTime&&p.jsxs("span",{children:[Math.round(N[Fe.id].responseTime||0),"ms"]})]})]})},Fe.id)})}):p.jsx("div",{className:"text-sm text-gray-500 italic text-center py-2",children:"Aucun firewall associ"})})]},Pe.id))}):p.jsx("div",{className:"text-sm text-gray-500 text-center py-4",children:"Aucun type de firewall trouv"})]})]})})},`dc-${pe.id}`):null)]}),d&&D&&P&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1000]",onClick:()=>m(!1)}),p.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-[1001]",children:p.jsx(iR,{onClose:()=>m(!1),position:g,onSuccess:pe=>{k(pe),setTimeout(()=>k(null),3e3)},onError:pe=>{_(pe),setTimeout(()=>_(null),3e3)},onCamerasUpdate:n})})]}),y&&p.jsxs("div",{className:"absolute top-4 left-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-[1002] flex items-center justify-between",children:[p.jsx("span",{children:y}),y.includes("connecter")&&p.jsx("button",{onClick:()=>window.location.reload(),className:"ml-4 px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Rafrachir"})]}),S&&p.jsx("div",{className:"absolute top-4 left-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded z-[1002]",children:S})]})};function gd(){const{id:e}=T4(),t=ka(),[r,n]=A.useState(""),[a,i]=A.useState(""),[o,l]=A.useState([]),[u,f]=A.useState([]),[d,m]=A.useState({name:"",description:""}),[g,v]=A.useState(null),[y,_]=A.useState(!1),[S,k]=A.useState(null),E=A.useRef(null),w=async()=>{try{const K=await Bs.getVariables();if(Array.isArray(K)){const ve=K.sort((xe,he)=>xe.name.localeCompare(he.name));l(ve)}else l([])}catch{k("Erreur lors du chargement des variables"),l([])}},N=async()=>{try{_(!0);const K=await js.getTemplates();Array.isArray(K)?f(K):f([])}catch{k("Erreur lors du chargement des templates"),f([])}finally{_(!1)}};A.useEffect(()=>{e&&I(e),w(),N()},[e]);const I=async K=>{try{_(!0);const ve=await js.getTemplate(parseInt(K)),xe=await Bs.getVariables();i(ve.name),n(ve.content),l(xe)}catch{k("Erreur lors du chargement du template")}finally{_(!1)}},D=K=>{if(E.current){const ve=E.current,xe=ve.selectionStart,he=ve.selectionEnd,me=ve.value,ae=me.substring(0,xe)+`{{ ${K} }}`+me.substring(he);n(ae),setTimeout(()=>{ve.focus(),ve.setSelectionRange(xe+K.length+6,xe+K.length+6)},0)}},P=async()=>{if(!d.name||!d.description){k("Veuillez remplir tous les champs de la variable");return}try{_(!0);const K=await Bs.createVariable(d);e&&await Bs.addVariableToTemplate(parseInt(e),K.id),m({name:"",description:""}),await w()}catch{k("Erreur lors de l'ajout de la variable")}finally{_(!1)}},V=async K=>{try{_(!0),await Bs.deleteVariable(K),await w()}catch{k("Erreur lors de la suppression de la variable")}finally{_(!1)}},z=async()=>{if(!a){k("Veuillez donner un nom au template");return}try{_(!0);const K={name:a,content:r};e?await js.updateTemplate(parseInt(e),K):await js.createTemplate({...K,description:"",variables:[]}),t("/templates")}catch{k("Erreur lors de la sauvegarde du template")}finally{_(!1)}},W=async K=>{if(window.confirm("tes-vous sr de vouloir supprimer ce template ?"))try{_(!0),await js.deleteTemplate(K),await N()}catch{k("Erreur lors de la suppression du template")}finally{_(!1)}},B=async K=>{try{_(!0);const ve=await $e.get(`${Wt}/templates/${K}/download_excel/`,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),xe=new Blob([ve.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),he=window.URL.createObjectURL(xe),me=document.createElement("a");me.href=he,me.download=`template_${K}_${new Date().toISOString()}.xlsx`,document.body.appendChild(me),me.click(),document.body.removeChild(me),window.URL.revokeObjectURL(he)}catch(ve){console.error("Error downloading Excel file:",ve),k("Failed to download Excel file")}finally{_(!1)}},G=async()=>{_(!0);try{await Promise.all([w(),N()])}catch{k("Erreur lors du rafrachissement")}finally{_(!1)}};return y?p.jsx("div",{className:"p-8 flex items-center justify-center",children:p.jsx(nl,{className:"w-8 h-8 animate-spin text-purple-600"})}):p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"Modifier le Template":"Nouveau Template"}),p.jsx("p",{className:"text-gray-600",children:"Crez et modifiez vos templates avec des variables dynamiques"})]}),p.jsx("button",{onClick:G,disabled:y,className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",title:"Rafrachir",children:y?p.jsx(nl,{className:"w-5 h-5 animate-spin"}):p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})})]}),S&&p.jsx("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded-md",children:S}),p.jsxs("div",{className:"flex gap-6",children:[p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{htmlFor:"templateName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du Template"}),p.jsx("input",{id:"templateName",name:"templateName",type:"text",value:a,onChange:K=>i(K.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"Entrez le nom du template"})]}),p.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:p.jsx("textarea",{ref:E,value:r,onChange:K=>n(K.target.value),className:"w-full h-[500px] p-4 font-mono text-sm bg-gray-900 text-gray-100 border-0 focus:ring-0 resize-none",placeholder:"Entrez le contenu du template ici...",style:{lineHeight:"1.5",tabSize:2}})}),p.jsxs("div",{className:"mt-4 flex gap-4",children:[p.jsxs("button",{onClick:z,disabled:y,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:[y?p.jsx(nl,{className:"w-5 h-5 mr-2 animate-spin"}):p.jsx(u2,{className:"w-5 h-5 mr-2"}),y?"Enregistrement...":"Enregistrer"]}),p.jsxs("button",{onClick:()=>t("/templates"),className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[p.jsx(Q3,{className:"w-5 h-5 mr-2"}),"Retour"]}),e&&p.jsxs("button",{onClick:()=>W(parseInt(e)),disabled:y,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:[p.jsx(Pn,{className:"w-5 h-5 mr-2"}),"Supprimer"]})]})]}),p.jsx("div",{className:"w-80",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Variables Disponibles"}),p.jsx("div",{className:"space-y-4 mb-6",children:o&&o.length>0?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"mb-4",children:[p.jsxs("h3",{className:"text-sm font-medium text-purple-600 mb-2 flex items-center",children:[p.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),"Variables Requises"]}),p.jsx("div",{className:"space-y-2",children:o.filter(K=>["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(K.name)).map(K=>p.jsxs("div",{className:"group relative",children:[p.jsxs("div",{className:"flex items-center justify-between p-2 bg-purple-50 hover:bg-purple-100 rounded-md transition-colors duration-200",children:[p.jsx("button",{onClick:()=>D(K.name),className:"flex-1 text-left flex items-center",children:p.jsx("span",{className:"text-purple-700 font-medium",children:K.name})}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(yh,{className:"w-4 h-4 text-purple-400"}),p.jsx("button",{onClick:()=>V(K.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:p.jsx(Pn,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===K.name&&p.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:K.description})]},`variable-${K.id||K.name}`))})]}),p.jsxs("div",{children:[p.jsxs("h3",{className:"text-sm font-medium text-gray-600 mb-2 flex items-center",children:[p.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),"Variables Personnalises"]}),p.jsx("div",{className:"space-y-2",children:o.filter(K=>!["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(K.name)).map(K=>p.jsxs("div",{className:"group relative",children:[p.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 hover:bg-gray-100 rounded-md transition-colors duration-200",children:[p.jsx("button",{onClick:()=>D(K.name),className:"flex-1 text-left flex items-center",children:p.jsx("span",{className:"text-gray-700",children:K.name})}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(yh,{className:"w-4 h-4 text-gray-400"}),p.jsx("button",{onClick:()=>V(K.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:p.jsx(Pn,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===K.name&&p.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:K.description})]},`variable-${K.id||K.name}`))})]})]}):p.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucune variable disponible"})}),p.jsxs("div",{className:"border-t pt-4",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Ajouter une variable"}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"variableName",className:"block text-sm text-gray-600 mb-1",children:"Nom de la variable"}),p.jsx("input",{id:"variableName",name:"variableName",type:"text",value:d.name,onChange:K=>m({...d,name:K.target.value}),placeholder:"Nom de la variable",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"variableDescription",className:"block text-sm text-gray-600 mb-1",children:"Description"}),p.jsx("input",{id:"variableDescription",name:"variableDescription",type:"text",value:d.description,onChange:K=>m({...d,description:K.target.value}),placeholder:"Description",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),p.jsxs("button",{onClick:P,disabled:y,className:"w-full flex items-center justify-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:[y?p.jsx(nl,{className:"w-4 h-4 mr-2 animate-spin"}):p.jsx(Js,{className:"w-4 h-4 mr-2"}),"Ajouter"]})]})]}),p.jsxs("div",{className:"border-t mt-6 pt-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Templates"}),p.jsxs("button",{onClick:()=>t("/templates/new"),className:"flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm",children:[p.jsx(Js,{className:"w-4 h-4 mr-1"}),"Nouveau"]})]}),p.jsx("div",{className:"space-y-3",children:y?p.jsx("div",{className:"flex justify-center py-4",children:p.jsx(nl,{className:"w-6 h-6 animate-spin text-purple-600"})}):u&&u.length>0?u.map(K=>p.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 hover:bg-gray-100 rounded-md",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("div",{className:"font-medium text-gray-900",children:K.name}),p.jsxs("div",{className:"text-sm text-gray-500",children:["Cr le: ",K.created_at?new Date(K.created_at).toLocaleDateString():"N/A"]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:()=>t(`/templates/${K.id}`),className:"p-1 text-blue-500 hover:text-blue-700",title:"Modifier",children:p.jsx(ib,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>B(K.id),className:"p-1 text-green-500 hover:text-green-700",title:"Tlcharger Excel",children:p.jsx(tb,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>W(K.id),className:"p-1 text-red-500 hover:text-red-700",title:"Supprimer",children:p.jsx(Pn,{className:"w-4 h-4"})})]})]},`template-${K.id}`)):p.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucun template disponible"})})]})]})})]})]})}function lR(){const e=ka(),[t,r]=A.useState(null),[n,a]=A.useState(!1),[i,o]=A.useState({}),[l,u]=A.useState(null),[f,d]=A.useState(null),[m,g]=A.useState(null),[v,y]=A.useState(!1),[_,S]=A.useState(null),[k,E]=A.useState(!1),[w,N]=A.useState({current_password:"",new_password:"",confirm_password:""});A.useEffect(()=>{(async()=>{try{const z=await Zr.get("/auth/users/me/");r(z.data),o(z.data),u(null)}catch(z){console.error("Error fetching user profile data:",z),u(z.message)}})()},[]);const I=async V=>{V.preventDefault();try{console.log("Updating user data:",i);const z=await Zr.put("/auth/users/update_user_info/",i);console.log("Update response:",z.data),z.data&&(r(z.data.user),a(!1),u(null))}catch(z){console.error("Error updating user data:",z),u(z.message)}},D=async V=>{var z,W;if(V.preventDefault(),d(null),g(null),w.new_password!==w.confirm_password){d("Les mots de passe ne correspondent pas");return}if(w.new_password.length<8){d("Le mot de passe doit contenir au moins 8 caractres");return}try{(await Zr.put("/auth/users/update_user_info/",{current_password:w.current_password,password:w.new_password})).data&&(g("Mot de passe mis  jour avec succs"),N({current_password:"",new_password:"",confirm_password:""}))}catch(B){console.error("Error updating password:",B),d(((W=(z=B.response)==null?void 0:z.data)==null?void 0:W.error)||"Erreur lors de la mise  jour du mot de passe")}},P=async()=>{var V,z;E(!0),S(null);try{await Zr.delete("/auth/users/me/"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e("/login")}catch(W){console.error("Error deleting profile:",W),S(((z=(V=W.response)==null?void 0:V.data)==null?void 0:z.error)||"Erreur lors de la suppression du profil"),y(!1)}finally{E(!1)}};return l?p.jsx("div",{className:"max-w-2xl mx-auto p-6",children:p.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:p.jsxs("p",{className:"text-red-600",children:["Error: ",l]})})}):t?p.jsx("div",{className:"max-w-2xl mx-auto p-6",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[p.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:p.jsx(wo,{className:"h-8 w-8 text-purple-600"})}),p.jsxs("div",{children:[p.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[t.first_name," ",t.last_name]}),p.jsxs("p",{className:"text-gray-600",children:["@",t.username]})]})]}),p.jsxs("form",{onSubmit:I,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(wo,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"text",value:i.username||"",onChange:V=>o({...i,username:V.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),p.jsx("input",{type:"text",value:i.first_name||"",onChange:V=>o({...i,first_name:V.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),p.jsx("input",{type:"text",value:i.last_name||"",onChange:V=>o({...i,last_name:V.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(l2,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"email",value:i.email||"",onChange:V=>o({...i,email:V.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(c2,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"tel",value:i.phone_number||"",onChange:V=>o({...i,phone_number:V.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsx("div",{className:"flex justify-end space-x-4 mt-6",children:n?p.jsxs(p.Fragment,{children:[p.jsx("button",{type:"button",onClick:()=>{a(!1),o(t)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),p.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[p.jsx(u2,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}):p.jsx("button",{type:"button",onClick:()=>a(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Edit Profile"})})]}),p.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[p.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),p.jsxs("form",{onSubmit:D,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(Ba,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"password",value:w.current_password,onChange:V=>N({...w,current_password:V.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(Ba,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"password",value:w.new_password,onChange:V=>N({...w,new_password:V.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(Ba,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"password",value:w.confirm_password,onChange:V=>N({...w,confirm_password:V.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),f&&p.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:p.jsx("p",{className:"text-red-600",children:f})}),m&&p.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:p.jsx("p",{className:"text-green-600",children:m})}),p.jsx("div",{className:"flex justify-end",children:p.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[p.jsx(Ba,{className:"h-4 w-4 mr-2"}),"Change Password"]})})]})]}),p.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[p.jsx("h2",{className:"text-lg font-medium text-red-600 mb-4",children:"Zone de danger"}),p.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[p.jsx("p",{className:"text-red-600 mb-4",children:"La suppression de votre compte est irrversible. Toutes vos donnes seront dfinitivement supprimes."}),p.jsxs("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center",children:[p.jsx(Pn,{className:"h-4 w-4 mr-2"}),"Supprimer mon compte"]})]})]}),v&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[p.jsx("h3",{className:"text-lg font-medium text-red-600 mb-4",children:"Confirmer la suppression"}),p.jsx("p",{className:"text-gray-600 mb-4",children:"tes-vous sr de vouloir supprimer votre compte ? Cette action est irrversible."}),_&&p.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:p.jsx("p",{className:"text-red-600",children:_})}),p.jsxs("div",{className:"flex justify-end space-x-4",children:[p.jsx("button",{onClick:()=>y(!1),disabled:k,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Annuler"}),p.jsx("button",{onClick:P,disabled:k,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center disabled:opacity-50",children:k?p.jsxs(p.Fragment,{children:[p.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Suppression en cours..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Pn,{className:"h-4 w-4 mr-2"}),"Confirmer la suppression"]})})]})]})})]})}):p.jsx("div",{className:"max-w-2xl mx-auto p-6",children:p.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:p.jsxs("div",{className:"animate-pulse",children:[p.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"h-4 bg-gray-200 rounded"}),p.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),p.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]})})})}const gk=6048e5,cR=864e5,nv=Symbol.for("constructDateFrom");function Fi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&nv in e?e[nv](t):e instanceof Date?new e.constructor(t):new Date(t)}function aa(e,t){return Fi(t||e,e)}let uR={};function n0(){return uR}function ac(e,t){var l,u,f,d;const r=n0(),n=(t==null?void 0:t.weekStartsOn)??((u=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((d=(f=r.locale)==null?void 0:f.options)==null?void 0:d.weekStartsOn)??0,a=aa(e,t==null?void 0:t.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Tf(e,t){return ac(e,{...t,weekStartsOn:1})}function xk(e,t){const r=aa(e,t==null?void 0:t.in),n=r.getFullYear(),a=Fi(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=Tf(a),o=Fi(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Tf(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function av(e){const t=aa(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function fR(e,...t){const r=Fi.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function iv(e,t){const r=aa(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function dR(e,t,r){const[n,a]=fR(r==null?void 0:r.in,e,t),i=iv(n),o=iv(a),l=+i-av(i),u=+o-av(o);return Math.round((l-u)/cR)}function hR(e,t){const r=xk(e,t),n=Fi(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Tf(n)}function pR(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function mR(e){return!(!pR(e)&&typeof e!="number"||isNaN(+aa(e)))}function gR(e,t){const r=aa(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const xR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},vR=(e,t,r)=>{let n;const a=xR[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function fo(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const _R={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yR={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},kR={date:fo({formats:_R,defaultWidth:"full"}),time:fo({formats:yR,defaultWidth:"full"}),dateTime:fo({formats:wR,defaultWidth:"full"})},ER={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},SR=(e,t,r,n)=>ER[e];function xa(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const TR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},CR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},bR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},AR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},NR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},LR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},PR=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},FR={ordinalNumber:PR,era:xa({values:TR,defaultWidth:"wide"}),quarter:xa({values:CR,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xa({values:bR,defaultWidth:"wide"}),day:xa({values:AR,defaultWidth:"wide"}),dayPeriod:xa({values:NR,defaultWidth:"wide",formattingValues:LR,defaultFormattingWidth:"wide"})};function va(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(l)?MR(l,m=>m.test(o)):OR(l,m=>m.test(o));let f;f=e.valueCallback?e.valueCallback(u):u,f=r.valueCallback?r.valueCallback(f):f;const d=t.slice(o.length);return{value:f,rest:d}}}function OR(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function MR(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function vk(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const RR=/^(\d+)(th|st|nd|rd)?/i,DR=/\d+/i,IR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},jR={any:[/^b/i,/^(a|c)/i]},BR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},zR={any:[/1/i,/2/i,/3/i,/4/i]},UR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},HR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VR={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},WR={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},$R={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},GR={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ZR={ordinalNumber:vk({matchPattern:RR,parsePattern:DR,valueCallback:e=>parseInt(e,10)}),era:va({matchPatterns:IR,defaultMatchWidth:"wide",parsePatterns:jR,defaultParseWidth:"any"}),quarter:va({matchPatterns:BR,defaultMatchWidth:"wide",parsePatterns:zR,defaultParseWidth:"any",valueCallback:e=>e+1}),month:va({matchPatterns:UR,defaultMatchWidth:"wide",parsePatterns:HR,defaultParseWidth:"any"}),day:va({matchPatterns:VR,defaultMatchWidth:"wide",parsePatterns:WR,defaultParseWidth:"any"}),dayPeriod:va({matchPatterns:$R,defaultMatchWidth:"any",parsePatterns:GR,defaultParseWidth:"any"})},XR={code:"en-US",formatDistance:vR,formatLong:kR,formatRelative:SR,localize:FR,match:ZR,options:{weekStartsOn:0,firstWeekContainsDate:1}};function qR(e,t){const r=aa(e,t==null?void 0:t.in);return dR(r,gR(r))+1}function YR(e,t){const r=aa(e,t==null?void 0:t.in),n=+Tf(r)-+hR(r);return Math.round(n/gk)+1}function _k(e,t){var d,m,g,v;const r=aa(e,t==null?void 0:t.in),n=r.getFullYear(),a=n0(),i=(t==null?void 0:t.firstWeekContainsDate)??((m=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(g=a.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??1,o=Fi((t==null?void 0:t.in)||e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=ac(o,t),u=Fi((t==null?void 0:t.in)||e,0);u.setFullYear(n,0,i),u.setHours(0,0,0,0);const f=ac(u,t);return+r>=+l?n+1:+r>=+f?n:n-1}function KR(e,t){var l,u,f,d;const r=n0(),n=(t==null?void 0:t.firstWeekContainsDate)??((u=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(f=r.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??1,a=_k(e,t),i=Fi((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),ac(i,t)}function JR(e,t){const r=aa(e,t==null?void 0:t.in),n=+ac(r,t)-+KR(r,t);return Math.round(n/gk)+1}function Nt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const si={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Nt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Nt(r+1,2)},d(e,t){return Nt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Nt(e.getHours()%12||12,t.length)},H(e,t){return Nt(e.getHours(),t.length)},m(e,t){return Nt(e.getMinutes(),t.length)},s(e,t){return Nt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Nt(a,t.length)}},Ds={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},sv={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return si.y(e,t)},Y:function(e,t,r,n){const a=_k(e,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return Nt(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Nt(i,t.length)},R:function(e,t){const r=xk(e);return Nt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Nt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Nt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Nt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return si.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Nt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=JR(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Nt(a,t.length)},I:function(e,t,r){const n=YR(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Nt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):si.d(e,t)},D:function(e,t,r){const n=qR(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Nt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Nt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Nt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Nt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Ds.noon:n===0?a=Ds.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Ds.evening:n>=12?a=Ds.afternoon:n>=4?a=Ds.morning:a=Ds.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return si.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):si.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Nt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Nt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):si.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):si.s(e,t)},S:function(e,t){return si.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return lv(n);case"XXXX":case"XX":return Gi(n);case"XXXXX":case"XXX":default:return Gi(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return lv(n);case"xxxx":case"xx":return Gi(n);case"xxxxx":case"xxx":default:return Gi(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ov(n,":");case"OOOO":default:return"GMT"+Gi(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ov(n,":");case"zzzz":default:return"GMT"+Gi(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Nt(n,t.length)},T:function(e,t,r){return Nt(+e,t.length)}};function ov(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Nt(i,2)}function lv(e,t){return e%60===0?(e>0?"-":"+")+Nt(Math.abs(e)/60,2):Gi(e,t)}function Gi(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Nt(Math.trunc(n/60),2),i=Nt(n%60,2);return r+a+t+i}const cv=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},yk=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},QR=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return cv(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",cv(n,t)).replace("{{time}}",yk(a,t))},eD={p:yk,P:QR},tD=/^D+$/,rD=/^Y+$/,nD=["D","DD","YY","YYYY"];function aD(e){return tD.test(e)}function iD(e){return rD.test(e)}function sD(e,t,r){const n=oD(e,t,r);if(console.warn(n),nD.includes(e))throw new RangeError(n)}function oD(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const lD=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,cD=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,uD=/^'([^]*?)'?$/,fD=/''/g,dD=/[a-zA-Z]/;function hD(e,t,r){var d,m,g,v,y,_,S,k;const n=n0(),a=(r==null?void 0:r.locale)??n.locale??XR,i=(r==null?void 0:r.firstWeekContainsDate)??((m=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((v=(g=n.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((_=(y=r==null?void 0:r.locale)==null?void 0:y.options)==null?void 0:_.weekStartsOn)??n.weekStartsOn??((k=(S=n.locale)==null?void 0:S.options)==null?void 0:k.weekStartsOn)??0,l=aa(e,r==null?void 0:r.in);if(!mR(l))throw new RangeError("Invalid time value");let u=t.match(cD).map(E=>{const w=E[0];if(w==="p"||w==="P"){const N=eD[w];return N(E,a.formatLong)}return E}).join("").match(lD).map(E=>{if(E==="''")return{isToken:!1,value:"'"};const w=E[0];if(w==="'")return{isToken:!1,value:pD(E)};if(sv[w])return{isToken:!0,value:E};if(w.match(dD))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:E}});a.localize.preprocessor&&(u=a.localize.preprocessor(l,u));const f={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return u.map(E=>{if(!E.isToken)return E.value;const w=E.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&iD(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&aD(w))&&sD(w,t,String(e));const N=sv[w[0]];return N(l,w,a.localize,f)}).join("")}function pD(e){const t=e.match(uD);return t?t[1].replace(fD,"'"):e}const mD={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},gD=(e,t,r)=>{let n;const a=mD[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},xD={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},vD={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},_D={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},yD={date:fo({formats:xD,defaultWidth:"full"}),time:fo({formats:vD,defaultWidth:"full"}),dateTime:fo({formats:_D,defaultWidth:"full"})},wD={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},kD=(e,t,r,n)=>wD[e],ED={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},SD={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},TD={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},CD={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},bD={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},AD=(e,t)=>{const r=Number(e),n=t==null?void 0:t.unit;if(r===0)return"0";const a=["year","week","hour","minute","second"];let i;return r===1?i=n&&a.includes(n)?"re":"er":i="me",r+i},ND=["MMM","MMMM"],LD={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&ND.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:AD,era:xa({values:ED,defaultWidth:"wide"}),quarter:xa({values:SD,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xa({values:TD,defaultWidth:"wide"}),day:xa({values:CD,defaultWidth:"wide"}),dayPeriod:xa({values:bD,defaultWidth:"wide"})},PD=/^(\d+)(ime|re|me|er|e)?/i,FD=/\d+/i,OD={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},MD={any:[/^av/i,/^ap/i]},RD={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},DD={any:[/1/i,/2/i,/3/i,/4/i]},ID={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},jD={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},BD={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},zD={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},UD={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},HD={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},VD={ordinalNumber:vk({matchPattern:PD,parsePattern:FD,valueCallback:e=>parseInt(e)}),era:va({matchPatterns:OD,defaultMatchWidth:"wide",parsePatterns:MD,defaultParseWidth:"any"}),quarter:va({matchPatterns:RD,defaultMatchWidth:"wide",parsePatterns:DD,defaultParseWidth:"any",valueCallback:e=>e+1}),month:va({matchPatterns:ID,defaultMatchWidth:"wide",parsePatterns:jD,defaultParseWidth:"any"}),day:va({matchPatterns:BD,defaultMatchWidth:"wide",parsePatterns:zD,defaultParseWidth:"any"}),dayPeriod:va({matchPatterns:UD,defaultMatchWidth:"any",parsePatterns:HD,defaultParseWidth:"any"})},WD={code:"fr",formatDistance:gD,formatLong:yD,formatRelative:kD,localize:LD,match:VD,options:{weekStartsOn:1,firstWeekContainsDate:4}},$D=()=>{const[e,t]=A.useState(null),[r,n]=A.useState(!0),[a,i]=A.useState(null),[o,l]=A.useState(null),u=k=>{switch(k.toLowerCase()){case"firewall":return p.jsx(ds,{className:"h-5 w-5 text-purple-600"});case"data_center":return p.jsx(mc,{className:"h-5 w-5 text-blue-600"});case"firewall_type":return p.jsx(gc,{className:"h-5 w-5 text-green-600"});case"command":return p.jsx(cb,{className:"h-5 w-5 text-yellow-600"});case"config":return p.jsx(wh,{className:"h-5 w-5 text-indigo-600"});case"auth":return p.jsx(Ba,{className:"h-5 w-5 text-red-600"});default:return p.jsx(wh,{className:"h-5 w-5 text-gray-600"})}},f=k=>({firewall:"Pare-feu",data_center:"Centre de donnes",firewall_type:"Type de pare-feu",command:"Commandes",config:"Configuration",auth:"Authentification"})[k]||k,d=k=>{try{return hD(new Date(k),"PPpp",{locale:WD})}catch{return k}},m=k=>k.includes("create")?"bg-green-100 text-green-800":k.includes("update")?"bg-blue-100 text-blue-800":k.includes("delete")?"bg-red-100 text-red-800":k.includes("status")?"bg-yellow-100 text-yellow-800":k.includes("restore")?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800",g=k=>({firewall_create:"Cration de pare-feu",firewall_update:"Modification de pare-feu",firewall_delete:"Suppression de pare-feu",firewall_type_create:"Cration de type de pare-feu",firewall_type_update:"Modification de type de pare-feu",firewall_type_delete:"Suppression de type de pare-feu",create:"Cration",update:"Modification",delete:"Suppression",add:"Ajout",remove:"Suppression",edit:"Modification",execute:"Excution",save:"Sauvegarde",restore:"Restauration",download:"Tlchargement",ping:"Test de connectivit",login:"Connexion",logout:"Dconnexion",password_change:"Changement de mot de passe",ssh_key_update:"Mise  jour de cl SSH"})[k.toLowerCase()]||k,v=(k,E,w)=>{const N=(w==null?void 0:w.name)||k||"Unknown";return N==="Unknown"?E:N},y=k=>typeof k=="string"?k:typeof k=="object"?JSON.stringify(k,null,2):String(k),_=()=>{if(!e||!e.services)return[];const k=[];return Object.entries(e.services).forEach(([E,w])=>{w.actions.forEach(N=>{k.push({...N,serviceType:E})})}),k.sort((E,w)=>new Date(w.timestamp).getTime()-new Date(E.timestamp).getTime())};if(A.useEffect(()=>{let k=!0;return(async()=>{try{if(n(!0),!ma())throw new Error("No authentication token found");const N=await Zr.get("/history/");k&&(t(N.data),n(!1))}catch(w){k&&(console.error("Error fetching history:",w),i("Failed to load history data"),n(!1))}})(),()=>{k=!1}},[]),r)return p.jsx("div",{className:"flex items-center justify-center h-screen",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})});if(a)return p.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mon Historique"}),p.jsx("p",{className:"text-gray-600",children:"Consultez l'historique de vos actions"})]}),p.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4",children:a})]});const S=_();return S.length===0?p.jsxs("div",{className:"text-center py-16",children:[p.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mb-4",children:p.jsx(ff,{className:"h-8 w-8 text-gray-400"})}),p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune action rcente"}),p.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:"Votre historique d'actions apparatra ici."})]}):p.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mon Historique"}),p.jsx("p",{className:"text-gray-600",children:"Historique de vos actions sur les services"})]}),p.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:S.map(k=>p.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[p.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>l(o===k.id?null:k.id),children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center space-x-3",children:[u(k.serviceType),p.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m(k.action)}`,children:g(k.action)}),p.jsx("span",{className:"text-sm font-medium text-gray-900",children:v(k.entity_name,k.action,k.details)}),p.jsx("span",{className:"text-sm text-gray-500",children:f(k.serviceType)})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[p.jsx(ff,{className:"h-4 w-4 mr-1"}),d(k.timestamp)]}),o===k.id?p.jsx(eb,{className:"h-5 w-5 text-gray-500"}):p.jsx(uf,{className:"h-5 w-5 text-gray-500"})]})]})}),o===k.id&&p.jsx("div",{className:"px-4 pb-4 bg-gray-50",children:p.jsxs("div",{className:"flex items-start space-x-2",children:[p.jsx(yh,{className:"h-5 w-5 text-gray-400 mt-0.5"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Dtails de l'action"}),p.jsx("pre",{className:"text-sm text-gray-600 whitespace-pre-wrap bg-white p-3 rounded-lg border border-gray-200",children:y(k.details)})]})]})})]},k.id))})]})},GD=()=>localStorage.getItem("token"),Ra=$e.create({baseURL:Wt});Ra.interceptors.request.use(e=>{const t=GD();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ra.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function ZD(){ka();const[e,t]=A.useState(!1),[r,n]=A.useState(null),[a,i]=A.useState(null),[o,l]=A.useState([]),[u,f]=A.useState([]),[d,m]=A.useState(`config global
get system status
diagnose autoupdate versions
get hardware memory`),[g,v]=A.useState([]),[y,_]=A.useState(""),[S,k]=A.useState("");A.useEffect(()=>{(async()=>{try{t(!0),n(null);const B=await Ra.get("/datacenters/hierarchy/");v(B.data)}catch(B){console.error("Error fetching hierarchy:",B),n("Failed to fetch hierarchy data")}finally{t(!1)}})()},[]),A.useEffect(()=>{(async()=>{try{const B=await Ra.get("/daily-check/daily-checks/");f(B.data.results||[])}catch(B){console.error("Error fetching daily checks:",B),f([])}})()},[]);const E=()=>{if(!y)return[];const W=g.find(B=>B.id===y);return W?W.firewall_types:[]},w=()=>{if(!S)return[];const W=g.find(G=>G.id===y);if(!W)return[];const B=W.firewall_types.find(G=>G.id===S);return B?B.firewalls:[]},N=W=>{const B=W.target.value;_(B),k(""),l([])},I=W=>{const B=W.target.value;k(B),l([])},D=()=>{const W=w();o.length===W.length?l([]):l(W.map(B=>B.id))},P=W=>{l(B=>B.includes(W)?B.filter(G=>G!==W):[...B,W])},V=async()=>{if(!o.length){n("Please select at least one firewall");return}if(!d.trim()){n("Please enter at least one command");return}t(!0),n(null),i(null);try{const W=d.split(`
`).filter(G=>G.trim()),B=await Ra.post("/daily-check/daily-checks/run_multiple_checks/",{firewalls:o,commands:W});if(B.data.status==="success"){i("Daily checks started. You can leave this page, the checks will continue in the background.");const G=B.data.task_id,K=setInterval(async()=>{try{const xe=(await Ra.get(`/daily-check/daily-checks/check_task_status/?task_id=${G}`)).data;if(i(`${xe.message} (${xe.progress}%)`),xe.status==="completed"){clearInterval(K),i("All daily checks completed successfully");const he=await Ra.get("/daily-check/daily-checks/");if(f(he.data.results||[]),xe.results&&xe.results.length>0){const me=[...new Set(xe.results.filter(ae=>ae.success&&ae.report_path).map(ae=>ae.report_path))];for(const ae of me)try{const Y=await Ra.get("/daily-check/daily-checks/download_multiple_reports/",{responseType:"blob",params:{report_path:ae}}),se=new Blob([Y.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ye=window.URL.createObjectURL(se),R=document.createElement("a");R.href=ye,R.setAttribute("download",`daily_check_${new Date().toISOString()}.xlsx`),document.body.appendChild(R),R.click(),document.body.removeChild(R),window.URL.revokeObjectURL(ye)}catch(Y){console.error("Error downloading report:",Y),Sr.error(`Failed to download report from ${ae}`)}}}else xe.status==="failed"&&(clearInterval(K),n(`Daily checks failed: ${xe.message}`))}catch(ve){console.error("Error checking task status:",ve),clearInterval(K),n("Failed to check task status")}},2e3);return()=>clearInterval(K)}else n("Failed to start daily checks")}catch(W){console.error("Error during daily check:",W),n("Failed to start daily checks")}finally{t(!1)}},z=async W=>{try{const B=await Ra.get(`/daily-check/daily-checks/${W}/download_report/`,{responseType:"blob"}),G=new Blob([B.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),K=window.URL.createObjectURL(G),ve=document.createElement("a");ve.href=K;const xe=B.headers["content-disposition"];let he="daily_check_report.xlsx";if(xe){const me=xe.match(/filename="(.+)"/);me&&(he=me[1])}ve.setAttribute("download",he),document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),window.URL.revokeObjectURL(K)}catch(B){console.error("Error downloading report:",B),Sr.error("Failed to download report")}};return e?p.jsx("div",{className:"p-8",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),p.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):p.jsxs("div",{className:"p-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"Daily Check"}),p.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[p.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(mc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),p.jsxs("select",{value:y,onChange:N,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[p.jsx("option",{value:"",children:"All data centers"}),g.map(W=>p.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(ds,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),p.jsxs("select",{value:S,onChange:I,disabled:!y,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${y?"":"bg-gray-100"}`,children:[p.jsx("option",{value:"",children:"Select a firewall type"}),E().map(W=>p.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(gc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),p.jsxs("div",{className:"mt-1 space-y-2",children:[p.jsx("button",{onClick:D,disabled:!S,className:`w-full px-3 py-1 text-sm rounded-md ${o.length===w().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${S?"":"opacity-50 cursor-not-allowed"}`,children:o.length===w().length?"Deselect All":"Select All"}),p.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:w().map(W=>p.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${o.includes(W.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>P(W.id),children:[p.jsx("input",{type:"checkbox",checked:o.includes(W.id),onChange:()=>P(W.id),className:"mr-2"}),p.jsxs("span",{className:"text-sm",children:[W.name," - ",W.ip_address]})]},W.id))})]})]})]})]}),p.jsx("div",{className:"mt-6",children:p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(_h,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Commands (one per line)"}),p.jsx("textarea",{value:d,onChange:W=>m(W.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",rows:5,placeholder:"Enter commands (one per line)"})]})]})})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[r&&p.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md mb-4",children:r}),a&&p.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md mb-4",children:a}),p.jsx("div",{className:"flex space-x-4",children:p.jsxs("button",{onClick:V,disabled:e||!o.length,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[p.jsx(Wp,{className:"h-5 w-5 mr-2"}),e?"Running...":"Run Daily Check"]})})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Daily Checks History"}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[p.jsx("thead",{className:"bg-gray-50",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Firewall"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),p.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(W=>{var K,ve;const B=(ve=(K=W.historique_dailycheck)==null?void 0:K.entries)==null?void 0:ve[W.historique_dailycheck.entries.length-1],G=(B==null?void 0:B.user)||"Unknown";return p.jsxs("tr",{children:[p.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[p.jsx("div",{className:"text-sm font-medium text-gray-900",children:W.firewall.name}),p.jsx("div",{className:"text-sm text-gray-500",children:W.firewall.ip_address})]}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsx("div",{className:"text-sm text-gray-900",children:G})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsx("div",{className:"text-sm text-gray-900",children:new Date(W.check_date).toLocaleString()})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${W.status==="SUCCESS"?"bg-green-100 text-green-800":W.status==="FAILED"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:W.status})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:W.excel_report&&p.jsxs("button",{onClick:()=>z(W.id),className:"text-purple-600 hover:text-purple-900 flex items-center",children:[p.jsx(_h,{className:"h-4 w-4 mr-1"}),"Download Report"]})})]},W.id)})})]})})]})]})}const Sn=({children:e})=>localStorage.getItem("token")?p.jsx(p.Fragment,{children:e}):p.jsx(z4,{to:"/login"}),Tn=({children:e})=>{const[t,r]=A.useState(!1),n=ka(),a=async()=>{try{await Zr.post("/auth/logout/")}catch(i){console.error("Logout error:",i)}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),delete Zr.defaults.headers.common.Authorization,n("/login")}};return t?p.jsx("div",{className:"flex items-center justify-center h-full",children:p.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-900"})}):p.jsxs("div",{className:"flex h-screen bg-gray-100",children:[p.jsx(mb,{onLogout:a}),p.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:p.jsx("main",{className:"flex-1 overflow-y-auto",children:e})})]})},XD=()=>{const[e,t]=A.useState(!1),r=ka();return A.useEffect(()=>{q3(r)},[r]),A.useEffect(()=>{const n=localStorage.getItem("token"),a=localStorage.getItem("refreshToken");n&&a&&(t(!0),Zr.defaults.headers.common.Authorization=`Bearer ${n}`)},[]),p.jsxs(H4,{children:[p.jsx(Vr,{path:"/login",element:p.jsx(ub,{onLogin:()=>t(!0)})}),p.jsx(Vr,{path:"/register",element:p.jsx(pb,{onRegister:()=>t(!0)})}),p.jsx(Vr,{path:"/",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(Kx,{})})})}),p.jsx(Vr,{path:"/firewalls",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(Kx,{})})})}),p.jsx(Vr,{path:"/profile",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(lR,{})})})}),p.jsx(Vr,{path:"/templates",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(gd,{})})})}),p.jsx(Vr,{path:"/templates/new",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(gd,{})})})}),p.jsx(Vr,{path:"/templates/:id",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(gd,{})})})}),p.jsx(Vr,{path:"/config",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(yM,{})})})}),p.jsx(Vr,{path:"/matrix",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(AO,{})})})}),p.jsx(Vr,{path:"/map",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(oR,{})})})}),p.jsx(Vr,{path:"/settings",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(wM,{})})})}),p.jsx(Vr,{path:"/history",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx($D,{})})})}),p.jsx(Vr,{path:"/daily-check",element:p.jsx(Sn,{children:p.jsx(Tn,{children:p.jsx(ZD,{})})})})]})};function qD(){return p.jsxs(B4,{children:[p.jsx(vM,{position:"top-right"}),p.jsx(OM,{children:p.jsx(XD,{})})]})}window.__REACT_DEVTOOLS_GLOBAL_HOOK__={isDisabled:!0};xd.createRoot(document.getElementById("root")).render(p.jsx(ho.StrictMode,{children:p.jsx(qD,{})}));
