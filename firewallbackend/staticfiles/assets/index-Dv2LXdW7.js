(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Ni=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Lf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var pv={exports:{}},Pf={},mv={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ic=Symbol.for("react.element"),EE=Symbol.for("react.portal"),SE=Symbol.for("react.fragment"),TE=Symbol.for("react.strict_mode"),CE=Symbol.for("react.profiler"),bE=Symbol.for("react.provider"),NE=Symbol.for("react.context"),AE=Symbol.for("react.forward_ref"),LE=Symbol.for("react.suspense"),PE=Symbol.for("react.memo"),FE=Symbol.for("react.lazy"),yg=Symbol.iterator;function OE(e){return e===null||typeof e!="object"?null:(e=yg&&e[yg]||e["@@iterator"],typeof e=="function"?e:null)}var gv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xv=Object.assign,vv={};function To(e,t,r){this.props=e,this.context=t,this.refs=vv,this.updater=r||gv}To.prototype.isReactComponent={};To.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};To.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function _v(){}_v.prototype=To.prototype;function Uh(e,t,r){this.props=e,this.context=t,this.refs=vv,this.updater=r||gv}var Hh=Uh.prototype=new _v;Hh.constructor=Uh;xv(Hh,To.prototype);Hh.isPureReactComponent=!0;var wg=Array.isArray,yv=Object.prototype.hasOwnProperty,Vh={current:null},wv={key:!0,ref:!0,__self:!0,__source:!0};function kv(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)yv.call(t,n)&&!wv.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];a.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:ic,type:e,key:i,ref:o,props:a,_owner:Vh.current}}function ME(e,t){return{$$typeof:ic,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wh(e){return typeof e=="object"&&e!==null&&e.$$typeof===ic}function jE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var kg=/\/+/g;function F0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?jE(""+e.key):t.toString(36)}function xu(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ic:case EE:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+F0(o,0):n,wg(a)?(r="",e!=null&&(r=e.replace(kg,"$&/")+"/"),xu(a,t,r,"",function(d){return d})):a!=null&&(Wh(a)&&(a=ME(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(kg,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",wg(e))for(var l=0;l<e.length;l++){i=e[l];var u=n+F0(i,l);o+=xu(i,t,r,u,a)}else if(u=OE(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=n+F0(i,l++),o+=xu(i,t,r,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Vc(e,t,r){if(e==null)return e;var n=[],a=0;return xu(e,n,"","",function(i){return t.call(r,i,a++)}),n}function RE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jr={current:null},vu={transition:null},DE={ReactCurrentDispatcher:Jr,ReactCurrentBatchConfig:vu,ReactCurrentOwner:Vh};function Ev(){throw Error("act(...) is not supported in production builds of React.")}ct.Children={map:Vc,forEach:function(e,t,r){Vc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Vc(e,function(){t++}),t},toArray:function(e){return Vc(e,function(t){return t})||[]},only:function(e){if(!Wh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ct.Component=To;ct.Fragment=SE;ct.Profiler=CE;ct.PureComponent=Uh;ct.StrictMode=TE;ct.Suspense=LE;ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DE;ct.act=Ev;ct.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=xv({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Vh.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)yv.call(t,u)&&!wv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:ic,type:e.type,key:a,ref:i,props:n,_owner:o}};ct.createContext=function(e){return e={$$typeof:NE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bE,_context:e},e.Consumer=e};ct.createElement=kv;ct.createFactory=function(e){var t=kv.bind(null,e);return t.type=e,t};ct.createRef=function(){return{current:null}};ct.forwardRef=function(e){return{$$typeof:AE,render:e}};ct.isValidElement=Wh;ct.lazy=function(e){return{$$typeof:FE,_payload:{_status:-1,_result:e},_init:RE}};ct.memo=function(e,t){return{$$typeof:PE,type:e,compare:t===void 0?null:t}};ct.startTransition=function(e){var t=vu.transition;vu.transition={};try{e()}finally{vu.transition=t}};ct.unstable_act=Ev;ct.useCallback=function(e,t){return Jr.current.useCallback(e,t)};ct.useContext=function(e){return Jr.current.useContext(e)};ct.useDebugValue=function(){};ct.useDeferredValue=function(e){return Jr.current.useDeferredValue(e)};ct.useEffect=function(e,t){return Jr.current.useEffect(e,t)};ct.useId=function(){return Jr.current.useId()};ct.useImperativeHandle=function(e,t,r){return Jr.current.useImperativeHandle(e,t,r)};ct.useInsertionEffect=function(e,t){return Jr.current.useInsertionEffect(e,t)};ct.useLayoutEffect=function(e,t){return Jr.current.useLayoutEffect(e,t)};ct.useMemo=function(e,t){return Jr.current.useMemo(e,t)};ct.useReducer=function(e,t,r){return Jr.current.useReducer(e,t,r)};ct.useRef=function(e){return Jr.current.useRef(e)};ct.useState=function(e){return Jr.current.useState(e)};ct.useSyncExternalStore=function(e,t,r){return Jr.current.useSyncExternalStore(e,t,r)};ct.useTransition=function(){return Jr.current.useTransition()};ct.version="18.3.1";mv.exports=ct;var C=mv.exports;const ls=hv(C);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IE=C,BE=Symbol.for("react.element"),zE=Symbol.for("react.fragment"),UE=Object.prototype.hasOwnProperty,HE=IE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VE={key:!0,ref:!0,__self:!0,__source:!0};function Sv(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)UE.call(t,n)&&!VE.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:BE,type:e,key:i,ref:o,props:a,_owner:HE.current}}Pf.Fragment=zE;Pf.jsx=Sv;Pf.jsxs=Sv;pv.exports=Pf;var f=pv.exports,yd={},Tv={exports:{}},xn={},Cv={exports:{}},bv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,U){var ne=ee.length;ee.push(U);e:for(;0<ne;){var ue=ne-1>>>1,F=ee[ue];if(0<a(F,U))ee[ue]=U,ee[ne]=F,ne=ue;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var U=ee[0],ne=ee.pop();if(ne!==U){ee[0]=ne;e:for(var ue=0,F=ee.length,te=F>>>1;ue<te;){var q=2*(ue+1)-1,X=ee[q],K=q+1,ye=ee[K];if(0>a(X,ne))K<F&&0>a(ye,X)?(ee[ue]=ye,ee[K]=ne,ue=K):(ee[ue]=X,ee[q]=ne,ue=q);else if(K<F&&0>a(ye,ne))ee[ue]=ye,ee[K]=ne,ue=K;else break e}}return U}function a(ee,U){var ne=ee.sortIndex-U.sortIndex;return ne!==0?ne:ee.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,m=null,g=3,x=!1,_=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(ee){for(var U=r(d);U!==null;){if(U.callback===null)n(d);else if(U.startTime<=ee)n(d),U.sortIndex=U.expirationTime,t(u,U);else break;U=r(d)}}function A(ee){if(y=!1,w(ee),!_)if(r(u)!==null)_=!0,de(D);else{var U=r(d);U!==null&&Q(A,U.startTime-ee)}}function D(ee,U){_=!1,y&&(y=!1,k(H),H=-1),x=!0;var ne=g;try{for(w(U),m=r(u);m!==null&&(!(m.expirationTime>U)||ee&&!I());){var ue=m.callback;if(typeof ue=="function"){m.callback=null,g=m.priorityLevel;var F=ue(m.expirationTime<=U);U=e.unstable_now(),typeof F=="function"?m.callback=F:m===r(u)&&n(u),w(U)}else n(u);m=r(u)}if(m!==null)var te=!0;else{var q=r(d);q!==null&&Q(A,q.startTime-U),te=!1}return te}finally{m=null,g=ne,x=!1}}var R=!1,P=null,H=-1,B=5,W=-1;function I(){return!(e.unstable_now()-W<B)}function Z(){if(P!==null){var ee=e.unstable_now();W=ee;var U=!0;try{U=P(!0,ee)}finally{U?J():(R=!1,P=null)}}else R=!1}var J;if(typeof S=="function")J=function(){S(Z)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,_e=ge.port2;ge.port1.onmessage=Z,J=function(){_e.postMessage(null)}}else J=function(){E(Z,0)};function de(ee){P=ee,R||(R=!0,J())}function Q(ee,U){H=E(function(){ee(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){_||x||(_=!0,de(D))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(ee){switch(g){case 1:case 2:case 3:var U=3;break;default:U=g}var ne=g;g=U;try{return ee()}finally{g=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,U){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ne=g;g=ee;try{return U()}finally{g=ne}},e.unstable_scheduleCallback=function(ee,U,ne){var ue=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ue+ne:ue):ne=ue,ee){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ne+F,ee={id:h++,callback:U,priorityLevel:ee,startTime:ne,expirationTime:F,sortIndex:-1},ne>ue?(ee.sortIndex=ne,t(d,ee),r(u)===null&&ee===r(d)&&(y?(k(H),H=-1):y=!0,Q(A,ne-ue))):(ee.sortIndex=F,t(u,ee),_||x||(_=!0,de(D))),ee},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(ee){var U=g;return function(){var ne=g;g=U;try{return ee.apply(this,arguments)}finally{g=ne}}}})(bv);Cv.exports=bv;var WE=Cv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $E=C,mn=WE;function Ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nv=new Set,Fl={};function _s(e,t){mo(e,t),mo(e+"Capture",t)}function mo(e,t){for(Fl[e]=t,e=0;e<t.length;e++)Nv.add(t[e])}var Va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wd=Object.prototype.hasOwnProperty,GE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Eg={},Sg={};function ZE(e){return wd.call(Sg,e)?!0:wd.call(Eg,e)?!1:GE.test(e)?Sg[e]=!0:(Eg[e]=!0,!1)}function qE(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XE(e,t,r,n){if(t===null||typeof t>"u"||qE(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qr(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){br[e]=new Qr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];br[t]=new Qr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){br[e]=new Qr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){br[e]=new Qr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){br[e]=new Qr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){br[e]=new Qr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){br[e]=new Qr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){br[e]=new Qr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){br[e]=new Qr(e,5,!1,e.toLowerCase(),null,!1,!1)});var $h=/[\-:]([a-z])/g;function Gh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($h,Gh);br[t]=new Qr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($h,Gh);br[t]=new Qr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($h,Gh);br[t]=new Qr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){br[e]=new Qr(e,1,!1,e.toLowerCase(),null,!1,!1)});br.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){br[e]=new Qr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zh(e,t,r,n){var a=br.hasOwnProperty(t)?br[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(XE(t,r,a,n)&&(r=null),n||a===null?ZE(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ya=$E.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wc=Symbol.for("react.element"),Vs=Symbol.for("react.portal"),Ws=Symbol.for("react.fragment"),qh=Symbol.for("react.strict_mode"),kd=Symbol.for("react.profiler"),Av=Symbol.for("react.provider"),Lv=Symbol.for("react.context"),Xh=Symbol.for("react.forward_ref"),Ed=Symbol.for("react.suspense"),Sd=Symbol.for("react.suspense_list"),Yh=Symbol.for("react.memo"),si=Symbol.for("react.lazy"),Pv=Symbol.for("react.offscreen"),Tg=Symbol.iterator;function Zo(e){return e===null||typeof e!="object"?null:(e=Tg&&e[Tg]||e["@@iterator"],typeof e=="function"?e:null)}var Ht=Object.assign,O0;function al(e){if(O0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);O0=t&&t[1]||""}return`
`+O0+e}var M0=!1;function j0(e,t){if(!e||M0)return"";M0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var u=`
`+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{M0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?al(e):""}function YE(e){switch(e.tag){case 5:return al(e.type);case 16:return al("Lazy");case 13:return al("Suspense");case 19:return al("SuspenseList");case 0:case 2:case 15:return e=j0(e.type,!1),e;case 11:return e=j0(e.type.render,!1),e;case 1:return e=j0(e.type,!0),e;default:return""}}function Td(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ws:return"Fragment";case Vs:return"Portal";case kd:return"Profiler";case qh:return"StrictMode";case Ed:return"Suspense";case Sd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lv:return(e.displayName||"Context")+".Consumer";case Av:return(e._context.displayName||"Context")+".Provider";case Xh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yh:return t=e.displayName||null,t!==null?t:Td(e.type)||"Memo";case si:t=e._payload,e=e._init;try{return Td(e(t))}catch{}}return null}function KE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Td(t);case 8:return t===qh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ai(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Fv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function JE(e){var t=Fv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $c(e){e._valueTracker||(e._valueTracker=JE(e))}function Ov(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Fv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ju(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cd(e,t){var r=t.checked;return Ht({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Cg(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ai(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Mv(e,t){t=t.checked,t!=null&&Zh(e,"checked",t,!1)}function bd(e,t){Mv(e,t);var r=Ai(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nd(e,t.type,r):t.hasOwnProperty("defaultValue")&&Nd(e,t.type,Ai(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function bg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Nd(e,t,r){(t!=="number"||ju(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var il=Array.isArray;function ao(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ai(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Ad(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ce(91));return Ht({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ng(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ce(92));if(il(r)){if(1<r.length)throw Error(Ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ai(r)}}function jv(e,t){var r=Ai(t.value),n=Ai(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Ag(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Rv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ld(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Rv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gc,Dv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gc=Gc||document.createElement("div"),Gc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ol(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var hl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QE=["Webkit","ms","Moz","O"];Object.keys(hl).forEach(function(e){QE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hl[t]=hl[e]})});function Iv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||hl.hasOwnProperty(e)&&hl[e]?(""+t).trim():t+"px"}function Bv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Iv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var e4=Ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pd(e,t){if(t){if(e4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ce(62))}}function Fd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Od=null;function Kh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Md=null,io=null,so=null;function Lg(e){if(e=lc(e)){if(typeof Md!="function")throw Error(Ce(280));var t=e.stateNode;t&&(t=Rf(t),Md(e.stateNode,e.type,t))}}function zv(e){io?so?so.push(e):so=[e]:io=e}function Uv(){if(io){var e=io,t=so;if(so=io=null,Lg(e),t)for(e=0;e<t.length;e++)Lg(t[e])}}function Hv(e,t){return e(t)}function Vv(){}var R0=!1;function Wv(e,t,r){if(R0)return e(t,r);R0=!0;try{return Hv(e,t,r)}finally{R0=!1,(io!==null||so!==null)&&(Vv(),Uv())}}function Ml(e,t){var r=e.stateNode;if(r===null)return null;var n=Rf(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ce(231,t,typeof r));return r}var jd=!1;if(Va)try{var qo={};Object.defineProperty(qo,"passive",{get:function(){jd=!0}}),window.addEventListener("test",qo,qo),window.removeEventListener("test",qo,qo)}catch{jd=!1}function t4(e,t,r,n,a,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(h){this.onError(h)}}var pl=!1,Ru=null,Du=!1,Rd=null,r4={onError:function(e){pl=!0,Ru=e}};function n4(e,t,r,n,a,i,o,l,u){pl=!1,Ru=null,t4.apply(r4,arguments)}function a4(e,t,r,n,a,i,o,l,u){if(n4.apply(this,arguments),pl){if(pl){var d=Ru;pl=!1,Ru=null}else throw Error(Ce(198));Du||(Du=!0,Rd=d)}}function ys(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function $v(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Pg(e){if(ys(e)!==e)throw Error(Ce(188))}function i4(e){var t=e.alternate;if(!t){if(t=ys(e),t===null)throw Error(Ce(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Pg(a),e;if(i===n)return Pg(a),t;i=i.sibling}throw Error(Ce(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(Ce(189))}}if(r.alternate!==n)throw Error(Ce(190))}if(r.tag!==3)throw Error(Ce(188));return r.stateNode.current===r?e:t}function Gv(e){return e=i4(e),e!==null?Zv(e):null}function Zv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Zv(e);if(t!==null)return t;e=e.sibling}return null}var qv=mn.unstable_scheduleCallback,Fg=mn.unstable_cancelCallback,s4=mn.unstable_shouldYield,o4=mn.unstable_requestPaint,Xt=mn.unstable_now,l4=mn.unstable_getCurrentPriorityLevel,Jh=mn.unstable_ImmediatePriority,Xv=mn.unstable_UserBlockingPriority,Iu=mn.unstable_NormalPriority,c4=mn.unstable_LowPriority,Yv=mn.unstable_IdlePriority,Ff=null,xa=null;function u4(e){if(xa&&typeof xa.onCommitFiberRoot=="function")try{xa.onCommitFiberRoot(Ff,e,void 0,(e.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:h4,f4=Math.log,d4=Math.LN2;function h4(e){return e>>>=0,e===0?32:31-(f4(e)/d4|0)|0}var Zc=64,qc=4194304;function sl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Bu(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=sl(l):(i&=o,i!==0&&(n=sl(i)))}else o=r&~a,o!==0?n=sl(o):i!==0&&(n=sl(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Yn(t),a=1<<r,n|=e[r],t&=~a;return n}function p4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function m4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Yn(i),l=1<<o,u=a[o];u===-1?(!(l&r)||l&n)&&(a[o]=p4(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function Dd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Kv(){var e=Zc;return Zc<<=1,!(Zc&4194240)&&(Zc=64),e}function D0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function sc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yn(t),e[t]=r}function g4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Yn(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Qh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Yn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Et=0;function Jv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Qv,ep,e_,t_,r_,Id=!1,Xc=[],_i=null,yi=null,wi=null,jl=new Map,Rl=new Map,li=[],x4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Og(e,t){switch(e){case"focusin":case"focusout":_i=null;break;case"dragenter":case"dragleave":yi=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":jl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rl.delete(t.pointerId)}}function Xo(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=lc(t),t!==null&&ep(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function v4(e,t,r,n,a){switch(t){case"focusin":return _i=Xo(_i,e,t,r,n,a),!0;case"dragenter":return yi=Xo(yi,e,t,r,n,a),!0;case"mouseover":return wi=Xo(wi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return jl.set(i,Xo(jl.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Rl.set(i,Xo(Rl.get(i)||null,e,t,r,n,a)),!0}return!1}function n_(e){var t=Yi(e.target);if(t!==null){var r=ys(t);if(r!==null){if(t=r.tag,t===13){if(t=$v(r),t!==null){e.blockedOn=t,r_(e.priority,function(){e_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _u(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Bd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Od=n,r.target.dispatchEvent(n),Od=null}else return t=lc(r),t!==null&&ep(t),e.blockedOn=r,!1;t.shift()}return!0}function Mg(e,t,r){_u(e)&&r.delete(t)}function _4(){Id=!1,_i!==null&&_u(_i)&&(_i=null),yi!==null&&_u(yi)&&(yi=null),wi!==null&&_u(wi)&&(wi=null),jl.forEach(Mg),Rl.forEach(Mg)}function Yo(e,t){e.blockedOn===t&&(e.blockedOn=null,Id||(Id=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,_4)))}function Dl(e){function t(a){return Yo(a,e)}if(0<Xc.length){Yo(Xc[0],e);for(var r=1;r<Xc.length;r++){var n=Xc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(_i!==null&&Yo(_i,e),yi!==null&&Yo(yi,e),wi!==null&&Yo(wi,e),jl.forEach(t),Rl.forEach(t),r=0;r<li.length;r++)n=li[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<li.length&&(r=li[0],r.blockedOn===null);)n_(r),r.blockedOn===null&&li.shift()}var oo=Ya.ReactCurrentBatchConfig,zu=!0;function y4(e,t,r,n){var a=Et,i=oo.transition;oo.transition=null;try{Et=1,tp(e,t,r,n)}finally{Et=a,oo.transition=i}}function w4(e,t,r,n){var a=Et,i=oo.transition;oo.transition=null;try{Et=4,tp(e,t,r,n)}finally{Et=a,oo.transition=i}}function tp(e,t,r,n){if(zu){var a=Bd(e,t,r,n);if(a===null)Z0(e,t,n,Uu,r),Og(e,n);else if(v4(a,e,t,r,n))n.stopPropagation();else if(Og(e,n),t&4&&-1<x4.indexOf(e)){for(;a!==null;){var i=lc(a);if(i!==null&&Qv(i),i=Bd(e,t,r,n),i===null&&Z0(e,t,n,Uu,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Z0(e,t,n,null,r)}}var Uu=null;function Bd(e,t,r,n){if(Uu=null,e=Kh(n),e=Yi(e),e!==null)if(t=ys(e),t===null)e=null;else if(r=t.tag,r===13){if(e=$v(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Uu=e,null}function a_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(l4()){case Jh:return 1;case Xv:return 4;case Iu:case c4:return 16;case Yv:return 536870912;default:return 16}default:return 16}}var pi=null,rp=null,yu=null;function i_(){if(yu)return yu;var e,t=rp,r=t.length,n,a="value"in pi?pi.value:pi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return yu=a.slice(e,1<n?1-n:void 0)}function wu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yc(){return!0}function jg(){return!1}function vn(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Yc:jg,this.isPropagationStopped=jg,this}return Ht(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yc)},persist:function(){},isPersistent:Yc}),t}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},np=vn(Co),oc=Ht({},Co,{view:0,detail:0}),k4=vn(oc),I0,B0,Ko,Of=Ht({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ap,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ko&&(Ko&&e.type==="mousemove"?(I0=e.screenX-Ko.screenX,B0=e.screenY-Ko.screenY):B0=I0=0,Ko=e),I0)},movementY:function(e){return"movementY"in e?e.movementY:B0}}),Rg=vn(Of),E4=Ht({},Of,{dataTransfer:0}),S4=vn(E4),T4=Ht({},oc,{relatedTarget:0}),z0=vn(T4),C4=Ht({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),b4=vn(C4),N4=Ht({},Co,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),A4=vn(N4),L4=Ht({},Co,{data:0}),Dg=vn(L4),P4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function M4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=O4[e])?!!t[e]:!1}function ap(){return M4}var j4=Ht({},oc,{key:function(e){if(e.key){var t=P4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?F4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ap,charCode:function(e){return e.type==="keypress"?wu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),R4=vn(j4),D4=Ht({},Of,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ig=vn(D4),I4=Ht({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ap}),B4=vn(I4),z4=Ht({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),U4=vn(z4),H4=Ht({},Of,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),V4=vn(H4),W4=[9,13,27,32],ip=Va&&"CompositionEvent"in window,ml=null;Va&&"documentMode"in document&&(ml=document.documentMode);var $4=Va&&"TextEvent"in window&&!ml,s_=Va&&(!ip||ml&&8<ml&&11>=ml),Bg=" ",zg=!1;function o_(e,t){switch(e){case"keyup":return W4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function l_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $s=!1;function G4(e,t){switch(e){case"compositionend":return l_(t);case"keypress":return t.which!==32?null:(zg=!0,Bg);case"textInput":return e=t.data,e===Bg&&zg?null:e;default:return null}}function Z4(e,t){if($s)return e==="compositionend"||!ip&&o_(e,t)?(e=i_(),yu=rp=pi=null,$s=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return s_&&t.locale!=="ko"?null:t.data;default:return null}}var q4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ug(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!q4[e.type]:t==="textarea"}function c_(e,t,r,n){zv(n),t=Hu(t,"onChange"),0<t.length&&(r=new np("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var gl=null,Il=null;function X4(e){y_(e,0)}function Mf(e){var t=qs(e);if(Ov(t))return e}function Y4(e,t){if(e==="change")return t}var u_=!1;if(Va){var U0;if(Va){var H0="oninput"in document;if(!H0){var Hg=document.createElement("div");Hg.setAttribute("oninput","return;"),H0=typeof Hg.oninput=="function"}U0=H0}else U0=!1;u_=U0&&(!document.documentMode||9<document.documentMode)}function Vg(){gl&&(gl.detachEvent("onpropertychange",f_),Il=gl=null)}function f_(e){if(e.propertyName==="value"&&Mf(Il)){var t=[];c_(t,Il,e,Kh(e)),Wv(X4,t)}}function K4(e,t,r){e==="focusin"?(Vg(),gl=t,Il=r,gl.attachEvent("onpropertychange",f_)):e==="focusout"&&Vg()}function J4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mf(Il)}function Q4(e,t){if(e==="click")return Mf(t)}function eS(e,t){if(e==="input"||e==="change")return Mf(t)}function tS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qn=typeof Object.is=="function"?Object.is:tS;function Bl(e,t){if(Qn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!wd.call(t,a)||!Qn(e[a],t[a]))return!1}return!0}function Wg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $g(e,t){var r=Wg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Wg(r)}}function d_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?d_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function h_(){for(var e=window,t=ju();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ju(e.document)}return t}function sp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function rS(e){var t=h_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&d_(r.ownerDocument.documentElement,r)){if(n!==null&&sp(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=$g(r,i);var o=$g(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nS=Va&&"documentMode"in document&&11>=document.documentMode,Gs=null,zd=null,xl=null,Ud=!1;function Gg(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ud||Gs==null||Gs!==ju(n)||(n=Gs,"selectionStart"in n&&sp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),xl&&Bl(xl,n)||(xl=n,n=Hu(zd,"onSelect"),0<n.length&&(t=new np("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gs)))}function Kc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Zs={animationend:Kc("Animation","AnimationEnd"),animationiteration:Kc("Animation","AnimationIteration"),animationstart:Kc("Animation","AnimationStart"),transitionend:Kc("Transition","TransitionEnd")},V0={},p_={};Va&&(p_=document.createElement("div").style,"AnimationEvent"in window||(delete Zs.animationend.animation,delete Zs.animationiteration.animation,delete Zs.animationstart.animation),"TransitionEvent"in window||delete Zs.transitionend.transition);function jf(e){if(V0[e])return V0[e];if(!Zs[e])return e;var t=Zs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in p_)return V0[e]=t[r];return e}var m_=jf("animationend"),g_=jf("animationiteration"),x_=jf("animationstart"),v_=jf("transitionend"),__=new Map,Zg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mi(e,t){__.set(e,t),_s(t,[e])}for(var W0=0;W0<Zg.length;W0++){var $0=Zg[W0],aS=$0.toLowerCase(),iS=$0[0].toUpperCase()+$0.slice(1);Mi(aS,"on"+iS)}Mi(m_,"onAnimationEnd");Mi(g_,"onAnimationIteration");Mi(x_,"onAnimationStart");Mi("dblclick","onDoubleClick");Mi("focusin","onFocus");Mi("focusout","onBlur");Mi(v_,"onTransitionEnd");mo("onMouseEnter",["mouseout","mouseover"]);mo("onMouseLeave",["mouseout","mouseover"]);mo("onPointerEnter",["pointerout","pointerover"]);mo("onPointerLeave",["pointerout","pointerover"]);_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_s("onBeforeInput",["compositionend","keypress","textInput","paste"]);_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function qg(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,a4(n,t,void 0,e),e.currentTarget=null}function y_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&a.isPropagationStopped())break e;qg(a,l,d),i=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&a.isPropagationStopped())break e;qg(a,l,d),i=u}}}if(Du)throw e=Rd,Du=!1,Rd=null,e}function Ft(e,t){var r=t[Gd];r===void 0&&(r=t[Gd]=new Set);var n=e+"__bubble";r.has(n)||(w_(t,e,2,!1),r.add(n))}function G0(e,t,r){var n=0;t&&(n|=4),w_(r,e,n,t)}var Jc="_reactListening"+Math.random().toString(36).slice(2);function zl(e){if(!e[Jc]){e[Jc]=!0,Nv.forEach(function(r){r!=="selectionchange"&&(sS.has(r)||G0(r,!1,e),G0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jc]||(t[Jc]=!0,G0("selectionchange",!1,t))}}function w_(e,t,r,n){switch(a_(t)){case 1:var a=y4;break;case 4:a=w4;break;default:a=tp}r=a.bind(null,t,r,e),a=void 0,!jd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Z0(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Yi(l),o===null)return;if(u=o.tag,u===5||u===6){n=i=o;continue e}l=l.parentNode}}n=n.return}Wv(function(){var d=i,h=Kh(r),m=[];e:{var g=__.get(e);if(g!==void 0){var x=np,_=e;switch(e){case"keypress":if(wu(r)===0)break e;case"keydown":case"keyup":x=R4;break;case"focusin":_="focus",x=z0;break;case"focusout":_="blur",x=z0;break;case"beforeblur":case"afterblur":x=z0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=S4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=B4;break;case m_:case g_:case x_:x=b4;break;case v_:x=U4;break;case"scroll":x=k4;break;case"wheel":x=V4;break;case"copy":case"cut":case"paste":x=A4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Ig}var y=(t&4)!==0,E=!y&&e==="scroll",k=y?g!==null?g+"Capture":null:g;y=[];for(var S=d,w;S!==null;){w=S;var A=w.stateNode;if(w.tag===5&&A!==null&&(w=A,k!==null&&(A=Ml(S,k),A!=null&&y.push(Ul(S,A,w)))),E)break;S=S.return}0<y.length&&(g=new x(g,_,null,r,h),m.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",g&&r!==Od&&(_=r.relatedTarget||r.fromElement)&&(Yi(_)||_[Wa]))break e;if((x||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,x?(_=r.relatedTarget||r.toElement,x=d,_=_?Yi(_):null,_!==null&&(E=ys(_),_!==E||_.tag!==5&&_.tag!==6)&&(_=null)):(x=null,_=d),x!==_)){if(y=Rg,A="onMouseLeave",k="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(y=Ig,A="onPointerLeave",k="onPointerEnter",S="pointer"),E=x==null?g:qs(x),w=_==null?g:qs(_),g=new y(A,S+"leave",x,r,h),g.target=E,g.relatedTarget=w,A=null,Yi(h)===d&&(y=new y(k,S+"enter",_,r,h),y.target=w,y.relatedTarget=E,A=y),E=A,x&&_)t:{for(y=x,k=_,S=0,w=y;w;w=Ds(w))S++;for(w=0,A=k;A;A=Ds(A))w++;for(;0<S-w;)y=Ds(y),S--;for(;0<w-S;)k=Ds(k),w--;for(;S--;){if(y===k||k!==null&&y===k.alternate)break t;y=Ds(y),k=Ds(k)}y=null}else y=null;x!==null&&Xg(m,g,x,y,!1),_!==null&&E!==null&&Xg(m,E,_,y,!0)}}e:{if(g=d?qs(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var D=Y4;else if(Ug(g))if(u_)D=eS;else{D=J4;var R=K4}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(D=Q4);if(D&&(D=D(e,d))){c_(m,D,r,h);break e}R&&R(e,g,d),e==="focusout"&&(R=g._wrapperState)&&R.controlled&&g.type==="number"&&Nd(g,"number",g.value)}switch(R=d?qs(d):window,e){case"focusin":(Ug(R)||R.contentEditable==="true")&&(Gs=R,zd=d,xl=null);break;case"focusout":xl=zd=Gs=null;break;case"mousedown":Ud=!0;break;case"contextmenu":case"mouseup":case"dragend":Ud=!1,Gg(m,r,h);break;case"selectionchange":if(nS)break;case"keydown":case"keyup":Gg(m,r,h)}var P;if(ip)e:{switch(e){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else $s?o_(e,r)&&(H="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(H="onCompositionStart");H&&(s_&&r.locale!=="ko"&&($s||H!=="onCompositionStart"?H==="onCompositionEnd"&&$s&&(P=i_()):(pi=h,rp="value"in pi?pi.value:pi.textContent,$s=!0)),R=Hu(d,H),0<R.length&&(H=new Dg(H,e,null,r,h),m.push({event:H,listeners:R}),P?H.data=P:(P=l_(r),P!==null&&(H.data=P)))),(P=$4?G4(e,r):Z4(e,r))&&(d=Hu(d,"onBeforeInput"),0<d.length&&(h=new Dg("onBeforeInput","beforeinput",null,r,h),m.push({event:h,listeners:d}),h.data=P))}y_(m,t)})}function Ul(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Hu(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ml(e,r),i!=null&&n.unshift(Ul(e,i,a)),i=Ml(e,t),i!=null&&n.push(Ul(e,i,a))),e=e.return}return n}function Ds(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xg(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,d=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&d!==null&&(l=d,a?(u=Ml(r,i),u!=null&&o.unshift(Ul(r,u,l))):a||(u=Ml(r,i),u!=null&&o.push(Ul(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var oS=/\r\n?/g,lS=/\u0000|\uFFFD/g;function Yg(e){return(typeof e=="string"?e:""+e).replace(oS,`
`).replace(lS,"")}function Qc(e,t,r){if(t=Yg(t),Yg(e)!==t&&r)throw Error(Ce(425))}function Vu(){}var Hd=null,Vd=null;function Wd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var $d=typeof setTimeout=="function"?setTimeout:void 0,cS=typeof clearTimeout=="function"?clearTimeout:void 0,Kg=typeof Promise=="function"?Promise:void 0,uS=typeof queueMicrotask=="function"?queueMicrotask:typeof Kg<"u"?function(e){return Kg.resolve(null).then(e).catch(fS)}:$d;function fS(e){setTimeout(function(){throw e})}function q0(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Dl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Dl(t)}function ki(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var bo=Math.random().toString(36).slice(2),pa="__reactFiber$"+bo,Hl="__reactProps$"+bo,Wa="__reactContainer$"+bo,Gd="__reactEvents$"+bo,dS="__reactListeners$"+bo,hS="__reactHandles$"+bo;function Yi(e){var t=e[pa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Wa]||r[pa]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jg(e);e!==null;){if(r=e[pa])return r;e=Jg(e)}return t}e=r,r=e.parentNode}return null}function lc(e){return e=e[pa]||e[Wa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ce(33))}function Rf(e){return e[Hl]||null}var Zd=[],Xs=-1;function ji(e){return{current:e}}function Mt(e){0>Xs||(e.current=Zd[Xs],Zd[Xs]=null,Xs--)}function Nt(e,t){Xs++,Zd[Xs]=e.current,e.current=t}var Li={},zr=ji(Li),an=ji(!1),cs=Li;function go(e,t){var r=e.type.contextTypes;if(!r)return Li;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function sn(e){return e=e.childContextTypes,e!=null}function Wu(){Mt(an),Mt(zr)}function Qg(e,t,r){if(zr.current!==Li)throw Error(Ce(168));Nt(zr,t),Nt(an,r)}function k_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Ce(108,KE(e)||"Unknown",a));return Ht({},r,n)}function $u(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Li,cs=zr.current,Nt(zr,e),Nt(an,an.current),!0}function ex(e,t,r){var n=e.stateNode;if(!n)throw Error(Ce(169));r?(e=k_(e,t,cs),n.__reactInternalMemoizedMergedChildContext=e,Mt(an),Mt(zr),Nt(zr,e)):Mt(an),Nt(an,r)}var ja=null,Df=!1,X0=!1;function E_(e){ja===null?ja=[e]:ja.push(e)}function pS(e){Df=!0,E_(e)}function Ri(){if(!X0&&ja!==null){X0=!0;var e=0,t=Et;try{var r=ja;for(Et=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ja=null,Df=!1}catch(a){throw ja!==null&&(ja=ja.slice(e+1)),qv(Jh,Ri),a}finally{Et=t,X0=!1}}return null}var Ys=[],Ks=0,Gu=null,Zu=0,bn=[],Nn=0,us=null,Ra=1,Da="";function Wi(e,t){Ys[Ks++]=Zu,Ys[Ks++]=Gu,Gu=e,Zu=t}function S_(e,t,r){bn[Nn++]=Ra,bn[Nn++]=Da,bn[Nn++]=us,us=e;var n=Ra;e=Da;var a=32-Yn(n)-1;n&=~(1<<a),r+=1;var i=32-Yn(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Ra=1<<32-Yn(t)+a|r<<a|n,Da=i+e}else Ra=1<<i|r<<a|n,Da=e}function op(e){e.return!==null&&(Wi(e,1),S_(e,1,0))}function lp(e){for(;e===Gu;)Gu=Ys[--Ks],Ys[Ks]=null,Zu=Ys[--Ks],Ys[Ks]=null;for(;e===us;)us=bn[--Nn],bn[Nn]=null,Da=bn[--Nn],bn[Nn]=null,Ra=bn[--Nn],bn[Nn]=null}var hn=null,dn=null,Rt=!1,Gn=null;function T_(e,t){var r=Ln(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function tx(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,hn=e,dn=ki(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,hn=e,dn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=us!==null?{id:Ra,overflow:Da}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ln(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,hn=e,dn=null,!0):!1;default:return!1}}function qd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xd(e){if(Rt){var t=dn;if(t){var r=t;if(!tx(e,t)){if(qd(e))throw Error(Ce(418));t=ki(r.nextSibling);var n=hn;t&&tx(e,t)?T_(n,r):(e.flags=e.flags&-4097|2,Rt=!1,hn=e)}}else{if(qd(e))throw Error(Ce(418));e.flags=e.flags&-4097|2,Rt=!1,hn=e}}}function rx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;hn=e}function eu(e){if(e!==hn)return!1;if(!Rt)return rx(e),Rt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Wd(e.type,e.memoizedProps)),t&&(t=dn)){if(qd(e))throw C_(),Error(Ce(418));for(;t;)T_(e,t),t=ki(t.nextSibling)}if(rx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){dn=ki(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}dn=null}}else dn=hn?ki(e.stateNode.nextSibling):null;return!0}function C_(){for(var e=dn;e;)e=ki(e.nextSibling)}function xo(){dn=hn=null,Rt=!1}function cp(e){Gn===null?Gn=[e]:Gn.push(e)}var mS=Ya.ReactCurrentBatchConfig;function Jo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ce(309));var n=r.stateNode}if(!n)throw Error(Ce(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ce(284));if(!r._owner)throw Error(Ce(290,e))}return e}function tu(e,t){throw e=Object.prototype.toString.call(t),Error(Ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function nx(e){var t=e._init;return t(e._payload)}function b_(e){function t(k,S){if(e){var w=k.deletions;w===null?(k.deletions=[S],k.flags|=16):w.push(S)}}function r(k,S){if(!e)return null;for(;S!==null;)t(k,S),S=S.sibling;return null}function n(k,S){for(k=new Map;S!==null;)S.key!==null?k.set(S.key,S):k.set(S.index,S),S=S.sibling;return k}function a(k,S){return k=Ci(k,S),k.index=0,k.sibling=null,k}function i(k,S,w){return k.index=w,e?(w=k.alternate,w!==null?(w=w.index,w<S?(k.flags|=2,S):w):(k.flags|=2,S)):(k.flags|=1048576,S)}function o(k){return e&&k.alternate===null&&(k.flags|=2),k}function l(k,S,w,A){return S===null||S.tag!==6?(S=rd(w,k.mode,A),S.return=k,S):(S=a(S,w),S.return=k,S)}function u(k,S,w,A){var D=w.type;return D===Ws?h(k,S,w.props.children,A,w.key):S!==null&&(S.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===si&&nx(D)===S.type)?(A=a(S,w.props),A.ref=Jo(k,S,w),A.return=k,A):(A=Nu(w.type,w.key,w.props,null,k.mode,A),A.ref=Jo(k,S,w),A.return=k,A)}function d(k,S,w,A){return S===null||S.tag!==4||S.stateNode.containerInfo!==w.containerInfo||S.stateNode.implementation!==w.implementation?(S=nd(w,k.mode,A),S.return=k,S):(S=a(S,w.children||[]),S.return=k,S)}function h(k,S,w,A,D){return S===null||S.tag!==7?(S=as(w,k.mode,A,D),S.return=k,S):(S=a(S,w),S.return=k,S)}function m(k,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return S=rd(""+S,k.mode,w),S.return=k,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Wc:return w=Nu(S.type,S.key,S.props,null,k.mode,w),w.ref=Jo(k,null,S),w.return=k,w;case Vs:return S=nd(S,k.mode,w),S.return=k,S;case si:var A=S._init;return m(k,A(S._payload),w)}if(il(S)||Zo(S))return S=as(S,k.mode,w,null),S.return=k,S;tu(k,S)}return null}function g(k,S,w,A){var D=S!==null?S.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return D!==null?null:l(k,S,""+w,A);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wc:return w.key===D?u(k,S,w,A):null;case Vs:return w.key===D?d(k,S,w,A):null;case si:return D=w._init,g(k,S,D(w._payload),A)}if(il(w)||Zo(w))return D!==null?null:h(k,S,w,A,null);tu(k,w)}return null}function x(k,S,w,A,D){if(typeof A=="string"&&A!==""||typeof A=="number")return k=k.get(w)||null,l(S,k,""+A,D);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Wc:return k=k.get(A.key===null?w:A.key)||null,u(S,k,A,D);case Vs:return k=k.get(A.key===null?w:A.key)||null,d(S,k,A,D);case si:var R=A._init;return x(k,S,w,R(A._payload),D)}if(il(A)||Zo(A))return k=k.get(w)||null,h(S,k,A,D,null);tu(S,A)}return null}function _(k,S,w,A){for(var D=null,R=null,P=S,H=S=0,B=null;P!==null&&H<w.length;H++){P.index>H?(B=P,P=null):B=P.sibling;var W=g(k,P,w[H],A);if(W===null){P===null&&(P=B);break}e&&P&&W.alternate===null&&t(k,P),S=i(W,S,H),R===null?D=W:R.sibling=W,R=W,P=B}if(H===w.length)return r(k,P),Rt&&Wi(k,H),D;if(P===null){for(;H<w.length;H++)P=m(k,w[H],A),P!==null&&(S=i(P,S,H),R===null?D=P:R.sibling=P,R=P);return Rt&&Wi(k,H),D}for(P=n(k,P);H<w.length;H++)B=x(P,k,H,w[H],A),B!==null&&(e&&B.alternate!==null&&P.delete(B.key===null?H:B.key),S=i(B,S,H),R===null?D=B:R.sibling=B,R=B);return e&&P.forEach(function(I){return t(k,I)}),Rt&&Wi(k,H),D}function y(k,S,w,A){var D=Zo(w);if(typeof D!="function")throw Error(Ce(150));if(w=D.call(w),w==null)throw Error(Ce(151));for(var R=D=null,P=S,H=S=0,B=null,W=w.next();P!==null&&!W.done;H++,W=w.next()){P.index>H?(B=P,P=null):B=P.sibling;var I=g(k,P,W.value,A);if(I===null){P===null&&(P=B);break}e&&P&&I.alternate===null&&t(k,P),S=i(I,S,H),R===null?D=I:R.sibling=I,R=I,P=B}if(W.done)return r(k,P),Rt&&Wi(k,H),D;if(P===null){for(;!W.done;H++,W=w.next())W=m(k,W.value,A),W!==null&&(S=i(W,S,H),R===null?D=W:R.sibling=W,R=W);return Rt&&Wi(k,H),D}for(P=n(k,P);!W.done;H++,W=w.next())W=x(P,k,H,W.value,A),W!==null&&(e&&W.alternate!==null&&P.delete(W.key===null?H:W.key),S=i(W,S,H),R===null?D=W:R.sibling=W,R=W);return e&&P.forEach(function(Z){return t(k,Z)}),Rt&&Wi(k,H),D}function E(k,S,w,A){if(typeof w=="object"&&w!==null&&w.type===Ws&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Wc:e:{for(var D=w.key,R=S;R!==null;){if(R.key===D){if(D=w.type,D===Ws){if(R.tag===7){r(k,R.sibling),S=a(R,w.props.children),S.return=k,k=S;break e}}else if(R.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===si&&nx(D)===R.type){r(k,R.sibling),S=a(R,w.props),S.ref=Jo(k,R,w),S.return=k,k=S;break e}r(k,R);break}else t(k,R);R=R.sibling}w.type===Ws?(S=as(w.props.children,k.mode,A,w.key),S.return=k,k=S):(A=Nu(w.type,w.key,w.props,null,k.mode,A),A.ref=Jo(k,S,w),A.return=k,k=A)}return o(k);case Vs:e:{for(R=w.key;S!==null;){if(S.key===R)if(S.tag===4&&S.stateNode.containerInfo===w.containerInfo&&S.stateNode.implementation===w.implementation){r(k,S.sibling),S=a(S,w.children||[]),S.return=k,k=S;break e}else{r(k,S);break}else t(k,S);S=S.sibling}S=nd(w,k.mode,A),S.return=k,k=S}return o(k);case si:return R=w._init,E(k,S,R(w._payload),A)}if(il(w))return _(k,S,w,A);if(Zo(w))return y(k,S,w,A);tu(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,S!==null&&S.tag===6?(r(k,S.sibling),S=a(S,w),S.return=k,k=S):(r(k,S),S=rd(w,k.mode,A),S.return=k,k=S),o(k)):r(k,S)}return E}var vo=b_(!0),N_=b_(!1),qu=ji(null),Xu=null,Js=null,up=null;function fp(){up=Js=Xu=null}function dp(e){var t=qu.current;Mt(qu),e._currentValue=t}function Yd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function lo(e,t){Xu=e,up=Js=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(nn=!0),e.firstContext=null)}function Fn(e){var t=e._currentValue;if(up!==e)if(e={context:e,memoizedValue:t,next:null},Js===null){if(Xu===null)throw Error(Ce(308));Js=e,Xu.dependencies={lanes:0,firstContext:e}}else Js=Js.next=e;return t}var Ki=null;function hp(e){Ki===null?Ki=[e]:Ki.push(e)}function A_(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,hp(t)):(r.next=a.next,a.next=r),t.interleaved=r,$a(e,n)}function $a(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var oi=!1;function pp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function L_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ei(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,xt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,$a(e,r)}return a=n.interleaved,a===null?(t.next=t,hp(n)):(t.next=a.next,a.next=t),n.interleaved=t,$a(e,r)}function ku(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qh(e,r)}}function ax(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Yu(e,t,r,n){var a=e.updateQueue;oi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(i!==null){var m=a.baseState;o=0,h=d=u=null,l=i;do{var g=l.lane,x=l.eventTime;if((n&g)===g){h!==null&&(h=h.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=e,y=l;switch(g=t,x=r,y.tag){case 1:if(_=y.payload,typeof _=="function"){m=_.call(x,m,g);break e}m=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=y.payload,g=typeof _=="function"?_.call(x,m,g):_,g==null)break e;m=Ht({},m,g);break e;case 2:oi=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=a.effects,g===null?a.effects=[l]:g.push(l))}else x={eventTime:x,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=x,u=m):h=h.next=x,o|=g;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;g=l,l=g.next,g.next=null,a.lastBaseUpdate=g,a.shared.pending=null}}while(!0);if(h===null&&(u=m),a.baseState=u,a.firstBaseUpdate=d,a.lastBaseUpdate=h,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);ds|=o,e.lanes=o,e.memoizedState=m}}function ix(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Ce(191,a));a.call(n)}}}var cc={},va=ji(cc),Vl=ji(cc),Wl=ji(cc);function Ji(e){if(e===cc)throw Error(Ce(174));return e}function mp(e,t){switch(Nt(Wl,t),Nt(Vl,e),Nt(va,cc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ld(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ld(t,e)}Mt(va),Nt(va,t)}function _o(){Mt(va),Mt(Vl),Mt(Wl)}function P_(e){Ji(Wl.current);var t=Ji(va.current),r=Ld(t,e.type);t!==r&&(Nt(Vl,e),Nt(va,r))}function gp(e){Vl.current===e&&(Mt(va),Mt(Vl))}var Bt=ji(0);function Ku(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Y0=[];function xp(){for(var e=0;e<Y0.length;e++)Y0[e]._workInProgressVersionPrimary=null;Y0.length=0}var Eu=Ya.ReactCurrentDispatcher,K0=Ya.ReactCurrentBatchConfig,fs=0,zt=null,sr=null,pr=null,Ju=!1,vl=!1,$l=0,gS=0;function Pr(){throw Error(Ce(321))}function vp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Qn(e[r],t[r]))return!1;return!0}function _p(e,t,r,n,a,i){if(fs=i,zt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Eu.current=e===null||e.memoizedState===null?yS:wS,e=r(n,a),vl){i=0;do{if(vl=!1,$l=0,25<=i)throw Error(Ce(301));i+=1,pr=sr=null,t.updateQueue=null,Eu.current=kS,e=r(n,a)}while(vl)}if(Eu.current=Qu,t=sr!==null&&sr.next!==null,fs=0,pr=sr=zt=null,Ju=!1,t)throw Error(Ce(300));return e}function yp(){var e=$l!==0;return $l=0,e}function da(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?zt.memoizedState=pr=e:pr=pr.next=e,pr}function On(){if(sr===null){var e=zt.alternate;e=e!==null?e.memoizedState:null}else e=sr.next;var t=pr===null?zt.memoizedState:pr.next;if(t!==null)pr=t,sr=e;else{if(e===null)throw Error(Ce(310));sr=e,e={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},pr===null?zt.memoizedState=pr=e:pr=pr.next=e}return pr}function Gl(e,t){return typeof t=="function"?t(e):t}function J0(e){var t=On(),r=t.queue;if(r===null)throw Error(Ce(311));r.lastRenderedReducer=e;var n=sr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,u=null,d=i;do{var h=d.lane;if((fs&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,zt.lanes|=h,ds|=h}d=d.next}while(d!==null&&d!==i);u===null?o=n:u.next=l,Qn(n,t.memoizedState)||(nn=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,zt.lanes|=i,ds|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Q0(e){var t=On(),r=t.queue;if(r===null)throw Error(Ce(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Qn(i,t.memoizedState)||(nn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function F_(){}function O_(e,t){var r=zt,n=On(),a=t(),i=!Qn(n.memoizedState,a);if(i&&(n.memoizedState=a,nn=!0),n=n.queue,wp(R_.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||pr!==null&&pr.memoizedState.tag&1){if(r.flags|=2048,Zl(9,j_.bind(null,r,n,a,t),void 0,null),mr===null)throw Error(Ce(349));fs&30||M_(r,t,a)}return a}function M_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=zt.updateQueue,t===null?(t={lastEffect:null,stores:null},zt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function j_(e,t,r,n){t.value=r,t.getSnapshot=n,D_(t)&&I_(e)}function R_(e,t,r){return r(function(){D_(t)&&I_(e)})}function D_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qn(e,r)}catch{return!0}}function I_(e){var t=$a(e,1);t!==null&&Kn(t,e,1,-1)}function sx(e){var t=da();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:e},t.queue=e,e=e.dispatch=_S.bind(null,zt,e),[t.memoizedState,e]}function Zl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=zt.updateQueue,t===null?(t={lastEffect:null,stores:null},zt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function B_(){return On().memoizedState}function Su(e,t,r,n){var a=da();zt.flags|=e,a.memoizedState=Zl(1|t,r,void 0,n===void 0?null:n)}function If(e,t,r,n){var a=On();n=n===void 0?null:n;var i=void 0;if(sr!==null){var o=sr.memoizedState;if(i=o.destroy,n!==null&&vp(n,o.deps)){a.memoizedState=Zl(t,r,i,n);return}}zt.flags|=e,a.memoizedState=Zl(1|t,r,i,n)}function ox(e,t){return Su(8390656,8,e,t)}function wp(e,t){return If(2048,8,e,t)}function z_(e,t){return If(4,2,e,t)}function U_(e,t){return If(4,4,e,t)}function H_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function V_(e,t,r){return r=r!=null?r.concat([e]):null,If(4,4,H_.bind(null,t,e),r)}function kp(){}function W_(e,t){var r=On();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&vp(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function $_(e,t){var r=On();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&vp(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function G_(e,t,r){return fs&21?(Qn(r,t)||(r=Kv(),zt.lanes|=r,ds|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,nn=!0),e.memoizedState=r)}function xS(e,t){var r=Et;Et=r!==0&&4>r?r:4,e(!0);var n=K0.transition;K0.transition={};try{e(!1),t()}finally{Et=r,K0.transition=n}}function Z_(){return On().memoizedState}function vS(e,t,r){var n=Ti(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},q_(e))X_(t,r);else if(r=A_(e,t,r,n),r!==null){var a=Xr();Kn(r,e,n,a),Y_(r,t,n)}}function _S(e,t,r){var n=Ti(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(q_(e))X_(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,Qn(l,o)){var u=t.interleaved;u===null?(a.next=a,hp(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}r=A_(e,t,a,n),r!==null&&(a=Xr(),Kn(r,e,n,a),Y_(r,t,n))}}function q_(e){var t=e.alternate;return e===zt||t!==null&&t===zt}function X_(e,t){vl=Ju=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Y_(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qh(e,r)}}var Qu={readContext:Fn,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},yS={readContext:Fn,useCallback:function(e,t){return da().memoizedState=[e,t===void 0?null:t],e},useContext:Fn,useEffect:ox,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Su(4194308,4,H_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Su(4194308,4,e,t)},useInsertionEffect:function(e,t){return Su(4,2,e,t)},useMemo:function(e,t){var r=da();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=da();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=vS.bind(null,zt,e),[n.memoizedState,e]},useRef:function(e){var t=da();return e={current:e},t.memoizedState=e},useState:sx,useDebugValue:kp,useDeferredValue:function(e){return da().memoizedState=e},useTransition:function(){var e=sx(!1),t=e[0];return e=xS.bind(null,e[1]),da().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=zt,a=da();if(Rt){if(r===void 0)throw Error(Ce(407));r=r()}else{if(r=t(),mr===null)throw Error(Ce(349));fs&30||M_(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,ox(R_.bind(null,n,i,e),[e]),n.flags|=2048,Zl(9,j_.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=da(),t=mr.identifierPrefix;if(Rt){var r=Da,n=Ra;r=(n&~(1<<32-Yn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=$l++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=gS++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wS={readContext:Fn,useCallback:W_,useContext:Fn,useEffect:wp,useImperativeHandle:V_,useInsertionEffect:z_,useLayoutEffect:U_,useMemo:$_,useReducer:J0,useRef:B_,useState:function(){return J0(Gl)},useDebugValue:kp,useDeferredValue:function(e){var t=On();return G_(t,sr.memoizedState,e)},useTransition:function(){var e=J0(Gl)[0],t=On().memoizedState;return[e,t]},useMutableSource:F_,useSyncExternalStore:O_,useId:Z_,unstable_isNewReconciler:!1},kS={readContext:Fn,useCallback:W_,useContext:Fn,useEffect:wp,useImperativeHandle:V_,useInsertionEffect:z_,useLayoutEffect:U_,useMemo:$_,useReducer:Q0,useRef:B_,useState:function(){return Q0(Gl)},useDebugValue:kp,useDeferredValue:function(e){var t=On();return sr===null?t.memoizedState=e:G_(t,sr.memoizedState,e)},useTransition:function(){var e=Q0(Gl)[0],t=On().memoizedState;return[e,t]},useMutableSource:F_,useSyncExternalStore:O_,useId:Z_,unstable_isNewReconciler:!1};function Wn(e,t){if(e&&e.defaultProps){t=Ht({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Kd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ht({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Bf={isMounted:function(e){return(e=e._reactInternals)?ys(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Xr(),a=Ti(e),i=Ba(n,a);i.payload=t,r!=null&&(i.callback=r),t=Ei(e,i,a),t!==null&&(Kn(t,e,a,n),ku(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Xr(),a=Ti(e),i=Ba(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ei(e,i,a),t!==null&&(Kn(t,e,a,n),ku(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Xr(),n=Ti(e),a=Ba(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ei(e,a,n),t!==null&&(Kn(t,e,n,r),ku(t,e,n))}};function lx(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Bl(r,n)||!Bl(a,i):!0}function K_(e,t,r){var n=!1,a=Li,i=t.contextType;return typeof i=="object"&&i!==null?i=Fn(i):(a=sn(t)?cs:zr.current,n=t.contextTypes,i=(n=n!=null)?go(e,a):Li),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bf,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function cx(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Bf.enqueueReplaceState(t,t.state,null)}function Jd(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},pp(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Fn(i):(i=sn(t)?cs:zr.current,a.context=go(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Kd(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Bf.enqueueReplaceState(a,a.state,null),Yu(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function yo(e,t){try{var r="",n=t;do r+=YE(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function ed(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Qd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ES=typeof WeakMap=="function"?WeakMap:Map;function J_(e,t,r){r=Ba(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){tf||(tf=!0,ch=n),Qd(e,t)},r}function Q_(e,t,r){r=Ba(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Qd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Qd(e,t),typeof n!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function ux(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ES;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=DS.bind(null,e,t,r),t.then(e,e))}function fx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dx(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ba(-1,1),t.tag=2,Ei(r,t,1))),r.lanes|=1),e)}var SS=Ya.ReactCurrentOwner,nn=!1;function $r(e,t,r,n){t.child=e===null?N_(t,null,r,n):vo(t,e.child,r,n)}function hx(e,t,r,n,a){r=r.render;var i=t.ref;return lo(t,a),n=_p(e,t,r,n,i,a),r=yp(),e!==null&&!nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ga(e,t,a)):(Rt&&r&&op(t),t.flags|=1,$r(e,t,n,a),t.child)}function px(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Lp(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,ey(e,t,i,n,a)):(e=Nu(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Bl,r(o,n)&&e.ref===t.ref)return Ga(e,t,a)}return t.flags|=1,e=Ci(i,n),e.ref=t.ref,e.return=t,t.child=e}function ey(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Bl(i,n)&&e.ref===t.ref)if(nn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(nn=!0);else return t.lanes=e.lanes,Ga(e,t,a)}return eh(e,t,r,n,a)}function ty(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(eo,cn),cn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Nt(eo,cn),cn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Nt(eo,cn),cn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Nt(eo,cn),cn|=n;return $r(e,t,a,r),t.child}function ry(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function eh(e,t,r,n,a){var i=sn(r)?cs:zr.current;return i=go(t,i),lo(t,a),r=_p(e,t,r,n,i,a),n=yp(),e!==null&&!nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ga(e,t,a)):(Rt&&n&&op(t),t.flags|=1,$r(e,t,r,a),t.child)}function mx(e,t,r,n,a){if(sn(r)){var i=!0;$u(t)}else i=!1;if(lo(t,a),t.stateNode===null)Tu(e,t),K_(t,r,n),Jd(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Fn(d):(d=sn(r)?cs:zr.current,d=go(t,d));var h=r.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==d)&&cx(t,o,n,d),oi=!1;var g=t.memoizedState;o.state=g,Yu(t,n,o,a),u=t.memoizedState,l!==n||g!==u||an.current||oi?(typeof h=="function"&&(Kd(t,r,h,n),u=t.memoizedState),(l=oi||lx(t,r,l,n,g,u,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,L_(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Wn(t.type,l),o.props=d,m=t.pendingProps,g=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=Fn(u):(u=sn(r)?cs:zr.current,u=go(t,u));var x=r.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==u)&&cx(t,o,n,u),oi=!1,g=t.memoizedState,o.state=g,Yu(t,n,o,a);var _=t.memoizedState;l!==m||g!==_||an.current||oi?(typeof x=="function"&&(Kd(t,r,x,n),_=t.memoizedState),(d=oi||lx(t,r,d,n,g,_,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,_,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,_,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=_),o.props=n,o.state=_,o.context=u,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return th(e,t,r,n,i,a)}function th(e,t,r,n,a,i){ry(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&ex(t,r,!1),Ga(e,t,i);n=t.stateNode,SS.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=vo(t,e.child,null,i),t.child=vo(t,null,l,i)):$r(e,t,l,i),t.memoizedState=n.state,a&&ex(t,r,!0),t.child}function ny(e){var t=e.stateNode;t.pendingContext?Qg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qg(e,t.context,!1),mp(e,t.containerInfo)}function gx(e,t,r,n,a){return xo(),cp(a),t.flags|=256,$r(e,t,r,n),t.child}var rh={dehydrated:null,treeContext:null,retryLane:0};function nh(e){return{baseLanes:e,cachePool:null,transitions:null}}function ay(e,t,r){var n=t.pendingProps,a=Bt.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Nt(Bt,a&1),e===null)return Xd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Hf(o,n,0,null),e=as(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=nh(r),t.memoizedState=rh,e):Ep(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return TS(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Ci(a,u),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Ci(l,i):(i=as(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?nh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=rh,n}return i=e.child,e=i.sibling,n=Ci(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ep(e,t){return t=Hf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ru(e,t,r,n){return n!==null&&cp(n),vo(t,e.child,null,r),e=Ep(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function TS(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=ed(Error(Ce(422))),ru(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Hf({mode:"visible",children:n.children},a,0,null),i=as(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&vo(t,e.child,null,o),t.child.memoizedState=nh(o),t.memoizedState=rh,i);if(!(t.mode&1))return ru(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Ce(419)),n=ed(i,n,void 0),ru(e,t,o,n)}if(l=(o&e.childLanes)!==0,nn||l){if(n=mr,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,$a(e,a),Kn(n,e,a,-1))}return Ap(),n=ed(Error(Ce(421))),ru(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=IS.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,dn=ki(a.nextSibling),hn=t,Rt=!0,Gn=null,e!==null&&(bn[Nn++]=Ra,bn[Nn++]=Da,bn[Nn++]=us,Ra=e.id,Da=e.overflow,us=t),t=Ep(t,n.children),t.flags|=4096,t)}function xx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Yd(e.return,t,r)}function td(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function iy(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if($r(e,t,n.children,r),n=Bt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&xx(e,r,t);else if(e.tag===19)xx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Nt(Bt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Ku(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),td(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ku(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}td(t,!0,r,null,i);break;case"together":td(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Tu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ga(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ds|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ce(153));if(t.child!==null){for(e=t.child,r=Ci(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ci(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function CS(e,t,r){switch(t.tag){case 3:ny(t),xo();break;case 5:P_(t);break;case 1:sn(t.type)&&$u(t);break;case 4:mp(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Nt(qu,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Nt(Bt,Bt.current&1),t.flags|=128,null):r&t.child.childLanes?ay(e,t,r):(Nt(Bt,Bt.current&1),e=Ga(e,t,r),e!==null?e.sibling:null);Nt(Bt,Bt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return iy(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Nt(Bt,Bt.current),n)break;return null;case 22:case 23:return t.lanes=0,ty(e,t,r)}return Ga(e,t,r)}var sy,ah,oy,ly;sy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ah=function(){};oy=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ji(va.current);var i=null;switch(r){case"input":a=Cd(e,a),n=Cd(e,n),i=[];break;case"select":a=Ht({},a,{value:void 0}),n=Ht({},n,{value:void 0}),i=[];break;case"textarea":a=Ad(e,a),n=Ad(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Vu)}Pd(r,n);var o;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Fl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var u=n[d];if(l=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(i||(i=[]),i.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Fl.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ft("scroll",e),i||l===u||(i=[])):(i=i||[]).push(d,u))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};ly=function(e,t,r,n){r!==n&&(t.flags|=4)};function Qo(e,t){if(!Rt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function bS(e,t,r){var n=t.pendingProps;switch(lp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(t),null;case 1:return sn(t.type)&&Wu(),Fr(t),null;case 3:return n=t.stateNode,_o(),Mt(an),Mt(zr),xp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(eu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gn!==null&&(dh(Gn),Gn=null))),ah(e,t),Fr(t),null;case 5:gp(t);var a=Ji(Wl.current);if(r=t.type,e!==null&&t.stateNode!=null)oy(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ce(166));return Fr(t),null}if(e=Ji(va.current),eu(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[pa]=t,n[Hl]=i,e=(t.mode&1)!==0,r){case"dialog":Ft("cancel",n),Ft("close",n);break;case"iframe":case"object":case"embed":Ft("load",n);break;case"video":case"audio":for(a=0;a<ol.length;a++)Ft(ol[a],n);break;case"source":Ft("error",n);break;case"img":case"image":case"link":Ft("error",n),Ft("load",n);break;case"details":Ft("toggle",n);break;case"input":Cg(n,i),Ft("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ft("invalid",n);break;case"textarea":Ng(n,i),Ft("invalid",n)}Pd(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Qc(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Qc(n.textContent,l,e),a=["children",""+l]):Fl.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ft("scroll",n)}switch(r){case"input":$c(n),bg(n,i,!0);break;case"textarea":$c(n),Ag(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Vu)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Rv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[pa]=t,e[Hl]=n,sy(e,t,!1,!1),t.stateNode=e;e:{switch(o=Fd(r,n),r){case"dialog":Ft("cancel",e),Ft("close",e),a=n;break;case"iframe":case"object":case"embed":Ft("load",e),a=n;break;case"video":case"audio":for(a=0;a<ol.length;a++)Ft(ol[a],e);a=n;break;case"source":Ft("error",e),a=n;break;case"img":case"image":case"link":Ft("error",e),Ft("load",e),a=n;break;case"details":Ft("toggle",e),a=n;break;case"input":Cg(e,n),a=Cd(e,n),Ft("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ht({},n,{value:void 0}),Ft("invalid",e);break;case"textarea":Ng(e,n),a=Ad(e,n),Ft("invalid",e);break;default:a=n}Pd(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Bv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Dv(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Ol(e,u):typeof u=="number"&&Ol(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fl.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ft("scroll",e):u!=null&&Zh(e,i,u,o))}switch(r){case"input":$c(e),bg(e,n,!1);break;case"textarea":$c(e),Ag(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ai(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?ao(e,!!n.multiple,i,!1):n.defaultValue!=null&&ao(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Vu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Fr(t),null;case 6:if(e&&t.stateNode!=null)ly(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ce(166));if(r=Ji(Wl.current),Ji(va.current),eu(t)){if(n=t.stateNode,r=t.memoizedProps,n[pa]=t,(i=n.nodeValue!==r)&&(e=hn,e!==null))switch(e.tag){case 3:Qc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[pa]=t,t.stateNode=n}return Fr(t),null;case 13:if(Mt(Bt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Rt&&dn!==null&&t.mode&1&&!(t.flags&128))C_(),xo(),t.flags|=98560,i=!1;else if(i=eu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Ce(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ce(317));i[pa]=t}else xo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Fr(t),i=!1}else Gn!==null&&(dh(Gn),Gn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Bt.current&1?or===0&&(or=3):Ap())),t.updateQueue!==null&&(t.flags|=4),Fr(t),null);case 4:return _o(),ah(e,t),e===null&&zl(t.stateNode.containerInfo),Fr(t),null;case 10:return dp(t.type._context),Fr(t),null;case 17:return sn(t.type)&&Wu(),Fr(t),null;case 19:if(Mt(Bt),i=t.memoizedState,i===null)return Fr(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Qo(i,!1);else{if(or!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ku(e),o!==null){for(t.flags|=128,Qo(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Nt(Bt,Bt.current&1|2),t.child}e=e.sibling}i.tail!==null&&Xt()>wo&&(t.flags|=128,n=!0,Qo(i,!1),t.lanes=4194304)}else{if(!n)if(e=Ku(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Qo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Rt)return Fr(t),null}else 2*Xt()-i.renderingStartTime>wo&&r!==1073741824&&(t.flags|=128,n=!0,Qo(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xt(),t.sibling=null,r=Bt.current,Nt(Bt,n?r&1|2:r&1),t):(Fr(t),null);case 22:case 23:return Np(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?cn&1073741824&&(Fr(t),t.subtreeFlags&6&&(t.flags|=8192)):Fr(t),null;case 24:return null;case 25:return null}throw Error(Ce(156,t.tag))}function NS(e,t){switch(lp(t),t.tag){case 1:return sn(t.type)&&Wu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _o(),Mt(an),Mt(zr),xp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return gp(t),null;case 13:if(Mt(Bt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ce(340));xo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Mt(Bt),null;case 4:return _o(),null;case 10:return dp(t.type._context),null;case 22:case 23:return Np(),null;case 24:return null;default:return null}}var nu=!1,jr=!1,AS=typeof WeakSet=="function"?WeakSet:Set,ze=null;function Qs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Wt(e,t,n)}else r.current=null}function ih(e,t,r){try{r()}catch(n){Wt(e,t,n)}}var vx=!1;function LS(e,t){if(Hd=zu,e=h_(),sp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,d=0,h=0,m=e,g=null;t:for(;;){for(var x;m!==r||a!==0&&m.nodeType!==3||(l=o+a),m!==i||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)g=m,m=x;for(;;){if(m===e)break t;if(g===r&&++d===a&&(l=o),g===i&&++h===n&&(u=o),(x=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=x}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Vd={focusedElem:e,selectionRange:r},zu=!1,ze=t;ze!==null;)if(t=ze,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ze=e;else for(;ze!==null;){t=ze;try{var _=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var y=_.memoizedProps,E=_.memoizedState,k=t.stateNode,S=k.getSnapshotBeforeUpdate(t.elementType===t.type?y:Wn(t.type,y),E);k.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ce(163))}}catch(A){Wt(t,t.return,A)}if(e=t.sibling,e!==null){e.return=t.return,ze=e;break}ze=t.return}return _=vx,vx=!1,_}function _l(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&ih(t,r,i)}a=a.next}while(a!==n)}}function zf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function sh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function cy(e){var t=e.alternate;t!==null&&(e.alternate=null,cy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[pa],delete t[Hl],delete t[Gd],delete t[dS],delete t[hS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function uy(e){return e.tag===5||e.tag===3||e.tag===4}function _x(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||uy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function oh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Vu));else if(n!==4&&(e=e.child,e!==null))for(oh(e,t,r),e=e.sibling;e!==null;)oh(e,t,r),e=e.sibling}function lh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(lh(e,t,r),e=e.sibling;e!==null;)lh(e,t,r),e=e.sibling}var yr=null,$n=!1;function ni(e,t,r){for(r=r.child;r!==null;)fy(e,t,r),r=r.sibling}function fy(e,t,r){if(xa&&typeof xa.onCommitFiberUnmount=="function")try{xa.onCommitFiberUnmount(Ff,r)}catch{}switch(r.tag){case 5:jr||Qs(r,t);case 6:var n=yr,a=$n;yr=null,ni(e,t,r),yr=n,$n=a,yr!==null&&($n?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&($n?(e=yr,r=r.stateNode,e.nodeType===8?q0(e.parentNode,r):e.nodeType===1&&q0(e,r),Dl(e)):q0(yr,r.stateNode));break;case 4:n=yr,a=$n,yr=r.stateNode.containerInfo,$n=!0,ni(e,t,r),yr=n,$n=a;break;case 0:case 11:case 14:case 15:if(!jr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ih(r,t,o),a=a.next}while(a!==n)}ni(e,t,r);break;case 1:if(!jr&&(Qs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Wt(r,t,l)}ni(e,t,r);break;case 21:ni(e,t,r);break;case 22:r.mode&1?(jr=(n=jr)||r.memoizedState!==null,ni(e,t,r),jr=n):ni(e,t,r);break;default:ni(e,t,r)}}function yx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new AS),t.forEach(function(n){var a=BS.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Un(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:yr=l.stateNode,$n=!1;break e;case 3:yr=l.stateNode.containerInfo,$n=!0;break e;case 4:yr=l.stateNode.containerInfo,$n=!0;break e}l=l.return}if(yr===null)throw Error(Ce(160));fy(i,o,a),yr=null,$n=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(d){Wt(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)dy(t,e),t=t.sibling}function dy(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Un(t,e),la(e),n&4){try{_l(3,e,e.return),zf(3,e)}catch(y){Wt(e,e.return,y)}try{_l(5,e,e.return)}catch(y){Wt(e,e.return,y)}}break;case 1:Un(t,e),la(e),n&512&&r!==null&&Qs(r,r.return);break;case 5:if(Un(t,e),la(e),n&512&&r!==null&&Qs(r,r.return),e.flags&32){var a=e.stateNode;try{Ol(a,"")}catch(y){Wt(e,e.return,y)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Mv(a,i),Fd(l,o);var d=Fd(l,i);for(o=0;o<u.length;o+=2){var h=u[o],m=u[o+1];h==="style"?Bv(a,m):h==="dangerouslySetInnerHTML"?Dv(a,m):h==="children"?Ol(a,m):Zh(a,h,m,d)}switch(l){case"input":bd(a,i);break;case"textarea":jv(a,i);break;case"select":var g=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?ao(a,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?ao(a,!!i.multiple,i.defaultValue,!0):ao(a,!!i.multiple,i.multiple?[]:"",!1))}a[Hl]=i}catch(y){Wt(e,e.return,y)}}break;case 6:if(Un(t,e),la(e),n&4){if(e.stateNode===null)throw Error(Ce(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(y){Wt(e,e.return,y)}}break;case 3:if(Un(t,e),la(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Dl(t.containerInfo)}catch(y){Wt(e,e.return,y)}break;case 4:Un(t,e),la(e);break;case 13:Un(t,e),la(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Cp=Xt())),n&4&&yx(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(jr=(d=jr)||h,Un(t,e),jr=d):Un(t,e),la(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!h&&e.mode&1)for(ze=e,h=e.child;h!==null;){for(m=ze=h;ze!==null;){switch(g=ze,x=g.child,g.tag){case 0:case 11:case 14:case 15:_l(4,g,g.return);break;case 1:Qs(g,g.return);var _=g.stateNode;if(typeof _.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(y){Wt(n,r,y)}}break;case 5:Qs(g,g.return);break;case 22:if(g.memoizedState!==null){kx(m);continue}}x!==null?(x.return=g,ze=x):kx(m)}h=h.sibling}e:for(h=null,m=e;;){if(m.tag===5){if(h===null){h=m;try{a=m.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Iv("display",o))}catch(y){Wt(e,e.return,y)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(y){Wt(e,e.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Un(t,e),la(e),n&4&&yx(e);break;case 21:break;default:Un(t,e),la(e)}}function la(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(uy(r)){var n=r;break e}r=r.return}throw Error(Ce(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ol(a,""),n.flags&=-33);var i=_x(e);lh(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=_x(e);oh(e,l,o);break;default:throw Error(Ce(161))}}catch(u){Wt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function PS(e,t,r){ze=e,hy(e)}function hy(e,t,r){for(var n=(e.mode&1)!==0;ze!==null;){var a=ze,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||nu;if(!o){var l=a.alternate,u=l!==null&&l.memoizedState!==null||jr;l=nu;var d=jr;if(nu=o,(jr=u)&&!d)for(ze=a;ze!==null;)o=ze,u=o.child,o.tag===22&&o.memoizedState!==null?Ex(a):u!==null?(u.return=o,ze=u):Ex(a);for(;i!==null;)ze=i,hy(i),i=i.sibling;ze=a,nu=l,jr=d}wx(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ze=i):wx(e)}}function wx(e){for(;ze!==null;){var t=ze;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jr||zf(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!jr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Wn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&ix(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ix(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Dl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ce(163))}jr||t.flags&512&&sh(t)}catch(g){Wt(t,t.return,g)}}if(t===e){ze=null;break}if(r=t.sibling,r!==null){r.return=t.return,ze=r;break}ze=t.return}}function kx(e){for(;ze!==null;){var t=ze;if(t===e){ze=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ze=r;break}ze=t.return}}function Ex(e){for(;ze!==null;){var t=ze;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{zf(4,t)}catch(u){Wt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(u){Wt(t,a,u)}}var i=t.return;try{sh(t)}catch(u){Wt(t,i,u)}break;case 5:var o=t.return;try{sh(t)}catch(u){Wt(t,o,u)}}}catch(u){Wt(t,t.return,u)}if(t===e){ze=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ze=l;break}ze=t.return}}var FS=Math.ceil,ef=Ya.ReactCurrentDispatcher,Sp=Ya.ReactCurrentOwner,Pn=Ya.ReactCurrentBatchConfig,xt=0,mr=null,nr=null,Sr=0,cn=0,eo=ji(0),or=0,ql=null,ds=0,Uf=0,Tp=0,yl=null,rn=null,Cp=0,wo=1/0,Pa=null,tf=!1,ch=null,Si=null,au=!1,mi=null,rf=0,wl=0,uh=null,Cu=-1,bu=0;function Xr(){return xt&6?Xt():Cu!==-1?Cu:Cu=Xt()}function Ti(e){return e.mode&1?xt&2&&Sr!==0?Sr&-Sr:mS.transition!==null?(bu===0&&(bu=Kv()),bu):(e=Et,e!==0||(e=window.event,e=e===void 0?16:a_(e.type)),e):1}function Kn(e,t,r,n){if(50<wl)throw wl=0,uh=null,Error(Ce(185));sc(e,r,n),(!(xt&2)||e!==mr)&&(e===mr&&(!(xt&2)&&(Uf|=r),or===4&&ci(e,Sr)),on(e,n),r===1&&xt===0&&!(t.mode&1)&&(wo=Xt()+500,Df&&Ri()))}function on(e,t){var r=e.callbackNode;m4(e,t);var n=Bu(e,e===mr?Sr:0);if(n===0)r!==null&&Fg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Fg(r),t===1)e.tag===0?pS(Sx.bind(null,e)):E_(Sx.bind(null,e)),uS(function(){!(xt&6)&&Ri()}),r=null;else{switch(Jv(n)){case 1:r=Jh;break;case 4:r=Xv;break;case 16:r=Iu;break;case 536870912:r=Yv;break;default:r=Iu}r=wy(r,py.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function py(e,t){if(Cu=-1,bu=0,xt&6)throw Error(Ce(327));var r=e.callbackNode;if(co()&&e.callbackNode!==r)return null;var n=Bu(e,e===mr?Sr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=nf(e,n);else{t=n;var a=xt;xt|=2;var i=gy();(mr!==e||Sr!==t)&&(Pa=null,wo=Xt()+500,ns(e,t));do try{jS();break}catch(l){my(e,l)}while(!0);fp(),ef.current=i,xt=a,nr!==null?t=0:(mr=null,Sr=0,t=or)}if(t!==0){if(t===2&&(a=Dd(e),a!==0&&(n=a,t=fh(e,a))),t===1)throw r=ql,ns(e,0),ci(e,n),on(e,Xt()),r;if(t===6)ci(e,n);else{if(a=e.current.alternate,!(n&30)&&!OS(a)&&(t=nf(e,n),t===2&&(i=Dd(e),i!==0&&(n=i,t=fh(e,i))),t===1))throw r=ql,ns(e,0),ci(e,n),on(e,Xt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Ce(345));case 2:$i(e,rn,Pa);break;case 3:if(ci(e,n),(n&130023424)===n&&(t=Cp+500-Xt(),10<t)){if(Bu(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Xr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=$d($i.bind(null,e,rn,Pa),t);break}$i(e,rn,Pa);break;case 4:if(ci(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Yn(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Xt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*FS(n/1960))-n,10<n){e.timeoutHandle=$d($i.bind(null,e,rn,Pa),n);break}$i(e,rn,Pa);break;case 5:$i(e,rn,Pa);break;default:throw Error(Ce(329))}}}return on(e,Xt()),e.callbackNode===r?py.bind(null,e):null}function fh(e,t){var r=yl;return e.current.memoizedState.isDehydrated&&(ns(e,t).flags|=256),e=nf(e,t),e!==2&&(t=rn,rn=r,t!==null&&dh(t)),e}function dh(e){rn===null?rn=e:rn.push.apply(rn,e)}function OS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Qn(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ci(e,t){for(t&=~Tp,t&=~Uf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Yn(t),n=1<<r;e[r]=-1,t&=~n}}function Sx(e){if(xt&6)throw Error(Ce(327));co();var t=Bu(e,0);if(!(t&1))return on(e,Xt()),null;var r=nf(e,t);if(e.tag!==0&&r===2){var n=Dd(e);n!==0&&(t=n,r=fh(e,n))}if(r===1)throw r=ql,ns(e,0),ci(e,t),on(e,Xt()),r;if(r===6)throw Error(Ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,$i(e,rn,Pa),on(e,Xt()),null}function bp(e,t){var r=xt;xt|=1;try{return e(t)}finally{xt=r,xt===0&&(wo=Xt()+500,Df&&Ri())}}function hs(e){mi!==null&&mi.tag===0&&!(xt&6)&&co();var t=xt;xt|=1;var r=Pn.transition,n=Et;try{if(Pn.transition=null,Et=1,e)return e()}finally{Et=n,Pn.transition=r,xt=t,!(xt&6)&&Ri()}}function Np(){cn=eo.current,Mt(eo)}function ns(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,cS(r)),nr!==null)for(r=nr.return;r!==null;){var n=r;switch(lp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Wu();break;case 3:_o(),Mt(an),Mt(zr),xp();break;case 5:gp(n);break;case 4:_o();break;case 13:Mt(Bt);break;case 19:Mt(Bt);break;case 10:dp(n.type._context);break;case 22:case 23:Np()}r=r.return}if(mr=e,nr=e=Ci(e.current,null),Sr=cn=t,or=0,ql=null,Tp=Uf=ds=0,rn=yl=null,Ki!==null){for(t=0;t<Ki.length;t++)if(r=Ki[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Ki=null}return e}function my(e,t){do{var r=nr;try{if(fp(),Eu.current=Qu,Ju){for(var n=zt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Ju=!1}if(fs=0,pr=sr=zt=null,vl=!1,$l=0,Sp.current=null,r===null||r.return===null){or=1,ql=t,nr=null;break}e:{var i=e,o=r.return,l=r,u=t;if(t=Sr,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=fx(o);if(x!==null){x.flags&=-257,dx(x,o,l,i,t),x.mode&1&&ux(i,d,t),t=x,u=d;var _=t.updateQueue;if(_===null){var y=new Set;y.add(u),t.updateQueue=y}else _.add(u);break e}else{if(!(t&1)){ux(i,d,t),Ap();break e}u=Error(Ce(426))}}else if(Rt&&l.mode&1){var E=fx(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),dx(E,o,l,i,t),cp(yo(u,l));break e}}i=u=yo(u,l),or!==4&&(or=2),yl===null?yl=[i]:yl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var k=J_(i,u,t);ax(i,k);break e;case 1:l=u;var S=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof S.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Si===null||!Si.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var A=Q_(i,l,t);ax(i,A);break e}}i=i.return}while(i!==null)}vy(r)}catch(D){t=D,nr===r&&r!==null&&(nr=r=r.return);continue}break}while(!0)}function gy(){var e=ef.current;return ef.current=Qu,e===null?Qu:e}function Ap(){(or===0||or===3||or===2)&&(or=4),mr===null||!(ds&268435455)&&!(Uf&268435455)||ci(mr,Sr)}function nf(e,t){var r=xt;xt|=2;var n=gy();(mr!==e||Sr!==t)&&(Pa=null,ns(e,t));do try{MS();break}catch(a){my(e,a)}while(!0);if(fp(),xt=r,ef.current=n,nr!==null)throw Error(Ce(261));return mr=null,Sr=0,or}function MS(){for(;nr!==null;)xy(nr)}function jS(){for(;nr!==null&&!s4();)xy(nr)}function xy(e){var t=yy(e.alternate,e,cn);e.memoizedProps=e.pendingProps,t===null?vy(e):nr=t,Sp.current=null}function vy(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=NS(r,t),r!==null){r.flags&=32767,nr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{or=6,nr=null;return}}else if(r=bS(r,t,cn),r!==null){nr=r;return}if(t=t.sibling,t!==null){nr=t;return}nr=t=e}while(t!==null);or===0&&(or=5)}function $i(e,t,r){var n=Et,a=Pn.transition;try{Pn.transition=null,Et=1,RS(e,t,r,n)}finally{Pn.transition=a,Et=n}return null}function RS(e,t,r,n){do co();while(mi!==null);if(xt&6)throw Error(Ce(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ce(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(g4(e,i),e===mr&&(nr=mr=null,Sr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||au||(au=!0,wy(Iu,function(){return co(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Pn.transition,Pn.transition=null;var o=Et;Et=1;var l=xt;xt|=4,Sp.current=null,LS(e,r),dy(r,e),rS(Vd),zu=!!Hd,Vd=Hd=null,e.current=r,PS(r),o4(),xt=l,Et=o,Pn.transition=i}else e.current=r;if(au&&(au=!1,mi=e,rf=a),i=e.pendingLanes,i===0&&(Si=null),u4(r.stateNode),on(e,Xt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(tf)throw tf=!1,e=ch,ch=null,e;return rf&1&&e.tag!==0&&co(),i=e.pendingLanes,i&1?e===uh?wl++:(wl=0,uh=e):wl=0,Ri(),null}function co(){if(mi!==null){var e=Jv(rf),t=Pn.transition,r=Et;try{if(Pn.transition=null,Et=16>e?16:e,mi===null)var n=!1;else{if(e=mi,mi=null,rf=0,xt&6)throw Error(Ce(331));var a=xt;for(xt|=4,ze=e.current;ze!==null;){var i=ze,o=i.child;if(ze.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(ze=d;ze!==null;){var h=ze;switch(h.tag){case 0:case 11:case 15:_l(8,h,i)}var m=h.child;if(m!==null)m.return=h,ze=m;else for(;ze!==null;){h=ze;var g=h.sibling,x=h.return;if(cy(h),h===d){ze=null;break}if(g!==null){g.return=x,ze=g;break}ze=x}}}var _=i.alternate;if(_!==null){var y=_.child;if(y!==null){_.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}ze=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ze=o;else e:for(;ze!==null;){if(i=ze,i.flags&2048)switch(i.tag){case 0:case 11:case 15:_l(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,ze=k;break e}ze=i.return}}var S=e.current;for(ze=S;ze!==null;){o=ze;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ze=w;else e:for(o=S;ze!==null;){if(l=ze,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zf(9,l)}}catch(D){Wt(l,l.return,D)}if(l===o){ze=null;break e}var A=l.sibling;if(A!==null){A.return=l.return,ze=A;break e}ze=l.return}}if(xt=a,Ri(),xa&&typeof xa.onPostCommitFiberRoot=="function")try{xa.onPostCommitFiberRoot(Ff,e)}catch{}n=!0}return n}finally{Et=r,Pn.transition=t}}return!1}function Tx(e,t,r){t=yo(r,t),t=J_(e,t,1),e=Ei(e,t,1),t=Xr(),e!==null&&(sc(e,1,t),on(e,t))}function Wt(e,t,r){if(e.tag===3)Tx(e,e,r);else for(;t!==null;){if(t.tag===3){Tx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Si===null||!Si.has(n))){e=yo(r,e),e=Q_(t,e,1),t=Ei(t,e,1),e=Xr(),t!==null&&(sc(t,1,e),on(t,e));break}}t=t.return}}function DS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Xr(),e.pingedLanes|=e.suspendedLanes&r,mr===e&&(Sr&r)===r&&(or===4||or===3&&(Sr&130023424)===Sr&&500>Xt()-Cp?ns(e,0):Tp|=r),on(e,t)}function _y(e,t){t===0&&(e.mode&1?(t=qc,qc<<=1,!(qc&130023424)&&(qc=4194304)):t=1);var r=Xr();e=$a(e,t),e!==null&&(sc(e,t,r),on(e,r))}function IS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),_y(e,r)}function BS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ce(314))}n!==null&&n.delete(t),_y(e,r)}var yy;yy=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||an.current)nn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return nn=!1,CS(e,t,r);nn=!!(e.flags&131072)}else nn=!1,Rt&&t.flags&1048576&&S_(t,Zu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Tu(e,t),e=t.pendingProps;var a=go(t,zr.current);lo(t,r),a=_p(null,t,n,e,a,r);var i=yp();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,sn(n)?(i=!0,$u(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,pp(t),a.updater=Bf,t.stateNode=a,a._reactInternals=t,Jd(t,n,e,r),t=th(null,t,n,!0,i,r)):(t.tag=0,Rt&&i&&op(t),$r(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Tu(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=US(n),e=Wn(n,e),a){case 0:t=eh(null,t,n,e,r);break e;case 1:t=mx(null,t,n,e,r);break e;case 11:t=hx(null,t,n,e,r);break e;case 14:t=px(null,t,n,Wn(n.type,e),r);break e}throw Error(Ce(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),eh(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),mx(e,t,n,a,r);case 3:e:{if(ny(t),e===null)throw Error(Ce(387));n=t.pendingProps,i=t.memoizedState,a=i.element,L_(e,t),Yu(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=yo(Error(Ce(423)),t),t=gx(e,t,n,r,a);break e}else if(n!==a){a=yo(Error(Ce(424)),t),t=gx(e,t,n,r,a);break e}else for(dn=ki(t.stateNode.containerInfo.firstChild),hn=t,Rt=!0,Gn=null,r=N_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(xo(),n===a){t=Ga(e,t,r);break e}$r(e,t,n,r)}t=t.child}return t;case 5:return P_(t),e===null&&Xd(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,Wd(n,a)?o=null:i!==null&&Wd(n,i)&&(t.flags|=32),ry(e,t),$r(e,t,o,r),t.child;case 6:return e===null&&Xd(t),null;case 13:return ay(e,t,r);case 4:return mp(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=vo(t,null,n,r):$r(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),hx(e,t,n,a,r);case 7:return $r(e,t,t.pendingProps,r),t.child;case 8:return $r(e,t,t.pendingProps.children,r),t.child;case 12:return $r(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Nt(qu,n._currentValue),n._currentValue=o,i!==null)if(Qn(i.value,o)){if(i.children===a.children&&!an.current){t=Ga(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=Ba(-1,r&-r),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Yd(i.return,r,t),l.lanes|=r;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ce(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Yd(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}$r(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,lo(t,r),a=Fn(a),n=n(a),t.flags|=1,$r(e,t,n,r),t.child;case 14:return n=t.type,a=Wn(n,t.pendingProps),a=Wn(n.type,a),px(e,t,n,a,r);case 15:return ey(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),Tu(e,t),t.tag=1,sn(n)?(e=!0,$u(t)):e=!1,lo(t,r),K_(t,n,a),Jd(t,n,a,r),th(null,t,n,!0,e,r);case 19:return iy(e,t,r);case 22:return ty(e,t,r)}throw Error(Ce(156,t.tag))};function wy(e,t){return qv(e,t)}function zS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(e,t,r,n){return new zS(e,t,r,n)}function Lp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function US(e){if(typeof e=="function")return Lp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xh)return 11;if(e===Yh)return 14}return 2}function Ci(e,t){var r=e.alternate;return r===null?(r=Ln(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Nu(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")Lp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ws:return as(r.children,a,i,t);case qh:o=8,a|=8;break;case kd:return e=Ln(12,r,t,a|2),e.elementType=kd,e.lanes=i,e;case Ed:return e=Ln(13,r,t,a),e.elementType=Ed,e.lanes=i,e;case Sd:return e=Ln(19,r,t,a),e.elementType=Sd,e.lanes=i,e;case Pv:return Hf(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Av:o=10;break e;case Lv:o=9;break e;case Xh:o=11;break e;case Yh:o=14;break e;case si:o=16,n=null;break e}throw Error(Ce(130,e==null?e:typeof e,""))}return t=Ln(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function as(e,t,r,n){return e=Ln(7,e,n,t),e.lanes=r,e}function Hf(e,t,r,n){return e=Ln(22,e,n,t),e.elementType=Pv,e.lanes=r,e.stateNode={isHidden:!1},e}function rd(e,t,r){return e=Ln(6,e,null,t),e.lanes=r,e}function nd(e,t,r){return t=Ln(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function HS(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=D0(0),this.expirationTimes=D0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=D0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Pp(e,t,r,n,a,i,o,l,u){return e=new HS(e,t,r,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ln(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},pp(i),e}function VS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function ky(e){if(!e)return Li;e=e._reactInternals;e:{if(ys(e)!==e||e.tag!==1)throw Error(Ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(sn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ce(171))}if(e.tag===1){var r=e.type;if(sn(r))return k_(e,r,t)}return t}function Ey(e,t,r,n,a,i,o,l,u){return e=Pp(r,n,!0,e,a,i,o,l,u),e.context=ky(null),r=e.current,n=Xr(),a=Ti(r),i=Ba(n,a),i.callback=t??null,Ei(r,i,a),e.current.lanes=a,sc(e,a,n),on(e,n),e}function Vf(e,t,r,n){var a=t.current,i=Xr(),o=Ti(a);return r=ky(r),t.context===null?t.context=r:t.pendingContext=r,t=Ba(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ei(a,t,o),e!==null&&(Kn(e,a,o,i),ku(e,a,o)),o}function af(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Cx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Fp(e,t){Cx(e,t),(e=e.alternate)&&Cx(e,t)}function WS(){return null}var Sy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Op(e){this._internalRoot=e}Wf.prototype.render=Op.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ce(409));Vf(e,t,null,null)};Wf.prototype.unmount=Op.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hs(function(){Vf(null,e,null,null)}),t[Wa]=null}};function Wf(e){this._internalRoot=e}Wf.prototype.unstable_scheduleHydration=function(e){if(e){var t=t_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<li.length&&t!==0&&t<li[r].priority;r++);li.splice(r,0,e),r===0&&n_(e)}};function Mp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $f(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function bx(){}function $S(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=af(o);i.call(d)}}var o=Ey(t,n,e,0,null,!1,!1,"",bx);return e._reactRootContainer=o,e[Wa]=o.current,zl(e.nodeType===8?e.parentNode:e),hs(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=af(u);l.call(d)}}var u=Pp(e,0,!1,null,null,!1,!1,"",bx);return e._reactRootContainer=u,e[Wa]=u.current,zl(e.nodeType===8?e.parentNode:e),hs(function(){Vf(t,u,r,n)}),u}function Gf(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var u=af(o);l.call(u)}}Vf(t,o,e,a)}else o=$S(r,t,e,a,n);return af(o)}Qv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=sl(t.pendingLanes);r!==0&&(Qh(t,r|1),on(t,Xt()),!(xt&6)&&(wo=Xt()+500,Ri()))}break;case 13:hs(function(){var n=$a(e,1);if(n!==null){var a=Xr();Kn(n,e,1,a)}}),Fp(e,1)}};ep=function(e){if(e.tag===13){var t=$a(e,134217728);if(t!==null){var r=Xr();Kn(t,e,134217728,r)}Fp(e,134217728)}};e_=function(e){if(e.tag===13){var t=Ti(e),r=$a(e,t);if(r!==null){var n=Xr();Kn(r,e,t,n)}Fp(e,t)}};t_=function(){return Et};r_=function(e,t){var r=Et;try{return Et=e,t()}finally{Et=r}};Md=function(e,t,r){switch(t){case"input":if(bd(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Rf(n);if(!a)throw Error(Ce(90));Ov(n),bd(n,a)}}}break;case"textarea":jv(e,r);break;case"select":t=r.value,t!=null&&ao(e,!!r.multiple,t,!1)}};Hv=bp;Vv=hs;var GS={usingClientEntryPoint:!1,Events:[lc,qs,Rf,zv,Uv,bp]},el={findFiberByHostInstance:Yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZS={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ya.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Gv(e),e===null?null:e.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||WS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{Ff=iu.inject(ZS),xa=iu}catch{}}xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GS;xn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mp(t))throw Error(Ce(200));return VS(e,t,null,r)};xn.createRoot=function(e,t){if(!Mp(e))throw Error(Ce(299));var r=!1,n="",a=Sy;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Pp(e,1,!1,null,null,r,!1,n,a),e[Wa]=t.current,zl(e.nodeType===8?e.parentNode:e),new Op(t)};xn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ce(188)):(e=Object.keys(e).join(","),Error(Ce(268,e)));return e=Gv(t),e=e===null?null:e.stateNode,e};xn.flushSync=function(e){return hs(e)};xn.hydrate=function(e,t,r){if(!$f(t))throw Error(Ce(200));return Gf(null,e,t,!0,r)};xn.hydrateRoot=function(e,t,r){if(!Mp(e))throw Error(Ce(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=Sy;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Ey(t,null,e,1,r??null,a,!1,i,o),e[Wa]=t.current,zl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Wf(t)};xn.render=function(e,t,r){if(!$f(t))throw Error(Ce(200));return Gf(null,e,t,!1,r)};xn.unmountComponentAtNode=function(e){if(!$f(e))throw Error(Ce(40));return e._reactRootContainer?(hs(function(){Gf(null,null,e,!1,function(){e._reactRootContainer=null,e[Wa]=null})}),!0):!1};xn.unstable_batchedUpdates=bp;xn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!$f(r))throw Error(Ce(200));if(e==null||e._reactInternals===void 0)throw Error(Ce(38));return Gf(e,t,r,!1,n)};xn.version="18.3.1-next-f1338f8080-20240426";function Ty(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ty)}catch(e){console.error(e)}}Ty(),Tv.exports=xn;var Cy=Tv.exports,Nx=Cy;yd.createRoot=Nx.createRoot,yd.hydrateRoot=Nx.hydrateRoot;var jp={};Object.defineProperty(jp,"__esModule",{value:!0});jp.parse=eT;jp.serialize=tT;const qS=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,XS=/^[\u0021-\u003A\u003C-\u007E]*$/,YS=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,KS=/^[\u0020-\u003A\u003D-\u007E]*$/,JS=Object.prototype.toString,QS=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function eT(e,t){const r=new QS,n=e.length;if(n<2)return r;const a=(t==null?void 0:t.decode)||rT;let i=0;do{const o=e.indexOf("=",i);if(o===-1)break;const l=e.indexOf(";",i),u=l===-1?n:l;if(o>u){i=e.lastIndexOf(";",o-1)+1;continue}const d=Ax(e,i,o),h=Lx(e,o,d),m=e.slice(d,h);if(r[m]===void 0){let g=Ax(e,o+1,u),x=Lx(e,u,g);const _=a(e.slice(g,x));r[m]=_}i=u+1}while(i<n);return r}function Ax(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function Lx(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function tT(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!qS.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=n(t);if(!XS.test(a))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+a;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!YS.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!KS.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!nT(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function rT(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function nT(e){return JS.call(e)==="[object Date]"}/**
 * react-router v7.5.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function aT(e={}){let{initialEntries:t=["/"],initialIndex:r,v5Compat:n=!1}=e,a;a=t.map((x,_)=>h(x,typeof x=="string"?null:x.state,_===0?"default":void 0));let i=u(r??a.length-1),o="POP",l=null;function u(x){return Math.min(Math.max(x,0),a.length-1)}function d(){return a[i]}function h(x,_=null,y){let E=sT(a?d().pathname:"/",x,_,y);return Mn(E.pathname.charAt(0)==="/",`relative pathnames are not supported in memory history: ${JSON.stringify(x)}`),E}function m(x){return typeof x=="string"?x:sf(x)}return{get index(){return i},get action(){return o},get location(){return d()},createHref:m,createURL(x){return new URL(m(x),"http://localhost")},encodeLocation(x){let _=typeof x=="string"?ws(x):x;return{pathname:_.pathname||"",search:_.search||"",hash:_.hash||""}},push(x,_){o="PUSH";let y=h(x,_);i+=1,a.splice(i,a.length,y),n&&l&&l({action:o,location:y,delta:1})},replace(x,_){o="REPLACE";let y=h(x,_);a[i]=y,n&&l&&l({action:o,location:y,delta:0})},go(x){o="POP";let _=u(i+x),y=a[_];i=_,l&&l({action:o,location:y,delta:x})},listen(x){return l=x,()=>{l=null}}}}function Ut(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Mn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function iT(){return Math.random().toString(36).substring(2,10)}function sT(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ws(t):t,state:r,key:t&&t.key||n||iT()}}function sf({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ws(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function by(e,t,r="/"){return oT(e,t,r,!1)}function oT(e,t,r,n){let a=typeof t=="string"?ws(t):t,i=Za(a.pathname||"/",r);if(i==null)return null;let o=Ny(e);lT(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=_T(i);l=xT(o[u],d,n)}return l}function Ny(e,t=[],r=[],n=""){let a=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Ut(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let d=za([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(Ut(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),Ny(i.children,t,h,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:mT(d,i.index),routesMeta:h})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let u of Ay(i.path))a(i,o,u)}),t}function Ay(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Ay(n.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function lT(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:gT(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var cT=/^:[\w-]+$/,uT=3,fT=2,dT=1,hT=10,pT=-2,Px=e=>e==="*";function mT(e,t){let r=e.split("/"),n=r.length;return r.some(Px)&&(n+=pT),t&&(n+=fT),r.filter(a=>!Px(a)).reduce((a,i)=>a+(cT.test(i)?uT:i===""?dT:hT),n)}function gT(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function xT(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],d=l===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",m=of({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),g=u.route;if(!m&&d&&r&&!n[n.length-1].route.index&&(m=of({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!m)return null;Object.assign(a,m.params),o.push({params:a,pathname:za([i,m.pathname]),pathnameBase:ET(za([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=za([i,m.pathnameBase]))}return o}function of(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=vT(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,{paramName:h,isOptional:m},g)=>{if(h==="*"){let _=l[g]||"";o=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const x=l[g];return m&&!x?d[h]=void 0:d[h]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:e}}function vT(e,t=!1,r=!0){Mn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function _T(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Mn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Za(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function yT(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?ws(e):e;return{pathname:r?r.startsWith("/")?r:wT(r,t):t,search:ST(n),hash:TT(a)}}function wT(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ad(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function kT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Rp(e){let t=kT(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Dp(e,t,r,n=!1){let a;typeof e=="string"?a=ws(e):(a={...e},Ut(!a.pathname||!a.pathname.includes("?"),ad("?","pathname","search",a)),Ut(!a.pathname||!a.pathname.includes("#"),ad("#","pathname","hash",a)),Ut(!a.search||!a.search.includes("#"),ad("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;a.pathname=g.join("/")}l=m>=0?t[m]:"/"}let u=yT(a,l),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var za=e=>e.join("/").replace(/\/\/+/g,"/"),ET=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ST=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,TT=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function CT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Ly=["POST","PUT","PATCH","DELETE"];new Set(Ly);var bT=["GET",...Ly];new Set(bT);var No=C.createContext(null);No.displayName="DataRouter";var Zf=C.createContext(null);Zf.displayName="DataRouterState";var Py=C.createContext({isTransitioning:!1});Py.displayName="ViewTransition";var NT=C.createContext(new Map);NT.displayName="Fetchers";var AT=C.createContext(null);AT.displayName="Await";var ea=C.createContext(null);ea.displayName="Navigation";var uc=C.createContext(null);uc.displayName="Location";var ta=C.createContext({outlet:null,matches:[],isDataRoute:!1});ta.displayName="Route";var Ip=C.createContext(null);Ip.displayName="RouteError";function LT(e,{relative:t}={}){Ut(Ao(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=C.useContext(ea),{hash:a,pathname:i,search:o}=fc(e,{relative:t}),l=i;return r!=="/"&&(l=i==="/"?r:za([r,i])),n.createHref({pathname:l,search:o,hash:a})}function Ao(){return C.useContext(uc)!=null}function Ka(){return Ut(Ao(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(uc).location}var Fy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Oy(e){C.useContext(ea).static||C.useLayoutEffect(e)}function ya(){let{isDataRoute:e}=C.useContext(ta);return e?WT():PT()}function PT(){Ut(Ao(),"useNavigate() may be used only in the context of a <Router> component.");let e=C.useContext(No),{basename:t,navigator:r}=C.useContext(ea),{matches:n}=C.useContext(ta),{pathname:a}=Ka(),i=JSON.stringify(Rp(n)),o=C.useRef(!1);return Oy(()=>{o.current=!0}),C.useCallback((u,d={})=>{if(Mn(o.current,Fy),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=Dp(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:za([t,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[t,r,i,a,e])}C.createContext(null);function FT(){let{matches:e}=C.useContext(ta),t=e[e.length-1];return t?t.params:{}}function fc(e,{relative:t}={}){let{matches:r}=C.useContext(ta),{pathname:n}=Ka(),a=JSON.stringify(Rp(r));return C.useMemo(()=>Dp(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function OT(e,t){return My(e,t)}function My(e,t,r,n){var S;Ut(Ao(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=C.useContext(ea),{matches:o}=C.useContext(ta),l=o[o.length-1],u=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",m=l&&l.route;{let w=m&&m.path||"";jy(d,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let g=Ka(),x;if(t){let w=typeof t=="string"?ws(t):t;Ut(h==="/"||((S=w.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${w.pathname}" was given in the \`location\` prop.`),x=w}else x=g;let _=x.pathname||"/",y=_;if(h!=="/"){let w=h.replace(/^\//,"").split("/");y="/"+_.replace(/^\//,"").split("/").slice(w.length).join("/")}let E=!i&&r&&r.matches&&r.matches.length>0?r.matches:by(e,{pathname:y});Mn(m||E!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),Mn(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=IT(E&&E.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:za([h,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?h:za([h,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n);return t&&k?C.createElement(uc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},k):k}function MT(){let e=VT(),t=CT(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:i},"ErrorBoundary")," or"," ",C.createElement("code",{style:i},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:a},r):null,o)}var jT=C.createElement(MT,null),RT=class extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(ta.Provider,{value:this.props.routeContext},C.createElement(Ip.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function DT({routeContext:e,match:t,children:r}){let n=C.useContext(No);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(ta.Provider,{value:e},r)}function IT(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let u=a.findIndex(d=>d.route.id&&(i==null?void 0:i[d.route.id])!==void 0);Ut(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,l=-1;if(r)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:h,errors:m}=r,g=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!m||m[d.route.id]===void 0);if(d.route.lazy||g){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((u,d,h)=>{let m,g=!1,x=null,_=null;r&&(m=i&&d.route.id?i[d.route.id]:void 0,x=d.route.errorElement||jT,o&&(l<0&&h===0?(jy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,_=null):l===h&&(g=!0,_=d.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,h+1)),E=()=>{let k;return m?k=x:g?k=_:d.route.Component?k=C.createElement(d.route.Component,null):d.route.element?k=d.route.element:k=u,C.createElement(DT,{match:d,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:k})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?C.createElement(RT,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:E(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):E()},null)}function Bp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function BT(e){let t=C.useContext(No);return Ut(t,Bp(e)),t}function zT(e){let t=C.useContext(Zf);return Ut(t,Bp(e)),t}function UT(e){let t=C.useContext(ta);return Ut(t,Bp(e)),t}function zp(e){let t=UT(e),r=t.matches[t.matches.length-1];return Ut(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function HT(){return zp("useRouteId")}function VT(){var n;let e=C.useContext(Ip),t=zT("useRouteError"),r=zp("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function WT(){let{router:e}=BT("useNavigate"),t=zp("useNavigate"),r=C.useRef(!1);return Oy(()=>{r.current=!0}),C.useCallback(async(a,i={})=>{Mn(r.current,Fy),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var Fx={};function jy(e,t,r){!t&&!Fx[e]&&(Fx[e]=!0,Mn(!1,r))}C.memo($T);function $T({routes:e,future:t,state:r}){return My(e,void 0,r,t)}function GT({basename:e,children:t,initialEntries:r,initialIndex:n}){let a=C.useRef();a.current==null&&(a.current=aT({initialEntries:r,initialIndex:n,v5Compat:!0}));let i=a.current,[o,l]=C.useState({action:i.action,location:i.location}),u=C.useCallback(d=>{C.startTransition(()=>l(d))},[l]);return C.useLayoutEffect(()=>i.listen(u),[i,u]),C.createElement(qT,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i})}function ZT({to:e,replace:t,state:r,relative:n}){Ut(Ao(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=C.useContext(ea);Mn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=C.useContext(ta),{pathname:o}=Ka(),l=ya(),u=Dp(e,Rp(i),o,n==="path"),d=JSON.stringify(u);return C.useEffect(()=>{l(JSON.parse(d),{replace:t,state:r,relative:n})},[l,d,n,t,r]),null}function er(e){Ut(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function qT({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){Ut(!Ao(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=C.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof r=="string"&&(r=ws(r));let{pathname:u="/",search:d="",hash:h="",state:m=null,key:g="default"}=r,x=C.useMemo(()=>{let _=Za(u,o);return _==null?null:{location:{pathname:_,search:d,hash:h,state:m,key:g},navigationType:n}},[o,u,d,h,m,g,n]);return Mn(x!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:C.createElement(ea.Provider,{value:l},C.createElement(uc.Provider,{children:t,value:x}))}function XT({children:e,location:t}){return OT(hh(e),t)}function hh(e,t=[]){let r=[];return C.Children.forEach(e,(n,a)=>{if(!C.isValidElement(n))return;let i=[...t,a];if(n.type===C.Fragment){r.push.apply(r,hh(n.props.children,i));return}Ut(n.type===er,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ut(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=hh(n.props.children,i)),r.push(o)}),r}var Au="get",Lu="application/x-www-form-urlencoded";function qf(e){return e!=null&&typeof e.tagName=="string"}function YT(e){return qf(e)&&e.tagName.toLowerCase()==="button"}function KT(e){return qf(e)&&e.tagName.toLowerCase()==="form"}function JT(e){return qf(e)&&e.tagName.toLowerCase()==="input"}function QT(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function e3(e,t){return e.button===0&&(!t||t==="_self")&&!QT(e)}var su=null;function t3(){if(su===null)try{new FormData(document.createElement("form"),0),su=!1}catch{su=!0}return su}var r3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function id(e){return e!=null&&!r3.has(e)?(Mn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lu}"`),null):e}function n3(e,t){let r,n,a,i,o;if(KT(e)){let l=e.getAttribute("action");n=l?Za(l,t):null,r=e.getAttribute("method")||Au,a=id(e.getAttribute("enctype"))||Lu,i=new FormData(e)}else if(YT(e)||JT(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||l.getAttribute("action");if(n=u?Za(u,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||Au,a=id(e.getAttribute("formenctype"))||id(l.getAttribute("enctype"))||Lu,i=new FormData(l,e),!t3()){let{name:d,type:h,value:m}=e;if(h==="image"){let g=d?`${d}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else d&&i.append(d,m)}}else{if(qf(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Au,n=null,a=Lu,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}function Up(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function a3(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function i3(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function s3(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let o=await a3(i,r);return o.links?o.links():[]}return[]}));return u3(n.flat(1).filter(i3).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Ox(e,t,r,n,a,i){let o=(u,d)=>r[d]?u.route.id!==r[d].route.id:!0,l=(u,d)=>{var h;return r[d].pathname!==u.pathname||((h=r[d].route.path)==null?void 0:h.endsWith("*"))&&r[d].params["*"]!==u.params["*"]};return i==="assets"?t.filter((u,d)=>o(u,d)||l(u,d)):i==="data"?t.filter((u,d)=>{var m;let h=n.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||l(u,d))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function o3(e,t,{includeHydrateFallback:r}={}){return l3(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function l3(e){return[...new Set(e)]}function c3(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function u3(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(c3(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}var f3=new Set([100,101,204,205]);function d3(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Za(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function Ry(){let e=C.useContext(No);return Up(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function h3(){let e=C.useContext(Zf);return Up(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Hp=C.createContext(void 0);Hp.displayName="FrameworkContext";function Dy(){let e=C.useContext(Hp);return Up(e,"You must render this element inside a <HydratedRouter> element"),e}function p3(e,t){let r=C.useContext(Hp),[n,a]=C.useState(!1),[i,o]=C.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:m}=t,g=C.useRef(null);C.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let y=k=>{k.forEach(S=>{o(S.isIntersecting)})},E=new IntersectionObserver(y,{threshold:.5});return g.current&&E.observe(g.current),()=>{E.disconnect()}}},[e]),C.useEffect(()=>{if(n){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[n]);let x=()=>{a(!0)},_=()=>{a(!1),o(!1)};return r?e!=="intent"?[i,g,{}]:[i,g,{onFocus:tl(l,x),onBlur:tl(u,_),onMouseEnter:tl(d,x),onMouseLeave:tl(h,_),onTouchStart:tl(m,x)}]:[!1,g,{}]}function tl(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function m3({page:e,...t}){let{router:r}=Ry(),n=C.useMemo(()=>by(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?C.createElement(x3,{page:e,matches:n,...t}):null}function g3(e){let{manifest:t,routeModules:r}=Dy(),[n,a]=C.useState([]);return C.useEffect(()=>{let i=!1;return s3(e,t,r).then(o=>{i||a(o)}),()=>{i=!0}},[e,t,r]),n}function x3({page:e,matches:t,...r}){let n=Ka(),{manifest:a,routeModules:i}=Dy(),{basename:o}=Ry(),{loaderData:l,matches:u}=h3(),d=C.useMemo(()=>Ox(e,t,u,a,n,"data"),[e,t,u,a,n]),h=C.useMemo(()=>Ox(e,t,u,a,n,"assets"),[e,t,u,a,n]),m=C.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let _=new Set,y=!1;if(t.forEach(k=>{var w;let S=a.routes[k.route.id];!S||!S.hasLoader||(!d.some(A=>A.route.id===k.route.id)&&k.route.id in l&&((w=i[k.route.id])!=null&&w.shouldRevalidate)||S.hasClientLoader?y=!0:_.add(k.route.id))}),_.size===0)return[];let E=d3(e,o);return y&&_.size>0&&E.searchParams.set("_routes",t.filter(k=>_.has(k.route.id)).map(k=>k.route.id).join(",")),[E.pathname+E.search]},[o,l,n,a,d,t,e,i]),g=C.useMemo(()=>o3(h,a),[h,a]),x=g3(h);return C.createElement(C.Fragment,null,m.map(_=>C.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...r})),g.map(_=>C.createElement("link",{key:_,rel:"modulepreload",href:_,...r})),x.map(({key:_,link:y})=>C.createElement("link",{key:_,...y})))}function v3(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Iy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Iy&&(window.__reactRouterVersion="7.5.1")}catch{}var By=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dc=C.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:l,target:u,to:d,preventScrollReset:h,viewTransition:m,...g},x){let{basename:_}=C.useContext(ea),y=typeof d=="string"&&By.test(d),E,k=!1;if(typeof d=="string"&&y&&(E=d,Iy))try{let B=new URL(window.location.href),W=d.startsWith("//")?new URL(B.protocol+d):new URL(d),I=Za(W.pathname,_);W.origin===B.origin&&I!=null?d=I+W.search+W.hash:k=!0}catch{Mn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let S=LT(d,{relative:a}),[w,A,D]=p3(n,g),R=k3(d,{replace:o,state:l,target:u,preventScrollReset:h,relative:a,viewTransition:m});function P(B){t&&t(B),B.defaultPrevented||R(B)}let H=C.createElement("a",{...g,...D,href:E||S,onClick:k||i?t:P,ref:v3(x,A),target:u,"data-discover":!y&&r==="render"?"true":void 0});return w&&!y?C.createElement(C.Fragment,null,H,C.createElement(m3,{page:S})):H});dc.displayName="Link";var _3=C.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:l,children:u,...d},h){let m=fc(o,{relative:d.relative}),g=Ka(),x=C.useContext(Zf),{navigator:_,basename:y}=C.useContext(ea),E=x!=null&&b3(m)&&l===!0,k=_.encodeLocation?_.encodeLocation(m).pathname:m.pathname,S=g.pathname,w=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;r||(S=S.toLowerCase(),w=w?w.toLowerCase():null,k=k.toLowerCase()),w&&y&&(w=Za(w,y)||w);const A=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let D=S===k||!a&&S.startsWith(k)&&S.charAt(A)==="/",R=w!=null&&(w===k||!a&&w.startsWith(k)&&w.charAt(k.length)==="/"),P={isActive:D,isPending:R,isTransitioning:E},H=D?t:void 0,B;typeof n=="function"?B=n(P):B=[n,D?"active":null,R?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let W=typeof i=="function"?i(P):i;return C.createElement(dc,{...d,"aria-current":H,className:B,ref:h,style:W,to:o,viewTransition:l},typeof u=="function"?u(P):u)});_3.displayName="NavLink";var y3=C.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Au,action:l,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:m,...g},x)=>{let _=T3(),y=C3(l,{relative:d}),E=o.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&By.test(l),S=w=>{if(u&&u(w),w.defaultPrevented)return;w.preventDefault();let A=w.nativeEvent.submitter,D=(A==null?void 0:A.getAttribute("formmethod"))||o;_(A||w.currentTarget,{fetcherKey:t,method:D,navigate:r,replace:a,state:i,relative:d,preventScrollReset:h,viewTransition:m})};return C.createElement("form",{ref:x,method:E,action:y,onSubmit:n?u:S,...g,"data-discover":!k&&e==="render"?"true":void 0})});y3.displayName="Form";function w3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zy(e){let t=C.useContext(No);return Ut(t,w3(e)),t}function k3(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o}={}){let l=ya(),u=Ka(),d=fc(e,{relative:i});return C.useCallback(h=>{if(e3(h,t)){h.preventDefault();let m=r!==void 0?r:sf(u)===sf(d);l(e,{replace:m,state:n,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,d,r,n,t,e,a,i,o])}var E3=0,S3=()=>`__${String(++E3)}__`;function T3(){let{router:e}=zy("useSubmit"),{basename:t}=C.useContext(ea),r=HT();return C.useCallback(async(n,a={})=>{let{action:i,method:o,encType:l,formData:u,body:d}=n3(n,t);if(a.navigate===!1){let h=a.fetcherKey||S3();await e.fetch(h,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function C3(e,{relative:t}={}){let{basename:r}=C.useContext(ea),n=C.useContext(ta);Ut(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...fc(e||".",{relative:t})},o=Ka();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(h=>h==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let h=l.toString();i.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:za([r,i.pathname])),sf(i)}function b3(e,t={}){let r=C.useContext(Py);Ut(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=zy("useViewTransitionState"),a=fc(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=Za(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Za(r.nextLocation.pathname,n)||r.nextLocation.pathname;return of(a.pathname,o)!=null||of(a.pathname,i)!=null}new TextEncoder;[...f3];function Uy(e,t){return function(){return e.apply(t,arguments)}}const{toString:N3}=Object.prototype,{getPrototypeOf:Vp}=Object,Xf=(e=>t=>{const r=N3.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ra=e=>(e=e.toLowerCase(),t=>Xf(t)===e),Yf=e=>t=>typeof t===e,{isArray:Lo}=Array,Xl=Yf("undefined");function A3(e){return e!==null&&!Xl(e)&&e.constructor!==null&&!Xl(e.constructor)&&pn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Hy=ra("ArrayBuffer");function L3(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Hy(e.buffer),t}const P3=Yf("string"),pn=Yf("function"),Vy=Yf("number"),Kf=e=>e!==null&&typeof e=="object",F3=e=>e===!0||e===!1,Pu=e=>{if(Xf(e)!=="object")return!1;const t=Vp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},O3=ra("Date"),M3=ra("File"),j3=ra("Blob"),R3=ra("FileList"),D3=e=>Kf(e)&&pn(e.pipe),I3=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||pn(e.append)&&((t=Xf(e))==="formdata"||t==="object"&&pn(e.toString)&&e.toString()==="[object FormData]"))},B3=ra("URLSearchParams"),[z3,U3,H3,V3]=["ReadableStream","Request","Response","Headers"].map(ra),W3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Lo(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,e[l],l,e)}}function Wy(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Qi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,$y=e=>!Xl(e)&&e!==Qi;function ph(){const{caseless:e}=$y(this)&&this||{},t={},r=(n,a)=>{const i=e&&Wy(t,a)||a;Pu(t[i])&&Pu(n)?t[i]=ph(t[i],n):Pu(n)?t[i]=ph({},n):Lo(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&hc(arguments[n],r);return t}const $3=(e,t,r,{allOwnKeys:n}={})=>(hc(t,(a,i)=>{r&&pn(a)?e[i]=Uy(a,r):e[i]=a},{allOwnKeys:n}),e),G3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Z3=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},q3=(e,t,r,n)=>{let a,i,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&Vp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},X3=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Y3=e=>{if(!e)return null;if(Lo(e))return e;let t=e.length;if(!Vy(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},K3=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Vp(Uint8Array)),J3=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},Q3=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},eC=ra("HTMLFormElement"),tC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Mx=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),rC=ra("RegExp"),Gy=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};hc(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},nC=e=>{Gy(e,(t,r)=>{if(pn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(pn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},aC=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return Lo(e)?n(e):n(String(e).split(t)),r},iC=()=>{},sC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function oC(e){return!!(e&&pn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const lC=e=>{const t=new Array(10),r=(n,a)=>{if(Kf(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=Lo(n)?[]:{};return hc(n,(o,l)=>{const u=r(o,a+1);!Xl(u)&&(i[l]=u)}),t[a]=void 0,i}}return n};return r(e,0)},cC=ra("AsyncFunction"),uC=e=>e&&(Kf(e)||pn(e))&&pn(e.then)&&pn(e.catch),Zy=((e,t)=>e?setImmediate:t?((r,n)=>(Qi.addEventListener("message",({source:a,data:i})=>{a===Qi&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Qi.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",pn(Qi.postMessage)),fC=typeof queueMicrotask<"u"?queueMicrotask.bind(Qi):typeof process<"u"&&process.nextTick||Zy,pe={isArray:Lo,isArrayBuffer:Hy,isBuffer:A3,isFormData:I3,isArrayBufferView:L3,isString:P3,isNumber:Vy,isBoolean:F3,isObject:Kf,isPlainObject:Pu,isReadableStream:z3,isRequest:U3,isResponse:H3,isHeaders:V3,isUndefined:Xl,isDate:O3,isFile:M3,isBlob:j3,isRegExp:rC,isFunction:pn,isStream:D3,isURLSearchParams:B3,isTypedArray:K3,isFileList:R3,forEach:hc,merge:ph,extend:$3,trim:W3,stripBOM:G3,inherits:Z3,toFlatObject:q3,kindOf:Xf,kindOfTest:ra,endsWith:X3,toArray:Y3,forEachEntry:J3,matchAll:Q3,isHTMLForm:eC,hasOwnProperty:Mx,hasOwnProp:Mx,reduceDescriptors:Gy,freezeMethods:nC,toObjectSet:aC,toCamelCase:tC,noop:iC,toFiniteNumber:sC,findKey:Wy,global:Qi,isContextDefined:$y,isSpecCompliantForm:oC,toJSONObject:lC,isAsyncFn:cC,isThenable:uC,setImmediate:Zy,asap:fC};function at(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}pe.inherits(at,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:pe.toJSONObject(this.config),code:this.code,status:this.status}}});const qy=at.prototype,Xy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Xy[e]={value:e}});Object.defineProperties(at,Xy);Object.defineProperty(qy,"isAxiosError",{value:!0});at.from=(e,t,r,n,a,i)=>{const o=Object.create(qy);return pe.toFlatObject(e,o,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),at.call(o,e.message,t,r,n,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const dC=null;function mh(e){return pe.isPlainObject(e)||pe.isArray(e)}function Yy(e){return pe.endsWith(e,"[]")?e.slice(0,-2):e}function jx(e,t,r){return e?e.concat(t).map(function(a,i){return a=Yy(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function hC(e){return pe.isArray(e)&&!e.some(mh)}const pC=pe.toFlatObject(pe,{},null,function(t){return/^is[A-Z]/.test(t)});function Jf(e,t,r){if(!pe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=pe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,E){return!pe.isUndefined(E[y])});const n=r.metaTokens,a=r.visitor||h,i=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&pe.isSpecCompliantForm(t);if(!pe.isFunction(a))throw new TypeError("visitor must be a function");function d(_){if(_===null)return"";if(pe.isDate(_))return _.toISOString();if(!u&&pe.isBlob(_))throw new at("Blob is not supported. Use a Buffer instead.");return pe.isArrayBuffer(_)||pe.isTypedArray(_)?u&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,y,E){let k=_;if(_&&!E&&typeof _=="object"){if(pe.endsWith(y,"{}"))y=n?y:y.slice(0,-2),_=JSON.stringify(_);else if(pe.isArray(_)&&hC(_)||(pe.isFileList(_)||pe.endsWith(y,"[]"))&&(k=pe.toArray(_)))return y=Yy(y),k.forEach(function(w,A){!(pe.isUndefined(w)||w===null)&&t.append(o===!0?jx([y],A,i):o===null?y:y+"[]",d(w))}),!1}return mh(_)?!0:(t.append(jx(E,y,i),d(_)),!1)}const m=[],g=Object.assign(pC,{defaultVisitor:h,convertValue:d,isVisitable:mh});function x(_,y){if(!pe.isUndefined(_)){if(m.indexOf(_)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(_),pe.forEach(_,function(k,S){(!(pe.isUndefined(k)||k===null)&&a.call(t,k,pe.isString(S)?S.trim():S,y,g))===!0&&x(k,y?y.concat(S):[S])}),m.pop()}}if(!pe.isObject(e))throw new TypeError("data must be an object");return x(e),t}function Rx(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Wp(e,t){this._pairs=[],e&&Jf(e,this,t)}const Ky=Wp.prototype;Ky.append=function(t,r){this._pairs.push([t,r])};Ky.toString=function(t){const r=t?function(n){return t.call(this,n,Rx)}:Rx;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function mC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Jy(e,t,r){if(!t)return e;const n=r&&r.encode||mC;pe.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=pe.isURLSearchParams(t)?t.toString():new Wp(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Dx{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){pe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Qy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gC=typeof URLSearchParams<"u"?URLSearchParams:Wp,xC=typeof FormData<"u"?FormData:null,vC=typeof Blob<"u"?Blob:null,_C={isBrowser:!0,classes:{URLSearchParams:gC,FormData:xC,Blob:vC},protocols:["http","https","file","blob","url","data"]},$p=typeof window<"u"&&typeof document<"u",gh=typeof navigator=="object"&&navigator||void 0,yC=$p&&(!gh||["ReactNative","NativeScript","NS"].indexOf(gh.product)<0),wC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",kC=$p&&window.location.href||"http://localhost",EC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$p,hasStandardBrowserEnv:yC,hasStandardBrowserWebWorkerEnv:wC,navigator:gh,origin:kC},Symbol.toStringTag,{value:"Module"})),Rr={...EC,..._C};function SC(e,t){return Jf(e,new Rr.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Rr.isNode&&pe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function TC(e){return pe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function CC(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function e2(e){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=i>=r.length;return o=!o&&pe.isArray(a)?a.length:o,u?(pe.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!pe.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&pe.isArray(a[o])&&(a[o]=CC(a[o])),!l)}if(pe.isFormData(e)&&pe.isFunction(e.entries)){const r={};return pe.forEachEntry(e,(n,a)=>{t(TC(n),a,r,0)}),r}return null}function bC(e,t,r){if(pe.isString(e))try{return(t||JSON.parse)(e),pe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const pc={transitional:Qy,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=pe.isObject(t);if(i&&pe.isHTMLForm(t)&&(t=new FormData(t)),pe.isFormData(t))return a?JSON.stringify(e2(t)):t;if(pe.isArrayBuffer(t)||pe.isBuffer(t)||pe.isStream(t)||pe.isFile(t)||pe.isBlob(t)||pe.isReadableStream(t))return t;if(pe.isArrayBufferView(t))return t.buffer;if(pe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return SC(t,this.formSerializer).toString();if((l=pe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Jf(l?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),bC(t)):t}],transformResponse:[function(t){const r=this.transitional||pc.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(pe.isResponse(t)||pe.isReadableStream(t))return t;if(t&&pe.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?at.from(l,at.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rr.classes.FormData,Blob:Rr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};pe.forEach(["delete","get","head","post","put","patch"],e=>{pc.headers[e]={}});const NC=pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),AC=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&NC[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Ix=Symbol("internals");function rl(e){return e&&String(e).trim().toLowerCase()}function Fu(e){return e===!1||e==null?e:pe.isArray(e)?e.map(Fu):String(e)}function LC(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const PC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function sd(e,t,r,n,a){if(pe.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!pe.isString(t)){if(pe.isString(n))return t.indexOf(n)!==-1;if(pe.isRegExp(n))return n.test(t)}}function FC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function OC(e,t){const r=pe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}class ln{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(l,u,d){const h=rl(u);if(!h)throw new Error("header name must be a non-empty string");const m=pe.findKey(a,h);(!m||a[m]===void 0||d===!0||d===void 0&&a[m]!==!1)&&(a[m||u]=Fu(l))}const o=(l,u)=>pe.forEach(l,(d,h)=>i(d,h,u));if(pe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(pe.isString(t)&&(t=t.trim())&&!PC(t))o(AC(t),r);else if(pe.isHeaders(t))for(const[l,u]of t.entries())i(u,l,n);else t!=null&&i(r,t,n);return this}get(t,r){if(t=rl(t),t){const n=pe.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return LC(a);if(pe.isFunction(r))return r.call(this,a,n);if(pe.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=rl(t),t){const n=pe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||sd(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=rl(o),o){const l=pe.findKey(n,o);l&&(!r||sd(n,n[l],l,r))&&(delete n[l],a=!0)}}return pe.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||sd(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return pe.forEach(this,(a,i)=>{const o=pe.findKey(n,i);if(o){r[o]=Fu(a),delete r[i];return}const l=t?FC(i):String(i).trim();l!==i&&delete r[i],r[l]=Fu(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return pe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&pe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[Ix]=this[Ix]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=rl(o);n[l]||(OC(a,o),n[l]=!0)}return pe.isArray(t)?t.forEach(i):i(t),this}}ln.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);pe.reduceDescriptors(ln.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});pe.freezeMethods(ln);function od(e,t){const r=this||pc,n=t||r,a=ln.from(n.headers);let i=n.data;return pe.forEach(e,function(l){i=l.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function t2(e){return!!(e&&e.__CANCEL__)}function Po(e,t,r){at.call(this,e??"canceled",at.ERR_CANCELED,t,r),this.name="CanceledError"}pe.inherits(Po,at,{__CANCEL__:!0});function r2(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new at("Request failed with status code "+r.status,[at.ERR_BAD_REQUEST,at.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function MC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function jC(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(u){const d=Date.now(),h=n[i];o||(o=d),r[a]=u,n[a]=d;let m=i,g=0;for(;m!==a;)g+=r[m++],m=m%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),d-o<t)return;const x=h&&d-h;return x?Math.round(g*1e3/x):void 0}}function RC(e,t){let r=0,n=1e3/t,a,i;const o=(d,h=Date.now())=>{r=h,a=null,i&&(clearTimeout(i),i=null),e.apply(null,d)};return[(...d)=>{const h=Date.now(),m=h-r;m>=n?o(d,h):(a=d,i||(i=setTimeout(()=>{i=null,o(a)},n-m)))},()=>a&&o(a)]}const lf=(e,t,r=3)=>{let n=0;const a=jC(50,250);return RC(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,u=o-n,d=a(u),h=o<=l;n=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:d||void 0,estimated:d&&l&&h?(l-o)/d:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},Bx=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},zx=e=>(...t)=>pe.asap(()=>e(...t)),DC=Rr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Rr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Rr.origin),Rr.navigator&&/(msie|trident)/i.test(Rr.navigator.userAgent)):()=>!0,IC=Rr.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];pe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),pe.isString(n)&&o.push("path="+n),pe.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function BC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function zC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function n2(e,t,r){let n=!BC(t);return e&&(n||r==!1)?zC(e,t):t}const Ux=e=>e instanceof ln?{...e}:e;function ps(e,t){t=t||{};const r={};function n(d,h,m,g){return pe.isPlainObject(d)&&pe.isPlainObject(h)?pe.merge.call({caseless:g},d,h):pe.isPlainObject(h)?pe.merge({},h):pe.isArray(h)?h.slice():h}function a(d,h,m,g){if(pe.isUndefined(h)){if(!pe.isUndefined(d))return n(void 0,d,m,g)}else return n(d,h,m,g)}function i(d,h){if(!pe.isUndefined(h))return n(void 0,h)}function o(d,h){if(pe.isUndefined(h)){if(!pe.isUndefined(d))return n(void 0,d)}else return n(void 0,h)}function l(d,h,m){if(m in t)return n(d,h);if(m in e)return n(void 0,d)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,h,m)=>a(Ux(d),Ux(h),m,!0)};return pe.forEach(Object.keys(Object.assign({},e,t)),function(h){const m=u[h]||a,g=m(e[h],t[h],h);pe.isUndefined(g)&&m!==l||(r[h]=g)}),r}const a2=e=>{const t=ps({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=t;t.headers=o=ln.from(o),t.url=Jy(n2(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let u;if(pe.isFormData(r)){if(Rr.hasStandardBrowserEnv||Rr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[d,...h]=u?u.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...h].join("; "))}}if(Rr.hasStandardBrowserEnv&&(n&&pe.isFunction(n)&&(n=n(t)),n||n!==!1&&DC(t.url))){const d=a&&i&&IC.read(i);d&&o.set(a,d)}return t},UC=typeof XMLHttpRequest<"u",HC=UC&&function(e){return new Promise(function(r,n){const a=a2(e);let i=a.data;const o=ln.from(a.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:d}=a,h,m,g,x,_;function y(){x&&x(),_&&_(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let E=new XMLHttpRequest;E.open(a.method.toUpperCase(),a.url,!0),E.timeout=a.timeout;function k(){if(!E)return;const w=ln.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),D={data:!l||l==="text"||l==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:w,config:e,request:E};r2(function(P){r(P),y()},function(P){n(P),y()},D),E=null}"onloadend"in E?E.onloadend=k:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(k)},E.onabort=function(){E&&(n(new at("Request aborted",at.ECONNABORTED,e,E)),E=null)},E.onerror=function(){n(new at("Network Error",at.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let A=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const D=a.transitional||Qy;a.timeoutErrorMessage&&(A=a.timeoutErrorMessage),n(new at(A,D.clarifyTimeoutError?at.ETIMEDOUT:at.ECONNABORTED,e,E)),E=null},i===void 0&&o.setContentType(null),"setRequestHeader"in E&&pe.forEach(o.toJSON(),function(A,D){E.setRequestHeader(D,A)}),pe.isUndefined(a.withCredentials)||(E.withCredentials=!!a.withCredentials),l&&l!=="json"&&(E.responseType=a.responseType),d&&([g,_]=lf(d,!0),E.addEventListener("progress",g)),u&&E.upload&&([m,x]=lf(u),E.upload.addEventListener("progress",m),E.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(h=w=>{E&&(n(!w||w.type?new Po(null,e,E):w),E.abort(),E=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const S=MC(a.url);if(S&&Rr.protocols.indexOf(S)===-1){n(new at("Unsupported protocol "+S+":",at.ERR_BAD_REQUEST,e));return}E.send(i||null)})},VC=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,l();const h=d instanceof Error?d:this.reason;n.abort(h instanceof at?h:new Po(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,i(new at(`timeout ${t} of ms exceeded`,at.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:u}=n;return u.unsubscribe=()=>pe.asap(l),u}},WC=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},$C=async function*(e,t){for await(const r of GC(e))yield*WC(r,t)},GC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Hx=(e,t,r,n)=>{const a=$C(e,t);let i=0,o,l=u=>{o||(o=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:d,value:h}=await a.next();if(d){l(),u.close();return}let m=h.byteLength;if(r){let g=i+=m;r(g)}u.enqueue(new Uint8Array(h))}catch(d){throw l(d),d}},cancel(u){return l(u),a.return()}},{highWaterMark:2})},Qf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",i2=Qf&&typeof ReadableStream=="function",ZC=Qf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),s2=(e,...t)=>{try{return!!e(...t)}catch{return!1}},qC=i2&&s2(()=>{let e=!1;const t=new Request(Rr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Vx=64*1024,xh=i2&&s2(()=>pe.isReadableStream(new Response("").body)),cf={stream:xh&&(e=>e.body)};Qf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!cf[t]&&(cf[t]=pe.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new at(`Response type '${t}' is not supported`,at.ERR_NOT_SUPPORT,n)})})})(new Response);const XC=async e=>{if(e==null)return 0;if(pe.isBlob(e))return e.size;if(pe.isSpecCompliantForm(e))return(await new Request(Rr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(pe.isArrayBufferView(e)||pe.isArrayBuffer(e))return e.byteLength;if(pe.isURLSearchParams(e)&&(e=e+""),pe.isString(e))return(await ZC(e)).byteLength},YC=async(e,t)=>{const r=pe.toFiniteNumber(e.getContentLength());return r??XC(t)},KC=Qf&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:u,responseType:d,headers:h,withCredentials:m="same-origin",fetchOptions:g}=a2(e);d=d?(d+"").toLowerCase():"text";let x=VC([a,i&&i.toAbortSignal()],o),_;const y=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let E;try{if(u&&qC&&r!=="get"&&r!=="head"&&(E=await YC(h,n))!==0){let D=new Request(t,{method:"POST",body:n,duplex:"half"}),R;if(pe.isFormData(n)&&(R=D.headers.get("content-type"))&&h.setContentType(R),D.body){const[P,H]=Bx(E,lf(zx(u)));n=Hx(D.body,Vx,P,H)}}pe.isString(m)||(m=m?"include":"omit");const k="credentials"in Request.prototype;_=new Request(t,{...g,signal:x,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:k?m:void 0});let S=await fetch(_);const w=xh&&(d==="stream"||d==="response");if(xh&&(l||w&&y)){const D={};["status","statusText","headers"].forEach(B=>{D[B]=S[B]});const R=pe.toFiniteNumber(S.headers.get("content-length")),[P,H]=l&&Bx(R,lf(zx(l),!0))||[];S=new Response(Hx(S.body,Vx,P,()=>{H&&H(),y&&y()}),D)}d=d||"text";let A=await cf[pe.findKey(cf,d)||"text"](S,e);return!w&&y&&y(),await new Promise((D,R)=>{r2(D,R,{data:A,headers:ln.from(S.headers),status:S.status,statusText:S.statusText,config:e,request:_})})}catch(k){throw y&&y(),k&&k.name==="TypeError"&&/fetch/i.test(k.message)?Object.assign(new at("Network Error",at.ERR_NETWORK,e,_),{cause:k.cause||k}):at.from(k,k&&k.code,e,_)}}),vh={http:dC,xhr:HC,fetch:KC};pe.forEach(vh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Wx=e=>`- ${e}`,JC=e=>pe.isFunction(e)||e===null||e===!1,o2={getAdapter:e=>{e=pe.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!JC(r)&&(n=vh[(o=String(r)).toLowerCase()],n===void 0))throw new at(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(Wx).join(`
`):" "+Wx(i[0]):"as no adapter specified";throw new at("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:vh};function ld(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Po(null,e)}function $x(e){return ld(e),e.headers=ln.from(e.headers),e.data=od.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),o2.getAdapter(e.adapter||pc.adapter)(e).then(function(n){return ld(e),n.data=od.call(e,e.transformResponse,n),n.headers=ln.from(n.headers),n},function(n){return t2(n)||(ld(e),n&&n.response&&(n.response.data=od.call(e,e.transformResponse,n.response),n.response.headers=ln.from(n.response.headers))),Promise.reject(n)})}const l2="1.8.4",e0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{e0[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Gx={};e0.transitional=function(t,r,n){function a(i,o){return"[Axios v"+l2+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new at(a(o," has been removed"+(r?" in "+r:"")),at.ERR_DEPRECATED);return r&&!Gx[o]&&(Gx[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};e0.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function QC(e,t,r){if(typeof e!="object")throw new at("options must be an object",at.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const l=e[i],u=l===void 0||o(l,i,e);if(u!==!0)throw new at("option "+i+" must be "+u,at.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new at("Unknown option "+i,at.ERR_BAD_OPTION)}}const Ou={assertOptions:QC,validators:e0},ca=Ou.validators;class is{constructor(t){this.defaults=t,this.interceptors={request:new Dx,response:new Dx}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ps(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Ou.assertOptions(n,{silentJSONParsing:ca.transitional(ca.boolean),forcedJSONParsing:ca.transitional(ca.boolean),clarifyTimeoutError:ca.transitional(ca.boolean)},!1),a!=null&&(pe.isFunction(a)?r.paramsSerializer={serialize:a}:Ou.assertOptions(a,{encode:ca.function,serialize:ca.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ou.assertOptions(r,{baseUrl:ca.spelling("baseURL"),withXsrfToken:ca.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&pe.merge(i.common,i[r.method]);i&&pe.forEach(["delete","get","head","post","put","patch","common"],_=>{delete i[_]}),r.headers=ln.concat(o,i);const l=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(u=u&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const d=[];this.interceptors.response.forEach(function(y){d.push(y.fulfilled,y.rejected)});let h,m=0,g;if(!u){const _=[$x.bind(this),void 0];for(_.unshift.apply(_,l),_.push.apply(_,d),g=_.length,h=Promise.resolve(r);m<g;)h=h.then(_[m++],_[m++]);return h}g=l.length;let x=r;for(m=0;m<g;){const _=l[m++],y=l[m++];try{x=_(x)}catch(E){y.call(this,E);break}}try{h=$x.call(this,x)}catch(_){return Promise.reject(_)}for(m=0,g=d.length;m<g;)h=h.then(d[m++],d[m++]);return h}getUri(t){t=ps(this.defaults,t);const r=n2(t.baseURL,t.url,t.allowAbsoluteUrls);return Jy(r,t.params,t.paramsSerializer)}}pe.forEach(["delete","get","head","options"],function(t){is.prototype[t]=function(r,n){return this.request(ps(n||{},{method:t,url:r,data:(n||{}).data}))}});pe.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(ps(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}is.prototype[t]=r(),is.prototype[t+"Form"]=r(!0)});class Gp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new Po(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Gp(function(a){t=a}),cancel:t}}}function eb(e){return function(r){return e.apply(null,r)}}function tb(e){return pe.isObject(e)&&e.isAxiosError===!0}const _h={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_h).forEach(([e,t])=>{_h[t]=e});function c2(e){const t=new is(e),r=Uy(is.prototype.request,t);return pe.extend(r,is.prototype,t,{allOwnKeys:!0}),pe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return c2(ps(e,a))},r}const Ve=c2(pc);Ve.Axios=is;Ve.CanceledError=Po;Ve.CancelToken=Gp;Ve.isCancel=t2;Ve.VERSION=l2;Ve.toFormData=Jf;Ve.AxiosError=at;Ve.Cancel=Ve.CanceledError;Ve.all=function(t){return Promise.all(t)};Ve.spread=eb;Ve.isAxiosError=tb;Ve.mergeConfig=ps;Ve.AxiosHeaders=ln;Ve.formToJSON=e=>e2(pe.isHTMLForm(e)?new FormData(e):e);Ve.getAdapter=o2.getAdapter;Ve.HttpStatusCode=_h;Ve.default=Ve;const Dt="http://localhost:8000/api",Zx={CAMERAS:{LIST:"/cameras/cameras/",UPLOAD:"/cameras/cameras/upload_csv/",DETAIL:e=>`/cameras/cameras/${e}/`,PING_ALL:"/cameras/cameras/ping_all/"},COMMANDS:{SAVE_CONFIG:"/command/commands/save_config/",EXECUTE:"/command/execute/"},AUTH:{LOGIN:"/auth/token/",REFRESH:"/auth/token/refresh/"},DATACENTERS:"/datacenters/",FIREWALL_TYPES:"/firewalls/firewall-type/",FIREWALLS:"/firewalls/firewall/"},u2=e=>{var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null};let yh=null;const rb=e=>{yh=e},uf=e=>{yh?yh(e):window.location.href=e},Ot=Ve.create({baseURL:Dt,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});Ot.interceptors.request.use(e=>{var t;if(["post","put","patch","delete"].includes(((t=e.method)==null?void 0:t.toLowerCase())||"")){const r=u2("csrftoken");r&&(e.headers["X-CSRFToken"]=r)}return e});Ot.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refreshToken");if(n){const a=await Ve.post(`${Dt}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"X-CSRFToken":u2("csrftoken")}}),{access:i}=a.data;return localStorage.setItem("token",i),Ot.defaults.headers.common.Authorization=`Bearer ${i}`,t.headers.Authorization=`Bearer ${i}`,Ot(t)}}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),uf("/login")}}return Promise.reject(e)});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ft=(e,t)=>{const r=C.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,...d},h)=>C.createElement("svg",{ref:h,...nb,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${ab(e)}`,l].join(" "),...d},[...t.map(([m,g])=>C.createElement(m,g)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=ft("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=ft("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=ft("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=ft("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=ft("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=ft("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=ft("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=ft("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=ft("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=ft("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=ft("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=ft("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=ft("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=ft("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=ft("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=ft("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=ft("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=ft("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=ft("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=ft("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=ft("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=ft("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=ft("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=ft("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=ft("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=ft("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=ft("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=ft("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=ft("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=ft("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=ft("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=ft("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=ft("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=ft("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=ft("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),qp="http://localhost:8000";Ve.defaults.withCredentials=!0;const mf=Ve.create({baseURL:qp,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}}),xb=e=>{var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null},Xp=()=>xb("csrftoken"),gf=async()=>{try{const t=(await Ve.get(`${qp}/api/auth/csrf/`,{withCredentials:!0,headers:{Accept:"application/json"}})).data.token;return t&&(document.cookie=`csrftoken=${t}; path=/`),t}catch(e){throw console.error("Error fetching CSRF token:",e),e}};mf.interceptors.request.use(async e=>{var n;if(((n=e.method)==null?void 0:n.toLowerCase())==="get")return e;let t=Xp();if(!t)try{if(t=await gf(),!t)throw new Error("Failed to get CSRF token")}catch(a){throw console.error("Failed to fetch CSRF token:",a),a}t&&(e.headers["X-CSRFToken"]=t,e.headers["X-Requested-With"]="XMLHttpRequest");const r=localStorage.getItem("access_token");return r&&(e.headers.Authorization=`Bearer ${r}`),e.withCredentials=!0,e},e=>Promise.reject(e));mf.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refresh_token");if(n){const a=await Ve.post(`${qp}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"Content-Type":"application/json","X-CSRFToken":Xp()}});if(a.data.access)return localStorage.setItem("access_token",a.data.access),t.headers.Authorization=`Bearer ${a.data.access}`,mf(t)}}catch(n){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(n)}}return Promise.reject(e)});const Yp="data:image/svg+xml,%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20viewBox='0%200%20512%20156'%20style='enable-background:new%200%200%20512%20156'%20xml:space='preserve'%3e%3cpath%20d='M44.6,44.5V109c0,4.3,0.8,8.4,2.3,12c1.7,3.7,3.8,7.1,6.5,10.3H41.9c-5.9,0-11.5-1.5-16.8-4.5%20c-11-5.2-16.6-14.5-16.6-28.1V44.5c0-6.4,1.6-11.2,4.8-14.5c3.2-3.5,7.7-5.3,13.5-5.3c5.3,0,9.7,1.8,13,5.3%20C43,33.3,44.6,38.2,44.6,44.5z%20M173.8,35c10.5,8.2,15.7,20.4,15.5,36.6v39.9c0,6.2-1.5,11-4.5,14.3c-3.3,3.7-7.9,5.5-13.5,5.5%20c-5.5,0-9.9-1.8-13.3-5.5c-3-3.3-4.5-8.1-4.5-14.3V71.6c0-5.8-1.4-10.5-4.3-14c-3.2-3.7-7.9-5.5-14-5.5c-6.2,0-10.9,1.8-14,5.5%20c-2.8,3.5-4.3,8.2-4.3,14v39.9c0,6.2-1.5,11-4.5,14.3c-3.3,3.7-7.8,5.5-13.3,5.5c-5.7,0-10.2-1.8-13.5-5.5c-3-3.3-4.5-8.1-4.5-14.3%20V71.6C81,55.2,86.1,43,96.5,35c9-6.9,21.9-10.3,38.6-10.3C151.8,24.7,164.7,28.1,173.8,35z%20M395.7,30c3.2,3.5,4.8,8.4,4.8,14.5%20v39.9c0,16.2-5.2,28.3-15.5,36.4c-9.2,7-22.1,10.5-38.6,10.5c-15.2,0-27.4-3-36.6-9c-8.9,6-20.8,9-35.9,9%20c-16.7,0-29.7-3.5-38.9-10.5c-10.2-8-15.3-20.1-15.3-36.4V44.5c0-6.4,1.5-11.2,4.5-14.5c3.2-3.5,7.7-5.3,13.5-5.3%20c5.5,0,9.9,1.8,13.3,5.3c3,3.3,4.5,8.2,4.5,14.5v39.4c0,6.2,1.4,11,4.3,14.3c3.2,3.7,7.9,5.5,14,5.5c6.2,0,10.8-1.8,13.8-5.5%20c2.8-3.3,4.3-8.1,4.3-14.3V44.5c0-6.4,1.6-11.2,4.8-14.5c3.2-3.5,7.7-5.3,13.5-5.3c5.5,0,9.9,1.8,13.3,5.3c3,3.3,4.5,8.2,4.5,14.5%20v39.4c0,6.2,1.4,11,4.3,14.3c3.2,3.7,7.9,5.5,14,5.5c6.2,0,10.8-1.8,13.8-5.5c2.8-3.3,4.3-8.1,4.3-14.3V44.5%20c0-6.4,1.6-11.2,4.8-14.5c3.3-3.5,7.7-5.3,13-5.3C388,24.7,392.5,26.5,395.7,30z%20M436.8,46.8c0-4.3-0.8-8.4-2.3-12%20c-1.7-3.5-3.8-6.9-6.5-10h11.5l5,0.8c4.3,0.3,8.2,1.5,11.5,3.5c11.2,5.2,16.8,14.6,16.8,28.3v54.2c0,6.2-1.7,11-5,14.3%20c-3,3.7-7.4,5.5-13.3,5.5c-5.4,0-9.7-1.8-13-5.5c-3.2-3.3-4.8-8.1-4.8-14.3V46.8z%20M484.9,27.5c0.7,0,1-0.4,1-1.3v-0.5%20c0-0.7-0.3-1-1-1h-11c-0.7,0-1,0.3-1,1v0.5c0,0.8,0.3,1.3,1,1.3h4v11.8c0,0.8,0.3,1.3,1,1.3h0.5c1.2,0,1.7-0.4,1.5-1.3V27.5H484.9z%20M503.5,26.2L503,25l-0.8-0.3H501l-1,0.3c0,0.2,0,0.3-0.1,0.5c-0.1,0.2-0.2,0.3-0.4,0.3L496,34l-3-8.3l-0.3-0.8l-1.3-0.3h-1.3%20c-1.2,0-1.7,0.5-1.5,1.5v13c0,0.8,0.4,1.3,1.3,1.3h0.3c0.8,0,1.3-0.4,1.3-1.3V28.5l3.5,8.3l0.3,0.3l0.8,0.5l1.3-0.5l0.5-0.3%20l3.3-8.3v10.8c0,0.5,0.1,0.8,0.3,1c0.2,0.2,0.4,0.3,0.8,0.3h0.3c0.8,0,1.3-0.4,1.3-1.3V26.2z'%20style='fill:%23AD2184'/%3e%3c/svg%3e";function vb({onLogin:e}){const t=ya(),[r,n]=C.useState(""),[a,i]=C.useState(""),[o,l]=C.useState(""),[u,d]=C.useState(!1);C.useEffect(()=>{(async()=>{try{await gf()}catch(g){console.error("Error initializing CSRF:",g)}})()},[]);const h=async m=>{var g,x;m.preventDefault(),d(!0),l("");try{const _={username:r,password:a},y=await Ot.post("/auth/login/",_);localStorage.setItem("token",y.data.access),localStorage.setItem("refreshToken",y.data.refresh),localStorage.setItem("role",y.data.role),Ot.defaults.headers.common.Authorization=`Bearer ${y.data.access}`,e(),y.data.role==="admin"?t("/admin-dashboard"):t("/")}catch(_){console.error("Login error details:",_),(x=(g=_.response)==null?void 0:g.data)!=null&&x.detail?l(_.response.data.detail):l("Nom d'utilisateur ou mot de passe incorrect")}finally{d(!1)}};return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:f.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[f.jsx("div",{className:"flex items-center justify-center mb-8",children:f.jsx("div",{className:"bg-purple-100 p-3 rounded-full flex items-center justify-center",children:f.jsx("img",{src:Yp,alt:"INWI Logo",className:"h-8 w-auto mr-2"})})}),o&&f.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:o}),f.jsxs("form",{onSubmit:h,className:"space-y-6",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(ko,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"text",value:r,onChange:m=>n(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(gi,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"password",value:a,onChange:m=>i(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),f.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50",children:u?f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Se connecter"}),f.jsx("div",{className:"text-center mt-4",children:f.jsxs("p",{className:"text-sm text-gray-600",children:["Pas encore de compte ?"," ",f.jsx(dc,{to:"/register",className:"font-medium text-purple-600 hover:text-purple-500",children:"S'inscrire"})]})})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}function _b({onRegister:e}){const t=ya(),[r,n]=C.useState({username:"",email:"",phone_number:"",password:"",confirmPassword:"",first_name:"",last_name:""}),[a,i]=C.useState(""),[o,l]=C.useState(!1);C.useEffect(()=>{(async()=>{try{await gf()}catch(m){console.error("Failed to fetch CSRF token:",m),i("Erreur de configuration CSRF. Veuillez rafrachir la page.")}})()},[]);const u=h=>{const{name:m,value:g}=h.target;n(x=>({...x,[m]:g}))},d=async h=>{var m,g,x,_,y;if(h.preventDefault(),i(""),l(!0),r.password!==r.confirmPassword){i("Les mots de passe ne correspondent pas"),l(!1);return}try{Xp()||await gf();const k=await mf.post("/api/auth/register/",{username:r.username,email:r.email,phone_number:r.phone_number,password:r.password,first_name:r.first_name,last_name:r.last_name});k.data.access&&(localStorage.setItem("access_token",k.data.access),k.data.refresh&&localStorage.setItem("refresh_token",k.data.refresh),e?e():t("/"))}catch(E){console.error("Registration error:",E),(g=(m=E.response)==null?void 0:m.data)!=null&&g.error?i(E.response.data.error):(_=(x=E.response)==null?void 0:x.data)!=null&&_.username?i("Ce nom d'utilisateur est dj pris"):((y=E.response)==null?void 0:y.status)===403?i("Erreur CORS: Vrifiez la configuration du serveur"):i("Une erreur est survenue lors de l'inscription. Veuillez ressayer.")}finally{l(!1)}};return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:f.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[f.jsx("div",{className:"flex items-center justify-center mb-8",children:f.jsx("div",{className:"bg-purple-100 p-3 rounded-full flex items-center justify-center",children:f.jsx("img",{src:Yp,alt:"INWI Logo",className:"h-8 w-auto mr-2"})})}),a&&f.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:a}),f.jsxs("form",{onSubmit:d,className:"space-y-6",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(ko,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"text",name:"username",value:r.username,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(qx,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Prnom",required:!0})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(qx,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom",required:!0})]})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(f2,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"email",name:"email",value:r.email,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Email",required:!0})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(h2,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"tel",name:"phone_number",value:r.phone_number,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Numro de tlphone",required:!0})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(gi,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"password",name:"password",value:r.password,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(gi,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Confirmer le mot de passe",required:!0})]}),f.jsx("div",{children:f.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:o?"Inscription en cours...":"S'inscrire"})}),f.jsx("div",{className:"text-center",children:f.jsxs("p",{className:"text-sm text-gray-600",children:["Dj un compte ?"," ",f.jsx(dc,{to:"/login",className:"font-medium text-purple-600 hover:text-purple-500",children:"Se connecter"})]})})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}const yb=({onLogout:e,sidebarOpen:t,setSidebarOpen:r})=>{const n=Ka(),[a,i]=C.useState({main:!0,firewall:!0,tools:!0}),o=localStorage.getItem("role"),l=g=>{i(x=>({...x,[g]:!x[g]}))},u=g=>n.pathname===g,d=[{title:"Main",items:[{path:"/firewalls",icon:ms,label:"Pare-feux"},{path:"/daily-check",icon:hf,label:"Daily Check"},{path:"/config",icon:ub,label:"Backup config"}]},{title:"Maps",items:[{path:"/map",icon:db,label:" Mapping CCTV"},{path:"/network-map",icon:d2,label:"Mapping FWs"}]},{title:"Settings",items:[{path:"/settings",icon:kh,label:"Paramtres"},{path:"/templates",icon:pf,label:"Configuration templates"},{path:"/matrix",icon:ib,label:"Dynamic configuration"}]},{title:"Tools",items:[{path:"/profile",icon:ko,label:"Profile"},{path:"/history",icon:hf,label:"Historique"}]}],m=[...o==="admin"?[{title:"Admin",items:[{path:"/admin-users",icon:ko,label:"Gestion utilisateurs"},{path:"/admin-emails",icon:pf,label:"Gestion des emails"}]}]:[],...d];return f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"fixed top-4 left-4 z-[4000] bg-[#120247] text-white p-2 rounded-full shadow-lg transition-transform duration-300 translate-x-0",onClick:()=>r(g=>!g),"aria-label":t?"Close sidebar":"Open sidebar",children:t?f.jsx(ob,{className:"h-6 w-6"}):f.jsx(df,{className:"h-6 w-6"})}),f.jsxs("div",{className:`fixed top-0 left-0 h-screen z-40 transition-transform duration-300 ${t?"translate-x-0":"-translate-x-full"} w-64 bg-[#120247] text-white p-6 flex flex-col`,style:{boxShadow:t?"2px 0 8px rgba(0,0,0,0.1)":"none"},children:[f.jsx("div",{className:"flex items-center justify-center mb-8",children:f.jsx("img",{src:Yp,alt:"INWI Logo",className:"h-12 w-auto"})}),f.jsx("nav",{className:"space-y-6 flex-grow overflow-y-auto custom-sidebar-scrollbar",children:m.map(g=>f.jsxs("div",{className:"space-y-2",children:[f.jsxs("button",{onClick:()=>l(g.title.toLowerCase()),className:"flex items-center justify-between w-full p-2 rounded-lg hover:bg-[#7a487a]",children:[f.jsx("span",{className:"font-semibold",children:g.title}),a[g.title.toLowerCase()]?f.jsx(ff,{className:"h-4 w-4"}):f.jsx(df,{className:"h-4 w-4"})]}),a[g.title.toLowerCase()]&&f.jsx("div",{className:"space-y-1 pl-2",children:g.items.map(x=>{const _=x.icon;return f.jsxs(dc,{to:x.path,className:`flex items-center space-x-2 w-full p-2 rounded-lg transition-colors duration-200 ${u(x.path)?"bg-[#6b3d6b] text-white":"hover:bg-[#7a487a] text-purple-100"}`,children:[f.jsx(_,{className:"h-5 w-5"}),f.jsx("span",{children:x.label})]},x.path)})})]},g.title))}),f.jsxs("button",{onClick:e,className:"flex items-center space-x-2 w-full p-2 rounded-lg hover:bg-[#7a487a] mt-auto",children:[f.jsx(fb,{className:"h-5 w-5"}),f.jsx("span",{children:"Logout"})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var g2=1252,wb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Kp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Jp=function(e){wb.indexOf(e)!=-1&&(g2=Kp[0]=e)};function kb(){Jp(1252)}var qn=function(e){Jp(e)};function x2(){qn(1200),kb()}function Xx(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Eb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function v2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ll=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Eb(e.slice(2)):t==254&&r==255?v2(e.slice(2)):t==65279?e.slice(1):e},ou=function(t){return String.fromCharCode(t)},Yx=function(t){return String.fromCharCode(t)},ui,xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Kx(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,u=a&63,isNaN(n)?l=u=64:isNaN(a)&&(u=64),t+=xi.charAt(i)+xi.charAt(o)+xi.charAt(l)+xi.charAt(u);return t}function gn(e){var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=xi.indexOf(e.charAt(d++)),o=xi.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=xi.indexOf(e.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=xi.indexOf(e.charAt(d++)),a=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var ut=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ks=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Pi(e){return ut?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Jx(e){return ut?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Zn=function(t){return ut?ks(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Es(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Qp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Qp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var fi=ut?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ks(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Sb(e){for(var t=[],r=0,n=e.length+250,a=Pi(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Pi(65535),n=65530)}return t.push(a.slice(0,r)),fi(t)}var Yr=/\u0000/g,cl=/[\u0001-\u0006]/g;function uo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xn(e,t){var r=""+e;return r.length>=t?r:$t("0",t-r.length)+r}function em(e,t){var r=""+e;return r.length>=t?r:$t(" ",t-r.length)+r}function xf(e,t){var r=""+e;return r.length>=t?r:r+$t(" ",t-r.length)}function Tb(e,t){var r=""+Math.round(e);return r.length>=t?r:$t("0",t-r.length)+r}function Cb(e,t){var r=""+e;return r.length>=t?r:$t("0",t-r.length)+r}var Qx=Math.pow(2,32);function Is(e,t){if(e>Qx||e<-Qx)return Tb(e,t);var r=Math.round(e);return Cb(r,t)}function vf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var e1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},t1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Nb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _f(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,u=1,d=0,h=0,m=Math.floor(a);d<t&&(m=Math.floor(a),l=m*o+i,h=m*d+u,!(a-m<5e-8));)a=1/(a-m),i=o,o=l,u=d,d=h;if(h>t&&(d>t?(h=u,l=i):(h=d,l=o)),!r)return[0,n*l,h];var g=Math.floor(n*l/h);return[g,n*l-g*h,h]}function ts(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=Mb(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var _2=new Date(1899,11,31,0,0,0),Ab=_2.getTime(),Lb=new Date(1900,2,1,0,0,0);function y2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Lb&&(r+=24*60*60*1e3),(r-(Ab+(e.getTimezoneOffset()-_2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function tm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Pb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Fb(e){var t=e<0?12:11,r=tm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ob(e){var t=tm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Yl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Fb(e):t===10?r=e.toFixed(10).substr(0,12):r=Ob(e),tm(Pb(r.toUpperCase()))}function gs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return jn(14,y2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Mb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function jb(e,t,r,n){var a="",i=0,o=0,l=r.y,u,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,d=2;break;default:u=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,d=t.length;break;case 3:return cd[r.m-1][1];case 5:return cd[r.m-1][0];default:return cd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,d=t.length;break;case 3:return e1[r.q][0];default:return e1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=Xn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:u=l,d=1;break}var h=d>0?Xn(u,d):"";return h}function vi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var w2=/%/g;function Rb(e,t,r){var n=t.replace(w2,""),a=t.length-n.length;return Ua(e,n,r*Math.pow(10,2*a))+$t("%",a)}function Db(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ua(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function k2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+k2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,d,h){return u+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var E2=/# (\?+)( ?)\/( ?)(\d+)/;function Ib(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?$t(" ",e[1].length+1+e[4].length):em(o,e[1].length)+e[2]+"/"+e[3]+Xn(l,e[4].length))}function Bb(e,t,r){return r+(t===0?"":""+t)+$t(" ",e[1].length+2+e[4].length)}var S2=/^#*0*\.([0#]+)/,T2=/\).*[0#]/,C2=/\(###\) ###\\?-####/;function Gr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function r1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function n1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function zb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Ub(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Tn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(T2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tn("n",n,r):"("+Tn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Db(e,t,r);if(t.indexOf("%")!==-1)return Rb(e,t,r);if(t.indexOf("E")!==-1)return k2(t,r);if(t.charCodeAt(0)===36)return"$"+Tn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Is(u,t.length);if(t.match(/^[#?]+$/))return a=Is(r,0),a==="0"&&(a=""),a.length>t.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(E2))return Ib(i,u,d);if(t.match(/^#+0+$/))return d+Is(u,t.length-t.indexOf("0"));if(i=t.match(S2))return a=r1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Gr(i[1])).replace(/\.$/,"."+Gr(i[1])).replace(/\.(\d*)$/,function(_,y){return"."+y+$t("0",Gr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+r1(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+vi(Is(u,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tn(e,t,-r):vi(""+(Math.floor(r)+zb(r,i[1].length)))+"."+Xn(n1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Tn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=uo(Tn(e,t.replace(/[\\-]/g,""),r)),o=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<a.length?a.charAt(o++):_==="0"?"0":""}));if(t.match(C2))return a=Tn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=_f(u,Math.pow(10,o)-1,!1),a=""+d,h=Ua("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=xf(l[2],o),h.length<i[4].length&&(h=Gr(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=_f(u,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?em(l[1],o)+i[2]+"/"+i[3]+xf(l[2],o):$t(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Is(r,0),t.length<=a.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return Gr(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=n1(r,i[1].length),r<0?"-"+Tn(e,t,-r):vi(Ub(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Xn(0,3-_.length):"")+_})+"."+Xn(o,i[1].length);switch(t){case"###,##0.00":return Tn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=vi(Is(u,0));return x!=="0"?d+x:"";case"###,###.00":return Tn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Hb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ua(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Vb(e,t,r){var n=t.replace(w2,""),a=t.length-n.length;return Ua(e,n,r*Math.pow(10,2*a))+$t("%",a)}function b2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+b2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,d,h){return u+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(T2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fa("n",n,r):"("+fa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Hb(e,t,r);if(t.indexOf("%")!==-1)return Vb(e,t,r);if(t.indexOf("E")!==-1)return b2(t,r);if(t.charCodeAt(0)===36)return"$"+fa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Xn(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(E2))return Bb(i,u,d);if(t.match(/^#+0+$/))return d+Xn(u,t.length-t.indexOf("0"));if(i=t.match(S2))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Gr(i[1])).replace(/\.$/,"."+Gr(i[1])),a=a.replace(/\.(\d*)$/,function(_,y){return"."+y+$t("0",Gr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+vi(""+u);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fa(e,t,-r):vi(""+r)+"."+$t("0",i[1].length);if(i=t.match(/^#,#*,#0/))return fa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=uo(fa(e,t.replace(/[\\-]/g,""),r)),o=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<a.length?a.charAt(o++):_==="0"?"0":""}));if(t.match(C2))return a=fa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=_f(u,Math.pow(10,o)-1,!1),a=""+d,h=Ua("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=xf(l[2],o),h.length<i[4].length&&(h=Gr(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=_f(u,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?em(l[1],o)+i[2]+"/"+i[3]+xf(l[2],o):$t(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return Gr(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fa(e,t,-r):vi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Xn(0,3-_.length):"")+_})+"."+Xn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=vi(""+u);return x!=="0"?d+x:"";default:if(t.match(/\.[0#?]*$/))return fa(e,t.slice(0,t.lastIndexOf(".")),r)+Gr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ua(e,t,r){return(r|0)===r?fa(e,t,r):Tn(e,t,r)}function Wb(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var N2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":vf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(N2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function $b(e,t,r,n){for(var a=[],i="",o=0,l="",u="t",d,h,m,g="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!vf(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++o;break;case"\\":var x=e.charAt(++o),_=x==="("||x===")"?x:"t";a[a.length]={t:_,v:x},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ts(t,r,e.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ts(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),a[a.length]={t:l,v:i},u=l;break;case"A":case"a":case"":var y={t:l,v:l};if(d==null&&(d=ts(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",o+=5,g="h"):(y.t="t",++o),d==null&&y.t==="T")return"";a[a.length]=y,u=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(N2)){if(d==null&&(d=ts(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fo(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var E=0,k=0,S;for(o=a.length-1,u="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=g,u="h",E<1&&(E=1);break;case"s":(S=a[o].v.match(/\.0+$/))&&(k=Math.max(k,S[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":u=a[o].t;break;case"m":u==="s"&&(a[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[o].v.match(/[Hh]/)&&(E=1),E<2&&a[o].v.match(/[Mm]/)&&(E=2),E<3&&a[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var w="",A;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=jb(a[o].t.charCodeAt(0),a[o].v,d,k),a[o].t="t";break;case"n":case"?":for(A=o+1;a[A]!=null&&((l=a[A].t)==="?"||l==="D"||(l===" "||l==="t")&&a[A+1]!=null&&(a[A+1].t==="?"||a[A+1].t==="t"&&a[A+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[A].v==="/"||a[A].v===" "&&a[A+1]!=null&&a[A+1].t=="?"));)a[o].v+=a[A].v,a[A]={v:"",t:";"},++A;w+=a[o].v,o=A-1;break;case"G":a[o].t="t",a[o].v=gs(t,r);break}var D="",R,P;if(w.length>0){w.charCodeAt(0)==40?(R=t<0&&w.charCodeAt(0)===45?-t:t,P=Ua("n",w,R)):(R=t<0&&n>1?-t:t,P=Ua("n",w,R),R<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),A=P.length-1;var H=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){H=o;break}var B=a.length;if(H===a.length&&P.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(A>=a[o].v.length-1?(A-=a[o].v.length,a[o].v=P.substr(A+1,a[o].v.length)):A<0?a[o].v="":(a[o].v=P.substr(0,A+1),A=-1),a[o].t="t",B=o);A>=0&&B<a.length&&(a[B].v=P.substr(0,A+1)+a[B].v)}else if(H!==a.length&&P.indexOf("E")===-1){for(A=P.indexOf(".")-1,o=H;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(h=a[o].v.indexOf(".")>-1&&o===H?a[o].v.indexOf(".")-1:a[o].v.length-1,D=a[o].v.substr(h+1);h>=0;--h)A>=0&&(a[o].v.charAt(h)==="0"||a[o].v.charAt(h)==="#")&&(D=P.charAt(A--)+D);a[o].v=D,a[o].t="t",B=o}for(A>=0&&B<a.length&&(a[B].v=P.substr(0,A+1)+a[B].v),A=P.indexOf(".")+1,o=H;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==H)){for(h=a[o].v.indexOf(".")>-1&&o===H?a[o].v.indexOf(".")+1:0,D=a[o].v.substr(0,h);h<a[o].v.length;++h)A<P.length&&(D+=P.charAt(A++));a[o].v=D,a[o].t="t",B=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(R=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Ua(a[o].t,a[o].v,R),a[o].t="t");var W="";for(o=0;o!==a.length;++o)a[o]!=null&&(W+=a[o].v);return W}var a1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function i1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Gb(e,t){var r=Wb(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(a1),l=r[1].match(a1);return i1(t,o)?[n,r[0]]:i1(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function jn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[e],n==null&&(n=r.table&&r.table[t1[e]]||nt[t1[e]]),n==null&&(n=Nb[e]||"General");break}if(vf(n,0))return gs(t,r);t instanceof Date&&(t=y2(t,r.date1904));var a=Gb(n,t);if(vf(a[1]))return gs(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return $b(a[1],t,r,a[0])}function ss(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nt[r]==null){t<0&&(t=r);continue}if(nt[r]==e){t=r;break}}t<0&&(t=391)}return nt[t]=e,t}function A2(){nt=bb()}var Zb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},L2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qb(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(L2,"(\\d+)"),new RegExp("^"+t+"$")}function Xb(e,t,r){var n=-1,a=-1,i=-1,o=-1,l=-1,u=-1;(t.match(L2)||[]).forEach(function(m,g){var x=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=x;break;case"d":i=x;break;case"h":o=x;break;case"s":u=x;break;case"m":o>=0?l=x:a=x;break}}),u>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?d:n==-1&&a==-1&&i==-1?h:d+"T"+h}var Yb=function(){var e={};e.version="1.2.0";function t(){for(var P=0,H=new Array(256),B=0;B!=256;++B)P=B,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,H[B]=P;return typeof Int32Array<"u"?new Int32Array(H):H}var r=t();function n(P){var H=0,B=0,W=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)I[W]=P[W];for(W=0;W!=256;++W)for(B=P[W],H=256+W;H<4096;H+=256)B=I[H]=B>>>8^P[B&255];var Z=[];for(W=1;W!=16;++W)Z[W-1]=typeof Int32Array<"u"?I.subarray(W*256,W*256+256):I.slice(W*256,W*256+256);return Z}var a=n(r),i=a[0],o=a[1],l=a[2],u=a[3],d=a[4],h=a[5],m=a[6],g=a[7],x=a[8],_=a[9],y=a[10],E=a[11],k=a[12],S=a[13],w=a[14];function A(P,H){for(var B=H^-1,W=0,I=P.length;W<I;)B=B>>>8^r[(B^P.charCodeAt(W++))&255];return~B}function D(P,H){for(var B=H^-1,W=P.length-15,I=0;I<W;)B=w[P[I++]^B&255]^S[P[I++]^B>>8&255]^k[P[I++]^B>>16&255]^E[P[I++]^B>>>24]^y[P[I++]]^_[P[I++]]^x[P[I++]]^g[P[I++]]^m[P[I++]]^h[P[I++]]^d[P[I++]]^u[P[I++]]^l[P[I++]]^o[P[I++]]^i[P[I++]]^r[P[I++]];for(W+=15;I<W;)B=B>>>8^r[(B^P[I++])&255];return~B}function R(P,H){for(var B=H^-1,W=0,I=P.length,Z=0,J=0;W<I;)Z=P.charCodeAt(W++),Z<128?B=B>>>8^r[(B^Z)&255]:Z<2048?(B=B>>>8^r[(B^(192|Z>>6&31))&255],B=B>>>8^r[(B^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,J=P.charCodeAt(W++)&1023,B=B>>>8^r[(B^(240|Z>>8&7))&255],B=B>>>8^r[(B^(128|Z>>2&63))&255],B=B>>>8^r[(B^(128|J>>6&15|(Z&3)<<4))&255],B=B>>>8^r[(B^(128|J&63))&255]):(B=B>>>8^r[(B^(224|Z>>12&15))&255],B=B>>>8^r[(B^(128|Z>>6&63))&255],B=B>>>8^r[(B^(128|Z&63))&255]);return~B}return e.table=r,e.bstr=A,e.buf=D,e.str=R,e}(),mt=function(){var t={};t.version="1.2.1";function r(b,M){for(var O=b.split("/"),j=M.split("/"),z=0,V=0,ae=Math.min(O.length,j.length);z<ae;++z){if(V=O[z].length-j[z].length)return V;if(O[z]!=j[z])return O[z]<j[z]?-1:1}return O.length-j.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var M=b.lastIndexOf("/");return M===-1?b:b.slice(0,M+1)}function a(b){if(b.charAt(b.length-1)=="/")return a(b.slice(0,-1));var M=b.lastIndexOf("/");return M===-1?b:b.slice(M+1)}function i(b,M){typeof M=="string"&&(M=new Date(M));var O=M.getHours();O=O<<6|M.getMinutes(),O=O<<5|M.getSeconds()>>>1,b.write_shift(2,O);var j=M.getFullYear()-1980;j=j<<4|M.getMonth()+1,j=j<<5|M.getDate(),b.write_shift(2,j)}function o(b){var M=b.read_shift(2)&65535,O=b.read_shift(2)&65535,j=new Date,z=O&31;O>>>=5;var V=O&15;O>>>=4,j.setMilliseconds(0),j.setFullYear(O+1980),j.setMonth(V-1),j.setDate(z);var ae=M&31;M>>>=5;var ve=M&63;return M>>>=6,j.setHours(M),j.setMinutes(ve),j.setSeconds(ae<<1),j}function l(b){wr(b,0);for(var M={},O=0;b.l<=b.length-4;){var j=b.read_shift(2),z=b.read_shift(2),V=b.l+z,ae={};switch(j){case 21589:O=b.read_shift(1),O&1&&(ae.mtime=b.read_shift(4)),z>5&&(O&2&&(ae.atime=b.read_shift(4)),O&4&&(ae.ctime=b.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}b.l=V,M[j]=ae}return M}var u;function d(){return u||(u={})}function h(b,M){if(b[0]==80&&b[1]==75)return Ne(b,M);if((b[0]|32)==109&&(b[1]|32)==105)return Xe(b,M);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var O=3,j=512,z=0,V=0,ae=0,ve=0,se=0,oe=[],le=b.slice(0,512);wr(le,0);var Se=m(le);switch(O=Se[0],O){case 3:j=512;break;case 4:j=4096;break;case 0:if(Se[1]==0)return Ne(b,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}j!==512&&(le=b.slice(0,j),wr(le,28));var Oe=b.slice(0,j);g(le,O);var Ie=le.read_shift(4,"i");if(O===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ve=le.read_shift(4,"i"),z=le.read_shift(4,"i"),se=le.read_shift(4,"i"),V=le.read_shift(4,"i");for(var Ae=-1,Me=0;Me<109&&(Ae=le.read_shift(4,"i"),!(Ae<0));++Me)oe[Me]=Ae;var Je=x(b,j);E(se,V,Je,j,oe);var Lt=S(Je,ae,oe,j);Lt[ae].name="!Directory",z>0&&ve!==J&&(Lt[ve].name="!MiniFAT"),Lt[oe[0]].name="!FAT",Lt.fat_addrs=oe,Lt.ssz=j;var Pt={},fr=[],Sa=[],In=[];w(ae,Lt,Je,fr,z,Pt,Sa,ve),_(Sa,In,fr),fr.shift();var ei={FileIndex:Sa,FullPaths:In};return M&&M.raw&&(ei.raw={header:Oe,sectors:Je}),ei}function m(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(ge,"Header Signature: "),b.l+=16;var M=b.read_shift(2,"u");return[b.read_shift(2,"u"),M]}function g(b,M){var O=9;switch(b.l+=2,O=b.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function x(b,M){for(var O=Math.ceil(b.length/M)-1,j=[],z=1;z<O;++z)j[z-1]=b.slice(z*M,(z+1)*M);return j[O-1]=b.slice(O*M),j}function _(b,M,O){for(var j=0,z=0,V=0,ae=0,ve=0,se=O.length,oe=[],le=[];j<se;++j)oe[j]=le[j]=j,M[j]=O[j];for(;ve<le.length;++ve)j=le[ve],z=b[j].L,V=b[j].R,ae=b[j].C,oe[j]===j&&(z!==-1&&oe[z]!==z&&(oe[j]=oe[z]),V!==-1&&oe[V]!==V&&(oe[j]=oe[V])),ae!==-1&&(oe[ae]=j),z!==-1&&j!=oe[j]&&(oe[z]=oe[j],le.lastIndexOf(z)<ve&&le.push(z)),V!==-1&&j!=oe[j]&&(oe[V]=oe[j],le.lastIndexOf(V)<ve&&le.push(V));for(j=1;j<se;++j)oe[j]===j&&(V!==-1&&oe[V]!==V?oe[j]=oe[V]:z!==-1&&oe[z]!==z&&(oe[j]=oe[z]));for(j=1;j<se;++j)if(b[j].type!==0){if(ve=j,ve!=oe[ve])do ve=oe[ve],M[j]=M[ve]+"/"+M[j];while(ve!==0&&oe[ve]!==-1&&ve!=oe[ve]);oe[j]=-1}for(M[0]+="/",j=1;j<se;++j)b[j].type!==2&&(M[j]+="/")}function y(b,M,O){for(var j=b.start,z=b.size,V=[],ae=j;O&&z>0&&ae>=0;)V.push(M.slice(ae*Z,ae*Z+Z)),z-=Z,ae=qi(O,ae*4);return V.length===0?ir(0):fi(V).slice(0,b.size)}function E(b,M,O,j,z){var V=J;if(b===J){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ae=O[b],ve=(j>>>2)-1;if(!ae)return;for(var se=0;se<ve&&(V=qi(ae,se*4))!==J;++se)z.push(V);E(qi(ae,j-4),M-1,O,j,z)}}function k(b,M,O,j,z){var V=[],ae=[];z||(z=[]);var ve=j-1,se=0,oe=0;for(se=M;se>=0;){z[se]=!0,V[V.length]=se,ae.push(b[se]);var le=O[Math.floor(se*4/j)];if(oe=se*4&ve,j<4+oe)throw new Error("FAT boundary crossed: "+se+" 4 "+j);if(!b[le])break;se=qi(b[le],oe)}return{nodes:V,data:m1([ae])}}function S(b,M,O,j){var z=b.length,V=[],ae=[],ve=[],se=[],oe=j-1,le=0,Se=0,Oe=0,Ie=0;for(le=0;le<z;++le)if(ve=[],Oe=le+M,Oe>=z&&(Oe-=z),!ae[Oe]){se=[];var Ae=[];for(Se=Oe;Se>=0;){Ae[Se]=!0,ae[Se]=!0,ve[ve.length]=Se,se.push(b[Se]);var Me=O[Math.floor(Se*4/j)];if(Ie=Se*4&oe,j<4+Ie)throw new Error("FAT boundary crossed: "+Se+" 4 "+j);if(!b[Me]||(Se=qi(b[Me],Ie),Ae[Se]))break}V[Oe]={nodes:ve,data:m1([se])}}return V}function w(b,M,O,j,z,V,ae,ve){for(var se=0,oe=j.length?2:0,le=M[b].data,Se=0,Oe=0,Ie;Se<le.length;Se+=128){var Ae=le.slice(Se,Se+128);wr(Ae,64),Oe=Ae.read_shift(2),Ie=sm(Ae,0,Oe-oe),j.push(Ie);var Me={name:Ie,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},Je=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Je!==0&&(Me.ct=A(Ae,Ae.l-8));var Lt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Lt!==0&&(Me.mt=A(Ae,Ae.l-8)),Me.start=Ae.read_shift(4,"i"),Me.size=Ae.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=J,Me.name=""),Me.type===5?(se=Me.start,z>0&&se!==J&&(M[se].name="!StreamData")):Me.size>=4096?(Me.storage="fat",M[Me.start]===void 0&&(M[Me.start]=k(O,Me.start,M.fat_addrs,M.ssz)),M[Me.start].name=Me.name,Me.content=M[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:se!==J&&Me.start!==J&&M[se]&&(Me.content=y(Me,M[se].data,(M[ve]||{}).data))),Me.content&&wr(Me.content,0),V[Ie]=Me,ae.push(Me)}}function A(b,M){return new Date((un(b,M+4)/1e7*Math.pow(2,32)+un(b,M)/1e7-11644473600)*1e3)}function D(b,M){return d(),h(u.readFileSync(b),M)}function R(b,M){var O=M&&M.type;switch(O||ut&&Buffer.isBuffer(b)&&(O="buffer"),O||"base64"){case"file":return D(b,M);case"base64":return h(Zn(gn(b)),M);case"binary":return h(Zn(b),M)}return h(b,M)}function P(b,M){var O=M||{},j=O.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=j+"/",b.FileIndex[0]={name:j,type:5}),O.CLSID&&(b.FileIndex[0].clsid=O.CLSID),H(b)}function H(b){var M="Sh33tJ5";if(!mt.find(b,"/"+M)){var O=ir(4);O[0]=55,O[1]=O[3]=50,O[2]=54,b.FileIndex.push({name:M,type:2,content:O,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+M),B(b)}}function B(b,M){P(b);for(var O=!1,j=!1,z=b.FullPaths.length-1;z>=0;--z){var V=b.FileIndex[z];switch(V.type){case 0:j?O=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(V.R*V.L*V.C)&&(O=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!M)){var ae=new Date(1987,1,19),ve=0,se=Object.create?Object.create(null):{},oe=[];for(z=0;z<b.FullPaths.length;++z)se[b.FullPaths[z]]=!0,b.FileIndex[z].type!==0&&oe.push([b.FullPaths[z],b.FileIndex[z]]);for(z=0;z<oe.length;++z){var le=n(oe[z][0]);j=se[le],j||(oe.push([le,{name:a(le).replace("/",""),type:1,clsid:de,ct:ae,mt:ae,content:null}]),se[le]=!0)}for(oe.sort(function(Ie,Ae){return r(Ie[0],Ae[0])}),b.FullPaths=[],b.FileIndex=[],z=0;z<oe.length;++z)b.FullPaths[z]=oe[z][0],b.FileIndex[z]=oe[z][1];for(z=0;z<oe.length;++z){var Se=b.FileIndex[z],Oe=b.FullPaths[z];if(Se.name=a(Oe).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||de,z===0)Se.C=oe.length>1?1:-1,Se.size=0,Se.type=5;else if(Oe.slice(-1)=="/"){for(ve=z+1;ve<oe.length&&n(b.FullPaths[ve])!=Oe;++ve);for(Se.C=ve>=oe.length?-1:ve,ve=z+1;ve<oe.length&&n(b.FullPaths[ve])!=n(Oe);++ve);Se.R=ve>=oe.length?-1:ve,Se.type=1}else n(b.FullPaths[z+1]||"")==n(Oe)&&(Se.R=z+1),Se.type=2}}}function W(b,M){var O=M||{};if(O.fileType=="mad")return Ze(b,O);switch(B(b),O.fileType){case"zip":return Ge(b,O)}var j=function(Ie){for(var Ae=0,Me=0,Je=0;Je<Ie.FileIndex.length;++Je){var Lt=Ie.FileIndex[Je];if(Lt.content){var Pt=Lt.content.length;Pt>0&&(Pt<4096?Ae+=Pt+63>>6:Me+=Pt+511>>9)}}for(var fr=Ie.FullPaths.length+3>>2,Sa=Ae+7>>3,In=Ae+127>>7,ei=Sa+Me+fr+In,aa=ei+127>>7,Ta=aa<=109?0:Math.ceil((aa-109)/127);ei+aa+Ta+127>>7>aa;)Ta=++aa<=109?0:Math.ceil((aa-109)/127);var tt=[1,Ta,aa,In,fr,Me,Ae,0];return Ie.FileIndex[0].size=Ae<<6,tt[7]=(Ie.FileIndex[0].start=tt[0]+tt[1]+tt[2]+tt[3]+tt[4]+tt[5])+(tt[6]+7>>3),tt}(b),z=ir(j[7]<<9),V=0,ae=0;{for(V=0;V<8;++V)z.write_shift(1,_e[V]);for(V=0;V<8;++V)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),V=0;V<3;++V)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,j[2]),z.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:J),z.write_shift(4,j[3]),z.write_shift(-4,j[1]?j[0]-1:J),z.write_shift(4,j[1]),V=0;V<109;++V)z.write_shift(-4,V<j[2]?j[1]+V:-1)}if(j[1])for(ae=0;ae<j[1];++ae){for(;V<236+ae*127;++V)z.write_shift(-4,V<j[2]?j[1]+V:-1);z.write_shift(-4,ae===j[1]-1?J:ae+1)}var ve=function(Ie){for(ae+=Ie;V<ae-1;++V)z.write_shift(-4,V+1);Ie&&(++V,z.write_shift(-4,J))};for(ae=V=0,ae+=j[1];V<ae;++V)z.write_shift(-4,Q.DIFSECT);for(ae+=j[2];V<ae;++V)z.write_shift(-4,Q.FATSECT);ve(j[3]),ve(j[4]);for(var se=0,oe=0,le=b.FileIndex[0];se<b.FileIndex.length;++se)le=b.FileIndex[se],le.content&&(oe=le.content.length,!(oe<4096)&&(le.start=ae,ve(oe+511>>9)));for(ve(j[6]+7>>3);z.l&511;)z.write_shift(-4,Q.ENDOFCHAIN);for(ae=V=0,se=0;se<b.FileIndex.length;++se)le=b.FileIndex[se],le.content&&(oe=le.content.length,!(!oe||oe>=4096)&&(le.start=ae,ve(oe+63>>6)));for(;z.l&511;)z.write_shift(-4,Q.ENDOFCHAIN);for(V=0;V<j[4]<<2;++V){var Se=b.FullPaths[V];if(!Se||Se.length===0){for(se=0;se<17;++se)z.write_shift(4,0);for(se=0;se<3;++se)z.write_shift(4,-1);for(se=0;se<12;++se)z.write_shift(4,0);continue}le=b.FileIndex[V],V===0&&(le.start=le.size?le.start-1:J);var Oe=V===0&&O.root||le.name;if(oe=2*(Oe.length+1),z.write_shift(64,Oe,"utf16le"),z.write_shift(2,oe),z.write_shift(1,le.type),z.write_shift(1,le.color),z.write_shift(-4,le.L),z.write_shift(-4,le.R),z.write_shift(-4,le.C),le.clsid)z.write_shift(16,le.clsid,"hex");else for(se=0;se<4;++se)z.write_shift(4,0);z.write_shift(4,le.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,le.start),z.write_shift(4,le.size),z.write_shift(4,0)}for(V=1;V<b.FileIndex.length;++V)if(le=b.FileIndex[V],le.size>=4096)if(z.l=le.start+1<<9,ut&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+511&-512;else{for(se=0;se<le.size;++se)z.write_shift(1,le.content[se]);for(;se&511;++se)z.write_shift(1,0)}for(V=1;V<b.FileIndex.length;++V)if(le=b.FileIndex[V],le.size>0&&le.size<4096)if(ut&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+63&-64;else{for(se=0;se<le.size;++se)z.write_shift(1,le.content[se]);for(;se&63;++se)z.write_shift(1,0)}if(ut)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function I(b,M){var O=b.FullPaths.map(function(se){return se.toUpperCase()}),j=O.map(function(se){var oe=se.split("/");return oe[oe.length-(se.slice(-1)=="/"?2:1)]}),z=!1;M.charCodeAt(0)===47?(z=!0,M=O[0].slice(0,-1)+M):z=M.indexOf("/")!==-1;var V=M.toUpperCase(),ae=z===!0?O.indexOf(V):j.indexOf(V);if(ae!==-1)return b.FileIndex[ae];var ve=!V.match(cl);for(V=V.replace(Yr,""),ve&&(V=V.replace(cl,"!")),ae=0;ae<O.length;++ae)if((ve?O[ae].replace(cl,"!"):O[ae]).replace(Yr,"")==V||(ve?j[ae].replace(cl,"!"):j[ae]).replace(Yr,"")==V)return b.FileIndex[ae];return null}var Z=64,J=-2,ge="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(b,M,O){d();var j=W(b,O);u.writeFileSync(M,j)}function U(b){for(var M=new Array(b.length),O=0;O<b.length;++O)M[O]=String.fromCharCode(b[O]);return M.join("")}function ne(b,M){var O=W(b,M);switch(M&&M.type||"buffer"){case"file":return d(),u.writeFileSync(M.filename,O),O;case"binary":return typeof O=="string"?O:U(O);case"base64":return Kx(typeof O=="string"?O:U(O));case"buffer":if(ut)return Buffer.isBuffer(O)?O:ks(O);case"array":return typeof O=="string"?Zn(O):O}return O}var ue;function F(b){try{var M=b.InflateRaw,O=new M;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)ue=b;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function te(b,M){if(!ue)return xe(b,M);var O=ue.InflateRaw,j=new O,z=j._processChunk(b.slice(b.l),j._finishFlushFlag);return b.l+=j.bytesRead,z}function q(b){return ue?ue.deflateRawSync(b):Ke(b)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(b){var M=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(M>>16|M>>8|M)&255}for(var be=typeof Uint8Array<"u",ke=be?new Uint8Array(256):[],$e=0;$e<256;++$e)ke[$e]=Le($e);function G(b,M){var O=ke[b&255];return M<=8?O>>>8-M:(O=O<<8|ke[b>>8&255],M<=16?O>>>16-M:(O=O<<8|ke[b>>16&255],O>>>24-M))}function ot(b,M){var O=M&7,j=M>>>3;return(b[j]|(O<=6?0:b[j+1]<<8))>>>O&3}function me(b,M){var O=M&7,j=M>>>3;return(b[j]|(O<=5?0:b[j+1]<<8))>>>O&7}function Te(b,M){var O=M&7,j=M>>>3;return(b[j]|(O<=4?0:b[j+1]<<8))>>>O&15}function Pe(b,M){var O=M&7,j=M>>>3;return(b[j]|(O<=3?0:b[j+1]<<8))>>>O&31}function he(b,M){var O=M&7,j=M>>>3;return(b[j]|(O<=1?0:b[j+1]<<8))>>>O&127}function Ue(b,M,O){var j=M&7,z=M>>>3,V=(1<<O)-1,ae=b[z]>>>j;return O<8-j||(ae|=b[z+1]<<8-j,O<16-j)||(ae|=b[z+2]<<16-j,O<24-j)||(ae|=b[z+3]<<24-j),ae&V}function We(b,M,O){var j=M&7,z=M>>>3;return j<=5?b[z]|=(O&7)<<j:(b[z]|=O<<j&255,b[z+1]=(O&7)>>8-j),M+3}function yt(b,M,O){var j=M&7,z=M>>>3;return O=(O&1)<<j,b[z]|=O,M+1}function Tt(b,M,O){var j=M&7,z=M>>>3;return O<<=j,b[z]|=O&255,O>>>=8,b[z+1]=O,M+8}function dt(b,M,O){var j=M&7,z=M>>>3;return O<<=j,b[z]|=O&255,O>>>=8,b[z+1]=O&255,b[z+2]=O>>>8,M+16}function St(b,M){var O=b.length,j=2*O>M?2*O:M+5,z=0;if(O>=M)return b;if(ut){var V=Jx(j);if(b.copy)b.copy(V);else for(;z<b.length;++z)V[z]=b[z];return V}else if(be){var ae=new Uint8Array(j);if(ae.set)ae.set(b);else for(;z<O;++z)ae[z]=b[z];return ae}return b.length=j,b}function _t(b){for(var M=new Array(b),O=0;O<b;++O)M[O]=0;return M}function ar(b,M,O){var j=1,z=0,V=0,ae=0,ve=0,se=b.length,oe=be?new Uint16Array(32):_t(32);for(V=0;V<32;++V)oe[V]=0;for(V=se;V<O;++V)b[V]=0;se=b.length;var le=be?new Uint16Array(se):_t(se);for(V=0;V<se;++V)oe[z=b[V]]++,j<z&&(j=z),le[V]=0;for(oe[0]=0,V=1;V<=j;++V)oe[V+16]=ve=ve+oe[V-1]<<1;for(V=0;V<se;++V)ve=b[V],ve!=0&&(le[V]=oe[ve+16]++);var Se=0;for(V=0;V<se;++V)if(Se=b[V],Se!=0)for(ve=G(le[V],j)>>j-Se,ae=(1<<j+4-Se)-1;ae>=0;--ae)M[ve|ae<<Se]=Se&15|V<<4;return j}var Yt=be?new Uint16Array(512):_t(512),_n=be?new Uint16Array(32):_t(32);if(!be){for(var Vt=0;Vt<512;++Vt)Yt[Vt]=0;for(Vt=0;Vt<32;++Vt)_n[Vt]=0}(function(){for(var b=[],M=0;M<32;M++)b.push(5);ar(b,_n,32);var O=[];for(M=0;M<=143;M++)O.push(8);for(;M<=255;M++)O.push(9);for(;M<=279;M++)O.push(7);for(;M<=287;M++)O.push(8);ar(O,Yt,288)})();var Nr=function(){for(var M=be?new Uint8Array(32768):[],O=0,j=0;O<ye.length-1;++O)for(;j<ye[O+1];++j)M[j]=O;for(;j<32768;++j)M[j]=29;var z=be?new Uint8Array(259):[];for(O=0,j=0;O<K.length-1;++O)for(;j<K[O+1];++j)z[j]=O;function V(ve,se){for(var oe=0;oe<ve.length;){var le=Math.min(65535,ve.length-oe),Se=oe+le==ve.length;for(se.write_shift(1,+Se),se.write_shift(2,le),se.write_shift(2,~le&65535);le-- >0;)se[se.l++]=ve[oe++]}return se.l}function ae(ve,se){for(var oe=0,le=0,Se=be?new Uint16Array(32768):[];le<ve.length;){var Oe=Math.min(65535,ve.length-le);if(Oe<10){for(oe=We(se,oe,+(le+Oe==ve.length)),oe&7&&(oe+=8-(oe&7)),se.l=oe/8|0,se.write_shift(2,Oe),se.write_shift(2,~Oe&65535);Oe-- >0;)se[se.l++]=ve[le++];oe=se.l*8;continue}oe=We(se,oe,+(le+Oe==ve.length)+2);for(var Ie=0;Oe-- >0;){var Ae=ve[le];Ie=(Ie<<5^Ae)&32767;var Me=-1,Je=0;if((Me=Se[Ie])&&(Me|=le&-32768,Me>le&&(Me-=32768),Me<le))for(;ve[Me+Je]==ve[le+Je]&&Je<250;)++Je;if(Je>2){Ae=z[Je],Ae<=22?oe=Tt(se,oe,ke[Ae+1]>>1)-1:(Tt(se,oe,3),oe+=5,Tt(se,oe,ke[Ae-23]>>5),oe+=3);var Lt=Ae<8?0:Ae-4>>2;Lt>0&&(dt(se,oe,Je-K[Ae]),oe+=Lt),Ae=M[le-Me],oe=Tt(se,oe,ke[Ae]>>3),oe-=3;var Pt=Ae<4?0:Ae-2>>1;Pt>0&&(dt(se,oe,le-Me-ye[Ae]),oe+=Pt);for(var fr=0;fr<Je;++fr)Se[Ie]=le&32767,Ie=(Ie<<5^ve[le])&32767,++le;Oe-=Je-1}else Ae<=143?Ae=Ae+48:oe=yt(se,oe,1),oe=Tt(se,oe,ke[Ae]),Se[Ie]=le&32767,++le}oe=Tt(se,oe,0)-1}return se.l=(oe+7)/8|0,se.l}return function(se,oe){return se.length<8?V(se,oe):ae(se,oe)}}();function Ke(b){var M=ir(50+Math.floor(b.length*1.1)),O=Nr(b,M);return M.slice(0,O)}var wt=be?new Uint16Array(32768):_t(32768),ur=be?new Uint16Array(32768):_t(32768),Ct=be?new Uint16Array(128):_t(128),Ar=1,yn=1;function Qa(b,M){var O=Pe(b,M)+257;M+=5;var j=Pe(b,M)+1;M+=5;var z=Te(b,M)+4;M+=4;for(var V=0,ae=be?new Uint8Array(19):_t(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,oe=be?new Uint8Array(8):_t(8),le=be?new Uint8Array(8):_t(8),Se=ae.length,Oe=0;Oe<z;++Oe)ae[X[Oe]]=V=me(b,M),se<V&&(se=V),oe[V]++,M+=3;var Ie=0;for(oe[0]=0,Oe=1;Oe<=se;++Oe)le[Oe]=Ie=Ie+oe[Oe-1]<<1;for(Oe=0;Oe<Se;++Oe)(Ie=ae[Oe])!=0&&(ve[Oe]=le[Ie]++);var Ae=0;for(Oe=0;Oe<Se;++Oe)if(Ae=ae[Oe],Ae!=0){Ie=ke[ve[Oe]]>>8-Ae;for(var Me=(1<<7-Ae)-1;Me>=0;--Me)Ct[Ie|Me<<Ae]=Ae&7|Oe<<3}var Je=[];for(se=1;Je.length<O+j;)switch(Ie=Ct[he(b,M)],M+=Ie&7,Ie>>>=3){case 16:for(V=3+ot(b,M),M+=2,Ie=Je[Je.length-1];V-- >0;)Je.push(Ie);break;case 17:for(V=3+me(b,M),M+=3;V-- >0;)Je.push(0);break;case 18:for(V=11+he(b,M),M+=7;V-- >0;)Je.push(0);break;default:Je.push(Ie),se<Ie&&(se=Ie);break}var Lt=Je.slice(0,O),Pt=Je.slice(O);for(Oe=O;Oe<286;++Oe)Lt[Oe]=0;for(Oe=j;Oe<30;++Oe)Pt[Oe]=0;return Ar=ar(Lt,wt,286),yn=ar(Pt,ur,30),M}function Dn(b,M){if(b[0]==3&&!(b[1]&3))return[Pi(M),2];for(var O=0,j=0,z=Jx(M||1<<18),V=0,ae=z.length>>>0,ve=0,se=0;!(j&1);){if(j=me(b,O),O+=3,j>>>1)j>>1==1?(ve=9,se=5):(O=Qa(b,O),ve=Ar,se=yn);else{O&7&&(O+=8-(O&7));var oe=b[O>>>3]|b[(O>>>3)+1]<<8;if(O+=32,oe>0)for(!M&&ae<V+oe&&(z=St(z,V+oe),ae=z.length);oe-- >0;)z[V++]=b[O>>>3],O+=8;continue}for(;;){!M&&ae<V+32767&&(z=St(z,V+32767),ae=z.length);var le=Ue(b,O,ve),Se=j>>>1==1?Yt[le]:wt[le];if(O+=Se&15,Se>>>=4,!(Se>>>8&255))z[V++]=Se;else{if(Se==256)break;Se-=257;var Oe=Se<8?0:Se-4>>2;Oe>5&&(Oe=0);var Ie=V+K[Se];Oe>0&&(Ie+=Ue(b,O,Oe),O+=Oe),le=Ue(b,O,se),Se=j>>>1==1?_n[le]:ur[le],O+=Se&15,Se>>>=4;var Ae=Se<4?0:Se-2>>1,Me=ye[Se];for(Ae>0&&(Me+=Ue(b,O,Ae),O+=Ae),!M&&ae<Ie&&(z=St(z,Ie+100),ae=z.length);V<Ie;)z[V]=z[V-Me],++V}}}return M?[z,O+7>>>3]:[z.slice(0,V),O+7>>>3]}function xe(b,M){var O=b.slice(b.l||0),j=Dn(O,M);return b.l+=j[1],j[0]}function we(b,M){if(b)typeof console<"u"&&console.error(M);else throw new Error(M)}function Ne(b,M){var O=b;wr(O,0);var j=[],z=[],V={FileIndex:j,FullPaths:z};P(V,{root:M.root});for(var ae=O.length-4;(O[ae]!=80||O[ae+1]!=75||O[ae+2]!=5||O[ae+3]!=6)&&ae>=0;)--ae;O.l=ae+4,O.l+=4;var ve=O.read_shift(2);O.l+=6;var se=O.read_shift(4);for(O.l=se,ae=0;ae<ve;++ae){O.l+=20;var oe=O.read_shift(4),le=O.read_shift(4),Se=O.read_shift(2),Oe=O.read_shift(2),Ie=O.read_shift(2);O.l+=8;var Ae=O.read_shift(4),Me=l(O.slice(O.l+Se,O.l+Se+Oe));O.l+=Se+Oe+Ie;var Je=O.l;O.l=Ae+4,je(O,oe,le,V,Me),O.l=Je}return V}function je(b,M,O,j,z){b.l+=2;var V=b.read_shift(2),ae=b.read_shift(2),ve=o(b);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var se=b.read_shift(4),oe=b.read_shift(4),le=b.read_shift(4),Se=b.read_shift(2),Oe=b.read_shift(2),Ie="",Ae=0;Ae<Se;++Ae)Ie+=String.fromCharCode(b[b.l++]);if(Oe){var Me=l(b.slice(b.l,b.l+Oe));(Me[21589]||{}).mt&&(ve=Me[21589].mt),((z||{})[21589]||{}).mt&&(ve=z[21589].mt)}b.l+=Oe;var Je=b.slice(b.l,b.l+oe);switch(ae){case 8:Je=te(b,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Lt=!1;V&8&&(se=b.read_shift(4),se==134695760&&(se=b.read_shift(4),Lt=!0),oe=b.read_shift(4),le=b.read_shift(4)),oe!=M&&we(Lt,"Bad compressed size: "+M+" != "+oe),le!=O&&we(Lt,"Bad uncompressed size: "+O+" != "+le),Qe(j,Ie,Je,{unsafe:!0,mt:ve})}function Ge(b,M){var O=M||{},j=[],z=[],V=ir(1),ae=O.compression?8:0,ve=0,se=0,oe=0,le=0,Se=0,Oe=b.FullPaths[0],Ie=Oe,Ae=b.FileIndex[0],Me=[],Je=0;for(se=1;se<b.FullPaths.length;++se)if(Ie=b.FullPaths[se].slice(Oe.length),Ae=b.FileIndex[se],!(!Ae.size||!Ae.content||Ie=="Sh33tJ5")){var Lt=le,Pt=ir(Ie.length);for(oe=0;oe<Ie.length;++oe)Pt.write_shift(1,Ie.charCodeAt(oe)&127);Pt=Pt.slice(0,Pt.l),Me[Se]=Yb.buf(Ae.content,0);var fr=Ae.content;ae==8&&(fr=q(fr)),V=ir(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,ve),V.write_shift(2,ae),Ae.mt?i(V,Ae.mt):V.write_shift(4,0),V.write_shift(-4,Me[Se]),V.write_shift(4,fr.length),V.write_shift(4,Ae.content.length),V.write_shift(2,Pt.length),V.write_shift(2,0),le+=V.length,j.push(V),le+=Pt.length,j.push(Pt),le+=fr.length,j.push(fr),V=ir(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,ve),V.write_shift(2,ae),V.write_shift(4,0),V.write_shift(-4,Me[Se]),V.write_shift(4,fr.length),V.write_shift(4,Ae.content.length),V.write_shift(2,Pt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,Lt),Je+=V.l,z.push(V),Je+=Pt.length,z.push(Pt),++Se}return V=ir(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,Se),V.write_shift(2,Se),V.write_shift(4,Je),V.write_shift(4,le),V.write_shift(2,0),fi([fi(j),fi(z),V])}var ht={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lt(b,M){if(b.ctype)return b.ctype;var O=b.name||"",j=O.match(/\.([^\.]+)$/);return j&&ht[j[1]]||M&&(j=(O=M).match(/[\.\\]([^\.\\])+$/),j&&ht[j[1]])?ht[j[1]]:"application/octet-stream"}function re(b){for(var M=Kx(b),O=[],j=0;j<M.length;j+=76)O.push(M.slice(j,j+76));return O.join(`\r
`)+`\r
`}function ce(b){var M=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],j=M.split(`\r
`),z=0;z<j.length;++z){var V=j[z];if(V.length==0){O.push("");continue}for(var ae=0;ae<V.length;){var ve=76,se=V.slice(ae,ae+ve);se.charAt(ve-1)=="="?ve--:se.charAt(ve-2)=="="?ve-=2:se.charAt(ve-3)=="="&&(ve-=3),se=V.slice(ae,ae+ve),ae+=ve,ae<V.length&&(se+="="),O.push(se)}}return O.join(`\r
`)}function Fe(b){for(var M=[],O=0;O<b.length;++O){for(var j=b[O];O<=b.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+b[++O];M.push(j)}for(var z=0;z<M.length;++z)M[z]=M[z].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return Zn(M.join(`\r
`))}function Re(b,M,O){for(var j="",z="",V="",ae,ve=0;ve<10;++ve){var se=M[ve];if(!se||se.match(/^\s*$/))break;var oe=se.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":j=oe[2].trim();break;case"content-type":V=oe[2].trim();break;case"content-transfer-encoding":z=oe[2].trim();break}}switch(++ve,z.toLowerCase()){case"base64":ae=Zn(gn(M.slice(ve).join("")));break;case"quoted-printable":ae=Fe(M.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var le=Qe(b,j.slice(O.length),ae,{unsafe:!0});V&&(le.ctype=V)}function Xe(b,M){if(U(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=M&&M.root||"",j=(ut&&Buffer.isBuffer(b)?b.toString("binary"):U(b)).split(`\r
`),z=0,V="";for(z=0;z<j.length;++z)if(V=j[z],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),O||(O=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),V.slice(0,O.length)!=O););var ae=(j[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var ve="--"+(ae[1]||""),se=[],oe=[],le={FileIndex:se,FullPaths:oe};P(le);var Se,Oe=0;for(z=0;z<j.length;++z){var Ie=j[z];Ie!==ve&&Ie!==ve+"--"||(Oe++&&Re(le,j.slice(Se,z),O),Se=z)}return le}function Ze(b,M){var O=M||{},j=O.boundary||"SheetJS";j="------="+j;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],V=b.FullPaths[0],ae=V,ve=b.FileIndex[0],se=1;se<b.FullPaths.length;++se)if(ae=b.FullPaths[se].slice(V.length),ve=b.FileIndex[se],!(!ve.size||!ve.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Je){return"_x"+Je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Je){return"_u"+Je.charCodeAt(0).toString(16)+"_"});for(var oe=ve.content,le=ut&&Buffer.isBuffer(oe)?oe.toString("binary"):U(oe),Se=0,Oe=Math.min(1024,le.length),Ie=0,Ae=0;Ae<=Oe;++Ae)(Ie=le.charCodeAt(Ae))>=32&&Ie<128&&++Se;var Me=Se>=Oe*4/5;z.push(j),z.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ae),z.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),z.push("Content-Type: "+lt(ve,ae)),z.push(""),z.push(Me?ce(le):re(le))}return z.push(j+`--\r
`),z.join(`\r
`)}function He(b){var M={};return P(M,b),M}function Qe(b,M,O,j){var z=j&&j.unsafe;z||P(b);var V=!z&&mt.find(b,M);if(!V){var ae=b.FullPaths[0];M.slice(0,ae.length)==ae?ae=M:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+M).replace("//","/")),V={name:a(M),type:2},b.FileIndex.push(V),b.FullPaths.push(ae),z||mt.utils.cfb_gc(b)}return V.content=O,V.size=O?O.length:0,j&&(j.CLSID&&(V.clsid=j.CLSID),j.mt&&(V.mt=j.mt),j.ct&&(V.ct=j.ct)),V}function Vr(b,M){P(b);var O=mt.find(b,M);if(O){for(var j=0;j<b.FileIndex.length;++j)if(b.FileIndex[j]==O)return b.FileIndex.splice(j,1),b.FullPaths.splice(j,1),!0}return!1}function Lr(b,M,O){P(b);var j=mt.find(b,M);if(j){for(var z=0;z<b.FileIndex.length;++z)if(b.FileIndex[z]==j)return b.FileIndex[z].name=a(O),b.FullPaths[z]=O,!0}return!1}function Be(b){B(b,!0)}return t.find=I,t.read=R,t.parse=h,t.write=ne,t.writeFile=ee,t.utils={cfb_new:He,cfb_add:Qe,cfb_del:Vr,cfb_mov:Lr,cfb_gc:Be,ReadShift:kl,CheckField:J2,prep_blob:wr,bconcat:fi,use_zlib:F,_deflateRaw:Ke,_inflateRaw:xe,consts:Q},t}();function Kb(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function _a(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function rm(e){for(var t=[],r=_a(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var yf=new Date(1899,11,30,0,0,0);function Kr(e,t){var r=e.getTime(),n=yf.getTime()+(e.getTimezoneOffset()-yf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var P2=new Date,Jb=yf.getTime()+(P2.getTimezoneOffset()-yf.getTimezoneOffset())*6e4,s1=P2.getTimezoneOffset();function t0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Jb),t.getTimezoneOffset()!==s1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-s1)*6e4),t}function Qb(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var o1=new Date("2017-02-19T19:06:09.000Z"),F2=isNaN(o1.getFullYear())?new Date("2/19/17"):o1,eN=F2.getFullYear()==2017;function gr(e,t){var r=new Date(e);if(eN)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(F2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function xs(e,t){if(ut&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return fl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return fl(v2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return fl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return fl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Tr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Tr(e[r]));return t}function $t(e,t){for(var r="";r.length<t;)r+=e;return r}function Jn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var tN=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&tN.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var rN=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(a),o.push(i[l]);return o}}();function O2(e){return e?e.content&&e.type?xs(e.content,!0):e.data?ll(e.data):e.asNodeBuffer&&ut?ll(e.asNodeBuffer().toString("binary")):e.asBinary?ll(e.asBinary()):e._data&&e._data.getContent?ll(xs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function M2(e){if(!e)return null;if(e.data)return Xx(e.data);if(e.asNodeBuffer&&ut)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Xx(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function nN(e){return e&&e.name.slice(-4)===".bin"?M2(e):O2(e)}function Cn(e,t){for(var r=e.FullPaths||_a(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function nm(e,t){var r=Cn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function tr(e,t,r){if(!r)return nN(nm(e,t));if(!t)return null;try{return tr(e,t)}catch{return null}}function fn(e,t,r){if(!r)return O2(nm(e,t));if(!t)return null;try{return fn(e,t)}catch{return null}}function aN(e,t,r){return M2(nm(e,t))}function l1(e){for(var t=e.FullPaths||_a(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function iN(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ut?n=ks(r):n=Sb(r),mt.utils.cfb_add(e,t,n)}mt.utils.cfb_add(e,t,r)}else e.file(t,r)}function j2(e,t){switch(t.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ul(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var R2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,sN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,c1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,oN=/<[^>]*>/g,Hr=R2.match(c1)?c1:oN,lN=/<\w*:/,cN=/<(\/?)\w+:/;function Ye(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(sN),l=0,u="",d=0,h="",m="",g=1;if(o)for(d=0;d!=o.length;++d){for(m=o[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(h=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(g=(a=m.charCodeAt(i+1))==34||a==39?1:0,u=m.slice(i+1+g,m.length-g),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=u,n[h.toLowerCase()]=u;else{var x=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[x]&&h.slice(l-3,l)=="ext")continue;n[x]=u,n[x.toLowerCase()]=u}}return n}function wa(e){return e.replace(cN,"<$1")}var D2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uN=rm(D2),vt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,u){return D2[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),fN=/[&<>'"]/g,dN=/[\u0000-\u001f]/g;function am(e){var t=e+"";return t.replace(fN,function(r){return uN[r]}).replace(/\n/g,"<br/>").replace(dN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var u1=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function jt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ud(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function f1(e){var t=Pi(2*e.length),r,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function d1(e){return ks(e,"binary").toString("utf8")}var lu="foo bar baz",At=ut&&(d1(lu)==ud(lu)&&d1||f1(lu)==ud(lu)&&f1)||ud,fl=ut?function(e){return ks(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Kl=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),I2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),hN=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),pN=/<\/?(?:vt:)?variant>/g,mN=/<(?:vt:)([^>]*)>([\s\S]*)</;function h1(e,t){var r=Ye(e),n=e.match(hN(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(pN,"").match(mN);o&&a.push({v:At(o[2]),t:o[1]})}),a}var gN=/(^\s|\s$|\n)/;function xN(e){return _a(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function vN(e,t,r){return"<"+e+(r!=null?xN(r):"")+(t!=null?(t.match(gN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function im(e){if(ut&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return At(Es(Qp(e)));throw new Error("Bad input format: expected Buffer or string")}var Jl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_N={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yN=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function wN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function kN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var p1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},m1=ut?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ks(t)})):p1(e)}:p1,g1=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ia(e,a)));return n.join("").replace(Yr,"")},sm=ut?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Yr,""):g1(e,t,r)}:g1,x1=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},B2=ut?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):x1(e,t,r)}:x1,v1=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(zs(e,a)));return n.join("")},xc=ut?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):v1(t,r,n)}:v1,z2=function(e,t){var r=un(e,t);return r>0?xc(e,t+4,t+4+r-1):""},U2=z2,H2=function(e,t){var r=un(e,t);return r>0?xc(e,t+4,t+4+r-1):""},V2=H2,W2=function(e,t){var r=2*un(e,t);return r>0?xc(e,t+4,t+4+r-1):""},$2=W2,G2=function(t,r){var n=un(t,r);return n>0?sm(t,r+4,r+4+n):""},Z2=G2,q2=function(e,t){var r=un(e,t);return r>0?xc(e,t+4,t+4+r):""},X2=q2,Y2=function(e,t){return wN(e,t)},wf=Y2,K2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ut&&(U2=function(t,r){if(!Buffer.isBuffer(t))return z2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},V2=function(t,r){if(!Buffer.isBuffer(t))return H2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},$2=function(t,r){if(!Buffer.isBuffer(t))return W2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Z2=function(t,r){if(!Buffer.isBuffer(t))return G2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},X2=function(t,r){if(!Buffer.isBuffer(t))return q2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},wf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Y2(t,r)},K2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var zs=function(e,t){return e[t]},Ia=function(e,t){return e[t+1]*256+e[t]},EN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},un=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},qi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},SN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kl(e,t){var r="",n,a,i=[],o,l,u,d;switch(t){case"dbcs":if(d=this.l,ut&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Ia(this,d)),d+=2;e*=2;break;case"utf8":r=xc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=sm(this,this.l,this.l+e);break;case"wstr":return kl.call(this,e,"dbcs");case"lpstr-ansi":r=U2(this,this.l),e=4+un(this,this.l);break;case"lpstr-cp":r=V2(this,this.l),e=4+un(this,this.l);break;case"lpwstr":r=$2(this,this.l),e=4+2*un(this,this.l);break;case"lpp4":e=4+un(this,this.l),r=Z2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+un(this,this.l),r=X2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=zs(this,this.l+e++))!==0;)i.push(ou(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Ia(this,this.l+e))!==0;)i.push(ou(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=zs(this,d),this.l=d+1,l=kl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(ou(Ia(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=zs(this,d),this.l=d+1,l=kl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(ou(zs(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=zs(this,this.l),this.l++,n;case 2:return n=(t==="i"?EN:Ia)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?qi:SN)(this,this.l),this.l+=4,n):(a=un(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=wf(this,this.l):a=wf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=B2(this,this.l,e);break}}return this.l+=e,r}var TN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},CN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},bN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function NN(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)bN(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,TN(this,t,this.l);break;case 8:if(n=8,r==="f"){kN(this,t,this.l);break}case 16:break;case-4:n=4,CN(this,t,this.l);break}return this.l+=n,this}function J2(e,t){var r=B2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=kl,e.chk=J2,e.write_shift=NN}function Ur(e,t){e.l+=t}function ir(e){var t=Pi(e);return wr(t,0),t}function Ja(e,t,r){if(e){var n,a,i;wr(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=bf[l]||bf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;u=e.l+i;var h=d.f&&d.f(e,i,r);if(e.l=u,t(h,d,l))return}}}function Th(){var e=[],t=ut?256:2048,r=function(d){var h=ir(d);return wr(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},o=function(){return a(),fi(e)},l=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function El(e,t,r){var n=Tr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function _1(e,t,r){var n=Tr(e);return n.s=El(n.s,t.s,r),n.e=El(n.e,t.s,r),n}function Sl(e,t){if(e.cRel&&e.c<0)for(e=Tr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Tr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=et(e);return!e.cRel&&e.cRel!=null&&(r=PN(r)),!e.rRel&&e.rRel!=null&&(r=AN(r)),r}function fd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+lr(e.s.c)+":"+(e.e.cRel?"":"$")+lr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Cr(e.s.r)+":"+(e.e.rRel?"":"$")+Cr(e.e.r):Sl(e.s,t.biff)+":"+Sl(e.e,t.biff)}function om(e){return parseInt(LN(e),10)-1}function Cr(e){return""+(e+1)}function AN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LN(e){return e.replace(/\$(\d+)$/,"$1")}function lm(e){for(var t=FN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function lr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function PN(e){return e.replace(/^([A-Z])/,"$$$1")}function FN(e){return e.replace(/^\$([A-Z])/,"$1")}function ON(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function et(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Oo(e){var t=e.indexOf(":");return t==-1?{s:qr(e),e:qr(e)}:{s:qr(e.slice(0,t)),e:qr(e.slice(t+1))}}function gt(e,t){return typeof t>"u"||typeof t=="number"?gt(e.s,e.e):(typeof e!="string"&&(e=et(e)),typeof t!="string"&&(t=et(t)),e==t?e:e+":"+t)}function Gt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function y1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=jn(e.z,r?Kr(t):t)}catch{}try{return e.w=jn((e.XF||{}).numFmtId||(r?14:0),r?Kr(t):t)}catch{return""+t}}function qa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Cs[e.v]||e.v:t==null?y1(e,e.v):y1(e,t))}function Di(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Q2(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?qr(n.origin):n.origin;o=u.r,l=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=Gt(i["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(d.e.r=o=h.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var x={v:t[m][g]},_=o+m,y=l+g;if(d.s.r>_&&(d.s.r=_),d.s.c>y&&(d.s.c=y),d.e.r<_&&(d.e.r=_),d.e.c<y&&(d.e.c=y),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))x=t[m][g];else if(Array.isArray(x.v)&&(x.f=t[m][g][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||nt[14],n.cellDates?(x.t="d",x.w=jn(x.z,Kr(x.v))):(x.t="n",x.v=Kr(x.v),x.w=jn(x.z,x.v))):x.t="s";if(a)i[_]||(i[_]=[]),i[_][y]&&i[_][y].z&&(x.z=i[_][y].z),i[_][y]=x;else{var E=et({c:y,r:_});i[E]&&i[E].z&&(x.z=i[E].z),i[E]=x}}}return d.s.c<1e7&&(i["!ref"]=gt(d)),i}function Mo(e,t){return Q2(null,e,t)}function MN(e){return e.read_shift(4,"i")}function Br(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function jN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function cm(e,t){var r=e.l,n=e.read_shift(1),a=Br(e),i=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)i.push(jN(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var RN=cm;function Rn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ss(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var DN=Br;function um(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var IN=Br,Ch=um;function fm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?wf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):qi(t,0)>>2;return r?a/100:a}function ew(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ts=ew;function Dr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function BN(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=os[a];d&&(t.rgb=ec(d));break;case 2:t.rgb=ec([o,l,u]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function zN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function tw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function UN(e){return tw(e,1)}function HN(e){return tw(e,2)}var dm=2,tn=3,cu=11,w1=12,kf=19,uu=64,VN=65,WN=71,$N=4108,GN=4126,hr=80,rw=81,ZN=[hr,rw],qN={1:{n:"CodePage",t:dm},2:{n:"Category",t:hr},3:{n:"PresentationFormat",t:hr},4:{n:"ByteCount",t:tn},5:{n:"LineCount",t:tn},6:{n:"ParagraphCount",t:tn},7:{n:"SlideCount",t:tn},8:{n:"NoteCount",t:tn},9:{n:"HiddenCount",t:tn},10:{n:"MultimediaClipCount",t:tn},11:{n:"ScaleCrop",t:cu},12:{n:"HeadingPairs",t:$N},13:{n:"TitlesOfParts",t:GN},14:{n:"Manager",t:hr},15:{n:"Company",t:hr},16:{n:"LinksUpToDate",t:cu},17:{n:"CharacterCount",t:tn},19:{n:"SharedDoc",t:cu},22:{n:"HyperlinksChanged",t:cu},23:{n:"AppVersion",t:tn,p:"version"},24:{n:"DigSig",t:VN},26:{n:"ContentType",t:hr},27:{n:"ContentStatus",t:hr},28:{n:"Language",t:hr},29:{n:"Version",t:hr},255:{},2147483648:{n:"Locale",t:kf},2147483651:{n:"Behavior",t:kf},1919054434:{}},XN={1:{n:"CodePage",t:dm},2:{n:"Title",t:hr},3:{n:"Subject",t:hr},4:{n:"Author",t:hr},5:{n:"Keywords",t:hr},6:{n:"Comments",t:hr},7:{n:"Template",t:hr},8:{n:"LastAuthor",t:hr},9:{n:"RevNumber",t:hr},10:{n:"EditTime",t:uu},11:{n:"LastPrinted",t:uu},12:{n:"CreatedDate",t:uu},13:{n:"ModifiedDate",t:uu},14:{n:"PageCount",t:tn},15:{n:"WordCount",t:tn},16:{n:"CharCount",t:tn},17:{n:"Thumbnail",t:WN},18:{n:"Application",t:hr},19:{n:"DocSecurity",t:tn},255:{},2147483648:{n:"Locale",t:kf},2147483651:{n:"Behavior",t:kf},1919054434:{}},k1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},YN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function KN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var JN=KN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),os=Tr(JN),Cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},E1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function QN(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function eA(e){var t=QN();if(!e||!e.match)return t;var r={};if((e.match(Hr)||[]).forEach(function(n){var a=Ye(n);switch(a[0].replace(lN,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[E1[a.ContentType]]!==void 0&&t[E1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==_N.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var to={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function bh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Tl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Hr)||[]).forEach(function(a){var i=Ye(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:ul(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}var tA="application/vnd.oasis.opendocument.spreadsheet";function rA(e,t){for(var r=im(e),n,a;n=Jl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ye(n[0],!1),a.path=="/"&&a.type!==tA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Cl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],nA=function(){for(var e=new Array(Cl.length),t=0;t<Cl.length;++t){var r=Cl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function aw(e){var t={};e=At(e);for(var r=0;r<Cl.length;++r){var n=Cl[r],a=e.match(nA[r]);a!=null&&a.length>0&&(t[n[1]]=vt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=gr(t[n[1]]))}return t}var aA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function iw(e,t,r,n){var a=[];if(typeof e=="string")a=h1(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var o=typeof t=="string"?h1(t,n).map(function(h){return h.v}):t,l=0,u=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(u=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function iA(e,t,r){var n={};return t||(t={}),e=At(e),aA.forEach(function(a){var i=(e.match(Kl(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=vt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&iw(n.HeadingPairs,n.TitlesOfParts,t,r),t}var sA=/<[^>]+>[^<]*/g;function oA(e,t){var r={},n="",a=e.match(sA);if(a)for(var i=0;i!=a.length;++i){var o=a[i],l=Ye(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=vt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),d=u[0].slice(4),h=u[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=vt(h);break;case"bool":r[n]=jt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=gr(h);break;case"cy":case"error":r[n]=vt(h);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var lA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dd;function cA(e,t,r){dd||(dd=rm(lA)),t=dd[t]||t,e[t]=r}function hm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function sw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function ow(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function lw(e,t,r){return t===31?ow(e):sw(e,t,r)}function Nh(e,t,r){return lw(e,t,r===!1?0:4)}function uA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return lw(e,t,0)}function fA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Yr,""),e.l-a&2&&(e.l+=2)}return r}function dA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Yr,"");return r}function hA(e){var t=e.l,r=Ef(e,rw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ef(e,tn);return[r,n]}function pA(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(hA(e));return r}function S1(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Yr,"").replace(cl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function cw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function mA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ef(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==w1&&n!==t&&ZN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===w1?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return sw(e,n,4).replace(Yr,"");case 31:return ow(e);case 64:return hm(e);case 65:return cw(e);case 71:return mA(e);case 80:return Nh(e,n,!i.raw).replace(Yr,"");case 81:return uA(e,n).replace(Yr,"");case 4108:return pA(e);case 4126:case 4127:return n==4127?fA(e):dA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function T1(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,l=0,u=-1,d={};for(o=0;o!=a;++o){var h=e.read_shift(4),m=e.read_shift(4);i[o]=[h,m+r]}i.sort(function(S,w){return S[1]-w[1]});var g={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var x=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(x=!1,e.l=i[o][1]),x)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var _=t[i[o][0]];if(g[_.n]=Ef(e,_.t,{raw:!0}),_.p==="version"&&(g[_.n]=String(g[_.n]>>16)+"."+("0000"+String(g[_.n]&65535)).slice(-4)),_.n=="CodePage")switch(g[_.n]){case 0:g[_.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qn(l=g[_.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[_.n])}}else if(i[o][0]===1){if(l=g.CodePage=Ef(e,dm),qn(l),u!==-1){var y=e.l;e.l=i[u][1],d=S1(e,l),e.l=y}}else if(i[o][0]===0){if(l===0){u=o,e.l=i[o+1][1];continue}d=S1(e,l)}else{var E=d[i[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=cw(e);break;case 30:e.l+=4,k=Nh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Nh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=qt(e,4);break;case 64:e.l+=4,k=gr(hm(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[E]=k}}return e.l=r+n,g}function C1(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var a,i,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==mt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=T1(n,t),g={SystemIdentifier:d};for(var x in m)g[x]=m[x];if(g.FMTID=i,a===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var _;try{_=T1(n,null)}catch{}for(x in _)g[x]=_[x];return g.FMTID=[i,o],g}function ai(e,t){return e.read_shift(t),null}function gA(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function qt(e,t){return e.read_shift(t)===1}function rr(e){return e.read_shift(2,"u")}function uw(e,t){return gA(e,t,rr)}function xA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function vc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function vA(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,l,u={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*o),n&&(e.l+=l),u.t=h,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function vs(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function _c(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vs(e,n,r)}function bs(e,t,r){if(r.biff>5)return _c(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function _A(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function yA(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Yr,"");return n&&(e.l+=24),a}function wA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Yr,"");return r+o}function kA(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return yA(e);case"0303000000000000c000000000000046":return wA(e);default:throw new Error("Unsupported Moniker "+r)}}function fu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Yr,""):"";return r}function EA(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,l,u,d="",h,m;a&16&&(i=fu(e,r-e.l)),a&128&&(o=fu(e,r-e.l)),(a&257)===257&&(l=fu(e,r-e.l)),(a&257)===1&&(u=kA(e,r-e.l)),a&8&&(d=fu(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(m=hm(e)),e.l=r;var g=o||l||u||"";g&&d&&(g+="#"+d),g||(g="#"+d),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var x={Target:g};return h&&(x.guid=h),m&&(x.time=m),i&&(x.Tooltip=i),x}function fw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function dw(e,t){var r=fw(e);return r[3]=0,r}function ka(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function SA(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function TA(e,t,r){return t===0?"":bs(e,t,r)}function CA(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function hw(e){var t=e.read_shift(2),r=fm(e);return[t,r]}function bA(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=vc(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function r0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function pw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var NA=pw;function mw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function AA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function LA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Or(e){e.l+=2,e.l+=e.read_shift(2)}var PA={0:Or,4:Or,5:Or,6:Or,7:LA,8:Or,9:Or,10:Or,11:Or,12:Or,13:AA,14:Or,15:Or,16:Or,17:Or,18:Or,19:Or,20:Or,21:mw};function FA(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(PA[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function du(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function OA(e,t){return t===0||e.read_shift(2),1200}function MA(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=bs(e,0,r);return e.read_shift(t+n-e.l),a}function jA(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function RA(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=vc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function DA(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(vA(e));return i.Count=n,i.Unique=a,i}function IA(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function BA(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function zA(e){var t=SA(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function UA(e){return e.read_shift(2),e.read_shift(4)}function b1(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function HA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:l,Selected:u,TabRatio:d}}function VA(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function WA(){}function $A(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=vc(e,0,r),n}function GA(e){var t=ka(e);return t.isst=e.read_shift(4),t}function ZA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=ka(e);r.biff==2&&e.l++;var i=_c(e,n-e.l,r);return a.val=i,a}function qA(e,t,r){var n=e.read_shift(2),a=bs(e,0,r);return[n,a]}var XA=bs;function N1(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c:u}}}function YA(e){var t=e.read_shift(2),r=e.read_shift(2),n=hw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function KA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(hw(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function JA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function QA(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return a.patternType=YN[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function e5(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=QA(e,t,n.fStyle,r),n}function t5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function A1(e,t,r){var n=ka(e);(r.biff==2||t==9)&&++e.l;var a=xA(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function r5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ka(e),a=Dr(e);return n.val=a,n}var L1=TA;function n5(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=vs(e,i),l=[];n>e.l;)l.push(_c(e));return[i,a,o,l]}function P1(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=bA(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var a5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function F1(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=vs(e,o,r);a&32&&(d=a5[d.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var m=n==e.l||l===0||!(h>0)?[]:BP(e,h,r,l);return{chKey:i,Name:d,itab:u,rgce:m}}function gw(e,t,r){if(r.biff<8)return i5(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(CA(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function i5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=vc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function s5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=vs(e,n,r),o=vs(e,a,r);return[i,o]}function o5(e,t,r){var n=pw(e);e.l++;var a=e.read_shift(1);return t-=8,[zP(e,t,r),a,n]}function O1(e,t,r){var n=NA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,DP(e,t,r)]}function l5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function c5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=bs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,i]}}function u5(e,t,r){return c5(e,t,r)}function f5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(r0(e));return r}function d5(e,t,r){if(r&&r.biff<8)return p5(e,t,r);var n=mw(e),a=FA(e,t-22,n[1]);return{cmo:n,ft:a}}var h5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function p5(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((h5[n]||Ur)(e,t,r)),{cmo:[a,n,i],ft:o}}function m5(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=_A(e,6,r);var l=e.read_shift(2);e.read_shift(2),rr(e,2);var u=e.read_shift(2);e.l+=u;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],m=vs(e,e.lens[d+1]-e.lens[d]-1);if(a+=m,a.length>=(h?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function g5(e,t){var r=r0(e);e.l+=16;var n=EA(e,t-24);return[r,n]}function x5(e,t){e.read_shift(2);var r=r0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Yr,""),[r,n]}function v5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=k1[r]||r,r=e.read_shift(2),t[1]=k1[r]||r,t}function _5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dw(e));return r}function y5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dw(e));return r}function w5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function xw(e,t,r){if(!r.cellStyles)return Ur(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(d.level=u>>8&7),d}function k5(e,t){var r={};return t<32||(e.l+=16,r.header=Dr(e),r.footer=Dr(e),e.l+=2),r}function E5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var S5=ka,T5=uw,C5=_c;function b5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function N5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ka(e);++e.l;var a=bs(e,t-7,r);return n.t="str",n.val=a,n}function A5(e){var t=ka(e);++e.l;var r=Dr(e);return t.t="n",t.val=r,t}function L5(e){var t=ka(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function P5(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function F5(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function O5(e,t,r){var n=e.l+t,a=ka(e),i=e.read_shift(2),o=vs(e,i,r);return e.l=n,a.t="str",a.val=o,a}var M5=[2,3,48,49,131,139,140,245],M1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var d=[],h=Pi(1);switch(u.type){case"base64":h=Zn(gn(l));break;case"binary":h=Zn(l);break;case"buffer":case"array":h=l;break}wr(h,0);var m=h.read_shift(1),g=!!(m&136),x=!1,_=!1;switch(m){case 2:break;case 3:break;case 48:x=!0,g=!0;break;case 49:x=!0,g=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,E=521;m==2&&(y=h.read_shift(2)),h.l+=3,m!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(E=h.read_shift(2));var k=h.read_shift(2),S=u.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=e[h[h.l]]),h.l+=1,h.l+=2),_&&(h.l+=36);for(var w=[],A={},D=Math.min(h.length,m==2?521:E-10-(x?264:0)),R=_?32:11;h.l<D&&h[h.l]!=13;)switch(A={},A.name=ui.utils.decode(S,h.slice(h.l,h.l+R)).replace(/[\u0000\r\n].*$/g,""),h.l+=R,A.type=String.fromCharCode(h.read_shift(1)),m!=2&&!_&&(A.offset=h.read_shift(4)),A.len=h.read_shift(1),m==2&&(A.offset=h.read_shift(2)),A.dec=h.read_shift(1),A.name.length&&w.push(A),m!=2&&(h.l+=_?13:14),A.type){case"B":(!x||A.len!=8)&&u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var P=0,H=0;for(d[0]=[],H=0;H!=w.length;++H)d[0][H]=w[H].name;for(;y-- >0;){if(h[h.l]===42){h.l+=k;continue}for(++h.l,d[++P]=[],H=0,H=0;H!=w.length;++H){var B=h.slice(h.l,h.l+w[H].len);h.l+=w[H].len,wr(B,0);var W=ui.utils.decode(S,B);switch(w[H].type){case"C":W.trim().length&&(d[P][H]=W.replace(/\s+$/,""));break;case"D":W.length===8?d[P][H]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):d[P][H]=W;break;case"F":d[P][H]=parseFloat(W.trim());break;case"+":case"I":d[P][H]=_?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":d[P][H]=!0;break;case"N":case"F":d[P][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[P][H]="##MEMO##"+(_?parseInt(W.trim(),10):B.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(d[P][H]=+W||0);break;case"@":d[P][H]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":d[P][H]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":d[P][H]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[P][H]=-B.read_shift(-8,"f");break;case"B":if(x&&w[H].len==8){d[P][H]=B.read_shift(8,"f");break}case"G":case"P":B.l+=w[H].len;break;case"0":if(w[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[H].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(d=d.slice(0,u.sheetRows)),u.DBF=w,d}function n(l,u){var d=u||{};d.dateNF||(d.dateNF="yyyymmdd");var h=Mo(r(l,d),d);return h["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,h}function a(l,u){try{return Di(n(l,u),u)}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var d=u||{};if(+d.codepage>=0&&qn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=Th(),m=jh(l,{header:1,raw:!0,cellDates:!0}),g=m[0],x=m.slice(1),_=l["!cols"]||[],y=0,E=0,k=0,S=1;for(y=0;y<g.length;++y){if(((_[y]||{}).DBF||{}).name){g[y]=_[y].DBF.name,++k;continue}if(g[y]!=null){if(++k,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(E=0;E<1024;++E)if(g.indexOf(g[y]+"_"+E)==-1){g[y]+="_"+E;break}}}}var w=Gt(l["!ref"]),A=[],D=[],R=[];for(y=0;y<=w.e.c-w.s.c;++y){var P="",H="",B=0,W=[];for(E=0;E<x.length;++E)x[E][y]!=null&&W.push(x[E][y]);if(W.length==0||g[y]==null){A[y]="?";continue}for(E=0;E<W.length;++E){switch(typeof W[E]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=W[E]instanceof Date?"D":"C";break;default:H="C"}B=Math.max(B,String(W[E]).length),P=P&&P!=H?"C":H}B>250&&(B=250),H=((_[y]||{}).DBF||{}).type,H=="C"&&_[y].DBF.len>B&&(B=_[y].DBF.len),P=="B"&&H=="N"&&(P="N",R[y]=_[y].DBF.dec,B=_[y].DBF.len),D[y]=P=="C"||H=="N"?B:i[P]||0,S+=D[y],A[y]=P}var I=h.next(32);for(I.write_shift(4,318902576),I.write_shift(4,x.length),I.write_shift(2,296+32*k),I.write_shift(2,S),y=0;y<4;++y)I.write_shift(4,0);for(I.write_shift(4,0|(+t[g2]||3)<<8),y=0,E=0;y<g.length;++y)if(g[y]!=null){var Z=h.next(32),J=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,J,"sbcs"),Z.write_shift(1,A[y]=="?"?"C":A[y],"sbcs"),Z.write_shift(4,E),Z.write_shift(1,D[y]||i[A[y]]||0),Z.write_shift(1,R[y]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),E+=D[y]||i[A[y]]||0}var ge=h.next(264);for(ge.write_shift(4,13),y=0;y<65;++y)ge.write_shift(4,0);for(y=0;y<x.length;++y){var _e=h.next(S);for(_e.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(A[E]){case"L":_e.write_shift(1,x[y][E]==null?63:x[y][E]?84:70);break;case"B":_e.write_shift(8,x[y][E]||0,"f");break;case"N":var de="0";for(typeof x[y][E]=="number"&&(de=x[y][E].toFixed(R[E]||0)),k=0;k<D[E]-de.length;++k)_e.write_shift(1,32);_e.write_shift(1,de,"sbcs");break;case"D":x[y][E]?(_e.write_shift(4,("0000"+x[y][E].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(x[y][E].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+x[y][E].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(x[y][E]!=null?x[y][E]:"").slice(0,D[E]);for(_e.write_shift(1,Q,"sbcs"),k=0;k<D[E]-Q.length;++k)_e.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),j5=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+_a(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,x){var _=e[x];return typeof _=="number"?Yx(_):_},n=function(g,x,_){var y=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return y==59?g:Yx(y)};e["|"]=254;function a(g,x){switch(x.type){case"base64":return i(gn(g),x);case"binary":return i(g,x);case"buffer":return i(ut&&Buffer.isBuffer(g)?g.toString("binary"):Es(g),x);case"array":return i(xs(g),x)}throw new Error("Unrecognized type "+x.type)}function i(g,x){var _=g.split(/[\n\r]+/),y=-1,E=-1,k=0,S=0,w=[],A=[],D=null,R={},P=[],H=[],B=[],W=0,I;for(+x.codepage>=0&&qn(+x.codepage);k!==_.length;++k){W=0;var Z=_[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),J=Z.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),ge=J[0],_e;if(Z.length>0)switch(ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&A.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,Q=!1,ee=!1,U=!1,ne=-1,ue=-1;for(S=1;S<J.length;++S)switch(J[S].charAt(0)){case"A":break;case"X":E=parseInt(J[S].slice(1))-1,Q=!0;break;case"Y":for(y=parseInt(J[S].slice(1))-1,Q||(E=0),I=w.length;I<=y;++I)w[I]=[];break;case"K":_e=J[S].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Jn(_e))?isNaN(Eo(_e).getDate())||(_e=gr(_e)):(_e=Jn(_e),D!==null&&Fo(D)&&(_e=t0(_e))),de=!0;break;case"E":U=!0;var F=fo(J[S].slice(1),{r:y,c:E});w[y][E]=[w[y][E],F];break;case"S":ee=!0,w[y][E]=[w[y][E],"S5S"];break;case"G":break;case"R":ne=parseInt(J[S].slice(1))-1;break;case"C":ue=parseInt(J[S].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Z)}if(de&&(w[y][E]&&w[y][E].length==2?w[y][E][0]=_e:w[y][E]=_e,D=null),ee){if(U)throw new Error("SYLK shared formula cannot have own formula");var te=ne>-1&&w[ne][ue];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");w[y][E][1]=bw(te[1],{r:y-ne,c:E-ue})}break;case"F":var q=0;for(S=1;S<J.length;++S)switch(J[S].charAt(0)){case"X":E=parseInt(J[S].slice(1))-1,++q;break;case"Y":for(y=parseInt(J[S].slice(1))-1,I=w.length;I<=y;++I)w[I]=[];break;case"M":W=parseInt(J[S].slice(1))/20;break;case"F":break;case"G":break;case"P":D=A[parseInt(J[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=J[S].slice(1).split(" "),I=parseInt(B[0],10);I<=parseInt(B[1],10);++I)W=parseInt(B[2],10),H[I-1]=W===0?{hidden:!0}:{wch:W},So(H[I-1]);break;case"C":E=parseInt(J[S].slice(1))-1,H[E]||(H[E]={});break;case"R":y=parseInt(J[S].slice(1))-1,P[y]||(P[y]={}),W>0?(P[y].hpt=W,P[y].hpx=tc(W)):W===0&&(P[y].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Z)}q<1&&(D=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Z)}}return P.length>0&&(R["!rows"]=P),H.length>0&&(R["!cols"]=H),x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),[w,R]}function o(g,x){var _=a(g,x),y=_[0],E=_[1],k=Mo(y,x);return _a(E).forEach(function(S){k[S]=E[S]}),k}function l(g,x){return Di(o(g,x),x)}function u(g,x,_,y){var E="C;Y"+(_+1)+";X"+(y+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+w6(g.f,{r:_,c:y}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function d(g,x){x.forEach(function(_,y){var E="F;W"+(y+1)+" "+(y+1)+" ";_.hidden?E+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Tf(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Cf(_.wpx)),typeof _.wch=="number"&&(E+=Math.round(_.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function h(g,x){x.forEach(function(_,y){var E="F;";_.hidden?E+="M0;":_.hpt?E+="M"+20*_.hpt+";":_.hpx&&(E+="M"+20*Sw(_.hpx)+";"),E.length>2&&g.push(E+"R"+(y+1))})}function m(g,x){var _=["ID;PWXL;N;E"],y=[],E=Gt(g["!ref"]),k,S=Array.isArray(g),w=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),g["!cols"]&&d(_,g["!cols"]),g["!rows"]&&h(_,g["!rows"]),_.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var A=E.s.r;A<=E.e.r;++A)for(var D=E.s.c;D<=E.e.c;++D){var R=et({r:A,c:D});k=S?(g[A]||[])[D]:g[R],!(!k||k.v==null&&(!k.f||k.F))&&y.push(u(k,g,A,D))}return _.join(w)+w+y.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),R5=function(){function e(i,o){switch(o.type){case"base64":return t(gn(i),o);case"binary":return t(i,o);case"buffer":return t(ut&&Buffer.isBuffer(i)?i.toString("binary"):Es(i),o);case"array":return t(xs(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),u=-1,d=-1,h=0,m=[];h!==l.length;++h){if(l[h].trim()==="BOT"){m[++u]=[],d=0;continue}if(!(u<0)){var g=l[h].trim().split(","),x=g[0],_=g[1];++h;for(var y=l[h]||"";(y.match(/["]/g)||[]).length&1&&h<l.length-1;)y+=`
`+l[++h];switch(y=y.trim(),+x){case-1:if(y==="BOT"){m[++u]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[u][d]=!0:y==="FALSE"?m[u][d]=!1:isNaN(Jn(_))?isNaN(Eo(_).getDate())?m[u][d]=_:m[u][d]=gr(_):m[u][d]=Jn(_),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[u][d++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return Mo(e(i,o),o)}function n(i,o){return Di(r(i,o),o)}var a=function(){var i=function(u,d,h,m,g){u.push(d),u.push(h+","+m),u.push('"'+g.replace(/"/g,'""')+'"')},o=function(u,d,h,m){u.push(d+","+h),u.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var d=[],h=Gt(u["!ref"]),m,g=Array.isArray(u);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,h.e.r-h.s.r+1,""),i(d,"TUPLES",0,h.e.c-h.s.c+1,""),i(d,"DATA",0,0,"");for(var x=h.s.r;x<=h.e.r;++x){o(d,-1,0,"BOT");for(var _=h.s.c;_<=h.e.c;++_){var y=et({r:x,c:_});if(m=g?(u[x]||[])[_]:u[y],!m){o(d,1,0,"");continue}switch(m.t){case"n":var E=m.w;!E&&m.v!=null&&(E=m.v),E==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,E,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=jn(m.z||nt[14],Kr(gr(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var k=`\r
`,S=d.join(k);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),D5=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var x=m.split(`
`),_=-1,y=-1,E=0,k=[];E!==x.length;++E){var S=x[E].trim().split(":");if(S[0]==="cell"){var w=qr(S[1]);if(k.length<=w.r)for(_=k.length;_<=w.r;++_)k[_]||(k[_]=[]);switch(_=w.r,y=w.c,S[2]){case"t":k[_][y]=e(S[3]);break;case"v":k[_][y]=+S[3];break;case"vtf":var A=S[S.length-1];case"vtc":switch(S[3]){case"nl":k[_][y]=!!+S[4];break;default:k[_][y]=+S[4];break}S[2]=="vtf"&&(k[_][y]=[k[_][y],A])}}}return g&&g.sheetRows&&(k=k.slice(0,g.sheetRows)),k}function n(m,g){return Mo(r(m,g),g)}function a(m,g){return Di(n(m,g),g)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var g=[],x=[],_,y="",E=Oo(m["!ref"]),k=Array.isArray(m),S=E.s.r;S<=E.e.r;++S)for(var w=E.s.c;w<=E.e.c;++w)if(y=et({r:S,c:w}),_=k?(m[S]||[])[w]:m[y],!(!_||_.v==null||_.t==="z")){switch(x=["cell",y,"t"],_.t){case"s":case"str":x.push(t(_.v));break;case"n":_.f?(x[2]="vtf",x[3]="n",x[4]=_.v,x[5]=t(_.f)):(x[2]="v",x[3]=_.v);break;case"b":x[2]="vt"+(_.f?"f":"c"),x[3]="nl",x[4]=_.v?"1":"0",x[5]=t(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var A=Kr(gr(_.v));x[2]="vtc",x[3]="nd",x[4]=""+A,x[5]=_.w||jn(_.z||nt[14],A);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(m){return[i,o,l,o,d(m),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),Ql=function(){function e(h,m,g,x,_){_.raw?m[g][x]=h:h===""||(h==="TRUE"?m[g][x]=!0:h==="FALSE"?m[g][x]=!1:isNaN(Jn(h))?isNaN(Eo(h).getDate())?m[g][x]=h:m[g][x]=gr(h):m[g][x]=Jn(h))}function t(h,m){var g=m||{},x=[];if(!h||h.length===0)return x;for(var _=h.split(/[\r\n]/),y=_.length-1;y>=0&&_[y].length===0;)--y;for(var E=10,k=0,S=0;S<=y;++S)k=_[S].indexOf(" "),k==-1?k=_[S].length:k++,E=Math.max(E,k);for(S=0;S<=y;++S){x[S]=[];var w=0;for(e(_[S].slice(0,E).trim(),x,S,w,g),w=1;w<=(_[S].length-E)/10+1;++w)e(_[S].slice(E+(w-1)*10,E+w*10).trim(),x,S,w,g)}return g.sheetRows&&(x=x.slice(0,g.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var m={},g=!1,x=0,_=0;x<h.length;++x)(_=h.charCodeAt(x))==34?g=!g:!g&&_ in r&&(m[_]=(m[_]||0)+1);_=[];for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&_.push([m[x],x]);if(!_.length){m=n;for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&_.push([m[x],x])}return _.sort(function(y,E){return y[0]-E[0]||n[y[1]]-n[E[1]]}),r[_.pop()[1]]||44}function i(h,m){var g=m||{},x="",_=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(x=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(x=h.charAt(4),h=h.slice(6)):x=a(h.slice(0,1024)):g&&g.FS?x=g.FS:x=a(h.slice(0,1024));var E=0,k=0,S=0,w=0,A=0,D=x.charCodeAt(0),R=!1,P=0,H=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var B=g.dateNF!=null?qb(g.dateNF):null;function W(){var I=h.slice(w,A),Z={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)Z.t="z";else if(g.raw)Z.t="s",Z.v=I;else if(I.trim().length===0)Z.t="s",Z.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(Z.t="s",Z.v=I.slice(2,-1).replace(/""/g,'"')):E6(I)?(Z.t="n",Z.f=I.slice(1)):(Z.t="s",Z.v=I);else if(I=="TRUE")Z.t="b",Z.v=!0;else if(I=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(S=Jn(I)))Z.t="n",g.cellText!==!1&&(Z.w=I),Z.v=S;else if(!isNaN(Eo(I).getDate())||B&&I.match(B)){Z.z=g.dateNF||nt[14];var J=0;B&&I.match(B)&&(I=Xb(I,g.dateNF,I.match(B)||[]),J=1),g.cellDates?(Z.t="d",Z.v=gr(I,J)):(Z.t="n",Z.v=Kr(gr(I,J))),g.cellText!==!1&&(Z.w=jn(Z.z,Z.v instanceof Date?Kr(Z.v):Z.v)),g.cellNF||delete Z.z}else Z.t="s",Z.v=I;if(Z.t=="z"||(g.dense?(_[E]||(_[E]=[]),_[E][k]=Z):_[et({c:k,r:E})]=Z),w=A+1,H=h.charCodeAt(w),y.e.c<k&&(y.e.c=k),y.e.r<E&&(y.e.r=E),P==D)++k;else if(k=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;A<h.length;++A)switch(P=h.charCodeAt(A)){case 34:H===34&&(R=!R);break;case D:case 10:case 13:if(!R&&W())break e;break}return A-w>0&&W(),_["!ref"]=gt(y),_}function o(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,m):Mo(t(h,m),m)}function l(h,m){var g="",x=m.type=="string"?[0,0,0,0]:wm(h,m);switch(m.type){case"base64":g=gn(h);break;case"binary":g=h;break;case"buffer":m.codepage==65001?g=h.toString("utf8"):m.codepage&&typeof ui<"u"?g=ui.utils.decode(m.codepage,h):g=ut&&Buffer.isBuffer(h)?h.toString("binary"):Es(h);break;case"array":g=xs(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+m.type)}return x[0]==239&&x[1]==187&&x[2]==191?g=At(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=At(g):m.type=="binary"&&typeof ui<"u"&&m.codepage&&(g=ui.utils.decode(m.codepage,ui.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?D5.to_sheet(m.type=="string"?g:At(g),m):o(g,m)}function u(h,m){return Di(l(h,m),m)}function d(h){for(var m=[],g=Gt(h["!ref"]),x,_=Array.isArray(h),y=g.s.r;y<=g.e.r;++y){for(var E=[],k=g.s.c;k<=g.e.c;++k){var S=et({r:y,c:k});if(x=_?(h[y]||[])[k]:h[S],!x||x.v==null){E.push("          ");continue}for(var w=(x.w||(qa(x),x.w)||"").slice(0,10);w.length<10;)w+=" ";E.push(w+(k===0?" ":""))}m.push(E.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:d}}();function I5(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=j5.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Ql.to_workbook(e,t)}}var bl=function(){function e(F,te,q){if(F){wr(F,F.l||0);for(var X=q.Enum||ne;F.l<F.length;){var K=F.read_shift(2),ye=X[K]||X[65535],Le=F.read_shift(2),be=F.l+Le,ke=ye.f&&ye.f(F,Le,q);if(F.l=be,te(ke,ye,K))return}}}function t(F,te){switch(te.type){case"base64":return r(Zn(gn(F)),te);case"binary":return r(Zn(F),te);case"buffer":case"array":return r(F,te)}throw"Unsupported type "+te.type}function r(F,te){if(!F)return F;var q=te||{},X=q.dense?[]:{},K="Sheet1",ye="",Le=0,be={},ke=[],$e=[],G={s:{r:0,c:0},e:{r:0,c:0}},ot=q.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)q.Enum=ne,e(F,function(he,Ue,We){switch(We){case 0:q.vers=he,he>=4096&&(q.qpro=!0);break;case 6:G=he;break;case 204:he&&(ye=he);break;case 222:ye=he;break;case 15:case 51:q.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:We==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=q.dateNF||nt[14],q.cellDates&&(he[1].t="d",he[1].v=t0(he[1].v))),q.qpro&&he[3]>Le&&(X["!ref"]=gt(G),be[K]=X,ke.push(K),X=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Le=he[3],K=ye||"Sheet"+(Le+1),ye="");var yt=q.dense?(X[he[0].r]||[])[he[0].c]:X[et(he[0])];if(yt){yt.t=he[1].t,yt.v=he[1].v,he[1].z!=null&&(yt.z=he[1].z),he[1].f!=null&&(yt.f=he[1].f);break}q.dense?(X[he[0].r]||(X[he[0].r]=[]),X[he[0].r][he[0].c]=he[1]):X[et(he[0])]=he[1];break}},q);else if(F[2]==26||F[2]==14)q.Enum=ue,F[2]==14&&(q.qpro=!0,F.l=0),e(F,function(he,Ue,We){switch(We){case 204:K=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>Le&&(X["!ref"]=gt(G),be[K]=X,ke.push(K),X=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Le=he[3],K="Sheet"+(Le+1)),ot>0&&he[0].r>=ot)break;q.dense?(X[he[0].r]||(X[he[0].r]=[]),X[he[0].r][he[0].c]=he[1]):X[et(he[0])]=he[1],G.e.c<he[0].c&&(G.e.c=he[0].c),G.e.r<he[0].r&&(G.e.r=he[0].r);break;case 27:he[14e3]&&($e[he[14e3][0]]=he[14e3][1]);break;case 1537:$e[he[0]]=he[1],he[0]==Le&&(K=he[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(X["!ref"]=gt(G),be[ye||K]=X,ke.push(ye||K),!$e.length)return{SheetNames:ke,Sheets:be};for(var me={},Te=[],Pe=0;Pe<$e.length;++Pe)be[ke[Pe]]?(Te.push($e[Pe]||ke[Pe]),me[$e[Pe]]=be[$e[Pe]]||be[ke[Pe]]):(Te.push($e[Pe]),me[$e[Pe]]={"!ref":"A1"});return{SheetNames:Te,Sheets:me}}function n(F,te){var q=te||{};if(+q.codepage>=0&&qn(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Th(),K=Gt(F["!ref"]),ye=Array.isArray(F),Le=[];Vn(X,0,i(1030)),Vn(X,6,u(K));for(var be=Math.min(K.e.r,8191),ke=K.s.r;ke<=be;++ke)for(var $e=Cr(ke),G=K.s.c;G<=K.e.c;++G){ke===K.s.r&&(Le[G]=lr(G));var ot=Le[G]+$e,me=ye?(F[ke]||[])[G]:F[ot];if(!(!me||me.t=="z"))if(me.t=="n")(me.v|0)==me.v&&me.v>=-32768&&me.v<=32767?Vn(X,13,x(ke,G,me.v)):Vn(X,14,y(ke,G,me.v));else{var Te=qa(me);Vn(X,15,m(ke,G,Te.slice(0,239)))}}return Vn(X,1),X.end()}function a(F,te){var q=te||{};if(+q.codepage>=0&&qn(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Th();Vn(X,0,o(F));for(var K=0,ye=0;K<F.SheetNames.length;++K)(F.Sheets[F.SheetNames[K]]||{})["!ref"]&&Vn(X,27,U(F.SheetNames[K],ye++));var Le=0;for(K=0;K<F.SheetNames.length;++K){var be=F.Sheets[F.SheetNames[K]];if(!(!be||!be["!ref"])){for(var ke=Gt(be["!ref"]),$e=Array.isArray(be),G=[],ot=Math.min(ke.e.r,8191),me=ke.s.r;me<=ot;++me)for(var Te=Cr(me),Pe=ke.s.c;Pe<=ke.e.c;++Pe){me===ke.s.r&&(G[Pe]=lr(Pe));var he=G[Pe]+Te,Ue=$e?(be[me]||[])[Pe]:be[he];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")Vn(X,23,W(me,Pe,Le,Ue.v));else{var We=qa(Ue);Vn(X,22,P(me,Pe,Le,We.slice(0,239)))}}++Le}}return Vn(X,1),X.end()}function i(F){var te=ir(2);return te.write_shift(2,F),te}function o(F){var te=ir(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var q=0,X=0,K=0,ye=0;ye<F.SheetNames.length;++ye){var Le=F.SheetNames[ye],be=F.Sheets[Le];if(!(!be||!be["!ref"])){++K;var ke=Oo(be["!ref"]);q<ke.e.r&&(q=ke.e.r),X<ke.e.c&&(X=ke.e.c)}}return q>8191&&(q=8191),te.write_shift(2,q),te.write_shift(1,K),te.write_shift(1,X),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function l(F,te,q){var X={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&q.qpro?(X.s.c=F.read_shift(1),F.l++,X.s.r=F.read_shift(2),X.e.c=F.read_shift(1),F.l++,X.e.r=F.read_shift(2),X):(X.s.c=F.read_shift(2),X.s.r=F.read_shift(2),te==12&&q.qpro&&(F.l+=2),X.e.c=F.read_shift(2),X.e.r=F.read_shift(2),te==12&&q.qpro&&(F.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function u(F){var te=ir(8);return te.write_shift(2,F.s.c),te.write_shift(2,F.s.r),te.write_shift(2,F.e.c),te.write_shift(2,F.e.r),te}function d(F,te,q){var X=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(X[0].c=F.read_shift(1),X[3]=F.read_shift(1),X[0].r=F.read_shift(2),F.l+=2):(X[2]=F.read_shift(1),X[0].c=F.read_shift(2),X[0].r=F.read_shift(2)),X}function h(F,te,q){var X=F.l+te,K=d(F,te,q);if(K[1].t="s",q.vers==20768){F.l++;var ye=F.read_shift(1);return K[1].v=F.read_shift(ye,"utf8"),K}return q.qpro&&F.l++,K[1].v=F.read_shift(X-F.l,"cstr"),K}function m(F,te,q){var X=ir(7+q.length);X.write_shift(1,255),X.write_shift(2,te),X.write_shift(2,F),X.write_shift(1,39);for(var K=0;K<X.length;++K){var ye=q.charCodeAt(K);X.write_shift(1,ye>=128?95:ye)}return X.write_shift(1,0),X}function g(F,te,q){var X=d(F,te,q);return X[1].v=F.read_shift(2,"i"),X}function x(F,te,q){var X=ir(7);return X.write_shift(1,255),X.write_shift(2,te),X.write_shift(2,F),X.write_shift(2,q,"i"),X}function _(F,te,q){var X=d(F,te,q);return X[1].v=F.read_shift(8,"f"),X}function y(F,te,q){var X=ir(13);return X.write_shift(1,255),X.write_shift(2,te),X.write_shift(2,F),X.write_shift(8,q,"f"),X}function E(F,te,q){var X=F.l+te,K=d(F,te,q);if(K[1].v=F.read_shift(8,"f"),q.qpro)F.l=X;else{var ye=F.read_shift(2);A(F.slice(F.l,F.l+ye),K),F.l+=ye}return K}function k(F,te,q){var X=te&32768;return te&=-32769,te=(X?F:0)+(te>=8192?te-16384:te),(X?"":"$")+(q?lr(te):Cr(te))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(F,te){wr(F,0);for(var q=[],X=0,K="",ye="",Le="",be="";F.l<F.length;){var ke=F[F.l++];switch(ke){case 0:q.push(F.read_shift(8,"f"));break;case 1:ye=k(te[0].c,F.read_shift(2),!0),K=k(te[0].r,F.read_shift(2),!1),q.push(ye+K);break;case 2:{var $e=k(te[0].c,F.read_shift(2),!0),G=k(te[0].r,F.read_shift(2),!1);ye=k(te[0].c,F.read_shift(2),!0),K=k(te[0].r,F.read_shift(2),!1),q.push($e+G+":"+ye+K)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(F.read_shift(2));break;case 6:{for(var ot="";ke=F[F.l++];)ot+=String.fromCharCode(ke);q.push('"'+ot.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:be=q.pop(),Le=q.pop(),q.push(["AND","OR"][ke-20]+"("+Le+","+be+")");break;default:if(ke<32&&w[ke])be=q.pop(),Le=q.pop(),q.push(Le+w[ke]+be);else if(S[ke]){if(X=S[ke][1],X==69&&(X=F[F.l++]),X>q.length){console.error("WK1 bad formula parse 0x"+ke.toString(16)+":|"+q.join("|")+"|");return}var me=q.slice(-X);q.length-=X,q.push(S[ke][0]+"("+me.join(",")+")")}else return ke<=7?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=24?console.error("WK1 unsupported op "+ke.toString(16)):ke<=30?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=115?console.error("WK1 unsupported function opcode "+ke.toString(16)):console.error("WK1 unrecognized opcode "+ke.toString(16))}}q.length==1?te[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function D(F){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=F.read_shift(2),te[3]=F[F.l++],te[0].c=F[F.l++],te}function R(F,te){var q=D(F);return q[1].t="s",q[1].v=F.read_shift(te-4,"cstr"),q}function P(F,te,q,X){var K=ir(6+X.length);K.write_shift(2,F),K.write_shift(1,q),K.write_shift(1,te),K.write_shift(1,39);for(var ye=0;ye<X.length;++ye){var Le=X.charCodeAt(ye);K.write_shift(1,Le>=128?95:Le)}return K.write_shift(1,0),K}function H(F,te){var q=D(F);q[1].v=F.read_shift(2);var X=q[1].v>>1;if(q[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return q[1].v=X,q}function B(F,te){var q=D(F),X=F.read_shift(4),K=F.read_shift(4),ye=F.read_shift(2);if(ye==65535)return X===0&&K===3221225472?(q[1].t="e",q[1].v=15):X===0&&K===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Le=ye&32768;return ye=(ye&32767)-16446,q[1].v=(1-Le*2)*(K*Math.pow(2,ye+32)+X*Math.pow(2,ye)),q}function W(F,te,q,X){var K=ir(14);if(K.write_shift(2,F),K.write_shift(1,q),K.write_shift(1,te),X==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ye=0,Le=0,be=0,ke=0;return X<0&&(ye=1,X=-X),Le=Math.log2(X)|0,X/=Math.pow(2,Le-31),ke=X>>>0,ke&2147483648||(X/=2,++Le,ke=X>>>0),X-=ke,ke|=2147483648,ke>>>=0,X*=Math.pow(2,32),be=X>>>0,K.write_shift(4,be),K.write_shift(4,ke),Le+=16383+(ye?32768:0),K.write_shift(2,Le),K}function I(F,te){var q=B(F);return F.l+=te-14,q}function Z(F,te){var q=D(F),X=F.read_shift(4);return q[1].v=X>>6,q}function J(F,te){var q=D(F),X=F.read_shift(8,"f");return q[1].v=X,q}function ge(F,te){var q=J(F);return F.l+=te-10,q}function _e(F,te){return F[F.l+te-1]==0?F.read_shift(te,"cstr"):""}function de(F,te){var q=F[F.l++];q>te-1&&(q=te-1);for(var X="";X.length<q;)X+=String.fromCharCode(F[F.l++]);return X}function Q(F,te,q){if(!(!q.qpro||te<21)){var X=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var K=F.read_shift(te-21,"cstr");return[X,K]}}function ee(F,te){for(var q={},X=F.l+te;F.l<X;){var K=F.read_shift(2);if(K==14e3){for(q[K]=[0,""],q[K][0]=F.read_shift(2);F[F.l];)q[K][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return q}function U(F,te){var q=ir(5+F.length);q.write_shift(2,14e3),q.write_shift(2,te);for(var X=0;X<F.length;++X){var K=F.charCodeAt(X);q[q.l++]=K>127?95:K}return q[q.l++]=0,q}var ne={0:{n:"BOF",f:rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function B5(e){var t={},r=e.match(Hr),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Ye(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Kp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var z5=function(){var e=Kl("t"),t=Kl("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:vt(o[1])},u=i.match(t);return u&&(l.s=B5(u[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),U5=function(){var t=/(\r\n|\n)/g;function r(a,i,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),H5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,V5=/<(?:\w+:)?r>/,W5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function pm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=vt(At(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=At(e),r&&(n.h=am(n.t))):e.match(V5)&&(n.r=At(e),n.t=vt(At((e.replace(W5,"").match(H5)||[]).join("").replace(Hr,""))),r&&(n.h=U5(z5(n.r)))),n):{t:""}}var $5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,G5=/<(?:\w+:)?(?:si|sstItem)>/g,Z5=/<\/(?:\w+:)?(?:si|sstItem)>/;function q5(e,t){var r=[],n="";if(!e)return r;var a=e.match($5);if(a){n=a[2].replace(G5,"").split(Z5);for(var i=0;i!=n.length;++i){var o=pm(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=Ye(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function X5(e){return[e.read_shift(4),e.read_shift(4)]}function Y5(e,t){var r=[],n=!1;return Ja(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function vw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ha(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function K5(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ha(e,4),t.U=Ha(e,4),t.W=Ha(e,4),t}function J5(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Q5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(J5(e));return t}function eL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function tL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ha(e,4),t.U=Ha(e,4),t.W=Ha(e,4),t}function rL(e){var t=tL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function _w(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function yw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function nL(e){var t=Ha(e);switch(t.Minor){case 2:return[t.Minor,aL(e)];case 3:return[t.Minor,iL()];case 4:return[t.Minor,sL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function aL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=_w(e,r),a=yw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function iL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function sL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Hr,function(i){var o=Ye(i);switch(wa(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function oL(e,t){var r={},n=r.EncryptionVersionInfo=Ha(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=_w(e,a),t-=a,r.EncryptionVerifier=yw(e,t),r}function lL(e){var t={},r=t.EncryptionVersionInfo=Ha(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function cL(e){var t=0,r,n=vw(e),a=n.length+1,i,o,l,u,d;for(r=Pi(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],l=t&16384?1:0,u=t<<1&32767,d=l|u,t=d^o;return t^52811}var ww=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],u=104,d=o.length-1;d>=0;--d)for(var h=o[d],m=0;m!=7;++m)h&64&&(l^=r[u]),h*=2,--u;return l};return function(o){for(var l=vw(o),u=i(l),d=l.length,h=Pi(16),m=0;m!=16;++m)h[m]=0;var g,x,_;for((d&1)===1&&(g=u>>8,h[d]=a(e[0],g),--d,g=u&255,x=l[l.length-1],h[d]=a(x,g));d>0;)--d,g=u>>8,h[d]=a(l[d],g),--d,g=u&255,h[d]=a(l[d],g);for(d=15,_=15-l.length;_>0;)g=u>>8,h[d]=a(e[_],g),--d,--_,g=u&255,h[d]=a(l[d],g),--d,--_;return h}}(),uL=function(e,t,r,n,a){a||(a=t),n||(n=ww(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},fL=function(e){var t=0,r=ww(e);return function(n){var a=uL("",n,t,r);return t=a[1],a[0]}};function dL(e,t,r,n){var a={key:rr(e),verificationBytes:rr(e)};return r.password&&(a.verifier=cL(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=fL(r.password)),a}function hL(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=lL(e):n.Data=oL(e,t),n}function pL(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?hL(e,t-2,n):dL(e,r.biff>=8?t:t-2,r,n),n}var mL=function(){function e(a,i){switch(i.type){case"base64":return t(gn(a),i);case"binary":return t(a,i);case"buffer":return t(ut&&Buffer.isBuffer(a)?a.toString("binary"):Es(a),i);case"array":return t(xs(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},l=o.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,m){Array.isArray(l)&&(l[m]=[]);for(var g=/\\\w+\b/g,x=0,_,y=-1;_=g.exec(h);){switch(_[0]){case"\\cell":var E=h.slice(x,g.lastIndex-_[0].length);if(E[0]==" "&&(E=E.slice(1)),++y,E.length){var k={v:E,t:"s"};Array.isArray(l)?l[m][y]=k:l[et({r:m,c:y})]=k}break}x=g.lastIndex}y>d.e.c&&(d.e.c=y)}),l["!ref"]=gt(d),l}function r(a,i){return Di(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=Gt(a["!ref"]),l,u=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var m=et({r:d,c:h});l=u?(a[d]||[])[h]:a[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(qa(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function gL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ec(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xL(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var l=0,u=0,d=a+i;switch(u=o/(d>1?2-d:d),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,d/2]}function vL(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=a*l,o[0]+=a,o[1]+=u;break;case 1:u=a*(2-l),o[0]+=u,o[1]+=a;break;case 2:u=a*(l-2),o[1]+=a,o[2]+=u;break;case 3:u=a*(4-l),o[1]+=u,o[2]+=a;break;case 4:u=a*(l-4),o[2]+=a,o[0]+=u;break;case 5:u=a*(6-l),o[2]+=u,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Sf(e,t){if(t===0)return e;var r=xL(gL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ec(vL(r))}var kw=6,_L=15,yL=1,Zr=kw;function Tf(e){return Math.floor((e+Math.round(128/Zr)/256)*Zr)}function Cf(e){return Math.floor((e-5)/Zr*100+.5)/100}function Ah(e){return Math.round((e*Zr+5)/Zr*256)/256}function hd(e){return Ah(Cf(Tf(e)))}function mm(e){var t=Math.abs(e-hd(e)),r=Zr;if(t>.005)for(Zr=yL;Zr<_L;++Zr)Math.abs(e-hd(e))<=t&&(t=Math.abs(e-hd(e)),r=Zr);Zr=r}function So(e){e.width?(e.wpx=Tf(e.width),e.wch=Cf(e.wpx),e.MDW=Zr):e.wpx?(e.wch=Cf(e.wpx),e.width=Ah(e.wch),e.MDW=Zr):typeof e.wch=="number"&&(e.width=Ah(e.wch),e.wpx=Tf(e.width),e.MDW=Zr),e.customWidth&&delete e.customWidth}var wL=96,Ew=wL;function Sw(e){return e*96/Ew}function tc(e){return e*Ew/96}var kL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function EL(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Hr)||[]).forEach(function(o){var l=Ye(o);switch(wa(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=jt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=jt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function SL(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Hr)||[]).forEach(function(o){var l=Ye(o);switch(wa(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function TL(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Hr)||[]).forEach(function(o){var l=Ye(o);switch(wa(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=At(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?jt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?jt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?jt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?jt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?jt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?jt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?jt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Kp[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=jt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var u=os[a.color.index];a.color.index==81&&(u=os[1]),u||(u=os[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Sf(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function CL(e,t,r){t.NumberFmt=[];for(var n=_a(nt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=nt[n[a]];var i=e[0].match(Hr);if(i)for(a=0;a<i.length;++a){var o=Ye(i[a]);switch(wa(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=vt(At(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}ss(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var hu=["numFmtId","fillId","fontId","borderId","xfId"],pu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function bL(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Hr)||[]).forEach(function(i){var o=Ye(i),l=0;switch(wa(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<hu.length;++l)n[hu[l]]&&(n[hu[l]]=parseInt(n[hu[l]],10));for(l=0;l<pu.length;++l)n[pu[l]]&&(n[pu[l]]=jt(n[pu[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=jt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var NL=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,d){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&CL(m,h,d),(m=l.match(a))&&TL(m,h,u,d),(m=l.match(n))&&SL(m,h,u,d),(m=l.match(i))&&EL(m,h,u,d),(m=l.match(r))&&bL(m,h,d),h}}();function AL(e,t){var r=e.read_shift(2),n=Br(e);return[r,n]}function LL(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=zN(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=BN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Br(e),n}var PL=Ur;function FL(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var OL=Ur;function ML(e,t,r){var n={};n.NumberFmt=[];for(var a in nt)n.NumberFmt[a]=nt[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Ja(e,function(u,d,h){switch(h){case 44:n.NumberFmt[u[0]]=u[1],ss(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=Sf(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(h),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(h);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var jL=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function RL(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Hr)||[]).forEach(function(a){var i=Ye(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[jL.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function DL(){}function IL(){}var BL=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,zL=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,UL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function HL(e,t,r){t.themeElements={};var n;[["clrScheme",BL,RL],["fontScheme",zL,DL],["fmtScheme",UL,IL]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var VL=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Tw(e,t){(!e||e.length===0)&&(e=WL());var r,n={};if(!(r=e.match(VL)))throw new Error("themeElements not found in theme");return HL(r[0],n,t),n.raw=e,n}function WL(e,t){var r=[R2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $L(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=j2(i,{type:"array"})}catch{return}var l=fn(o,"theme/theme/theme1.xml",!0);if(l)return Tw(l,r)}}function GL(e){return e.read_shift(4)}function ZL(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=qL(e,4);break;case 2:t.xclrValue=fw(e);break;case 3:t.xclrValue=GL(e);break;case 4:e.l+=4;break}return e.l+=8,t}function qL(e,t){return Ur(e,t)}function XL(e,t){return Ur(e,t)}function YL(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=ZL(e);break;case 6:n[1]=XL(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function KL(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(YL(e,r-e.l));return{ixfe:n,ext:i}}function JL(e,t){t.forEach(function(r){switch(r[0]){}})}function QL(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Br(e)}}function e6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function t6(e){return e.l+=4,e.read_shift(4)!=0}function r6(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,l=2;return Ja(e,function(u,d,h){switch(h){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:i.push(h),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function n6(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(Hr,function(l){var u=Ye(l);switch(wa(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==u.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):i==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function a6(e){var t=[];if(!e)return t;var r=1;return(e.match(Hr)||[]).forEach(function(n){var a=Ye(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function i6(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=et(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function s6(e,t,r){var n=[];return Ja(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function o6(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Ja(e,function(l,u,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function l6(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function j1(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var l=qr(o.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[o.ref]=i;var u=Gt(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var d=gt(u);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(h.a==n[m].id){h.a=n[m].name||h.a;break}}i.c.push(h)})}function c6(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Ye(l[0]),d={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=qr(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&pm(m[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=g.h),n.push(d)}}}}),n}function u6(e,t){var r=[],n=!1,a={},i=0;return e.replace(Hr,function(l,u){var d=Ye(l);switch(wa(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=u+l.length;break;case"</text>":a.t=e.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function f6(e,t){var r=[],n=!1;return e.replace(Hr,function(i){var o=Ye(i);switch(wa(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function d6(e){var t={};t.iauthor=e.read_shift(4);var r=Ts(e);return t.rfx=r.s,t.ref=et(r.s),e.l+=16,t}var h6=Br;function p6(e,t){var r=[],n=[],a={},i=!1;return Ja(e,function(l,u,d){switch(d){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var m6="application/vnd.ms-office.vbaProject";function g6(e){var t=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),mt.write(t)}function x6(){return{"!type":"dialog"}}function v6(){return{"!type":"dialog"}}function _6(){return{"!type":"macro"}}function y6(){return{"!type":"macro"}}var fo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var l=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,u?d+=t.r:--d,a+(l?"":"$")+lr(h)+(u?"":"$")+Cr(d)}return function(a,i){return t=i,a.replace(e,r)}}(),Cw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,w6=function(){return function(t,r){return t.replace(Cw,function(n,a,i,o,l,u){var d=lm(o)-(i?0:r.c),h=om(u)-(l?0:r.r),m=h==0?"":l?h+1:"["+h+"]",g=d==0?"":i?d+1:"["+d+"]";return a+"R"+m+"C"+g})}}();function bw(e,t){return e.replace(Cw,function(r,n,a,i,o,l){return n+(a=="$"?a+i:lr(lm(i)+t.c))+(o=="$"?o+l:Cr(om(l)+t.r))})}function k6(e,t,r){var n=Oo(t),a=n.s,i=qr(r),o={r:i.r-a.r,c:i.c-a.c};return bw(e,o)}function E6(e){return e.length!=1}function R1(e){return e.replace(/_xlfn\./g,"")}function Qt(e){e.l+=1}function Fi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Nw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Aw(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Fi(e),l=Fi(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Aw(e){var t=Fi(e),r=Fi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function S6(e,t,r){if(r.biff<8)return Aw(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Fi(e),o=Fi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Lw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return T6(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Fi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function T6(e){var t=Fi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function C6(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function b6(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return N6(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function N6(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function A6(e,t,r){var n=(e[e.l++]&96)>>5,a=Nw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function L6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=Nw(e,i,r);return[n,a,o]}function P6(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function F6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function O6(e,t,r){var n=(e[e.l++]&96)>>5,a=S6(e,t-1,r);return[n,a]}function M6(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function D1(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function j6(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function R6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function D6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function I6(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function B6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Pw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function z6(e){return e.read_shift(2),Pw(e)}function U6(e){return e.read_shift(2),Pw(e)}function H6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Lw(e,0,r);return[n,a]}function V6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=b6(e,0,r);return[n,a]}function W6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Lw(e,0,r);return[n,a,i]}function $6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[GP[a],Mw[a],n]}function G6(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Z6(e);return[a,(i[0]===0?Mw:$P)[i[1]]]}function Z6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function q6(e,t,r){e.l+=r&&r.biff==2?3:4}function X6(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Y6(e){return e.l++,Cs[e.read_shift(1)]}function K6(e){return e.l++,e.read_shift(2)}function J6(e){return e.l++,e.read_shift(1)!==0}function Q6(e){return e.l++,Dr(e)}function eP(e,t,r){return e.l++,vc(e,t-1,r)}function tP(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=qt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Cs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Dr(e);break;case 2:r[1]=bs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function rP(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Ts:r0)(e));return a}function nP(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=tP(e,r.biff);return o}function aP(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function iP(e,t,r){if(r.biff==5)return sP(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function sP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function oP(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function lP(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function cP(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function uP(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var fP=Ur,dP=Ur,hP=Ur;function yc(e,t,r){return e.l+=2,[C6(e)]}function gm(e){return e.l+=6,[]}var pP=yc,mP=gm,gP=gm,xP=yc;function Fw(e){return e.l+=2,[rr(e),e.read_shift(2)&1]}var vP=yc,_P=Fw,yP=gm,wP=yc,kP=yc,EP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SP(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=EP[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function TP(e){return e.l+=2,[e.read_shift(4)]}function CP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function bP(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function NP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function LP(e){return e.l+=4,[0,0]}var I1={1:{n:"PtgExp",f:X6},2:{n:"PtgTbl",f:hP},3:{n:"PtgAdd",f:Qt},4:{n:"PtgSub",f:Qt},5:{n:"PtgMul",f:Qt},6:{n:"PtgDiv",f:Qt},7:{n:"PtgPower",f:Qt},8:{n:"PtgConcat",f:Qt},9:{n:"PtgLt",f:Qt},10:{n:"PtgLe",f:Qt},11:{n:"PtgEq",f:Qt},12:{n:"PtgGe",f:Qt},13:{n:"PtgGt",f:Qt},14:{n:"PtgNe",f:Qt},15:{n:"PtgIsect",f:Qt},16:{n:"PtgUnion",f:Qt},17:{n:"PtgRange",f:Qt},18:{n:"PtgUplus",f:Qt},19:{n:"PtgUminus",f:Qt},20:{n:"PtgPercent",f:Qt},21:{n:"PtgParen",f:Qt},22:{n:"PtgMissArg",f:Qt},23:{n:"PtgStr",f:eP},26:{n:"PtgSheet",f:CP},27:{n:"PtgEndSheet",f:bP},28:{n:"PtgErr",f:Y6},29:{n:"PtgBool",f:J6},30:{n:"PtgInt",f:K6},31:{n:"PtgNum",f:Q6},32:{n:"PtgArray",f:M6},33:{n:"PtgFunc",f:$6},34:{n:"PtgFuncVar",f:G6},35:{n:"PtgName",f:aP},36:{n:"PtgRef",f:H6},37:{n:"PtgArea",f:A6},38:{n:"PtgMemArea",f:oP},39:{n:"PtgMemErr",f:fP},40:{n:"PtgMemNoMem",f:dP},41:{n:"PtgMemFunc",f:lP},42:{n:"PtgRefErr",f:cP},43:{n:"PtgAreaErr",f:P6},44:{n:"PtgRefN",f:V6},45:{n:"PtgAreaN",f:O6},46:{n:"PtgMemAreaN",f:NP},47:{n:"PtgMemNoMemN",f:AP},57:{n:"PtgNameX",f:iP},58:{n:"PtgRef3d",f:W6},59:{n:"PtgArea3d",f:L6},60:{n:"PtgRefErr3d",f:uP},61:{n:"PtgAreaErr3d",f:F6},255:{}},PP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FP={1:{n:"PtgElfLel",f:Fw},2:{n:"PtgElfRw",f:wP},3:{n:"PtgElfCol",f:pP},6:{n:"PtgElfRwV",f:kP},7:{n:"PtgElfColV",f:xP},10:{n:"PtgElfRadical",f:vP},11:{n:"PtgElfRadicalS",f:yP},13:{n:"PtgElfColS",f:mP},15:{n:"PtgElfColSV",f:gP},16:{n:"PtgElfRadicalLel",f:_P},25:{n:"PtgList",f:SP},29:{n:"PtgSxName",f:TP},255:{}},OP={0:{n:"PtgAttrNoop",f:LP},1:{n:"PtgAttrSemi",f:B6},2:{n:"PtgAttrIf",f:D6},4:{n:"PtgAttrChoose",f:j6},8:{n:"PtgAttrGoto",f:R6},16:{n:"PtgAttrSum",f:q6},32:{n:"PtgAttrBaxcel",f:D1},33:{n:"PtgAttrBaxcel",f:D1},64:{n:"PtgAttrSpace",f:z6},65:{n:"PtgAttrSpaceSemi",f:U6},128:{n:"PtgAttrIfError",f:I6},255:{}};function wc(e,t,r,n){if(n.biff<8)return Ur(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=nP(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=rP(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(Ur(e,t)),i}function kc(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=I1[i]||I1[PP[i]],(i===24||i===25)&&(a=(i===24?FP:OP)[e[e.l+1]]),!a||!a.f?Ur(e,t):o.push([a.n,a.f(e,t,r)]);return o}function MP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var jP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function RP(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ow(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function B1(e,t,r){var n=Ow(e,t,r);return n=="#REF"?n:RP(n,r)}function Mr(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],u,d,h,m=0,g=0,x,_="";if(!e[0]||!e[0][0])return"";for(var y=-1,E="",k=0,S=e[0].length;k<S;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),d=l.pop(),y>=0){switch(e[0][y][1][0]){case 0:E=$t(" ",e[0][y][1][1]);break;case 1:E=$t("\r",e[0][y][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}d=d+E,y=-1}l.push(d+jP[w[0]]+u);break;case"PtgIsect":u=l.pop(),d=l.pop(),l.push(d+" "+u);break;case"PtgUnion":u=l.pop(),d=l.pop(),l.push(d+","+u);break;case"PtgRange":u=l.pop(),d=l.pop(),l.push(d+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=El(w[1][1],o,a),l.push(Sl(h,i));break;case"PtgRefN":h=r?El(w[1][1],r,a):w[1][1],l.push(Sl(h,i));break;case"PtgRef3d":m=w[1][1],h=El(w[1][2],o,a),_=B1(n,m,a),l.push(_+"!"+Sl(h,i));break;case"PtgFunc":case"PtgFuncVar":var A=w[1][0],D=w[1][1];A||(A=0),A&=127;var R=A==0?[]:l.slice(-A);l.length-=A,D==="User"&&(D=R.shift()),l.push(D+"("+R.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":x=_1(w[1][1],r?{s:r}:o,a),l.push(fd(x,a));break;case"PtgArea":x=_1(w[1][1],o,a),l.push(fd(x,a));break;case"PtgArea3d":m=w[1][1],x=w[1][2],_=B1(n,m,a),l.push(_+"!"+fd(x,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=w[1][2];var P=(n.names||[])[g-1]||(n[0]||[])[g],H=P?P.Name:"SH33TJSNAME"+String(g);H&&H.slice(0,6)=="_xlfn."&&!a.xlfn&&(H=H.slice(6)),l.push(H);break;case"PtgNameX":var B=w[1][1];g=w[1][2];var W;if(a.biff<=5)B<0&&(B=-B),n[B]&&(W=n[B][g]);else{var I="";if(((n[B]||[])[0]||[])[0]==14849||(((n[B]||[])[0]||[])[0]==1025?n[B][g]&&n[B][g].itab>0&&(I=n.SheetNames[n[B][g].itab-1]+"!"):I=n.SheetNames[g-1]+"!"),n[B]&&n[B][g])I+=n[B][g].Name;else if(n[0]&&n[0][g])I+=n[0][g].Name;else{var Z=(Ow(n,B,a)||"").split(";;");Z[g-1]?I=Z[g-1]:I+="SH33TJSERRX"}l.push(I);break}W||(W={Name:"SH33TJSERRY"}),l.push(W.Name);break;case"PtgParen":var J="(",ge=")";if(y>=0){switch(E="",e[0][y][1][0]){case 2:J=$t(" ",e[0][y][1][1])+J;break;case 3:J=$t("\r",e[0][y][1][1])+J;break;case 4:ge=$t(" ",e[0][y][1][1])+ge;break;case 5:ge=$t("\r",e[0][y][1][1])+ge;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}l.push(J+l.pop()+ge);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:w[1][1],r:w[1][0]};var _e={c:r.c,r:r.r};if(n.sharedf[et(h)]){var de=n.sharedf[et(h)];l.push(Mr(de,o,_e,n,a))}else{var Q=!1;for(u=0;u!=n.arrayf.length;++u)if(d=n.arrayf[u],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){l.push(Mr(d[1],o,_e,n,a)),Q=!0;break}Q||l.push(w[1])}break;case"PtgArray":l.push("{"+MP(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&y>=0&&ee.indexOf(e[0][k][0])==-1){w=e[0][y];var U=!0;switch(w[1][0]){case 4:U=!1;case 0:E=$t(" ",w[1][1]);break;case 5:U=!1;case 1:E=$t("\r",w[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((U?E:"")+l.pop()+(U?"":E)),y=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function DP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Ur(e,t-2)];var l=kc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function IP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Ur(e,t-2)];var l=kc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function BP(e,t,r,n){var a=e.l+t,i=kc(e,n,r),o;return a!==e.l&&(o=wc(e,a-e.l,i,r)),[i,o]}function zP(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=kc(e,i,r);return i==65535?[[],Ur(e,t-2)]:(t!==i+2&&(a=wc(e,n-i-2,o,r)),[o,a])}function UP(e){var t;if(Ia(e,e.l+6)!==65535)return[Dr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function pd(e,t,r){var n=e.l+t,a=ka(e);r.biff==2&&++e.l;var i=UP(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=IP(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function n0(e,t,r){var n=e.read_shift(4),a=kc(e,n,r),i=e.read_shift(4),o=i>0?wc(e,i,a,r):null;return[a,o]}var HP=n0,a0=n0,VP=n0,WP=n0,$P={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Mw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function z1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function md(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Nl={},ho={};function Al(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function jw(e,t,r,n,a,i){try{n.cellNF&&(e.z=nt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=gr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(nt[t]==null&&ss(Zb[t]||"General",t),e.t==="e")e.w=e.w||Cs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v);else if(e.t==="d"){var o=Kr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Yl(o)}else{if(e.v===void 0)return"";e.w=gs(e.v,ho)}else e.t==="d"?e.w=jn(t,Kr(e.v),ho):e.w=jn(t,e.v,ho)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Sf(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Sf(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function ZP(e,t){var r=Gt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=gt(r))}var qP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,XP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,YP=/<(?:\w:)?hyperlink [^>]*>/mg,KP=/"(\w*:\w*)"/,JP=/<(?:\w:)?col\b[^>]*[\/]?>/g,QP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,eF=/<(?:\w:)?pageMargins[^>]*\/>/g,Rw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,tF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function nF(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",m=e.match(XP);m?(d=e.slice(0,m.index),h=e.slice(m.index+m[0].length)):d=h=e;var g=d.match(Rw);g?xm(g[0],l,a,r):(g=d.match(tF))&&aF(g[0],g[1]||"",l,a,r);var x=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var _=d.slice(x,x+50).match(KP);_&&ZP(l,_[1])}var y=d.match(rF);y&&y[1]&&uF(y[1],a);var E=[];if(t.cellStyles){var k=d.match(JP);k&&oF(E,k)}m&&fF(m[1],l,t,u,i,o);var S=h.match(QP);S&&(l["!autofilter"]=lF(S[0]));var w=[],A=h.match(qP);if(A)for(x=0;x!=A.length;++x)w[x]=Gt(A[x].slice(A[x].indexOf('"')+1));var D=h.match(YP);D&&iF(l,D,n);var R=h.match(eF);if(R&&(l["!margins"]=sF(Ye(R[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=gt(u)),t.sheetRows>0&&l["!ref"]){var P=Gt(l["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>u.e.r&&(P.e.r=u.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>u.e.c&&(P.e.c=u.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),l["!fullref"]=l["!ref"],l["!ref"]=gt(P))}return E.length>0&&(l["!cols"]=E),w.length>0&&(l["!merges"]=w),l}function xm(e,t,r,n){var a=Ye(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=vt(At(a.codeName)))}function aF(e,t,r,n,a){xm(e.slice(0,e.indexOf(">")),r,n,a)}function iF(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Ye(At(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+vt(i.location))):(i.Target="#"+vt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=Gt(i.ref),u=l.s.r;u<=l.e.r;++u)for(var d=l.s.c;d<=l.e.c;++d){var h=et({c:d,r:u});n?(e[u]||(e[u]=[]),e[u][d]||(e[u][d]={t:"z",v:void 0}),e[u][d].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function sF(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function oF(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ye(t[n],!0);a.hidden&&(a.hidden=jt(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,mm(a.width)),So(a);i<=o;)e[i++]=Tr(a)}}function lF(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var cF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function uF(e,t){t.Views||(t.Views=[{}]),(e.match(cF)||[]).forEach(function(r,n){var a=Ye(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),jt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var fF=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Kl("v"),o=Kl("f");return function(u,d,h,m,g,x){for(var _=0,y="",E=[],k=[],S=0,w=0,A=0,D="",R,P,H=0,B=0,W,I,Z=0,J=0,ge=Array.isArray(x.CellXf),_e,de=[],Q=[],ee=Array.isArray(d),U=[],ne={},ue=!1,F=!!h.sheetStubs,te=u.split(t),q=0,X=te.length;q!=X;++q){y=te[q].trim();var K=y.length;if(K!==0){var ye=0;e:for(_=0;_<K;++_)switch(y[_]){case">":if(y[_-1]!="/"){++_;break e}if(h&&h.cellStyles){if(P=Ye(y.slice(ye,_),!0),H=P.r!=null?parseInt(P.r,10):H+1,B=-1,h.sheetRows&&h.sheetRows<H)continue;ne={},ue=!1,P.ht&&(ue=!0,ne.hpt=parseFloat(P.ht),ne.hpx=tc(ne.hpt)),P.hidden=="1"&&(ue=!0,ne.hidden=!0),P.outlineLevel!=null&&(ue=!0,ne.level=+P.outlineLevel),ue&&(U[H-1]=ne)}break;case"<":ye=_;break}if(ye>=_)break;if(P=Ye(y.slice(ye,_),!0),H=P.r!=null?parseInt(P.r,10):H+1,B=-1,!(h.sheetRows&&h.sheetRows<H)){m.s.r>H-1&&(m.s.r=H-1),m.e.r<H-1&&(m.e.r=H-1),h&&h.cellStyles&&(ne={},ue=!1,P.ht&&(ue=!0,ne.hpt=parseFloat(P.ht),ne.hpx=tc(ne.hpt)),P.hidden=="1"&&(ue=!0,ne.hidden=!0),P.outlineLevel!=null&&(ue=!0,ne.level=+P.outlineLevel),ue&&(U[H-1]=ne)),E=y.slice(_).split(e);for(var Le=0;Le!=E.length&&E[Le].trim().charAt(0)=="<";++Le);for(E=E.slice(Le),_=0;_!=E.length;++_)if(y=E[_].trim(),y.length!==0){if(k=y.match(r),S=_,w=0,A=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(S=0,D=k[1],w=0;w!=D.length&&!((A=D.charCodeAt(w)-64)<1||A>26);++w)S=26*S+A;--S,B=S}else++B;for(w=0;w!=y.length&&y.charCodeAt(w)!==62;++w);if(++w,P=Ye(y.slice(0,w),!0),P.r||(P.r=et({r:H-1,c:B})),D=y.slice(w),R={t:""},(k=D.match(i))!=null&&k[1]!==""&&(R.v=vt(k[1])),h.cellFormula){if((k=D.match(o))!=null&&k[1]!==""){if(R.f=vt(At(k[1])).replace(/\r\n/g,`
`),h.xlfn||(R.f=R1(R.f)),k[0].indexOf('t="array"')>-1)R.F=(D.match(a)||[])[1],R.F.indexOf(":")>-1&&de.push([Gt(R.F),R.F]);else if(k[0].indexOf('t="shared"')>-1){I=Ye(k[0]);var be=vt(At(k[1]));h.xlfn||(be=R1(be)),Q[parseInt(I.si,10)]=[I,be,P.r]}}else(k=D.match(/<f[^>]*\/>/))&&(I=Ye(k[0]),Q[I.si]&&(R.f=k6(Q[I.si][1],Q[I.si][2],P.r)));var ke=qr(P.r);for(w=0;w<de.length;++w)ke.r>=de[w][0].s.r&&ke.r<=de[w][0].e.r&&ke.c>=de[w][0].s.c&&ke.c<=de[w][0].e.c&&(R.F=de[w][1])}if(P.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(F)R.t="z";else continue;else R.t=P.t||"n";switch(m.s.c>B&&(m.s.c=B),m.e.c<B&&(m.e.c=B),R.t){case"n":if(R.v==""||R.v==null){if(!F)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!F)continue;R.t="z"}else W=Nl[parseInt(R.v,10)],R.v=W.t,R.r=W.r,h.cellHTML&&(R.h=W.h);break;case"str":R.t="s",R.v=R.v!=null?At(R.v):"",h.cellHTML&&(R.h=am(R.v));break;case"inlineStr":k=D.match(n),R.t="s",k!=null&&(W=pm(k[1]))?(R.v=W.t,h.cellHTML&&(R.h=W.h)):R.v="";break;case"b":R.v=jt(R.v);break;case"d":h.cellDates?R.v=gr(R.v,1):(R.v=Kr(gr(R.v,1)),R.t="n");break;case"e":(!h||h.cellText!==!1)&&(R.w=R.v),R.v=nw[R.v];break}if(Z=J=0,_e=null,ge&&P.s!==void 0&&(_e=x.CellXf[P.s],_e!=null&&(_e.numFmtId!=null&&(Z=_e.numFmtId),h.cellStyles&&_e.fillId!=null&&(J=_e.fillId))),jw(R,Z,J,h,g,x),h.cellDates&&ge&&R.t=="n"&&Fo(nt[Z])&&(R.t="d",R.v=t0(R.v)),P.cm&&h.xlmeta){var $e=(h.xlmeta.Cell||[])[+P.cm-1];$e&&$e.type=="XLDAPR"&&(R.D=!0)}if(ee){var G=qr(P.r);d[G.r]||(d[G.r]=[]),d[G.r][G.c]=R}else d[P.r]=R}}}}U.length>0&&(d["!rows"]=U)}}();function dF(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var hF=Ts;function pF(){}function mF(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=DN(e),r}function gF(e){var t=Rn(e);return[t]}function xF(e){var t=Ss(e);return[t]}function vF(e){var t=Rn(e),r=e.read_shift(1);return[t,r,"b"]}function _F(e){var t=Ss(e),r=e.read_shift(1);return[t,r,"b"]}function yF(e){var t=Rn(e),r=e.read_shift(1);return[t,r,"e"]}function wF(e){var t=Ss(e),r=e.read_shift(1);return[t,r,"e"]}function kF(e){var t=Rn(e),r=e.read_shift(4);return[t,r,"s"]}function EF(e){var t=Ss(e),r=e.read_shift(4);return[t,r,"s"]}function SF(e){var t=Rn(e),r=Dr(e);return[t,r,"n"]}function Dw(e){var t=Ss(e),r=Dr(e);return[t,r,"n"]}function TF(e){var t=Rn(e),r=fm(e);return[t,r,"n"]}function CF(e){var t=Ss(e),r=fm(e);return[t,r,"n"]}function bF(e){var t=Rn(e),r=cm(e);return[t,r,"is"]}function NF(e){var t=Rn(e),r=Br(e);return[t,r,"str"]}function AF(e){var t=Ss(e),r=Br(e);return[t,r,"str"]}function LF(e,t,r){var n=e.l+t,a=Rn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=a0(e,n-e.l,r);o[3]=Mr(l,null,a,r.supbooks,r)}else e.l=n;return o}function PF(e,t,r){var n=e.l+t,a=Rn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=a0(e,n-e.l,r);o[3]=Mr(l,null,a,r.supbooks,r)}else e.l=n;return o}function FF(e,t,r){var n=e.l+t,a=Rn(e);a.r=r["!row"];var i=Dr(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=a0(e,n-e.l,r);o[3]=Mr(l,null,a,r.supbooks,r)}else e.l=n;return o}function OF(e,t,r){var n=e.l+t,a=Rn(e);a.r=r["!row"];var i=Br(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=a0(e,n-e.l,r);o[3]=Mr(l,null,a,r.supbooks,r)}else e.l=n;return o}var MF=Ts;function jF(e,t){var r=e.l+t,n=Ts(e),a=um(e),i=Br(e),o=Br(e),l=Br(e);e.l=r;var u={rfx:n,relId:a,loc:i,display:l};return o&&(u.Tooltip=o),u}function RF(){}function DF(e,t,r){var n=e.l+t,a=ew(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var l=HP(e,n-e.l,r);o[1]=l}else e.l=n;return o}function IF(e,t,r){var n=e.l+t,a=Ts(e),i=[a];if(r.cellFormula){var o=WP(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}var BF=["left","right","top","bottom","header","footer"];function zF(e){var t={};return BF.forEach(function(r){t[r]=Dr(e)}),t}function UF(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function HF(){}function VF(){}function WF(e,t,r,n,a,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,x,_,y,E,k,S,w,A,D,R=[];l.biff=12,l["!row"]=0;var P=0,H=!1,B=[],W={},I=l.supbooks||a.supbooks||[[]];if(I.sharedf=W,I.arrayf=B,I.SheetNames=a.SheetNames||a.Sheets.map(function(ee){return ee.name}),!l.supbooks&&(l.supbooks=I,a.Names))for(var Z=0;Z<a.Names.length;++Z)I[0][Z+1]=a.Names[Z];var J=[],ge=[],_e=!1;bf[16]={n:"BrtShortReal",f:Dw};var de;if(Ja(e,function(U,ne,ue){if(!g)switch(ue){case 148:d=U;break;case 0:x=U,l.sheetRows&&l.sheetRows<=x.r&&(g=!0),A=Cr(E=x.r),l["!row"]=x.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=tc(U.hpt)),ge[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:U[2]},U[2]){case"n":_.v=U[1];break;case"s":w=Nl[U[1]],_.v=w.t,_.r=w.r;break;case"b":_.v=!!U[1];break;case"e":_.v=U[1],l.cellText!==!1&&(_.w=Cs[_.v]);break;case"str":_.t="s",_.v=U[1];break;case"is":_.t="s",_.v=U[1].t;break}if((y=o.CellXf[U[0].iStyleRef])&&jw(_,y.numFmtId,null,l,i,o),k=U[0].c==-1?k+1:U[0].c,l.dense?(u[E]||(u[E]=[]),u[E][k]=_):u[lr(k)+A]=_,l.cellFormula){for(H=!1,P=0;P<B.length;++P){var F=B[P];x.r>=F[0].s.r&&x.r<=F[0].e.r&&k>=F[0].s.c&&k<=F[0].e.c&&(_.F=gt(F[0]),H=!0)}!H&&U.length>3&&(_.f=U[3])}if(h.s.r>x.r&&(h.s.r=x.r),h.s.c>k&&(h.s.c=k),h.e.r<x.r&&(h.e.r=x.r),h.e.c<k&&(h.e.c=k),l.cellDates&&y&&_.t=="n"&&Fo(nt[y.numFmtId])){var te=ts(_.v);te&&(_.t="d",_.v=new Date(te.y,te.m-1,te.d,te.H,te.M,te.S,te.u))}de&&(de.type=="XLDAPR"&&(_.D=!0),de=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;_={t:"z",v:void 0},k=U[0].c==-1?k+1:U[0].c,l.dense?(u[E]||(u[E]=[]),u[E][k]=_):u[lr(k)+A]=_,h.s.r>x.r&&(h.s.r=x.r),h.s.c>k&&(h.s.c=k),h.e.r<x.r&&(h.e.r=x.r),h.e.c<k&&(h.e.c=k),de&&(de.type=="XLDAPR"&&(_.D=!0),de=void 0);break;case 176:R.push(U);break;case 49:de=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var q=n["!id"][U.relId];for(q?(U.Target=q.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=q):U.relId==""&&(U.Target="#"+U.loc),E=U.rfx.s.r;E<=U.rfx.e.r;++E)for(k=U.rfx.s.c;k<=U.rfx.e.c;++k)l.dense?(u[E]||(u[E]=[]),u[E][k]||(u[E][k]={t:"z",v:void 0}),u[E][k].l=U):(S=et({c:k,r:E}),u[S]||(u[S]={t:"z",v:void 0}),u[S].l=U);break;case 426:if(!l.cellFormula)break;B.push(U),D=l.dense?u[E][k]:u[lr(k)+A],D.f=Mr(U[1],h,{r:x.r,c:k},I,l),D.F=gt(U[0]);break;case 427:if(!l.cellFormula)break;W[et(U[0].s)]=U[1],D=l.dense?u[E][k]:u[lr(k)+A],D.f=Mr(U[1],h,{r:x.r,c:k},I,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)J[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},_e||(_e=!0,mm(U.w/256)),So(J[U.e+1]);break;case 161:u["!autofilter"]={ref:gt(U)};break;case 476:u["!margins"]=U;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),U.name&&(a.Sheets[r].CodeName=U.name),(U.above||U.left)&&(u["!outline"]={above:U.above,left:U.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),U.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!ne.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+ue.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(u["!ref"]=gt(d||h)),l.sheetRows&&u["!ref"]){var Q=Gt(u["!ref"]);l.sheetRows<=+Q.e.r&&(Q.e.r=l.sheetRows-1,Q.e.r>h.e.r&&(Q.e.r=h.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>h.e.c&&(Q.e.c=h.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),u["!fullref"]=u["!ref"],u["!ref"]=gt(Q))}return R.length>0&&(u["!merges"]=R),J.length>0&&(u["!cols"]=J),ge.length>0&&(u["!rows"]=ge),u}function $F(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=vt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function GF(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,u=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=$F(m);h.s.r=h.s.c=0,h.e.c=l,d=lr(l),g[0].forEach(function(x,_){o[d+Cr(_)]={t:"n",v:x,z:g[1]},u=_}),h.e.r<u&&(h.e.r=u),++l}),l>0&&(o["!ref"]=gt(h)),o}function ZF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Rw);return l&&xm(l[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function qF(e,t){e.l+=10;var r=Br(e);return{name:r}}function XF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ja(e,function(u,d,h){switch(h){case 550:i["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Iw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],YF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],KF=[],JF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function U1(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=jt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function H1(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=jt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Bw(e){H1(e.WBProps,Iw),H1(e.CalcPr,JF),U1(e.WBView,YF),U1(e.Sheets,KF),ho.date1904=jt(e.WBProps.date1904)}var QF="][*?/\\".split("");function e8(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return QF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var t8=/<\w+:workbook/;function r8(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(Hr,function(u,d){var h=Ye(u);switch(wa(h[0])){case"<?xml":break;case"<workbook":u.match(t8)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Iw.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=jt(h[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:r.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(r.WBProps.CodeName=At(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=vt(At(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=At(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),jt(h.hidden||"0")&&(i.Hidden=!0),o=d+u.length;break;case"</definedName>":i.Ref=vt(At(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),yN.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Bw(r),r}function n8(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ch(e),r.name=Br(e),r}function a8(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Br(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function i8(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function s8(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=IN(e),o=VP(e,0,r),l=um(e);e.l=n;var u={Name:i,Ptg:o};return a<268435455&&(u.Sheet=a),l&&(u.Comment=l),u}function o8(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],bf[16]={n:"BrtFRTArchID$",f:i8},Ja(e,function(u,d,h){switch(h){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Mr(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,u]):o[0]=[h,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),Bw(r),r.Names=i,r.supbooks=o,r}function l8(e,t,r){return t.slice(-4)===".bin"?o8(e,r):r8(e,r)}function c8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?WF(e,n,r,a,i,o,l):nF(e,n,r,a,i,o,l)}function u8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?XF(e,n,r,a,i):ZF(e,n,r,a,i)}function f8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?_6():y6()}function d8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?x6():v6()}function h8(e,t,r,n){return t.slice(-4)===".bin"?ML(e,r,n):NL(e,r,n)}function p8(e,t,r){return Tw(e,r)}function m8(e,t,r){return t.slice(-4)===".bin"?Y5(e,r):q5(e,r)}function g8(e,t,r){return t.slice(-4)===".bin"?p6(e,r):c6(e,r)}function x8(e,t,r){return t.slice(-4)===".bin"?s6(e):a6(e)}function v8(e,t,r,n){return r.slice(-4)===".bin"?o6(e,t,r,n):void 0}function _8(e,t,r){return t.slice(-4)===".bin"?r6(e,t,r):n6(e,t,r)}var zw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Uw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(zw),i,o,l,u;if(a)for(u=0;u!=a.length;++u)i=a[u].match(Uw),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function y8(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(zw),a,i,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(Uw),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Ll;function w8(e,t){var r=Ll[e]||vt(e);return r==="General"?gs(t):jn(r,t)}function k8(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=jt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=gr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[vt(t)]=a}function E8(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Cs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=gs(e.v):e.w=w8(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Ll[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Fo(n)){var a=ts(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function S8(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=kL[n.Pattern]||n.Pattern)}e[t.ID]=t}function T8(e,t,r,n,a,i,o,l,u,d){var h="General",m=n.StyleID,g={};d=d||{};var x=[],_=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(h=i[m].nf),i[m].Interior&&x.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=jt(e);break;case"String":n.t="s",n.r=u1(vt(e)),n.v=e.indexOf("<")>-1?vt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(gr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=vt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=nw[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=u1(t||e));break}if(E8(n,h,d),d.cellFormula!==!1)if(n.Formula){var y=vt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=fo(y,a),delete n.Formula,n.ArrayRange=="RC"?n.F=fo("RC:RC",a):n.ArrayRange&&(n.F=fo(n.ArrayRange,a),u.push([Gt(n.F),n.F]))}else for(_=0;_<u.length;++_)a.r>=u[_][0].s.r&&a.r<=u[_][0].e.r&&a.c>=u[_][0].s.c&&a.c<=u[_][0].e.c&&(n.F=u[_][1]);d.cellStyles&&(x.forEach(function(E){!g.patternType&&E.patternType&&(g.patternType=E.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function C8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function gd(e,t){var r=t||{};A2();var n=ll(im(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=At(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Tr(r);return o.type="string",Ql.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){a.indexOf("<"+Ue)>=0&&(i=!0)}),i)return j8(n,r);Ll={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],d,h={},m=[],g=r.dense?[]:{},x="",_={},y={},E=Hn('<Data ss:Type="String">'),k=0,S=0,w=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},R={},P="",H=0,B=[],W={},I={},Z=0,J=[],ge=[],_e={},de=[],Q,ee=!1,U=[],ne=[],ue={},F=0,te=0,q={Sheets:[],WBProps:{date1904:!1}},X={};Jl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";l=Jl.exec(n);)switch(l[3]=(K=l[3]).toLowerCase()){case"data":if(K=="data"){if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?T8(n.slice(k,l.index),P,E,u[u.length-1][0]=="comment"?_e:_,{c:S,r:w},D,de[S],y,U,r):(P="",E=Hn(l[0]),k=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(ge.length>0&&(_.c=ge),(!r.sheetRows||r.sheetRows>w)&&_.v!==void 0&&(r.dense?(g[w]||(g[w]=[]),g[w][S]=_):g[lr(S)+Cr(w)]=_),_.HRef&&(_.l={Target:vt(_.HRef)},_.HRefScreenTip&&(_.l.Tooltip=_.HRefScreenTip),delete _.HRef,delete _.HRefScreenTip),(_.MergeAcross||_.MergeDown)&&(F=S+(parseInt(_.MergeAcross,10)|0),te=w+(parseInt(_.MergeDown,10)|0),B.push({s:{c:S,r:w},e:{c:F,r:te}})),!r.sheetStubs)_.MergeAcross?S=F+1:++S;else if(_.MergeAcross||_.MergeDown){for(var ye=S;ye<=F;++ye)for(var Le=w;Le<=te;++Le)(ye>S||Le>w)&&(r.dense?(g[Le]||(g[Le]=[]),g[Le][ye]={t:"z"}):g[lr(ye)+Cr(Le)]={t:"z"});S=F+1}else++S;else _=y8(l[0]),_.Index&&(S=+_.Index-1),S<A.s.c&&(A.s.c=S),S>A.e.c&&(A.e.c=S),l[0].slice(-2)==="/>"&&++S,ge=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<A.s.r&&(A.s.r=w),w>A.e.r&&(A.e.r=w),l[0].slice(-2)==="/>"&&(y=Hn(l[0]),y.Index&&(w=+y.Index-1)),S=0,++w):(y=Hn(l[0]),y.Index&&(w=+y.Index-1),ue={},(y.AutoFitHeight=="0"||y.Height)&&(ue.hpx=parseInt(y.Height,10),ue.hpt=Sw(ue.hpx),ne[w]=ue),y.Hidden=="1"&&(ue.hidden=!0,ne[w]=ue));break;case"worksheet":if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));m.push(x),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(g["!ref"]=gt(A),r.sheetRows&&r.sheetRows<=A.e.r&&(g["!fullref"]=g["!ref"],A.e.r=r.sheetRows-1,g["!ref"]=gt(A))),B.length&&(g["!merges"]=B),de.length>0&&(g["!cols"]=de),ne.length>0&&(g["!rows"]=ne),h[x]=g}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=S=0,u.push([l[3],!1]),d=Hn(l[0]),x=vt(d.Name),g=r.dense?[]:{},B=[],U=[],ne=[],X={name:x,Hidden:0},q.Sheets.push(X);break;case"table":if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),de=[],ee=!1}break;case"style":l[1]==="/"?S8(D,R,r):R=Hn(l[0]);break;case"numberformat":R.nf=vt(Hn(l[0]).Format||"General"),Ll[R.nf]&&(R.nf=Ll[R.nf]);for(var be=0;be!=392&&nt[be]!=R.nf;++be);if(be==392){for(be=57;be!=392;++be)if(nt[be]==null){ss(R.nf,be);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Q=Hn(l[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!ee&&Q.wpx>10){ee=!0,Zr=kw;for(var ke=0;ke<de.length;++ke)de[ke]&&So(de[ke])}ee&&So(Q),de[Q.Index-1||de.length]=Q;for(var $e=0;$e<+Q.Span;++$e)de[de.length]=Tr(Q);break;case"namedrange":if(l[1]==="/")break;q.Names||(q.Names=[]);var G=Ye(l[0]),ot={Name:G.Name,Ref:fo(G.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ot.Sheet=q.Sheets.length-1),q.Names.push(ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?P+=n.slice(H,l.index):H=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=Hn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?cA(W,K,n.slice(Z,l.index)):Z=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));C8(_e),ge.push(_e)}else u.push([l[3],!1]),d=Hn(l[0]),_e={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var me=Hn(l[0]);g["!autofilter"]={ref:fo(me.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=u.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return q1(n,r);var Te=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(Z,l.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else Z=l.index+l[0].length;break;case"header":g["!margins"]||Al(g["!margins"]={},"xlml"),isNaN(+Ye(l[0]).Margin)||(g["!margins"].header=+Ye(l[0]).Margin);break;case"footer":g["!margins"]||Al(g["!margins"]={},"xlml"),isNaN(+Ye(l[0]).Margin)||(g["!margins"].footer=+Ye(l[0]).Margin);break;case"pagemargins":var Pe=Ye(l[0]);g["!margins"]||Al(g["!margins"]={},"xlml"),isNaN(+Pe.Top)||(g["!margins"].top=+Pe.Top),isNaN(+Pe.Left)||(g["!margins"].left=+Pe.Left),isNaN(+Pe.Right)||(g["!margins"].right=+Pe.Right),isNaN(+Pe.Bottom)||(g["!margins"].bottom=+Pe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?k8(I,K,J,n.slice(Z,l.index)):(J=l,Z=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=h),he.SheetNames=m,he.Workbook=q,he.SSF=Tr(nt),he.Props=W,he.Custprops=I,he}function Lh(e,t){switch(ym(t=t||{}),t.type||"base64"){case"base64":return gd(gn(e),t);case"binary":case"buffer":case"file":return gd(e,t);case"array":return gd(Es(e),t)}}function b8(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=UN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=HN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var N8=[60,1084,2066,2165,2175];function A8(e,t,r,n,a){var i=n,o=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=i;for(var u=Ia(r,r.l),d=Ph[u],h=0;d!=null&&N8.indexOf(u)>-1;)i=Ia(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),l=r.slice(h,r.l+4+i),o.push(l),r.l+=4+i,d=Ph[u=Ia(r,r.l)];var m=fi(o);wr(m,0);var g=0;m.lens=[];for(var x=0;x<o.length;++x)m.lens.push(g),g+=o[x].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function ua(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=nt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Cs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=gs(e.v):e.w=jn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Fo(nt[n]||String(n))){var a=ts(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function mu(e,t,r){return{v:e,ixfe:t,t:r}}function L8(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},l=null,u=[],d="",h={},m,g="",x,_,y,E,k={},S=[],w,A,D=[],R=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},H={},B=function(Ke){return Ke<8?os[Ke]:Ke<64&&R[Ke-8]||os[Ke]},W=function(Ke,wt,ur){var Ct=wt.XF.data;if(!(!Ct||!Ct.patternType||!ur||!ur.cellStyles)){wt.s={},wt.s.patternType=Ct.patternType;var Ar;(Ar=ec(B(Ct.icvFore)))&&(wt.s.fgColor={rgb:Ar}),(Ar=ec(B(Ct.icvBack)))&&(wt.s.bgColor={rgb:Ar})}},I=function(Ke,wt,ur){if(!(ue>1)&&!(ur.sheetRows&&Ke.r>=ur.sheetRows)){if(ur.cellStyles&&wt.XF&&wt.XF.data&&W(Ke,wt,ur),delete wt.ixfe,delete wt.XF,m=Ke,g=et(Ke),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ke.r<o.s.r&&(o.s.r=Ke.r),Ke.c<o.s.c&&(o.s.c=Ke.c),Ke.r+1>o.e.r&&(o.e.r=Ke.r+1),Ke.c+1>o.e.c&&(o.e.c=Ke.c+1),ur.cellFormula&&wt.f){for(var Ct=0;Ct<S.length;++Ct)if(!(S[Ct][0].s.c>Ke.c||S[Ct][0].s.r>Ke.r)&&!(S[Ct][0].e.c<Ke.c||S[Ct][0].e.r<Ke.r)){wt.F=gt(S[Ct][0]),(S[Ct][0].s.c!=Ke.c||S[Ct][0].s.r!=Ke.r)&&delete wt.f,wt.f&&(wt.f=""+Mr(S[Ct][1],o,Ke,U,Z));break}}ur.dense?(a[Ke.r]||(a[Ke.r]=[]),a[Ke.r][Ke.c]=wt):a[g]=wt}},Z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Z.password=t.password);var J,ge=[],_e=[],de=[],Q=[],ee=!1,U=[];U.SheetNames=Z.snames,U.sharedf=Z.sharedf,U.arrayf=Z.arrayf,U.names=[],U.XTI=[];var ne=0,ue=0,F=0,te=[],q=[],X;Z.codepage=1200,qn(1200);for(var K=!1;e.l<e.length-1;){var ye=e.l,Le=e.read_shift(2);if(Le===0&&ne===10)break;var be=e.l===e.length?0:e.read_shift(2),ke=Ph[Le];if(ke&&ke.f){if(t.bookSheets&&ne===133&&Le!==133)break;if(ne=Le,ke.r===2||ke.r==12){var $e=e.read_shift(2);if(be-=2,!Z.enc&&$e!==Le&&(($e&255)<<8|$e>>8)!==Le)throw new Error("rt mismatch: "+$e+"!="+Le);ke.r==12&&(e.l+=10,be-=10)}var G={};if(Le===10?G=ke.f(e,be,Z):G=A8(Le,ke,e,be,Z),ue==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(Le){case 34:r.opts.Date1904=P.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Z.enc||(e.l=0),Z.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:Z.lastuser=G;break;case 66:var ot=Number(G);switch(ot){case 21010:ot=1200;break;case 32768:ot=1e4;break;case 32769:ot=1252;break}qn(Z.codepage=ot),K=!0;break;case 317:Z.rrtabid=G;break;case 25:Z.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:Z.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(a["!type"]="dialog"),G.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),G.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:D.push(G);break;case 430:U.push([G]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(G);break;case 24:case 536:X={Name:G.Name,Ref:Mr(G.rgce,o,null,U,Z)},G.itab>0&&(X.Sheet=G.itab-1),U.names.push(X),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(q[G.itab-1]={ref:gt(G.rgce[0][0][1][2])});break;case 22:Z.ExternCount=G;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(G),U.XTI=U.XTI.concat(G);break;case 2196:if(Z.biff<8)break;X!=null&&(X.Comment=G[1]);break;case 18:a["!protect"]=G;break;case 19:G!==0&&Z.WTF&&console.error("Password verifier: "+G);break;case 133:i[G.pos]=G,Z.snames.push(G.name);break;case 10:{if(--ue)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=gt(o),t.sheetRows&&t.sheetRows<=o.e.r){var me=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=gt(o),o.e.r=me}o.e.r++,o.e.c++}ge.length>0&&(a["!merges"]=ge),_e.length>0&&(a["!objects"]=_e),de.length>0&&(a["!cols"]=de),Q.length>0&&(a["!rows"]=Q),P.Sheets.push(H)}d===""?h=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Z.biff===8&&(Z.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),Z.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(Z.biff=5,K=!0,qn(Z.codepage=28591)),Z.biff==8&&G.BIFFVer==0&&G.dt==16&&(Z.biff=2),ue++)break;if(a=t.dense?[]:{},Z.biff<8&&!K&&(K=!0,qn(Z.codepage=t.codepage||1252)),Z.biff<5||G.BIFFVer==0&&G.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-be,name:d};i[Te.pos]=Te,Z.snames.push(d)}else d=(i[ye]||{name:""}).name;G.dt==32&&(a["!type"]="chart"),G.dt==64&&(a["!type"]="macro"),ge=[],_e=[],Z.arrayf=S=[],de=[],Q=[],ee=!1,H={Hidden:(i[ye]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[G.r]||[])[G.c]:a[et({c:G.c,r:G.r})])&&++G.c,w={ixfe:G.ixfe,XF:D[G.ixfe]||{},v:G.val,t:"n"},F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:G.c,r:G.r},w,t);break;case 5:case 517:w={ixfe:G.ixfe,XF:D[G.ixfe],v:G.val,t:G.t},F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:G.c,r:G.r},w,t);break;case 638:w={ixfe:G.ixfe,XF:D[G.ixfe],v:G.rknum,t:"n"},F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:G.c,r:G.r},w,t);break;case 189:for(var Pe=G.c;Pe<=G.C;++Pe){var he=G.rkrec[Pe-G.c][0];w={ixfe:he,XF:D[he],v:G.rkrec[Pe-G.c][1],t:"n"},F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:Pe,r:G.r},w,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){l=G;break}if(w=mu(G.val,G.cell.ixfe,G.tt),w.XF=D[w.ixfe],t.cellFormula){var Ue=G.formula;if(Ue&&Ue[0]&&Ue[0][0]&&Ue[0][0][0]=="PtgExp"){var We=Ue[0][0][1][0],yt=Ue[0][0][1][1],Tt=et({r:We,c:yt});k[Tt]?w.f=""+Mr(G.formula,o,G.cell,U,Z):w.F=((t.dense?(a[We]||[])[yt]:a[Tt])||{}).F}else w.f=""+Mr(G.formula,o,G.cell,U,Z)}F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I(G.cell,w,t),l=G}break;case 7:case 519:if(l)l.val=G,w=mu(G,l.cell.ixfe,"s"),w.XF=D[w.ixfe],t.cellFormula&&(w.f=""+Mr(l.formula,o,l.cell,U,Z)),F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(G);var dt=et(G[0].s);if(x=t.dense?(a[G[0].s.r]||[])[G[0].s.c]:a[dt],t.cellFormula&&x){if(!l||!dt||!x)break;x.f=""+Mr(G[1],o,G[0],U,Z),x.F=gt(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!l)break;k[et(l.cell)]=G[0],x=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[et(l.cell)],(x||{}).f=""+Mr(G[0],o,m,U,Z)}}break;case 253:w=mu(u[G.isst].t,G.ixfe,"s"),u[G.isst].h&&(w.h=u[G.isst].h),w.XF=D[w.ixfe],F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:G.c,r:G.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:G.ixfe,XF:D[G.ixfe],t:"z"},F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:G.c,r:G.r},w,t));break;case 190:if(t.sheetStubs)for(var St=G.c;St<=G.C;++St){var _t=G.ixfe[St-G.c];w={ixfe:_t,XF:D[_t],t:"z"},F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:St,r:G.r},w,t)}break;case 214:case 516:case 4:w=mu(G.val,G.ixfe,"s"),w.XF=D[w.ixfe],F>0&&(w.z=te[w.ixfe>>8&63]),ua(w,t,r.opts.Date1904),I({c:G.c,r:G.r},w,t);break;case 0:case 512:ue===1&&(o=G);break;case 252:u=G;break;case 1054:if(Z.biff==4){te[F++]=G[1];for(var ar=0;ar<F+163&&nt[ar]!=G[1];++ar);ar>=163&&ss(G[1],F+163)}else ss(G[1],G[0]);break;case 30:{te[F++]=G;for(var Yt=0;Yt<F+163&&nt[Yt]!=G;++Yt);Yt>=163&&ss(G,F+163)}break;case 229:ge=ge.concat(G);break;case 93:_e[G.cmo[0]]=Z.lastobj=G;break;case 438:Z.lastobj.TxO=G;break;case 127:Z.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(y=G[0].s.c;y<=G[0].e.c;++y)x=t.dense?(a[E]||[])[y]:a[et({c:y,r:E})],x&&(x.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(y=G[0].s.c;y<=G[0].e.c;++y)x=t.dense?(a[E]||[])[y]:a[et({c:y,r:E})],x&&x.l&&(x.l.Tooltip=G[1]);break;case 28:{if(Z.biff<=5&&Z.biff>=2)break;x=t.dense?(a[G[0].r]||[])[G[0].c]:a[et(G[0])];var _n=_e[G[2]];x||(t.dense?(a[G[0].r]||(a[G[0].r]=[]),x=a[G[0].r][G[0].c]={t:"z"}):x=a[et(G[0])]={t:"z"},o.e.r=Math.max(o.e.r,G[0].r),o.s.r=Math.min(o.s.r,G[0].r),o.e.c=Math.max(o.e.c,G[0].c),o.s.c=Math.min(o.s.c,G[0].c)),x.c||(x.c=[]),_={a:G[1],t:_n.TxO.t},x.c.push(_)}break;case 2173:JL(D[G.ixfe],G.ext);break;case 125:{if(!Z.cellStyles)break;for(;G.e>=G.s;)de[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},ee||(ee=!0,mm(G.w/256)),So(de[G.e+1])}break;case 520:{var Vt={};G.level!=null&&(Q[G.r]=Vt,Vt.level=G.level),G.hidden&&(Q[G.r]=Vt,Vt.hidden=!0),G.hpt&&(Q[G.r]=Vt,Vt.hpt=G.hpt,Vt.hpx=tc(G.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Al(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=G;break;case 161:a["!margins"]||Al(a["!margins"]={}),a["!margins"].header=G.header,a["!margins"].footer=G.footer;break;case 574:G.RTL&&(P.Views[0].RTL=!0);break;case 146:R=G;break;case 2198:J=G;break;case 140:A=G;break;case 442:d?H.CodeName=G||H.name:P.WBProps.CodeName=G||"ThisWorkbook";break}}else ke||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),e.l+=be}return r.SheetNames=_a(i).sort(function(Nr,Ke){return Number(Nr)-Number(Ke)}).map(function(Nr){return i[Nr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&q.forEach(function(Nr,Ke){r.Sheets[r.SheetNames[Ke]]["!autofilter"]=Nr}),r.Strings=u,r.SSF=Tr(nt),Z.enc&&(r.Encryption=Z.enc),J&&(r.Themes=J),r.Metadata={},A!==void 0&&(r.Metadata.Country=A),U.names.length>0&&(P.Names=U.names),r.Workbook=P,r}var V1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function P8(e,t,r){var n=mt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=C1(n,qN,V1.DSI);for(var i in a)t[i]=a[i]}catch(d){if(r.WTF)throw d}var o=mt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=C1(o,XN,V1.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(iw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Hw(e,t){t||(t={}),ym(t),x2(),t.codepage&&Jp(t.codepage);var r,n;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");r=mt.find(e,"!CompObj"),n=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(t.type){case"base64":e=Zn(gn(e));break;case"binary":e=Zn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var a,i;if(r&&b8(r),t.bookProps&&!t.bookSheets)a={};else{var o=ut?"buffer":"array";if(n&&n.content)a=L8(n.content,t);else if((i=mt.find(e,"PerfectOffice_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=o,t));else if((i=mt.find(e,"NativeContent_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=o,t));else throw(i=mt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=g6(e))}var l={};return e.FullPaths&&P8(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}var bf={0:{f:dF},1:{f:gF},2:{f:TF},3:{f:yF},4:{f:vF},5:{f:SF},6:{f:NF},7:{f:kF},8:{f:OF},9:{f:FF},10:{f:LF},11:{f:PF},12:{f:xF},13:{f:CF},14:{f:wF},15:{f:_F},16:{f:Dw},17:{f:AF},18:{f:EF},19:{f:cm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:s8},40:{},42:{},43:{f:LL},44:{f:AL},45:{f:PL},46:{f:OL},47:{f:FL},48:{},49:{f:MN},50:{},51:{f:e6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xw},62:{f:bF},63:{f:i6},64:{f:HF},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ur,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:UF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mF},148:{f:hF,p:16},151:{f:RF},152:{},153:{f:a8},154:{},155:{},156:{f:n8},157:{},158:{},159:{T:1,f:X5},160:{T:-1},161:{T:1,f:Ts},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:MF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:QL},336:{T:-1},337:{f:t6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ch},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DF},427:{f:IF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:zF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:pF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:jF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ch},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:h6},633:{T:1},634:{T:-1},635:{T:1,f:d6},636:{T:-1},637:{f:RN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:qF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:VF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ph={6:{f:pd},10:{f:ai},12:{f:rr},13:{f:rr},14:{f:qt},15:{f:qt},16:{f:Dr},17:{f:qt},18:{f:qt},19:{f:rr},20:{f:L1},21:{f:L1},23:{f:gw},24:{f:F1},25:{f:qt},26:{},27:{},28:{f:u5},29:{},34:{f:qt},35:{f:P1},38:{f:Dr},39:{f:Dr},40:{f:Dr},41:{f:Dr},42:{f:qt},43:{f:qt},47:{f:pL},49:{f:$A},51:{f:rr},60:{},61:{f:HA},64:{f:qt},65:{f:WA},66:{f:rr},77:{},80:{},81:{},82:{},85:{f:rr},89:{},90:{},91:{},92:{f:MA},93:{f:d5},94:{},95:{f:qt},96:{},97:{},99:{f:qt},125:{f:xw},128:{f:t5},129:{f:jA},130:{f:rr},131:{f:qt},132:{f:qt},133:{f:RA},134:{},140:{f:v5},141:{f:rr},144:{},146:{f:y5},151:{},152:{},153:{},154:{},155:{},156:{f:rr},157:{},158:{},160:{f:T5},161:{f:k5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KA},190:{f:JA},193:{f:ai},197:{},198:{},199:{},200:{},201:{},202:{f:qt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rr},220:{},221:{f:qt},222:{},224:{f:e5},225:{f:OA},226:{f:ai},227:{},229:{f:f5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:DA},253:{f:GA},255:{f:IA},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:uw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qt},353:{f:ai},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:n5},431:{f:qt},432:{},433:{},434:{},437:{},438:{f:m5},439:{f:qt},440:{f:g5},441:{},442:{f:_c},443:{},444:{f:rr},445:{},446:{},448:{f:ai},449:{f:UA,r:2},450:{f:ai},512:{f:N1},513:{f:S5},515:{f:r5},516:{f:ZA},517:{f:A1},519:{f:C5},520:{f:BA},523:{},545:{f:O1},549:{f:b1},566:{},574:{f:VA},638:{f:YA},659:{},1048:{},1054:{f:qA},1084:{},1212:{f:o5},2048:{f:x5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:du},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ai},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:w5,r:12},2173:{f:KL,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:s5,r:12},2197:{},2198:{f:$L,r:12},2199:{},2200:{},2201:{},2202:{f:l5,r:12},2203:{f:ai},2204:{},2205:{},2206:{},2207:{},2211:{f:zA},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:E5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:N1},1:{},2:{f:L5},3:{f:A5},4:{f:N5},5:{f:A1},7:{f:P5},8:{},9:{f:du},11:{},22:{f:rr},30:{f:XA},31:{},32:{},33:{f:O1},36:{},37:{f:b1},50:{f:F5},62:{},52:{},67:{},68:{f:rr},69:{},86:{},126:{},127:{f:b5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:O5},223:{},234:{},354:{},421:{},518:{f:pd},521:{f:du},536:{f:F1},547:{f:P1},561:{},579:{},1030:{f:pd},1033:{f:du},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vn(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&K2(r)&&e.push(r)}}function W1(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,l=i&&i.index||e.length,u=rN(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,m=0,g=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},_=[];for(o=0;o<u.length;++o){var y=u[o].trim(),E=y.slice(0,3).toLowerCase();if(E=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(E!="<td"&&E!="<th")){var k=y.split(/<\/t[dh]>/i);for(l=0;l<k.length;++l){var S=k[l].trim();if(S.match(/<t[dh]/i)){for(var w=S,A=0;w.charAt(0)=="<"&&(A=w.indexOf(">"))>-1;)w=w.slice(A+1);for(var D=0;D<_.length;++D){var R=_[D];R.s.c==h&&R.s.r<d&&d<=R.e.r&&(h=R.e.c+1,D=-1)}var P=Ye(S.slice(0,S.indexOf(">")));g=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||g>1)&&_.push({s:{r:d,c:h},e:{r:d+(m||1)-1,c:h+g-1}});var H=P.t||P["data-t"]||"";if(!w.length){h+=g;continue}if(w=I2(w),x.s.r>d&&(x.s.r=d),x.e.r<d&&(x.e.r=d),x.s.c>h&&(x.s.c=h),x.e.c<h&&(x.e.c=h),!w.length){h+=g;continue}var B={t:"s",v:w};r.raw||!w.trim().length||H=="s"||(w==="TRUE"?B={t:"b",v:!0}:w==="FALSE"?B={t:"b",v:!1}:isNaN(Jn(w))?isNaN(Eo(w).getDate())||(B={t:"d",v:gr(w)},r.cellDates||(B={t:"n",v:Kr(B.v)}),B.z=r.dateNF||nt[14]):B={t:"n",v:Jn(w)}),r.dense?(n[d]||(n[d]=[]),n[d][h]=B):n[et({r:d,c:h})]=B,h+=g}}}}return n["!ref"]=gt(x),_.length&&(n["!merges"]=_),n}function F8(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){l=-1;break}l=a[d].e.r-a[d].s.r+1,u=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var h=et({r,c:o}),m=n.dense?(e[r]||[])[o]:e[h],g=m&&m.v!=null&&(m.h||am(m.w||(qa(m),m.w)||""))||"",x={};l>1&&(x.rowspan=l),u>1&&(x.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":m&&(x["data-t"]=m&&m.t||"z",m.v!=null&&(x["data-v"]=m.v),m.z!=null&&(x["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),x.id=(n.id||"sjs")+"-"+h,i.push(vN("td",g,x))}}var _="<tr>";return _+i.join("")+"</tr>"}var O8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',M8="</body></html>";function j8(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Di(W1(r[0],t),t);var n=km();return r.forEach(function(a,i){Em(n,W1(a,t),"Sheet"+(i+1))}),n}function R8(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function D8(e,t){var r=t||{},n=r.header!=null?r.header:O8,a=r.footer!=null?r.footer:M8,i=[n],o=Oo(e["!ref"]);r.dense=Array.isArray(e),i.push(R8(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(F8(e,o,l,r));return i.push("</table>"+a),i.join("")}function Vw(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?qr(n.origin):n.origin;a=o.r,i=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Oo(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),a==-1&&(d.e.r=a=h.e.r+1)}var m=[],g=0,x=e["!rows"]||(e["!rows"]=[]),_=0,y=0,E=0,k=0,S=0,w=0;for(e["!cols"]||(e["!cols"]=[]);_<l.length&&y<u;++_){var A=l[_];if($1(A)){if(n.display)continue;x[y]={hidden:!0}}var D=A.children;for(E=k=0;E<D.length;++E){var R=D[E];if(!(n.display&&$1(R))){var P=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):I2(R.innerHTML),H=R.getAttribute("data-z")||R.getAttribute("z");for(g=0;g<m.length;++g){var B=m[g];B.s.c==k+i&&B.s.r<y+a&&y+a<=B.e.r&&(k=B.e.c+1-i,g=-1)}w=+R.getAttribute("colspan")||1,((S=+R.getAttribute("rowspan")||1)>1||w>1)&&m.push({s:{r:y+a,c:k+i},e:{r:y+a+(S||1)-1,c:k+i+(w||1)-1}});var W={t:"s",v:P},I=R.getAttribute("data-t")||R.getAttribute("t")||"";P!=null&&(P.length==0?W.t=I||"z":n.raw||P.trim().length==0||I=="s"||(P==="TRUE"?W={t:"b",v:!0}:P==="FALSE"?W={t:"b",v:!1}:isNaN(Jn(P))?isNaN(Eo(P).getDate())||(W={t:"d",v:gr(P)},n.cellDates||(W={t:"n",v:Kr(W.v)}),W.z=n.dateNF||nt[14]):W={t:"n",v:Jn(P)})),W.z===void 0&&H!=null&&(W.z=H);var Z="",J=R.getElementsByTagName("A");if(J&&J.length)for(var ge=0;ge<J.length&&!(J[ge].hasAttribute("href")&&(Z=J[ge].getAttribute("href"),Z.charAt(0)!="#"));++ge);Z&&Z.charAt(0)!="#"&&(W.l={Target:Z}),n.dense?(e[y+a]||(e[y+a]=[]),e[y+a][k+i]=W):e[et({c:k+i,r:y+a})]=W,d.e.c<k+i&&(d.e.c=k+i),k+=w}}++y}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,y-1+a),e["!ref"]=gt(d),y>=u&&(e["!fullref"]=gt((d.e.r=l.length-_+y-1+a,d))),e}function Ww(e,t){var r=t||{},n=r.dense?[]:{};return Vw(n,e,t)}function I8(e,t){return Di(Ww(e,t),t)}function $1(e){var t="",r=B8(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function B8(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function z8(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=vt(t.replace(/<[^>]*>/g,""));return[r]}var G1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $w(e,t){var r=t||{},n=im(e),a=[],i,o,l={name:""},u="",d=0,h,m,g={},x=[],_=r.dense?[]:{},y,E,k={value:""},S="",w=0,A=[],D=-1,R=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},H=0,B={},W=[],I={},Z=0,J=0,ge=[],_e=1,de=1,Q=[],ee={Names:[]},U={},ne=["",""],ue=[],F={},te="",q=0,X=!1,K=!1,ye=0;for(Jl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Jl.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?_["!ref"]=gt(P):_["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(_["!fullref"]=_["!ref"],P.e.r=r.sheetRows-1,_["!ref"]=gt(P)),W.length&&(_["!merges"]=W),ge.length&&(_["!rows"]=ge),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),x.push(h.name),g[h.name]=_,K=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=Ye(y[0],!1),D=R=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,_=r.dense?[]:{},W=[],ge=[],K=!0);break;case"table-row-group":y[1]==="/"?--H:++H;break;case"table-row":case"":if(y[1]==="/"){D+=_e,_e=1;break}if(m=Ye(y[0],!1),m.?D=m.-1:D==-1&&(D=0),_e=+m["number-rows-repeated"]||1,_e<10)for(ye=0;ye<_e;++ye)H>0&&(ge[D+ye]={level:H});R=-1;break;case"covered-table-cell":y[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(_[D]||(_[D]=[]),_[D][R]={t:"z"}):_[et({r:D,c:R})]={t:"z"}),S="",A=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++R,k=Ye(y[0],!1),de=parseInt(k["number-columns-repeated"]||"1",10),E={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(E.f=z1(vt(k.formula))),(k.||k["value-type"])=="string"&&(E.t="s",E.v=vt(k["string-value"]||""),r.dense?(_[D]||(_[D]=[]),_[D][R]=E):_[et({r:D,c:R})]=E),R+=de-1;else if(y[1]!=="/"){++R,S="",w=0,A=[],de=1;var Le=_e?D+_e-1:D;if(R>P.e.c&&(P.e.c=R),R<P.s.c&&(P.s.c=R),D<P.s.r&&(P.s.r=D),Le>P.e.r&&(P.e.r=Le),k=Ye(y[0],!1),ue=[],F={},E={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=vt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Z=parseInt(k["number-matrix-rows-spanned"],10)||0,J=parseInt(k["number-matrix-columns-spanned"],10)||0,I={s:{r:D,c:R},e:{r:D+Z-1,c:R+J-1}},E.F=gt(I),Q.push([I,E.F])),k.formula)E.f=z1(k.formula);else for(ye=0;ye<Q.length;++ye)D>=Q[ye][0].s.r&&D<=Q[ye][0].e.r&&R>=Q[ye][0].s.c&&R<=Q[ye][0].e.c&&(E.F=Q[ye][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Z=parseInt(k["number-rows-spanned"],10)||0,J=parseInt(k["number-columns-spanned"],10)||0,I={s:{r:D,c:R},e:{r:D+Z-1,c:R+J-1}},W.push(I)),k["number-columns-repeated"]&&(de=parseInt(k["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=jt(k["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(k.value);break;case"percentage":E.t="n",E.v=parseFloat(k.value);break;case"currency":E.t="n",E.v=parseFloat(k.value);break;case"date":E.t="d",E.v=gr(k["date-value"]),r.cellDates||(E.t="n",E.v=Kr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=Qb(k["time-value"])/86400,r.cellDates&&(E.t="d",E.v=t0(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(k.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",k["string-value"]!=null&&(S=vt(k["string-value"]),A=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(X=!1,E.t==="s"&&(E.v=S||"",A.length&&(E.R=A),X=w==0),U.Target&&(E.l=U),ue.length>0&&(E.c=ue,ue=[]),S&&r.cellText!==!1&&(E.w=S),X&&(E.t="z",delete E.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var be=0;be<_e;++be){if(de=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(_[D+be]||(_[D+be]=[]),_[D+be][R]=be==0?E:Tr(E);--de>0;)_[D+be][R+de]=Tr(E);else for(_[et({r:D+be,c:R})]=E;--de>0;)_[et({r:D+be,c:R+de})]=Tr(E);P.e.c<=R&&(P.e.c=R)}de=parseInt(k["number-columns-repeated"]||"1",10),R+=de-1,de=0,E={},S="",A=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i;F.t=S,A.length&&(F.R=A),F.a=te,ue.push(F)}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);te="",q=0,S="",w=0,A=[];break;case"creator":y[1]==="/"?te=n.slice(q,y.index):q=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);S="",w=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(B[l.name]=u,(i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(u="",l=Ye(y[0],!1),a.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Ye(y[0],!1),u+=G1[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Ye(y[0],!1),u+=G1[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":o=Ye(y[0],!1),ne=md(o["cell-range-address"]);var ke={Name:o.name,Ref:ne[0]+"!"+ne[1]};K&&(ke.Sheet=x.length),ee.Names.push(ke);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var $e=z8(n.slice(w,y.index));S=(S.length>0?S+`
`:"")+$e[0]}else Ye(y[0],!1),w=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{ne=md(Ye(y[0])["target-range-address"]),g[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(U=Ye(y[0],!1),!U.href)break;U.Target=vt(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(ne=md(U.Target.slice(1)),U.Target="#"+ne[0]+"!"+ne[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var G={Sheets:g,SheetNames:x,Workbook:ee};return r.bookSheets&&delete G.Sheets,G}function Z1(e,t){t=t||{},Cn(e,"META-INF/manifest.xml")&&rA(tr(e,"META-INF/manifest.xml"),t);var r=fn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=$w(At(r),t);return Cn(e,"meta.xml")&&(n.Props=aw(tr(e,"meta.xml"))),n}function q1(e,t){return $w(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function vm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):At(Es(e))}function Oh(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function X1(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function U8(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function rc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function cr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ir(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=rc(e,r),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=rc(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:l,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function _m(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function H8(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=rc(e,n),i=Ir(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:cr(i[1][0].data),messages:[]};i[2].forEach(function(l){var u=Ir(l.data),d=cr(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=cr(i[3][0].data)>>>0>0),r.push(o)}return r}function V8(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=rc(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Oh(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(d>=u)for(a.push(a[0].slice(-u)),d-=u;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-u,-u+d))}}var h=Oh(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function W8(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(V8(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Oh(t)}function $8(e,t,r,n){var a=vm(e),i=a.getUint32(4,!0),o=(n>1?12:8)+X1(i&(n>1?3470:398))*4,l=-1,u=-1,d=NaN,h=new Date(2001,0,1);i&512&&(l=a.getUint32(o,!0),o+=4),o+=X1(i&(n>1?12288:4096))*4,i&16&&(u=a.getUint32(o,!0),o+=4),i&32&&(d=a.getFloat64(o,!0),o+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function G8(e,t,r){var n=vm(e),a=n.getUint32(8,!0),i=12,o=-1,l=-1,u=NaN,d=NaN,h=new Date(2001,0,1);a&1&&(u=U8(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function Z8(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return $8(e,t,r,e[0]);case 5:return G8(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function bi(e){var t=Ir(e);return rc(t[1][0].data)}function Y1(e,t){var r=Ir(t.data),n=cr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var l=Ir(o.data),u=cr(l[1][0].data)>>>0;switch(n){case 1:i[u]=Fh(l[3][0].data);break;case 8:{var d=e[bi(l[9][0].data)][0],h=Ir(d.data),m=e[bi(h[1][0].data)][0],g=cr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var x=Ir(m.data);i[u]=x[3].map(function(_){return Fh(_.data)}).join("")}break}}),i}function q8(e,t){var r,n,a,i,o,l,u,d,h,m,g,x,_,y,E=Ir(e),k=cr(E[1][0].data)>>>0,S=cr(E[2][0].data)>>>0,w=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&cr(E[8][0].data)>0||!1,A,D;if((i=(a=E[7])==null?void 0:a[0])!=null&&i.data&&t!=0)A=(l=(o=E[7])==null?void 0:o[0])==null?void 0:l.data,D=(d=(u=E[6])==null?void 0:u[0])==null?void 0:d.data;else if((m=(h=E[4])==null?void 0:h[0])!=null&&m.data&&t!=1)A=(x=(g=E[4])==null?void 0:g[0])==null?void 0:x.data,D=(y=(_=E[3])==null?void 0:_[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=w?4:1,P=vm(A),H=[],B=0;B<A.length/2;++B){var W=P.getUint16(B*2,!0);W<65535&&H.push([B,W])}if(H.length!=S)throw"Expected ".concat(S," cells, found ").concat(H.length);var I=[];for(B=0;B<H.length-1;++B)I[H[B][0]]=D.subarray(H[B][1]*R,H[B+1][1]*R);return H.length>=1&&(I[H[H.length-1][0]]=D.subarray(H[H.length-1][1]*R)),{R:k,cells:I}}function X8(e,t){var r,n=Ir(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?cr(n[7][0].data)>>>0>0?1:0:-1,i=_m(n[5],function(o){return q8(o,a)});return{nrows:cr(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=u}),o},[])}}function Y8(e,t,r){var n,a=Ir(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(cr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(cr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=gt(i);var o=Ir(a[4][0].data),l=Y1(e,e[bi(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?Y1(e,e[bi(o[17][0].data)][0]):[],d=Ir(o[3][0].data),h=0;d[1].forEach(function(m){var g=Ir(m.data),x=e[bi(g[2][0].data)][0],_=cr(x.meta[1][0].data);if(_!=6002)throw new Error("6001 unexpected reference to ".concat(_));var y=X8(e,x);y.data.forEach(function(E,k){E.forEach(function(S,w){var A=et({r:h+k,c:w}),D=Z8(S,l,u);D&&(r[A]=D)})}),h+=y.nrows})}function K8(e,t){var r=Ir(t.data),n={"!ref":"A1"},a=e[bi(r[2][0].data)],i=cr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Y8(e,a[0],n),n}function J8(e,t){var r,n=Ir(t.data),a={name:(r=n[1])!=null&&r[0]?Fh(n[1][0].data):"",sheets:[]},i=_m(n[2],bi);return i.forEach(function(o){e[o].forEach(function(l){var u=cr(l.meta[1][0].data);u==6e3&&a.sheets.push(K8(e,l))})}),a}function Q8(e,t){var r=km(),n=Ir(t.data),a=_m(n[1],bi);if(a.forEach(function(i){e[i].forEach(function(o){var l=cr(o.meta[1][0].data);if(l==2){var u=J8(e,o);u.sheets.forEach(function(d,h){Em(r,d,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function xd(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var d;try{d=W8(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var h;try{h=H8(d)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&cr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(u){i[u].forEach(function(d){var h=cr(d.meta[1][0].data)>>>0;if(h==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Q8(i,l)}function eO(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function ym(e){eO([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function tO(e){return to.WS.indexOf(e)>-1?"sheet":e==to.CS?"chart":e==to.DS?"dialog":e==to.MS?"macro":e&&e.length?e:"sheet"}function rO(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,tO(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function nO(e,t,r,n,a,i,o,l,u,d,h,m){try{i[n]=Tl(fn(e,r,!0),t);var g=tr(e,t),x;switch(l){case"sheet":x=c8(g,t,a,u,i[n],d,h,m);break;case"chart":if(x=u8(g,t,a,u,i[n],d,h,m),!x||!x["!drawel"])break;var _=ul(x["!drawel"].Target,t),y=bh(_),E=l6(fn(e,_,!0),Tl(fn(e,y,!0),_)),k=ul(E,_),S=bh(k);x=GF(fn(e,k,!0),k,u,Tl(fn(e,S,!0),k),d,x);break;case"macro":x=f8(g,t,a,u,i[n],d,h,m);break;case"dialog":x=d8(g,t,a,u,i[n],d,h,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=x;var w=[];i&&i[n]&&_a(i[n]).forEach(function(A){var D="";if(i[n][A].Type==to.CMNT){D=ul(i[n][A].Target,t);var R=g8(tr(e,D,!0),D,u);if(!R||!R.length)return;j1(x,R,!1)}i[n][A].Type==to.TCMNT&&(D=ul(i[n][A].Target,t),w=w.concat(u6(tr(e,D,!0),u)))}),w&&w.length&&j1(x,w,!0,u.people||[])}catch(A){if(u.WTF)throw A}}function Sn(e){return e.charAt(0)=="/"?e.slice(1):e}function aO(e,t){if(A2(),t=t||{},ym(t),Cn(e,"META-INF/manifest.xml")||Cn(e,"objectdata.xml"))return Z1(e,t);if(Cn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof xd<"u"){if(e.FileIndex)return xd(e);var r=mt.utils.cfb_new();return l1(e).forEach(function(ge){iN(r,ge,aN(e,ge))}),xd(r)}throw new Error("Unsupported NUMBERS file")}if(!Cn(e,"[Content_Types].xml"))throw Cn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Cn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=l1(e),a=eA(fn(e,"[Content_Types].xml")),i=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",tr(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!tr(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},d={};if(!t.bookSheets&&!t.bookProps){if(Nl=[],a.sst)try{Nl=m8(tr(e,Sn(a.sst)),a.sst,t)}catch(ge){if(t.WTF)throw ge}t.cellStyles&&a.themes.length&&(u=p8(fn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=h8(tr(e,Sn(a.style)),a.style,u,t))}a.links.map(function(ge){try{var _e=Tl(fn(e,bh(Sn(ge))),ge);return v8(tr(e,Sn(ge)),_e,ge,t)}catch{}});var h=l8(tr(e,Sn(a.workbooks[0])),a.workbooks[0],t),m={},g="";a.coreprops.length&&(g=tr(e,Sn(a.coreprops[0]),!0),g&&(m=aw(g)),a.extprops.length!==0&&(g=tr(e,Sn(a.extprops[0]),!0),g&&iA(g,m,t)));var x={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(g=fn(e,Sn(a.custprops[0]),!0),g&&(x=oA(g,t)));var _={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(_e){return _e.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(_.Props=m,_.Custprops=x),t.bookSheets&&typeof o<"u"&&(_.SheetNames=o),t.bookSheets?_.SheetNames:t.bookProps))return _;o={};var y={};t.bookDeps&&a.calcchain&&(y=x8(tr(e,Sn(a.calcchain)),a.calcchain));var E=0,k={},S,w;{var A=h.Sheets;m.Worksheets=A.length,m.SheetNames=[];for(var D=0;D!=A.length;++D)m.SheetNames[D]=A[D].name}var R=i?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),H=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Cn(e,H)||(H="xl/_rels/workbook."+R+".rels");var B=Tl(fn(e,H,!0),H.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=_8(tr(e,Sn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=f6(tr(e,Sn(a.people[0])),t)),B&&(B=rO(B,h.Sheets));var W=tr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=m.Worksheets;++E){var I="sheet";if(B&&B[E]?(S="xl/"+B[E][1].replace(/[\/]?xl\//,""),Cn(e,S)||(S=B[E][1]),Cn(e,S)||(S=H.replace(/_rels\/.*$/,"")+B[E][1]),I=B[E][2]):(S="xl/worksheets/sheet"+(E+1-W)+"."+R,S=S.replace(/sheet0\./,"sheet.")),w=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(m.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Z=!1,J=0;J!=t.sheets.length;++J)typeof t.sheets[J]=="number"&&t.sheets[J]==E&&(Z=1),typeof t.sheets[J]=="string"&&t.sheets[J].toLowerCase()==m.SheetNames[E].toLowerCase()&&(Z=1);if(!Z)continue e}}nO(e,S,w,m.SheetNames[E],E,k,o,I,t,h,u,d)}return _={Directory:a,Workbook:h,Props:m,Custprops:x,Deps:y,Sheets:o,SheetNames:m.SheetNames,Strings:Nl,Styles:d,Themes:u,SSF:Tr(nt)},t&&t.bookFiles&&(e.files?(_.keys=n,_.files=e.files):(_.keys=[],_.files={},e.FullPaths.forEach(function(ge,_e){ge=ge.replace(/^Root Entry[\/]/,""),_.keys.push(ge),_.files[ge]=e.FileIndex[_e]}))),t&&t.bookVBA&&(a.vba.length>0?_.vbaraw=tr(e,Sn(a.vba[0]),!0):a.defaults&&a.defaults.bin===m6&&(_.vbaraw=tr(e,"xl/vbaProject.bin",!0))),_}function iO(e,t){var r=t||{},n="Workbook",a=mt.find(e,n);try{if(n="/!DataSpaces/Version",a=mt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(K5(a.content),n="/!DataSpaces/DataSpaceMap",a=mt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Q5(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=mt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=eL(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=mt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);rL(a.content)}catch{}if(n="/EncryptionInfo",a=mt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=nL(a.content);if(n="/EncryptedPackage",a=mt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function wm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=gn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sO(e,t){return mt.find(e,"EncryptedPackage")?iO(e,t):Hw(e,t)}function oO(e,t){var r,n=e,a=t||{};return a.type||(a.type=ut&&Buffer.isBuffer(e)?"buffer":"base64"),r=j2(n,a),aO(r,a)}function Gw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lh(e.slice(r),t);default:break e}return Ql.to_workbook(e,t)}function lO(e,t){var r="",n=wm(e,t);switch(t.type){case"base64":r=gn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=xs(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=At(r)),t.type="binary",Gw(r,t)}function cO(e,t){var r=e;return t.type=="base64"&&(r=gn(r)),r=ui.utils.decode(1200,r.slice(2),"str"),t.type="binary",Gw(r,t)}function uO(e){return e.match(/[^\x00-\x7F]/)?fl(e):e}function vd(e,t,r,n){return n?(r.type="string",Ql.to_workbook(e,r)):Ql.to_workbook(t,r)}function Mh(e,t){x2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Mh(new Uint8Array(e),(r=Tr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ho={},r.dateNF&&(ho.dateNF=r.dateNF),r.type||(r.type=ut&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ut?"buffer":"binary",n=Kb(e),typeof Uint8Array<"u"&&!ut&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=uO(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Tr(r),r.type="array",Mh(Qp(n),r)}switch((a=wm(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return sO(mt.read(n,r),r);break;case 9:if(a[1]<=8)return Hw(n,r);break;case 60:return Lh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return I5(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return R5.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?oO(n,r):vd(e,n,r,i);case 239:return a[3]===60?Lh(n,r):vd(e,n,r,i);case 255:if(a[1]===254)return cO(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return bl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return bl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return M1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return mL.to_workbook(n,r);break;case 10:case 13:case 32:return lO(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return M5.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?M1.to_workbook(n,r):vd(e,n,r,i)}function fO(e,t,r,n,a,i,o,l){var u=Cr(r),d=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!o||e[r])for(var x=t.s.c;x<=t.e.c;++x){var _=o?e[r][x]:e[n[x]+u];if(_===void 0||_.t===void 0){if(d===void 0)continue;i[x]!=null&&(g[i[x]]=d);continue}var y=_.v;switch(_.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(i[x]!=null){if(y==null)if(_.t=="e"&&y===null)g[i[x]]=null;else if(d!==void 0)g[i[x]]=d;else if(h&&y===null)g[i[x]]=null;else continue;else g[i[x]]=h&&(_.t!=="n"||_.t==="n"&&l.rawNumbers!==!1)?y:qa(_,y,l);y!=null&&(m=!1)}}return{row:g,isempty:m}}function jh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":u=Gt(h);break;case"number":u=Gt(e["!ref"]),u.s.r=h;break;default:u=h}n>0&&(a=0);var m=Cr(u.s.r),g=[],x=[],_=0,y=0,E=Array.isArray(e),k=u.s.r,S=0,w={};E&&!e[k]&&(e[k]=[]);var A=d.skipHidden&&e["!cols"]||[],D=d.skipHidden&&e["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(A[S]||{}).hidden)switch(g[S]=lr(S),r=E?e[k][S]:e[g[S]+m],n){case 1:i[S]=S-u.s.c;break;case 2:i[S]=g[S];break;case 3:i[S]=d.header[S-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=qa(r,null,d),y=w[o]||0,!y)w[o]=1;else{do l=o+"_"+y++;while(w[l]);w[o]=y,w[l]=1}i[S]=l}for(k=u.s.r+a;k<=u.e.r;++k)if(!(D[k]||{}).hidden){var R=fO(e,u,k,g,n,i,E,d);(R.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(x[_++]=R.row)}return x.length=_,x}var K1=/"/g;function dO(e,t,r,n,a,i,o,l){for(var u=!0,d=[],h="",m=Cr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var x=l.dense?(e[r]||[])[g]:e[n[g]+m];if(x==null)h="";else if(x.v!=null){u=!1,h=""+(l.rawNumbers&&x.t=="n"?x.v:qa(x,null,l));for(var _=0,y=0;_!==h.length;++_)if((y=h.charCodeAt(_))===a||y===i||y===34||l.forceQuotes){h='"'+h.replace(K1,'""')+'"';break}h=="ID"&&(h='"ID"')}else x.f!=null&&!x.F?(u=!1,h="="+x.f,h.indexOf(",")>=0&&(h='"'+h.replace(K1,'""')+'"')):h="";d.push(h)}return l.blankrows===!1&&u?null:d.join(o)}function Zw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Gt(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),h="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],_=a.s.c;_<=a.e.c;++_)(g[_]||{}).hidden||(m[_]=lr(_));for(var y=0,E=a.s.r;E<=a.e.r;++E)(x[E]||{}).hidden||(h=dO(e,a,E,m,o,u,i,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&r.push((y++?l:"")+h)));return delete n.dense,r.join("")}function hO(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Zw(e,t);return r}function pO(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Gt(e["!ref"]),i="",o=[],l,u=[],d=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=lr(l);for(var h=a.s.r;h<=a.e.r;++h)for(i=Cr(h),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+i,r=d?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function qw(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?qr(n.origin):n.origin;o=u.r,l=u.c}var d,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(i["!ref"]){var m=Gt(i["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(o=m.e.r+1,h.e.r=o+t.length-1+a)}else o==-1&&(o=0,h.e.r=t.length-1+a);var g=n.header||[],x=0;t.forEach(function(y,E){_a(y).forEach(function(k){(x=g.indexOf(k))==-1&&(g[x=g.length]=k);var S=y[k],w="z",A="",D=et({c:l+x,r:o+E+a});d=nc(i,D),S&&typeof S=="object"&&!(S instanceof Date)?i[D]=S:(typeof S=="number"?w="n":typeof S=="boolean"?w="b":typeof S=="string"?w="s":S instanceof Date?(w="d",n.cellDates||(w="n",S=Kr(S)),A=n.dateNF||nt[14]):S===null&&n.nullError&&(w="e",S=0),d?(d.t=w,d.v=S,delete d.w,delete d.R,A&&(d.z=A)):i[D]=d={t:w,v:S},A&&(d.z=A))})}),h.e.c=Math.max(h.e.c,l+g.length-1);var _=Cr(o);if(a)for(x=0;x<g.length;++x)i[lr(x+l)+_]={t:"s",v:g[x]};return i["!ref"]=gt(h),i}function mO(e,t){return qw(null,e,t)}function nc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=qr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?nc(e,et(t)):nc(e,et({r:t,c:r||0}))}function gO(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function km(){return{SheetNames:[],Sheets:{}}}function Em(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(e8(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function xO(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=gO(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function vO(e,t){return e.z=t,e}function Xw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function _O(e,t,r){return Xw(e,"#"+t,r)}function yO(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function wO(e,t,r,n){for(var a=typeof t!="string"?t:Gt(t),i=typeof t=="string"?t:gt(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var u=nc(e,o,l);u.t="n",u.F=i,delete u.v,o==a.s.r&&l==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var kO={encode_col:lr,encode_row:Cr,encode_cell:et,encode_range:gt,decode_col:lm,decode_row:om,split_cell:ON,decode_cell:qr,decode_range:Oo,format_cell:qa,sheet_add_aoa:Q2,sheet_add_json:qw,sheet_add_dom:Vw,aoa_to_sheet:Mo,json_to_sheet:mO,table_to_sheet:Ww,table_to_book:I8,sheet_to_csv:Zw,sheet_to_txt:hO,sheet_to_json:jh,sheet_to_html:D8,sheet_to_formulae:pO,sheet_to_row_object_array:jh,sheet_get_cell:nc,book_new:km,book_append_sheet:Em,book_set_sheet_visibility:xO,cell_set_number_format:vO,cell_set_hyperlink:Xw,cell_set_internal_link:_O,cell_add_comment:yO,sheet_set_array_formula:wO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class dl extends Error{}dl.prototype.name="InvalidTokenError";function EO(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function SO(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return EO(t)}catch{return atob(t)}}function TO(e,t){if(typeof e!="string")throw new dl("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new dl(`Invalid token specified: missing part #${r+1}`);let a;try{a=SO(n)}catch(i){throw new dl(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(a)}catch(i){throw new dl(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const CO=e=>{try{const t=TO(e),r=Date.now()/1e3;return t.exp>r}catch{return!1}},ha=()=>{const e=localStorage.getItem("token");return e?CO(e)?e:(bO(),null):null},bO=()=>{localStorage.removeItem("token")},NO=async(e,t)=>{var r,n;try{return(await Ve.post(`${Dt}/command/execute/`,{firewall_id:e,command:t},{headers:{Authorization:`Bearer ${ha()}`,"Content-Type":"application/json"}})).data}catch(a){throw Ve.isAxiosError(a)?new Error(((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.error)||"Failed to execute command"):a}},AO=async e=>{var t,r;try{return(await Ve.get(`${Dt}/command/commands/`,{params:{firewall_id:e},headers:{Authorization:`Bearer ${ha()}`}})).data}catch(n){throw Ve.isAxiosError(n)?new Error(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.error)||"Failed to fetch command history"):n}},Gi=Ve.create({baseURL:Dt,headers:{"Content-Type":"application/json"},withCredentials:!0});Gi.interceptors.request.use(async e=>{var n;const t=ha();t&&(e.headers.Authorization=`Bearer ${t}`);const r=(n=document.cookie.split("; ").find(a=>a.startsWith("csrftoken=")))==null?void 0:n.split("=")[1];return r&&(e.headers["X-CSRFToken"]=r),e},e=>Promise.reject(e));const LO=[{name:"Name",description:"Template name"},{name:"Source Address",description:"Source IP address or network"},{name:"Source Description",description:"Description of the source"},{name:"Source Interface",description:"Source network interface"},{name:"Destination Address",description:"Destination IP address or network"},{name:"Destination Description",description:"Description of the destination"},{name:"Destination Interface",description:"Destination network interface"},{name:"Service",description:"Network service or port"}];class PO{async getVariables(){try{return(await Gi.get("/templates/variables/")).data.results||[]}catch{throw new Error("Failed to fetch variables")}}async getTemplate(t){try{return(await Gi.get(`/templates/${t}/`)).data}catch{throw new Error("Failed to fetch template")}}async getTemplates(){try{return(await Gi.get("/templates/")).data.results||[]}catch{throw new Error("Failed to fetch templates")}}async createTemplate(t){try{return(await Gi.post("/templates/",t)).data}catch{throw new Error("Failed to create template")}}async updateTemplate(t,r){try{return(await Gi.patch(`/templates/${t}/`,r)).data}catch{throw new Error("Failed to update template")}}async deleteTemplate(t){try{await Gi.delete(`/templates/${t}/`)}catch{throw new Error("Failed to delete template")}}}const Us=new PO,di={getVariables:async()=>{var e,t,r;try{const n=ha();if(!n)return console.error("No authentication token found"),[];let a=[],i=`${Dt}/templates/variables/`;for(;i;){const o=await Ve.get(i,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(Array.isArray(o.data))a=[...a,...o.data],i=null;else if(o.data.results&&Array.isArray(o.data.results))a=[...a,...o.data.results],i=o.data.next;else{console.error("Unexpected API response format:",o.data);break}}return a}catch(n){return console.error("Error fetching variables:",n),Ve.isAxiosError(n)&&console.error("Error details:",{status:(e=n.response)==null?void 0:e.status,data:(t=n.response)==null?void 0:t.data,headers:(r=n.response)==null?void 0:r.headers}),[]}},createVariable:async e=>{try{return(await Ve.post(`${Dt}/templates/variables/`,e,{headers:{Authorization:`Bearer ${ha()}`,"Content-Type":"application/json"}})).data}catch(t){throw console.error("Error creating variable:",t),t}},updateVariable:async(e,t)=>{try{return(await Ve.put(`${Dt}/templates/variables/${e}/`,t,{headers:{Authorization:`Bearer ${ha()}`,"Content-Type":"application/json"}})).data}catch(r){throw console.error("Error updating variable:",r),r}},deleteVariable:async e=>{try{await Ve.delete(`${Dt}/templates/variables/${e}/`,{headers:{Authorization:`Bearer ${ha()}`,"Content-Type":"application/json"}})}catch(t){throw console.error("Error deleting variable:",t),t}},addVariableToTemplate:async(e,t)=>{try{await Ve.post(`${Dt}/templates/${e}/add_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${ha()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error adding variable to template:",r),r}},removeVariableFromTemplate:async(e,t)=>{try{await Ve.post(`${Dt}/templates/${e}/remove_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${ha()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error removing variable from template:",r),r}},async ensureRequiredVariables(){const e=await this.getVariables(),t=new Set(e.map(r=>r.name));for(const r of LO)t.has(r.name)||await this.createVariable(r)}},J1=(e,t)=>{let r;return function(...a){const i=()=>{clearTimeout(r),e(...a)};clearTimeout(r),r=setTimeout(i,t)}},FO=()=>localStorage.getItem("token"),Fa=Ve.create({baseURL:Dt});Fa.interceptors.request.use(e=>{const t=FO();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Fa.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),uf("/login")),Promise.reject(e)));const OO=()=>{var je,Ge,ht,lt;const[e,t]=C.useState([]),[r,n]=C.useState(null),[a,i]=C.useState({hostname:"",ipAddress:"",vdom:"",setName:"",srcaddr:"",srcaddrDesc:"",srcintf:"",dstaddr:"",dstaddrDesc:"",dstintf:"",service:""});C.useState(""),C.useState("");const[o,l]=C.useState([]),[u,d]=C.useState([]),[h,m]=C.useState([]),[g,x]=C.useState(null),[_,y]=C.useState(!1),[E,k]=C.useState(""),[S,w]=C.useState(""),[A,D]=C.useState([]),[R,P]=C.useState([]),[H,B]=C.useState([]),[W,I]=C.useState({}),[Z,J]=C.useState(""),[ge,_e]=C.useState(""),[de,Q]=C.useState([]),[ee,U]=C.useState(!1),[ne,ue]=C.useState(null),[F,te]=C.useState(""),[q,X]=C.useState([]),[K,ye]=C.useState(!1),[Le,be]=C.useState(null);C.useEffect(()=>{(async()=>{try{ye(!0),be(null);const ce=await Us.getTemplates();X(ce)}catch(ce){console.error("Error loading templates:",ce),be("Failed to load templates")}finally{ye(!1)}})()},[]);const[ke,$e]=C.useState(null),[G,ot]=C.useState(!1),[me,Te]=C.useState(null),[Pe,he]=C.useState(null),[Ue,We]=C.useState(!1),[yt,Tt]=C.useState(null),[dt,St]=C.useState([]);C.useEffect(()=>{(async()=>{try{y(!0);const ce=await Fa.get("/datacenters/hierarchy/");St(ce.data)}catch(ce){console.error("Error fetching hierarchy:",ce)}finally{y(!1)}})()},[]);const _t=()=>{if(!E)return[];const re=dt.find(ce=>ce.id===E);return re?re.firewall_types:[]},ar=()=>{if(!S)return[];const re=dt.find(Fe=>Fe.id===E);if(!re)return[];const ce=re.firewall_types.find(Fe=>Fe.id===S);return ce?ce.firewalls:[]},Yt=re=>{const ce=re.target.value;k(ce),w(""),x(null)},_n=re=>{const ce=re.target.value;w(ce),x(null)},Vt=re=>{var Xe,Ze;const ce=re.target.value,Re=ar().find(He=>He.id===ce);if(Re){const He={id:Re.id,name:Re.name,ip_address:Re.ip_address,data_center:{id:E,name:((Xe=dt.find(Qe=>Qe.id===E))==null?void 0:Xe.name)||""},firewall_type:{id:S,name:((Ze=_t().find(Qe=>Qe.id===S))==null?void 0:Ze.name)||""},config:{id:"",config_data:{}},created_at:new Date().toISOString()};x(He)}};C.useEffect(()=>{Nr()},[]);const Nr=async()=>{try{y(!0);let re=[],ce="/firewalls/firewalls/";for(;ce;){const O=(await Fa.get(ce)).data;re=[...re,...O.results||[]],ce=O.next}const[Fe,Re]=await Promise.all([Fa.get("/firewalls/firewall-types/"),Fa.get("/datacenters/")]);console.log("API Responses:",{firewallTypes:Fe.data,dataCenters:Re.data,firewalls:re});const Ze=(Fe.data.results||[]).map(M=>({id:M.id,name:M.name,data_center:M.data_center,attributes_schema:M.attributes_schema||{}}));l(Ze);const Qe=(Re.data.results||[]).map(M=>({id:M.id,name:M.name}));d(Qe);const Vr=re.map(M=>({id:M.id,name:M.name,ip_address:M.ip_address,data_center:M.data_center&&M.data_center.id&&M.data_center.name?{id:M.data_center.id,name:M.data_center.name}:null,firewall_type:M.firewall_type&&M.firewall_type.id&&M.firewall_type.name?{id:M.firewall_type.id,name:M.firewall_type.name}:null,config:M.config||{id:"",config_data:{}},created_at:M.created_at}));m(Vr);const Lr=localStorage.getItem("dataCenter"),Be=localStorage.getItem("firewallType"),b=localStorage.getItem("selectedFirewallId");if(Lr&&k(Lr),Be&&w(Be),b){const M=Vr.find(O=>O.id===b);M&&(x(M),i(O=>({...O,ipAddress:M.ip_address})))}}catch(re){console.error("Error fetching data:",re)}finally{y(!1)}};C.useEffect(()=>{if(E){const re=o.filter(ce=>{if(!ce.data_center)return console.log("No data_center for type:",ce),!1;const Fe=ce.data_center===E;return console.log("Type matches:",{typeId:ce.id,typeDataCenter:ce.data_center,selectedDataCenter:E,matches:Fe}),Fe});console.log("Filtered Firewall Types:",{selectedDataCenter:E,allTypes:o,filteredTypes:re}),D(re),S&&!re.some(ce=>ce.id===S)&&(w(""),localStorage.removeItem("firewallType"))}else D([]),w("")},[E,o]),C.useEffect(()=>{var re;if(S){const ce=A.find(Fe=>Fe.id===S);if(console.log("Selected Type:",ce),(re=ce==null?void 0:ce.attributes_schema)!=null&&re.properties){const Fe=Object.entries(ce.attributes_schema.properties).map(([Re,Xe])=>({name:Re,label:Xe.title||Re,required:Xe.required||!1,type:Xe.type||"string"}));console.log("Generated Form Fields:",Fe),B(Fe)}else console.log("No attributes schema found for type:",ce),B([])}else B([])},[S,A]),C.useEffect(()=>{if(S&&E){const re=h.filter(ce=>{if(!ce.firewall_type||!ce.data_center)return!1;const Fe=ce.firewall_type.id===S,Re=ce.data_center.id===E;return console.log("Firewall Filter Check:",{firewallId:ce.id,firewallType:ce.firewall_type.id,dataCenter:ce.data_center.id,selectedType:S,selectedDC:E,matchesType:Fe,matchesDataCenter:Re}),Fe&&Re});console.log("Filtered Firewalls:",{selectedFirewallType:S,selectedDataCenter:E,allFirewalls:h,filteredFirewalls:re}),P(re),g&&!re.some(ce=>ce.id===g.id)&&(x(null),localStorage.removeItem("selectedFirewallId"))}else P([]),x(null)},[S,E,h]),C.useEffect(()=>{const re=localStorage.getItem("dataCenter"),ce=localStorage.getItem("firewallType"),Fe=localStorage.getItem("selectedFirewallId");if(console.log("Loading saved selections:",{savedDataCenter:re,savedFirewallType:ce,savedFirewallId:Fe}),re&&k(re),ce&&w(ce),Fe){const Re=h.find(Xe=>Xe.id===Fe);Re&&(x(Re),i(Xe=>({...Xe,ipAddress:Re.ip_address})))}},[h]);const Ke=re=>{var ce;try{const Fe=Mh(re,{type:"array"});if(!Fe.SheetNames.length)throw new Error("No sheets found in the Excel file");const Re=Fe.SheetNames[0],Xe=Fe.Sheets[Re],Ze=A.find(b=>b.id===S);if(!Ze)throw new Error("No firewall type selected");if(!((ce=Ze.attributes_schema)!=null&&ce.properties))throw new Error("No attributes defined for the selected firewall type");const He=Object.entries(Ze.attributes_schema.properties).filter(([b,M])=>M.required).map(([b])=>b),Qe=kO.sheet_to_json(Xe,{raw:!1,header:1});if(!Array.isArray(Qe)||Qe.length===0)throw new Error("No data found in the Excel file");const Vr=Qe[0];if(!Array.isArray(Vr)||Vr.length===0)throw new Error("No headers found in the Excel file");const Be=Qe.slice(1).map((b,M)=>{var V;const O={};Array.isArray(b)&&Vr.forEach((ae,ve)=>{const se=b[ve];O[ae]=se});const j=He.filter(ae=>!O[ae]);if(j.length>0)throw new Error(`Missing required fields in row ${M+2}: ${j.join(", ")}`);const z={};return(V=Ze==null?void 0:Ze.attributes_schema)!=null&&V.properties&&Object.entries(Ze.attributes_schema.properties).forEach(([ae,ve])=>{const se=Object.keys(O).find(oe=>{const le=oe.toLowerCase().replace(/\s+/g,""),Se=ae.toLowerCase().replace(/\s+/g,""),Oe={ipaddress:["ip","ipaddress","ipaddr","ip_address","ipaddress","IP Adresse"],sourceaddress:["source","src","sourceaddr","source_address","sourceaddress","source"],destinationinterface:["dstintf","destinationintf","destination_interface","dstinterface","destinationinterface","destination"],name:["name","nom","hostname","device"],vdom:["vdom","virtualdomain"],service:["service","services","protocol"],hostname:["hostname","name","device"],sourcedescription:["sourcedescription","srcdesc","source_desc"],sourceinterface:["sourceinterface","srcintf","source_intf"],destinationaddress:["destinationaddress","dstaddr","destination_addr"],destinationdescription:["destinationdescription","dstdesc","destination_desc"]};return le===Se?!0:Oe[Se]?Oe[Se].includes(le):!1});se?z[ae]=O[se]||"":z[ae]=""}),z});t(Be),Be.length>0&&(n(Be[0]),I(Be[0])),alert(`${Be.length} configurations loaded successfully`)}catch(Fe){alert(`Error processing Excel file: ${Fe.message}`)}},wt=re=>{var Fe;const ce=(Fe=re.target.files)==null?void 0:Fe[0];if(ce){if(!S){alert("Please select a firewall type before uploading the file");return}const Re=new FileReader;Re.onload=Xe=>{var He;const Ze=(He=Xe.target)==null?void 0:He.result;Ke(Ze)},Re.readAsArrayBuffer(ce)}},ur=ls.useCallback(J1(async re=>{var ce,Fe,Re,Xe;if(!(!g||!re)){ot(!0),Te(null),$e(null);try{const Ze=await Fa.post("/analysis/flow-matrix/analyze-ip/",{source_ip:re,firewall_id:g.id,data_center_name:((ce=g.data_center)==null?void 0:ce.name)||"",firewall_type_name:((Fe=g.firewall_type)==null?void 0:Fe.name)||""});$e(Ze.data)}catch(Ze){Te(((Xe=(Re=Ze.response)==null?void 0:Re.data)==null?void 0:Xe.error)||"Failed to search address")}finally{ot(!1)}}},500),[g]),Ct=ls.useCallback(J1(async re=>{var ce,Fe,Re,Xe;if(!(!g||!re)){We(!0),Tt(null),he(null);try{const Ze=await Fa.post("/analysis/flow-matrix/analyze-ip/",{source_ip:re,firewall_id:g.id,data_center_name:((ce=g.data_center)==null?void 0:ce.name)||"",firewall_type_name:((Fe=g.firewall_type)==null?void 0:Fe.name)||""});he(Ze.data)}catch(Ze){Tt(((Xe=(Re=Ze.response)==null?void 0:Re.data)==null?void 0:Xe.error)||"Failed to search address")}finally{We(!1)}}},500),[g]),Ar=(re,ce)=>{I(Fe=>({...Fe,[re]:ce})),re==="SourceAddress"?ur(ce):re==="DestinationAddress"&&Ct(ce)},yn=r&&{fields:[{name:"hostname",label:"Hostname",required:!0},{name:"ipAddress",label:"IP Address",required:!0},{name:"vdom",label:"VDOM",required:!0},{name:"setName",label:"Set Name",required:!0},{name:"srcaddr",label:"Source Address",required:!0},{name:"srcaddrDesc",label:"Source Description",required:!1},{name:"srcintf",label:"Source Interface",required:!0},{name:"dstaddr",label:"Destination Address",required:!0},{name:"dstaddrDesc",label:"Destination Description",required:!1},{name:"dstintf",label:"Destination Interface",required:!0},{name:"service",label:"Service",required:!0}]};yn!=null&&yn.fields;const Qa=async re=>{if(!g){Ne("Please select a firewall first");return}try{const ce=await NO(g.id,re);Q(Fe=>Array.isArray(Fe)?[...Fe,ce]:[ce]),J(""),Ne(null)}catch(ce){Ne(ce instanceof Error?ce.message:"Failed to execute command")}};C.useEffect(()=>{(async()=>{if(g)try{const ce=await AO(g.id);Q(Array.isArray(ce)?ce:[])}catch(ce){console.error("Error loading command history:",ce),Q([])}})()},[g]);const Dn=()=>{if(!F)return;const re=q.find(He=>He.name===F);if(!re)return;const ce=/{{([^}]+)}}/g,Fe=new Set;let Re;for(;(Re=ce.exec(re.content))!==null;){const He=Re[1].trim();Fe.add(He)}const Xe={};Fe.forEach(He=>{const Qe=W[He]||"";Xe[`{{ ${He} }}`]=Qe});let Ze=re.content;Object.entries(Xe).forEach(([He,Qe])=>{Ze=Ze.replace(new RegExp(He,"g"),Qe)}),J(Ze)},xe=async()=>{var re,ce,Fe,Re;if(!g||!W.SourceAddress){Te("Please select a firewall and enter a source address");return}ot(!0),Te(null),$e(null);try{const Xe=await Fa.post("/analysis/flow-matrix/analyze-ip/",{source_ip:W.SourceAddress,firewall_id:g.id,data_center_name:((re=g.data_center)==null?void 0:re.name)||"",firewall_type_name:((ce=g.firewall_type)==null?void 0:ce.name)||""});$e(Xe.data)}catch(Xe){Te(((Re=(Fe=Xe.response)==null?void 0:Fe.data)==null?void 0:Re.error)||"Failed to search source address")}finally{ot(!1)}};C.useState(!1);const[we,Ne]=C.useState(null);return C.useState([]),C.useState(!1),C.useState(null),C.useState([]),C.useState([]),C.useState(""),C.useState(""),C.useState(""),f.jsxs("div",{className:"p-8",children:[f.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:f.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(mc,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),f.jsxs("select",{value:E,onChange:Yt,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[f.jsx("option",{value:"",children:"All data centers"}),dt.map(re=>f.jsx("option",{value:re.id,children:re.name},re.id))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(ms,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),f.jsxs("select",{value:S,onChange:_n,disabled:!E,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${E?"":"bg-gray-100"}`,children:[f.jsx("option",{value:"",children:"Select a firewall type"}),_t().map(re=>f.jsx("option",{value:re.id,children:re.name},re.id))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(gc,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),f.jsxs("select",{value:(g==null?void 0:g.id)||"",onChange:Vt,disabled:!S,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${S?"":"bg-gray-100"}`,children:[f.jsx("option",{value:"",children:"Select a firewall"}),ar().map(re=>f.jsxs("option",{value:re.id,children:[re.name," - ",re.ip_address]},re.id))]})]})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Configuration"}),f.jsx("div",{className:"space-y-4",children:H.length>0?H.map(re=>f.jsxs("div",{className:"mb-6",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[re.label,re.required&&f.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),f.jsx("div",{className:"relative",children:f.jsx("input",{type:re.type==="string"?"text":re.type,value:W[re.name]||"",onChange:ce=>Ar(re.name,ce.target.value),required:re.required,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2",placeholder:`Enter ${re.label.toLowerCase()}`})})]},re.name)):f.jsx("div",{className:"text-center py-4 text-gray-500",children:S?"No fields defined for this firewall type":"Select a firewall type to see available fields"})})]})}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Slectionner une configuration"}),e.length>0?f.jsxs(f.Fragment,{children:[f.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg mb-4",value:r?JSON.stringify(r):"",onChange:re=>{const ce=JSON.parse(re.target.value);n(ce);const Fe={};Object.entries(ce).forEach(([Re,Xe])=>{Fe[Re]=String(Xe)}),I(Fe)},children:[f.jsx("option",{value:"",children:"Choisir une configuration"}),e.map((re,ce)=>f.jsxs("option",{value:JSON.stringify(re),children:[re.hostname," - ",re.ipAddress]},ce))]}),r&&f.jsxs("button",{onClick:()=>{const re={};Object.entries(r).forEach(([ce,Fe])=>{re[ce]=String(Fe)}),I(re)},className:"w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 flex items-center justify-center",children:[f.jsx(Zp,{className:"w-5 h-5 mr-2"}),"Appliquer la configuration"]})]}):f.jsx("div",{className:"text-center py-4 text-gray-500",children:"Aucune configuration disponible. Veuillez importer un fichier Excel ou crer une configuration manuelle."})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Importer une configuration"}),f.jsx("div",{className:"space-y-4",children:S?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"mb-4",children:f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Format Excel requis:"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsx("tr",{children:Object.entries(((Ge=(je=A.find(re=>re.id===S))==null?void 0:je.attributes_schema)==null?void 0:Ge.properties)||{}).map(([re,ce])=>f.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider border-b border-gray-200",children:[ce.title," ",ce.required&&f.jsx("span",{className:"text-red-500 ml-1",children:"*"})]},re))})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.jsx("tr",{children:Object.entries(((lt=(ht=A.find(re=>re.id===S))==null?void 0:ht.attributes_schema)==null?void 0:lt.properties)||{}).map(([re,ce])=>f.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 border-b border-gray-200",children:ce.type==="string"?"Texte":ce.type},re))})})]})}),f.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[f.jsx("span",{className:"text-red-500",children:"*"})," Champs obligatoires"]})]})}),f.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[f.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:wt,className:"hidden",id:"file-upload"}),f.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center",children:[f.jsx(m2,{className:"h-12 w-12 text-gray-400 mb-4"}),f.jsx("span",{className:"text-gray-600",children:"Choisir un fichier Excel"}),f.jsx("span",{className:"text-sm text-gray-500 mt-2",children:"Format: .xlsx, .xls"})]})]})]}):f.jsx("div",{className:"text-center py-8",children:f.jsx("p",{className:"text-gray-500",children:"Veuillez slectionner un type de pare-feu pour voir les champs requis"})})})]})]})]}),f.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Source Address Search"}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("input",{type:"text",value:W.SourceAddress||"",onChange:re=>Ar("SourceAddress",re.target.value),placeholder:"Enter source address",className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),f.jsx("button",{onClick:xe,disabled:G||!g||!W.SourceAddress,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:G?"Searching...":"Search Address"})]}),me&&f.jsx("div",{className:"mt-4 p-4 bg-red-50 text-red-700 rounded-md",children:me}),ke&&f.jsx("div",{className:"mt-4 space-y-4",children:f.jsxs("div",{className:"p-4 bg-green-50 rounded-md",children:[f.jsx("h4",{className:"font-medium text-green-800 mb-4",children:"Search Results"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Source Address"}),f.jsx("p",{className:"font-medium text-gray-900",children:ke.ip})]}),f.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Config Path"}),f.jsx("p",{className:"font-medium text-gray-900",children:ke.config_path})]})]}),f.jsxs("div",{className:"mt-6",children:[f.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Matched Address Objects"}),ke.matches&&ke.matches.length>0?f.jsx("div",{className:"space-y-4",children:ke.matches.map((re,ce)=>f.jsxs("div",{className:"border-l-4 border-green-500 pl-3",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),f.jsx("span",{className:"font-medium text-gray-900",children:re.name})]}),re.comment&&f.jsx("div",{className:"ml-4 mt-1",children:f.jsx("p",{className:"text-xs text-gray-500 italic",children:re.comment})}),re.groups&&re.groups.length>0&&f.jsxs("div",{className:"ml-4 mt-2 text-sm text-blue-600",children:["Groups: ",re.groups.join(", ")]})]},ce))}):f.jsx("p",{className:"text-gray-500 italic mt-2",children:"No matches found"})]}),ke.matches&&ke.matches.length>0&&f.jsxs("details",{className:"mt-4",children:[f.jsx("summary",{className:"text-sm text-gray-500 cursor-pointer",children:"Debug Information"}),f.jsx("div",{className:"mt-2 space-y-2",children:ke.matches.map((re,ce)=>f.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[f.jsxs("p",{children:[f.jsx("span",{className:"text-gray-500",children:"Name:"})," ",re.name]}),re.comment&&f.jsxs("p",{children:[f.jsx("span",{className:"text-gray-500",children:"Comment:"})," ",re.comment]}),re.groups&&re.groups.length>0&&f.jsxs("p",{children:[f.jsx("span",{className:"text-gray-500",children:"Groups:"})," ",re.groups.join(", ")]})]},ce))})]})]})})]}),f.jsxs("div",{className:"mt-8 bg-gray-900 rounded-lg shadow-lg p-6",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),f.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),f.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-200 ml-2",children:"Terminal"})]}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[f.jsx("span",{className:"text-green-400",children:"$"}),f.jsx("span",{className:"text-gray-400",children:"Selected Firewall:"}),f.jsx("span",{className:"text-purple-400",children:g?`${g.name} (${g.ip_address})`:"None"})]}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[f.jsx("span",{className:"text-green-400",children:"$"}),f.jsx("span",{className:"text-gray-400",children:"Template:"})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsxs("select",{value:F,onChange:re=>te(re.target.value),className:"flex-1 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:K,children:[f.jsx("option",{value:"",children:"Select a template..."}),q.map(re=>f.jsx("option",{value:re.name,children:re.name},re.id))]}),f.jsx("button",{onClick:Dn,disabled:!F||K,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:K?"Loading...":"Apply Template"})]}),Le&&f.jsx("div",{className:"mt-2 text-sm text-red-400",children:Le})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsxs("div",{className:"flex-1 relative",children:[f.jsx("span",{className:"absolute left-3 top-2 text-green-400",children:"$"}),f.jsx("textarea",{value:Z,onChange:re=>J(re.target.value),placeholder:"Enter command...",className:"w-full h-32 pl-8 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm resize-none",onKeyDown:re=>{re.key==="Enter"&&!re.shiftKey&&(re.preventDefault(),Qa(Z))}})]}),f.jsxs("div",{className:"flex flex-col space-y-2",children:[f.jsx("button",{onClick:re=>{re.preventDefault(),Qa(Z)},disabled:ee||!g||!Z.trim(),className:`px-4 py-2 rounded-md transition-colors duration-200 ${ee?"bg-yellow-600 text-white":!g||!Z.trim()?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:ee?f.jsxs("div",{className:"flex items-center",children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Executing..."]}):"Execute"}),f.jsx("button",{onClick:()=>J(""),className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors duration-200",children:"Clear"})]})]})]}),ge&&f.jsxs("div",{className:"mb-4 p-4 bg-gray-800 rounded-md border border-gray-700",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-gray-400 text-lg",children:"Output:"}),f.jsx("button",{onClick:()=>_e(""),className:"text-gray-500 hover:text-gray-400",children:"Clear"})]}),f.jsx("pre",{className:"text-sm overflow-auto max-h-96 font-mono text-gray-300 p-4 bg-gray-900 rounded-md",children:ge})]}),ne&&f.jsxs("div",{className:"mb-4 p-4 bg-red-900/50 text-red-400 rounded-md border border-red-700",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-red-500 font-semibold",children:"Error:"}),f.jsx("button",{onClick:()=>ue(null),className:"text-red-500 hover:text-red-400",children:"Clear"})]}),f.jsx("p",{className:"mt-2",children:ne})]}),de.length>0&&f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-green-400",children:"$"}),f.jsx("span",{className:"text-gray-400",children:"History:"})]}),f.jsx("button",{onClick:()=>Q([]),className:"text-gray-500 hover:text-gray-400 text-sm",children:"Clear History"})]}),f.jsx("div",{className:"space-y-2",children:de.map((re,ce)=>f.jsxs("div",{className:"bg-gray-800 rounded-md p-3 border border-gray-700",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-green-400",children:"$"}),f.jsx("span",{className:"font-mono text-sm text-gray-300",children:re.command})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:`px-2 py-1 rounded text-xs ${re.status==="completed"?"bg-green-900 text-green-300":re.status==="failed"?"bg-red-900 text-red-300":re.status==="executing"?"bg-yellow-900 text-yellow-300":"bg-gray-900 text-gray-300"}`,children:re.status}),f.jsx("span",{className:"text-xs text-gray-500",children:new Date(re.executed_at).toLocaleString()})]})]}),re.output&&f.jsx("pre",{className:`text-sm overflow-auto max-h-40 font-mono ${re.status==="completed"?"text-gray-300":"text-red-400"}`,children:re.output}),re.error_message&&f.jsxs("div",{className:"mt-2 text-sm text-red-400",children:["Error: ",re.error_message]})]},`${re.id}-${re.executed_at}-${ce}`))})]})]})]})};let MO={data:""},jO=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||MO,RO=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,DO=/\/\*[^]*?\*\/|  +/g,Q1=/\n+/g,hi=(e,t)=>{let r="",n="",a="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?hi(o,i):i+"{"+hi(o,i[1]=="k"?"":t)+"}":typeof o=="object"?n+=hi(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=hi.p?hi.p(i,o):i+":"+o+";")}return r+(t&&a?t+"{"+a+"}":a)+n},La={},Yw=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Yw(e[r]);return t}return e},IO=(e,t,r,n,a)=>{let i=Yw(e),o=La[i]||(La[i]=(u=>{let d=0,h=11;for(;d<u.length;)h=101*h+u.charCodeAt(d++)>>>0;return"go"+h})(i));if(!La[o]){let u=i!==e?e:(d=>{let h,m,g=[{}];for(;h=RO.exec(d.replace(DO,""));)h[4]?g.shift():h[3]?(m=h[3].replace(Q1," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][h[1]]=h[2].replace(Q1," ").trim();return g[0]})(e);La[o]=hi(a?{["@keyframes "+o]:u}:u,r?"":"."+o)}let l=r&&La.g?La.g:null;return r&&(La.g=La[o]),((u,d,h,m)=>{m?d.data=d.data.replace(m,u):d.data.indexOf(u)===-1&&(d.data=h?u+d.data:d.data+u)})(La[o],t,n,l),o},BO=(e,t,r)=>e.reduce((n,a,i)=>{let o=t[i];if(o&&o.call){let l=o(r),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":hi(l,""):l===!1?"":l}return n+a+(o??"")},"");function i0(e){let t=this||{},r=e.call?e(t.p):e;return IO(r.unshift?r.raw?BO(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,jO(t.target),t.g,t.o,t.k)}let Kw,Rh,Dh;i0.bind({g:1});let Xa=i0.bind({k:1});function zO(e,t,r,n){hi.p=t,Kw=e,Rh=r,Dh=n}function Ii(e,t){let r=this||{};return function(){let n=arguments;function a(i,o){let l=Object.assign({},i),u=l.className||a.className;r.p=Object.assign({theme:Rh&&Rh()},l),r.o=/ *go\d+/.test(u),l.className=i0.apply(r,n)+(u?" "+u:"");let d=e;return e[0]&&(d=l.as||e,delete l.as),Dh&&d[0]&&Dh(l),Kw(d,l)}return a}}var UO=e=>typeof e=="function",Nf=(e,t)=>UO(e)?e(t):e,HO=(()=>{let e=0;return()=>(++e).toString()})(),Jw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),VO=20,Qw=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,VO)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return Qw(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Mu=[],rs={toasts:[],pausedAt:void 0},Ns=e=>{rs=Qw(rs,e),Mu.forEach(t=>{t(rs)})},WO={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},$O=(e={})=>{let[t,r]=C.useState(rs),n=C.useRef(rs);C.useEffect(()=>(n.current!==rs&&r(rs),Mu.push(r),()=>{let i=Mu.indexOf(r);i>-1&&Mu.splice(i,1)}),[]);let a=t.toasts.map(i=>{var o,l,u;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((o=e[i.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((l=e[i.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||WO[i.type],style:{...e.style,...(u=e[i.type])==null?void 0:u.style,...i.style}}});return{...t,toasts:a}},GO=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||HO()}),Ec=e=>(t,r)=>{let n=GO(t,e,r);return Ns({type:2,toast:n}),n.id},kr=(e,t)=>Ec("blank")(e,t);kr.error=Ec("error");kr.success=Ec("success");kr.loading=Ec("loading");kr.custom=Ec("custom");kr.dismiss=e=>{Ns({type:3,toastId:e})};kr.remove=e=>Ns({type:4,toastId:e});kr.promise=(e,t,r)=>{let n=kr.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?Nf(t.success,a):void 0;return i?kr.success(i,{id:n,...r,...r==null?void 0:r.success}):kr.dismiss(n),a}).catch(a=>{let i=t.error?Nf(t.error,a):void 0;i?kr.error(i,{id:n,...r,...r==null?void 0:r.error}):kr.dismiss(n)}),e};var ZO=(e,t)=>{Ns({type:1,toast:{id:e,height:t}})},qO=()=>{Ns({type:5,time:Date.now()})},Pl=new Map,XO=1e3,YO=(e,t=XO)=>{if(Pl.has(e))return;let r=setTimeout(()=>{Pl.delete(e),Ns({type:4,toastId:e})},t);Pl.set(e,r)},KO=e=>{let{toasts:t,pausedAt:r}=$O(e);C.useEffect(()=>{if(r)return;let i=Date.now(),o=t.map(l=>{if(l.duration===1/0)return;let u=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(u<0){l.visible&&kr.dismiss(l.id);return}return setTimeout(()=>kr.dismiss(l.id),u)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[t,r]);let n=C.useCallback(()=>{r&&Ns({type:6,time:Date.now()})},[r]),a=C.useCallback((i,o)=>{let{reverseOrder:l=!1,gutter:u=8,defaultPosition:d}=o||{},h=t.filter(x=>(x.position||d)===(i.position||d)&&x.height),m=h.findIndex(x=>x.id===i.id),g=h.filter((x,_)=>_<m&&x.visible).length;return h.filter(x=>x.visible).slice(...l?[g+1]:[0,g]).reduce((x,_)=>x+(_.height||0)+u,0)},[t]);return C.useEffect(()=>{t.forEach(i=>{if(i.dismissed)YO(i.id,i.removeDelay);else{let o=Pl.get(i.id);o&&(clearTimeout(o),Pl.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:ZO,startPause:qO,endPause:n,calculateOffset:a}}},JO=Xa`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,QO=Xa`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,eM=Xa`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,tM=Ii("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${JO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${QO} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${eM} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,rM=Xa`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,nM=Ii("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${rM} 1s linear infinite;
`,aM=Xa`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,iM=Xa`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,sM=Ii("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${aM} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${iM} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,oM=Ii("div")`
  position: absolute;
`,lM=Ii("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,cM=Xa`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,uM=Ii("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${cM} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,fM=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?C.createElement(uM,null,t):t:r==="blank"?null:C.createElement(lM,null,C.createElement(nM,{...n}),r!=="loading"&&C.createElement(oM,null,r==="error"?C.createElement(tM,{...n}):C.createElement(sM,{...n})))},dM=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,hM=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,pM="0%{opacity:0;} 100%{opacity:1;}",mM="0%{opacity:1;} 100%{opacity:0;}",gM=Ii("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,xM=Ii("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,vM=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=Jw()?[pM,mM]:[dM(r),hM(r)];return{animation:t?`${Xa(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Xa(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},_M=C.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?vM(e.position||t||"top-center",e.visible):{opacity:0},i=C.createElement(fM,{toast:e}),o=C.createElement(xM,{...e.ariaProps},Nf(e.message,e));return C.createElement(gM,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:o}):C.createElement(C.Fragment,null,i,o))});zO(C.createElement);var yM=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=C.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(e,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return C.createElement("div",{ref:i,className:t,style:r},a)},wM=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Jw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},kM=i0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,gu=16,EM=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:u}=KO(r);return C.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:gu,left:gu,right:gu,bottom:gu,pointerEvents:"none",...i},className:o,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(d=>{let h=d.position||t,m=u.calculateOffset(d,{reverseOrder:e,gutter:n,defaultPosition:t}),g=wM(h,m);return C.createElement(yM,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?kM:"",style:g},d.type==="custom"?Nf(d.message,d):a?a(d):C.createElement(_M,{toast:d,position:h}))}))};const SM=()=>localStorage.getItem("token"),ro=Ve.create({baseURL:Dt});ro.interceptors.request.use(e=>{const t=SM();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));ro.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function TM(){ya();const[e,t]=C.useState(""),[r,n]=C.useState("show"),[a,i]=C.useState(!1),[o,l]=C.useState(null),[u,d]=C.useState(null),[h,m]=C.useState([]);C.useState(!1);const[g,x]=C.useState([]),[_,y]=C.useState(""),[E,k]=C.useState(""),[S,w]=C.useState(null);C.useEffect(()=>{(async()=>{try{i(!0),l(null);const Z=await ro.get("/datacenters/hierarchy/");x(Z.data)}catch(Z){console.error("Error fetching hierarchy:",Z),l("Failed to fetch hierarchy data")}finally{i(!1)}})()},[]);const A=()=>{if(!_)return[];const I=g.find(Z=>Z.id===_);return I?I.firewall_types:[]},D=()=>{if(!E)return[];const I=g.find(J=>J.id===_);if(!I)return[];const Z=I.firewall_types.find(J=>J.id===E);return Z?Z.firewalls:[]},R=I=>{const Z=I.target.value;y(Z),k(""),w(null),m([])},P=I=>{const Z=I.target.value;k(Z),w(null),m([])},H=()=>{const I=D();h.length===I.length?m([]):m(I.map(Z=>Z.id))},B=I=>{m(Z=>Z.includes(I)?Z.filter(J=>J!==I):[...Z,I])},W=async()=>{if(!h.length&&!E){l("Please select firewalls or a firewall type");return}i(!0),l(null),d(null);try{const I=h.length>0?D().filter(J=>h.includes(J.id)):D(),Z=await ro.post("/command/commands/save_bulk_config/",{firewall_ids:I.map(J=>J.id),command:r});if(Z.data.status==="success"){d("Configuration save started. You can leave this page, the saves will continue in the background.");const J=Z.data.task_id,ge=setInterval(async()=>{try{const de=(await ro.get(`/command/commands/check_task_status/?task_id=${J}`)).data;if(d(`${de.message} (${de.progress}%)`),de.status==="completed"){if(clearInterval(ge),d("All configurations saved successfully"),de.results&&de.results.length>0){const Q=de.results.filter(U=>U.status==="success"&&U.filepath),ee=de.results.filter(U=>U.status==="failed");for(const U of Q)try{const ne=await ro.get("/command/commands/download_config_file/",{responseType:"blob",params:{filepath:U.filepath}}),ue=new Blob([ne.data],{type:"text/plain"}),F=window.URL.createObjectURL(ue),te=document.createElement("a");te.href=F,te.setAttribute("download",`${U.firewall_name}_config.txt`),document.body.appendChild(te),te.click(),document.body.removeChild(te),window.URL.revokeObjectURL(F)}catch(ne){console.error(`Error downloading config for ${U.firewall_name}:`,ne),kr.error(`Failed to download configuration for ${U.firewall_name}`)}Q.length>0&&d(`${Q.length} configurations saved and downloaded successfully`),ee.length>0&&l(`Failed to save ${ee.length} configurations: ${ee.map(U=>U.firewall_name).join(", ")}`)}}else de.status==="failed"&&(clearInterval(ge),l(`Configuration save failed: ${de.message}`))}catch(_e){console.error("Error checking task status:",_e),clearInterval(ge),l("Failed to check task status")}},2e3);return()=>clearInterval(ge)}else l("Failed to start configuration save")}catch(I){console.error("Error during bulk save:",I),l("Failed to save configurations")}finally{i(!1)}};return a?f.jsx("div",{className:"p-8",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):o?f.jsx("div",{className:"p-8",children:f.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[f.jsx("strong",{className:"font-bold",children:"Error!"}),f.jsxs("span",{className:"block sm:inline",children:[" ",o]})]})}):f.jsxs("div",{className:"p-8",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall Configuration"}),f.jsx("p",{className:"text-gray-600 mb-6",children:"Manage firewall configurations"}),f.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:f.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(mc,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),f.jsxs("select",{value:_,onChange:R,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[f.jsx("option",{value:"",children:"All data centers"}),g.map(I=>f.jsx("option",{value:I.id,children:I.name},I.id))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(ms,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),f.jsxs("select",{value:E,onChange:P,disabled:!_,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${_?"":"bg-gray-100"}`,children:[f.jsx("option",{value:"",children:"Select a firewall type"}),A().map(I=>f.jsx("option",{value:I.id,children:I.name},I.id))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(gc,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),f.jsxs("div",{className:"mt-1 space-y-2",children:[f.jsx("button",{onClick:H,disabled:!E,className:`w-full px-3 py-1 text-sm rounded-md ${h.length===D().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${E?"":"opacity-50 cursor-not-allowed"}`,children:h.length===D().length?"Deselect All":"Select All"}),f.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:D().map(I=>f.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${h.includes(I.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>B(I.id),children:[f.jsx("input",{type:"checkbox",checked:h.includes(I.id),onChange:()=>B(I.id),className:"mr-2"}),f.jsxs("span",{className:"text-sm",children:[I.name," - ",I.ip_address]})]},I.id))})]})]})]})]})}),f.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP Address"}),f.jsx("input",{type:"text",value:e,onChange:I=>t(I.target.value),placeholder:"e.g., 192.168.1.1",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Command"}),f.jsx("input",{type:"text",value:r,onChange:I=>n(I.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),o&&f.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md",children:o}),u&&f.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md",children:u}),f.jsx("div",{className:"flex space-x-4",children:f.jsxs("button",{onClick:W,disabled:a||!h.length&&!E,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[f.jsx(Zp,{className:"h-5 w-5 mr-2"}),a?"Saving...":"Save Configuration"]})})]})})]})}const ev=["Hostname","IP Adresse","VDOM","Name","SourceAddress","SourceDescription","SourceInterface","DestinationAddress","DestinationDescription","DestinationInterface","service"];function CM(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[a,i]=C.useState([]),[o,l]=C.useState({name:"",description:"",location:"",latitude:"",longitude:""}),[u,d]=C.useState({name:"",description:""}),[h,m]=C.useState([]),[g,x]=C.useState({}),[_,y]=C.useState(!1),[E,k]=C.useState(null),[S,w]=C.useState({}),[A,D]=C.useState(""),[R,P]=C.useState(""),[H,B]=C.useState(!1),[W,I]=C.useState(null),[Z,J]=C.useState(null),[ge,_e]=C.useState(null);C.useState(1);const[de,Q]=C.useState(null),[ee,U]=C.useState(!1),[ne,ue]=C.useState(null),[F,te]=C.useState(!1),[q,X]=C.useState({name:"",ip_address:"",firewall_type:""}),[K,ye]=C.useState(!1),[Le,be]=C.useState(""),[ke,$e]=C.useState(""),[G,ot]=C.useState(""),[me,Te]=C.useState(!1),Pe=()=>{const xe=localStorage.getItem("token");if(!xe)throw new Error("No authentication token found");return xe},he=Ve.create({baseURL:Dt,headers:{"Content-Type":"application/json"}});he.interceptors.request.use(xe=>{var we;try{const Ne=Pe();return Ne&&(xe.headers.Authorization=`Bearer ${Ne}`),(we=xe.url)!=null&&we.startsWith("/api/")&&(xe.url=xe.url.replace("/api/","/")),xe}catch(Ne){console.error("Authentication error:",Ne),uf("/login")}return xe},xe=>Promise.reject(xe)),he.interceptors.response.use(xe=>xe,xe=>(xe.response&&xe.response.status===401&&(localStorage.removeItem("token"),uf("/login")),Promise.reject(xe)));const Ue=async()=>{var xe,we,Ne;try{y(!0);const[je,Ge,ht]=await Promise.all([he.get("/firewalls/firewall-types/"),he.get("/datacenters/"),he.get("/firewalls/")]),lt=Array.isArray((xe=je.data)==null?void 0:xe.results)?je.data.results:[],re=Array.isArray((we=Ge.data)==null?void 0:we.results)?Ge.data.results:[],ce=Array.isArray((Ne=ht.data)==null?void 0:Ne.results)?ht.data.results:[],Fe=re.map(He=>({id:He.id,name:He.name,description:He.description||"",location:He.location||"",latitude:He.latitude?parseFloat(He.latitude):null,longitude:He.longitude?parseFloat(He.longitude):null,owner:He.owner||"",owner_username:He.owner_username||"",created_at:He.created_at,updated_at:He.updated_at,is_active:He.is_active,firewall_count:He.firewall_count||0,firewall_type_count:He.firewall_type_count||0,firewalls:ce.filter(Qe=>{var Vr;return((Vr=Qe.data_center)==null?void 0:Vr.id)===He.id}),firewall_types:lt.filter(Qe=>Qe.data_center===He.id)}));t(Fe);const Re=localStorage.getItem("selectedFirewallId"),Xe=localStorage.getItem("firewallType"),Ze=localStorage.getItem("dataCenter");if(Re){const He=ce.find(Qe=>Qe.id===Re);He&&(k(He),w(Qe=>({...Qe,ipAddress:He.ip_address})))}Xe&&D(Xe),Ze&&P(Ze)}catch{alert("Erreur lors du chargement des donnes. Veuillez rafrachir la page.")}finally{y(!1)}};C.useEffect(()=>{Ue()},[]);const We=async()=>{await Ue()},yt=xe=>{n(we=>we.includes(xe)?we.filter(Ne=>Ne!==xe):[...we,xe])},Tt=xe=>{i(we=>we.includes(xe)?we.filter(Ne=>Ne!==xe):[...we,xe])},dt=async()=>{var xe,we,Ne,je,Ge,ht,lt,re,ce,Fe;if(o.name)try{let Re=null,Xe=null;if(o.latitude){const Qe=parseFloat(o.latitude);if(!isNaN(Qe)&&Qe>=-90&&Qe<=90)Re=Number(Qe.toFixed(6));else{alert("La latitude doit tre comprise entre -90 et 90 degrs");return}}if(o.longitude){const Qe=parseFloat(o.longitude);if(!isNaN(Qe)&&Qe>=-180&&Qe<=180)Xe=Number(Qe.toFixed(6));else{alert("La longitude doit tre comprise entre -180 et 180 degrs");return}}const Ze={name:o.name.trim(),description:o.description.trim()||null,location:o.location.trim()||null,latitude:Re,longitude:Xe,is_active:!0};if(Ze.latitude!==null&&Ze.longitude===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(Ze.latitude===null&&Ze.longitude!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}console.log("Sending data to API:",Ze);const He=await he.post("/datacenters/",Ze);console.log("API Response:",He.data),l({name:"",description:"",location:"",latitude:"",longitude:""}),await We()}catch(Re){if(console.error("Error creating data center:",Re),console.error("Error response:",(xe=Re.response)==null?void 0:xe.data),(Ne=(we=Re.response)==null?void 0:we.data)!=null&&Ne.longitude)alert(`Erreur de longitude: ${Re.response.data.longitude[0]}`);else if((Ge=(je=Re.response)==null?void 0:je.data)!=null&&Ge.latitude)alert(`Erreur de latitude: ${Re.response.data.latitude[0]}`);else{const Xe=((lt=(ht=Re.response)==null?void 0:ht.data)==null?void 0:lt.detail)||((Fe=(ce=(re=Re.response)==null?void 0:re.data)==null?void 0:ce.non_field_errors)==null?void 0:Fe[0])||"Erreur lors de la cration du datacenter. Veuillez ressayer.";alert(Xe)}}else alert("Le nom du datacenter est requis")},St=async xe=>{var je,Ge,ht,lt,re,ce;const{name:we,description:Ne}=u;if(we)try{const Fe=Object.entries(g).filter(([Ze,He])=>He).map(([Ze])=>Ze),Re={name:we,description:Ne||"",data_center:xe,attributes_schema:{type:"object",properties:Fe.reduce((Ze,He)=>{const Qe=h.find(Vr=>Vr.name===He);return Qe&&(Ze[He]={type:"string",title:Qe.label,required:Qe.required}),Ze},{}),required:Fe.filter(Ze=>{const He=h.find(Qe=>Qe.name===Ze);return He==null?void 0:He.required})}};console.log("Creating firewall type with data:",Re);const Xe=await he.post("/firewalls/firewall-types/",Re,{headers:{"Content-Type":"application/json",Accept:"application/json"}});console.log("Firewall type created successfully:",Xe.data),d({name:"",description:""}),x(h.reduce((Ze,He)=>({...Ze,[He.name]:!1}),{})),await We()}catch(Fe){console.error("Error creating firewall type:",Fe),console.error("Error response:",(je=Fe.response)==null?void 0:je.data);const Re=((ht=(Ge=Fe.response)==null?void 0:Ge.data)==null?void 0:ht.detail)||((ce=(re=(lt=Fe.response)==null?void 0:lt.data)==null?void 0:re.owner)==null?void 0:ce[0])||"Erreur lors de la cration du type de pare-feu.";alert(Re)}},_t=async xe=>{var we,Ne;try{await he.delete(`/datacenters/${xe}/`),await We()}catch(je){console.error("Error deleting data center:",je);const Ge=((Ne=(we=je.response)==null?void 0:we.data)==null?void 0:Ne.detail)||"Erreur lors de la suppression du datacenter.";alert(Ge)}},ar=async xe=>{var we,Ne;if(window.confirm("tes-vous sr de vouloir supprimer ce type de pare-feu ?"))try{await he.delete(`/firewalls/firewall-types/${xe}/`),await We()}catch(je){console.error("Error deleting firewall type:",je);const Ge=((Ne=(we=je.response)==null?void 0:we.data)==null?void 0:Ne.detail)||"Erreur lors de la suppression du type de pare-feu.";alert(Ge)}},Yt=C.useCallback(xe=>{xe.preventDefault(),B(!0)},[]),_n=C.useCallback(xe=>{xe.preventDefault(),B(!1)},[]),Vt=C.useCallback(async(xe,we)=>{var Ge,ht;xe.preventDefault(),B(!1),J(null),I(0);const je=Array.from(xe.dataTransfer.files).filter(lt=>lt.type==="text/csv"||lt.name.endsWith(".csv"));if(je.length===0){J("Veuillez dposer uniquement des fichiers CSV");return}for(const lt of je)try{const re=new FormData;re.append("file",lt),re.append("firewall_type",we);const ce=await he.post("/api/firewalls/upload-csv/",re,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:Fe=>{const Re=Fe.total?Math.round(Fe.loaded*100/Fe.total):0;I(Re)}});if(ce.data.success)_e(`Fichier tlcharg avec succs. ${ce.data.created_count} pare-feu(s) cr(s).`),J(null),await We();else{const Fe=ce.data.error||"Erreur lors du tlchargement",Re=ce.data.errors||[];J(`${Fe}
${Re.join(`
`)}`)}}catch(re){console.error("Error uploading CSV:",re);const ce=((ht=(Ge=re.response)==null?void 0:Ge.data)==null?void 0:ht.error)||"Erreur lors du tlchargement du fichier";J(ce)}},[We]),Nr=xe=>{Q(xe),U(!0)},Ke=async()=>{var xe,we,Ne,je,Ge,ht,lt;if(de)try{let re=de.latitude,ce=de.longitude;if(re!==null&&(re<-90||re>90)){alert("La latitude doit tre comprise entre -90 et 90 degrs");return}if(ce!==null&&(ce<-180||ce>180)){alert("La longitude doit tre comprise entre -180 et 180 degrs");return}if(re!==null&&ce===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(re===null&&ce!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}const Fe={name:de.name.trim(),description:((xe=de.description)==null?void 0:xe.trim())||null,location:((we=de.location)==null?void 0:we.trim())||null,latitude:re,longitude:ce,is_active:de.is_active};await he.put(`/datacenters/${de.id}/`,Fe),U(!1),Q(null),await We()}catch(re){console.error("Error updating data center:",re);const ce=((je=(Ne=re.response)==null?void 0:Ne.data)==null?void 0:je.detail)||((lt=(ht=(Ge=re.response)==null?void 0:Ge.data)==null?void 0:ht.non_field_errors)==null?void 0:lt[0])||"Erreur lors de la mise  jour du datacenter.";alert(ce)}},wt=xe=>{ue(xe),te(!0)},ur=async()=>{var xe,we,Ne,je,Ge,ht;if(ne)try{const lt=Object.entries(g).filter(([ce,Fe])=>Fe).map(([ce])=>ce),re={name:ne.name.trim(),description:((xe=ne.description)==null?void 0:xe.trim())||"",data_center:ne.data_center,attributes_schema:{type:"object",properties:lt.reduce((ce,Fe)=>{const Re=h.find(Xe=>Xe.name===Fe);return Re&&(ce[Fe]={type:"string",title:Re.label,required:Re.required}),ce},{}),required:lt.filter(ce=>{const Fe=h.find(Re=>Re.name===ce);return Fe==null?void 0:Fe.required})}};await he.put(`/firewalls/firewall-types/${ne.id}/`,re),te(!1),ue(null),await We()}catch(lt){console.error("Error updating firewall type:",lt);const re=((Ne=(we=lt.response)==null?void 0:we.data)==null?void 0:Ne.detail)||((ht=(Ge=(je=lt.response)==null?void 0:je.data)==null?void 0:Ge.non_field_errors)==null?void 0:ht[0])||"Erreur lors de la mise  jour du type de pare-feu.";alert(re)}},Ct=async xe=>{var we,Ne;if(!q.name||!q.ip_address){alert("Le nom et l'adresse IP sont requis");return}try{const je=e.flatMap(ce=>ce.firewall_types).find(ce=>ce.id===xe);if(!je)throw new Error("Type de firewall non trouv");let Ge;const ht=localStorage.getItem("userData");if(ht?Ge=JSON.parse(ht).id:Ge=(await he.get("/auth/users/me/")).data.id,!Ge)throw new Error("Impossible de rcuprer l'ID de l'utilisateur");const lt={name:q.name.trim(),ip_address:q.ip_address.trim(),firewall_type:xe,data_center:je.data_center,owner:Ge};console.log("Sending data to API:",lt);const re=await he.post("/firewalls/firewalls/",lt);console.log("API Response:",re.data),X({name:"",ip_address:"",firewall_type:""}),ye(!1),await We()}catch(je){console.error("Error creating firewall:",je),console.error("Error response:",(we=je.response)==null?void 0:we.data);let Ge="Erreur lors de la cration du pare-feu.";(Ne=je.response)!=null&&Ne.data&&(typeof je.response.data=="object"?Ge=`Erreurs de validation:
${Object.entries(je.response.data).map(([lt,re])=>`${lt}: ${Array.isArray(re)?re.join(", "):re}`).join(`
`)}`:typeof je.response.data=="string"?Ge=je.response.data:je.response.data.detail&&(Ge=je.response.data.detail)),alert(Ge)}},Ar=async xe=>{var we,Ne;if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await he.delete(`/firewalls/${xe}/`),await We()}catch(je){console.error("Error deleting firewall:",je);const Ge=((Ne=(we=je.response)==null?void 0:we.data)==null?void 0:Ne.detail)||"Erreur lors de la suppression du pare-feu.";alert(Ge)}},yn=async()=>{if(!ke.trim()||!G.trim()){alert("Le nom et la description sont requis");return}try{Te(!0),await di.createVariable({name:ke.trim(),description:G.trim()}),$e(""),ot("");const we=(await di.getVariables()).map(Ne=>({name:Ne.name,label:Ne.name,required:!1}));m(we),x(we.reduce((Ne,je)=>({...Ne,[je.name]:!1}),{}))}catch{alert("Erreur lors de la cration de la variable")}finally{Te(!1)}},Qa=()=>f.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Liste des Datacenters et Types de Firewall"}),f.jsx("div",{className:"space-y-4",children:e.map(xe=>{var we;return f.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[f.jsxs("div",{className:"bg-gray-50 p-4 flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900",children:xe.name}),f.jsx("p",{className:"text-sm text-gray-500",children:xe.location})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("button",{onClick:()=>Nr(xe),className:"px-3 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-2",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),f.jsxs("button",{onClick:()=>_t(xe.id),className:"px-3 py-1.5 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-2",children:[f.jsx(An,{className:"h-4 w-4"}),"Supprimer"]})]})]}),f.jsxs("div",{className:"p-4",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Types de Firewall"}),f.jsx("div",{className:"space-y-3",children:(we=xe.firewall_types)==null?void 0:we.map(Ne=>{var je;return f.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:Ne.name}),f.jsx("p",{className:"text-sm text-gray-500",children:Ne.description}),f.jsxs("div",{className:"mt-2",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Attributs configurs:"}),f.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:((je=Ne.attributes_schema)==null?void 0:je.properties)&&Object.entries(Ne.attributes_schema.properties).sort(([Ge],[ht])=>{const lt=ev.indexOf(Ge),re=ev.indexOf(ht);return lt===-1?1:re===-1?-1:lt-re}).map(([Ge,ht])=>f.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:Ge},Ge))})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("button",{onClick:()=>{be(Ne.id),ye(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[f.jsx(es,{className:"h-3 w-3"}),"Ajouter Firewall"]}),f.jsxs("button",{onClick:()=>wt(Ne),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),f.jsxs("button",{onClick:()=>ar(Ne.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[f.jsx(An,{className:"h-3 w-3"}),"Supprimer"]})]})]})},Ne.id)})})]})]},xe.id)})})]}),Dn=(xe,we)=>{var Ne;return f.jsxs("div",{className:"ml-6 mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-md",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{onClick:()=>Tt(we.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:a.includes(we.id)?f.jsx(ff,{size:20}):f.jsx(df,{size:20})}),f.jsx("span",{className:"font-medium",children:we.name})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("button",{onClick:()=>{be(we.id),ye(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[f.jsx(es,{className:"h-3 w-3"}),"Ajouter Firewall"]}),f.jsxs("button",{onClick:()=>wt(we),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),f.jsxs("button",{onClick:()=>ar(we.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[f.jsx(An,{className:"h-3 w-3"}),"Supprimer"]})]})]}),a.includes(we.id)&&f.jsxs("div",{className:"mt-2 p-4 bg-white rounded-md shadow",children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pare-feu existants"}),f.jsx("div",{className:"space-y-2",children:(Ne=we.firewalls)==null?void 0:Ne.map(je=>f.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:je.name}),f.jsx("p",{className:"text-sm text-gray-500",children:je.ip_address})]}),f.jsx("button",{onClick:()=>Ar(je.id),className:"text-red-500 hover:text-red-700",children:f.jsx(An,{className:"h-4 w-4"})})]},je.id))})]}),f.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center ${H?"border-purple-500 bg-purple-50":"border-gray-300"}`,onDragOver:Yt,onDragLeave:_n,onDrop:je=>Vt(je,we.id),children:[f.jsx(m2,{className:"mx-auto h-12 w-12 text-gray-400"}),f.jsxs("div",{className:"mt-4",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Glissez et dposez vos fichiers CSV ici"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ou cliquez pour slectionner des fichiers"})]}),W!==null&&f.jsxs("div",{className:"mt-4",children:[f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:f.jsx("div",{className:"bg-purple-600 h-2.5 rounded-full",style:{width:`${W}%`}})}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Progression: ",W,"%"]})]}),Z&&f.jsx("p",{className:"text-red-500 text-sm mt-2",children:Z})]})]})]},we.id)};return C.useEffect(()=>{(async()=>{try{const Ne=(await di.getVariables()).map(je=>({name:je.name,label:je.name,required:!1}));m(Ne),x(Ne.reduce((je,Ge)=>({...je,[Ge.name]:!1}),{}))}catch(we){console.error("Error loading variables:",we)}})()},[]),f.jsxs("div",{className:"p-8",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Paramtres CMS"}),f.jsx("p",{className:"text-gray-600",children:"Grez la structure des data centers et leurs types de firewalls"})]}),f.jsxs("button",{onClick:We,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Rafrachir"]})]}),_?f.jsx("div",{className:"flex justify-center items-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):f.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[Qa(),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Structure"}),f.jsx("div",{className:"mb-6 p-4 border border-dashed border-gray-300 rounded-lg",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"Nom du Data Center *",value:o.name,onChange:xe=>l(we=>({...we,name:xe.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",required:!0}),f.jsx("button",{onClick:dt,className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:f.jsx(es,{className:"w-4 h-4"})})]}),f.jsx("textarea",{placeholder:"Description",value:o.description,onChange:xe=>l(we=>({...we,description:xe.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),f.jsx("input",{type:"text",placeholder:"Adresse physique",value:o.location,onChange:xe=>l(we=>({...we,location:xe.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude (-90  90)",value:o.latitude,onChange:xe=>{const we=xe.target.value;(we===""||parseFloat(we)>=-90&&parseFloat(we)<=90)&&l(Ne=>({...Ne,latitude:we}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: 33.552084"})]}),f.jsxs("div",{children:[f.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude (-180  180)",value:o.longitude,onChange:xe=>{const we=xe.target.value;(we===""||parseFloat(we)>=-180&&parseFloat(we)<=180)&&l(Ne=>({...Ne,longitude:we}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: -7.657616"})]})]})]})}),f.jsx("div",{className:"space-y-2",children:Array.isArray(e)&&e.map(xe=>{var we;return f.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-t-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{onClick:()=>yt(xe.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:r.includes(xe.id)?f.jsx(ff,{className:"w-4 h-4"}):f.jsx(df,{className:"w-4 h-4"})}),f.jsx("span",{className:"font-medium",children:xe.name})]}),f.jsx("button",{onClick:()=>_t(xe.id),className:"text-red-500 hover:text-red-700",children:f.jsx(An,{className:"w-4 h-4"})})]}),r.includes(xe.id)&&f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsx("div",{className:"p-4 border border-dashed border-gray-300 rounded-lg",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"Nom du type de pare-feu",value:u.name,onChange:Ne=>d(je=>({...je,name:Ne.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm"}),f.jsx("button",{onClick:()=>St(xe.id),className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:f.jsx(es,{className:"w-4 h-4"})})]}),f.jsx("textarea",{placeholder:"Description",value:u.description,onChange:Ne=>d(je=>({...je,description:Ne.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.map(Ne=>f.jsxs("label",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"checkbox",checked:g[Ne.name],onChange:je=>x(Ge=>({...Ge,[Ne.name]:je.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),f.jsx("span",{className:"text-sm text-gray-700",children:Ne.label})]},Ne.name)),f.jsxs("div",{className:"flex items-center space-x-2 col-span-2 mt-2",children:[f.jsx("input",{type:"text",value:ke,onChange:Ne=>$e(Ne.target.value),placeholder:"Nom de la variable",className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",disabled:me}),f.jsx("input",{type:"text",value:G,onChange:Ne=>ot(Ne.target.value),placeholder:"Description",className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",disabled:me}),f.jsx("button",{onClick:yn,className:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",disabled:me,children:"Ajouter"})]})]})]})}),f.jsx("div",{className:"space-y-2",children:(we=xe.firewall_types)==null?void 0:we.map(Ne=>Dn(xe,Ne))})]})]},xe.id)})})]})})})]}),ee&&de&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Data Center"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),f.jsx("input",{type:"text",value:de.name,onChange:xe=>Q(we=>we?{...we,name:xe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),f.jsx("textarea",{value:de.description||"",onChange:xe=>Q(we=>we?{...we,description:xe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse physique"}),f.jsx("input",{type:"text",value:de.location||"",onChange:xe=>Q(we=>we?{...we,location:xe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude (-90  90)"}),f.jsx("input",{type:"number",step:"0.000001",value:de.latitude||"",onChange:xe=>{const we=xe.target.value===""?null:parseFloat(xe.target.value);(we===null||we>=-90&&we<=90)&&Q(Ne=>Ne?{...Ne,latitude:we}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude (-180  180)"}),f.jsx("input",{type:"number",step:"0.000001",value:de.longitude||"",onChange:xe=>{const we=xe.target.value===""?null:parseFloat(xe.target.value);(we===null||we>=-180&&we<=180)&&Q(Ne=>Ne?{...Ne,longitude:we}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"})]})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("input",{type:"checkbox",checked:de.is_active,onChange:xe=>Q(we=>we?{...we,is_active:xe.target.checked}:null),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),f.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Actif"})]})]}),f.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[f.jsx("button",{onClick:()=>{U(!1),Q(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),f.jsx("button",{onClick:Ke,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),F&&ne&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Type de Pare-feu"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),f.jsx("input",{type:"text",value:ne.name,onChange:xe=>ue(we=>we?{...we,name:xe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),f.jsx("textarea",{value:ne.description||"",onChange:xe=>ue(we=>we?{...we,description:xe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attributs de configuration"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.map(xe=>f.jsxs("label",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"checkbox",checked:g[xe.name],onChange:we=>x(Ne=>({...Ne,[xe.name]:we.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),f.jsx("span",{className:"text-sm text-gray-700",children:xe.label})]},xe.name)),f.jsxs("div",{className:"flex items-center space-x-2 col-span-2 mt-2",children:[f.jsx("input",{type:"text",value:ke,onChange:xe=>$e(xe.target.value),placeholder:"Nom de la variable",className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",disabled:me}),f.jsx("input",{type:"text",value:G,onChange:xe=>ot(xe.target.value),placeholder:"Description",className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",disabled:me}),f.jsx("button",{onClick:yn,className:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",disabled:me,children:"Ajouter"})]})]})]})]}),f.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[f.jsx("button",{onClick:()=>{te(!1),ue(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),f.jsx("button",{onClick:ur,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),K&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ajouter un Pare-feu"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),f.jsx("input",{type:"text",value:q.name,onChange:xe=>X(we=>({...we,name:xe.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP *"}),f.jsx("input",{type:"text",value:q.ip_address,onChange:xe=>X(we=>({...we,ip_address:xe.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0,placeholder:"Ex: 192.168.1.1"})]})]}),f.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[f.jsx("button",{onClick:()=>{ye(!1),X({name:"",ip_address:"",firewall_type:""})},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),f.jsx("button",{onClick:()=>Ct(Le),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Ajouter"})]})]})})]})}const Xi=Ve.create({baseURL:Dt});Xi.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Xi.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));const tv={getFirewalls:async e=>{try{let t="/firewalls/firewalls/";return e&&(t+=`?page=${e}`),(await Xi.get(t)).data}catch(t){throw t}},getFirewall:async e=>{try{return(await Xi.get(`/firewalls/firewalls/${e}/`)).data}catch(t){throw t}},createFirewall:async e=>{try{return(await Xi.post("/firewalls/firewalls/",e)).data}catch(t){throw t}},updateFirewall:async(e,t)=>{try{return(await Xi.put(`/firewalls/firewalls/${e}/`,t)).data}catch(r){throw r}},deleteFirewall:async e=>{try{await Xi.delete(`/firewalls/firewalls/${e}/`)}catch(t){throw t}}},rv=()=>{const[e,t]=C.useState([]),[r,n]=C.useState([]),[a,i]=C.useState(""),[o,l]=C.useState(!0),[u,d]=C.useState(null),[h,m]=C.useState(0);C.useEffect(()=>{(async()=>{try{l(!0);let y=[],E=1,k=!0;for(;k;){const S=await tv.getFirewalls(E),w=S.results||[];y=y.concat(w),S.next?E+=1:k=!1}t(y),n(y),d(null)}catch(y){d(`Erreur lors de la rcupration des pare-feux: ${y.message||"Erreur inconnue"}`)}finally{l(!1)}})()},[h]),C.useEffect(()=>{if(!a.trim()){n(e);return}const _=a.toLowerCase().trim(),y=e.filter(E=>E.name.toLowerCase().includes(_)||E.ip_address.toLowerCase().includes(_));n(y)},[a,e]);const g=()=>{m(_=>_+1)},x=async _=>{if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await tv.deleteFirewall(_),t(e.filter(y=>y.id!==_))}catch{d("Erreur lors de la suppression du pare-feu")}};return o?f.jsx("div",{className:"flex items-center justify-center h-screen",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):f.jsxs("div",{className:"p-8",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Liste des Pare-feux"}),f.jsx("p",{className:"text-gray-600",children:"Grez vos pare-feux et leurs configurations"})]}),f.jsxs("button",{onClick:g,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[f.jsx(pb,{className:"w-4 h-4"}),"Rafrachir"]})]}),f.jsxs("div",{className:"mb-6",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(mb,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Rechercher par nom ou adresse IP...",value:a,onChange:_=>i(_.target.value)})]}),a&&f.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:[r.length," pare-feu",r.length!==1?"x":""," trouv",r.length!==1?"s":""]})]}),u&&f.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md",children:u}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(_=>{var y;return f.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(ms,{className:"h-8 w-8 text-purple-600 mr-3"}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:_.name}),f.jsx("p",{className:"text-gray-500 text-sm",children:_.ip_address})]})]}),f.jsx("div",{className:"flex space-x-2",children:f.jsx("button",{onClick:()=>x(_.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors duration-200",children:f.jsx(An,{className:"h-5 w-5"})})})]}),f.jsxs("div",{className:"mt-4 space-y-3",children:[f.jsxs("div",{className:"flex items-center text-gray-600",children:[f.jsx(mc,{className:"h-5 w-5 mr-2"}),f.jsxs("span",{children:["Data Center: ",((y=_.data_center_info)==null?void 0:y.name)||"N/A"]})]}),f.jsxs("div",{className:"flex items-center text-gray-600",children:[f.jsx(gc,{className:"h-5 w-5 mr-2"}),f.jsxs("span",{children:["Type: ",typeof _.firewall_type=="object"&&_.firewall_type?_.firewall_type.name:"N/A"]})]})]})]})},_.id)})}),r.length===0&&!o&&f.jsxs("div",{className:"text-center py-12",children:[f.jsx(ms,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Aucun rsultat trouv":"Aucun pare-feu trouv"}),f.jsx("p",{className:"text-gray-500 mt-2",children:a?"Essayez de modifier votre recherche":"Commencez par ajouter un nouveau pare-feu."})]})]})};function Sm(e,t){const r=C.useRef(t);C.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function bM(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const ek=1;function tk(e){return Object.freeze({__version:ek,map:e})}function Tm(e,t){return Object.freeze({...e,...t})}const Cm=C.createContext(null),bm=Cm.Provider;function Sc(){const e=C.useContext(Cm);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Nm(e){function t(r,n){const{instance:a,context:i}=e(r).current;return C.useImperativeHandle(n,()=>a),r.children==null?null:ls.createElement(bm,{value:i},r.children)}return C.forwardRef(t)}function rk(e){function t(r,n){const[a,i]=C.useState(!1),{instance:o}=e(r,i).current;C.useImperativeHandle(n,()=>o),C.useEffect(function(){a&&o.update()},[o,a,r.children]);const l=o._contentNode;return l?Cy.createPortal(r.children,l):null}return C.forwardRef(t)}function Am(e){function t(r,n){const{instance:a}=e(r).current;return C.useImperativeHandle(n,()=>a),null}return C.forwardRef(t)}function nk(e){return function(r){const n=Sc(),a=e(r,n),{instance:i}=a.current,o=C.useRef(r.position),{position:l}=r;return C.useEffect(function(){return i.addTo(n.map),function(){i.remove()}},[n.map,i]),C.useEffect(function(){l!=null&&l!==o.current&&(i.setPosition(l),o.current=l)},[i,l]),a}}function s0(e,t){const r=C.useRef();C.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function Tc(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function ak(e,t){return function(n,a){const i=Sc(),o=e(Tc(n,i),i);return Sm(i.map,n.attribution),s0(o.current,n.eventHandlers),t(o.current,i,n,a),o}}var Ih={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(Ni,function(r){var n="1.9.4";function a(s){var c,p,v,T;for(p=1,v=arguments.length;p<v;p++){T=arguments[p];for(c in T)s[c]=T[c]}return s}var i=Object.create||function(){function s(){}return function(c){return s.prototype=c,new s}}();function o(s,c){var p=Array.prototype.slice;if(s.bind)return s.bind.apply(s,p.call(arguments,1));var v=p.call(arguments,2);return function(){return s.apply(c,v.length?v.concat(p.call(arguments)):arguments)}}var l=0;function u(s){return"_leaflet_id"in s||(s._leaflet_id=++l),s._leaflet_id}function d(s,c,p){var v,T,N,Y;return Y=function(){v=!1,T&&(N.apply(p,T),T=!1)},N=function(){v?T=arguments:(s.apply(p,arguments),setTimeout(Y,c),v=!0)},N}function h(s,c,p){var v=c[1],T=c[0],N=v-T;return s===v&&p?s:((s-T)%N+N)%N+T}function m(){return!1}function g(s,c){if(c===!1)return s;var p=Math.pow(10,c===void 0?6:c);return Math.round(s*p)/p}function x(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function _(s){return x(s).split(/\s+/)}function y(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?i(s.options):{});for(var p in c)s.options[p]=c[p];return s.options}function E(s,c,p){var v=[];for(var T in s)v.push(encodeURIComponent(p?T.toUpperCase():T)+"="+encodeURIComponent(s[T]));return(!c||c.indexOf("?")===-1?"?":"&")+v.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function S(s,c){return s.replace(k,function(p,v){var T=c[v];if(T===void 0)throw new Error("No value provided for variable "+p);return typeof T=="function"&&(T=T(c)),T})}var w=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function A(s,c){for(var p=0;p<s.length;p++)if(s[p]===c)return p;return-1}var D="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var P=0;function H(s){var c=+new Date,p=Math.max(0,16-(c-P));return P=c+p,window.setTimeout(s,p)}var B=window.requestAnimationFrame||R("RequestAnimationFrame")||H,W=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function I(s,c,p){if(p&&B===H)s.call(c);else return B.call(window,o(s,c))}function Z(s){s&&W.call(window,s)}var J={__proto__:null,extend:a,create:i,bind:o,get lastId(){return l},stamp:u,throttle:d,wrapNum:h,falseFn:m,formatNum:g,trim:x,splitWords:_,setOptions:y,getParamString:E,template:S,isArray:w,indexOf:A,emptyImageUrl:D,requestFn:B,cancelFn:W,requestAnimFrame:I,cancelAnimFrame:Z};function ge(){}ge.extend=function(s){var c=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=c.__super__=this.prototype,v=i(p);v.constructor=c,c.prototype=v;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return s.statics&&a(c,s.statics),s.includes&&(_e(s.includes),a.apply(null,[v].concat(s.includes))),a(v,s),delete v.statics,delete v.includes,v.options&&(v.options=p.options?i(p.options):{},a(v.options,s.options)),v._initHooks=[],v.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var N=0,Y=v._initHooks.length;N<Y;N++)v._initHooks[N].call(this)}},c},ge.include=function(s){var c=this.prototype.options;return a(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},ge.mergeOptions=function(s){return a(this.prototype.options,s),this},ge.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),p=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function _e(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=w(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(s,c,p){if(typeof s=="object")for(var v in s)this._on(v,s[v],c);else{s=_(s);for(var T=0,N=s.length;T<N;T++)this._on(s[T],c,p)}return this},off:function(s,c,p){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var v in s)this._off(v,s[v],c);else{s=_(s);for(var T=arguments.length===1,N=0,Y=s.length;N<Y;N++)T?this._off(s[N]):this._off(s[N],c,p)}return this},_on:function(s,c,p,v){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,p)===!1){p===this&&(p=void 0);var T={fn:c,ctx:p};v&&(T.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(T)}},_off:function(s,c,p){var v,T,N;if(this._events&&(v=this._events[s],!!v)){if(arguments.length===1){if(this._firingCount)for(T=0,N=v.length;T<N;T++)v[T].fn=m;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var Y=this._listens(s,c,p);if(Y!==!1){var ie=v[Y];this._firingCount&&(ie.fn=m,this._events[s]=v=v.slice()),v.splice(Y,1)}}},fire:function(s,c,p){if(!this.listens(s,p))return this;var v=a({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[s];if(T){this._firingCount=this._firingCount+1||1;for(var N=0,Y=T.length;N<Y;N++){var ie=T[N],fe=ie.fn;ie.once&&this.off(s,fe,ie.ctx),fe.call(ie.ctx||this,v)}this._firingCount--}}return p&&this._propagateEvent(v),this},listens:function(s,c,p,v){typeof s!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(v=!!c,T=void 0,p=void 0);var N=this._events&&this._events[s];if(N&&N.length&&this._listens(s,T,p)!==!1)return!0;if(v){for(var Y in this._eventParents)if(this._eventParents[Y].listens(s,c,p,v))return!0}return!1},_listens:function(s,c,p){if(!this._events)return!1;var v=this._events[s]||[];if(!c)return!!v.length;p===this&&(p=void 0);for(var T=0,N=v.length;T<N;T++)if(v[T].fn===c&&v[T].ctx===p)return T;return!1},once:function(s,c,p){if(typeof s=="object")for(var v in s)this._on(v,s[v],c,!0);else{s=_(s);for(var T=0,N=s.length;T<N;T++)this._on(s[T],c,p,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[u(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[u(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,a({layer:s.target,propagatedFrom:s.target},s),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var Q=ge.extend(de);function ee(s,c,p){this.x=p?Math.round(s):s,this.y=p?Math.round(c):c}var U=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};ee.prototype={clone:function(){return new ee(this.x,this.y)},add:function(s){return this.clone()._add(ne(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ne(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new ee(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new ee(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=U(this.x),this.y=U(this.y),this},distanceTo:function(s){s=ne(s);var c=s.x-this.x,p=s.y-this.y;return Math.sqrt(c*c+p*p)},equals:function(s){return s=ne(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ne(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function ne(s,c,p){return s instanceof ee?s:w(s)?new ee(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new ee(s.x,s.y):new ee(s,c,p)}function ue(s,c){if(s)for(var p=c?[s,c]:s,v=0,T=p.length;v<T;v++)this.extend(p[v])}ue.prototype={extend:function(s){var c,p;if(!s)return this;if(s instanceof ee||typeof s[0]=="number"||"x"in s)c=p=ne(s);else if(s=F(s),c=s.min,p=s.max,!c||!p)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=p.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(s){return ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ne(this.min.x,this.max.y)},getTopRight:function(){return ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,p;return typeof s[0]=="number"||s instanceof ee?s=ne(s):s=F(s),s instanceof ue?(c=s.min,p=s.max):c=p=s,c.x>=this.min.x&&p.x<=this.max.x&&c.y>=this.min.y&&p.y<=this.max.y},intersects:function(s){s=F(s);var c=this.min,p=this.max,v=s.min,T=s.max,N=T.x>=c.x&&v.x<=p.x,Y=T.y>=c.y&&v.y<=p.y;return N&&Y},overlaps:function(s){s=F(s);var c=this.min,p=this.max,v=s.min,T=s.max,N=T.x>c.x&&v.x<p.x,Y=T.y>c.y&&v.y<p.y;return N&&Y},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,p=this.max,v=Math.abs(c.x-p.x)*s,T=Math.abs(c.y-p.y)*s;return F(ne(c.x-v,c.y-T),ne(p.x+v,p.y+T))},equals:function(s){return s?(s=F(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function F(s,c){return!s||s instanceof ue?s:new ue(s,c)}function te(s,c){if(s)for(var p=c?[s,c]:s,v=0,T=p.length;v<T;v++)this.extend(p[v])}te.prototype={extend:function(s){var c=this._southWest,p=this._northEast,v,T;if(s instanceof X)v=s,T=s;else if(s instanceof te){if(v=s._southWest,T=s._northEast,!v||!T)return this}else return s?this.extend(K(s)||q(s)):this;return!c&&!p?(this._southWest=new X(v.lat,v.lng),this._northEast=new X(T.lat,T.lng)):(c.lat=Math.min(v.lat,c.lat),c.lng=Math.min(v.lng,c.lng),p.lat=Math.max(T.lat,p.lat),p.lng=Math.max(T.lng,p.lng)),this},pad:function(s){var c=this._southWest,p=this._northEast,v=Math.abs(c.lat-p.lat)*s,T=Math.abs(c.lng-p.lng)*s;return new te(new X(c.lat-v,c.lng-T),new X(p.lat+v,p.lng+T))},getCenter:function(){return new X((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new X(this.getNorth(),this.getWest())},getSouthEast:function(){return new X(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof X||"lat"in s?s=K(s):s=q(s);var c=this._southWest,p=this._northEast,v,T;return s instanceof te?(v=s.getSouthWest(),T=s.getNorthEast()):v=T=s,v.lat>=c.lat&&T.lat<=p.lat&&v.lng>=c.lng&&T.lng<=p.lng},intersects:function(s){s=q(s);var c=this._southWest,p=this._northEast,v=s.getSouthWest(),T=s.getNorthEast(),N=T.lat>=c.lat&&v.lat<=p.lat,Y=T.lng>=c.lng&&v.lng<=p.lng;return N&&Y},overlaps:function(s){s=q(s);var c=this._southWest,p=this._northEast,v=s.getSouthWest(),T=s.getNorthEast(),N=T.lat>c.lat&&v.lat<p.lat,Y=T.lng>c.lng&&v.lng<p.lng;return N&&Y},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=q(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function q(s,c){return s instanceof te?s:new te(s,c)}function X(s,c,p){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,p!==void 0&&(this.alt=+p)}X.prototype={equals:function(s,c){if(!s)return!1;s=K(s);var p=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return p<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+g(this.lat,s)+", "+g(this.lng,s)+")"},distanceTo:function(s){return Le.distance(this,K(s))},wrap:function(){return Le.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,p=c/Math.cos(Math.PI/180*this.lat);return q([this.lat-c,this.lng-p],[this.lat+c,this.lng+p])},clone:function(){return new X(this.lat,this.lng,this.alt)}};function K(s,c,p){return s instanceof X?s:w(s)&&typeof s[0]!="object"?s.length===3?new X(s[0],s[1],s[2]):s.length===2?new X(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new X(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new X(s,c,p)}var ye={latLngToPoint:function(s,c){var p=this.projection.project(s),v=this.scale(c);return this.transformation._transform(p,v)},pointToLatLng:function(s,c){var p=this.scale(c),v=this.transformation.untransform(s,p);return this.projection.unproject(v)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,p=this.scale(s),v=this.transformation.transform(c.min,p),T=this.transformation.transform(c.max,p);return new ue(v,T)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?h(s.lng,this.wrapLng,!0):s.lng,p=this.wrapLat?h(s.lat,this.wrapLat,!0):s.lat,v=s.alt;return new X(p,c,v)},wrapLatLngBounds:function(s){var c=s.getCenter(),p=this.wrapLatLng(c),v=c.lat-p.lat,T=c.lng-p.lng;if(v===0&&T===0)return s;var N=s.getSouthWest(),Y=s.getNorthEast(),ie=new X(N.lat-v,N.lng-T),fe=new X(Y.lat-v,Y.lng-T);return new te(ie,fe)}},Le=a({},ye,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var p=Math.PI/180,v=s.lat*p,T=c.lat*p,N=Math.sin((c.lat-s.lat)*p/2),Y=Math.sin((c.lng-s.lng)*p/2),ie=N*N+Math.cos(v)*Math.cos(T)*Y*Y,fe=2*Math.atan2(Math.sqrt(ie),Math.sqrt(1-ie));return this.R*fe}}),be=6378137,ke={R:be,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,p=this.MAX_LATITUDE,v=Math.max(Math.min(p,s.lat),-p),T=Math.sin(v*c);return new ee(this.R*s.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(s){var c=180/Math.PI;return new X((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:function(){var s=be*Math.PI;return new ue([-s,-s],[s,s])}()};function $e(s,c,p,v){if(w(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=p,this._d=v}$e.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new ee((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function G(s,c,p,v){return new $e(s,c,p,v)}var ot=a({},Le,{code:"EPSG:3857",projection:ke,transformation:function(){var s=.5/(Math.PI*ke.R);return G(s,.5,-s,.5)}()}),me=a({},ot,{code:"EPSG:900913"});function Te(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Pe(s,c){var p="",v,T,N,Y,ie,fe;for(v=0,N=s.length;v<N;v++){for(ie=s[v],T=0,Y=ie.length;T<Y;T++)fe=ie[T],p+=(T?"L":"M")+fe.x+" "+fe.y;p+=c?Be.svg?"z":"x":""}return p||"M0 0"}var he=document.documentElement.style,Ue="ActiveXObject"in window,We=Ue&&!document.addEventListener,yt="msLaunchUri"in navigator&&!("documentMode"in document),Tt=Lr("webkit"),dt=Lr("android"),St=Lr("android 2")||Lr("android 3"),_t=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ar=dt&&Lr("Google")&&_t<537&&!("AudioNode"in window),Yt=!!window.opera,_n=!yt&&Lr("chrome"),Vt=Lr("gecko")&&!Tt&&!Yt&&!Ue,Nr=!_n&&Lr("safari"),Ke=Lr("phantom"),wt="OTransition"in he,ur=navigator.platform.indexOf("Win")===0,Ct=Ue&&"transition"in he,Ar="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!St,yn="MozPerspective"in he,Qa=!window.L_DISABLE_3D&&(Ct||Ar||yn)&&!wt&&!Ke,Dn=typeof orientation<"u"||Lr("mobile"),xe=Dn&&Tt,we=Dn&&Ar,Ne=!window.PointerEvent&&window.MSPointerEvent,je=!!(window.PointerEvent||Ne),Ge="ontouchstart"in window||!!window.TouchEvent,ht=!window.L_NO_TOUCH&&(Ge||je),lt=Dn&&Yt,re=Dn&&Vt,ce=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Fe=function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return s}(),Re=function(){return!!document.createElement("canvas").getContext}(),Xe=!!(document.createElementNS&&Te("svg").createSVGRect),Ze=!!Xe&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),He=!Xe&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Qe=navigator.platform.indexOf("Mac")===0,Vr=navigator.platform.indexOf("Linux")===0;function Lr(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Be={ie:Ue,ielt9:We,edge:yt,webkit:Tt,android:dt,android23:St,androidStock:ar,opera:Yt,chrome:_n,gecko:Vt,safari:Nr,phantom:Ke,opera12:wt,win:ur,ie3d:Ct,webkit3d:Ar,gecko3d:yn,any3d:Qa,mobile:Dn,mobileWebkit:xe,mobileWebkit3d:we,msPointer:Ne,pointer:je,touch:ht,touchNative:Ge,mobileOpera:lt,mobileGecko:re,retina:ce,passiveEvents:Fe,canvas:Re,svg:Xe,vml:He,inlineSvg:Ze,mac:Qe,linux:Vr},b=Be.msPointer?"MSPointerDown":"pointerdown",M=Be.msPointer?"MSPointerMove":"pointermove",O=Be.msPointer?"MSPointerUp":"pointerup",j=Be.msPointer?"MSPointerCancel":"pointercancel",z={touchstart:b,touchmove:M,touchend:O,touchcancel:j},V={touchstart:Me,touchmove:Ae,touchend:Ae,touchcancel:Ae},ae={},ve=!1;function se(s,c,p){return c==="touchstart"&&Ie(),V[c]?(p=V[c].bind(this,p),s.addEventListener(z[c],p,!1),p):(console.warn("wrong event specified:",c),m)}function oe(s,c,p){if(!z[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(z[c],p,!1)}function le(s){ae[s.pointerId]=s}function Se(s){ae[s.pointerId]&&(ae[s.pointerId]=s)}function Oe(s){delete ae[s.pointerId]}function Ie(){ve||(document.addEventListener(b,le,!0),document.addEventListener(M,Se,!0),document.addEventListener(O,Oe,!0),document.addEventListener(j,Oe,!0),ve=!0)}function Ae(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var p in ae)c.touches.push(ae[p]);c.changedTouches=[c],s(c)}}function Me(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&xr(c),Ae(s,c)}function Je(s){var c={},p,v;for(v in s)p=s[v],c[v]=p&&p.bind?p.bind(s):p;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Lt=200;function Pt(s,c){s.addEventListener("dblclick",c);var p=0,v;function T(N){if(N.detail!==1){v=N.detail;return}if(!(N.pointerType==="mouse"||N.sourceCapabilities&&!N.sourceCapabilities.firesTouchEvents)){var Y=Rm(N);if(!(Y.some(function(fe){return fe instanceof HTMLLabelElement&&fe.attributes.for})&&!Y.some(function(fe){return fe instanceof HTMLInputElement||fe instanceof HTMLSelectElement}))){var ie=Date.now();ie-p<=Lt?(v++,v===2&&c(Je(N))):v=1,p=ie}}}return s.addEventListener("click",T),{dblclick:c,simDblclick:T}}function fr(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var Sa=Nc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),In=Nc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ei=In==="webkitTransition"||In==="OTransition"?In+"End":"transitionend";function aa(s){return typeof s=="string"?document.getElementById(s):s}function Ta(s,c){var p=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!p||p==="auto")&&document.defaultView){var v=document.defaultView.getComputedStyle(s,null);p=v?v[c]:null}return p==="auto"?null:p}function tt(s,c,p){var v=document.createElement(s);return v.className=c||"",p&&p.appendChild(v),v}function It(s){var c=s.parentNode;c&&c.removeChild(s)}function Cc(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function As(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function Ls(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function l0(s,c){if(s.classList!==void 0)return s.classList.contains(c);var p=bc(s);return p.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(p)}function it(s,c){if(s.classList!==void 0)for(var p=_(c),v=0,T=p.length;v<T;v++)s.classList.add(p[v]);else if(!l0(s,c)){var N=bc(s);c0(s,(N?N+" ":"")+c)}}function Zt(s,c){s.classList!==void 0?s.classList.remove(c):c0(s,x((" "+bc(s)+" ").replace(" "+c+" "," ")))}function c0(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function bc(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function wn(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&Nk(s,c)}function Nk(s,c){var p=!1,v="DXImageTransform.Microsoft.Alpha";try{p=s.filters.item(v)}catch{if(c===1)return}c=Math.round(c*100),p?(p.Enabled=c!==100,p.Opacity=c):s.style.filter+=" progid:"+v+"(opacity="+c+")"}function Nc(s){for(var c=document.documentElement.style,p=0;p<s.length;p++)if(s[p]in c)return s[p];return!1}function Bi(s,c,p){var v=c||new ee(0,0);s.style[Sa]=(Be.ie3d?"translate("+v.x+"px,"+v.y+"px)":"translate3d("+v.x+"px,"+v.y+"px,0)")+(p?" scale("+p+")":"")}function Kt(s,c){s._leaflet_pos=c,Be.any3d?Bi(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function zi(s){return s._leaflet_pos||new ee(0,0)}var Do,Io,u0;if("onselectstart"in document)Do=function(){rt(window,"selectstart",xr)},Io=function(){bt(window,"selectstart",xr)};else{var Bo=Nc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Do=function(){if(Bo){var s=document.documentElement.style;u0=s[Bo],s[Bo]="none"}},Io=function(){Bo&&(document.documentElement.style[Bo]=u0,u0=void 0)}}function f0(){rt(window,"dragstart",xr)}function d0(){bt(window,"dragstart",xr)}var Ac,h0;function p0(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Lc(),Ac=s,h0=s.style.outlineStyle,s.style.outlineStyle="none",rt(window,"keydown",Lc))}function Lc(){Ac&&(Ac.style.outlineStyle=h0,Ac=void 0,h0=void 0,bt(window,"keydown",Lc))}function Mm(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function m0(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var Ak={__proto__:null,TRANSFORM:Sa,TRANSITION:In,TRANSITION_END:ei,get:aa,getStyle:Ta,create:tt,remove:It,empty:Cc,toFront:As,toBack:Ls,hasClass:l0,addClass:it,removeClass:Zt,setClass:c0,getClass:bc,setOpacity:wn,testProp:Nc,setTransform:Bi,setPosition:Kt,getPosition:zi,get disableTextSelection(){return Do},get enableTextSelection(){return Io},disableImageDrag:f0,enableImageDrag:d0,preventOutline:p0,restoreOutline:Lc,getSizedParentNode:Mm,getScale:m0};function rt(s,c,p,v){if(c&&typeof c=="object")for(var T in c)x0(s,T,c[T],p);else{c=_(c);for(var N=0,Y=c.length;N<Y;N++)x0(s,c[N],p,v)}return this}var ia="_leaflet_events";function bt(s,c,p,v){if(arguments.length===1)jm(s),delete s[ia];else if(c&&typeof c=="object")for(var T in c)v0(s,T,c[T],p);else if(c=_(c),arguments.length===2)jm(s,function(ie){return A(c,ie)!==-1});else for(var N=0,Y=c.length;N<Y;N++)v0(s,c[N],p,v);return this}function jm(s,c){for(var p in s[ia]){var v=p.split(/\d/)[0];(!c||c(v))&&v0(s,v,null,null,p)}}var g0={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function x0(s,c,p,v){var T=c+u(p)+(v?"_"+u(v):"");if(s[ia]&&s[ia][T])return this;var N=function(ie){return p.call(v||s,ie||window.event)},Y=N;!Be.touchNative&&Be.pointer&&c.indexOf("touch")===0?N=se(s,c,N):Be.touch&&c==="dblclick"?N=Pt(s,N):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(g0[c]||c,N,Be.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(N=function(ie){ie=ie||window.event,y0(s,ie)&&Y(ie)},s.addEventListener(g0[c],N,!1)):s.addEventListener(c,Y,!1):s.attachEvent("on"+c,N),s[ia]=s[ia]||{},s[ia][T]=N}function v0(s,c,p,v,T){T=T||c+u(p)+(v?"_"+u(v):"");var N=s[ia]&&s[ia][T];if(!N)return this;!Be.touchNative&&Be.pointer&&c.indexOf("touch")===0?oe(s,c,N):Be.touch&&c==="dblclick"?fr(s,N):"removeEventListener"in s?s.removeEventListener(g0[c]||c,N,!1):s.detachEvent("on"+c,N),s[ia][T]=null}function Ui(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function _0(s){return x0(s,"wheel",Ui),this}function zo(s){return rt(s,"mousedown touchstart dblclick contextmenu",Ui),s._leaflet_disable_click=!0,this}function xr(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Hi(s){return xr(s),Ui(s),this}function Rm(s){if(s.composedPath)return s.composedPath();for(var c=[],p=s.target;p;)c.push(p),p=p.parentNode;return c}function Dm(s,c){if(!c)return new ee(s.clientX,s.clientY);var p=m0(c),v=p.boundingClientRect;return new ee((s.clientX-v.left)/p.x-c.clientLeft,(s.clientY-v.top)/p.y-c.clientTop)}var Lk=Be.linux&&Be.chrome?window.devicePixelRatio:Be.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Im(s){return Be.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Lk:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function y0(s,c){var p=c.relatedTarget;if(!p)return!0;try{for(;p&&p!==s;)p=p.parentNode}catch{return!1}return p!==s}var Pk={__proto__:null,on:rt,off:bt,stopPropagation:Ui,disableScrollPropagation:_0,disableClickPropagation:zo,preventDefault:xr,stop:Hi,getPropagationPath:Rm,getMousePosition:Dm,getWheelDelta:Im,isExternalTarget:y0,addListener:rt,removeListener:bt},Bm=Q.extend({run:function(s,c,p,v){this.stop(),this._el=s,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(v||.5,.2),this._startPos=zi(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=I(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,p=this._duration*1e3;c<p?this._runFrame(this._easeOut(c/p),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var p=this._startPos.add(this._offset.multiplyBy(s));c&&p._round(),Kt(this._el,p),this.fire("step")},_complete:function(){Z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),pt=Q.extend({options:{crs:ot,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=y(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(K(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=In&&Be.any3d&&!Be.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,ei,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,p){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(K(s),c,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=a({animate:p.animate},p.zoom),p.pan=a({animate:p.animate,duration:p.duration},p.pan));var v=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,p.zoom):this._tryAnimatedPan(s,p.pan);if(v)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,p.pan&&p.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,p){var v=this.getZoomScale(c),T=this.getSize().divideBy(2),N=s instanceof ee?s:this.latLngToContainerPoint(s),Y=N.subtract(T).multiplyBy(1-1/v),ie=this.containerPointToLatLng(T.add(Y));return this.setView(ie,c,{zoom:p})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():q(s);var p=ne(c.paddingTopLeft||c.padding||[0,0]),v=ne(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(s,!1,p.add(v));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:s.getCenter(),zoom:T};var N=v.subtract(p).divideBy(2),Y=this.project(s.getSouthWest(),T),ie=this.project(s.getNorthEast(),T),fe=this.unproject(Y.add(ie).divideBy(2).add(N),T);return{center:fe,zoom:T}},fitBounds:function(s,c){if(s=q(s),!s.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(s,c);return this.setView(p.center,p.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=ne(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Bm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){it(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,p,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,p){if(p=p||{},p.animate===!1||!Be.any3d)return this.setView(s,c,p);this._stop();var v=this.project(this.getCenter()),T=this.project(s),N=this.getSize(),Y=this._zoom;s=K(s),c=c===void 0?Y:c;var ie=Math.max(N.x,N.y),fe=ie*this.getZoomScale(Y,c),Ee=T.distanceTo(v)||1,De=1.42,qe=De*De;function st(Jt){var Hc=Jt?-1:1,_E=Jt?fe:ie,yE=fe*fe-ie*ie+Hc*qe*qe*Ee*Ee,wE=2*_E*qe*Ee,P0=yE/wE,_g=Math.sqrt(P0*P0+1)-P0,kE=_g<1e-9?-18:Math.log(_g);return kE}function Wr(Jt){return(Math.exp(Jt)-Math.exp(-Jt))/2}function dr(Jt){return(Math.exp(Jt)+Math.exp(-Jt))/2}function En(Jt){return Wr(Jt)/dr(Jt)}var en=st(0);function Rs(Jt){return ie*(dr(en)/dr(en+De*Jt))}function mE(Jt){return ie*(dr(en)*En(en+De*Jt)-Wr(en))/qe}function gE(Jt){return 1-Math.pow(1-Jt,1.5)}var xE=Date.now(),xg=(st(1)-en)/De,vE=p.duration?1e3*p.duration:1e3*xg*.8;function vg(){var Jt=(Date.now()-xE)/vE,Hc=gE(Jt)*xg;Jt<=1?(this._flyToFrame=I(vg,this),this._move(this.unproject(v.add(T.subtract(v).multiplyBy(mE(Hc)/Ee)),Y),this.getScaleZoom(ie/Rs(Hc),Y),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),vg.call(this),this},flyToBounds:function(s,c){var p=this._getBoundsCenterZoom(s,c);return this.flyTo(p.center,p.zoom,c)},setMaxBounds:function(s){return s=q(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var p=this.getCenter(),v=this._limitCenter(p,this._zoom,q(s));return p.equals(v)||this.panTo(v,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var p=ne(c.paddingTopLeft||c.padding||[0,0]),v=ne(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),N=this.project(s),Y=this.getPixelBounds(),ie=F([Y.min.add(p),Y.max.subtract(v)]),fe=ie.getSize();if(!ie.contains(N)){this._enforcingBounds=!0;var Ee=N.subtract(ie.getCenter()),De=ie.extend(N).getSize().subtract(fe);T.x+=Ee.x<0?-De.x:De.x,T.y+=Ee.y<0?-De.y:De.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=a({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),v=c.divideBy(2).round(),T=p.divideBy(2).round(),N=v.subtract(T);return!N.x&&!N.y?this:(s.animate&&s.pan?this.panBy(N):(s.pan&&this._rawPanBy(N),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=a({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),p=o(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,p,s):navigator.geolocation.getCurrentPosition(c,p,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,p=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,p=s.coords.longitude,v=new X(c,p),T=v.toBounds(s.coords.accuracy*2),N=this._locateOptions;if(N.setView){var Y=this.getBoundsZoom(T);this.setView(v,N.maxZoom?Math.min(Y,N.maxZoom):Y)}var ie={latlng:v,bounds:T,timestamp:s.timestamp};for(var fe in s.coords)typeof s.coords[fe]=="number"&&(ie[fe]=s.coords[fe]);this.fire("locationfound",ie)}},addHandler:function(s,c){if(!c)return this;var p=this[s]=new c(this);return this._handlers.push(p),this.options[s]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),It(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)It(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var p="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),v=tt("div",p,c||this._mapPane);return s&&(this._panes[s]=v),v},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),p=this.unproject(s.getTopRight());return new te(c,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,p){s=q(s),p=ne(p||[0,0]);var v=this.getZoom()||0,T=this.getMinZoom(),N=this.getMaxZoom(),Y=s.getNorthWest(),ie=s.getSouthEast(),fe=this.getSize().subtract(p),Ee=F(this.project(ie,v),this.project(Y,v)).getSize(),De=Be.any3d?this.options.zoomSnap:1,qe=fe.x/Ee.x,st=fe.y/Ee.y,Wr=c?Math.max(qe,st):Math.min(qe,st);return v=this.getScaleZoom(Wr,v),De&&(v=Math.round(v/(De/100))*(De/100),v=c?Math.ceil(v/De)*De:Math.floor(v/De)*De),Math.max(T,Math.min(N,v))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ee(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var p=this._getTopLeftPoint(s,c);return new ue(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var p=this.options.crs;return c=c===void 0?this._zoom:c,p.scale(s)/p.scale(c)},getScaleZoom:function(s,c){var p=this.options.crs;c=c===void 0?this._zoom:c;var v=p.zoom(s*p.scale(c));return isNaN(v)?1/0:v},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(K(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ne(s),c)},layerPointToLatLng:function(s){var c=ne(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(K(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(K(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(q(s))},distance:function(s,c){return this.options.crs.distance(K(s),K(c))},containerPointToLayerPoint:function(s){return ne(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ne(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(ne(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(K(s)))},mouseEventToContainerPoint:function(s){return Dm(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=aa(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Be.any3d,it(s,"leaflet-container"+(Be.touch?" leaflet-touch":"")+(Be.retina?" leaflet-retina":"")+(Be.ielt9?" leaflet-oldie":"")+(Be.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Ta(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Kt(this._mapPane,new ee(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(it(s.markerPane,"leaflet-zoom-hide"),it(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,p){Kt(this._mapPane,new ee(0,0));var v=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,p)._move(s,c)._moveEnd(T),this.fire("viewreset"),v&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,p,v){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),v?p&&p.pinch&&this.fire("zoom",p):((T||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Kt(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[u(this._container)]=this;var c=s?bt:rt;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Be.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Z(this._resizeRequest),this._resizeRequest=I(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var p=[],v,T=c==="mouseout"||c==="mouseover",N=s.target||s.srcElement,Y=!1;N;){if(v=this._targets[u(N)],v&&(c==="click"||c==="preclick")&&this._draggableMoved(v)){Y=!0;break}if(v&&v.listens(c,!0)&&(T&&!y0(N,s)||(p.push(v),T))||N===this._container)break;N=N.parentNode}return!p.length&&!Y&&!T&&this.listens(c,!0)&&(p=[this]),p},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var p=s.type;p==="mousedown"&&p0(c),this._fireDOMEvent(s,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,p){if(s.type==="click"){var v=a({},s);v.type="preclick",this._fireDOMEvent(v,v.type,p)}var T=this._findEventTargets(s,c);if(p){for(var N=[],Y=0;Y<p.length;Y++)p[Y].listens(c,!0)&&N.push(p[Y]);T=N.concat(T)}if(T.length){c==="contextmenu"&&xr(s);var ie=T[0],fe={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Ee=ie.getLatLng&&(!ie._radius||ie._radius<=10);fe.containerPoint=Ee?this.latLngToContainerPoint(ie.getLatLng()):this.mouseEventToContainerPoint(s),fe.layerPoint=this.containerPointToLayerPoint(fe.containerPoint),fe.latlng=Ee?ie.getLatLng():this.layerPointToLatLng(fe.layerPoint)}for(Y=0;Y<T.length;Y++)if(T[Y].fire(c,fe,!0),fe.originalEvent._stopped||T[Y].options.bubblingMouseEvents===!1&&A(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return zi(this._mapPane)||new ee(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var p=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var p=this.getSize()._divideBy(2);return this.project(s,c)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,p){var v=this._getNewPixelOrigin(p,c);return this.project(s,c)._subtract(v)},_latLngBoundsToNewLayerBounds:function(s,c,p){var v=this._getNewPixelOrigin(p,c);return F([this.project(s.getSouthWest(),c)._subtract(v),this.project(s.getNorthWest(),c)._subtract(v),this.project(s.getSouthEast(),c)._subtract(v),this.project(s.getNorthEast(),c)._subtract(v)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,p){if(!p)return s;var v=this.project(s,c),T=this.getSize().divideBy(2),N=new ue(v.subtract(T),v.add(T)),Y=this._getBoundsOffset(N,p,c);return Math.abs(Y.x)<=1&&Math.abs(Y.y)<=1?s:this.unproject(v.add(Y),c)},_limitOffset:function(s,c){if(!c)return s;var p=this.getPixelBounds(),v=new ue(p.min.add(s),p.max.add(s));return s.add(this._getBoundsOffset(v,c))},_getBoundsOffset:function(s,c,p){var v=F(this.project(c.getNorthEast(),p),this.project(c.getSouthWest(),p)),T=v.min.subtract(s.min),N=v.max.subtract(s.max),Y=this._rebound(T.x,-N.x),ie=this._rebound(T.y,-N.y);return new ee(Y,ie)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),p=this.getMaxZoom(),v=Be.any3d?this.options.zoomSnap:1;return v&&(s=Math.round(s/v)*v),Math.max(c,Math.min(p,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Zt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var p=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,c),!0)},_createAnimProxy:function(){var s=this._proxy=tt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var p=Sa,v=this._proxy.style[p];Bi(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),v===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){It(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();Bi(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var v=this.getZoomScale(c),T=this._getCenterOffset(s)._divideBy(1-1/v);return p.animate!==!0&&!this.getSize().contains(T)?!1:(I(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,p,v){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,it(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:v}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Zt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Fk(s,c){return new pt(s,c)}var Bn=ge.extend({options:{position:"topright"},initialize:function(s){y(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),p=this.getPosition(),v=s._controlCorners[p];return it(c,"leaflet-control"),p.indexOf("bottom")!==-1?v.insertBefore(c,v.firstChild):v.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(It(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Uo=function(s){return new Bn(s)};pt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",p=this._controlContainer=tt("div",c+"control-container",this._container);function v(T,N){var Y=c+T+" "+c+N;s[T+N]=tt("div",Y,p)}v("top","left"),v("top","right"),v("bottom","left"),v("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)It(this._controlCorners[s]);It(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var zm=Bn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,p,v){return p<v?-1:v<p?1:0}},initialize:function(s,c,p){y(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var v in s)this._addLayer(s[v],v);for(v in c)this._addLayer(c[v],v,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Bn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){it(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(it(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Zt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Zt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=tt("div",s),p=this.options.collapsed;c.setAttribute("aria-haspopup",!0),zo(c),_0(c);var v=this._section=tt("section",s+"-list");p&&(this._map.on("click",this.collapse,this),rt(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=tt("a",s+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),rt(T,{keydown:function(N){N.keyCode===13&&this._expandSafely()},click:function(N){xr(N),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=tt("div",s+"-base",v),this._separator=tt("div",s+"-separator",v),this._overlaysList=tt("div",s+"-overlays",v),c.appendChild(v)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,p){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:p}),this.options.sortLayers&&this._layers.sort(o(function(v,T){return this.options.sortFunction(v.layer,T.layer,v.name,T.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Cc(this._baseLayersList),Cc(this._overlaysList),this._layerControlInputs=[];var s,c,p,v,T=0;for(p=0;p<this._layers.length;p++)v=this._layers[p],this._addItem(v),c=c||v.overlay,s=s||!v.overlay,T+=v.overlay?0:1;return this.options.hideSingleBase&&(s=s&&T>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(u(s.target)),p=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;p&&this._map.fire(p,c)},_createRadioElement:function(s,c){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",v=document.createElement("div");return v.innerHTML=p,v.firstChild},_addItem:function(s){var c=document.createElement("label"),p=this._map.hasLayer(s.layer),v;s.overlay?(v=document.createElement("input"),v.type="checkbox",v.className="leaflet-control-layers-selector",v.defaultChecked=p):v=this._createRadioElement("leaflet-base-layers_"+u(this),p),this._layerControlInputs.push(v),v.layerId=u(s.layer),rt(v,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+s.name;var N=document.createElement("span");c.appendChild(N),N.appendChild(v),N.appendChild(T);var Y=s.overlay?this._overlaysList:this._baseLayersList;return Y.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,p,v=[],T=[];this._handlingClick=!0;for(var N=s.length-1;N>=0;N--)c=s[N],p=this._getLayer(c.layerId).layer,c.checked?v.push(p):c.checked||T.push(p);for(N=0;N<T.length;N++)this._map.hasLayer(T[N])&&this._map.removeLayer(T[N]);for(N=0;N<v.length;N++)this._map.hasLayer(v[N])||this._map.addLayer(v[N]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,p,v=this._map.getZoom(),T=s.length-1;T>=0;T--)c=s[T],p=this._getLayer(c.layerId).layer,c.disabled=p.options.minZoom!==void 0&&v<p.options.minZoom||p.options.maxZoom!==void 0&&v>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,rt(s,"click",xr),this.expand();var c=this;setTimeout(function(){bt(s,"click",xr),c._preventClick=!1})}}),Ok=function(s,c,p){return new zm(s,c,p)},w0=Bn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",p=tt("div",c+" leaflet-bar"),v=this.options;return this._zoomInButton=this._createButton(v.zoomInText,v.zoomInTitle,c+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(v.zoomOutText,v.zoomOutTitle,c+"-out",p,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,p,v,T){var N=tt("a",p,v);return N.innerHTML=s,N.href="#",N.title=c,N.setAttribute("role","button"),N.setAttribute("aria-label",c),zo(N),rt(N,"click",Hi),rt(N,"click",T,this),rt(N,"click",this._refocusOnMap,this),N},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";Zt(this._zoomInButton,c),Zt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(it(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(it(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});pt.mergeOptions({zoomControl:!0}),pt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new w0,this.addControl(this.zoomControl))});var Mk=function(s){return new w0(s)},Um=Bn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",p=tt("div",c),v=this.options;return this._addScales(v,c+"-line",p),s.on(v.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),p},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,p){s.metric&&(this._mScale=tt("div",c,p)),s.imperial&&(this._iScale=tt("div",c,p))},_update:function(){var s=this._map,c=s.getSize().y/2,p=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(p)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),p=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,p,c/s)},_updateImperial:function(s){var c=s*3.2808399,p,v,T;c>5280?(p=c/5280,v=this._getRoundNum(p),this._updateScale(this._iScale,v+" mi",v/p)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(s,c,p){s.style.width=Math.round(this.options.maxWidth*p)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),p=s/c;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,c*p}}),jk=function(s){return new Um(s)},Rk='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',k0=Bn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Be.inlineSvg?Rk+" ":"")+"Leaflet</a>"},initialize:function(s){y(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=tt("div","leaflet-control-attribution"),zo(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var p=[];this.options.prefix&&p.push(this.options.prefix),s.length&&p.push(s.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});pt.mergeOptions({attributionControl:!0}),pt.addInitHook(function(){this.options.attributionControl&&new k0().addTo(this)});var Dk=function(s){return new k0(s)};Bn.Layers=zm,Bn.Zoom=w0,Bn.Scale=Um,Bn.Attribution=k0,Uo.layers=Ok,Uo.zoom=Mk,Uo.scale=jk,Uo.attribution=Dk;var sa=ge.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});sa.addTo=function(s,c){return s.addHandler(c,this),this};var Ik={Events:de},Hm=Be.touch?"touchstart mousedown":"mousedown",ti=Q.extend({options:{clickTolerance:3},initialize:function(s,c,p,v){y(this,v),this._element=s,this._dragStartTarget=c||s,this._preventOutline=p},enable:function(){this._enabled||(rt(this._dragStartTarget,Hm,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ti._dragging===this&&this.finishDrag(!0),bt(this._dragStartTarget,Hm,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!l0(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){ti._dragging===this&&this.finishDrag();return}if(!(ti._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(ti._dragging=this,this._preventOutline&&p0(this._element),f0(),Do(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,p=Mm(this._element);this._startPoint=new ee(c.clientX,c.clientY),this._startPos=zi(this._element),this._parentScale=m0(p);var v=s.type==="mousedown";rt(document,v?"mousemove":"touchmove",this._onMove,this),rt(document,v?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,p=new ee(c.clientX,c.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,xr(s),this._moved||(this.fire("dragstart"),this._moved=!0,it(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),it(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Kt(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Zt(document.body,"leaflet-dragging"),this._lastTarget&&(Zt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),bt(document,"mousemove touchmove",this._onMove,this),bt(document,"mouseup touchend touchcancel",this._onUp,this),d0(),Io();var c=this._moved&&this._moving;this._moving=!1,ti._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Vm(s,c,p){var v,T=[1,4,2,8],N,Y,ie,fe,Ee,De,qe,st;for(N=0,De=s.length;N<De;N++)s[N]._code=Vi(s[N],c);for(ie=0;ie<4;ie++){for(qe=T[ie],v=[],N=0,De=s.length,Y=De-1;N<De;Y=N++)fe=s[N],Ee=s[Y],fe._code&qe?Ee._code&qe||(st=Pc(Ee,fe,qe,c,p),st._code=Vi(st,c),v.push(st)):(Ee._code&qe&&(st=Pc(Ee,fe,qe,c,p),st._code=Vi(st,c),v.push(st)),v.push(fe));s=v}return s}function Wm(s,c){var p,v,T,N,Y,ie,fe,Ee,De;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var qe=K([0,0]),st=q(s),Wr=st.getNorthWest().distanceTo(st.getSouthWest())*st.getNorthEast().distanceTo(st.getNorthWest());Wr<1700&&(qe=E0(s));var dr=s.length,En=[];for(p=0;p<dr;p++){var en=K(s[p]);En.push(c.project(K([en.lat-qe.lat,en.lng-qe.lng])))}for(ie=fe=Ee=0,p=0,v=dr-1;p<dr;v=p++)T=En[p],N=En[v],Y=T.y*N.x-N.y*T.x,fe+=(T.x+N.x)*Y,Ee+=(T.y+N.y)*Y,ie+=Y*3;ie===0?De=En[0]:De=[fe/ie,Ee/ie];var Rs=c.unproject(ne(De));return K([Rs.lat+qe.lat,Rs.lng+qe.lng])}function E0(s){for(var c=0,p=0,v=0,T=0;T<s.length;T++){var N=K(s[T]);c+=N.lat,p+=N.lng,v++}return K([c/v,p/v])}var Bk={__proto__:null,clipPolygon:Vm,polygonCenter:Wm,centroid:E0};function $m(s,c){if(!c||!s.length)return s.slice();var p=c*c;return s=Hk(s,p),s=Uk(s,p),s}function Gm(s,c,p){return Math.sqrt(Ho(s,c,p,!0))}function zk(s,c,p){return Ho(s,c,p)}function Uk(s,c){var p=s.length,v=typeof Uint8Array<"u"?Uint8Array:Array,T=new v(p);T[0]=T[p-1]=1,S0(s,T,c,0,p-1);var N,Y=[];for(N=0;N<p;N++)T[N]&&Y.push(s[N]);return Y}function S0(s,c,p,v,T){var N=0,Y,ie,fe;for(ie=v+1;ie<=T-1;ie++)fe=Ho(s[ie],s[v],s[T],!0),fe>N&&(Y=ie,N=fe);N>p&&(c[Y]=1,S0(s,c,p,v,Y),S0(s,c,p,Y,T))}function Hk(s,c){for(var p=[s[0]],v=1,T=0,N=s.length;v<N;v++)Vk(s[v],s[T])>c&&(p.push(s[v]),T=v);return T<N-1&&p.push(s[N-1]),p}var Zm;function qm(s,c,p,v,T){var N=v?Zm:Vi(s,p),Y=Vi(c,p),ie,fe,Ee;for(Zm=Y;;){if(!(N|Y))return[s,c];if(N&Y)return!1;ie=N||Y,fe=Pc(s,c,ie,p,T),Ee=Vi(fe,p),ie===N?(s=fe,N=Ee):(c=fe,Y=Ee)}}function Pc(s,c,p,v,T){var N=c.x-s.x,Y=c.y-s.y,ie=v.min,fe=v.max,Ee,De;return p&8?(Ee=s.x+N*(fe.y-s.y)/Y,De=fe.y):p&4?(Ee=s.x+N*(ie.y-s.y)/Y,De=ie.y):p&2?(Ee=fe.x,De=s.y+Y*(fe.x-s.x)/N):p&1&&(Ee=ie.x,De=s.y+Y*(ie.x-s.x)/N),new ee(Ee,De,T)}function Vi(s,c){var p=0;return s.x<c.min.x?p|=1:s.x>c.max.x&&(p|=2),s.y<c.min.y?p|=4:s.y>c.max.y&&(p|=8),p}function Vk(s,c){var p=c.x-s.x,v=c.y-s.y;return p*p+v*v}function Ho(s,c,p,v){var T=c.x,N=c.y,Y=p.x-T,ie=p.y-N,fe=Y*Y+ie*ie,Ee;return fe>0&&(Ee=((s.x-T)*Y+(s.y-N)*ie)/fe,Ee>1?(T=p.x,N=p.y):Ee>0&&(T+=Y*Ee,N+=ie*Ee)),Y=s.x-T,ie=s.y-N,v?Y*Y+ie*ie:new ee(T,N)}function kn(s){return!w(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Xm(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),kn(s)}function Ym(s,c){var p,v,T,N,Y,ie,fe,Ee;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var De=K([0,0]),qe=q(s),st=qe.getNorthWest().distanceTo(qe.getSouthWest())*qe.getNorthEast().distanceTo(qe.getNorthWest());st<1700&&(De=E0(s));var Wr=s.length,dr=[];for(p=0;p<Wr;p++){var En=K(s[p]);dr.push(c.project(K([En.lat-De.lat,En.lng-De.lng])))}for(p=0,v=0;p<Wr-1;p++)v+=dr[p].distanceTo(dr[p+1])/2;if(v===0)Ee=dr[0];else for(p=0,N=0;p<Wr-1;p++)if(Y=dr[p],ie=dr[p+1],T=Y.distanceTo(ie),N+=T,N>v){fe=(N-v)/T,Ee=[ie.x-fe*(ie.x-Y.x),ie.y-fe*(ie.y-Y.y)];break}var en=c.unproject(ne(Ee));return K([en.lat+De.lat,en.lng+De.lng])}var Wk={__proto__:null,simplify:$m,pointToSegmentDistance:Gm,closestPointOnSegment:zk,clipSegment:qm,_getEdgeIntersection:Pc,_getBitCode:Vi,_sqClosestPointOnSegment:Ho,isFlat:kn,_flat:Xm,polylineCenter:Ym},T0={project:function(s){return new ee(s.lng,s.lat)},unproject:function(s){return new X(s.y,s.x)},bounds:new ue([-180,-90],[180,90])},C0={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ue([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,p=this.R,v=s.lat*c,T=this.R_MINOR/p,N=Math.sqrt(1-T*T),Y=N*Math.sin(v),ie=Math.tan(Math.PI/4-v/2)/Math.pow((1-Y)/(1+Y),N/2);return v=-p*Math.log(Math.max(ie,1e-10)),new ee(s.lng*c*p,v)},unproject:function(s){for(var c=180/Math.PI,p=this.R,v=this.R_MINOR/p,T=Math.sqrt(1-v*v),N=Math.exp(-s.y/p),Y=Math.PI/2-2*Math.atan(N),ie=0,fe=.1,Ee;ie<15&&Math.abs(fe)>1e-7;ie++)Ee=T*Math.sin(Y),Ee=Math.pow((1-Ee)/(1+Ee),T/2),fe=Math.PI/2-2*Math.atan(N*Ee)-Y,Y+=fe;return new X(Y*c,s.x*c/p)}},$k={__proto__:null,LonLat:T0,Mercator:C0,SphericalMercator:ke},Gk=a({},Le,{code:"EPSG:3395",projection:C0,transformation:function(){var s=.5/(Math.PI*C0.R);return G(s,.5,-s,.5)}()}),Km=a({},Le,{code:"EPSG:4326",projection:T0,transformation:G(1/180,1,-1/180,.5)}),Zk=a({},ye,{projection:T0,transformation:G(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var p=c.lng-s.lng,v=c.lat-s.lat;return Math.sqrt(p*p+v*v)},infinite:!0});ye.Earth=Le,ye.EPSG3395=Gk,ye.EPSG3857=ot,ye.EPSG900913=me,ye.EPSG4326=Km,ye.Simple=Zk;var zn=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[u(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[u(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var p=this.getEvents();c.on(p,this),this.once("remove",function(){c.off(p,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});pt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=u(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return u(s)in this._layers},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},_addLayers:function(s){s=s?w(s)?s:[s]:[];for(var c=0,p=s.length;c<p;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[u(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=u(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,p=this._getZoomSpan();for(var v in this._zoomBoundLayers){var T=this._zoomBoundLayers[v].options;s=T.minZoom===void 0?s:Math.min(s,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ps=zn.extend({initialize:function(s,c){y(this,c),this._layers={};var p,v;if(s)for(p=0,v=s.length;p<v;p++)this.addLayer(s[p])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),p,v;for(p in this._layers)v=this._layers[p],v[s]&&v[s].apply(v,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return u(s)}}),qk=function(s,c){return new Ps(s,c)},Ca=Ps.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Ps.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Ps.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new te;for(var c in this._layers){var p=this._layers[c];s.extend(p.getBounds?p.getBounds():p.getLatLng())}return s}}),Xk=function(s,c){return new Ca(s,c)},Fs=ge.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){y(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var p=this._getIconUrl(s);if(!p){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var v=this._createImg(p,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(v,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v},_setIconStyles:function(s,c){var p=this.options,v=p[c+"Size"];typeof v=="number"&&(v=[v,v]);var T=ne(v),N=ne(c==="shadow"&&p.shadowAnchor||p.iconAnchor||T&&T.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(p.className||""),N&&(s.style.marginLeft=-N.x+"px",s.style.marginTop=-N.y+"px"),T&&(s.style.width=T.x+"px",s.style.height=T.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return Be.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Yk(s){return new Fs(s)}var Vo=Fs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Vo.imagePath!="string"&&(Vo.imagePath=this._detectIconPath()),(this.options.imagePath||Vo.imagePath)+Fs.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(p,v,T){var N=v.exec(p);return N&&N[T]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=tt("div","leaflet-default-icon-path",document.body),c=Ta(s,"background-image")||Ta(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Jm=sa.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new ti(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),it(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Zt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,p=c._map,v=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,N=zi(c._icon),Y=p.getPixelBounds(),ie=p.getPixelOrigin(),fe=F(Y.min._subtract(ie).add(T),Y.max._subtract(ie).subtract(T));if(!fe.contains(N)){var Ee=ne((Math.max(fe.max.x,N.x)-fe.max.x)/(Y.max.x-fe.max.x)-(Math.min(fe.min.x,N.x)-fe.min.x)/(Y.min.x-fe.min.x),(Math.max(fe.max.y,N.y)-fe.max.y)/(Y.max.y-fe.max.y)-(Math.min(fe.min.y,N.y)-fe.min.y)/(Y.min.y-fe.min.y)).multiplyBy(v);p.panBy(Ee,{animate:!1}),this._draggable._newPos._add(Ee),this._draggable._startPos._add(Ee),Kt(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=I(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(Z(this._panRequest),this._panRequest=I(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,p=c._shadow,v=zi(c._icon),T=c._map.layerPointToLatLng(v);p&&Kt(p,v),c._latlng=T,s.latlng=T,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){Z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Fc=zn.extend({options:{icon:new Vo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){y(this,c),this._latlng=K(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=K(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=s.icon.createIcon(this._icon),v=!1;p!==this._icon&&(this._icon&&this._removeIcon(),v=!0,s.title&&(p.title=s.title),p.tagName==="IMG"&&(p.alt=s.alt||"")),it(p,c),s.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(p,"focus",this._panOnFocus,this);var T=s.icon.createShadow(this._shadow),N=!1;T!==this._shadow&&(this._removeShadow(),N=!0),T&&(it(T,c),T.alt=""),this._shadow=T,s.opacity<1&&this._updateOpacity(),v&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&N&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&bt(this._icon,"focus",this._panOnFocus,this),It(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&It(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Kt(this._icon,s),this._shadow&&Kt(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(it(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Jm)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Jm(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&wn(this._icon,s),this._shadow&&wn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,p=c.iconSize?ne(c.iconSize):ne(0,0),v=c.iconAnchor?ne(c.iconAnchor):ne(0,0);s.panInside(this._latlng,{paddingTopLeft:v,paddingBottomRight:p.subtract(v)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Kk(s,c){return new Fc(s,c)}var ri=zn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return y(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Oc=ri.extend({options:{fill:!0,radius:10},initialize:function(s,c){y(this,c),this._latlng=K(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=K(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return ri.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,p=this._clickTolerance(),v=[s+p,c+p];this._pxBounds=new ue(this._point.subtract(v),this._point.add(v))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Jk(s,c){return new Oc(s,c)}var b0=Oc.extend({initialize:function(s,c,p){if(typeof c=="number"&&(c=a({},p,{radius:c})),y(this,c),this._latlng=K(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new te(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:ri.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,p=this._map,v=p.options.crs;if(v.distance===Le.distance){var T=Math.PI/180,N=this._mRadius/Le.R/T,Y=p.project([c+N,s]),ie=p.project([c-N,s]),fe=Y.add(ie).divideBy(2),Ee=p.unproject(fe).lat,De=Math.acos((Math.cos(N*T)-Math.sin(c*T)*Math.sin(Ee*T))/(Math.cos(c*T)*Math.cos(Ee*T)))/T;(isNaN(De)||De===0)&&(De=N/Math.cos(Math.PI/180*c)),this._point=fe.subtract(p.getPixelOrigin()),this._radius=isNaN(De)?0:fe.x-p.project([Ee,s-De]).x,this._radiusY=fe.y-Y.y}else{var qe=v.unproject(v.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(qe).x}this._updateBounds()}});function Qk(s,c,p){return new b0(s,c,p)}var ba=ri.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){y(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,p=null,v=Ho,T,N,Y=0,ie=this._parts.length;Y<ie;Y++)for(var fe=this._parts[Y],Ee=1,De=fe.length;Ee<De;Ee++){T=fe[Ee-1],N=fe[Ee];var qe=v(s,T,N,!0);qe<c&&(c=qe,p=v(s,T,N))}return p&&(p.distance=Math.sqrt(c)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ym(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=K(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new te,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return kn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],p=kn(s),v=0,T=s.length;v<T;v++)p?(c[v]=K(s[v]),this._bounds.extend(c[v])):c[v]=this._convertLatLngs(s[v]);return c},_project:function(){var s=new ue;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new ee(s,s);this._rawPxBounds&&(this._pxBounds=new ue([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,p){var v=s[0]instanceof X,T=s.length,N,Y;if(v){for(Y=[],N=0;N<T;N++)Y[N]=this._map.latLngToLayerPoint(s[N]),p.extend(Y[N]);c.push(Y)}else for(N=0;N<T;N++)this._projectLatlngs(s[N],c,p)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,p,v,T,N,Y,ie,fe;for(p=0,T=0,N=this._rings.length;p<N;p++)for(fe=this._rings[p],v=0,Y=fe.length;v<Y-1;v++)ie=qm(fe[v],fe[v+1],s,v,!0),ie&&(c[T]=c[T]||[],c[T].push(ie[0]),(ie[1]!==fe[v+1]||v===Y-2)&&(c[T].push(ie[1]),T++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,p=0,v=s.length;p<v;p++)s[p]=$m(s[p],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var p,v,T,N,Y,ie,fe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(p=0,N=this._parts.length;p<N;p++)for(ie=this._parts[p],v=0,Y=ie.length,T=Y-1;v<Y;T=v++)if(!(!c&&v===0)&&Gm(s,ie[T],ie[v])<=fe)return!0;return!1}});function eE(s,c){return new ba(s,c)}ba._flat=Xm;var Os=ba.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Wm(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=ba.prototype._convertLatLngs.call(this,s),p=c.length;return p>=2&&c[0]instanceof X&&c[0].equals(c[p-1])&&c.pop(),c},_setLatLngs:function(s){ba.prototype._setLatLngs.call(this,s),kn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return kn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,p=new ee(c,c);if(s=new ue(s.min.subtract(p),s.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var v=0,T=this._rings.length,N;v<T;v++)N=Vm(this._rings[v],s,!0),N.length&&this._parts.push(N)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,p,v,T,N,Y,ie,fe,Ee;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(N=0,fe=this._parts.length;N<fe;N++)for(p=this._parts[N],Y=0,Ee=p.length,ie=Ee-1;Y<Ee;ie=Y++)v=p[Y],T=p[ie],v.y>s.y!=T.y>s.y&&s.x<(T.x-v.x)*(s.y-v.y)/(T.y-v.y)+v.x&&(c=!c);return c||ba.prototype._containsPoint.call(this,s,!0)}});function tE(s,c){return new Os(s,c)}var Na=Ca.extend({initialize:function(s,c){y(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=w(s)?s:s.features,p,v,T;if(c){for(p=0,v=c.length;p<v;p++)T=c[p],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var N=this.options;if(N.filter&&!N.filter(s))return this;var Y=Mc(s,N);return Y?(Y.feature=Dc(s),Y.defaultOptions=Y.options,this.resetStyle(Y),N.onEachFeature&&N.onEachFeature(s,Y),this.addLayer(Y)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=a({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function Mc(s,c){var p=s.type==="Feature"?s.geometry:s,v=p?p.coordinates:null,T=[],N=c&&c.pointToLayer,Y=c&&c.coordsToLatLng||N0,ie,fe,Ee,De;if(!v&&!p)return null;switch(p.type){case"Point":return ie=Y(v),Qm(N,s,ie,c);case"MultiPoint":for(Ee=0,De=v.length;Ee<De;Ee++)ie=Y(v[Ee]),T.push(Qm(N,s,ie,c));return new Ca(T);case"LineString":case"MultiLineString":return fe=jc(v,p.type==="LineString"?0:1,Y),new ba(fe,c);case"Polygon":case"MultiPolygon":return fe=jc(v,p.type==="Polygon"?1:2,Y),new Os(fe,c);case"GeometryCollection":for(Ee=0,De=p.geometries.length;Ee<De;Ee++){var qe=Mc({geometry:p.geometries[Ee],type:"Feature",properties:s.properties},c);qe&&T.push(qe)}return new Ca(T);case"FeatureCollection":for(Ee=0,De=p.features.length;Ee<De;Ee++){var st=Mc(p.features[Ee],c);st&&T.push(st)}return new Ca(T);default:throw new Error("Invalid GeoJSON object.")}}function Qm(s,c,p,v){return s?s(c,p):new Fc(p,v&&v.markersInheritOptions&&v)}function N0(s){return new X(s[1],s[0],s[2])}function jc(s,c,p){for(var v=[],T=0,N=s.length,Y;T<N;T++)Y=c?jc(s[T],c-1,p):(p||N0)(s[T]),v.push(Y);return v}function A0(s,c){return s=K(s),s.alt!==void 0?[g(s.lng,c),g(s.lat,c),g(s.alt,c)]:[g(s.lng,c),g(s.lat,c)]}function Rc(s,c,p,v){for(var T=[],N=0,Y=s.length;N<Y;N++)T.push(c?Rc(s[N],kn(s[N])?0:c-1,p,v):A0(s[N],v));return!c&&p&&T.length>0&&T.push(T[0].slice()),T}function Ms(s,c){return s.feature?a({},s.feature,{geometry:c}):Dc(c)}function Dc(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var L0={toGeoJSON:function(s){return Ms(this,{type:"Point",coordinates:A0(this.getLatLng(),s)})}};Fc.include(L0),b0.include(L0),Oc.include(L0),ba.include({toGeoJSON:function(s){var c=!kn(this._latlngs),p=Rc(this._latlngs,c?1:0,!1,s);return Ms(this,{type:(c?"Multi":"")+"LineString",coordinates:p})}}),Os.include({toGeoJSON:function(s){var c=!kn(this._latlngs),p=c&&!kn(this._latlngs[0]),v=Rc(this._latlngs,p?2:c?1:0,!0,s);return c||(v=[v]),Ms(this,{type:(p?"Multi":"")+"Polygon",coordinates:v})}}),Ps.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(p){c.push(p.toGeoJSON(s).geometry.coordinates)}),Ms(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var p=c==="GeometryCollection",v=[];return this.eachLayer(function(T){if(T.toGeoJSON){var N=T.toGeoJSON(s);if(p)v.push(N.geometry);else{var Y=Dc(N);Y.type==="FeatureCollection"?v.push.apply(v,Y.features):v.push(Y)}}}),p?Ms(this,{geometries:v,type:"GeometryCollection"}):{type:"FeatureCollection",features:v}}});function eg(s,c){return new Na(s,c)}var rE=eg,Ic=zn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,p){this._url=s,this._bounds=q(c),y(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(it(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){It(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&As(this._image),this},bringToBack:function(){return this._map&&Ls(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=q(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:tt("img");if(it(c,"leaflet-image-layer"),this._zoomAnimated&&it(c,"leaflet-zoom-animated"),this.options.className&&it(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;Bi(this._image,p,c)},_reset:function(){var s=this._image,c=new ue(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=c.getSize();Kt(s,c.min),s.style.width=p.x+"px",s.style.height=p.y+"px"},_updateOpacity:function(){wn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),nE=function(s,c,p){return new Ic(s,c,p)},tg=Ic.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:tt("video");if(it(c,"leaflet-image-layer"),this._zoomAnimated&&it(c,"leaflet-zoom-animated"),this.options.className&&it(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),s){for(var p=c.getElementsByTagName("source"),v=[],T=0;T<p.length;T++)v.push(p[T].src);this._url=p.length>0?v:[c.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var N=0;N<this._url.length;N++){var Y=tt("source");Y.src=this._url[N],c.appendChild(Y)}}});function aE(s,c,p){return new tg(s,c,p)}var rg=Ic.extend({_initImage:function(){var s=this._image=this._url;it(s,"leaflet-image-layer"),this._zoomAnimated&&it(s,"leaflet-zoom-animated"),this.options.className&&it(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function iE(s,c,p){return new rg(s,c,p)}var oa=zn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof X||w(s))?(this._latlng=K(s),y(this,c)):(y(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&wn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&wn(this._container,1),this.bringToFront(),this.options.interactive&&(it(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(wn(this._container,0),this._removeTimeout=setTimeout(o(It,void 0,this._container),200)):It(this._container),this.options.interactive&&(Zt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=K(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&As(this._container),this},bringToBack:function(){return this._map&&Ls(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof Ca){c=null;var p=this._source._layers;for(var v in p)if(p[v]._map){c=p[v];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=ne(this.options.offset),p=this._getAnchor();this._zoomAnimated?Kt(this._container,s.add(p)):c=c.add(s).add(p);var v=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=v+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});pt.include({_initOverlay:function(s,c,p,v){var T=c;return T instanceof s||(T=new s(v).setContent(c)),p&&T.setLatLng(p),T}}),zn.include({_initOverlay:function(s,c,p,v){var T=p;return T instanceof s?(y(T,v),T._source=this):(T=c&&!v?c:new s(v,this),T.setContent(p)),T}});var Bc=oa.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,oa.prototype.openOn.call(this,s)},onAdd:function(s){oa.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ri||this._source.on("preclick",Ui))},onRemove:function(s){oa.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ri||this._source.off("preclick",Ui))},getEvents:function(){var s=oa.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=tt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=tt("div",s+"-content-wrapper",c);if(this._contentNode=tt("div",s+"-content",p),zo(c),_0(this._contentNode),rt(c,"contextmenu",Ui),this._tipContainer=tt("div",s+"-tip-container",c),this._tip=tt("div",s+"-tip",this._tipContainer),this.options.closeButton){var v=this._closeButton=tt("a",s+"-close-button",c);v.setAttribute("role","button"),v.setAttribute("aria-label","Close popup"),v.href="#close",v.innerHTML='<span aria-hidden="true">&#215;</span>',rt(v,"click",function(T){xr(T),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var p=s.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),c.width=p+1+"px",c.whiteSpace="",c.height="";var v=s.offsetHeight,T=this.options.maxHeight,N="leaflet-popup-scrolled";T&&v>T?(c.height=T+"px",it(s,N)):Zt(s,N),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),p=this._getAnchor();Kt(this._container,c.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(Ta(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+c,v=this._containerWidth,T=new ee(this._containerLeft,-p-this._containerBottom);T._add(zi(this._container));var N=s.layerPointToContainerPoint(T),Y=ne(this.options.autoPanPadding),ie=ne(this.options.autoPanPaddingTopLeft||Y),fe=ne(this.options.autoPanPaddingBottomRight||Y),Ee=s.getSize(),De=0,qe=0;N.x+v+fe.x>Ee.x&&(De=N.x+v-Ee.x+fe.x),N.x-De-ie.x<0&&(De=N.x-ie.x),N.y+p+fe.y>Ee.y&&(qe=N.y+p-Ee.y+fe.y),N.y-qe-ie.y<0&&(qe=N.y-ie.y),(De||qe)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([De,qe]))}},_getAnchor:function(){return ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),sE=function(s,c){return new Bc(s,c)};pt.mergeOptions({closePopupOnClick:!0}),pt.include({openPopup:function(s,c,p){return this._initOverlay(Bc,s,c,p).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),zn.include({bindPopup:function(s,c){return this._popup=this._initOverlay(Bc,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Ca||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Hi(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof ri)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var zc=oa.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){oa.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){oa.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=oa.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=tt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,p,v=this._map,T=this._container,N=v.latLngToContainerPoint(v.getCenter()),Y=v.layerPointToContainerPoint(s),ie=this.options.direction,fe=T.offsetWidth,Ee=T.offsetHeight,De=ne(this.options.offset),qe=this._getAnchor();ie==="top"?(c=fe/2,p=Ee):ie==="bottom"?(c=fe/2,p=0):ie==="center"?(c=fe/2,p=Ee/2):ie==="right"?(c=0,p=Ee/2):ie==="left"?(c=fe,p=Ee/2):Y.x<N.x?(ie="right",c=0,p=Ee/2):(ie="left",c=fe+(De.x+qe.x)*2,p=Ee/2),s=s.subtract(ne(c,p,!0)).add(De).add(qe),Zt(T,"leaflet-tooltip-right"),Zt(T,"leaflet-tooltip-left"),Zt(T,"leaflet-tooltip-top"),Zt(T,"leaflet-tooltip-bottom"),it(T,"leaflet-tooltip-"+ie),Kt(T,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&wn(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),oE=function(s,c){return new zc(s,c)};pt.include({openTooltip:function(s,c,p){return this._initOverlay(zc,s,c,p).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),zn.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(zc,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[c](p),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Ca||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(rt(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),rt(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,p,v;this._tooltip.options.sticky&&s.originalEvent&&(p=this._map.mouseEventToContainerPoint(s.originalEvent),v=this._map.containerPointToLayerPoint(p),c=this._map.layerPointToLatLng(v)),this._tooltip.setLatLng(c)}});var ng=Fs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),p=this.options;if(p.html instanceof Element?(Cc(c),c.appendChild(p.html)):c.innerHTML=p.html!==!1?p.html:"",p.bgPos){var v=ne(p.bgPos);c.style.backgroundPosition=-v.x+"px "+-v.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function lE(s){return new ng(s)}Fs.Default=Vo;var Wo=zn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Be.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){y(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),It(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(As(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ls(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof ee?s:new ee(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,p=-s(-1/0,1/0),v=0,T=c.length,N;v<T;v++)N=c[v].style.zIndex,c[v]!==this._container&&N&&(p=s(p,+N));isFinite(p)&&(this.options.zIndex=p+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Be.ielt9){wn(this._container,this.options.opacity);var s=+new Date,c=!1,p=!1;for(var v in this._tiles){var T=this._tiles[v];if(!(!T.current||!T.loaded)){var N=Math.min(1,(s-T.loaded)/200);wn(T.el,N),N<1?c=!0:(T.active?p=!0:this._onOpaqueTile(T),T.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),c&&(Z(this._fadeFrame),this._fadeFrame=I(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=tt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===s?(this._levels[p].el.style.zIndex=c-Math.abs(s-p),this._onUpdateLevel(p)):(It(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var v=this._levels[s],T=this._map;return v||(v=this._levels[s]={},v.el=tt("div","leaflet-tile-container leaflet-zoom-animated",this._container),v.el.style.zIndex=c,v.origin=T.project(T.unproject(T.getPixelOrigin()),s).round(),v.zoom=s,this._setZoomTransform(v,T.getCenter(),T.getZoom()),m(v.el.offsetWidth),this._onCreateLevel(v)),this._level=v,v}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,c,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var v=c.coords;this._retainParent(v.x,v.y,v.z,v.z-5)||this._retainChildren(v.x,v.y,v.z,v.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)It(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,p,v){var T=Math.floor(s/2),N=Math.floor(c/2),Y=p-1,ie=new ee(+T,+N);ie.z=+Y;var fe=this._tileCoordsToKey(ie),Ee=this._tiles[fe];return Ee&&Ee.active?(Ee.retain=!0,!0):(Ee&&Ee.loaded&&(Ee.retain=!0),Y>v?this._retainParent(T,N,Y,v):!1)},_retainChildren:function(s,c,p,v){for(var T=2*s;T<2*s+2;T++)for(var N=2*c;N<2*c+2;N++){var Y=new ee(T,N);Y.z=p+1;var ie=this._tileCoordsToKey(Y),fe=this._tiles[ie];if(fe&&fe.active){fe.retain=!0;continue}else fe&&fe.loaded&&(fe.retain=!0);p+1<v&&this._retainChildren(T,N,p+1,v)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,p,v){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var N=this.options.updateWhenZooming&&T!==this._tileZoom;(!v||N)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(s),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var p in this._levels)this._setZoomTransform(this._levels[p],s,c)},_setZoomTransform:function(s,c,p){var v=this._map.getZoomScale(p,s.zoom),T=s.origin.multiplyBy(v).subtract(this._map._getNewPixelOrigin(c,p)).round();Be.any3d?Bi(s.el,T,v):Kt(s.el,T)},_resetGrid:function(){var s=this._map,c=s.options.crs,p=this._tileSize=this.getTileSize(),v=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],v).x/p.x),Math.ceil(s.project([0,c.wrapLng[1]],v).x/p.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],v).y/p.x),Math.ceil(s.project([c.wrapLat[1],0],v).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,p=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),v=c.getZoomScale(p,this._tileZoom),T=c.project(s,this._tileZoom).floor(),N=c.getSize().divideBy(v*2);return new ue(T.subtract(N),T.add(N))},_update:function(s){var c=this._map;if(c){var p=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var v=this._getTiledPixelBounds(s),T=this._pxBoundsToTileRange(v),N=T.getCenter(),Y=[],ie=this.options.keepBuffer,fe=new ue(T.getBottomLeft().subtract([ie,-ie]),T.getTopRight().add([ie,-ie]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ee in this._tiles){var De=this._tiles[Ee].coords;(De.z!==this._tileZoom||!fe.contains(new ee(De.x,De.y)))&&(this._tiles[Ee].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(s,p);return}for(var qe=T.min.y;qe<=T.max.y;qe++)for(var st=T.min.x;st<=T.max.x;st++){var Wr=new ee(st,qe);if(Wr.z=this._tileZoom,!!this._isValidTile(Wr)){var dr=this._tiles[this._tileCoordsToKey(Wr)];dr?dr.current=!0:Y.push(Wr)}}if(Y.sort(function(en,Rs){return en.distanceTo(N)-Rs.distanceTo(N)}),Y.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var En=document.createDocumentFragment();for(st=0;st<Y.length;st++)this._addTile(Y[st],En);this._level.el.appendChild(En)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var p=this._globalTileRange;if(!c.wrapLng&&(s.x<p.min.x||s.x>p.max.x)||!c.wrapLat&&(s.y<p.min.y||s.y>p.max.y))return!1}if(!this.options.bounds)return!0;var v=this._tileCoordsToBounds(s);return q(this.options.bounds).overlaps(v)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,p=this.getTileSize(),v=s.scaleBy(p),T=v.add(p),N=c.unproject(v,s.z),Y=c.unproject(T,s.z);return[N,Y]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),p=new te(c[0],c[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),p=new ee(+c[0],+c[1]);return p.z=+c[2],p},_removeTile:function(s){var c=this._tiles[s];c&&(It(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){it(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=m,s.onmousemove=m,Be.ielt9&&this.options.opacity<1&&wn(s,this.options.opacity)},_addTile:function(s,c){var p=this._getTilePos(s),v=this._tileCoordsToKey(s),T=this.createTile(this._wrapCoords(s),o(this._tileReady,this,s));this._initTile(T),this.createTile.length<2&&I(o(this._tileReady,this,s,null,T)),Kt(T,p),this._tiles[v]={el:T,coords:s,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:s})},_tileReady:function(s,c,p){c&&this.fire("tileerror",{error:c,tile:p,coords:s});var v=this._tileCoordsToKey(s);p=this._tiles[v],p&&(p.loaded=+new Date,this._map._fadeAnimated?(wn(p.el,0),Z(this._fadeFrame),this._fadeFrame=I(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),c||(it(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Be.ielt9||!this._map._fadeAnimated?I(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new ee(this._wrapX?h(s.x,this._wrapX):s.x,this._wrapY?h(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new ue(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function cE(s){return new Wo(s)}var js=Wo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=y(this,c),c.detectRetina&&Be.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var p=document.createElement("img");return rt(p,"load",o(this._tileOnLoad,this,c,p)),rt(p,"error",o(this._tileOnError,this,c,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(s),p},getTileUrl:function(s){var c={r:Be.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=p),c["-y"]=p}return S(this._url,a(c,this.options))},_tileOnLoad:function(s,c){Be.ielt9?setTimeout(o(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,p){var v=this.options.errorTileUrl;v&&c.getAttribute("src")!==v&&(c.src=v),s(p,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,p=this.options.zoomReverse,v=this.options.zoomOffset;return p&&(s=c-s),s+v},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=m,c.onerror=m,!c.complete)){c.src=D;var p=this._tiles[s].coords;It(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:p})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",D),Wo.prototype._removeTile.call(this,s)},_tileReady:function(s,c,p){if(!(!this._map||p&&p.getAttribute("src")===D))return Wo.prototype._tileReady.call(this,s,c,p)}});function ag(s,c){return new js(s,c)}var ig=js.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var p=a({},this.defaultWmsParams);for(var v in c)v in this.options||(p[v]=c[v]);c=y(this,c);var T=c.detectRetina&&Be.retina?2:1,N=this.getTileSize();p.width=N.x*T,p.height=N.y*T,this.wmsParams=p},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,js.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),p=this._crs,v=F(p.project(c[0]),p.project(c[1])),T=v.min,N=v.max,Y=(this._wmsVersion>=1.3&&this._crs===Km?[T.y,T.x,N.y,N.x]:[T.x,T.y,N.x,N.y]).join(","),ie=js.prototype.getTileUrl.call(this,s);return ie+E(this.wmsParams,ie,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Y},setParams:function(s,c){return a(this.wmsParams,s),c||this.redraw(),this}});function uE(s,c){return new ig(s,c)}js.WMS=ig,ag.wms=uE;var Aa=zn.extend({options:{padding:.1},initialize:function(s){y(this,s),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),it(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var p=this._map.getZoomScale(c,this._zoom),v=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),N=v.multiplyBy(-p).add(T).subtract(this._map._getNewPixelOrigin(s,c));Be.any3d?Bi(this._container,N,p):Kt(this._container,N)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),p=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new ue(p,p.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),sg=Aa.extend({options:{tolerance:0},getEvents:function(){var s=Aa.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Aa.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");rt(s,"mousemove",this._onMouseMove,this),rt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){Z(this._redrawRequest),delete this._ctx,It(this._container),bt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Aa.prototype._update.call(this);var s=this._bounds,c=this._container,p=s.getSize(),v=Be.retina?2:1;Kt(c,s.min),c.width=v*p.x,c.height=v*p.y,c.style.width=p.x+"px",c.style.height=p.y+"px",Be.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Aa.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[u(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,p=c.next,v=c.prev;p?p.prev=v:this._drawLast=v,v?v.next=p:this._drawFirst=p,delete s._order,delete this._layers[u(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),p=[],v,T;for(T=0;T<c.length;T++){if(v=Number(c[T]),isNaN(v))return;p.push(v)}s.options._dashArray=p}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||I(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ue,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var p=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var v=this._drawFirst;v;v=v.next)s=v.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var p,v,T,N,Y=s._parts,ie=Y.length,fe=this._ctx;if(ie){for(fe.beginPath(),p=0;p<ie;p++){for(v=0,T=Y[p].length;v<T;v++)N=Y[p][v],fe[v?"lineTo":"moveTo"](N.x,N.y);c&&fe.closePath()}this._fillStroke(fe,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,p=this._ctx,v=Math.max(Math.round(s._radius),1),T=(Math.max(Math.round(s._radiusY),1)||v)/v;T!==1&&(p.save(),p.scale(1,T)),p.beginPath(),p.arc(c.x,c.y/T,v,0,Math.PI*2,!1),T!==1&&p.restore(),this._fillStroke(p,s)}},_fillStroke:function(s,c){var p=c.options;p.fill&&(s.globalAlpha=p.fillOpacity,s.fillStyle=p.fillColor||p.color,s.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=p.opacity,s.lineWidth=p.weight,s.strokeStyle=p.color,s.lineCap=p.lineCap,s.lineJoin=p.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),p,v,T=this._drawFirst;T;T=T.next)p=T.layer,p.options.interactive&&p._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(p))&&(v=p);this._fireEvent(v?[v]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(Zt(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var p,v,T=this._drawFirst;T;T=T.next)p=T.layer,p.options.interactive&&p._containsPoint(c)&&(v=p);v!==this._hoveredLayer&&(this._handleMouseOut(s),v&&(it(this._container,"leaflet-interactive"),this._fireEvent([v],s,"mouseover"),this._hoveredLayer=v)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,p){this._map._fireDOMEvent(c,p||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var p=c.next,v=c.prev;if(p)p.prev=v;else return;v?v.next=p:p&&(this._drawFirst=p),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var p=c.next,v=c.prev;if(v)v.next=p;else return;p?p.prev=v:v&&(this._drawLast=v),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function og(s){return Be.canvas?new sg(s):null}var $o=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),fE={_initContainer:function(){this._container=tt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Aa.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=$o("shape");it(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=$o("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;It(c),s.removeInteractiveTarget(c),delete this._layers[u(s)]},_updateStyle:function(s){var c=s._stroke,p=s._fill,v=s.options,T=s._container;T.stroked=!!v.stroke,T.filled=!!v.fill,v.stroke?(c||(c=s._stroke=$o("stroke")),T.appendChild(c),c.weight=v.weight+"px",c.color=v.color,c.opacity=v.opacity,v.dashArray?c.dashStyle=w(v.dashArray)?v.dashArray.join(" "):v.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=v.lineCap.replace("butt","flat"),c.joinstyle=v.lineJoin):c&&(T.removeChild(c),s._stroke=null),v.fill?(p||(p=s._fill=$o("fill")),T.appendChild(p),p.color=v.fillColor||v.color,p.opacity=v.fillOpacity):p&&(T.removeChild(p),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),p=Math.round(s._radius),v=Math.round(s._radiusY||p);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+p+","+v+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){As(s._container)},_bringToBack:function(s){Ls(s._container)}},Uc=Be.vml?$o:Te,Go=Aa.extend({_initContainer:function(){this._container=Uc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Uc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){It(this._container),bt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Aa.prototype._update.call(this);var s=this._bounds,c=s.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,p.setAttribute("width",c.x),p.setAttribute("height",c.y)),Kt(p,s.min),p.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=Uc("path");s.options.className&&it(c,s.options.className),s.options.interactive&&it(c,"leaflet-interactive"),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){It(s._path),s.removeInteractiveTarget(s._path),delete this._layers[u(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,p=s.options;c&&(p.stroke?(c.setAttribute("stroke",p.color),c.setAttribute("stroke-opacity",p.opacity),c.setAttribute("stroke-width",p.weight),c.setAttribute("stroke-linecap",p.lineCap),c.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?c.setAttribute("stroke-dasharray",p.dashArray):c.removeAttribute("stroke-dasharray"),p.dashOffset?c.setAttribute("stroke-dashoffset",p.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),p.fill?(c.setAttribute("fill",p.fillColor||p.color),c.setAttribute("fill-opacity",p.fillOpacity),c.setAttribute("fill-rule",p.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,Pe(s._parts,c))},_updateCircle:function(s){var c=s._point,p=Math.max(Math.round(s._radius),1),v=Math.max(Math.round(s._radiusY),1)||p,T="a"+p+","+v+" 0 1,0 ",N=s._empty()?"M0 0":"M"+(c.x-p)+","+c.y+T+p*2+",0 "+T+-p*2+",0 ";this._setPath(s,N)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){As(s._path)},_bringToBack:function(s){Ls(s._path)}});Be.vml&&Go.include(fE);function lg(s){return Be.svg||Be.vml?new Go(s):null}pt.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&og(s)||lg(s)}});var cg=Os.extend({initialize:function(s,c){Os.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=q(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function dE(s,c){return new cg(s,c)}Go.create=Uc,Go.pointsToPath=Pe,Na.geometryToLayer=Mc,Na.coordsToLatLng=N0,Na.coordsToLatLngs=jc,Na.latLngToCoords=A0,Na.latLngsToCoords=Rc,Na.getFeature=Ms,Na.asFeature=Dc,pt.mergeOptions({boxZoom:!0});var ug=sa.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){bt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){It(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Do(),f0(),this._startPoint=this._map.mouseEventToContainerPoint(s),rt(document,{contextmenu:Hi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=tt("div","leaflet-zoom-box",this._container),it(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new ue(this._point,this._startPoint),p=c.getSize();Kt(this._box,c.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(It(this._box),Zt(this._container,"leaflet-crosshair")),Io(),d0(),bt(document,{contextmenu:Hi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new te(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});pt.addInitHook("addHandler","boxZoom",ug),pt.mergeOptions({doubleClickZoom:!0});var fg=sa.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,p=c.getZoom(),v=c.options.zoomDelta,T=s.originalEvent.shiftKey?p-v:p+v;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(s.containerPoint,T)}});pt.addInitHook("addHandler","doubleClickZoom",fg),pt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var dg=sa.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new ti(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}it(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Zt(this._map._container,"leaflet-grab"),Zt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=q(this._map.options.maxBounds);this._offsetLimit=F(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),p=this._initialWorldOffset,v=this._draggable._newPos.x,T=(v-c+p)%s+c-p,N=(v+c+p)%s-c-p,Y=Math.abs(T+p)<Math.abs(N+p)?T:N;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Y},_onDragEnd:function(s){var c=this._map,p=c.options,v=!p.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),v)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),N=(this._lastTime-this._times[0])/1e3,Y=p.easeLinearity,ie=T.multiplyBy(Y/N),fe=ie.distanceTo([0,0]),Ee=Math.min(p.inertiaMaxSpeed,fe),De=ie.multiplyBy(Ee/fe),qe=Ee/(p.inertiaDeceleration*Y),st=De.multiplyBy(-qe/2).round();!st.x&&!st.y?c.fire("moveend"):(st=c._limitOffset(st,c.options.maxBounds),I(function(){c.panBy(st,{duration:qe,easeLinearity:Y,noMoveStart:!0,animate:!0})}))}}});pt.addInitHook("addHandler","dragging",dg),pt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var hg=sa.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),rt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),bt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,p=s.scrollTop||c.scrollTop,v=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(v,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},p=this.keyCodes,v,T;for(v=0,T=p.left.length;v<T;v++)c[p.left[v]]=[-1*s,0];for(v=0,T=p.right.length;v<T;v++)c[p.right[v]]=[s,0];for(v=0,T=p.down.length;v<T;v++)c[p.down[v]]=[0,s];for(v=0,T=p.up.length;v<T;v++)c[p.up[v]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},p=this.keyCodes,v,T;for(v=0,T=p.zoomIn.length;v<T;v++)c[p.zoomIn[v]]=s;for(v=0,T=p.zoomOut.length;v<T;v++)c[p.zoomOut[v]]=-s},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){bt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,p=this._map,v;if(c in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(v=this._panKeys[c],s.shiftKey&&(v=ne(v).multiplyBy(3)),p.options.maxBounds&&(v=p._limitOffset(ne(v),p.options.maxBounds)),p.options.worldCopyJump){var T=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(v)));p.panTo(T)}else p.panBy(v)}else if(c in this._zoomKeys)p.setZoom(p.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Hi(s)}}});pt.addInitHook("addHandler","keyboard",hg),pt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var pg=sa.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){bt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=Im(s),p=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var v=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),v),Hi(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),p=this._map.options.zoomSnap||0;s._stop();var v=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(v))))/Math.LN2,N=p?Math.ceil(T/p)*p:T,Y=s._limitZoom(c+(this._delta>0?N:-N))-c;this._delta=0,this._startTime=null,Y&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+Y):s.setZoomAround(this._lastMousePos,c+Y))}});pt.addInitHook("addHandler","scrollWheelZoom",pg);var hE=600;pt.mergeOptions({tapHold:Be.touchNative&&Be.safari&&Be.mobile,tapTolerance:15});var mg=sa.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){bt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new ee(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",xr),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),hE),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){bt(document,"touchend",xr),bt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),bt(document,"touchend touchcancel contextmenu",this._cancel,this),bt(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new ee(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var p=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});p._simulated=!0,c.target.dispatchEvent(p)}});pt.addInitHook("addHandler","tapHold",mg),pt.mergeOptions({touchZoom:Be.touch,bounceAtZoomLimits:!0});var gg=sa.extend({addHooks:function(){it(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Zt(this._map._container,"leaflet-touch-zoom"),bt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var p=c.mouseEventToContainerPoint(s.touches[0]),v=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(p.add(v)._divideBy(2))),this._startDist=p.distanceTo(v),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),xr(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,p=c.mouseEventToContainerPoint(s.touches[0]),v=c.mouseEventToContainerPoint(s.touches[1]),T=p.distanceTo(v)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var N=p._add(v)._divideBy(2)._subtract(this._centerPoint);if(T===1&&N.x===0&&N.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(N),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),Z(this._animRequest);var Y=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=I(Y,this,!0),xr(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Z(this._animRequest),bt(document,"touchmove",this._onTouchMove,this),bt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});pt.addInitHook("addHandler","touchZoom",gg),pt.BoxZoom=ug,pt.DoubleClickZoom=fg,pt.Drag=dg,pt.Keyboard=hg,pt.ScrollWheelZoom=pg,pt.TapHold=mg,pt.TouchZoom=gg,r.Bounds=ue,r.Browser=Be,r.CRS=ye,r.Canvas=sg,r.Circle=b0,r.CircleMarker=Oc,r.Class=ge,r.Control=Bn,r.DivIcon=ng,r.DivOverlay=oa,r.DomEvent=Pk,r.DomUtil=Ak,r.Draggable=ti,r.Evented=Q,r.FeatureGroup=Ca,r.GeoJSON=Na,r.GridLayer=Wo,r.Handler=sa,r.Icon=Fs,r.ImageOverlay=Ic,r.LatLng=X,r.LatLngBounds=te,r.Layer=zn,r.LayerGroup=Ps,r.LineUtil=Wk,r.Map=pt,r.Marker=Fc,r.Mixin=Ik,r.Path=ri,r.Point=ee,r.PolyUtil=Bk,r.Polygon=Os,r.Polyline=ba,r.Popup=Bc,r.PosAnimation=Bm,r.Projection=$k,r.Rectangle=cg,r.Renderer=Aa,r.SVG=Go,r.SVGOverlay=rg,r.TileLayer=js,r.Tooltip=zc,r.Transformation=$e,r.Util=J,r.VideoOverlay=tg,r.bind=o,r.bounds=F,r.canvas=og,r.circle=Qk,r.circleMarker=Jk,r.control=Uo,r.divIcon=lE,r.extend=a,r.featureGroup=Xk,r.geoJSON=eg,r.geoJson=rE,r.gridLayer=cE,r.icon=Yk,r.imageOverlay=nE,r.latLng=K,r.latLngBounds=q,r.layerGroup=qk,r.map=Fk,r.marker=Kk,r.point=ne,r.polygon=tE,r.polyline=eE,r.popup=sE,r.rectangle=dE,r.setOptions=y,r.stamp=u,r.svg=lg,r.svgOverlay=iE,r.tileLayer=ag,r.tooltip=oE,r.transformation=G,r.version=n,r.videoOverlay=aE;var pE=window.L;r.noConflict=function(){return window.L=pE,this},window.L=r})})(Ih,Ih.exports);var Ea=Ih.exports;const Er=hv(Ea);function ik(e){return e.split(" ").filter(Boolean)}function sk(e,t){ik(t).forEach(r=>{Ea.DomUtil.addClass(e,r)})}function ok(e,t){ik(t).forEach(r=>{Ea.DomUtil.removeClass(e,r)})}function NM(e,t,r){e!=null&&r!==t&&(t!=null&&t.length>0&&ok(e,t),r!=null&&r.length>0&&sk(e,r))}function jo(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Ro(e,t){return t==null?function(n,a){const i=C.useRef();return i.current||(i.current=e(n,a)),i}:function(n,a){const i=C.useRef();i.current||(i.current=e(n,a));const o=C.useRef(n),{instance:l}=i.current;return C.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,a]),i}}function Lm(e,t){C.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var i;(i=t.layerContainer)==null||i.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Pm(e){return function(r){const n=Sc(),a=e(Tc(r,n),n);return Sm(n.map,r.attribution),s0(a.current,r.eventHandlers),Lm(a.current,n),a}}function lk(e,t){const r=C.useRef();C.useEffect(function(){if(t.pathOptions!==r.current){const a=t.pathOptions??{};e.instance.setStyle(a),r.current=a}},[e,t])}function ck(e){return function(r){const n=Sc(),a=e(Tc(r,n),n);return s0(a.current,r.eventHandlers),Lm(a.current,n),lk(a.current,r),a}}function AM(e){function t(a,i){return jo(e(a),i)}const r=Ro(t),n=nk(r);return Am(n)}function uk(e,t){const r=Ro(e,t),n=Pm(r);return Nm(n)}function fk(e,t){const r=Ro(e),n=ak(r,t);return rk(n)}function dk(e,t){const r=Ro(e,t),n=ck(r);return Nm(n)}function hk(e,t){const r=Ro(e,t),n=Pm(r);return Am(n)}function pk(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function LM(e,t,r){t.bounds instanceof Ea.LatLngBounds&&t.bounds!==r.bounds&&e.setBounds(t.bounds),t.opacity!=null&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),t.zIndex!=null&&t.zIndex!==r.zIndex&&e.setZIndex(t.zIndex)}const PM=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_VERSION:ek,LeafletContext:Cm,LeafletProvider:bm,addClassName:sk,createContainerComponent:Nm,createControlComponent:AM,createControlHook:nk,createDivOverlayComponent:rk,createDivOverlayHook:ak,createElementHook:Ro,createElementObject:jo,createLayerComponent:uk,createLayerHook:Pm,createLeafComponent:Am,createLeafletContext:tk,createOverlayComponent:fk,createPathComponent:dk,createPathHook:ck,createTileLayerComponent:hk,extendContext:Tm,removeClassName:ok,updateCircle:bM,updateClassName:NM,updateGridLayer:pk,updateMediaOverlay:LM,useAttribution:Sm,useEventHandlers:s0,useLayerLifecycle:Lm,useLeafletContext:Sc,usePathOptions:lk,withPane:Tc},Symbol.toStringTag,{value:"Module"})),FM=dk(function({data:t,...r},n){const a=new Ea.GeoJSON(t,r);return jo(a,Tm(n,{overlayContainer:a}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function Bh(){return Bh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bh.apply(this,arguments)}function OM({bounds:e,boundsOptions:t,center:r,children:n,className:a,id:i,placeholder:o,style:l,whenReady:u,zoom:d,...h},m){const[g]=C.useState({className:a,id:i,style:l}),[x,_]=C.useState(null);C.useImperativeHandle(m,()=>(x==null?void 0:x.map)??null,[x]);const y=C.useCallback(k=>{if(k!==null&&x===null){const S=new Ea.Map(k,h);r!=null&&d!=null?S.setView(r,d):e!=null&&S.fitBounds(e,t),u!=null&&S.whenReady(u),_(tk(S))}},[]);C.useEffect(()=>()=>{x==null||x.map.remove()},[x]);const E=x?ls.createElement(bm,{value:x},n):o??null;return ls.createElement("div",Bh({},g,{ref:y}),E)}const mk=C.forwardRef(OM),gk=uk(function({position:t,...r},n){const a=new Ea.Marker(t,r);return jo(a,Tm(n,{overlayContainer:a}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),xk=fk(function(t,r){const n=new Ea.Popup(t,r.overlayContainer);return jo(n,r)},function(t,r,{position:n},a){C.useEffect(function(){const{instance:o}=t;function l(d){d.popup===o&&(o.update(),a(!0))}function u(d){d.popup===o&&a(!1)}return r.map.on({popupopen:l,popupclose:u}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var h;r.map.off({popupopen:l,popupclose:u}),(h=r.overlayContainer)==null||h.unbindPopup(),r.map.removeLayer(o)}},[t,r,a,n])}),vk=hk(function({url:t,...r},n){const a=new Ea.TileLayer(t,Tc(r,n));return jo(a,n)},function(t,r,n){pk(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)}),_k=C.createContext({token:null,setToken:()=>{},isAuthenticated:!1,user:null,setUser:()=>{}}),Fm=()=>C.useContext(_k),MM=({children:e})=>{const[t,r]=C.useState(localStorage.getItem("token")),[n,a]=C.useState(null),i=!!t;return f.jsx(_k.Provider,{value:{token:t,setToken:r,isAuthenticated:i,user:n,setUser:a},children:e})};var yk={};const jM=Lf(PM);var nv={exports:{}};(function(e,t){(function(r,n){n(t)})(Ni,function(r){var n=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(i){L.Util.setOptions(this,i),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var o=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,o?this._withAnimation:this._noAnimation),this._markerCluster=o?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(i){if(i instanceof L.LayerGroup)return this.addLayers([i]);if(!i.getLatLng)return this._nonPointGroup.addLayer(i),this.fire("layeradd",{layer:i}),this;if(!this._map)return this._needsClustering.push(i),this.fire("layeradd",{layer:i}),this;if(this.hasLayer(i))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(i,this._maxZoom),this.fire("layeradd",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var o=i,l=this._zoom;if(i.__parent)for(;o.__parent._zoom>=l;)o=o.__parent;return this._currentShownBounds.contains(o.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(i,o):this._animationAddLayerNonAnimated(i,o)),this},removeLayer:function(i){return i instanceof L.LayerGroup?this.removeLayers([i]):i.getLatLng?this._map?i.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(i)),this._removeLayer(i,!0),this.fire("layerremove",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),i.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(i)&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,i)&&this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}),this):(this._nonPointGroup.removeLayer(i),this.fire("layerremove",{layer:i}),this)},addLayers:function(i,o){if(!L.Util.isArray(i))return this.addLayer(i);var l=this._featureGroup,u=this._nonPointGroup,d=this.options.chunkedLoading,h=this.options.chunkInterval,m=this.options.chunkProgress,g=i.length,x=0,_=!0,y;if(this._map){var E=new Date().getTime(),k=L.bind(function(){var w=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();x<g;x++){if(d&&x%200===0){var A=new Date().getTime()-w;if(A>h)break}if(y=i[x],y instanceof L.LayerGroup){_&&(i=i.slice(),_=!1),this._extractNonGroupLayers(y,i),g=i.length;continue}if(!y.getLatLng){u.addLayer(y),o||this.fire("layeradd",{layer:y});continue}if(!this.hasLayer(y)&&(this._addLayer(y,this._maxZoom),o||this.fire("layeradd",{layer:y}),y.__parent&&y.__parent.getChildCount()===2)){var D=y.__parent.getAllChildMarkers(),R=D[0]===y?D[1]:D[0];l.removeLayer(R)}}m&&m(x,g,new Date().getTime()-E),x===g?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(k,this.options.chunkDelay)},this);k()}else for(var S=this._needsClustering;x<g;x++){if(y=i[x],y instanceof L.LayerGroup){_&&(i=i.slice(),_=!1),this._extractNonGroupLayers(y,i),g=i.length;continue}if(!y.getLatLng){u.addLayer(y);continue}this.hasLayer(y)||S.push(y)}return this},removeLayers:function(i){var o,l,u=i.length,d=this._featureGroup,h=this._nonPointGroup,m=!0;if(!this._map){for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}this._arraySplice(this._needsClustering,l),h.removeLayer(l),this.hasLayer(l)&&this._needsRemoving.push({layer:l,latlng:l._latlng}),this.fire("layerremove",{layer:l})}return this}if(this._unspiderfy){this._unspiderfy();var g=i.slice(),x=u;for(o=0;o<x;o++){if(l=g[o],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,g),x=g.length;continue}this._unspiderfyLayer(l)}}for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}if(!l.__parent){h.removeLayer(l),this.fire("layerremove",{layer:l});continue}this._removeLayer(l,!0,!0),this.fire("layerremove",{layer:l}),d.hasLayer(l)&&(d.removeLayer(l),l.clusterShow&&l.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(i){i.off(this._childMarkerEventHandlers,this),delete i.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var i=new L.LatLngBounds;this._topClusterLevel&&i.extend(this._topClusterLevel._bounds);for(var o=this._needsClustering.length-1;o>=0;o--)i.extend(this._needsClustering[o].getLatLng());return i.extend(this._nonPointGroup.getBounds()),i},eachLayer:function(i,o){var l=this._needsClustering.slice(),u=this._needsRemoving,d,h,m;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(l),h=l.length-1;h>=0;h--){for(d=!0,m=u.length-1;m>=0;m--)if(u[m].layer===l[h]){d=!1;break}d&&i.call(o,l[h])}this._nonPointGroup.eachLayer(i,o)},getLayers:function(){var i=[];return this.eachLayer(function(o){i.push(o)}),i},getLayer:function(i){var o=null;return i=parseInt(i,10),this.eachLayer(function(l){L.stamp(l)===i&&(o=l)}),o},hasLayer:function(i){if(!i)return!1;var o,l=this._needsClustering;for(o=l.length-1;o>=0;o--)if(l[o]===i)return!0;for(l=this._needsRemoving,o=l.length-1;o>=0;o--)if(l[o].layer===i)return!1;return!!(i.__parent&&i.__parent._group===this)||this._nonPointGroup.hasLayer(i)},zoomToShowLayer:function(i,o){var l=this._map;typeof o!="function"&&(o=function(){});var u=function(){(l.hasLayer(i)||l.hasLayer(i.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),l.hasLayer(i)?o():i.__parent._icon&&(this.once("spiderfied",o,this),i.__parent.spiderfy()))};i._icon&&this._map.getBounds().contains(i.getLatLng())?o():i.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(i.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),i.__parent.zoomToBounds())},onAdd:function(i){this._map=i;var o,l,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(i),this._nonPointGroup.addTo(i),this._gridClusters||this._generateInitialClusters(),this._maxLat=i.options.crs.projection.MAX_LATITUDE,o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),l=this._needsClustering,this._needsClustering=[],this.addLayers(l,!0)},onRemove:function(i){i.off("zoomend",this._zoomEnd,this),i.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(i){for(var o=i;o&&!o._icon;)o=o.__parent;return o||null},_arraySplice:function(i,o){for(var l=i.length-1;l>=0;l--)if(i[l]===o)return i.splice(l,1),!0},_removeFromGridUnclustered:function(i,o){for(var l=this._map,u=this._gridUnclustered,d=Math.floor(this._map.getMinZoom());o>=d&&u[o].removeObject(i,l.project(i.getLatLng(),o));o--);},_childMarkerDragStart:function(i){i.target.__dragStart=i.target._latlng},_childMarkerMoved:function(i){if(!this._ignoreMove&&!i.target.__dragStart){var o=i.target._popup&&i.target._popup.isOpen();this._moveChild(i.target,i.oldLatLng,i.latlng),o&&i.target.openPopup()}},_moveChild:function(i,o,l){i._latlng=o,this.removeLayer(i),i._latlng=l,this.addLayer(i)},_childMarkerDragEnd:function(i){var o=i.target.__dragStart;delete i.target.__dragStart,o&&this._moveChild(i.target,o,i.target._latlng)},_removeLayer:function(i,o,l){var u=this._gridClusters,d=this._gridUnclustered,h=this._featureGroup,m=this._map,g=Math.floor(this._map.getMinZoom());o&&this._removeFromGridUnclustered(i,this._maxZoom);var x=i.__parent,_=x._markers,y;for(this._arraySplice(_,i);x&&(x._childCount--,x._boundsNeedUpdate=!0,!(x._zoom<g));)o&&x._childCount<=1?(y=x._markers[0]===i?x._markers[1]:x._markers[0],u[x._zoom].removeObject(x,m.project(x._cLatLng,x._zoom)),d[x._zoom].addObject(y,m.project(y.getLatLng(),x._zoom)),this._arraySplice(x.__parent._childClusters,x),x.__parent._markers.push(y),y.__parent=x.__parent,x._icon&&(h.removeLayer(x),l||h.addLayer(y))):x._iconNeedsUpdate=!0,x=x.__parent;delete i.__parent},_isOrIsParent:function(i,o){for(;o;){if(i===o)return!0;o=o.parentNode}return!1},fire:function(i,o,l){if(o&&o.layer instanceof L.MarkerCluster){if(o.originalEvent&&this._isOrIsParent(o.layer._icon,o.originalEvent.relatedTarget))return;i="cluster"+i}L.FeatureGroup.prototype.fire.call(this,i,o,l)},listens:function(i,o){return L.FeatureGroup.prototype.listens.call(this,i,o)||L.FeatureGroup.prototype.listens.call(this,"cluster"+i,o)},_defaultIconCreateFunction:function(i){var o=i.getChildCount(),l=" marker-cluster-";return o<10?l+="small":o<100?l+="medium":l+="large",new L.DivIcon({html:"<div><span>"+o+"</span></div>",className:"marker-cluster"+l,iconSize:new L.Point(40,40)})},_bindEvents:function(){var i=this._map,o=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,d=this.options.spiderfyOnEveryZoom;(o||u||d)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),i.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(i){var o=i.layer,l=o;if(!(i.type==="clusterkeypress"&&i.originalEvent&&i.originalEvent.keyCode!==13)){for(;l._childClusters.length===1;)l=l._childClusters[0];l._zoom===this._maxZoom&&l._childCount===o._childCount&&this.options.spiderfyOnMaxZoom?o.spiderfy():this.options.zoomToBoundsOnClick&&o.zoomToBounds(),this.options.spiderfyOnEveryZoom&&o.spiderfy(),i.originalEvent&&i.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(i){var o=this._map;this._inZoomAnimation||(this._shownPolygon&&o.removeLayer(this._shownPolygon),i.layer.getChildCount()>2&&i.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(i.layer.getConvexHull(),this.options.polygonOptions),o.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var i=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,d=this._map;(i||l||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),d.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var i=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,i),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),i),this._currentShownBounds=i}},_generateInitialClusters:function(){var i=Math.ceil(this._map.getMaxZoom()),o=Math.floor(this._map.getMinZoom()),l=this.options.maxClusterRadius,u=l;typeof l!="function"&&(u=function(){return l}),this.options.disableClusteringAtZoom!==null&&(i=this.options.disableClusteringAtZoom-1),this._maxZoom=i,this._gridClusters={},this._gridUnclustered={};for(var d=i;d>=o;d--)this._gridClusters[d]=new L.DistanceGrid(u(d)),this._gridUnclustered[d]=new L.DistanceGrid(u(d));this._topClusterLevel=new this._markerCluster(this,o-1)},_addLayer:function(i,o){var l=this._gridClusters,u=this._gridUnclustered,d=Math.floor(this._map.getMinZoom()),h,m;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(i),i.on(this._childMarkerEventHandlers,this);o>=d;o--){h=this._map.project(i.getLatLng(),o);var g=l[o].getNearObject(h);if(g){g._addChild(i),i.__parent=g;return}if(g=u[o].getNearObject(h),g){var x=g.__parent;x&&this._removeLayer(g,!1);var _=new this._markerCluster(this,o,g,i);l[o].addObject(_,this._map.project(_._cLatLng,o)),g.__parent=_,i.__parent=_;var y=_;for(m=o-1;m>x._zoom;m--)y=new this._markerCluster(this,m,y),l[m].addObject(y,this._map.project(g.getLatLng(),m));x._addChild(y),this._removeFromGridUnclustered(g,o);return}u[o].addObject(i,h)}this._topClusterLevel._addChild(i),i.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(i){i instanceof L.MarkerCluster&&i._iconNeedsUpdate&&i._updateIcon()})},_enqueue:function(i){this._queue.push(i),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var i=0;i<this._queue.length;i++)this._queue[i].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var i=Math.round(this._map._zoom);this._processQueue(),this._zoom<i&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,i)):this._zoom>i?(this._animationStart(),this._animationZoomOut(this._zoom,i)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(i){var o=this._maxLat;return o!==void 0&&(i.getNorth()>=o&&(i._northEast.lat=1/0),i.getSouth()<=-o&&(i._southWest.lat=-1/0)),i},_animationAddLayerNonAnimated:function(i,o){if(o===i)this._featureGroup.addLayer(i);else if(o._childCount===2){o._addToMap();var l=o.getAllChildMarkers();this._featureGroup.removeLayer(l[0]),this._featureGroup.removeLayer(l[1])}else o._updateIcon()},_extractNonGroupLayers:function(i,o){var l=i.getLayers(),u=0,d;for(o=o||[];u<l.length;u++){if(d=l[u],d instanceof L.LayerGroup){this._extractNonGroupLayers(d,o);continue}o.push(d)}return o},_overrideMarkerIcon:function(i){var o=i.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[i]}});return o}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(i,o){this._animationAddLayerNonAnimated(i,o)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(i,o){var l=this._getExpandedVisibleBounds(),u=this._featureGroup,d=Math.floor(this._map.getMinZoom()),h;this._ignoreMove=!0,this._topClusterLevel._recursively(l,i,d,function(m){var g=m._latlng,x=m._markers,_;for(l.contains(g)||(g=null),m._isSingleParent()&&i+1===o?(u.removeLayer(m),m._recursivelyAddChildrenToMap(null,o,l)):(m.clusterHide(),m._recursivelyAddChildrenToMap(g,o,l)),h=x.length-1;h>=0;h--)_=x[h],l.contains(_._latlng)||u.removeLayer(_)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(l,o),u.eachLayer(function(m){!(m instanceof L.MarkerCluster)&&m._icon&&m.clusterShow()}),this._topClusterLevel._recursively(l,i,o,function(m){m._recursivelyRestoreChildPositions(o)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(l,i,d,function(m){u.removeLayer(m),m.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(i,o){this._animationZoomOutSingle(this._topClusterLevel,i-1,o),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i,this._getExpandedVisibleBounds())},_animationAddLayer:function(i,o){var l=this,u=this._featureGroup;u.addLayer(i),o!==i&&(o._childCount>2?(o._updateIcon(),this._forceLayout(),this._animationStart(),i._setPos(this._map.latLngToLayerPoint(o.getLatLng())),i.clusterHide(),this._enqueue(function(){u.removeLayer(i),i.clusterShow(),l._animationEnd()})):(this._forceLayout(),l._animationStart(),l._animationZoomOutSingle(o,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(i,o,l){var u=this._getExpandedVisibleBounds(),d=Math.floor(this._map.getMinZoom());i._recursivelyAnimateChildrenInAndAddSelfToMap(u,d,o+1,l);var h=this;this._forceLayout(),i._recursivelyBecomeVisible(u,l),this._enqueue(function(){if(i._childCount===1){var m=i._markers[0];this._ignoreMove=!0,m.setLatLng(m.getLatLng()),this._ignoreMove=!1,m.clusterShow&&m.clusterShow()}else i._recursively(u,l,d,function(g){g._recursivelyRemoveChildrenFromMap(u,d,o+1)});h._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(i){return new L.MarkerClusterGroup(i)};var a=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(i,o,l,u){L.Marker.prototype.initialize.call(this,l?l._cLatLng||l.getLatLng():new L.LatLng(0,0),{icon:this,pane:i.options.clusterPane}),this._group=i,this._zoom=o,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,l&&this._addChild(l),u&&this._addChild(u)},getAllChildMarkers:function(i,o){i=i||[];for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l].getAllChildMarkers(i,o);for(var u=this._markers.length-1;u>=0;u--)o&&this._markers[u].__dragStart||i.push(this._markers[u]);return i},getChildCount:function(){return this._childCount},zoomToBounds:function(i){for(var o=this._childClusters.slice(),l=this._group._map,u=l.getBoundsZoom(this._bounds),d=this._zoom+1,h=l.getZoom(),m;o.length>0&&u>d;){d++;var g=[];for(m=0;m<o.length;m++)g=g.concat(o[m]._childClusters);o=g}u>d?this._group._map.setView(this._latlng,d):u<=h?this._group._map.setView(this._latlng,h+1):this._group._map.fitBounds(this._bounds,i)},getBounds:function(){var i=new L.LatLngBounds;return i.extend(this._bounds),i},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(i,o){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(i),i instanceof L.MarkerCluster?(o||(this._childClusters.push(i),i.__parent=this),this._childCount+=i._childCount):(o||this._markers.push(i),this._childCount++),this.__parent&&this.__parent._addChild(i,!0)},_setClusterCenter:function(i){this._cLatLng||(this._cLatLng=i._cLatLng||i._latlng)},_resetBounds:function(){var i=this._bounds;i._southWest&&(i._southWest.lat=1/0,i._southWest.lng=1/0),i._northEast&&(i._northEast.lat=-1/0,i._northEast.lng=-1/0)},_recalculateBounds:function(){var i=this._markers,o=this._childClusters,l=0,u=0,d=this._childCount,h,m,g,x;if(d!==0){for(this._resetBounds(),h=0;h<i.length;h++)g=i[h]._latlng,this._bounds.extend(g),l+=g.lat,u+=g.lng;for(h=0;h<o.length;h++)m=o[h],m._boundsNeedUpdate&&m._recalculateBounds(),this._bounds.extend(m._bounds),g=m._wLatLng,x=m._childCount,l+=g.lat*x,u+=g.lng*x;this._latlng=this._wLatLng=new L.LatLng(l/d,u/d),this._boundsNeedUpdate=!1}},_addToMap:function(i){i&&(this._backupLatlng=this._latlng,this.setLatLng(i)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(i,o,l){this._recursively(i,this._group._map.getMinZoom(),l-1,function(u){var d=u._markers,h,m;for(h=d.length-1;h>=0;h--)m=d[h],m._icon&&(m._setPos(o),m.clusterHide())},function(u){var d=u._childClusters,h,m;for(h=d.length-1;h>=0;h--)m=d[h],m._icon&&(m._setPos(o),m.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(i,o,l,u){this._recursively(i,u,o,function(d){d._recursivelyAnimateChildrenIn(i,d._group._map.latLngToLayerPoint(d.getLatLng()).round(),l),d._isSingleParent()&&l-1===u?(d.clusterShow(),d._recursivelyRemoveChildrenFromMap(i,o,l)):d.clusterHide(),d._addToMap()})},_recursivelyBecomeVisible:function(i,o){this._recursively(i,this._group._map.getMinZoom(),o,null,function(l){l.clusterShow()})},_recursivelyAddChildrenToMap:function(i,o,l){this._recursively(l,this._group._map.getMinZoom()-1,o,function(u){if(o!==u._zoom)for(var d=u._markers.length-1;d>=0;d--){var h=u._markers[d];l.contains(h._latlng)&&(i&&(h._backupLatlng=h.getLatLng(),h.setLatLng(i),h.clusterHide&&h.clusterHide()),u._group._featureGroup.addLayer(h))}},function(u){u._addToMap(i)})},_recursivelyRestoreChildPositions:function(i){for(var o=this._markers.length-1;o>=0;o--){var l=this._markers[o];l._backupLatlng&&(l.setLatLng(l._backupLatlng),delete l._backupLatlng)}if(i-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var d=this._childClusters.length-1;d>=0;d--)this._childClusters[d]._recursivelyRestoreChildPositions(i)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(i,o,l,u){var d,h;this._recursively(i,o-1,l-1,function(m){for(h=m._markers.length-1;h>=0;h--)d=m._markers[h],(!u||!u.contains(d._latlng))&&(m._group._featureGroup.removeLayer(d),d.clusterShow&&d.clusterShow())},function(m){for(h=m._childClusters.length-1;h>=0;h--)d=m._childClusters[h],(!u||!u.contains(d._latlng))&&(m._group._featureGroup.removeLayer(d),d.clusterShow&&d.clusterShow())})},_recursively:function(i,o,l,u,d){var h=this._childClusters,m=this._zoom,g,x;if(o<=m&&(u&&u(this),d&&m===l&&d(this)),m<o||m<l)for(g=h.length-1;g>=0;g--)x=h[g],x._boundsNeedUpdate&&x._recalculateBounds(),i.intersects(x._bounds)&&x._recursively(i,o,l,u,d)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var i=this.options.opacity;return this.setOpacity(0),this.options.opacity=i,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(i){this._cellSize=i,this._sqCellSize=i*i,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),d=this._grid,h=d[u]=d[u]||{},m=h[l]=h[l]||[],g=L.Util.stamp(i);this._objectPoint[g]=o,m.push(i)},updateObject:function(i,o){this.removeObject(i),this.addObject(i,o)},removeObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),d=this._grid,h=d[u]=d[u]||{},m=h[l]=h[l]||[],g,x;for(delete this._objectPoint[L.Util.stamp(i)],g=0,x=m.length;g<x;g++)if(m[g]===i)return m.splice(g,1),x===1&&delete h[l],!0},eachObject:function(i,o){var l,u,d,h,m,g,x,_=this._grid;for(l in _){m=_[l];for(u in m)for(g=m[u],d=0,h=g.length;d<h;d++)x=i.call(o,g[d]),x&&(d--,h--)}},getNearObject:function(i){var o=this._getCoord(i.x),l=this._getCoord(i.y),u,d,h,m,g,x,_,y,E=this._objectPoint,k=this._sqCellSize,S=null;for(u=l-1;u<=l+1;u++)if(m=this._grid[u],m){for(d=o-1;d<=o+1;d++)if(g=m[d],g)for(h=0,x=g.length;h<x;h++)_=g[h],y=this._sqDist(E[L.Util.stamp(_)],i),(y<k||y<=k&&S===null)&&(k=y,S=_)}return S},_getCoord:function(i){var o=Math.floor(i/this._cellSize);return isFinite(o)?o:i},_sqDist:function(i,o){var l=o.x-i.x,u=o.y-i.y;return l*l+u*u}},function(){L.QuickHull={getDistant:function(i,o){var l=o[1].lat-o[0].lat,u=o[0].lng-o[1].lng;return u*(i.lat-o[0].lat)+l*(i.lng-o[0].lng)},findMostDistantPointFromBaseLine:function(i,o){var l=0,u=null,d=[],h,m,g;for(h=o.length-1;h>=0;h--){if(m=o[h],g=this.getDistant(m,i),g>0)d.push(m);else continue;g>l&&(l=g,u=m)}return{maxPoint:u,newPoints:d}},buildConvexHull:function(i,o){var l=[],u=this.findMostDistantPointFromBaseLine(i,o);return u.maxPoint?(l=l.concat(this.buildConvexHull([i[0],u.maxPoint],u.newPoints)),l=l.concat(this.buildConvexHull([u.maxPoint,i[1]],u.newPoints)),l):[i[0]]},getConvexHull:function(i){var o=!1,l=!1,u=!1,d=!1,h=null,m=null,g=null,x=null,_=null,y=null,E;for(E=i.length-1;E>=0;E--){var k=i[E];(o===!1||k.lat>o)&&(h=k,o=k.lat),(l===!1||k.lat<l)&&(m=k,l=k.lat),(u===!1||k.lng>u)&&(g=k,u=k.lng),(d===!1||k.lng<d)&&(x=k,d=k.lng)}l!==o?(y=m,_=h):(y=x,_=g);var S=[].concat(this.buildConvexHull([y,_],i),this.buildConvexHull([_,y],i));return S}}}(),L.MarkerCluster.include({getConvexHull:function(){var i=this.getAllChildMarkers(),o=[],l,u;for(u=i.length-1;u>=0;u--)l=i[u].getLatLng(),o.push(l);return L.QuickHull.getConvexHull(o)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var i=this.getAllChildMarkers(null,!0),o=this._group,l=o._map,u=l.latLngToLayerPoint(this._latlng),d;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?d=this._group.options.spiderfyShapePositions(i.length,u):i.length>=this._circleSpiralSwitchover?d=this._generatePointsSpiral(i.length,u):(u.y+=10,d=this._generatePointsCircle(i.length,u)),this._animationSpiderfy(i,d)}},unspiderfy:function(i){this._group._inZoomAnimation||(this._animationUnspiderfy(i),this._group._spiderfied=null)},_generatePointsCircle:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+i),u=l/this._2PI,d=this._2PI/i,h=[],m,g;for(u=Math.max(u,35),h.length=i,m=0;m<i;m++)g=this._circleStartAngle+m*d,h[m]=new L.Point(o.x+u*Math.cos(g),o.y+u*Math.sin(g))._round();return h},_generatePointsSpiral:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier,u=l*this._spiralLengthStart,d=l*this._spiralFootSeparation,h=l*this._spiralLengthFactor*this._2PI,m=0,g=[],x;for(g.length=i,x=i;x>=0;x--)x<i&&(g[x]=new L.Point(o.x+u*Math.cos(m),o.y+u*Math.sin(m))._round()),m+=d/u+x*5e-4,u+=h/m;return g},_noanimationUnspiderfy:function(){var i=this._group,o=i._map,l=i._featureGroup,u=this.getAllChildMarkers(null,!0),d,h;for(i._ignoreMove=!0,this.setOpacity(1),h=u.length-1;h>=0;h--)d=u[h],l.removeLayer(d),d._preSpiderfyLatlng&&(d.setLatLng(d._preSpiderfyLatlng),delete d._preSpiderfyLatlng),d.setZIndexOffset&&d.setZIndexOffset(0),d._spiderLeg&&(o.removeLayer(d._spiderLeg),delete d._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:u}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(i,o){var l=this._group,u=l._map,d=l._featureGroup,h=this._group.options.spiderLegPolylineOptions,m,g,x,_;for(l._ignoreMove=!0,m=0;m<i.length;m++)_=u.layerPointToLatLng(o[m]),g=i[m],x=new L.Polyline([this._latlng,_],h),u.addLayer(x),g._spiderLeg=x,g._preSpiderfyLatlng=g._latlng,g.setLatLng(_),g.setZIndexOffset&&g.setZIndexOffset(1e6),d.addLayer(g);this.setOpacity(.3),l._ignoreMove=!1,l.fire("spiderfied",{cluster:this,markers:i})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(i,o){var l=this,u=this._group,d=u._map,h=u._featureGroup,m=this._latlng,g=d.latLngToLayerPoint(m),x=L.Path.SVG,_=L.extend({},this._group.options.spiderLegPolylineOptions),y=_.opacity,E,k,S,w,A,D;for(y===void 0&&(y=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),x?(_.opacity=0,_.className=(_.className||"")+" leaflet-cluster-spider-leg"):_.opacity=y,u._ignoreMove=!0,E=0;E<i.length;E++)k=i[E],D=d.layerPointToLatLng(o[E]),S=new L.Polyline([m,D],_),d.addLayer(S),k._spiderLeg=S,x&&(w=S._path,A=w.getTotalLength()+.1,w.style.strokeDasharray=A,w.style.strokeDashoffset=A),k.setZIndexOffset&&k.setZIndexOffset(1e6),k.clusterHide&&k.clusterHide(),h.addLayer(k),k._setPos&&k._setPos(g);for(u._forceLayout(),u._animationStart(),E=i.length-1;E>=0;E--)D=d.layerPointToLatLng(o[E]),k=i[E],k._preSpiderfyLatlng=k._latlng,k.setLatLng(D),k.clusterShow&&k.clusterShow(),x&&(S=k._spiderLeg,w=S._path,w.style.strokeDashoffset=0,S.setStyle({opacity:y}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:l,markers:i})},200)},_animationUnspiderfy:function(i){var o=this,l=this._group,u=l._map,d=l._featureGroup,h=i?u._latLngToNewLayerPoint(this._latlng,i.zoom,i.center):u.latLngToLayerPoint(this._latlng),m=this.getAllChildMarkers(null,!0),g=L.Path.SVG,x,_,y,E,k,S;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),_=m.length-1;_>=0;_--)x=m[_],x._preSpiderfyLatlng&&(x.closePopup(),x.setLatLng(x._preSpiderfyLatlng),delete x._preSpiderfyLatlng,S=!0,x._setPos&&(x._setPos(h),S=!1),x.clusterHide&&(x.clusterHide(),S=!1),S&&d.removeLayer(x),g&&(y=x._spiderLeg,E=y._path,k=E.getTotalLength()+.1,E.style.strokeDashoffset=k,y.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var w=0;for(_=m.length-1;_>=0;_--)x=m[_],x._spiderLeg&&w++;for(_=m.length-1;_>=0;_--)x=m[_],x._spiderLeg&&(x.clusterShow&&x.clusterShow(),x.setZIndexOffset&&x.setZIndexOffset(0),w>1&&d.removeLayer(x),u.removeLayer(x._spiderLeg),delete x._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:o,markers:m})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(i){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(i))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(i){this._spiderfied&&this._spiderfied.unspiderfy(i)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(i){i._spiderLeg&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow(),i.setZIndexOffset&&i.setZIndexOffset(0),this._map.removeLayer(i._spiderLeg),delete i._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(i){return i?i instanceof L.MarkerClusterGroup?i=i._topClusterLevel.getAllChildMarkers():i instanceof L.LayerGroup?i=i._layers:i instanceof L.MarkerCluster?i=i.getAllChildMarkers():i instanceof L.Marker&&(i=[i]):i=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(i),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(i),this},_flagParentsIconsNeedUpdate:function(i){var o,l;for(o in i)for(l=i[o].__parent;l;)l._iconNeedsUpdate=!0,l=l.__parent},_refreshSingleMarkerModeMarkers:function(i){var o,l;for(o in i)l=i[o],this.hasLayer(l)&&l.setIcon(this._overrideMarkerIcon(l))}}),L.Marker.include({refreshIconOptions:function(i,o){var l=this.options.icon;return L.setOptions(l,i),this.setIcon(l),o&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),r.MarkerClusterGroup=n,r.MarkerCluster=a,Object.defineProperty(r,"__esModule",{value:!0})})})(nv,nv.exports);const RM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",DM=Object.freeze(Object.defineProperty({__proto__:null,default:RM},Symbol.toStringTag,{value:"Module"})),IM=Lf(DM),BM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",zM=Object.freeze(Object.defineProperty({__proto__:null,default:BM},Symbol.toStringTag,{value:"Module"})),UM=Lf(zM),HM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",VM=Object.freeze(Object.defineProperty({__proto__:null,default:HM},Symbol.toStringTag,{value:"Module"})),WM=Lf(VM);var no=Ni&&Ni.__assign||function(){return no=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},no.apply(this,arguments)},$M=Ni&&Ni.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},GM=Ni&&Ni.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yk,"__esModule",{value:!0});var zh=jM,Om=GM(Ea);delete Om.default.Icon.Default.prototype._getIconUrl;Om.default.Icon.Default.mergeOptions({iconRetinaUrl:IM.default,iconUrl:UM.default,shadowUrl:WM.default});function ZM(e){var t={},r={};e.children;var n=$M(e,["children"]);return Object.entries(n).forEach(function(a){var i,o,l=a[0],u=a[1];l.startsWith("on")?r=no(no({},r),(i={},i[l]=u,i)):t=no(no({},t),(o={},o[l]=u,o))}),{clusterProps:t,clusterEvents:r}}function qM(e,t){var r=ZM(e),n=r.clusterProps,a=r.clusterEvents,i=new Om.default.MarkerClusterGroup(n);return Object.entries(a).forEach(function(o){var l=o[0],u=o[1],d="cluster".concat(l.substring(2).toLowerCase());i.on(d,u)}),(0,zh.createElementObject)(i,(0,zh.extendContext)(t,{layerContainer:i}))}var XM=function(e,t,r){},YM=(0,zh.createPathComponent)(qM,XM),wk=yk.default=YM;const av=(e,t)=>{const r=Math.abs(e),n=Math.floor(r),a=Math.floor((r-n)*60),i=((r-n-a/60)*3600).toFixed(1),o=t?e>=0?"N":"S":e>=0?"E":"W";return`${n}${a}'${i}"${o}`},KM=({onClose:e,position:t,onSuccess:r,onError:n,onCamerasUpdate:a})=>{const[i,o]=C.useState({name:"",ip_address:"",location:`${av(t[0],!0)} ${av(t[1],!1)}`,latitude:t[0].toString(),longitude:t[1].toString()}),{isAuthenticated:l,token:u}=Fm(),d=C.useRef(null),[h,m]=C.useState(!1),g=async _=>{var y,E,k;if(_.preventDefault(),!l||!u){n("Veuillez vous connecter pour ajouter une camra");return}m(!0);try{if((await Ve.post(`${Dt}/cameras/cameras/`,i,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}})).status===201){r("Camra ajoute avec succs");const w=await Ve.get(`${Dt}/cameras/cameras/`,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(w.data.results||[]),e()}}catch(S){console.error("Error adding camera:",S),Ve.isAxiosError(S)?((y=S.response)==null?void 0:y.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):n(((k=(E=S.response)==null?void 0:E.data)==null?void 0:k.error)||"Erreur lors de l'ajout de la camra"):n("Erreur lors de l'ajout de la camra")}finally{m(!1)}},x=async _=>{var k,S,w,A,D;if(!l||!u){n("Veuillez vous connecter pour importer des camras");return}const y=(k=_.target.files)==null?void 0:k[0];if(!y)return;if(!y.name.endsWith(".csv")){n("Le fichier doit tre au format CSV");return}m(!0);const E=new FormData;E.append("file",y);try{const R=await Ve.post(`${Dt}/cameras/cameras/upload_csv/`,E,{headers:{Authorization:`Bearer ${u}`,Accept:"application/json","Content-Type":"multipart/form-data"}});if(R.status===200){r(`Import russi: ${R.data.created} cres, ${R.data.updated} mises  jour`);const P=await Ve.get(`${Dt}/cameras/cameras/`,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(P.data.results||[]),e()}}catch(R){console.error("Error uploading CSV:",R),Ve.isAxiosError(R)?((S=R.response)==null?void 0:S.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):((w=R.response)==null?void 0:w.status)===400?n(R.response.data.error||"Format de fichier invalide ou donnes manquantes"):n(((D=(A=R.response)==null?void 0:A.data)==null?void 0:D.error)||"Erreur lors de l'importation du fichier CSV"):n("Erreur lors de l'importation du fichier CSV")}finally{m(!1),d.current&&(d.current.value="")}};return f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl z-50 w-full max-w-2xl mx-auto border border-gray-200",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Ajouter une nouvelle camra"}),f.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",disabled:h,children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("form",{onSubmit:g,className:"space-y-6",children:[f.jsxs("fieldset",{className:"border border-gray-300 rounded-lg p-4 pb-6",children:[f.jsx("legend",{className:"text-md font-semibold text-gray-700 px-2",children:"Informations Gnrales"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-4 pt-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom de la camra"}),f.jsx("input",{type:"text",id:"name",value:i.name,onChange:_=>o({...i,name:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: Camra Principale Entre",required:!0,disabled:h})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"ip_address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse IP"}),f.jsx("input",{type:"text",id:"ip_address",value:i.ip_address,onChange:_=>o({...i,ip_address:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: 192.168.1.100",required:!0,disabled:h})]}),f.jsxs("div",{className:"col-span-1 md:col-span-2",children:[f.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Emplacement (Description)"}),f.jsx("input",{type:"text",id:"location",value:i.location,onChange:_=>o({...i,location:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: Btiment A, Porte 2",disabled:h})]})]})]}),f.jsxs("fieldset",{className:"border border-gray-300 rounded-lg p-4 pb-6",children:[f.jsx("legend",{className:"text-md font-semibold text-gray-700 px-2",children:"Coordonnes Gographiques"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-4 pt-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"latitude",className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),f.jsx("input",{type:"text",id:"latitude",value:i.latitude,onChange:_=>o({...i,latitude:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: 34.0000 (Dcimal)",required:!0,disabled:h})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"longitude",className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),f.jsx("input",{type:"text",id:"longitude",value:i.longitude,onChange:_=>o({...i,longitude:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: -6.0000 (Dcimal)",required:!0,disabled:h})]})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4 mt-6",children:[f.jsx("input",{type:"file",ref:d,onChange:x,accept:".csv",className:"hidden",id:"csv-upload",disabled:h}),f.jsx("label",{htmlFor:"csv-upload",className:`w-full sm:w-auto flex justify-center items-center px-6 py-2 border border-transparent text-sm font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 cursor-pointer transition-colors duration-200 ${h?"opacity-50 cursor-not-allowed":""}`,children:h?f.jsxs("span",{className:"flex items-center",children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-green-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," Importation..."]}):"Importer CSV"}),f.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto flex justify-center items-center px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200",disabled:h,children:"Annuler"}),f.jsx("button",{type:"submit",className:`w-full sm:w-auto flex justify-center items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 ${h?"opacity-50 cursor-not-allowed":""}`,disabled:h,children:h?f.jsxs("span",{className:"flex items-center",children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," Ajout en cours..."]}):"Ajouter"})]})]})]})},Oa=Ve.create({baseURL:Dt,headers:{"Content-Type":"application/json",Accept:"application/json"}});Oa.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Oa.interceptors.response.use(e=>e,e=>{if(e.response){if(e.response.status===401)localStorage.removeItem("token"),window.location.href="/login";else if(e.response.status===404)return console.error("Endpoint not found:",e.response.config.url),Promise.reject(new Error("Endpoint non trouv. Veuillez vrifier la configuration du serveur."))}return Promise.reject(e)});const JM=Er.icon({iconUrl:"/images/marker-icon.png",iconRetinaUrl:"/images/marker-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),QM=Er.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#22c55e">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),ej=Er.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#ef4444">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),tj=Er.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#2563eb">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),rj=`
  .custom-camera-icon {
    background: none;
    border: none;
  }
  .custom-camera-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-camera-icon:hover svg {
    transform: scale(1.1);
  }
  .custom-datacenter-icon {
    background: none;
    border: none;
  }
  .custom-datacenter-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-datacenter-icon:hover svg {
    transform: scale(1.1);
  }
  .leaflet-popup-content-wrapper {
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  .leaflet-popup-content {
    margin: 0;
    min-width: 300px;
    max-width: 500px;
  }
  .datacenter-popup-content {
    padding: 1rem;
    min-width: 300px;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    background: white;
    border-radius: 8px;
  }
`,kk=document.createElement("style");kk.innerText=rj;document.head.appendChild(kk);const nj=()=>{const[e,t]=C.useState(null),[r,n]=C.useState([]),[a,i]=C.useState(!1),[o,l]=C.useState([0,0]),[u,d]=C.useState(null),[h,m]=C.useState(null),[g,x]=C.useState({}),{isAuthenticated:_,token:y}=Fm(),E=C.useRef(null),[k,S]=C.useState("all"),[w,A]=C.useState("all"),[D,R]=C.useState(""),[P,H]=C.useState(!1),B=C.useRef(null),[W,I]=C.useState(!1),[Z,J]=C.useState(null),[ge,_e]=C.useState(!1),[de,Q]=C.useState(new Set),[ee,U]=C.useState(!1),[ne,ue]=C.useState(!1),F=me=>{d(me),B.current&&clearTimeout(B.current),B.current=window.setTimeout(()=>{window.location.reload()},3e3)};C.useEffect(()=>{const me=localStorage.getItem("token");if(!me){F("Veuillez vous connecter pour accder  cette page");return}return Oa.get(Zx.CAMERAS.LIST,{headers:{Authorization:`Bearer ${me}`,"Content-Type":"application/json",Accept:"application/json"}}).then(()=>{H(!0)}).catch(Te=>{var Pe;((Pe=Te.response)==null?void 0:Pe.status)===401?(F("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):d("Erreur de connexion au serveur")}),()=>{B.current&&clearTimeout(B.current)}},[]),C.useEffect(()=>{P&&(Er.Marker.prototype.options.icon=JM,t(e))},[P]),C.useEffect(()=>P?((async()=>{var Te;try{const Pe=localStorage.getItem("token");if(!Pe){d("Token non trouv. Veuillez vous reconnecter.");return}let he=[],Ue=Zx.CAMERAS.LIST;for(;Ue;){const We=await Oa.get(Ue,{headers:{Authorization:`Bearer ${Pe}`,"Content-Type":"application/json",Accept:"application/json"}});We.data.results&&(he=[...he,...We.data.results]),Ue=We.data.next}n(he),d(null)}catch(Pe){console.error("Error fetching cameras:",Pe),Ve.isAxiosError(Pe)&&((Te=Pe.response)==null?void 0:Te.status)===401?(d("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):d("Erreur lors du chargement des camras"),n([])}})(),()=>{Er.Marker.prototype.options.icon=void 0}):void 0,[P]);const te=async me=>{try{x(he=>({...he,[me]:{status:"loading",responseTime:null}}));const Te=await fetch(`${Dt}/cameras/cameras/${me}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!Te.ok)throw new Error("Erreur lors du ping");const Pe=await Te.json();x(he=>({...he,[me]:{status:Pe.status,responseTime:Pe.response_time,lastUpdate:Date.now()}}))}catch(Te){console.error("Error pinging camera:",Te),x(Pe=>({...Pe,[me]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},q=async me=>{var Te,Pe,he;if(!_||!y){d("Veuillez vous connecter pour supprimer une camra");return}_e(!0);try{(await Oa.delete(`/cameras/cameras/${me.id}/`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json",Accept:"application/json"}})).status===204&&(m(`Camra "${X(me.name)}" supprime avec succs`),n(We=>We.filter(yt=>yt.id!==me.id)),J(null))}catch(Ue){console.error("Error deleting camera:",Ue),Ve.isAxiosError(Ue)?((Te=Ue.response)==null?void 0:Te.status)===401?(d("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):d(((he=(Pe=Ue.response)==null?void 0:Pe.data)==null?void 0:he.error)||"Erreur lors de la suppression de la camra"):d("Erreur lors de la suppression de la camra")}finally{_e(!1)}},X=me=>me.replace(//g,"").replace(//g,"").replace(//g,"").replace(/ /g,"").replace(//g,"").replace(//g,"").replace(//g,"").replace(//g,"").replace(//g,""),K=me=>me?Date.now()-me>3e5:!0,ye=me=>{const Te=g[me];return!Te||Te.status==="idle"||K(Te.lastUpdate)?tj:Te.status==="online"?QM:ej},Le=r.filter(me=>{var Ue,We,yt;const Te=me.name.toLowerCase().includes(D.toLowerCase())||me.ip_address.toLowerCase().includes(D.toLowerCase()),Pe=k==="all"||k==="cameras",he=w==="all"||w==="online"&&((Ue=g[me.id])==null?void 0:Ue.status)==="online"||w==="offline"&&(((We=g[me.id])==null?void 0:We.status)==="offline"||((yt=g[me.id])==null?void 0:yt.status)==="error");return Te&&Pe&&he}),be=async()=>{if(!_){d("Veuillez vous connecter pour effectuer un ping");return}I(!0);try{const Te=(await Oa.post("/cameras/cameras/ping_all/")).data.task_id,Pe=async()=>{try{const Ue=(await Oa.get(`/cameras/cameras/check_ping_status/?task_id=${Te}`)).data;if(Ue.status==="completed"){const We={};Ue.results.forEach(dt=>{We[dt.id]={status:dt.status,responseTime:dt.response_time,lastUpdate:Date.now()}}),x(dt=>({...dt,...We})),n(dt=>dt.map(St=>{const _t=We[St.id];return _t?{...St,is_online:_t.status==="online"}:St}));const yt=Object.values(We).filter(dt=>dt.status==="online").length,Tt=Object.values(We).filter(dt=>dt.status==="offline"||dt.status==="error").length;m(`Ping termin: ${yt} en ligne, ${Tt} hors ligne`),I(!1)}else Ue.status==="failed"?(d(`Erreur lors du ping: ${Ue.message}`),I(!1)):setTimeout(Pe,2e3)}catch(he){console.error("Error checking ping status:",he),d("Erreur lors de la vrification du statut"),I(!1)}};Pe()}catch(me){console.error("Error starting ping process:",me),d("Erreur lors du dmarrage du ping"),I(!1)}},ke=me=>{ee&&(Q(Te=>{const Pe=new Set(Te);return Pe.has(me)?Pe.delete(me):Pe.add(me),Pe}),ue(!0))},$e=me=>{Q(Te=>{const Pe=new Set(Te);return Pe.delete(me),Pe})},G=async()=>{var me,Te,Pe;if(!(!_||!y||de.size===0)){_e(!0);try{const he=Array.from(de).map(Ue=>Oa.delete(`/cameras/cameras/${Ue}/`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json",Accept:"application/json"}}));await Promise.all(he),m(`${de.size} camra(s) supprime(s) avec succs`),n(Ue=>Ue.filter(We=>!de.has(We.id))),Q(new Set),U(!1)}catch(he){console.error("Error deleting cameras:",he),Ve.isAxiosError(he)?((me=he.response)==null?void 0:me.status)===401?(d("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):d(((Pe=(Te=he.response)==null?void 0:Te.data)==null?void 0:Pe.error)||"Erreur lors de la suppression des camras"):d("Erreur lors de la suppression des camras")}finally{_e(!1)}}},ot=async()=>{if(!(!_||!y||de.size===0)){I(!0);try{const me=Array.from(de).map(he=>Oa.post(`/cameras/cameras/${he}/ping/`)),Te=await Promise.all(me),Pe={};Te.forEach((he,Ue)=>{const We=Array.from(de)[Ue];Pe[We]={status:he.data.status,responseTime:he.data.response_time,lastUpdate:Date.now()}}),x(he=>({...he,...Pe})),m(`Ping de ${de.size} camra(s) termin`)}catch(me){console.error("Error pinging cameras:",me),d("Erreur lors du ping des camras slectionnes")}finally{I(!1)}}};return f.jsxs("div",{className:"w-full h-full rounded-lg overflow-hidden shadow-lg relative",children:[f.jsxs("div",{className:"absolute top-4 right-4 z-[1000] bg-white rounded-lg shadow-lg p-4 space-y-4 w-80",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode slection"}),f.jsx("button",{onClick:()=>{U(!ee),ee||(Q(new Set),ue(!1))},className:`relative inline-flex h-6 w-11 items-center rounded-full ${ee?"bg-blue-600":"bg-gray-200"}`,children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${ee?"translate-x-6":"translate-x-1"}`})})]}),ee&&de.size>0&&ne&&f.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[f.jsxs("div",{className:"p-3 border-b border-gray-200 flex justify-between items-center",children:[f.jsxs("h3",{className:"text-sm font-medium text-gray-700",children:["Camras slectionnes (",de.size,")"]}),f.jsx("button",{onClick:()=>ue(!1),className:"text-gray-400 hover:text-gray-600",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),f.jsx("div",{className:"max-h-60 overflow-y-auto",children:Array.from(de).map(me=>{var Pe,he,Ue,We,yt,Tt,dt;const Te=r.find(St=>St.id===me);return Te?f.jsx("div",{className:"p-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50",children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-900",children:X(Te.name)}),f.jsxs("p",{className:"text-xs text-gray-500",children:["IP: ",Te.ip_address]}),Te.latitude&&Te.longitude&&f.jsxs("p",{className:"text-xs text-gray-500",children:["Position: ",Te.latitude,", ",Te.longitude]}),f.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[f.jsx("button",{onClick:()=>te(Te.id),disabled:((Pe=g[Te.id])==null?void 0:Pe.status)==="loading",className:`px-2 py-1 rounded text-xs text-white ${((he=g[Te.id])==null?void 0:he.status)==="loading"?"bg-gray-400":((Ue=g[Te.id])==null?void 0:Ue.status)==="online"?"bg-green-500":((We=g[Te.id])==null?void 0:We.status)==="offline"?"bg-red-500":"bg-blue-500"}`,children:((yt=g[Te.id])==null?void 0:yt.status)==="loading"?f.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-2 border-white border-t-transparent"}):((Tt=g[Te.id])==null?void 0:Tt.status)==="online"?f.jsx(Sh,{className:"w-3 h-3"}):((dt=g[Te.id])==null?void 0:dt.status)==="offline"?f.jsx(Eh,{className:"w-3 h-3"}):"Ping"}),f.jsx("button",{onClick:()=>$e(Te.id),className:"px-2 py-1 rounded text-xs text-white bg-red-500 hover:bg-red-600",children:"Retirer"})]})]}),f.jsx("div",{className:"ml-2",children:f.jsx("button",{onClick:()=>{if(E.current){const St=parseFloat(Te.latitude||"0"),_t=parseFloat(Te.longitude||"0");!isNaN(St)&&!isNaN(_t)&&E.current.setView([St,_t],13)}},className:"text-gray-400 hover:text-gray-600",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})})]})},me):null})}),f.jsx("div",{className:"p-3 bg-gray-50 border-t border-gray-200",children:f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{onClick:ot,disabled:W,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${W?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:W?"Ping en cours...":"Ping slection"}),f.jsx("button",{onClick:G,disabled:ge,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${ge?"bg-red-400":"bg-red-500 hover:bg-red-600"}`,children:ge?"Suppression...":"Supprimer"})]})})]}),ee&&de.size>0&&!ne&&f.jsxs("div",{className:"bg-blue-50 p-3 rounded-md space-y-2",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"text-sm font-medium text-blue-700",children:[de.size," camra(s) slectionne(s)"]}),f.jsx("button",{onClick:()=>ue(!0),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Voir la liste"})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{onClick:ot,disabled:W,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${W?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:W?"Ping en cours...":"Ping slection"}),f.jsx("button",{onClick:G,disabled:ge,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${ge?"bg-red-400":"bg-red-500 hover:bg-red-600"}`,children:ge?"Suppression...":"Supprimer"})]})]}),f.jsxs("button",{onClick:()=>{if(!_){F("Veuillez vous connecter pour ajouter une camra");return}i(!0)},className:"w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[f.jsx(es,{className:"h-5 w-5 mr-2"}),"Ajouter une Camra"]}),f.jsxs("div",{className:"flex space-x-2 mb-2",children:[f.jsx("button",{onClick:()=>S("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${k==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tout"}),f.jsx("button",{onClick:()=>S("cameras"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${k==="cameras"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Camras"})]}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:D,onChange:me=>R(me.target.value),placeholder:"Rechercher une camra...",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),D&&f.jsx("button",{onClick:()=>R(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{onClick:()=>A("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${w==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous"}),f.jsx("button",{onClick:()=>A("online"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${w==="online"?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"En ligne"}),f.jsx("button",{onClick:()=>A("offline"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${w==="offline"?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Hors ligne"})]}),f.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[f.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Statistiques"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Camras:"}),f.jsx("span",{className:"font-semibold",children:Le.length})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"En ligne:"}),f.jsx("span",{className:"text-green-500 font-semibold",children:Object.values(g).filter(me=>me.status==="online").length})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Hors ligne:"}),f.jsx("span",{className:"text-red-500 font-semibold",children:Object.values(g).filter(me=>me.status==="offline"||me.status==="error").length})]})]}),f.jsx("button",{onClick:be,disabled:W,className:`w-full px-4 py-2 rounded-md text-white text-sm flex items-center justify-center gap-2 ${W?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:W?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Ping en cours..."]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),"Tester toutes les camras"]})})]})]}),f.jsxs(mk,{center:[31.7917,-7.0926],zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,ref:E,children:[f.jsx(vk,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),e&&f.jsx(FM,{data:e,style:{color:"#2563eb",weight:2,fillOpacity:.1,fillColor:"#3b82f6"},onEachFeature:(me,Te)=>{var Pe;Te.bindPopup(`
                <div class="p-2">
                  <h3 class="font-semibold text-lg">${me.properties.ADMIN}</h3>
                  <p class="text-sm">Population: ${((Pe=me.properties.POP_EST)==null?void 0:Pe.toLocaleString())||"N/A"}</p>
                </div>
              `)}}),f.jsx(wk,{chunkedLoading:!0,maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:me=>Er.divIcon({html:`<div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${me.getChildCount()}</div>`,className:"custom-cluster-icon",iconSize:Er.point(32,32)}),children:Le.map(me=>{var Te,Pe,he,Ue,We,yt,Tt,dt;if(me.latitude&&me.longitude){const St=parseFloat(me.latitude),_t=parseFloat(me.longitude);if(!isNaN(St)&&!isNaN(_t)){const ar=de.has(me.id);return f.jsx(gk,{position:[St,_t],icon:ye(me.id),riseOnHover:!0,eventHandlers:{click:()=>ke(me.id)},children:f.jsx(xk,{children:f.jsxs("div",{className:`p-2 min-w-[200px] ${ar?"bg-blue-50":""}`,children:[f.jsx("h3",{className:"font-semibold text-lg",children:X(me.name)}),f.jsxs("p",{className:"text-sm",children:["IP: ",me.ip_address]}),f.jsxs("p",{className:"text-sm",children:["Latitude: ",St]}),f.jsxs("p",{className:"text-sm",children:["Longitude: ",_t]}),f.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[f.jsxs("button",{onClick:Yt=>{Yt.preventDefault(),te(me.id)},className:`px-3 py-1 rounded-md text-white text-sm flex items-center gap-2 ${((Te=g[me.id])==null?void 0:Te.status)==="loading"?"bg-gray-400":((Pe=g[me.id])==null?void 0:Pe.status)==="online"?"bg-green-500":((he=g[me.id])==null?void 0:he.status)==="offline"?"bg-red-500":"bg-blue-500"}`,disabled:((Ue=g[me.id])==null?void 0:Ue.status)==="loading",children:[((We=g[me.id])==null?void 0:We.status)==="loading"?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((yt=g[me.id])==null?void 0:yt.status)==="online"?f.jsx(Sh,{className:"w-4 h-4"}):((Tt=g[me.id])==null?void 0:Tt.status)==="offline"?f.jsx(Eh,{className:"w-4 h-4"}):"Ping",((dt=g[me.id])==null?void 0:dt.status)==="online"&&g[me.id].responseTime&&f.jsxs("span",{children:[Math.round(g[me.id].responseTime||0),"ms"]})]}),!ee&&f.jsxs("button",{onClick:Yt=>{Yt.preventDefault(),J(me)},className:"px-3 py-1 rounded-md text-white text-sm bg-red-500 hover:bg-red-600 flex items-center gap-2",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Supprimer"]})]})]})})},me.id)}}return null})})]}),a&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1000]",onClick:()=>i(!1)}),f.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1001]",children:f.jsx(KM,{onClose:()=>i(!1),position:o,onSuccess:me=>{m(me),i(!1)},onError:me=>{d(me),i(!1)},onCamerasUpdate:me=>{n(me)}})})]}),Z&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1000]",onClick:()=>!ge&&J(null)}),f.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1001] bg-white rounded-lg p-6 w-96",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Confirmer la suppression"}),f.jsxs("div",{className:"mb-4",children:[f.jsx("p",{className:"text-gray-600 mb-2",children:"tes-vous sr de vouloir supprimer la camra suivante ?"}),f.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium",children:X(Z.name)}),f.jsxs("p",{className:"text-sm text-gray-500",children:["IP: ",Z.ip_address]}),Z.latitude&&Z.longitude&&f.jsxs("p",{className:"text-sm text-gray-500",children:["Position: ",Z.latitude,", ",Z.longitude]})]})]}),f.jsxs("div",{className:"flex justify-end space-x-3",children:[f.jsx("button",{onClick:()=>J(null),disabled:ge,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Annuler"}),f.jsx("button",{onClick:()=>q(Z),disabled:ge,className:`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 ${ge?"bg-red-400":"bg-red-600 hover:bg-red-700"}`,children:ge?f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Suppression..."]}):"Supprimer"})]})]})]}),u&&f.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[f.jsx("strong",{className:"font-bold",children:"Erreur! "}),f.jsx("span",{className:"block sm:inline",children:u}),u.includes("Trop de requtes")&&f.jsx("button",{className:"ml-4 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.location.reload(),children:"Ressayer"}),f.jsx("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>d(null),children:f.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[f.jsx("title",{children:"Close"}),f.jsx("path",{d:"M14.348 14.849a1 1 0 0 1-1.697 0L10 11.819l-2.651 3.029a1 1 0 1 0 1.697 1.414L10 13.515l2.651-3.029a1 1 0 0 1 1.697-1.697L10 11.819l2.651-3.031a1 1 0 1 0 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),h&&f.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",role:"alert",children:[f.jsx("strong",{className:"font-bold",children:"Succs! "}),f.jsx("span",{className:"block sm:inline",children:h}),f.jsx("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>m(null),children:f.jsxs("svg",{className:"fill-current h-6 w-6 text-green-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[f.jsx("title",{children:"Close"}),f.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1 1 0 1 0 1.697 1.697L10 13.515l2.651-3.029a1 1 0 0 0-1.697-1.697L10 11.819l2.651-3.031a1 1 0 1 0 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})]})};function _d(){const{id:e}=FT(),t=ya(),[r,n]=C.useState(""),[a,i]=C.useState(""),[o,l]=C.useState([]),[u,d]=C.useState([]),[h,m]=C.useState({name:"",description:""}),[g,x]=C.useState(null),[_,y]=C.useState(!1),[E,k]=C.useState(null),S=C.useRef(null),w=async()=>{try{const J=await di.getVariables();if(Array.isArray(J)){const ge=J.sort((_e,de)=>_e.name.localeCompare(de.name));l(ge)}else l([])}catch{k("Erreur lors du chargement des variables"),l([])}},A=async()=>{try{y(!0);const J=await Us.getTemplates();Array.isArray(J)?d(J):d([])}catch{k("Erreur lors du chargement des templates"),d([])}finally{y(!1)}};C.useEffect(()=>{e&&D(e),w(),A()},[e]);const D=async J=>{try{y(!0);const ge=await Us.getTemplate(parseInt(J)),_e=await di.getVariables();i(ge.name),n(ge.content),l(_e)}catch{k("Erreur lors du chargement du template")}finally{y(!1)}},R=J=>{if(S.current){const ge=S.current,_e=ge.selectionStart,de=ge.selectionEnd,Q=ge.value,ee=Q.substring(0,_e)+`{{ ${J} }}`+Q.substring(de);n(ee),setTimeout(()=>{ge.focus(),ge.setSelectionRange(_e+J.length+6,_e+J.length+6)},0)}},P=async()=>{if(!h.name||!h.description){k("Veuillez remplir tous les champs de la variable");return}try{y(!0);const J=await di.createVariable(h);e&&await di.addVariableToTemplate(parseInt(e),J.id),m({name:"",description:""}),await w()}catch{k("Erreur lors de l'ajout de la variable")}finally{y(!1)}},H=async J=>{try{y(!0),await di.deleteVariable(J),await w()}catch{k("Erreur lors de la suppression de la variable")}finally{y(!1)}},B=async()=>{if(!a){k("Veuillez donner un nom au template");return}try{y(!0);const J={name:a,content:r};e?await Us.updateTemplate(parseInt(e),J):await Us.createTemplate({...J,description:"",variables:[]}),t("/templates")}catch{k("Erreur lors de la sauvegarde du template")}finally{y(!1)}},W=async J=>{if(window.confirm("tes-vous sr de vouloir supprimer ce template ?"))try{y(!0),await Us.deleteTemplate(J),await A()}catch{k("Erreur lors de la suppression du template")}finally{y(!1)}},I=async J=>{try{y(!0);const ge=await Ve.get(`${Dt}/templates/${J}/download_excel/`,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),_e=new Blob([ge.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),de=window.URL.createObjectURL(_e),Q=document.createElement("a");Q.href=de,Q.download=`template_${J}_${new Date().toISOString()}.xlsx`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),window.URL.revokeObjectURL(de)}catch(ge){console.error("Error downloading Excel file:",ge),k("Failed to download Excel file")}finally{y(!1)}},Z=async()=>{y(!0);try{await Promise.all([w(),A()])}catch{k("Erreur lors du rafrachissement")}finally{y(!1)}};return _?f.jsx("div",{className:"p-8 flex items-center justify-center",children:f.jsx(nl,{className:"w-8 h-8 animate-spin text-purple-600"})}):f.jsxs("div",{className:"p-8",children:[f.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"Modifier le Template":"Nouveau Template"}),f.jsx("p",{className:"text-gray-600",children:"Crez et modifiez vos templates avec des variables dynamiques"})]}),f.jsx("button",{onClick:Z,disabled:_,className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",title:"Rafrachir",children:_?f.jsx(nl,{className:"w-5 h-5 animate-spin"}):f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})})]}),E&&f.jsx("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded-md",children:E}),f.jsxs("div",{className:"flex gap-6",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{htmlFor:"templateName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du Template"}),f.jsx("input",{id:"templateName",name:"templateName",type:"text",value:a,onChange:J=>i(J.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"Entrez le nom du template"})]}),f.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:f.jsx("textarea",{ref:S,value:r,onChange:J=>n(J.target.value),className:"w-full h-[500px] p-4 font-mono text-sm bg-gray-900 text-gray-100 border-0 focus:ring-0 resize-none",placeholder:"Entrez le contenu du template ici...",style:{lineHeight:"1.5",tabSize:2}})}),f.jsxs("div",{className:"mt-4 flex gap-4",children:[f.jsxs("button",{onClick:B,disabled:_,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:[_?f.jsx(nl,{className:"w-5 h-5 mr-2 animate-spin"}):f.jsx(p2,{className:"w-5 h-5 mr-2"}),_?"Enregistrement...":"Enregistrer"]}),f.jsxs("button",{onClick:()=>t("/templates"),className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[f.jsx(sb,{className:"w-5 h-5 mr-2"}),"Retour"]}),e&&f.jsxs("button",{onClick:()=>W(parseInt(e)),disabled:_,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:[f.jsx(An,{className:"w-5 h-5 mr-2"}),"Supprimer"]})]})]}),f.jsx("div",{className:"w-80",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Variables Disponibles"}),f.jsx("div",{className:"space-y-4 mb-6",children:o&&o.length>0?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"mb-4",children:[f.jsxs("h3",{className:"text-sm font-medium text-purple-600 mb-2 flex items-center",children:[f.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),"Variables Requises"]}),f.jsx("div",{className:"space-y-2",children:o.filter(J=>["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(J.name)).map(J=>f.jsxs("div",{className:"group relative",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 bg-purple-50 hover:bg-purple-100 rounded-md transition-colors duration-200",children:[f.jsx("button",{onClick:()=>R(J.name),className:"flex-1 text-left flex items-center",children:f.jsx("span",{className:"text-purple-700 font-medium",children:J.name})}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wh,{className:"w-4 h-4 text-purple-400"}),f.jsx("button",{onClick:()=>H(J.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:f.jsx(An,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===J.name&&f.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:J.description})]},`variable-${J.id||J.name}`))})]}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-sm font-medium text-gray-600 mb-2 flex items-center",children:[f.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),"Variables Personnalises"]}),f.jsx("div",{className:"space-y-2",children:o.filter(J=>!["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(J.name)).map(J=>f.jsxs("div",{className:"group relative",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 hover:bg-gray-100 rounded-md transition-colors duration-200",children:[f.jsx("button",{onClick:()=>R(J.name),className:"flex-1 text-left flex items-center",children:f.jsx("span",{className:"text-gray-700",children:J.name})}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(wh,{className:"w-4 h-4 text-gray-400"}),f.jsx("button",{onClick:()=>H(J.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:f.jsx(An,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===J.name&&f.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:J.description})]},`variable-${J.id||J.name}`))})]})]}):f.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucune variable disponible"})}),f.jsxs("div",{className:"border-t pt-4",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Ajouter une variable"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"variableName",className:"block text-sm text-gray-600 mb-1",children:"Nom de la variable"}),f.jsx("input",{id:"variableName",name:"variableName",type:"text",value:h.name,onChange:J=>m({...h,name:J.target.value}),placeholder:"Nom de la variable",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"variableDescription",className:"block text-sm text-gray-600 mb-1",children:"Description"}),f.jsx("input",{id:"variableDescription",name:"variableDescription",type:"text",value:h.description,onChange:J=>m({...h,description:J.target.value}),placeholder:"Description",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),f.jsxs("button",{onClick:P,disabled:_,className:"w-full flex items-center justify-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:[_?f.jsx(nl,{className:"w-4 h-4 mr-2 animate-spin"}):f.jsx(es,{className:"w-4 h-4 mr-2"}),"Ajouter"]})]})]}),f.jsxs("div",{className:"border-t mt-6 pt-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Templates"}),f.jsxs("button",{onClick:()=>t("/templates/new"),className:"flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm",children:[f.jsx(es,{className:"w-4 h-4 mr-1"}),"Nouveau"]})]}),f.jsx("div",{className:"space-y-3",children:_?f.jsx("div",{className:"flex justify-center py-4",children:f.jsx(nl,{className:"w-6 h-6 animate-spin text-purple-600"})}):u&&u.length>0?u.map(J=>f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 hover:bg-gray-100 rounded-md",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"font-medium text-gray-900",children:J.name}),f.jsxs("div",{className:"text-sm text-gray-500",children:["Cr le: ",J.created_at?new Date(J.created_at).toLocaleDateString():"N/A"]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>t(`/templates/${J.id}`),className:"p-1 text-blue-500 hover:text-blue-700",title:"Modifier",children:f.jsx(hb,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>I(J.id),className:"p-1 text-green-500 hover:text-green-700",title:"Tlcharger Excel",children:f.jsx(cb,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>W(J.id),className:"p-1 text-red-500 hover:text-red-700",title:"Supprimer",children:f.jsx(An,{className:"w-4 h-4"})})]})]},`template-${J.id}`)):f.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucun template disponible"})})]})]})})]})]})}function aj(){const e=ya(),[t,r]=C.useState(null),[n,a]=C.useState(!1),[i,o]=C.useState({}),[l,u]=C.useState(null),[d,h]=C.useState(null),[m,g]=C.useState(null),[x,_]=C.useState(!1),[y,E]=C.useState(null),[k,S]=C.useState(!1),[w,A]=C.useState({current_password:"",new_password:"",confirm_password:""});C.useEffect(()=>{(async()=>{try{const B=await Ot.get("/auth/users/me/");r(B.data),o(B.data),u(null)}catch(B){console.error("Error fetching user profile data:",B),u(B.message)}})()},[]);const D=async H=>{H.preventDefault();try{console.log("Updating user data:",i);const B=await Ot.put("/auth/users/update_user_info/",i);console.log("Update response:",B.data),B.data&&(r(B.data.user),a(!1),u(null))}catch(B){console.error("Error updating user data:",B),u(B.message)}},R=async H=>{var B,W;if(H.preventDefault(),h(null),g(null),w.new_password!==w.confirm_password){h("Les mots de passe ne correspondent pas");return}if(w.new_password.length<8){h("Le mot de passe doit contenir au moins 8 caractres");return}try{(await Ot.put("/auth/users/update_user_info/",{current_password:w.current_password,password:w.new_password})).data&&(g("Mot de passe mis  jour avec succs"),A({current_password:"",new_password:"",confirm_password:""}))}catch(I){console.error("Error updating password:",I),h(((W=(B=I.response)==null?void 0:B.data)==null?void 0:W.error)||"Erreur lors de la mise  jour du mot de passe")}},P=async()=>{var H,B;S(!0),E(null);try{await Ot.delete("/auth/users/me/"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e("/login")}catch(W){console.error("Error deleting profile:",W),E(((B=(H=W.response)==null?void 0:H.data)==null?void 0:B.error)||"Erreur lors de la suppression du profil"),_(!1)}finally{S(!1)}};return l?f.jsx("div",{className:"max-w-2xl mx-auto p-6",children:f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:f.jsxs("p",{className:"text-red-600",children:["Error: ",l]})})}):t?f.jsx("div",{className:"max-w-2xl mx-auto p-6",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[f.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[f.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:f.jsx(ko,{className:"h-8 w-8 text-purple-600"})}),f.jsxs("div",{children:[f.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[t.first_name," ",t.last_name]}),f.jsxs("p",{className:"text-gray-600",children:["@",t.username]})]})]}),f.jsxs("form",{onSubmit:D,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),f.jsxs("div",{className:"mt-1 flex items-center",children:[f.jsx(ko,{className:"h-5 w-5 text-gray-400 mr-2"}),f.jsx("input",{type:"text",value:i.username||"",onChange:H=>o({...i,username:H.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),f.jsx("input",{type:"text",value:i.first_name||"",onChange:H=>o({...i,first_name:H.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),f.jsx("input",{type:"text",value:i.last_name||"",onChange:H=>o({...i,last_name:H.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),f.jsxs("div",{className:"mt-1 flex items-center",children:[f.jsx(f2,{className:"h-5 w-5 text-gray-400 mr-2"}),f.jsx("input",{type:"email",value:i.email||"",onChange:H=>o({...i,email:H.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),f.jsxs("div",{className:"mt-1 flex items-center",children:[f.jsx(h2,{className:"h-5 w-5 text-gray-400 mr-2"}),f.jsx("input",{type:"tel",value:i.phone_number||"",onChange:H=>o({...i,phone_number:H.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),f.jsx("div",{className:"flex justify-end space-x-4 mt-6",children:n?f.jsxs(f.Fragment,{children:[f.jsx("button",{type:"button",onClick:()=>{a(!1),o(t)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),f.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[f.jsx(p2,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}):f.jsx("button",{type:"button",onClick:()=>a(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Edit Profile"})})]}),f.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[f.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),f.jsxs("form",{onSubmit:R,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),f.jsxs("div",{className:"mt-1 flex items-center",children:[f.jsx(gi,{className:"h-5 w-5 text-gray-400 mr-2"}),f.jsx("input",{type:"password",value:w.current_password,onChange:H=>A({...w,current_password:H.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),f.jsxs("div",{className:"mt-1 flex items-center",children:[f.jsx(gi,{className:"h-5 w-5 text-gray-400 mr-2"}),f.jsx("input",{type:"password",value:w.new_password,onChange:H=>A({...w,new_password:H.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),f.jsxs("div",{className:"mt-1 flex items-center",children:[f.jsx(gi,{className:"h-5 w-5 text-gray-400 mr-2"}),f.jsx("input",{type:"password",value:w.confirm_password,onChange:H=>A({...w,confirm_password:H.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),d&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:f.jsx("p",{className:"text-red-600",children:d})}),m&&f.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:f.jsx("p",{className:"text-green-600",children:m})}),f.jsx("div",{className:"flex justify-end",children:f.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[f.jsx(gi,{className:"h-4 w-4 mr-2"}),"Change Password"]})})]})]}),f.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[f.jsx("h2",{className:"text-lg font-medium text-red-600 mb-4",children:"Zone de danger"}),f.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[f.jsx("p",{className:"text-red-600 mb-4",children:"La suppression de votre compte est irrversible. Toutes vos donnes seront dfinitivement supprimes."}),f.jsxs("button",{onClick:()=>_(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center",children:[f.jsx(An,{className:"h-4 w-4 mr-2"}),"Supprimer mon compte"]})]})]}),x&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[f.jsx("h3",{className:"text-lg font-medium text-red-600 mb-4",children:"Confirmer la suppression"}),f.jsx("p",{className:"text-gray-600 mb-4",children:"tes-vous sr de vouloir supprimer votre compte ? Cette action est irrversible."}),y&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:f.jsx("p",{className:"text-red-600",children:y})}),f.jsxs("div",{className:"flex justify-end space-x-4",children:[f.jsx("button",{onClick:()=>_(!1),disabled:k,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Annuler"}),f.jsx("button",{onClick:P,disabled:k,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center disabled:opacity-50",children:k?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Suppression en cours..."]}):f.jsxs(f.Fragment,{children:[f.jsx(An,{className:"h-4 w-4 mr-2"}),"Confirmer la suppression"]})})]})]})})]})}):f.jsx("div",{className:"max-w-2xl mx-auto p-6",children:f.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:f.jsxs("div",{className:"animate-pulse",children:[f.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"h-4 bg-gray-200 rounded"}),f.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]})})})}const Ek=6048e5,ij=864e5,iv=Symbol.for("constructDateFrom");function Oi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&iv in e?e[iv](t):e instanceof Date?new e.constructor(t):new Date(t)}function na(e,t){return Oi(t||e,e)}let sj={};function o0(){return sj}function ac(e,t){var l,u,d,h;const r=o0(),n=(t==null?void 0:t.weekStartsOn)??((u=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((h=(d=r.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,a=na(e,t==null?void 0:t.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Af(e,t){return ac(e,{...t,weekStartsOn:1})}function Sk(e,t){const r=na(e,t==null?void 0:t.in),n=r.getFullYear(),a=Oi(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=Af(a),o=Oi(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Af(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function sv(e){const t=na(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function oj(e,...t){const r=Oi.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function ov(e,t){const r=na(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function lj(e,t,r){const[n,a]=oj(r==null?void 0:r.in,e,t),i=ov(n),o=ov(a),l=+i-sv(i),u=+o-sv(o);return Math.round((l-u)/ij)}function cj(e,t){const r=Sk(e,t),n=Oi(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Af(n)}function uj(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function fj(e){return!(!uj(e)&&typeof e!="number"||isNaN(+na(e)))}function dj(e,t){const r=na(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const hj={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pj=(e,t,r)=>{let n;const a=hj[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function po(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const mj={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},gj={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},xj={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vj={date:po({formats:mj,defaultWidth:"full"}),time:po({formats:gj,defaultWidth:"full"}),dateTime:po({formats:xj,defaultWidth:"full"})},_j={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yj=(e,t,r,n)=>_j[e];function ma(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const wj={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},kj={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ej={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Sj={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Tj={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Cj={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bj=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Nj={ordinalNumber:bj,era:ma({values:wj,defaultWidth:"wide"}),quarter:ma({values:kj,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ma({values:Ej,defaultWidth:"wide"}),day:ma({values:Sj,defaultWidth:"wide"}),dayPeriod:ma({values:Tj,defaultWidth:"wide",formattingValues:Cj,defaultFormattingWidth:"wide"})};function ga(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(l)?Lj(l,m=>m.test(o)):Aj(l,m=>m.test(o));let d;d=e.valueCallback?e.valueCallback(u):u,d=r.valueCallback?r.valueCallback(d):d;const h=t.slice(o.length);return{value:d,rest:h}}}function Aj(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Lj(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Tk(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const Pj=/^(\d+)(th|st|nd|rd)?/i,Fj=/\d+/i,Oj={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Mj={any:[/^b/i,/^(a|c)/i]},jj={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Rj={any:[/1/i,/2/i,/3/i,/4/i]},Dj={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ij={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Bj={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},zj={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Uj={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Hj={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Vj={ordinalNumber:Tk({matchPattern:Pj,parsePattern:Fj,valueCallback:e=>parseInt(e,10)}),era:ga({matchPatterns:Oj,defaultMatchWidth:"wide",parsePatterns:Mj,defaultParseWidth:"any"}),quarter:ga({matchPatterns:jj,defaultMatchWidth:"wide",parsePatterns:Rj,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ga({matchPatterns:Dj,defaultMatchWidth:"wide",parsePatterns:Ij,defaultParseWidth:"any"}),day:ga({matchPatterns:Bj,defaultMatchWidth:"wide",parsePatterns:zj,defaultParseWidth:"any"}),dayPeriod:ga({matchPatterns:Uj,defaultMatchWidth:"any",parsePatterns:Hj,defaultParseWidth:"any"})},Wj={code:"en-US",formatDistance:pj,formatLong:vj,formatRelative:yj,localize:Nj,match:Vj,options:{weekStartsOn:0,firstWeekContainsDate:1}};function $j(e,t){const r=na(e,t==null?void 0:t.in);return lj(r,dj(r))+1}function Gj(e,t){const r=na(e,t==null?void 0:t.in),n=+Af(r)-+cj(r);return Math.round(n/Ek)+1}function Ck(e,t){var h,m,g,x;const r=na(e,t==null?void 0:t.in),n=r.getFullYear(),a=o0(),i=(t==null?void 0:t.firstWeekContainsDate)??((m=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((x=(g=a.locale)==null?void 0:g.options)==null?void 0:x.firstWeekContainsDate)??1,o=Oi((t==null?void 0:t.in)||e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=ac(o,t),u=Oi((t==null?void 0:t.in)||e,0);u.setFullYear(n,0,i),u.setHours(0,0,0,0);const d=ac(u,t);return+r>=+l?n+1:+r>=+d?n:n-1}function Zj(e,t){var l,u,d,h;const r=o0(),n=(t==null?void 0:t.firstWeekContainsDate)??((u=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((h=(d=r.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,a=Ck(e,t),i=Oi((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),ac(i,t)}function qj(e,t){const r=na(e,t==null?void 0:t.in),n=+ac(r,t)-+Zj(r,t);return Math.round(n/Ek)+1}function kt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const ii={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return kt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):kt(r+1,2)},d(e,t){return kt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return kt(e.getHours()%12||12,t.length)},H(e,t){return kt(e.getHours(),t.length)},m(e,t){return kt(e.getMinutes(),t.length)},s(e,t){return kt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return kt(a,t.length)}},Bs={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},lv={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return ii.y(e,t)},Y:function(e,t,r,n){const a=Ck(e,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return kt(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):kt(i,t.length)},R:function(e,t){const r=Sk(e);return kt(r,t.length)},u:function(e,t){const r=e.getFullYear();return kt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return kt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return kt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return ii.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return kt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=qj(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):kt(a,t.length)},I:function(e,t,r){const n=Gj(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):kt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ii.d(e,t)},D:function(e,t,r){const n=$j(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):kt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return kt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return kt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return kt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Bs.noon:n===0?a=Bs.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Bs.evening:n>=12?a=Bs.afternoon:n>=4?a=Bs.morning:a=Bs.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ii.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ii.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):kt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):kt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ii.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ii.s(e,t)},S:function(e,t){return ii.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return uv(n);case"XXXX":case"XX":return Zi(n);case"XXXXX":case"XXX":default:return Zi(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return uv(n);case"xxxx":case"xx":return Zi(n);case"xxxxx":case"xxx":default:return Zi(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+cv(n,":");case"OOOO":default:return"GMT"+Zi(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+cv(n,":");case"zzzz":default:return"GMT"+Zi(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return kt(n,t.length)},T:function(e,t,r){return kt(+e,t.length)}};function cv(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+kt(i,2)}function uv(e,t){return e%60===0?(e>0?"-":"+")+kt(Math.abs(e)/60,2):Zi(e,t)}function Zi(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=kt(Math.trunc(n/60),2),i=kt(n%60,2);return r+a+t+i}const fv=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},bk=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Xj=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return fv(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",fv(n,t)).replace("{{time}}",bk(a,t))},Yj={p:bk,P:Xj},Kj=/^D+$/,Jj=/^Y+$/,Qj=["D","DD","YY","YYYY"];function eR(e){return Kj.test(e)}function tR(e){return Jj.test(e)}function rR(e,t,r){const n=nR(e,t,r);if(console.warn(n),Qj.includes(e))throw new RangeError(n)}function nR(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const aR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,iR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,sR=/^'([^]*?)'?$/,oR=/''/g,lR=/[a-zA-Z]/;function cR(e,t,r){var h,m,g,x,_,y,E,k;const n=o0(),a=(r==null?void 0:r.locale)??n.locale??Wj,i=(r==null?void 0:r.firstWeekContainsDate)??((m=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((y=(_=r==null?void 0:r.locale)==null?void 0:_.options)==null?void 0:y.weekStartsOn)??n.weekStartsOn??((k=(E=n.locale)==null?void 0:E.options)==null?void 0:k.weekStartsOn)??0,l=na(e,r==null?void 0:r.in);if(!fj(l))throw new RangeError("Invalid time value");let u=t.match(iR).map(S=>{const w=S[0];if(w==="p"||w==="P"){const A=Yj[w];return A(S,a.formatLong)}return S}).join("").match(aR).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const w=S[0];if(w==="'")return{isToken:!1,value:uR(S)};if(lv[w])return{isToken:!0,value:S};if(w.match(lR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(u=a.localize.preprocessor(l,u));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return u.map(S=>{if(!S.isToken)return S.value;const w=S.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&tR(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&eR(w))&&rR(w,t,String(e));const A=lv[w[0]];return A(l,w,a.localize,d)}).join("")}function uR(e){const t=e.match(sR);return t?t[1].replace(oR,"'"):e}const fR={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},dR=(e,t,r)=>{let n;const a=fR[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},hR={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},pR={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},mR={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gR={date:po({formats:hR,defaultWidth:"full"}),time:po({formats:pR,defaultWidth:"full"}),dateTime:po({formats:mR,defaultWidth:"full"})},xR={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},vR=(e,t,r,n)=>xR[e],_R={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},yR={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},wR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},kR={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},ER={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},SR=(e,t)=>{const r=Number(e),n=t==null?void 0:t.unit;if(r===0)return"0";const a=["year","week","hour","minute","second"];let i;return r===1?i=n&&a.includes(n)?"re":"er":i="me",r+i},TR=["MMM","MMMM"],CR={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&TR.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:SR,era:ma({values:_R,defaultWidth:"wide"}),quarter:ma({values:yR,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ma({values:wR,defaultWidth:"wide"}),day:ma({values:kR,defaultWidth:"wide"}),dayPeriod:ma({values:ER,defaultWidth:"wide"})},bR=/^(\d+)(ime|re|me|er|e)?/i,NR=/\d+/i,AR={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},LR={any:[/^av/i,/^ap/i]},PR={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},FR={any:[/1/i,/2/i,/3/i,/4/i]},OR={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},MR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},jR={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},RR={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},DR={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},IR={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},BR={ordinalNumber:Tk({matchPattern:bR,parsePattern:NR,valueCallback:e=>parseInt(e)}),era:ga({matchPatterns:AR,defaultMatchWidth:"wide",parsePatterns:LR,defaultParseWidth:"any"}),quarter:ga({matchPatterns:PR,defaultMatchWidth:"wide",parsePatterns:FR,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ga({matchPatterns:OR,defaultMatchWidth:"wide",parsePatterns:MR,defaultParseWidth:"any"}),day:ga({matchPatterns:jR,defaultMatchWidth:"wide",parsePatterns:RR,defaultParseWidth:"any"}),dayPeriod:ga({matchPatterns:DR,defaultMatchWidth:"any",parsePatterns:IR,defaultParseWidth:"any"})},zR={code:"fr",formatDistance:dR,formatLong:gR,formatRelative:vR,localize:CR,match:BR,options:{weekStartsOn:1,firstWeekContainsDate:4}},UR=()=>{const[e,t]=C.useState(null),[r,n]=C.useState(!0),[a,i]=C.useState(null),[o,l]=C.useState(null),u=k=>{switch(k.toLowerCase()){case"firewall":return f.jsx(ms,{className:"h-5 w-5 text-purple-600"});case"data_center":return f.jsx(mc,{className:"h-5 w-5 text-blue-600"});case"firewall_type":return f.jsx(gc,{className:"h-5 w-5 text-green-600"});case"command":return f.jsx(gb,{className:"h-5 w-5 text-yellow-600"});case"config":return f.jsx(kh,{className:"h-5 w-5 text-indigo-600"});case"auth":return f.jsx(gi,{className:"h-5 w-5 text-red-600"});default:return f.jsx(kh,{className:"h-5 w-5 text-gray-600"})}},d=k=>({firewall:"Pare-feu",data_center:"Centre de donnes",firewall_type:"Type de pare-feu",command:"Commandes",config:"Configuration",auth:"Authentification"})[k]||k,h=k=>{try{return cR(new Date(k),"PPpp",{locale:zR})}catch{return k}},m=k=>k.includes("create")?"bg-green-100 text-green-800":k.includes("update")?"bg-blue-100 text-blue-800":k.includes("delete")?"bg-red-100 text-red-800":k.includes("status")?"bg-yellow-100 text-yellow-800":k.includes("restore")?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800",g=k=>({firewall_create:"Cration de pare-feu",firewall_update:"Modification de pare-feu",firewall_delete:"Suppression de pare-feu",firewall_type_create:"Cration de type de pare-feu",firewall_type_update:"Modification de type de pare-feu",firewall_type_delete:"Suppression de type de pare-feu",create:"Cration",update:"Modification",delete:"Suppression",add:"Ajout",remove:"Suppression",edit:"Modification",execute:"Excution",save:"Sauvegarde",restore:"Restauration",download:"Tlchargement",ping:"Test de connectivit",login:"Connexion",logout:"Dconnexion",password_change:"Changement de mot de passe",ssh_key_update:"Mise  jour de cl SSH"})[k.toLowerCase()]||k,x=(k,S,w)=>{const A=(w==null?void 0:w.name)||k||"Unknown";return A==="Unknown"?S:A},_=k=>typeof k=="string"?k:typeof k=="object"?JSON.stringify(k,null,2):String(k),y=()=>{if(!e||!e.services)return[];const k=[];return Object.entries(e.services).forEach(([S,w])=>{w.actions.forEach(A=>{k.push({...A,serviceType:S})})}),k.sort((S,w)=>new Date(w.timestamp).getTime()-new Date(S.timestamp).getTime())};if(C.useEffect(()=>{let k=!0;return(async()=>{try{if(n(!0),!ha())throw new Error("No authentication token found");const A=await Ot.get("/history/");k&&(t(A.data),n(!1))}catch(w){k&&(console.error("Error fetching history:",w),i("Failed to load history data"),n(!1))}})(),()=>{k=!1}},[]),r)return f.jsx("div",{className:"flex items-center justify-center h-screen",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})});if(a)return f.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[f.jsxs("div",{className:"mb-8",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mon Historique"}),f.jsx("p",{className:"text-gray-600",children:"Consultez l'historique de vos actions"})]}),f.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4",children:a})]});const E=y();return E.length===0?f.jsxs("div",{className:"text-center py-16",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mb-4",children:f.jsx(hf,{className:"h-8 w-8 text-gray-400"})}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune action rcente"}),f.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:"Votre historique d'actions apparatra ici."})]}):f.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[f.jsxs("div",{className:"mb-8",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mon Historique"}),f.jsx("p",{className:"text-gray-600",children:"Historique de vos actions sur les services"})]}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:E.map(k=>f.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[f.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>l(o===k.id?null:k.id),children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[u(k.serviceType),f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m(k.action)}`,children:g(k.action)}),f.jsx("span",{className:"text-sm font-medium text-gray-900",children:x(k.entity_name,k.action,k.details)}),f.jsx("span",{className:"text-sm text-gray-500",children:d(k.serviceType)})]}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[f.jsx(hf,{className:"h-4 w-4 mr-1"}),h(k.timestamp)]}),o===k.id?f.jsx(lb,{className:"h-5 w-5 text-gray-500"}):f.jsx(ff,{className:"h-5 w-5 text-gray-500"})]})]})}),o===k.id&&f.jsx("div",{className:"px-4 pb-4 bg-gray-50",children:f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx(wh,{className:"h-5 w-5 text-gray-400 mt-0.5"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Dtails de l'action"}),f.jsx("pre",{className:"text-sm text-gray-600 whitespace-pre-wrap bg-white p-3 rounded-lg border border-gray-200",children:_(k.details)})]})]})})]},k.id))})]})},HR=()=>localStorage.getItem("token"),Ma=Ve.create({baseURL:Dt});Ma.interceptors.request.use(e=>{const t=HR();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ma.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function VR(){ya();const[e,t]=C.useState(!1),[r,n]=C.useState(null),[a,i]=C.useState(null),[o,l]=C.useState([]),[u,d]=C.useState([]),[h,m]=C.useState(`config global
get system status
diagnose autoupdate versions
get hardware memory`),[g,x]=C.useState([]),[_,y]=C.useState(""),[E,k]=C.useState("");C.useEffect(()=>{(async()=>{try{t(!0),n(null);const I=await Ma.get("/datacenters/hierarchy/");x(I.data)}catch(I){console.error("Error fetching hierarchy:",I),n("Failed to fetch hierarchy data")}finally{t(!1)}})()},[]),C.useEffect(()=>{(async()=>{try{const I=await Ma.get("/daily-check/daily-checks/");d(I.data.results||[])}catch(I){console.error("Error fetching daily checks:",I),d([])}})()},[]);const S=()=>{if(!_)return[];const W=g.find(I=>I.id===_);return W?W.firewall_types:[]},w=()=>{if(!E)return[];const W=g.find(Z=>Z.id===_);if(!W)return[];const I=W.firewall_types.find(Z=>Z.id===E);return I?I.firewalls:[]},A=W=>{const I=W.target.value;y(I),k(""),l([])},D=W=>{const I=W.target.value;k(I),l([])},R=()=>{const W=w();o.length===W.length?l([]):l(W.map(I=>I.id))},P=W=>{l(I=>I.includes(W)?I.filter(Z=>Z!==W):[...I,W])},H=async()=>{if(!o.length){n("Please select at least one firewall");return}if(!h.trim()){n("Please enter at least one command");return}t(!0),n(null),i(null);try{const W=h.split(`
`).filter(Z=>Z.trim()),I=await Ma.post("/daily-check/daily-checks/run_multiple_checks/",{firewalls:o,commands:W});if(I.data.status==="success"){i("Daily checks started. You can leave this page, the checks will continue in the background.");const Z=I.data.task_id,J=setInterval(async()=>{try{const _e=(await Ma.get(`/daily-check/daily-checks/check_task_status/?task_id=${Z}`)).data;if(i(`${_e.message} (${_e.progress}%)`),_e.status==="completed"){clearInterval(J),i("All daily checks completed successfully");const de=await Ma.get("/daily-check/daily-checks/");if(d(de.data.results||[]),_e.results&&_e.results.length>0){const Q=[...new Set(_e.results.filter(ee=>ee.success&&ee.report_path).map(ee=>ee.report_path))];for(const ee of Q)try{const U=await Ma.get("/daily-check/daily-checks/download_multiple_reports/",{responseType:"blob",params:{report_path:ee}}),ne=new Blob([U.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ue=window.URL.createObjectURL(ne),F=document.createElement("a");F.href=ue,F.setAttribute("download",`daily_check_${new Date().toISOString()}.xlsx`),document.body.appendChild(F),F.click(),document.body.removeChild(F),window.URL.revokeObjectURL(ue)}catch(U){console.error("Error downloading report:",U),kr.error(`Failed to download report from ${ee}`)}}}else _e.status==="failed"&&(clearInterval(J),n(`Daily checks failed: ${_e.message}`))}catch(ge){console.error("Error checking task status:",ge),clearInterval(J),n("Failed to check task status")}},2e3);return()=>clearInterval(J)}else n("Failed to start daily checks")}catch(W){console.error("Error during daily check:",W),n("Failed to start daily checks")}finally{t(!1)}},B=async W=>{try{const I=await Ma.get(`/daily-check/daily-checks/${W}/download_report/`,{responseType:"blob"}),Z=new Blob([I.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),J=window.URL.createObjectURL(Z),ge=document.createElement("a");ge.href=J;const _e=I.headers["content-disposition"];let de="daily_check_report.xlsx";if(_e){const Q=_e.match(/filename="(.+)"/);Q&&(de=Q[1])}ge.setAttribute("download",de),document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),window.URL.revokeObjectURL(J)}catch(I){console.error("Error downloading report:",I),kr.error("Failed to download report")}};return e?f.jsx("div",{className:"p-8",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):f.jsxs("div",{className:"p-8",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall"}),f.jsx("p",{className:"text-gray-600 mb-6",children:"Daily Check"}),f.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(mc,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),f.jsxs("select",{value:_,onChange:A,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[f.jsx("option",{value:"",children:"All data centers"}),g.map(W=>f.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(ms,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),f.jsxs("select",{value:E,onChange:D,disabled:!_,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${_?"":"bg-gray-100"}`,children:[f.jsx("option",{value:"",children:"Select a firewall type"}),S().map(W=>f.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(gc,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),f.jsxs("div",{className:"mt-1 space-y-2",children:[f.jsx("button",{onClick:R,disabled:!E,className:`w-full px-3 py-1 text-sm rounded-md ${o.length===w().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${E?"":"opacity-50 cursor-not-allowed"}`,children:o.length===w().length?"Deselect All":"Select All"}),f.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:w().map(W=>f.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${o.includes(W.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>P(W.id),children:[f.jsx("input",{type:"checkbox",checked:o.includes(W.id),onChange:()=>P(W.id),className:"mr-2"}),f.jsxs("span",{className:"text-sm",children:[W.name," - ",W.ip_address]})]},W.id))})]})]})]})]}),f.jsx("div",{className:"mt-6",children:f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[f.jsx(pf,{className:"h-6 w-6 text-purple-600"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Commands (one per line)"}),f.jsx("textarea",{value:h,onChange:W=>m(W.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",rows:5,placeholder:"Enter commands (one per line)"})]})]})})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[r&&f.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md mb-4",children:r}),a&&f.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md mb-4",children:a}),f.jsx("div",{className:"flex space-x-4",children:f.jsxs("button",{onClick:H,disabled:e||!o.length,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[f.jsx(Zp,{className:"h-5 w-5 mr-2"}),e?"Running...":"Run Daily Check"]})})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[f.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Daily Checks History"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Firewall"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(W=>{var J,ge;const I=(ge=(J=W.historique_dailycheck)==null?void 0:J.entries)==null?void 0:ge[W.historique_dailycheck.entries.length-1],Z=(I==null?void 0:I.user)||"Unknown";return f.jsxs("tr",{children:[f.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[f.jsx("div",{className:"text-sm font-medium text-gray-900",children:W.firewall.name}),f.jsx("div",{className:"text-sm text-gray-500",children:W.firewall.ip_address})]}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsx("div",{className:"text-sm text-gray-900",children:Z})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsx("div",{className:"text-sm text-gray-900",children:new Date(W.check_date).toLocaleString()})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${W.status==="SUCCESS"?"bg-green-100 text-green-800":W.status==="FAILED"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:W.status})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:W.excel_report&&f.jsxs("button",{onClick:()=>B(W.id),className:"text-purple-600 hover:text-purple-900 flex items-center",children:[f.jsx(pf,{className:"h-4 w-4 mr-1"}),"Download Report"]})})]},W.id)})})]})})]})]})}delete Er.Icon.Default.prototype._getIconUrl;Er.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const Hs=Ve.create({baseURL:Dt,headers:{"Content-Type":"application/json",Accept:"application/json"}});Hs.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const dv=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),WR=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#ef4444" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),$R=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#f97316" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),GR=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#22c55e" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),ZR=`
  .custom-datacenter-icon {
    background: none;
    border: none;
  }
  .custom-datacenter-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-datacenter-icon:hover svg {
    transform: scale(1.1);
  }
  .leaflet-popup-content-wrapper {
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  .leaflet-popup-content {
    margin: 0;
    min-width: 300px;
    max-width: 500px;
  }
  .datacenter-popup-content {
    padding: 1rem;
    min-width: 300px;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    background: white;
    border-radius: 8px;
  }
`,qR=()=>{const[e,t]=C.useState([]),[r,n]=C.useState({}),[a,i]=C.useState({}),[o,l]=C.useState({}),[u,d]=C.useState(null),[h,m]=C.useState(!1),g=C.useRef(null),{token:x}=Fm(),[_,y]=C.useState("all"),[E,k]=C.useState(""),[S,w]=C.useState(!1),[A,D]=C.useState({}),R=Q=>{D(ee=>({...ee,[Q]:!ee[Q]}))};C.useEffect(()=>{const Q=document.createElement("style");return Q.innerText=ZR,document.head.appendChild(Q),()=>{document.head.removeChild(Q)}},[]);const P=Q=>{d(Q),g.current&&clearTimeout(g.current),g.current=window.setTimeout(()=>{window.location.reload()},3e3)};C.useEffect(()=>{console.log("Starting authentication check...");const Q=localStorage.getItem("token");if(!Q){console.log("No token found"),P("Please login to access this page");return}return console.log("Token found, verifying..."),Hs.get("/datacenters/",{headers:{Authorization:`Bearer ${Q}`,"Content-Type":"application/json",Accept:"application/json"}}).then(()=>{console.log("Token verified successfully"),m(!0)}).catch(ee=>{var U;console.error("Token verification failed:",ee),Ve.isAxiosError(ee)&&(((U=ee.response)==null?void 0:U.status)===401?(P("Session expired. Please login again."),localStorage.removeItem("token"),window.location.href="/login"):d("Server connection error"))}),()=>{g.current&&clearTimeout(g.current)}},[]),C.useEffect(()=>{console.log("Map initialization effect running, isInitialized:",h),h&&(console.log("Setting default marker icon"),Er.Marker.prototype.options.icon=dv)},[h]),C.useEffect(()=>{if(console.log("Fetch datacenters effect running, isInitialized:",h),!h)return;(async()=>{var ee;try{console.log("Starting to fetch datacenters...");const U=localStorage.getItem("token");if(!U){console.log("No token found during fetch"),d("Token not found. Please login again.");return}const ne=await Hs.get("/datacenters/",{headers:{Authorization:`Bearer ${U}`,"Content-Type":"application/json",Accept:"application/json"}});console.log("Raw API response:",ne.data),ne.data.results?(console.log("Setting datacenters:",ne.data.results),t(ne.data.results),ne.data.results.forEach(ue=>{H(ue.id)})):(console.log("No results in API response"),t([]))}catch(U){console.error("Error fetching datacenters:",U),Ve.isAxiosError(U)&&(((ee=U.response)==null?void 0:ee.status)===401?(d("Session expired. Please login again."),localStorage.removeItem("token"),window.location.href="/login"):d("Error loading datacenters")),t([])}})()},[h]),C.useEffect(()=>{console.log("Datacenters state updated:",e)},[e]);const H=async Q=>{var ee;try{l(ue=>({...ue,[Q]:!0}));const U=localStorage.getItem("token");if(!U){d("Token not found. Please login again.");return}const ne=await Hs.get("/datacenters/hierarchy/",{headers:{Authorization:`Bearer ${U}`,"Content-Type":"application/json",Accept:"application/json"}});if(ne.data){const ue=ne.data.find(F=>F.id===Q);ue&&ue.firewall_types?(console.log(`Datacenter found in hierarchy (ID: ${Q}):`,ue),n(F=>({...F,[Q]:ue.firewall_types}))):(console.warn(`Datacenter with ID ${Q} not found or has no firewall types in hierarchy.`,ne.data),n(F=>({...F,[Q]:[]})))}}catch(U){console.error("Error fetching firewall types:",U),Ve.isAxiosError(U)&&((ee=U.response)==null?void 0:ee.status)===401?(d("Session expired. Please login again."),localStorage.removeItem("token"),window.location.href="/login"):d("Error fetching firewall types")}finally{l(U=>({...U,[Q]:!1}))}},B=C.useMemo(()=>e.filter(Q=>_==="all"?!0:_==="online"?Q.is_active:_==="offline"?!Q.is_active:!1),[e,_]),W=(Q,ee,U)=>{const ne=ee[Q]||[];let ue=0,F=0,te=!1;return ne.forEach(q=>{var X;(X=q.firewalls)==null||X.forEach(K=>{const ye=U[K.id];ye&&!_e(ye.lastUpdate)?(ue++,ye.status==="online"&&F++):te=!0})}),ue===0||te?"unknown":F===ue?"online":F===0?"offline":"partial"},I=C.useCallback(Q=>{switch(W(Q,r,a)){case"online":return GR;case"offline":return WR;case"partial":return $R;default:return dv}},[r,a]),Z=C.useCallback(Q=>{H(Q.id)},[H]),J=C.useCallback(async Q=>{var ee;if(((ee=a[Q])==null?void 0:ee.status)!=="loading")try{i(ue=>({...ue,[Q]:{status:"loading",responseTime:null}}));const U=await Hs.post(`/firewalls/${Q}/ping/`);if(console.log(`Ping response for firewall ${Q}:`,U.data),!U.data)throw new Error("Invalid response from server");if(console.log("Response data details:",{status:U.data.status,response_time:U.data.response_time,message:U.data.message}),U.data.status==="error"){console.log("Error status detected, setting firewall to offline"),i(ue=>({...ue,[Q]:{status:"offline",responseTime:null,lastUpdate:Date.now(),error:U.data.message||"Connection failed"}}));return}const ne=U.data.status==="online"?"online":"offline";console.log("Status determination:",{firewallId:Q,status:ne,responseTime:U.data.response_time}),i(ue=>({...ue,[Q]:{status:ne,responseTime:U.data.response_time,lastUpdate:Date.now(),error:U.data.message||void 0}}))}catch(U){console.error(`Error pinging firewall ${Q}:`,U),i(ne=>({...ne,[Q]:{status:"offline",responseTime:null,lastUpdate:Date.now(),error:U instanceof Error?U.message:"Connection failed"}}))}},[a]),ge=C.useCallback(async()=>{if(!x){d("Please login to perform this action.");return}w(!0);try{const Q=await Hs.post("/firewalls/ping_all/");if(console.log("Ping all response:",Q.data),Q.data&&Q.data.results){const ee={};Q.data.results.forEach(U=>{ee[U.id]={status:U.status==="online"?"online":"offline",responseTime:U.response_time,lastUpdate:Date.now(),error:U.message}}),i(U=>({...U,...ee})),console.log("Ping statistics:",{total:Q.data.total,online:Q.data.online,offline:Q.data.offline,errors:Q.data.errors})}}catch(Q){console.error("Error pinging all firewalls:",Q),d("Error pinging all firewalls")}finally{w(!1)}},[x]),_e=Q=>Q?Date.now()-Q>5*60*1e3:!0,de=C.useMemo(()=>B.map(Q=>{if(!Q.latitude||!Q.longitude)return null;const ee=parseFloat(Q.latitude.toString()),U=parseFloat(Q.longitude.toString());if(isNaN(ee)||isNaN(U))return null;const ne=W(Q.id,r,a);return f.jsx(gk,{position:[ee,U],icon:I(Q.id),eventHandlers:{click:()=>Z(Q)},children:f.jsx(xk,{children:f.jsxs("div",{className:"datacenter-popup-content",children:[f.jsxs("div",{className:"border-b border-gray-200 pb-3 mb-4",children:[f.jsxs("h3",{className:"font-semibold text-lg text-purple-700 flex items-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.5L20 8v8l-8 4-8-4V8l8-3.5z",fill:"currentColor"})}),Q.name]}),Q.location&&f.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[f.jsx("span",{className:"font-medium",children:"Adresse:"})," ",Q.location]}),f.jsx("div",{className:"mt-2",children:f.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ne==="online"?"bg-green-100 text-green-800":ne==="offline"?"bg-red-100 text-red-800":ne==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:ne==="online"?"Actif":ne==="offline"?"Inactif":ne==="partial"?"Partiellement Actif":"Statut Inconnu"})})]}),f.jsxs("div",{className:"mt-4",children:[f.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-3 flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),"Types de Firewall"]}),o[Q.id]?f.jsxs("div",{className:"flex items-center justify-center py-4",children:[f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-purple-500 border-t-transparent"}),f.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Chargement des firewalls..."})]}):r[Q.id]?f.jsx("div",{className:"space-y-3",children:r[Q.id].map(ue=>f.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[f.jsx("div",{className:"bg-purple-50 p-3 border-b border-purple-100 cursor-pointer hover:bg-purple-100 transition-colors",onClick:()=>R(ue.id),children:f.jsxs("div",{className:"font-medium text-sm text-purple-700 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),ue.name]}),f.jsx("svg",{className:`w-4 h-4 transform transition-transform ${A[ue.id]?"rotate-180":""}`,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M7 10l5 5 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),A[ue.id]&&f.jsx("div",{className:"p-3",children:ue.firewalls&&ue.firewalls.length>0?f.jsx("div",{className:"space-y-2",children:ue.firewalls.map(F=>{var te,q,X,K,ye,Le,be,ke,$e;return f.jsx("div",{className:"bg-gray-50 rounded-md p-3 hover:bg-gray-100 transition-colors",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm",children:f.jsx("svg",{className:"w-4 h-4 text-purple-600",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})})}),f.jsxs("div",{children:[f.jsx("div",{className:"font-medium text-sm",children:F.name}),f.jsx("div",{className:"text-xs text-gray-500 mt-1",children:F.ip_address})]})]}),f.jsxs("button",{onClick:G=>{G.stopPropagation(),J(F.id)},className:`px-3 py-1.5 rounded-md text-white text-sm flex items-center gap-2 transition-colors ${((te=a[F.id])==null?void 0:te.status)==="loading"?"bg-gray-400":((q=a[F.id])==null?void 0:q.status)==="online"?"bg-green-500 hover:bg-green-600":((X=a[F.id])==null?void 0:X.status)==="offline"?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600"}`,disabled:((K=a[F.id])==null?void 0:K.status)==="loading",title:((ye=a[F.id])==null?void 0:ye.error)||"",children:[((Le=a[F.id])==null?void 0:Le.status)==="loading"?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((be=a[F.id])==null?void 0:be.status)==="online"?f.jsx(Sh,{className:"w-4 h-4"}):((ke=a[F.id])==null?void 0:ke.status)==="offline"?f.jsx(Eh,{className:"w-4 h-4"}):"Ping",(($e=a[F.id])==null?void 0:$e.status)==="online"&&a[F.id].responseTime&&f.jsxs("span",{children:[Math.round(a[F.id].responseTime||0),"ms"]})]})]})},F.id)})}):f.jsx("div",{className:"text-center text-sm text-gray-500",children:"Aucun firewall trouv"})})]},ue.id))}):f.jsx("div",{className:"text-center text-sm text-gray-500",children:"Aucun type de firewall trouv"})]})]})})},Q.id)}),[B,I,J,Z,R,o,r,A,a]);return f.jsxs("div",{className:"h-screen w-full",children:[u&&f.jsxs("div",{className:"absolute top-0 left-0 right-0 bg-red-500 text-white p-2 text-center z-50",children:[u,u.includes("Trop de requtes")&&f.jsx("button",{className:"ml-4 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.location.reload(),children:"Ressayer"}),f.jsx("button",{className:"ml-4 px-3 py-1 bg-gray-700 text-white rounded hover:bg-gray-800",onClick:()=>d(null),children:"Fermer"})]}),f.jsxs("div",{className:"fixed top-4 right-4 z-[3000] bg-white rounded-lg shadow-lg p-4 space-y-4 w-80",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:E,onChange:Q=>k(Q.target.value),placeholder:"Rechercher un datacenter...",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),E&&f.jsx("button",{onClick:()=>k(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{onClick:()=>y("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${_==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous"}),f.jsx("button",{onClick:()=>y("online"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${_==="online"?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"En ligne"}),f.jsx("button",{onClick:()=>y("offline"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${_==="offline"?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Hors ligne"})]}),f.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[f.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Statistiques"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Datacenters:"}),f.jsx("span",{className:"font-semibold",children:B.length})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"En ligne:"}),f.jsx("span",{className:"text-green-500 font-semibold",children:B.filter(Q=>{const ee=r[Q.id]||[];let U=0,ne=0;return ee.forEach(ue=>{var F;(F=ue.firewalls)==null||F.forEach(te=>{const q=a[te.id];q&&!_e(q.lastUpdate)&&(U++,q.status==="online"&&ne++)})}),Q.is_active&&(U===0||ne===U)}).length})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Hors ligne:"}),f.jsx("span",{className:"text-red-500 font-semibold",children:B.filter(Q=>{const ee=r[Q.id]||[];let U=0,ne=0;return ee.forEach(ue=>{var F;(F=ue.firewalls)==null||F.forEach(te=>{const q=a[te.id];q&&!_e(q.lastUpdate)&&(U++,q.status==="online"&&ne++)})}),!Q.is_active||U>0&&ne<U}).length})]})]})]}),f.jsx("button",{onClick:ge,disabled:S,className:`w-full px-4 py-2 rounded-md text-white text-sm flex items-center justify-center gap-2 ${S?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:S?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Test en cours..."]}):f.jsxs(f.Fragment,{children:[f.jsx(d2,{className:"w-4 h-4"}),"Tester tous les firewalls"]})})]}),f.jsxs(mk,{center:[31.7917,-7.0926],zoom:6,style:{height:"100%",width:"100%"},minZoom:4,maxZoom:18,children:[f.jsx(vk,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),f.jsx(wk,{chunkedLoading:!0,maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:Q=>Er.divIcon({html:`<div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${Q.getChildCount()}</div>`,className:"custom-cluster-icon",iconSize:Er.point(32,32)}),children:de})]})]})},XR=ls.memo(qR),YR=()=>f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:f.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[f.jsx("h1",{className:"text-2xl font-bold mb-4 text-purple-700",children:"Bienvenue, Admin !"}),f.jsx("p",{className:"text-gray-700",children:"Ceci est l'interface rserve aux administrateurs."})]})}),KR=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(!0),[a,i]=C.useState(""),[o,l]=C.useState(null),[u,d]=C.useState({}),[h,m]=C.useState(!1),g=async()=>{n(!0);try{const w=await Ot.get("/auth/users/"),A=Array.isArray(w.data)?w.data:w.data.results||[];t(A)}catch{i("Erreur lors du chargement des utilisateurs")}finally{n(!1)}};C.useEffect(()=>{g()},[]);const x=w=>{l(w),d(w)},_=async w=>{if(window.confirm("Supprimer cet utilisateur ?"))try{await Ot.delete(`/auth/users/${w.id}/`),g()}catch{i("Erreur lors de la suppression")}},y=async w=>{try{await Ot.post(`/auth/users/${w.id}/freeze/`),g()}catch{i("Erreur lors du freeze")}},E=async w=>{try{await Ot.post(`/auth/users/${w.id}/unfreeze/`),g()}catch{i("Erreur lors du unfreeze")}},k=w=>{d({...u,[w.target.name]:w.target.value})},S=async w=>{w.preventDefault();try{o?await Ot.put(`/auth/users/${o.id}/`,u):await Ot.post("/auth/users/",u),l(null),d({}),m(!1),g()}catch{i("Erreur lors de la sauvegarde")}};return f.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600 p-8",children:f.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-4xl",children:[f.jsx("h1",{className:"text-2xl font-bold mb-4 text-purple-700",children:"Gestion des utilisateurs"}),a&&f.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:a}),f.jsx("button",{className:"mb-4 px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",onClick:()=>{l(null),d({}),m(!0)},children:"Ajouter un utilisateur"}),(o||h)&&f.jsxs("form",{onSubmit:S,className:"mb-6 space-y-2",children:[f.jsx("input",{type:"text",name:"username",placeholder:"Nom d'utilisateur",value:u.username||"",onChange:k,className:"border p-2 rounded w-full",required:!0}),f.jsx("input",{type:"email",name:"email",placeholder:"Email",value:u.email||"",onChange:k,className:"border p-2 rounded w-full",required:!0}),f.jsx("input",{type:"text",name:"first_name",placeholder:"Prnom",value:u.first_name||"",onChange:k,className:"border p-2 rounded w-full"}),f.jsx("input",{type:"text",name:"last_name",placeholder:"Nom",value:u.last_name||"",onChange:k,className:"border p-2 rounded w-full"}),f.jsx("input",{type:"text",name:"phone_number",placeholder:"Tlphone",value:u.phone_number||"",onChange:k,className:"border p-2 rounded w-full"}),!o&&f.jsx("input",{type:"password",name:"password",placeholder:"Mot de passe",value:u.password||"",onChange:k,className:"border p-2 rounded w-full",required:!0}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:o?"Enregistrer":"Crer"}),f.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-400 text-white rounded",onClick:()=>{l(null),d({}),m(!1)},children:"Annuler"})]})]}),r?f.jsx("div",{children:"Chargement..."}):f.jsxs("table",{className:"w-full table-auto border",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-purple-100",children:[f.jsx("th",{className:"p-2",children:"Nom d'utilisateur"}),f.jsx("th",{className:"p-2",children:"Email"}),f.jsx("th",{className:"p-2",children:"Prnom"}),f.jsx("th",{className:"p-2",children:"Nom"}),f.jsx("th",{className:"p-2",children:"Tlphone"}),f.jsx("th",{className:"p-2",children:"Statut"}),f.jsx("th",{className:"p-2",children:"Actions"})]})}),f.jsx("tbody",{children:Array.isArray(e)&&e.map(w=>f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"p-2",children:w.username}),f.jsx("td",{className:"p-2",children:w.email}),f.jsx("td",{className:"p-2",children:w.first_name}),f.jsx("td",{className:"p-2",children:w.last_name}),f.jsx("td",{className:"p-2",children:w.phone_number}),f.jsx("td",{className:"p-2",children:w.is_active?f.jsx("span",{className:"text-green-600",children:"Actif"}):f.jsx("span",{className:"text-red-600",children:"Freez"})}),f.jsxs("td",{className:"p-2 space-x-2",children:[f.jsx("button",{className:"px-2 py-1 bg-blue-500 text-white rounded",onClick:()=>x(w),children:"Editer"}),f.jsx("button",{className:"px-2 py-1 bg-red-500 text-white rounded",onClick:()=>_(w),children:"Supprimer"}),w.is_active?f.jsx("button",{className:"px-2 py-1 bg-yellow-500 text-white rounded",onClick:()=>y(w),children:"Freezer"}):f.jsx("button",{className:"px-2 py-1 bg-green-500 text-white rounded",onClick:()=>E(w),children:"Dfreezer"})]})]},w.id))})]})]})})},JR=()=>f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:f.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[f.jsx("h1",{className:"text-2xl font-bold mb-4 text-purple-700",children:"Logs systme"}),f.jsx("p",{className:"text-gray-700",children:"Page rserve  la consultation des logs systme."})]})}),QR=()=>{const[e,t]=C.useState([]),[r,n]=C.useState([]),[a,i]=C.useState(!0),[o,l]=C.useState(""),[u,d]=C.useState({recipients:"",subject:"",content:"",from_email:"",smtp_password:"",smtp_host:"",smtp_port:"587"}),[h,m]=C.useState(!1),[g,x]=C.useState(""),[_,y]=C.useState(""),[E,k]=C.useState([]),[S,w]=C.useState(""),[A,D]=C.useState(""),[R,P]=C.useState(null),[H,B]=C.useState({from_email:"",smtp_host:"",smtp_port:"587",smtp_password:"",admin_key:""}),[W,I]=C.useState(""),[Z,J]=C.useState(""),[ge,_e]=C.useState(!1),de=async()=>{i(!0),l("");try{const K=await Ot.get("email/emails/");t(Array.isArray(K.data)?K.data:K.data.results||[])}catch{l("Erreur lors du chargement des emails")}finally{i(!1)}},Q=async()=>{try{const K=await Ot.get("auth/users/");n(Array.isArray(K.data)?K.data:K.data.results||[])}catch{}},ee=async K=>{_e(!0),J(""),I("");try{const ye=await Ot.post("email/config/",{admin_key:K});P(ye.data),B({...H,...ye.data,smtp_password:"",admin_key:K}),d(Le=>({...Le,from_email:ye.data.from_email,smtp_host:ye.data.smtp_host,smtp_port:ye.data.smtp_port}))}catch{J("Erreur lors du chargement de la configuration principale")}finally{_e(!1)}};C.useEffect(()=>{de(),Q()},[]);const U=K=>{E.includes(K)||k([...E,K])},ne=K=>{k(E.filter(ye=>ye!==K))},ue=async K=>{K.preventDefault(),m(!0),l(""),x("");try{await Ot.post("email/admin/send-email/",{user_ids:E,subject:S,message:A}),x("Email envoy avec succs"),k([]),w(""),D(""),de()}catch{l("Erreur lors de l'envoi de l'email")}finally{m(!1)}},F=r.filter(K=>E.includes(K.id)),te=r.filter(K=>K.email.toLowerCase().includes(_.toLowerCase())),q=K=>{B({...H,[K.target.name]:K.target.value})},X=async K=>{K.preventDefault(),_e(!0),I(""),J("");try{await Ot.put("email/config/",H),I("Configuration enregistre !"),ee(H.admin_key)}catch{J("Erreur lors de la sauvegarde de la configuration")}finally{_e(!1)}};return f.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600 p-8",children:f.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-6xl flex flex-col gap-8",children:[f.jsxs("div",{className:"mb-8 border-b pb-6",children:[f.jsx("h2",{className:"text-xl font-bold mb-2 text-purple-700",children:"Configuration email principale"}),f.jsxs("form",{onSubmit:X,className:"space-y-2 max-w-xl",children:[f.jsx("input",{name:"admin_key",type:"password",value:H.admin_key,onChange:q,placeholder:"Cl de modification (obligatoire)",className:"border p-2 rounded w-full",required:!0}),f.jsx("input",{name:"from_email",value:H.from_email,onChange:q,placeholder:"Expditeur principal (from@...)",className:"border p-2 rounded w-full",required:!0}),f.jsx("input",{name:"smtp_password",type:"password",value:H.smtp_password,onChange:q,placeholder:"Mot de passe SMTP principal",className:"border p-2 rounded w-full"}),f.jsx("input",{name:"smtp_host",value:H.smtp_host,onChange:q,placeholder:"Serveur SMTP principal",className:"border p-2 rounded w-full",required:!0}),f.jsx("input",{name:"smtp_port",value:H.smtp_port,onChange:q,placeholder:"Port SMTP principal",className:"border p-2 rounded w-full",required:!0}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",disabled:ge,children:ge?"Enregistrement...":"Enregistrer"}),W&&f.jsx("div",{className:"text-green-600",children:W}),Z&&f.jsx("div",{className:"text-red-600",children:Z})]}),f.jsx("button",{className:"mt-2 text-sm text-purple-700 underline",onClick:()=>H.admin_key&&ee(H.admin_key),disabled:!H.admin_key,children:"Charger la config principale"})]}),f.jsxs("div",{className:"flex flex-row gap-8",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h1",{className:"text-2xl font-bold mb-4 text-purple-700",children:"Gestion des emails envoys"}),f.jsxs("form",{onSubmit:ue,className:"mb-8 space-y-2",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-semibold mb-1",children:"Destinataires slectionns :"}),f.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[F.map(K=>f.jsxs("span",{className:"bg-purple-200 text-purple-800 px-2 py-1 rounded flex items-center",children:[K.email,f.jsx("button",{type:"button",className:"ml-1 text-red-600",onClick:()=>ne(K.id),children:""})]},K.id)),F.length===0&&f.jsx("span",{className:"text-gray-400",children:"Aucun"})]})]}),f.jsx("input",{name:"subject",value:S,onChange:K=>w(K.target.value),placeholder:"Sujet",className:"border p-2 rounded w-full",required:!0}),f.jsx("textarea",{name:"content",value:A,onChange:K=>D(K.target.value),placeholder:"Contenu",className:"border p-2 rounded w-full",rows:4,required:!0}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",disabled:h,children:h?"Envoi...":"Envoyer"}),g&&f.jsx("div",{className:"text-green-600",children:g}),o&&f.jsx("div",{className:"text-red-600",children:o})]}),a?f.jsx("div",{children:"Chargement..."}):f.jsxs("table",{className:"w-full table-auto border",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-purple-100",children:[f.jsx("th",{className:"p-2",children:"Destinataire"}),f.jsx("th",{className:"p-2",children:"Sujet"}),f.jsx("th",{className:"p-2",children:"Contenu"}),f.jsx("th",{className:"p-2",children:"Date d'envoi"})]})}),f.jsx("tbody",{children:e.map(K=>f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"p-2",children:K.recipient}),f.jsx("td",{className:"p-2",children:K.subject}),f.jsx("td",{className:"p-2",children:K.content}),f.jsx("td",{className:"p-2",children:K.sent_at})]},K.id))})]})]}),f.jsxs("div",{className:"w-64 border-l pl-4",children:[f.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Utilisateurs"}),f.jsx("input",{type:"text",placeholder:"Rechercher un email...",value:_,onChange:K=>y(K.target.value),className:"mb-2 p-2 border rounded w-full"}),f.jsx("ul",{className:"space-y-1 max-h-96 overflow-y-auto",children:te.map(K=>f.jsx("li",{children:f.jsx("button",{type:"button",className:"w-full text-left px-2 py-1 rounded hover:bg-purple-100",onClick:()=>U(K.id),disabled:E.includes(K.id),children:K.email})},K.id))})]})]})]})})},vr=({children:e})=>localStorage.getItem("token")?f.jsx(f.Fragment,{children:e}):f.jsx(ZT,{to:"/login"}),_r=({children:e})=>{const[t,r]=C.useState(!1),n=ya(),[a,i]=C.useState(!0),o=async()=>{try{await Ot.post("/auth/logout/")}catch(l){console.error("Logout error:",l)}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),delete Ot.defaults.headers.common.Authorization,n("/login")}};return t?f.jsx("div",{className:"flex items-center justify-center h-full",children:f.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-900"})}):f.jsxs("div",{className:"flex h-screen bg-gray-100",children:[f.jsx(yb,{onLogout:o,sidebarOpen:a,setSidebarOpen:i}),f.jsx("div",{className:`flex-1 flex flex-col overflow-hidden transition-all duration-300 ${a?"ml-64":"ml-0"}`,children:f.jsx("main",{className:"flex-1 overflow-y-auto",children:e})})]})},eD=()=>{const[e,t]=C.useState(!1),r=ya();return C.useEffect(()=>{rb(r)},[r]),C.useEffect(()=>{const n=localStorage.getItem("token"),a=localStorage.getItem("refreshToken");n&&a&&(t(!0),Ot.defaults.headers.common.Authorization=`Bearer ${n}`)},[]),f.jsxs(XT,{children:[f.jsx(er,{path:"/login",element:f.jsx(vb,{onLogin:()=>t(!0)})}),f.jsx(er,{path:"/register",element:f.jsx(_b,{onRegister:()=>t(!0)})}),f.jsx(er,{path:"/",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(rv,{})})})}),f.jsx(er,{path:"/firewalls",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(rv,{})})})}),f.jsx(er,{path:"/profile",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(aj,{})})})}),f.jsx(er,{path:"/templates",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(_d,{})})})}),f.jsx(er,{path:"/templates/new",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(_d,{})})})}),f.jsx(er,{path:"/templates/:id",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(_d,{})})})}),f.jsx(er,{path:"/config",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(TM,{})})})}),f.jsx(er,{path:"/matrix",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(OO,{})})})}),f.jsx(er,{path:"/map",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(nj,{})})})}),f.jsx(er,{path:"/settings",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(CM,{})})})}),f.jsx(er,{path:"/history",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(UR,{})})})}),f.jsx(er,{path:"/daily-check",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(VR,{})})})}),f.jsx(er,{path:"/network-map",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(XR,{})})})}),f.jsx(er,{path:"/admin-dashboard",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(YR,{})})})}),f.jsx(er,{path:"/admin-users",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(KR,{})})})}),f.jsx(er,{path:"/admin-logs",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(JR,{})})})}),f.jsx(er,{path:"/admin-emails",element:f.jsx(vr,{children:f.jsx(_r,{children:f.jsx(QR,{})})})})]})};function tD(){return f.jsxs(GT,{children:[f.jsx(EM,{position:"top-right"}),f.jsx(MM,{children:f.jsx(eD,{})})]})}window.__REACT_DEVTOOLS_GLOBAL_HOOK__={isDisabled:!0};yd.createRoot(document.getElementById("root")).render(f.jsx(ls.StrictMode,{children:f.jsx(tD,{})}));
