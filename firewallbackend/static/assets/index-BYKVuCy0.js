(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var wa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function uf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Zx={exports:{}},ff={},Gx={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zl=Symbol.for("react.element"),eE=Symbol.for("react.portal"),tE=Symbol.for("react.fragment"),rE=Symbol.for("react.strict_mode"),nE=Symbol.for("react.profiler"),iE=Symbol.for("react.provider"),aE=Symbol.for("react.context"),sE=Symbol.for("react.forward_ref"),oE=Symbol.for("react.suspense"),lE=Symbol.for("react.memo"),cE=Symbol.for("react.lazy"),Gm=Symbol.iterator;function uE(e){return e===null||typeof e!="object"?null:(e=Gm&&e[Gm]||e["@@iterator"],typeof e=="function"?e:null)}var Xx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kx=Object.assign,qx={};function fo(e,t,r){this.props=e,this.context=t,this.refs=qx,this.updater=r||Xx}fo.prototype.isReactComponent={};fo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Yx(){}Yx.prototype=fo.prototype;function xh(e,t,r){this.props=e,this.context=t,this.refs=qx,this.updater=r||Xx}var vh=xh.prototype=new Yx;vh.constructor=xh;Kx(vh,fo.prototype);vh.isPureReactComponent=!0;var Xm=Array.isArray,Jx=Object.prototype.hasOwnProperty,_h={current:null},Qx={key:!0,ref:!0,__self:!0,__source:!0};function ev(e,t,r){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Jx.call(t,n)&&!Qx.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var u=Array(l),f=0;f<l;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:Zl,type:e,key:a,ref:o,props:i,_owner:_h.current}}function fE(e,t){return{$$typeof:Zl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function yh(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zl}function dE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Km=/\/+/g;function f0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dE(""+e.key):t.toString(36)}function nu(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Zl:case eE:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+f0(o,0):n,Xm(i)?(r="",e!=null&&(r=e.replace(Km,"$&/")+"/"),nu(i,t,r,"",function(f){return f})):i!=null&&(yh(i)&&(i=fE(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Km,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",Xm(e))for(var l=0;l<e.length;l++){a=e[l];var u=n+f0(a,l);o+=nu(a,t,r,u,i)}else if(u=uE(e),typeof u=="function")for(e=u.call(e),l=0;!(a=e.next()).done;)a=a.value,u=n+f0(a,l++),o+=nu(a,t,r,u,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Nc(e,t,r){if(e==null)return e;var n=[],i=0;return nu(e,n,"","",function(a){return t.call(r,a,i++)}),n}function hE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Xr={current:null},iu={transition:null},pE={ReactCurrentDispatcher:Xr,ReactCurrentBatchConfig:iu,ReactCurrentOwner:_h};function tv(){throw Error("act(...) is not supported in production builds of React.")}mt.Children={map:Nc,forEach:function(e,t,r){Nc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Nc(e,function(){t++}),t},toArray:function(e){return Nc(e,function(t){return t})||[]},only:function(e){if(!yh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};mt.Component=fo;mt.Fragment=tE;mt.Profiler=nE;mt.PureComponent=xh;mt.StrictMode=rE;mt.Suspense=oE;mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pE;mt.act=tv;mt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Kx({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=_h.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Jx.call(t,u)&&!Qx.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var f=0;f<u;f++)l[f]=arguments[f+2];n.children=l}return{$$typeof:Zl,type:e.type,key:i,ref:a,props:n,_owner:o}};mt.createContext=function(e){return e={$$typeof:aE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:iE,_context:e},e.Consumer=e};mt.createElement=ev;mt.createFactory=function(e){var t=ev.bind(null,e);return t.type=e,t};mt.createRef=function(){return{current:null}};mt.forwardRef=function(e){return{$$typeof:sE,render:e}};mt.isValidElement=yh;mt.lazy=function(e){return{$$typeof:cE,_payload:{_status:-1,_result:e},_init:hE}};mt.memo=function(e,t){return{$$typeof:lE,type:e,compare:t===void 0?null:t}};mt.startTransition=function(e){var t=iu.transition;iu.transition={};try{e()}finally{iu.transition=t}};mt.unstable_act=tv;mt.useCallback=function(e,t){return Xr.current.useCallback(e,t)};mt.useContext=function(e){return Xr.current.useContext(e)};mt.useDebugValue=function(){};mt.useDeferredValue=function(e){return Xr.current.useDeferredValue(e)};mt.useEffect=function(e,t){return Xr.current.useEffect(e,t)};mt.useId=function(){return Xr.current.useId()};mt.useImperativeHandle=function(e,t,r){return Xr.current.useImperativeHandle(e,t,r)};mt.useInsertionEffect=function(e,t){return Xr.current.useInsertionEffect(e,t)};mt.useLayoutEffect=function(e,t){return Xr.current.useLayoutEffect(e,t)};mt.useMemo=function(e,t){return Xr.current.useMemo(e,t)};mt.useReducer=function(e,t,r){return Xr.current.useReducer(e,t,r)};mt.useRef=function(e){return Xr.current.useRef(e)};mt.useState=function(e){return Xr.current.useState(e)};mt.useSyncExternalStore=function(e,t,r){return Xr.current.useSyncExternalStore(e,t,r)};mt.useTransition=function(){return Xr.current.useTransition()};mt.version="18.3.1";Gx.exports=mt;var N=Gx.exports;const Kn=$x(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mE=N,gE=Symbol.for("react.element"),xE=Symbol.for("react.fragment"),vE=Object.prototype.hasOwnProperty,_E=mE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yE={key:!0,ref:!0,__self:!0,__source:!0};function rv(e,t,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)vE.call(t,n)&&!yE.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:gE,type:e,key:a,ref:o,props:i,_owner:_E.current}}ff.Fragment=xE;ff.jsx=rv;ff.jsxs=rv;Zx.exports=ff;var p=Zx.exports,nv={exports:{}},gn={},iv={exports:{}},av={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,q){var ae=re.length;re.push(q);e:for(;0<ae;){var pe=ae-1>>>1,O=re[pe];if(0<i(O,q))re[pe]=q,re[ae]=O,ae=pe;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var q=re[0],ae=re.pop();if(ae!==q){re[0]=ae;e:for(var pe=0,O=re.length,J=O>>>1;pe<J;){var X=2*(pe+1)-1,W=re[X],ie=X+1,we=re[ie];if(0>i(W,ae))ie<O&&0>i(we,W)?(re[pe]=we,re[ie]=ae,pe=ie):(re[pe]=W,re[X]=ae,pe=X);else if(ie<O&&0>i(we,ae))re[pe]=we,re[ie]=ae,pe=ie;else break e}}return q}function i(re,q){var ae=re.sortIndex-q.sortIndex;return ae!==0?ae:re.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],f=[],d=1,m=null,g=3,_=!1,y=!1,v=!1,T=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(re){for(var q=r(f);q!==null;){if(q.callback===null)n(f);else if(q.startTime<=re)n(f),q.sortIndex=q.expirationTime,t(u,q);else break;q=r(f)}}function P(re){if(v=!1,w(re),!y)if(r(u)!==null)y=!0,Y(I);else{var q=r(f);q!==null&&xe(P,q.startTime-re)}}function I(re,q){y=!1,v&&(v=!1,k(U),U=-1),_=!0;var ae=g;try{for(w(q),m=r(u);m!==null&&(!(m.expirationTime>q)||re&&!V());){var pe=m.callback;if(typeof pe=="function"){m.callback=null,g=m.priorityLevel;var O=pe(m.expirationTime<=q);q=e.unstable_now(),typeof O=="function"?m.callback=O:m===r(u)&&n(u),w(q)}else n(u);m=r(u)}if(m!==null)var J=!0;else{var X=r(f);X!==null&&xe(P,X.startTime-q),J=!1}return J}finally{m=null,g=ae,_=!1}}var M=!1,b=null,U=-1,j=5,K=-1;function V(){return!(e.unstable_now()-K<j)}function G(){if(b!==null){var re=e.unstable_now();K=re;var q=!0;try{q=b(!0,re)}finally{q?de():(M=!1,b=null)}}else M=!1}var de;if(typeof E=="function")de=function(){E(G)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,ce=Se.port2;Se.port1.onmessage=G,de=function(){ce.postMessage(null)}}else de=function(){T(G,0)};function Y(re){b=re,M||(M=!0,de())}function xe(re,q){U=T(function(){re(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){y||_||(y=!0,Y(I))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(re){switch(g){case 1:case 2:case 3:var q=3;break;default:q=g}var ae=g;g=q;try{return re()}finally{g=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,q){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ae=g;g=re;try{return q()}finally{g=ae}},e.unstable_scheduleCallback=function(re,q,ae){var pe=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?pe+ae:pe):ae=pe,re){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ae+O,re={id:d++,callback:q,priorityLevel:re,startTime:ae,expirationTime:O,sortIndex:-1},ae>pe?(re.sortIndex=ae,t(f,re),r(u)===null&&re===r(f)&&(v?(k(U),U=-1):v=!0,xe(P,ae-pe))):(re.sortIndex=O,t(u,re),y||_||(y=!0,Y(I))),re},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(re){var q=g;return function(){var ae=g;g=q;try{return re.apply(this,arguments)}finally{g=ae}}}})(av);iv.exports=av;var wE=iv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kE=N,pn=wE;function Te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sv=new Set,_l={};function os(e,t){ro(e,t),ro(e+"Capture",t)}function ro(e,t){for(_l[e]=t,e=0;e<t.length;e++)sv.add(t[e])}var Bi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nd=Object.prototype.hasOwnProperty,EE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qm={},Ym={};function TE(e){return nd.call(Ym,e)?!0:nd.call(qm,e)?!1:EE.test(e)?Ym[e]=!0:(qm[e]=!0,!1)}function SE(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CE(e,t,r,n){if(t===null||typeof t>"u"||SE(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Kr(e,t,r,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Sr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Sr[e]=new Kr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Sr[t]=new Kr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Sr[e]=new Kr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Sr[e]=new Kr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Sr[e]=new Kr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Sr[e]=new Kr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Sr[e]=new Kr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Sr[e]=new Kr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Sr[e]=new Kr(e,5,!1,e.toLowerCase(),null,!1,!1)});var wh=/[\-:]([a-z])/g;function kh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(wh,kh);Sr[t]=new Kr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(wh,kh);Sr[t]=new Kr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(wh,kh);Sr[t]=new Kr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Sr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!1,!1)});Sr.xlinkHref=new Kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Sr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Eh(e,t,r,n){var i=Sr.hasOwnProperty(t)?Sr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CE(t,r,i,n)&&(r=null),n||i===null?TE(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var $i=kE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bc=Symbol.for("react.element"),Ps=Symbol.for("react.portal"),Fs=Symbol.for("react.fragment"),Th=Symbol.for("react.strict_mode"),id=Symbol.for("react.profiler"),ov=Symbol.for("react.provider"),lv=Symbol.for("react.context"),Sh=Symbol.for("react.forward_ref"),ad=Symbol.for("react.suspense"),sd=Symbol.for("react.suspense_list"),Ch=Symbol.for("react.memo"),ea=Symbol.for("react.lazy"),cv=Symbol.for("react.offscreen"),Jm=Symbol.iterator;function Mo(e){return e===null||typeof e!="object"?null:(e=Jm&&e[Jm]||e["@@iterator"],typeof e=="function"?e:null)}var Wt=Object.assign,d0;function $o(e){if(d0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);d0=t&&t[1]||""}return`
`+d0+e}var h0=!1;function p0(e,t){if(!e||h0)return"";h0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var u=`
`+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{h0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?$o(e):""}function AE(e){switch(e.tag){case 5:return $o(e.type);case 16:return $o("Lazy");case 13:return $o("Suspense");case 19:return $o("SuspenseList");case 0:case 2:case 15:return e=p0(e.type,!1),e;case 11:return e=p0(e.type.render,!1),e;case 1:return e=p0(e.type,!0),e;default:return""}}function od(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Fs:return"Fragment";case Ps:return"Portal";case id:return"Profiler";case Th:return"StrictMode";case ad:return"Suspense";case sd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case lv:return(e.displayName||"Context")+".Consumer";case ov:return(e._context.displayName||"Context")+".Provider";case Sh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ch:return t=e.displayName||null,t!==null?t:od(e.type)||"Memo";case ea:t=e._payload,e=e._init;try{return od(e(t))}catch{}}return null}function NE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return od(t);case 8:return t===Th?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ka(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function uv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function bE(e){var t=uv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lc(e){e._valueTracker||(e._valueTracker=bE(e))}function fv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=uv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function yu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ld(e,t){var r=t.checked;return Wt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Qm(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ka(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function dv(e,t){t=t.checked,t!=null&&Eh(e,"checked",t,!1)}function cd(e,t){dv(e,t);var r=ka(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ud(e,t.type,r):t.hasOwnProperty("defaultValue")&&ud(e,t.type,ka(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function eg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ud(e,t,r){(t!=="number"||yu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Zo=Array.isArray;function Gs(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ka(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function fd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Te(91));return Wt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function tg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Te(92));if(Zo(r)){if(1<r.length)throw Error(Te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ka(r)}}function hv(e,t){var r=ka(t.value),n=ka(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function rg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function pv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?pv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Pc,mv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Pc=Pc||document.createElement("div"),Pc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Pc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function yl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var el={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LE=["Webkit","ms","Moz","O"];Object.keys(el).forEach(function(e){LE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),el[t]=el[e]})});function gv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||el.hasOwnProperty(e)&&el[e]?(""+t).trim():t+"px"}function xv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=gv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var PE=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hd(e,t){if(t){if(PE[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Te(62))}}function pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var md=null;function Ah(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gd=null,Xs=null,Ks=null;function ng(e){if(e=Kl(e)){if(typeof gd!="function")throw Error(Te(280));var t=e.stateNode;t&&(t=gf(t),gd(e.stateNode,e.type,t))}}function vv(e){Xs?Ks?Ks.push(e):Ks=[e]:Xs=e}function _v(){if(Xs){var e=Xs,t=Ks;if(Ks=Xs=null,ng(e),t)for(e=0;e<t.length;e++)ng(t[e])}}function yv(e,t){return e(t)}function wv(){}var m0=!1;function kv(e,t,r){if(m0)return e(t,r);m0=!0;try{return yv(e,t,r)}finally{m0=!1,(Xs!==null||Ks!==null)&&(wv(),_v())}}function wl(e,t){var r=e.stateNode;if(r===null)return null;var n=gf(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Te(231,t,typeof r));return r}var xd=!1;if(Bi)try{var Io={};Object.defineProperty(Io,"passive",{get:function(){xd=!0}}),window.addEventListener("test",Io,Io),window.removeEventListener("test",Io,Io)}catch{xd=!1}function FE(e,t,r,n,i,a,o,l,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var tl=!1,wu=null,ku=!1,vd=null,OE={onError:function(e){tl=!0,wu=e}};function RE(e,t,r,n,i,a,o,l,u){tl=!1,wu=null,FE.apply(OE,arguments)}function ME(e,t,r,n,i,a,o,l,u){if(RE.apply(this,arguments),tl){if(tl){var f=wu;tl=!1,wu=null}else throw Error(Te(198));ku||(ku=!0,vd=f)}}function ls(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Ev(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ig(e){if(ls(e)!==e)throw Error(Te(188))}function IE(e){var t=e.alternate;if(!t){if(t=ls(e),t===null)throw Error(Te(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return ig(i),e;if(a===n)return ig(i),t;a=a.sibling}throw Error(Te(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o)throw Error(Te(189))}}if(r.alternate!==n)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?e:t}function Tv(e){return e=IE(e),e!==null?Sv(e):null}function Sv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Sv(e);if(t!==null)return t;e=e.sibling}return null}var Cv=pn.unstable_scheduleCallback,ag=pn.unstable_cancelCallback,DE=pn.unstable_shouldYield,jE=pn.unstable_requestPaint,Jt=pn.unstable_now,BE=pn.unstable_getCurrentPriorityLevel,Nh=pn.unstable_ImmediatePriority,Av=pn.unstable_UserBlockingPriority,Eu=pn.unstable_NormalPriority,zE=pn.unstable_LowPriority,Nv=pn.unstable_IdlePriority,df=null,mi=null;function UE(e){if(mi&&typeof mi.onCommitFiberRoot=="function")try{mi.onCommitFiberRoot(df,e,void 0,(e.current.flags&128)===128)}catch{}}var qn=Math.clz32?Math.clz32:WE,HE=Math.log,VE=Math.LN2;function WE(e){return e>>>=0,e===0?32:31-(HE(e)/VE|0)|0}var Fc=64,Oc=4194304;function Go(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tu(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=Go(l):(a&=o,a!==0&&(n=Go(a)))}else o=r&~i,o!==0?n=Go(o):a!==0&&(n=Go(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-qn(t),i=1<<r,n|=e[r],t&=~i;return n}function $E(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZE(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-qn(a),l=1<<o,u=i[o];u===-1?(!(l&r)||l&n)&&(i[o]=$E(l,t)):u<=t&&(e.expiredLanes|=l),a&=~l}}function _d(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bv(){var e=Fc;return Fc<<=1,!(Fc&4194240)&&(Fc=64),e}function g0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Gl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qn(t),e[t]=r}function GE(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-qn(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function bh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-qn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Nt=0;function Lv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Pv,Lh,Fv,Ov,Rv,yd=!1,Rc=[],fa=null,da=null,ha=null,kl=new Map,El=new Map,ra=[],XE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sg(e,t){switch(e){case"focusin":case"focusout":fa=null;break;case"dragenter":case"dragleave":da=null;break;case"mouseover":case"mouseout":ha=null;break;case"pointerover":case"pointerout":kl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":El.delete(t.pointerId)}}function Do(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Kl(t),t!==null&&Lh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function KE(e,t,r,n,i){switch(t){case"focusin":return fa=Do(fa,e,t,r,n,i),!0;case"dragenter":return da=Do(da,e,t,r,n,i),!0;case"mouseover":return ha=Do(ha,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return kl.set(a,Do(kl.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,El.set(a,Do(El.get(a)||null,e,t,r,n,i)),!0}return!1}function Mv(e){var t=za(e.target);if(t!==null){var r=ls(t);if(r!==null){if(t=r.tag,t===13){if(t=Ev(r),t!==null){e.blockedOn=t,Rv(e.priority,function(){Fv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function au(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=wd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);md=n,r.target.dispatchEvent(n),md=null}else return t=Kl(r),t!==null&&Lh(t),e.blockedOn=r,!1;t.shift()}return!0}function og(e,t,r){au(e)&&r.delete(t)}function qE(){yd=!1,fa!==null&&au(fa)&&(fa=null),da!==null&&au(da)&&(da=null),ha!==null&&au(ha)&&(ha=null),kl.forEach(og),El.forEach(og)}function jo(e,t){e.blockedOn===t&&(e.blockedOn=null,yd||(yd=!0,pn.unstable_scheduleCallback(pn.unstable_NormalPriority,qE)))}function Tl(e){function t(i){return jo(i,e)}if(0<Rc.length){jo(Rc[0],e);for(var r=1;r<Rc.length;r++){var n=Rc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(fa!==null&&jo(fa,e),da!==null&&jo(da,e),ha!==null&&jo(ha,e),kl.forEach(t),El.forEach(t),r=0;r<ra.length;r++)n=ra[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ra.length&&(r=ra[0],r.blockedOn===null);)Mv(r),r.blockedOn===null&&ra.shift()}var qs=$i.ReactCurrentBatchConfig,Su=!0;function YE(e,t,r,n){var i=Nt,a=qs.transition;qs.transition=null;try{Nt=1,Ph(e,t,r,n)}finally{Nt=i,qs.transition=a}}function JE(e,t,r,n){var i=Nt,a=qs.transition;qs.transition=null;try{Nt=4,Ph(e,t,r,n)}finally{Nt=i,qs.transition=a}}function Ph(e,t,r,n){if(Su){var i=wd(e,t,r,n);if(i===null)C0(e,t,n,Cu,r),sg(e,n);else if(KE(i,e,t,r,n))n.stopPropagation();else if(sg(e,n),t&4&&-1<XE.indexOf(e)){for(;i!==null;){var a=Kl(i);if(a!==null&&Pv(a),a=wd(e,t,r,n),a===null&&C0(e,t,n,Cu,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else C0(e,t,n,null,r)}}var Cu=null;function wd(e,t,r,n){if(Cu=null,e=Ah(n),e=za(e),e!==null)if(t=ls(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Ev(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Cu=e,null}function Iv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BE()){case Nh:return 1;case Av:return 4;case Eu:case zE:return 16;case Nv:return 536870912;default:return 16}default:return 16}}var sa=null,Fh=null,su=null;function Dv(){if(su)return su;var e,t=Fh,r=t.length,n,i="value"in sa?sa.value:sa.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[a-n];n++);return su=i.slice(e,1<n?1-n:void 0)}function ou(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Mc(){return!0}function lg(){return!1}function xn(e){function t(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Mc:lg,this.isPropagationStopped=lg,this}return Wt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Mc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Mc)},persist:function(){},isPersistent:Mc}),t}var ho={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oh=xn(ho),Xl=Wt({},ho,{view:0,detail:0}),QE=xn(Xl),x0,v0,Bo,hf=Wt({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bo&&(Bo&&e.type==="mousemove"?(x0=e.screenX-Bo.screenX,v0=e.screenY-Bo.screenY):v0=x0=0,Bo=e),x0)},movementY:function(e){return"movementY"in e?e.movementY:v0}}),cg=xn(hf),eT=Wt({},hf,{dataTransfer:0}),tT=xn(eT),rT=Wt({},Xl,{relatedTarget:0}),_0=xn(rT),nT=Wt({},ho,{animationName:0,elapsedTime:0,pseudoElement:0}),iT=xn(nT),aT=Wt({},ho,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sT=xn(aT),oT=Wt({},ho,{data:0}),ug=xn(oT),lT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=uT[e])?!!t[e]:!1}function Rh(){return fT}var dT=Wt({},Xl,{key:function(e){if(e.key){var t=lT[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ou(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rh,charCode:function(e){return e.type==="keypress"?ou(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ou(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),hT=xn(dT),pT=Wt({},hf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fg=xn(pT),mT=Wt({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rh}),gT=xn(mT),xT=Wt({},ho,{propertyName:0,elapsedTime:0,pseudoElement:0}),vT=xn(xT),_T=Wt({},hf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yT=xn(_T),wT=[9,13,27,32],Mh=Bi&&"CompositionEvent"in window,rl=null;Bi&&"documentMode"in document&&(rl=document.documentMode);var kT=Bi&&"TextEvent"in window&&!rl,jv=Bi&&(!Mh||rl&&8<rl&&11>=rl),dg=" ",hg=!1;function Bv(e,t){switch(e){case"keyup":return wT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Os=!1;function ET(e,t){switch(e){case"compositionend":return zv(t);case"keypress":return t.which!==32?null:(hg=!0,dg);case"textInput":return e=t.data,e===dg&&hg?null:e;default:return null}}function TT(e,t){if(Os)return e==="compositionend"||!Mh&&Bv(e,t)?(e=Dv(),su=Fh=sa=null,Os=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jv&&t.locale!=="ko"?null:t.data;default:return null}}var ST={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ST[e.type]:t==="textarea"}function Uv(e,t,r,n){vv(n),t=Au(t,"onChange"),0<t.length&&(r=new Oh("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var nl=null,Sl=null;function CT(e){Jv(e,0)}function pf(e){var t=Is(e);if(fv(t))return e}function AT(e,t){if(e==="change")return t}var Hv=!1;if(Bi){var y0;if(Bi){var w0="oninput"in document;if(!w0){var mg=document.createElement("div");mg.setAttribute("oninput","return;"),w0=typeof mg.oninput=="function"}y0=w0}else y0=!1;Hv=y0&&(!document.documentMode||9<document.documentMode)}function gg(){nl&&(nl.detachEvent("onpropertychange",Vv),Sl=nl=null)}function Vv(e){if(e.propertyName==="value"&&pf(Sl)){var t=[];Uv(t,Sl,e,Ah(e)),kv(CT,t)}}function NT(e,t,r){e==="focusin"?(gg(),nl=t,Sl=r,nl.attachEvent("onpropertychange",Vv)):e==="focusout"&&gg()}function bT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pf(Sl)}function LT(e,t){if(e==="click")return pf(t)}function PT(e,t){if(e==="input"||e==="change")return pf(t)}function FT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qn=typeof Object.is=="function"?Object.is:FT;function Cl(e,t){if(Qn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!nd.call(t,i)||!Qn(e[i],t[i]))return!1}return!0}function xg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function vg(e,t){var r=xg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=xg(r)}}function Wv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Wv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $v(){for(var e=window,t=yu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=yu(e.document)}return t}function Ih(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function OT(e){var t=$v(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Wv(r.ownerDocument.documentElement,r)){if(n!==null&&Ih(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=vg(r,a);var o=vg(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var RT=Bi&&"documentMode"in document&&11>=document.documentMode,Rs=null,kd=null,il=null,Ed=!1;function _g(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ed||Rs==null||Rs!==yu(n)||(n=Rs,"selectionStart"in n&&Ih(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),il&&Cl(il,n)||(il=n,n=Au(kd,"onSelect"),0<n.length&&(t=new Oh("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Rs)))}function Ic(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ms={animationend:Ic("Animation","AnimationEnd"),animationiteration:Ic("Animation","AnimationIteration"),animationstart:Ic("Animation","AnimationStart"),transitionend:Ic("Transition","TransitionEnd")},k0={},Zv={};Bi&&(Zv=document.createElement("div").style,"AnimationEvent"in window||(delete Ms.animationend.animation,delete Ms.animationiteration.animation,delete Ms.animationstart.animation),"TransitionEvent"in window||delete Ms.transitionend.transition);function mf(e){if(k0[e])return k0[e];if(!Ms[e])return e;var t=Ms[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Zv)return k0[e]=t[r];return e}var Gv=mf("animationend"),Xv=mf("animationiteration"),Kv=mf("animationstart"),qv=mf("transitionend"),Yv=new Map,yg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ca(e,t){Yv.set(e,t),os(t,[e])}for(var E0=0;E0<yg.length;E0++){var T0=yg[E0],MT=T0.toLowerCase(),IT=T0[0].toUpperCase()+T0.slice(1);Ca(MT,"on"+IT)}Ca(Gv,"onAnimationEnd");Ca(Xv,"onAnimationIteration");Ca(Kv,"onAnimationStart");Ca("dblclick","onDoubleClick");Ca("focusin","onFocus");Ca("focusout","onBlur");Ca(qv,"onTransitionEnd");ro("onMouseEnter",["mouseout","mouseover"]);ro("onMouseLeave",["mouseout","mouseover"]);ro("onPointerEnter",["pointerout","pointerover"]);ro("onPointerLeave",["pointerout","pointerover"]);os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));os("onBeforeInput",["compositionend","keypress","textInput","paste"]);os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xo));function wg(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,ME(n,t,void 0,e),e.currentTarget=null}function Jv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,f=l.currentTarget;if(l=l.listener,u!==a&&i.isPropagationStopped())break e;wg(i,l,f),a=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,f=l.currentTarget,l=l.listener,u!==a&&i.isPropagationStopped())break e;wg(i,l,f),a=u}}}if(ku)throw e=vd,ku=!1,vd=null,e}function It(e,t){var r=t[Nd];r===void 0&&(r=t[Nd]=new Set);var n=e+"__bubble";r.has(n)||(Qv(t,e,2,!1),r.add(n))}function S0(e,t,r){var n=0;t&&(n|=4),Qv(r,e,n,t)}var Dc="_reactListening"+Math.random().toString(36).slice(2);function Al(e){if(!e[Dc]){e[Dc]=!0,sv.forEach(function(r){r!=="selectionchange"&&(DT.has(r)||S0(r,!1,e),S0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Dc]||(t[Dc]=!0,S0("selectionchange",!1,t))}}function Qv(e,t,r,n){switch(Iv(t)){case 1:var i=YE;break;case 4:i=JE;break;default:i=Ph}r=i.bind(null,t,r,e),i=void 0,!xd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function C0(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=za(l),o===null)return;if(u=o.tag,u===5||u===6){n=a=o;continue e}l=l.parentNode}}n=n.return}kv(function(){var f=a,d=Ah(r),m=[];e:{var g=Yv.get(e);if(g!==void 0){var _=Oh,y=e;switch(e){case"keypress":if(ou(r)===0)break e;case"keydown":case"keyup":_=hT;break;case"focusin":y="focus",_=_0;break;case"focusout":y="blur",_=_0;break;case"beforeblur":case"afterblur":_=_0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=cg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=tT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=gT;break;case Gv:case Xv:case Kv:_=iT;break;case qv:_=vT;break;case"scroll":_=QE;break;case"wheel":_=yT;break;case"copy":case"cut":case"paste":_=sT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=fg}var v=(t&4)!==0,T=!v&&e==="scroll",k=v?g!==null?g+"Capture":null:g;v=[];for(var E=f,w;E!==null;){w=E;var P=w.stateNode;if(w.tag===5&&P!==null&&(w=P,k!==null&&(P=wl(E,k),P!=null&&v.push(Nl(E,P,w)))),T)break;E=E.return}0<v.length&&(g=new _(g,y,null,r,d),m.push({event:g,listeners:v}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",g&&r!==md&&(y=r.relatedTarget||r.fromElement)&&(za(y)||y[zi]))break e;if((_||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,_?(y=r.relatedTarget||r.toElement,_=f,y=y?za(y):null,y!==null&&(T=ls(y),y!==T||y.tag!==5&&y.tag!==6)&&(y=null)):(_=null,y=f),_!==y)){if(v=cg,P="onMouseLeave",k="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(v=fg,P="onPointerLeave",k="onPointerEnter",E="pointer"),T=_==null?g:Is(_),w=y==null?g:Is(y),g=new v(P,E+"leave",_,r,d),g.target=T,g.relatedTarget=w,P=null,za(d)===f&&(v=new v(k,E+"enter",y,r,d),v.target=w,v.relatedTarget=T,P=v),T=P,_&&y)t:{for(v=_,k=y,E=0,w=v;w;w=Ts(w))E++;for(w=0,P=k;P;P=Ts(P))w++;for(;0<E-w;)v=Ts(v),E--;for(;0<w-E;)k=Ts(k),w--;for(;E--;){if(v===k||k!==null&&v===k.alternate)break t;v=Ts(v),k=Ts(k)}v=null}else v=null;_!==null&&kg(m,g,_,v,!1),y!==null&&T!==null&&kg(m,T,y,v,!0)}}e:{if(g=f?Is(f):window,_=g.nodeName&&g.nodeName.toLowerCase(),_==="select"||_==="input"&&g.type==="file")var I=AT;else if(pg(g))if(Hv)I=PT;else{I=bT;var M=NT}else(_=g.nodeName)&&_.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(I=LT);if(I&&(I=I(e,f))){Uv(m,I,r,d);break e}M&&M(e,g,f),e==="focusout"&&(M=g._wrapperState)&&M.controlled&&g.type==="number"&&ud(g,"number",g.value)}switch(M=f?Is(f):window,e){case"focusin":(pg(M)||M.contentEditable==="true")&&(Rs=M,kd=f,il=null);break;case"focusout":il=kd=Rs=null;break;case"mousedown":Ed=!0;break;case"contextmenu":case"mouseup":case"dragend":Ed=!1,_g(m,r,d);break;case"selectionchange":if(RT)break;case"keydown":case"keyup":_g(m,r,d)}var b;if(Mh)e:{switch(e){case"compositionstart":var U="onCompositionStart";break e;case"compositionend":U="onCompositionEnd";break e;case"compositionupdate":U="onCompositionUpdate";break e}U=void 0}else Os?Bv(e,r)&&(U="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(U="onCompositionStart");U&&(jv&&r.locale!=="ko"&&(Os||U!=="onCompositionStart"?U==="onCompositionEnd"&&Os&&(b=Dv()):(sa=d,Fh="value"in sa?sa.value:sa.textContent,Os=!0)),M=Au(f,U),0<M.length&&(U=new ug(U,e,null,r,d),m.push({event:U,listeners:M}),b?U.data=b:(b=zv(r),b!==null&&(U.data=b)))),(b=kT?ET(e,r):TT(e,r))&&(f=Au(f,"onBeforeInput"),0<f.length&&(d=new ug("onBeforeInput","beforeinput",null,r,d),m.push({event:d,listeners:f}),d.data=b))}Jv(m,t)})}function Nl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Au(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=wl(e,r),a!=null&&n.unshift(Nl(e,a,i)),a=wl(e,t),a!=null&&n.push(Nl(e,a,i))),e=e.return}return n}function Ts(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function kg(e,t,r,n,i){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,f=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&f!==null&&(l=f,i?(u=wl(r,a),u!=null&&o.unshift(Nl(r,u,l))):i||(u=wl(r,a),u!=null&&o.push(Nl(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var jT=/\r\n?/g,BT=/\u0000|\uFFFD/g;function Eg(e){return(typeof e=="string"?e:""+e).replace(jT,`
`).replace(BT,"")}function jc(e,t,r){if(t=Eg(t),Eg(e)!==t&&r)throw Error(Te(425))}function Nu(){}var Td=null,Sd=null;function Cd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ad=typeof setTimeout=="function"?setTimeout:void 0,zT=typeof clearTimeout=="function"?clearTimeout:void 0,Tg=typeof Promise=="function"?Promise:void 0,UT=typeof queueMicrotask=="function"?queueMicrotask:typeof Tg<"u"?function(e){return Tg.resolve(null).then(e).catch(HT)}:Ad;function HT(e){setTimeout(function(){throw e})}function A0(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Tl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Tl(t)}function pa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Sg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),pi="__reactFiber$"+po,bl="__reactProps$"+po,zi="__reactContainer$"+po,Nd="__reactEvents$"+po,VT="__reactListeners$"+po,WT="__reactHandles$"+po;function za(e){var t=e[pi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[zi]||r[pi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Sg(e);e!==null;){if(r=e[pi])return r;e=Sg(e)}return t}e=r,r=e.parentNode}return null}function Kl(e){return e=e[pi]||e[zi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Is(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Te(33))}function gf(e){return e[bl]||null}var bd=[],Ds=-1;function Aa(e){return{current:e}}function Dt(e){0>Ds||(e.current=bd[Ds],bd[Ds]=null,Ds--)}function Pt(e,t){Ds++,bd[Ds]=e.current,e.current=t}var Ea={},Ir=Aa(Ea),tn=Aa(!1),qa=Ea;function no(e,t){var r=e.type.contextTypes;if(!r)return Ea;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function rn(e){return e=e.childContextTypes,e!=null}function bu(){Dt(tn),Dt(Ir)}function Cg(e,t,r){if(Ir.current!==Ea)throw Error(Te(168));Pt(Ir,t),Pt(tn,r)}function e_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Te(108,NE(e)||"Unknown",i));return Wt({},r,n)}function Lu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,qa=Ir.current,Pt(Ir,e),Pt(tn,tn.current),!0}function Ag(e,t,r){var n=e.stateNode;if(!n)throw Error(Te(169));r?(e=e_(e,t,qa),n.__reactInternalMemoizedMergedChildContext=e,Dt(tn),Dt(Ir),Pt(Ir,e)):Dt(tn),Pt(tn,r)}var Li=null,xf=!1,N0=!1;function t_(e){Li===null?Li=[e]:Li.push(e)}function $T(e){xf=!0,t_(e)}function Na(){if(!N0&&Li!==null){N0=!0;var e=0,t=Nt;try{var r=Li;for(Nt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Li=null,xf=!1}catch(i){throw Li!==null&&(Li=Li.slice(e+1)),Cv(Nh,Na),i}finally{Nt=t,N0=!1}}return null}var js=[],Bs=0,Pu=null,Fu=0,Cn=[],An=0,Ya=null,Fi=1,Oi="";function Ma(e,t){js[Bs++]=Fu,js[Bs++]=Pu,Pu=e,Fu=t}function r_(e,t,r){Cn[An++]=Fi,Cn[An++]=Oi,Cn[An++]=Ya,Ya=e;var n=Fi;e=Oi;var i=32-qn(n)-1;n&=~(1<<i),r+=1;var a=32-qn(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Fi=1<<32-qn(t)+i|r<<i|n,Oi=a+e}else Fi=1<<a|r<<i|n,Oi=e}function Dh(e){e.return!==null&&(Ma(e,1),r_(e,1,0))}function jh(e){for(;e===Pu;)Pu=js[--Bs],js[Bs]=null,Fu=js[--Bs],js[Bs]=null;for(;e===Ya;)Ya=Cn[--An],Cn[An]=null,Oi=Cn[--An],Cn[An]=null,Fi=Cn[--An],Cn[An]=null}var dn=null,fn=null,Bt=!1,$n=null;function n_(e,t){var r=bn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Ng(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,dn=e,fn=pa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,dn=e,fn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ya!==null?{id:Fi,overflow:Oi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=bn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,dn=e,fn=null,!0):!1;default:return!1}}function Ld(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Pd(e){if(Bt){var t=fn;if(t){var r=t;if(!Ng(e,t)){if(Ld(e))throw Error(Te(418));t=pa(r.nextSibling);var n=dn;t&&Ng(e,t)?n_(n,r):(e.flags=e.flags&-4097|2,Bt=!1,dn=e)}}else{if(Ld(e))throw Error(Te(418));e.flags=e.flags&-4097|2,Bt=!1,dn=e}}}function bg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;dn=e}function Bc(e){if(e!==dn)return!1;if(!Bt)return bg(e),Bt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cd(e.type,e.memoizedProps)),t&&(t=fn)){if(Ld(e))throw i_(),Error(Te(418));for(;t;)n_(e,t),t=pa(t.nextSibling)}if(bg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){fn=pa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}fn=null}}else fn=dn?pa(e.stateNode.nextSibling):null;return!0}function i_(){for(var e=fn;e;)e=pa(e.nextSibling)}function io(){fn=dn=null,Bt=!1}function Bh(e){$n===null?$n=[e]:$n.push(e)}var ZT=$i.ReactCurrentBatchConfig;function zo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var n=r.stateNode}if(!n)throw Error(Te(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,e))}return e}function zc(e,t){throw e=Object.prototype.toString.call(t),Error(Te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Lg(e){var t=e._init;return t(e._payload)}function a_(e){function t(k,E){if(e){var w=k.deletions;w===null?(k.deletions=[E],k.flags|=16):w.push(E)}}function r(k,E){if(!e)return null;for(;E!==null;)t(k,E),E=E.sibling;return null}function n(k,E){for(k=new Map;E!==null;)E.key!==null?k.set(E.key,E):k.set(E.index,E),E=E.sibling;return k}function i(k,E){return k=va(k,E),k.index=0,k.sibling=null,k}function a(k,E,w){return k.index=w,e?(w=k.alternate,w!==null?(w=w.index,w<E?(k.flags|=2,E):w):(k.flags|=2,E)):(k.flags|=1048576,E)}function o(k){return e&&k.alternate===null&&(k.flags|=2),k}function l(k,E,w,P){return E===null||E.tag!==6?(E=M0(w,k.mode,P),E.return=k,E):(E=i(E,w),E.return=k,E)}function u(k,E,w,P){var I=w.type;return I===Fs?d(k,E,w.props.children,P,w.key):E!==null&&(E.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ea&&Lg(I)===E.type)?(P=i(E,w.props),P.ref=zo(k,E,w),P.return=k,P):(P=pu(w.type,w.key,w.props,null,k.mode,P),P.ref=zo(k,E,w),P.return=k,P)}function f(k,E,w,P){return E===null||E.tag!==4||E.stateNode.containerInfo!==w.containerInfo||E.stateNode.implementation!==w.implementation?(E=I0(w,k.mode,P),E.return=k,E):(E=i(E,w.children||[]),E.return=k,E)}function d(k,E,w,P,I){return E===null||E.tag!==7?(E=Za(w,k.mode,P,I),E.return=k,E):(E=i(E,w),E.return=k,E)}function m(k,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return E=M0(""+E,k.mode,w),E.return=k,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case bc:return w=pu(E.type,E.key,E.props,null,k.mode,w),w.ref=zo(k,null,E),w.return=k,w;case Ps:return E=I0(E,k.mode,w),E.return=k,E;case ea:var P=E._init;return m(k,P(E._payload),w)}if(Zo(E)||Mo(E))return E=Za(E,k.mode,w,null),E.return=k,E;zc(k,E)}return null}function g(k,E,w,P){var I=E!==null?E.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return I!==null?null:l(k,E,""+w,P);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case bc:return w.key===I?u(k,E,w,P):null;case Ps:return w.key===I?f(k,E,w,P):null;case ea:return I=w._init,g(k,E,I(w._payload),P)}if(Zo(w)||Mo(w))return I!==null?null:d(k,E,w,P,null);zc(k,w)}return null}function _(k,E,w,P,I){if(typeof P=="string"&&P!==""||typeof P=="number")return k=k.get(w)||null,l(E,k,""+P,I);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case bc:return k=k.get(P.key===null?w:P.key)||null,u(E,k,P,I);case Ps:return k=k.get(P.key===null?w:P.key)||null,f(E,k,P,I);case ea:var M=P._init;return _(k,E,w,M(P._payload),I)}if(Zo(P)||Mo(P))return k=k.get(w)||null,d(E,k,P,I,null);zc(E,P)}return null}function y(k,E,w,P){for(var I=null,M=null,b=E,U=E=0,j=null;b!==null&&U<w.length;U++){b.index>U?(j=b,b=null):j=b.sibling;var K=g(k,b,w[U],P);if(K===null){b===null&&(b=j);break}e&&b&&K.alternate===null&&t(k,b),E=a(K,E,U),M===null?I=K:M.sibling=K,M=K,b=j}if(U===w.length)return r(k,b),Bt&&Ma(k,U),I;if(b===null){for(;U<w.length;U++)b=m(k,w[U],P),b!==null&&(E=a(b,E,U),M===null?I=b:M.sibling=b,M=b);return Bt&&Ma(k,U),I}for(b=n(k,b);U<w.length;U++)j=_(b,k,U,w[U],P),j!==null&&(e&&j.alternate!==null&&b.delete(j.key===null?U:j.key),E=a(j,E,U),M===null?I=j:M.sibling=j,M=j);return e&&b.forEach(function(V){return t(k,V)}),Bt&&Ma(k,U),I}function v(k,E,w,P){var I=Mo(w);if(typeof I!="function")throw Error(Te(150));if(w=I.call(w),w==null)throw Error(Te(151));for(var M=I=null,b=E,U=E=0,j=null,K=w.next();b!==null&&!K.done;U++,K=w.next()){b.index>U?(j=b,b=null):j=b.sibling;var V=g(k,b,K.value,P);if(V===null){b===null&&(b=j);break}e&&b&&V.alternate===null&&t(k,b),E=a(V,E,U),M===null?I=V:M.sibling=V,M=V,b=j}if(K.done)return r(k,b),Bt&&Ma(k,U),I;if(b===null){for(;!K.done;U++,K=w.next())K=m(k,K.value,P),K!==null&&(E=a(K,E,U),M===null?I=K:M.sibling=K,M=K);return Bt&&Ma(k,U),I}for(b=n(k,b);!K.done;U++,K=w.next())K=_(b,k,U,K.value,P),K!==null&&(e&&K.alternate!==null&&b.delete(K.key===null?U:K.key),E=a(K,E,U),M===null?I=K:M.sibling=K,M=K);return e&&b.forEach(function(G){return t(k,G)}),Bt&&Ma(k,U),I}function T(k,E,w,P){if(typeof w=="object"&&w!==null&&w.type===Fs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case bc:e:{for(var I=w.key,M=E;M!==null;){if(M.key===I){if(I=w.type,I===Fs){if(M.tag===7){r(k,M.sibling),E=i(M,w.props.children),E.return=k,k=E;break e}}else if(M.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ea&&Lg(I)===M.type){r(k,M.sibling),E=i(M,w.props),E.ref=zo(k,M,w),E.return=k,k=E;break e}r(k,M);break}else t(k,M);M=M.sibling}w.type===Fs?(E=Za(w.props.children,k.mode,P,w.key),E.return=k,k=E):(P=pu(w.type,w.key,w.props,null,k.mode,P),P.ref=zo(k,E,w),P.return=k,k=P)}return o(k);case Ps:e:{for(M=w.key;E!==null;){if(E.key===M)if(E.tag===4&&E.stateNode.containerInfo===w.containerInfo&&E.stateNode.implementation===w.implementation){r(k,E.sibling),E=i(E,w.children||[]),E.return=k,k=E;break e}else{r(k,E);break}else t(k,E);E=E.sibling}E=I0(w,k.mode,P),E.return=k,k=E}return o(k);case ea:return M=w._init,T(k,E,M(w._payload),P)}if(Zo(w))return y(k,E,w,P);if(Mo(w))return v(k,E,w,P);zc(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,E!==null&&E.tag===6?(r(k,E.sibling),E=i(E,w),E.return=k,k=E):(r(k,E),E=M0(w,k.mode,P),E.return=k,k=E),o(k)):r(k,E)}return T}var ao=a_(!0),s_=a_(!1),Ou=Aa(null),Ru=null,zs=null,zh=null;function Uh(){zh=zs=Ru=null}function Hh(e){var t=Ou.current;Dt(Ou),e._currentValue=t}function Fd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ys(e,t){Ru=e,zh=zs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qr=!0),e.firstContext=null)}function Fn(e){var t=e._currentValue;if(zh!==e)if(e={context:e,memoizedValue:t,next:null},zs===null){if(Ru===null)throw Error(Te(308));zs=e,Ru.dependencies={lanes:0,firstContext:e}}else zs=zs.next=e;return t}var Ua=null;function Vh(e){Ua===null?Ua=[e]:Ua.push(e)}function o_(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Vh(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ui(e,n)}function Ui(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ta=!1;function Wh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function l_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ma(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,kt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ui(e,r)}return i=n.interleaved,i===null?(t.next=t,Vh(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ui(e,r)}function lu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,bh(e,r)}}function Pg(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Mu(e,t,r,n){var i=e.updateQueue;ta=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,f=u.next;u.next=null,o===null?a=f:o.next=f,o=u;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=f:l.next=f,d.lastBaseUpdate=u))}if(a!==null){var m=i.baseState;o=0,d=f=u=null,l=a;do{var g=l.lane,_=l.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:_,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,v=l;switch(g=t,_=r,v.tag){case 1:if(y=v.payload,typeof y=="function"){m=y.call(_,m,g);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,g=typeof y=="function"?y.call(_,m,g):y,g==null)break e;m=Wt({},m,g);break e;case 2:ta=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else _={eventTime:_,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(f=d=_,u=m):d=d.next=_,o|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(d===null&&(u=m),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Qa|=o,e.lanes=o,e.memoizedState=m}}function Fg(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Te(191,i));i.call(n)}}}var ql={},gi=Aa(ql),Ll=Aa(ql),Pl=Aa(ql);function Ha(e){if(e===ql)throw Error(Te(174));return e}function $h(e,t){switch(Pt(Pl,t),Pt(Ll,e),Pt(gi,ql),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dd(t,e)}Dt(gi),Pt(gi,t)}function so(){Dt(gi),Dt(Ll),Dt(Pl)}function c_(e){Ha(Pl.current);var t=Ha(gi.current),r=dd(t,e.type);t!==r&&(Pt(Ll,e),Pt(gi,r))}function Zh(e){Ll.current===e&&(Dt(gi),Dt(Ll))}var Ut=Aa(0);function Iu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var b0=[];function Gh(){for(var e=0;e<b0.length;e++)b0[e]._workInProgressVersionPrimary=null;b0.length=0}var cu=$i.ReactCurrentDispatcher,L0=$i.ReactCurrentBatchConfig,Ja=0,Ht=null,cr=null,gr=null,Du=!1,al=!1,Fl=0,GT=0;function Ar(){throw Error(Te(321))}function Xh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Qn(e[r],t[r]))return!1;return!0}function Kh(e,t,r,n,i,a){if(Ja=a,Ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,cu.current=e===null||e.memoizedState===null?YT:JT,e=r(n,i),al){a=0;do{if(al=!1,Fl=0,25<=a)throw Error(Te(301));a+=1,gr=cr=null,t.updateQueue=null,cu.current=QT,e=r(n,i)}while(al)}if(cu.current=ju,t=cr!==null&&cr.next!==null,Ja=0,gr=cr=Ht=null,Du=!1,t)throw Error(Te(300));return e}function qh(){var e=Fl!==0;return Fl=0,e}function di(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?Ht.memoizedState=gr=e:gr=gr.next=e,gr}function On(){if(cr===null){var e=Ht.alternate;e=e!==null?e.memoizedState:null}else e=cr.next;var t=gr===null?Ht.memoizedState:gr.next;if(t!==null)gr=t,cr=e;else{if(e===null)throw Error(Te(310));cr=e,e={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},gr===null?Ht.memoizedState=gr=e:gr=gr.next=e}return gr}function Ol(e,t){return typeof t=="function"?t(e):t}function P0(e){var t=On(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=cr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var l=o=null,u=null,f=a;do{var d=f.lane;if((Ja&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var m={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,Ht.lanes|=d,Qa|=d}f=f.next}while(f!==null&&f!==a);u===null?o=n:u.next=l,Qn(n,t.memoizedState)||(Qr=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,Ht.lanes|=a,Qa|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function F0(e){var t=On(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Qn(a,t.memoizedState)||(Qr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function u_(){}function f_(e,t){var r=Ht,n=On(),i=t(),a=!Qn(n.memoizedState,i);if(a&&(n.memoizedState=i,Qr=!0),n=n.queue,Yh(p_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||gr!==null&&gr.memoizedState.tag&1){if(r.flags|=2048,Rl(9,h_.bind(null,r,n,i,t),void 0,null),xr===null)throw Error(Te(349));Ja&30||d_(r,t,i)}return i}function d_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ht.updateQueue,t===null?(t={lastEffect:null,stores:null},Ht.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function h_(e,t,r,n){t.value=r,t.getSnapshot=n,m_(t)&&g_(e)}function p_(e,t,r){return r(function(){m_(t)&&g_(e)})}function m_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qn(e,r)}catch{return!0}}function g_(e){var t=Ui(e,1);t!==null&&Yn(t,e,1,-1)}function Og(e){var t=di();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:e},t.queue=e,e=e.dispatch=qT.bind(null,Ht,e),[t.memoizedState,e]}function Rl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ht.updateQueue,t===null?(t={lastEffect:null,stores:null},Ht.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function x_(){return On().memoizedState}function uu(e,t,r,n){var i=di();Ht.flags|=e,i.memoizedState=Rl(1|t,r,void 0,n===void 0?null:n)}function vf(e,t,r,n){var i=On();n=n===void 0?null:n;var a=void 0;if(cr!==null){var o=cr.memoizedState;if(a=o.destroy,n!==null&&Xh(n,o.deps)){i.memoizedState=Rl(t,r,a,n);return}}Ht.flags|=e,i.memoizedState=Rl(1|t,r,a,n)}function Rg(e,t){return uu(8390656,8,e,t)}function Yh(e,t){return vf(2048,8,e,t)}function v_(e,t){return vf(4,2,e,t)}function __(e,t){return vf(4,4,e,t)}function y_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function w_(e,t,r){return r=r!=null?r.concat([e]):null,vf(4,4,y_.bind(null,t,e),r)}function Jh(){}function k_(e,t){var r=On();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Xh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function E_(e,t){var r=On();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Xh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function T_(e,t,r){return Ja&21?(Qn(r,t)||(r=bv(),Ht.lanes|=r,Qa|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qr=!0),e.memoizedState=r)}function XT(e,t){var r=Nt;Nt=r!==0&&4>r?r:4,e(!0);var n=L0.transition;L0.transition={};try{e(!1),t()}finally{Nt=r,L0.transition=n}}function S_(){return On().memoizedState}function KT(e,t,r){var n=xa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},C_(e))A_(t,r);else if(r=o_(e,t,r,n),r!==null){var i=$r();Yn(r,e,n,i),N_(r,t,n)}}function qT(e,t,r){var n=xa(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(C_(e))A_(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(i.hasEagerState=!0,i.eagerState=l,Qn(l,o)){var u=t.interleaved;u===null?(i.next=i,Vh(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=o_(e,t,i,n),r!==null&&(i=$r(),Yn(r,e,n,i),N_(r,t,n))}}function C_(e){var t=e.alternate;return e===Ht||t!==null&&t===Ht}function A_(e,t){al=Du=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function N_(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,bh(e,r)}}var ju={readContext:Fn,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useInsertionEffect:Ar,useLayoutEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useMutableSource:Ar,useSyncExternalStore:Ar,useId:Ar,unstable_isNewReconciler:!1},YT={readContext:Fn,useCallback:function(e,t){return di().memoizedState=[e,t===void 0?null:t],e},useContext:Fn,useEffect:Rg,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,uu(4194308,4,y_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return uu(4194308,4,e,t)},useInsertionEffect:function(e,t){return uu(4,2,e,t)},useMemo:function(e,t){var r=di();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=di();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=KT.bind(null,Ht,e),[n.memoizedState,e]},useRef:function(e){var t=di();return e={current:e},t.memoizedState=e},useState:Og,useDebugValue:Jh,useDeferredValue:function(e){return di().memoizedState=e},useTransition:function(){var e=Og(!1),t=e[0];return e=XT.bind(null,e[1]),di().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ht,i=di();if(Bt){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=t(),xr===null)throw Error(Te(349));Ja&30||d_(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,Rg(p_.bind(null,n,a,e),[e]),n.flags|=2048,Rl(9,h_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=di(),t=xr.identifierPrefix;if(Bt){var r=Oi,n=Fi;r=(n&~(1<<32-qn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Fl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=GT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},JT={readContext:Fn,useCallback:k_,useContext:Fn,useEffect:Yh,useImperativeHandle:w_,useInsertionEffect:v_,useLayoutEffect:__,useMemo:E_,useReducer:P0,useRef:x_,useState:function(){return P0(Ol)},useDebugValue:Jh,useDeferredValue:function(e){var t=On();return T_(t,cr.memoizedState,e)},useTransition:function(){var e=P0(Ol)[0],t=On().memoizedState;return[e,t]},useMutableSource:u_,useSyncExternalStore:f_,useId:S_,unstable_isNewReconciler:!1},QT={readContext:Fn,useCallback:k_,useContext:Fn,useEffect:Yh,useImperativeHandle:w_,useInsertionEffect:v_,useLayoutEffect:__,useMemo:E_,useReducer:F0,useRef:x_,useState:function(){return F0(Ol)},useDebugValue:Jh,useDeferredValue:function(e){var t=On();return cr===null?t.memoizedState=e:T_(t,cr.memoizedState,e)},useTransition:function(){var e=F0(Ol)[0],t=On().memoizedState;return[e,t]},useMutableSource:u_,useSyncExternalStore:f_,useId:S_,unstable_isNewReconciler:!1};function Vn(e,t){if(e&&e.defaultProps){t=Wt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Od(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Wt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _f={isMounted:function(e){return(e=e._reactInternals)?ls(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=$r(),i=xa(e),a=Mi(n,i);a.payload=t,r!=null&&(a.callback=r),t=ma(e,a,i),t!==null&&(Yn(t,e,i,n),lu(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=$r(),i=xa(e),a=Mi(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ma(e,a,i),t!==null&&(Yn(t,e,i,n),lu(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=$r(),n=xa(e),i=Mi(r,n);i.tag=2,t!=null&&(i.callback=t),t=ma(e,i,n),t!==null&&(Yn(t,e,n,r),lu(t,e,n))}};function Mg(e,t,r,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!Cl(r,n)||!Cl(i,a):!0}function b_(e,t,r){var n=!1,i=Ea,a=t.contextType;return typeof a=="object"&&a!==null?a=Fn(a):(i=rn(t)?qa:Ir.current,n=t.contextTypes,a=(n=n!=null)?no(e,i):Ea),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_f,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ig(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_f.enqueueReplaceState(t,t.state,null)}function Rd(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Wh(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Fn(a):(a=rn(t)?qa:Ir.current,i.context=no(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Od(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&_f.enqueueReplaceState(i,i.state,null),Mu(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function oo(e,t){try{var r="",n=t;do r+=AE(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function O0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Md(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var eS=typeof WeakMap=="function"?WeakMap:Map;function L_(e,t,r){r=Mi(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){zu||(zu=!0,$d=n),Md(e,t)},r}function P_(e,t,r){r=Mi(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Md(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Md(e,t),typeof n!="function"&&(ga===null?ga=new Set([this]):ga.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Dg(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new eS;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=pS.bind(null,e,t,r),t.then(e,e))}function jg(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Bg(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Mi(-1,1),t.tag=2,ma(r,t,1))),r.lanes|=1),e)}var tS=$i.ReactCurrentOwner,Qr=!1;function Ur(e,t,r,n){t.child=e===null?s_(t,null,r,n):ao(t,e.child,r,n)}function zg(e,t,r,n,i){r=r.render;var a=t.ref;return Ys(t,i),n=Kh(e,t,r,n,a,i),r=qh(),e!==null&&!Qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hi(e,t,i)):(Bt&&r&&Dh(t),t.flags|=1,Ur(e,t,n,i),t.child)}function Ug(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!sp(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,F_(e,t,a,n,i)):(e=pu(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:Cl,r(o,n)&&e.ref===t.ref)return Hi(e,t,i)}return t.flags|=1,e=va(a,n),e.ref=t.ref,e.return=t,t.child=e}function F_(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(Cl(a,n)&&e.ref===t.ref)if(Qr=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(Qr=!0);else return t.lanes=e.lanes,Hi(e,t,i)}return Id(e,t,r,n,i)}function O_(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(Hs,sn),sn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pt(Hs,sn),sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Pt(Hs,sn),sn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Pt(Hs,sn),sn|=n;return Ur(e,t,i,r),t.child}function R_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Id(e,t,r,n,i){var a=rn(r)?qa:Ir.current;return a=no(t,a),Ys(t,i),r=Kh(e,t,r,n,a,i),n=qh(),e!==null&&!Qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hi(e,t,i)):(Bt&&n&&Dh(t),t.flags|=1,Ur(e,t,r,i),t.child)}function Hg(e,t,r,n,i){if(rn(r)){var a=!0;Lu(t)}else a=!1;if(Ys(t,i),t.stateNode===null)fu(e,t),b_(t,r,n),Rd(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,f=r.contextType;typeof f=="object"&&f!==null?f=Fn(f):(f=rn(r)?qa:Ir.current,f=no(t,f));var d=r.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==f)&&Ig(t,o,n,f),ta=!1;var g=t.memoizedState;o.state=g,Mu(t,n,o,i),u=t.memoizedState,l!==n||g!==u||tn.current||ta?(typeof d=="function"&&(Od(t,r,d,n),u=t.memoizedState),(l=ta||Mg(t,r,l,n,g,u,f))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=f,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,l_(e,t),l=t.memoizedProps,f=t.type===t.elementType?l:Vn(t.type,l),o.props=f,m=t.pendingProps,g=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=Fn(u):(u=rn(r)?qa:Ir.current,u=no(t,u));var _=r.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==u)&&Ig(t,o,n,u),ta=!1,g=t.memoizedState,o.state=g,Mu(t,n,o,i);var y=t.memoizedState;l!==m||g!==y||tn.current||ta?(typeof _=="function"&&(Od(t,r,_,n),y=t.memoizedState),(f=ta||Mg(t,r,f,n,g,y,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=u,n=f):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return Dd(e,t,r,n,a,i)}function Dd(e,t,r,n,i,a){R_(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&Ag(t,r,!1),Hi(e,t,a);n=t.stateNode,tS.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ao(t,e.child,null,a),t.child=ao(t,null,l,a)):Ur(e,t,l,a),t.memoizedState=n.state,i&&Ag(t,r,!0),t.child}function M_(e){var t=e.stateNode;t.pendingContext?Cg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Cg(e,t.context,!1),$h(e,t.containerInfo)}function Vg(e,t,r,n,i){return io(),Bh(i),t.flags|=256,Ur(e,t,r,n),t.child}var jd={dehydrated:null,treeContext:null,retryLane:0};function Bd(e){return{baseLanes:e,cachePool:null,transitions:null}}function I_(e,t,r){var n=t.pendingProps,i=Ut.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Pt(Ut,i&1),e===null)return Pd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=kf(o,n,0,null),e=Za(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Bd(r),t.memoizedState=jd,e):Qh(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return rS(e,t,o,n,l,i,r);if(a){a=n.fallback,o=t.mode,i=e.child,l=i.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=va(i,u),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=va(l,a):(a=Za(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?Bd(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=jd,n}return a=e.child,e=a.sibling,n=va(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Qh(e,t){return t=kf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Uc(e,t,r,n){return n!==null&&Bh(n),ao(t,e.child,null,r),e=Qh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rS(e,t,r,n,i,a,o){if(r)return t.flags&256?(t.flags&=-257,n=O0(Error(Te(422))),Uc(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=kf({mode:"visible",children:n.children},i,0,null),a=Za(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&ao(t,e.child,null,o),t.child.memoizedState=Bd(o),t.memoizedState=jd,a);if(!(t.mode&1))return Uc(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(Te(419)),n=O0(a,n,void 0),Uc(e,t,o,n)}if(l=(o&e.childLanes)!==0,Qr||l){if(n=xr,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Ui(e,i),Yn(n,e,i,-1))}return ap(),n=O0(Error(Te(421))),Uc(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=mS.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,fn=pa(i.nextSibling),dn=t,Bt=!0,$n=null,e!==null&&(Cn[An++]=Fi,Cn[An++]=Oi,Cn[An++]=Ya,Fi=e.id,Oi=e.overflow,Ya=t),t=Qh(t,n.children),t.flags|=4096,t)}function Wg(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Fd(e.return,t,r)}function R0(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function D_(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Ur(e,t,n.children,r),n=Ut.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Wg(e,r,t);else if(e.tag===19)Wg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Pt(Ut,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Iu(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),R0(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Iu(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}R0(t,!0,r,null,a);break;case"together":R0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function fu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hi(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Qa|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Te(153));if(t.child!==null){for(e=t.child,r=va(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=va(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function nS(e,t,r){switch(t.tag){case 3:M_(t),io();break;case 5:c_(t);break;case 1:rn(t.type)&&Lu(t);break;case 4:$h(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Pt(Ou,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Pt(Ut,Ut.current&1),t.flags|=128,null):r&t.child.childLanes?I_(e,t,r):(Pt(Ut,Ut.current&1),e=Hi(e,t,r),e!==null?e.sibling:null);Pt(Ut,Ut.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return D_(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pt(Ut,Ut.current),n)break;return null;case 22:case 23:return t.lanes=0,O_(e,t,r)}return Hi(e,t,r)}var j_,zd,B_,z_;j_=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zd=function(){};B_=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ha(gi.current);var a=null;switch(r){case"input":i=ld(e,i),n=ld(e,n),a=[];break;case"select":i=Wt({},i,{value:void 0}),n=Wt({},n,{value:void 0}),a=[];break;case"textarea":i=fd(e,i),n=fd(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Nu)}hd(r,n);var o;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var l=i[f];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(_l.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var u=n[f];if(l=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&u!==l&&(u!=null||l!=null))if(f==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(a||(a=[]),a.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(_l.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&It("scroll",e),a||l===u||(a=[])):(a=a||[]).push(f,u))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};z_=function(e,t,r,n){r!==n&&(t.flags|=4)};function Uo(e,t){if(!Bt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function iS(e,t,r){var n=t.pendingProps;switch(jh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(t),null;case 1:return rn(t.type)&&bu(),Nr(t),null;case 3:return n=t.stateNode,so(),Dt(tn),Dt(Ir),Gh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Bc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$n!==null&&(Xd($n),$n=null))),zd(e,t),Nr(t),null;case 5:Zh(t);var i=Ha(Pl.current);if(r=t.type,e!==null&&t.stateNode!=null)B_(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Te(166));return Nr(t),null}if(e=Ha(gi.current),Bc(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[pi]=t,n[bl]=a,e=(t.mode&1)!==0,r){case"dialog":It("cancel",n),It("close",n);break;case"iframe":case"object":case"embed":It("load",n);break;case"video":case"audio":for(i=0;i<Xo.length;i++)It(Xo[i],n);break;case"source":It("error",n);break;case"img":case"image":case"link":It("error",n),It("load",n);break;case"details":It("toggle",n);break;case"input":Qm(n,a),It("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},It("invalid",n);break;case"textarea":tg(n,a),It("invalid",n)}hd(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&jc(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&jc(n.textContent,l,e),i=["children",""+l]):_l.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&It("scroll",n)}switch(r){case"input":Lc(n),eg(n,a,!0);break;case"textarea":Lc(n),rg(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Nu)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=pv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[pi]=t,e[bl]=n,j_(e,t,!1,!1),t.stateNode=e;e:{switch(o=pd(r,n),r){case"dialog":It("cancel",e),It("close",e),i=n;break;case"iframe":case"object":case"embed":It("load",e),i=n;break;case"video":case"audio":for(i=0;i<Xo.length;i++)It(Xo[i],e);i=n;break;case"source":It("error",e),i=n;break;case"img":case"image":case"link":It("error",e),It("load",e),i=n;break;case"details":It("toggle",e),i=n;break;case"input":Qm(e,n),i=ld(e,n),It("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Wt({},n,{value:void 0}),It("invalid",e);break;case"textarea":tg(e,n),i=fd(e,n),It("invalid",e);break;default:i=n}hd(r,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var u=l[a];a==="style"?xv(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&mv(e,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&yl(e,u):typeof u=="number"&&yl(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(_l.hasOwnProperty(a)?u!=null&&a==="onScroll"&&It("scroll",e):u!=null&&Eh(e,a,u,o))}switch(r){case"input":Lc(e),eg(e,n,!1);break;case"textarea":Lc(e),rg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ka(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Gs(e,!!n.multiple,a,!1):n.defaultValue!=null&&Gs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Nu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nr(t),null;case 6:if(e&&t.stateNode!=null)z_(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Te(166));if(r=Ha(Pl.current),Ha(gi.current),Bc(t)){if(n=t.stateNode,r=t.memoizedProps,n[pi]=t,(a=n.nodeValue!==r)&&(e=dn,e!==null))switch(e.tag){case 3:jc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jc(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[pi]=t,t.stateNode=n}return Nr(t),null;case 13:if(Dt(Ut),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Bt&&fn!==null&&t.mode&1&&!(t.flags&128))i_(),io(),t.flags|=98560,a=!1;else if(a=Bc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Te(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Te(317));a[pi]=t}else io(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nr(t),a=!1}else $n!==null&&(Xd($n),$n=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ut.current&1?ur===0&&(ur=3):ap())),t.updateQueue!==null&&(t.flags|=4),Nr(t),null);case 4:return so(),zd(e,t),e===null&&Al(t.stateNode.containerInfo),Nr(t),null;case 10:return Hh(t.type._context),Nr(t),null;case 17:return rn(t.type)&&bu(),Nr(t),null;case 19:if(Dt(Ut),a=t.memoizedState,a===null)return Nr(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Uo(a,!1);else{if(ur!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Iu(e),o!==null){for(t.flags|=128,Uo(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Pt(Ut,Ut.current&1|2),t.child}e=e.sibling}a.tail!==null&&Jt()>lo&&(t.flags|=128,n=!0,Uo(a,!1),t.lanes=4194304)}else{if(!n)if(e=Iu(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Uo(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Bt)return Nr(t),null}else 2*Jt()-a.renderingStartTime>lo&&r!==1073741824&&(t.flags|=128,n=!0,Uo(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Jt(),t.sibling=null,r=Ut.current,Pt(Ut,n?r&1|2:r&1),t):(Nr(t),null);case 22:case 23:return ip(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?sn&1073741824&&(Nr(t),t.subtreeFlags&6&&(t.flags|=8192)):Nr(t),null;case 24:return null;case 25:return null}throw Error(Te(156,t.tag))}function aS(e,t){switch(jh(t),t.tag){case 1:return rn(t.type)&&bu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return so(),Dt(tn),Dt(Ir),Gh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Zh(t),null;case 13:if(Dt(Ut),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Te(340));io()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Dt(Ut),null;case 4:return so(),null;case 10:return Hh(t.type._context),null;case 22:case 23:return ip(),null;case 24:return null;default:return null}}var Hc=!1,Pr=!1,sS=typeof WeakSet=="function"?WeakSet:Set,je=null;function Us(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Gt(e,t,n)}else r.current=null}function Ud(e,t,r){try{r()}catch(n){Gt(e,t,n)}}var $g=!1;function oS(e,t){if(Td=Su,e=$v(),Ih(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,f=0,d=0,m=e,g=null;t:for(;;){for(var _;m!==r||i!==0&&m.nodeType!==3||(l=o+i),m!==a||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(_=m.firstChild)!==null;)g=m,m=_;for(;;){if(m===e)break t;if(g===r&&++f===i&&(l=o),g===a&&++d===n&&(u=o),(_=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=_}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Sd={focusedElem:e,selectionRange:r},Su=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,T=y.memoizedState,k=t.stateNode,E=k.getSnapshotBeforeUpdate(t.elementType===t.type?v:Vn(t.type,v),T);k.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(P){Gt(t,t.return,P)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return y=$g,$g=!1,y}function sl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Ud(t,r,a)}i=i.next}while(i!==n)}}function yf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Hd(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function U_(e){var t=e.alternate;t!==null&&(e.alternate=null,U_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[pi],delete t[bl],delete t[Nd],delete t[VT],delete t[WT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function H_(e){return e.tag===5||e.tag===3||e.tag===4}function Zg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||H_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Nu));else if(n!==4&&(e=e.child,e!==null))for(Vd(e,t,r),e=e.sibling;e!==null;)Vd(e,t,r),e=e.sibling}function Wd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Wd(e,t,r),e=e.sibling;e!==null;)Wd(e,t,r),e=e.sibling}var yr=null,Wn=!1;function Ji(e,t,r){for(r=r.child;r!==null;)V_(e,t,r),r=r.sibling}function V_(e,t,r){if(mi&&typeof mi.onCommitFiberUnmount=="function")try{mi.onCommitFiberUnmount(df,r)}catch{}switch(r.tag){case 5:Pr||Us(r,t);case 6:var n=yr,i=Wn;yr=null,Ji(e,t,r),yr=n,Wn=i,yr!==null&&(Wn?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&(Wn?(e=yr,r=r.stateNode,e.nodeType===8?A0(e.parentNode,r):e.nodeType===1&&A0(e,r),Tl(e)):A0(yr,r.stateNode));break;case 4:n=yr,i=Wn,yr=r.stateNode.containerInfo,Wn=!0,Ji(e,t,r),yr=n,Wn=i;break;case 0:case 11:case 14:case 15:if(!Pr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Ud(r,t,o),i=i.next}while(i!==n)}Ji(e,t,r);break;case 1:if(!Pr&&(Us(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Gt(r,t,l)}Ji(e,t,r);break;case 21:Ji(e,t,r);break;case 22:r.mode&1?(Pr=(n=Pr)||r.memoizedState!==null,Ji(e,t,r),Pr=n):Ji(e,t,r);break;default:Ji(e,t,r)}}function Gg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new sS),t.forEach(function(n){var i=gS.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function zn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:yr=l.stateNode,Wn=!1;break e;case 3:yr=l.stateNode.containerInfo,Wn=!0;break e;case 4:yr=l.stateNode.containerInfo,Wn=!0;break e}l=l.return}if(yr===null)throw Error(Te(160));V_(a,o,i),yr=null,Wn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){Gt(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)W_(t,e),t=t.sibling}function W_(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(zn(t,e),li(e),n&4){try{sl(3,e,e.return),yf(3,e)}catch(v){Gt(e,e.return,v)}try{sl(5,e,e.return)}catch(v){Gt(e,e.return,v)}}break;case 1:zn(t,e),li(e),n&512&&r!==null&&Us(r,r.return);break;case 5:if(zn(t,e),li(e),n&512&&r!==null&&Us(r,r.return),e.flags&32){var i=e.stateNode;try{yl(i,"")}catch(v){Gt(e,e.return,v)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&dv(i,a),pd(l,o);var f=pd(l,a);for(o=0;o<u.length;o+=2){var d=u[o],m=u[o+1];d==="style"?xv(i,m):d==="dangerouslySetInnerHTML"?mv(i,m):d==="children"?yl(i,m):Eh(i,d,m,f)}switch(l){case"input":cd(i,a);break;case"textarea":hv(i,a);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var _=a.value;_!=null?Gs(i,!!a.multiple,_,!1):g!==!!a.multiple&&(a.defaultValue!=null?Gs(i,!!a.multiple,a.defaultValue,!0):Gs(i,!!a.multiple,a.multiple?[]:"",!1))}i[bl]=a}catch(v){Gt(e,e.return,v)}}break;case 6:if(zn(t,e),li(e),n&4){if(e.stateNode===null)throw Error(Te(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(v){Gt(e,e.return,v)}}break;case 3:if(zn(t,e),li(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Tl(t.containerInfo)}catch(v){Gt(e,e.return,v)}break;case 4:zn(t,e),li(e);break;case 13:zn(t,e),li(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(rp=Jt())),n&4&&Gg(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Pr=(f=Pr)||d,zn(t,e),Pr=f):zn(t,e),li(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for(je=e,d=e.child;d!==null;){for(m=je=d;je!==null;){switch(g=je,_=g.child,g.tag){case 0:case 11:case 14:case 15:sl(4,g,g.return);break;case 1:Us(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(v){Gt(n,r,v)}}break;case 5:Us(g,g.return);break;case 22:if(g.memoizedState!==null){Kg(m);continue}}_!==null?(_.return=g,je=_):Kg(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{i=m.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=gv("display",o))}catch(v){Gt(e,e.return,v)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(v){Gt(e,e.return,v)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:zn(t,e),li(e),n&4&&Gg(e);break;case 21:break;default:zn(t,e),li(e)}}function li(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(H_(r)){var n=r;break e}r=r.return}throw Error(Te(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(yl(i,""),n.flags&=-33);var a=Zg(e);Wd(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Zg(e);Vd(e,l,o);break;default:throw Error(Te(161))}}catch(u){Gt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lS(e,t,r){je=e,$_(e)}function $_(e,t,r){for(var n=(e.mode&1)!==0;je!==null;){var i=je,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Hc;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||Pr;l=Hc;var f=Pr;if(Hc=o,(Pr=u)&&!f)for(je=i;je!==null;)o=je,u=o.child,o.tag===22&&o.memoizedState!==null?qg(i):u!==null?(u.return=o,je=u):qg(i);for(;a!==null;)je=a,$_(a),a=a.sibling;je=i,Hc=l,Pr=f}Xg(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,je=a):Xg(e)}}function Xg(e){for(;je!==null;){var t=je;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Pr||yf(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Pr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Vn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Fg(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Fg(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Tl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}Pr||t.flags&512&&Hd(t)}catch(g){Gt(t,t.return,g)}}if(t===e){je=null;break}if(r=t.sibling,r!==null){r.return=t.return,je=r;break}je=t.return}}function Kg(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var r=t.sibling;if(r!==null){r.return=t.return,je=r;break}je=t.return}}function qg(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{yf(4,t)}catch(u){Gt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){Gt(t,i,u)}}var a=t.return;try{Hd(t)}catch(u){Gt(t,a,u)}break;case 5:var o=t.return;try{Hd(t)}catch(u){Gt(t,o,u)}}}catch(u){Gt(t,t.return,u)}if(t===e){je=null;break}var l=t.sibling;if(l!==null){l.return=t.return,je=l;break}je=t.return}}var cS=Math.ceil,Bu=$i.ReactCurrentDispatcher,ep=$i.ReactCurrentOwner,Pn=$i.ReactCurrentBatchConfig,kt=0,xr=null,ar=null,kr=0,sn=0,Hs=Aa(0),ur=0,Ml=null,Qa=0,wf=0,tp=0,ol=null,Jr=null,rp=0,lo=1/0,Ni=null,zu=!1,$d=null,ga=null,Vc=!1,oa=null,Uu=0,ll=0,Zd=null,du=-1,hu=0;function $r(){return kt&6?Jt():du!==-1?du:du=Jt()}function xa(e){return e.mode&1?kt&2&&kr!==0?kr&-kr:ZT.transition!==null?(hu===0&&(hu=bv()),hu):(e=Nt,e!==0||(e=window.event,e=e===void 0?16:Iv(e.type)),e):1}function Yn(e,t,r,n){if(50<ll)throw ll=0,Zd=null,Error(Te(185));Gl(e,r,n),(!(kt&2)||e!==xr)&&(e===xr&&(!(kt&2)&&(wf|=r),ur===4&&na(e,kr)),nn(e,n),r===1&&kt===0&&!(t.mode&1)&&(lo=Jt()+500,xf&&Na()))}function nn(e,t){var r=e.callbackNode;ZE(e,t);var n=Tu(e,e===xr?kr:0);if(n===0)r!==null&&ag(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&ag(r),t===1)e.tag===0?$T(Yg.bind(null,e)):t_(Yg.bind(null,e)),UT(function(){!(kt&6)&&Na()}),r=null;else{switch(Lv(n)){case 1:r=Nh;break;case 4:r=Av;break;case 16:r=Eu;break;case 536870912:r=Nv;break;default:r=Eu}r=Q_(r,Z_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Z_(e,t){if(du=-1,hu=0,kt&6)throw Error(Te(327));var r=e.callbackNode;if(Js()&&e.callbackNode!==r)return null;var n=Tu(e,e===xr?kr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Hu(e,n);else{t=n;var i=kt;kt|=2;var a=X_();(xr!==e||kr!==t)&&(Ni=null,lo=Jt()+500,$a(e,t));do try{dS();break}catch(l){G_(e,l)}while(!0);Uh(),Bu.current=a,kt=i,ar!==null?t=0:(xr=null,kr=0,t=ur)}if(t!==0){if(t===2&&(i=_d(e),i!==0&&(n=i,t=Gd(e,i))),t===1)throw r=Ml,$a(e,0),na(e,n),nn(e,Jt()),r;if(t===6)na(e,n);else{if(i=e.current.alternate,!(n&30)&&!uS(i)&&(t=Hu(e,n),t===2&&(a=_d(e),a!==0&&(n=a,t=Gd(e,a))),t===1))throw r=Ml,$a(e,0),na(e,n),nn(e,Jt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Te(345));case 2:Ia(e,Jr,Ni);break;case 3:if(na(e,n),(n&130023424)===n&&(t=rp+500-Jt(),10<t)){if(Tu(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){$r(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ad(Ia.bind(null,e,Jr,Ni),t);break}Ia(e,Jr,Ni);break;case 4:if(na(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-qn(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=Jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*cS(n/1960))-n,10<n){e.timeoutHandle=Ad(Ia.bind(null,e,Jr,Ni),n);break}Ia(e,Jr,Ni);break;case 5:Ia(e,Jr,Ni);break;default:throw Error(Te(329))}}}return nn(e,Jt()),e.callbackNode===r?Z_.bind(null,e):null}function Gd(e,t){var r=ol;return e.current.memoizedState.isDehydrated&&($a(e,t).flags|=256),e=Hu(e,t),e!==2&&(t=Jr,Jr=r,t!==null&&Xd(t)),e}function Xd(e){Jr===null?Jr=e:Jr.push.apply(Jr,e)}function uS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Qn(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function na(e,t){for(t&=~tp,t&=~wf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-qn(t),n=1<<r;e[r]=-1,t&=~n}}function Yg(e){if(kt&6)throw Error(Te(327));Js();var t=Tu(e,0);if(!(t&1))return nn(e,Jt()),null;var r=Hu(e,t);if(e.tag!==0&&r===2){var n=_d(e);n!==0&&(t=n,r=Gd(e,n))}if(r===1)throw r=Ml,$a(e,0),na(e,t),nn(e,Jt()),r;if(r===6)throw Error(Te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ia(e,Jr,Ni),nn(e,Jt()),null}function np(e,t){var r=kt;kt|=1;try{return e(t)}finally{kt=r,kt===0&&(lo=Jt()+500,xf&&Na())}}function es(e){oa!==null&&oa.tag===0&&!(kt&6)&&Js();var t=kt;kt|=1;var r=Pn.transition,n=Nt;try{if(Pn.transition=null,Nt=1,e)return e()}finally{Nt=n,Pn.transition=r,kt=t,!(kt&6)&&Na()}}function ip(){sn=Hs.current,Dt(Hs)}function $a(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,zT(r)),ar!==null)for(r=ar.return;r!==null;){var n=r;switch(jh(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&bu();break;case 3:so(),Dt(tn),Dt(Ir),Gh();break;case 5:Zh(n);break;case 4:so();break;case 13:Dt(Ut);break;case 19:Dt(Ut);break;case 10:Hh(n.type._context);break;case 22:case 23:ip()}r=r.return}if(xr=e,ar=e=va(e.current,null),kr=sn=t,ur=0,Ml=null,tp=wf=Qa=0,Jr=ol=null,Ua!==null){for(t=0;t<Ua.length;t++)if(r=Ua[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}Ua=null}return e}function G_(e,t){do{var r=ar;try{if(Uh(),cu.current=ju,Du){for(var n=Ht.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Du=!1}if(Ja=0,gr=cr=Ht=null,al=!1,Fl=0,ep.current=null,r===null||r.return===null){ur=1,Ml=t,ar=null;break}e:{var a=e,o=r.return,l=r,u=t;if(t=kr,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=jg(o);if(_!==null){_.flags&=-257,Bg(_,o,l,a,t),_.mode&1&&Dg(a,f,t),t=_,u=f;var y=t.updateQueue;if(y===null){var v=new Set;v.add(u),t.updateQueue=v}else y.add(u);break e}else{if(!(t&1)){Dg(a,f,t),ap();break e}u=Error(Te(426))}}else if(Bt&&l.mode&1){var T=jg(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Bg(T,o,l,a,t),Bh(oo(u,l));break e}}a=u=oo(u,l),ur!==4&&(ur=2),ol===null?ol=[a]:ol.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var k=L_(a,u,t);Pg(a,k);break e;case 1:l=u;var E=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof E.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ga===null||!ga.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var P=P_(a,l,t);Pg(a,P);break e}}a=a.return}while(a!==null)}q_(r)}catch(I){t=I,ar===r&&r!==null&&(ar=r=r.return);continue}break}while(!0)}function X_(){var e=Bu.current;return Bu.current=ju,e===null?ju:e}function ap(){(ur===0||ur===3||ur===2)&&(ur=4),xr===null||!(Qa&268435455)&&!(wf&268435455)||na(xr,kr)}function Hu(e,t){var r=kt;kt|=2;var n=X_();(xr!==e||kr!==t)&&(Ni=null,$a(e,t));do try{fS();break}catch(i){G_(e,i)}while(!0);if(Uh(),kt=r,Bu.current=n,ar!==null)throw Error(Te(261));return xr=null,kr=0,ur}function fS(){for(;ar!==null;)K_(ar)}function dS(){for(;ar!==null&&!DE();)K_(ar)}function K_(e){var t=J_(e.alternate,e,sn);e.memoizedProps=e.pendingProps,t===null?q_(e):ar=t,ep.current=null}function q_(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=aS(r,t),r!==null){r.flags&=32767,ar=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ur=6,ar=null;return}}else if(r=iS(r,t,sn),r!==null){ar=r;return}if(t=t.sibling,t!==null){ar=t;return}ar=t=e}while(t!==null);ur===0&&(ur=5)}function Ia(e,t,r){var n=Nt,i=Pn.transition;try{Pn.transition=null,Nt=1,hS(e,t,r,n)}finally{Pn.transition=i,Nt=n}return null}function hS(e,t,r,n){do Js();while(oa!==null);if(kt&6)throw Error(Te(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Te(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(GE(e,a),e===xr&&(ar=xr=null,kr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Vc||(Vc=!0,Q_(Eu,function(){return Js(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Pn.transition,Pn.transition=null;var o=Nt;Nt=1;var l=kt;kt|=4,ep.current=null,oS(e,r),W_(r,e),OT(Sd),Su=!!Td,Sd=Td=null,e.current=r,lS(r),jE(),kt=l,Nt=o,Pn.transition=a}else e.current=r;if(Vc&&(Vc=!1,oa=e,Uu=i),a=e.pendingLanes,a===0&&(ga=null),UE(r.stateNode),nn(e,Jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(zu)throw zu=!1,e=$d,$d=null,e;return Uu&1&&e.tag!==0&&Js(),a=e.pendingLanes,a&1?e===Zd?ll++:(ll=0,Zd=e):ll=0,Na(),null}function Js(){if(oa!==null){var e=Lv(Uu),t=Pn.transition,r=Nt;try{if(Pn.transition=null,Nt=16>e?16:e,oa===null)var n=!1;else{if(e=oa,oa=null,Uu=0,kt&6)throw Error(Te(331));var i=kt;for(kt|=4,je=e.current;je!==null;){var a=je,o=a.child;if(je.flags&16){var l=a.deletions;if(l!==null){for(var u=0;u<l.length;u++){var f=l[u];for(je=f;je!==null;){var d=je;switch(d.tag){case 0:case 11:case 15:sl(8,d,a)}var m=d.child;if(m!==null)m.return=d,je=m;else for(;je!==null;){d=je;var g=d.sibling,_=d.return;if(U_(d),d===f){je=null;break}if(g!==null){g.return=_,je=g;break}je=_}}}var y=a.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var T=v.sibling;v.sibling=null,v=T}while(v!==null)}}je=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,je=o;else e:for(;je!==null;){if(a=je,a.flags&2048)switch(a.tag){case 0:case 11:case 15:sl(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,je=k;break e}je=a.return}}var E=e.current;for(je=E;je!==null;){o=je;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,je=w;else e:for(o=E;je!==null;){if(l=je,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:yf(9,l)}}catch(I){Gt(l,l.return,I)}if(l===o){je=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,je=P;break e}je=l.return}}if(kt=i,Na(),mi&&typeof mi.onPostCommitFiberRoot=="function")try{mi.onPostCommitFiberRoot(df,e)}catch{}n=!0}return n}finally{Nt=r,Pn.transition=t}}return!1}function Jg(e,t,r){t=oo(r,t),t=L_(e,t,1),e=ma(e,t,1),t=$r(),e!==null&&(Gl(e,1,t),nn(e,t))}function Gt(e,t,r){if(e.tag===3)Jg(e,e,r);else for(;t!==null;){if(t.tag===3){Jg(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ga===null||!ga.has(n))){e=oo(r,e),e=P_(t,e,1),t=ma(t,e,1),e=$r(),t!==null&&(Gl(t,1,e),nn(t,e));break}}t=t.return}}function pS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=$r(),e.pingedLanes|=e.suspendedLanes&r,xr===e&&(kr&r)===r&&(ur===4||ur===3&&(kr&130023424)===kr&&500>Jt()-rp?$a(e,0):tp|=r),nn(e,t)}function Y_(e,t){t===0&&(e.mode&1?(t=Oc,Oc<<=1,!(Oc&130023424)&&(Oc=4194304)):t=1);var r=$r();e=Ui(e,t),e!==null&&(Gl(e,t,r),nn(e,r))}function mS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Y_(e,r)}function gS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Te(314))}n!==null&&n.delete(t),Y_(e,r)}var J_;J_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||tn.current)Qr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qr=!1,nS(e,t,r);Qr=!!(e.flags&131072)}else Qr=!1,Bt&&t.flags&1048576&&r_(t,Fu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;fu(e,t),e=t.pendingProps;var i=no(t,Ir.current);Ys(t,r),i=Kh(null,t,n,e,i,r);var a=qh();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,rn(n)?(a=!0,Lu(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Wh(t),i.updater=_f,t.stateNode=i,i._reactInternals=t,Rd(t,n,e,r),t=Dd(null,t,n,!0,a,r)):(t.tag=0,Bt&&a&&Dh(t),Ur(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(fu(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=vS(n),e=Vn(n,e),i){case 0:t=Id(null,t,n,e,r);break e;case 1:t=Hg(null,t,n,e,r);break e;case 11:t=zg(null,t,n,e,r);break e;case 14:t=Ug(null,t,n,Vn(n.type,e),r);break e}throw Error(Te(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),Id(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),Hg(e,t,n,i,r);case 3:e:{if(M_(t),e===null)throw Error(Te(387));n=t.pendingProps,a=t.memoizedState,i=a.element,l_(e,t),Mu(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=oo(Error(Te(423)),t),t=Vg(e,t,n,r,i);break e}else if(n!==i){i=oo(Error(Te(424)),t),t=Vg(e,t,n,r,i);break e}else for(fn=pa(t.stateNode.containerInfo.firstChild),dn=t,Bt=!0,$n=null,r=s_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(io(),n===i){t=Hi(e,t,r);break e}Ur(e,t,n,r)}t=t.child}return t;case 5:return c_(t),e===null&&Pd(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Cd(n,i)?o=null:a!==null&&Cd(n,a)&&(t.flags|=32),R_(e,t),Ur(e,t,o,r),t.child;case 6:return e===null&&Pd(t),null;case 13:return I_(e,t,r);case 4:return $h(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ao(t,null,n,r):Ur(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),zg(e,t,n,i,r);case 7:return Ur(e,t,t.pendingProps,r),t.child;case 8:return Ur(e,t,t.pendingProps.children,r),t.child;case 12:return Ur(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Pt(Ou,n._currentValue),n._currentValue=o,a!==null)if(Qn(a.value,o)){if(a.children===i.children&&!tn.current){t=Hi(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=Mi(-1,r&-r),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),Fd(a.return,r,t),l.lanes|=r;break}u=u.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Te(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Fd(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Ur(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ys(t,r),i=Fn(i),n=n(i),t.flags|=1,Ur(e,t,n,r),t.child;case 14:return n=t.type,i=Vn(n,t.pendingProps),i=Vn(n.type,i),Ug(e,t,n,i,r);case 15:return F_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),fu(e,t),t.tag=1,rn(n)?(e=!0,Lu(t)):e=!1,Ys(t,r),b_(t,n,i),Rd(t,n,i,r),Dd(null,t,n,!0,e,r);case 19:return D_(e,t,r);case 22:return O_(e,t,r)}throw Error(Te(156,t.tag))};function Q_(e,t){return Cv(e,t)}function xS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(e,t,r,n){return new xS(e,t,r,n)}function sp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vS(e){if(typeof e=="function")return sp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Sh)return 11;if(e===Ch)return 14}return 2}function va(e,t){var r=e.alternate;return r===null?(r=bn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function pu(e,t,r,n,i,a){var o=2;if(n=e,typeof e=="function")sp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Fs:return Za(r.children,i,a,t);case Th:o=8,i|=8;break;case id:return e=bn(12,r,t,i|2),e.elementType=id,e.lanes=a,e;case ad:return e=bn(13,r,t,i),e.elementType=ad,e.lanes=a,e;case sd:return e=bn(19,r,t,i),e.elementType=sd,e.lanes=a,e;case cv:return kf(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ov:o=10;break e;case lv:o=9;break e;case Sh:o=11;break e;case Ch:o=14;break e;case ea:o=16,n=null;break e}throw Error(Te(130,e==null?e:typeof e,""))}return t=bn(o,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function Za(e,t,r,n){return e=bn(7,e,n,t),e.lanes=r,e}function kf(e,t,r,n){return e=bn(22,e,n,t),e.elementType=cv,e.lanes=r,e.stateNode={isHidden:!1},e}function M0(e,t,r){return e=bn(6,e,null,t),e.lanes=r,e}function I0(e,t,r){return t=bn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _S(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=g0(0),this.expirationTimes=g0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=g0(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function op(e,t,r,n,i,a,o,l,u){return e=new _S(e,t,r,l,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=bn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wh(a),e}function yS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ps,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function ey(e){if(!e)return Ea;e=e._reactInternals;e:{if(ls(e)!==e||e.tag!==1)throw Error(Te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Te(171))}if(e.tag===1){var r=e.type;if(rn(r))return e_(e,r,t)}return t}function ty(e,t,r,n,i,a,o,l,u){return e=op(r,n,!0,e,i,a,o,l,u),e.context=ey(null),r=e.current,n=$r(),i=xa(r),a=Mi(n,i),a.callback=t??null,ma(r,a,i),e.current.lanes=i,Gl(e,i,n),nn(e,n),e}function Ef(e,t,r,n){var i=t.current,a=$r(),o=xa(i);return r=ey(r),t.context===null?t.context=r:t.pendingContext=r,t=Mi(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ma(i,t,o),e!==null&&(Yn(e,i,o,a),lu(e,i,o)),o}function Vu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Qg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function lp(e,t){Qg(e,t),(e=e.alternate)&&Qg(e,t)}function wS(){return null}var ry=typeof reportError=="function"?reportError:function(e){console.error(e)};function cp(e){this._internalRoot=e}Tf.prototype.render=cp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Te(409));Ef(e,t,null,null)};Tf.prototype.unmount=cp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;es(function(){Ef(null,e,null,null)}),t[zi]=null}};function Tf(e){this._internalRoot=e}Tf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ov();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ra.length&&t!==0&&t<ra[r].priority;r++);ra.splice(r,0,e),r===0&&Mv(e)}};function up(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function e1(){}function kS(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=Vu(o);a.call(f)}}var o=ty(t,n,e,0,null,!1,!1,"",e1);return e._reactRootContainer=o,e[zi]=o.current,Al(e.nodeType===8?e.parentNode:e),es(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var f=Vu(u);l.call(f)}}var u=op(e,0,!1,null,null,!1,!1,"",e1);return e._reactRootContainer=u,e[zi]=u.current,Al(e.nodeType===8?e.parentNode:e),es(function(){Ef(t,u,r,n)}),u}function Cf(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var u=Vu(o);l.call(u)}}Ef(t,o,e,i)}else o=kS(r,t,e,i,n);return Vu(o)}Pv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Go(t.pendingLanes);r!==0&&(bh(t,r|1),nn(t,Jt()),!(kt&6)&&(lo=Jt()+500,Na()))}break;case 13:es(function(){var n=Ui(e,1);if(n!==null){var i=$r();Yn(n,e,1,i)}}),lp(e,1)}};Lh=function(e){if(e.tag===13){var t=Ui(e,134217728);if(t!==null){var r=$r();Yn(t,e,134217728,r)}lp(e,134217728)}};Fv=function(e){if(e.tag===13){var t=xa(e),r=Ui(e,t);if(r!==null){var n=$r();Yn(r,e,t,n)}lp(e,t)}};Ov=function(){return Nt};Rv=function(e,t){var r=Nt;try{return Nt=e,t()}finally{Nt=r}};gd=function(e,t,r){switch(t){case"input":if(cd(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=gf(n);if(!i)throw Error(Te(90));fv(n),cd(n,i)}}}break;case"textarea":hv(e,r);break;case"select":t=r.value,t!=null&&Gs(e,!!r.multiple,t,!1)}};yv=np;wv=es;var ES={usingClientEntryPoint:!1,Events:[Kl,Is,gf,vv,_v,np]},Ho={findFiberByHostInstance:za,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TS={bundleType:Ho.bundleType,version:Ho.version,rendererPackageName:Ho.rendererPackageName,rendererConfig:Ho.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$i.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tv(e),e===null?null:e.stateNode},findFiberByHostInstance:Ho.findFiberByHostInstance||wS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wc.isDisabled&&Wc.supportsFiber)try{df=Wc.inject(TS),mi=Wc}catch{}}gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ES;gn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!up(t))throw Error(Te(200));return yS(e,t,null,r)};gn.createRoot=function(e,t){if(!up(e))throw Error(Te(299));var r=!1,n="",i=ry;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=op(e,1,!1,null,null,r,!1,n,i),e[zi]=t.current,Al(e.nodeType===8?e.parentNode:e),new cp(t)};gn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Te(188)):(e=Object.keys(e).join(","),Error(Te(268,e)));return e=Tv(t),e=e===null?null:e.stateNode,e};gn.flushSync=function(e){return es(e)};gn.hydrate=function(e,t,r){if(!Sf(t))throw Error(Te(200));return Cf(null,e,t,!0,r)};gn.hydrateRoot=function(e,t,r){if(!up(e))throw Error(Te(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=ry;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=ty(t,null,e,1,r??null,i,!1,a,o),e[zi]=t.current,Al(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Tf(t)};gn.render=function(e,t,r){if(!Sf(t))throw Error(Te(200));return Cf(null,e,t,!1,r)};gn.unmountComponentAtNode=function(e){if(!Sf(e))throw Error(Te(40));return e._reactRootContainer?(es(function(){Cf(null,null,e,!1,function(){e._reactRootContainer=null,e[zi]=null})}),!0):!1};gn.unstable_batchedUpdates=np;gn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Sf(r))throw Error(Te(200));if(e==null||e._reactInternals===void 0)throw Error(Te(38));return Cf(e,t,r,!1,n)};gn.version="18.3.1-next-f1338f8080-20240426";function ny(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ny)}catch(e){console.error(e)}}ny(),nv.exports=gn;var iy=nv.exports,ay,t1=iy;ay=t1.createRoot,t1.hydrateRoot;var fp={};Object.defineProperty(fp,"__esModule",{value:!0});fp.parse=PS;fp.serialize=FS;const SS=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,CS=/^[\u0021-\u003A\u003C-\u007E]*$/,AS=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,NS=/^[\u0020-\u003A\u003D-\u007E]*$/,bS=Object.prototype.toString,LS=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function PS(e,t){const r=new LS,n=e.length;if(n<2)return r;const i=(t==null?void 0:t.decode)||OS;let a=0;do{const o=e.indexOf("=",a);if(o===-1)break;const l=e.indexOf(";",a),u=l===-1?n:l;if(o>u){a=e.lastIndexOf(";",o-1)+1;continue}const f=r1(e,a,o),d=n1(e,o,f),m=e.slice(f,d);if(r[m]===void 0){let g=r1(e,o+1,u),_=n1(e,u,g);const y=i(e.slice(g,_));r[m]=y}a=u+1}while(a<n);return r}function r1(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function n1(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function FS(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!SS.test(e))throw new TypeError(`argument name is invalid: ${e}`);const i=n(t);if(!CS.test(i))throw new TypeError(`argument val is invalid: ${t}`);let a=e+"="+i;if(!r)return a;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);a+="; Max-Age="+r.maxAge}if(r.domain){if(!AS.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);a+="; Domain="+r.domain}if(r.path){if(!NS.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);a+="; Path="+r.path}if(r.expires){if(!RS(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.partitioned&&(a+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return a}function OS(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function RS(e){return bS.call(e)==="[object Date]"}/**
 * react-router v7.5.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function MS(e={}){let{initialEntries:t=["/"],initialIndex:r,v5Compat:n=!1}=e,i;i=t.map((_,y)=>d(_,typeof _=="string"?null:_.state,y===0?"default":void 0));let a=u(r??i.length-1),o="POP",l=null;function u(_){return Math.min(Math.max(_,0),i.length-1)}function f(){return i[a]}function d(_,y=null,v){let T=DS(i?f().pathname:"/",_,y,v);return Rn(T.pathname.charAt(0)==="/",`relative pathnames are not supported in memory history: ${JSON.stringify(_)}`),T}function m(_){return typeof _=="string"?_:Wu(_)}return{get index(){return a},get action(){return o},get location(){return f()},createHref:m,createURL(_){return new URL(m(_),"http://localhost")},encodeLocation(_){let y=typeof _=="string"?cs(_):_;return{pathname:y.pathname||"",search:y.search||"",hash:y.hash||""}},push(_,y){o="PUSH";let v=d(_,y);a+=1,i.splice(a,i.length,v),n&&l&&l({action:o,location:v,delta:1})},replace(_,y){o="REPLACE";let v=d(_,y);i[a]=v,n&&l&&l({action:o,location:v,delta:0})},go(_){o="POP";let y=u(a+_),v=i[y];a=y,l&&l({action:o,location:v,delta:_})},listen(_){return l=_,()=>{l=null}}}}function Vt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Rn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function IS(){return Math.random().toString(36).substring(2,10)}function DS(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?cs(t):t,state:r,key:t&&t.key||n||IS()}}function Wu({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function cs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function sy(e,t,r="/"){return jS(e,t,r,!1)}function jS(e,t,r,n){let i=typeof t=="string"?cs(t):t,a=Vi(i.pathname||"/",r);if(a==null)return null;let o=oy(e);BS(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let f=qS(a);l=XS(o[u],f,n)}return l}function oy(e,t=[],r=[],n=""){let i=(a,o,l)=>{let u={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};u.relativePath.startsWith("/")&&(Vt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let f=Ii([n,u.relativePath]),d=r.concat(u);a.children&&a.children.length>0&&(Vt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),oy(a.children,t,d,f)),!(a.path==null&&!a.index)&&t.push({path:f,score:ZS(f,a.index),routesMeta:d})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let u of ly(a.path))i(a,o,u)}),t}function ly(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=ly(n.join("/")),l=[];return l.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function BS(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:GS(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var zS=/^:[\w-]+$/,US=3,HS=2,VS=1,WS=10,$S=-2,i1=e=>e==="*";function ZS(e,t){let r=e.split("/"),n=r.length;return r.some(i1)&&(n+=$S),t&&(n+=HS),r.filter(i=>!i1(i)).reduce((i,a)=>i+(zS.test(a)?US:a===""?VS:WS),n)}function GS(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function XS(e,t,r=!1){let{routesMeta:n}=e,i={},a="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],f=l===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",m=$u({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},d),g=u.route;if(!m&&f&&r&&!n[n.length-1].route.index&&(m=$u({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!m)return null;Object.assign(i,m.params),o.push({params:i,pathname:Ii([a,m.pathname]),pathnameBase:e4(Ii([a,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(a=Ii([a,m.pathnameBase]))}return o}function $u(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=KS(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:m},g)=>{if(d==="*"){let y=l[g]||"";o=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const _=l[g];return m&&!_?f[d]=void 0:f[d]=(_||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:o,pattern:e}}function KS(e,t=!1,r=!0){Rn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function qS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Rn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Vi(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function YS(e,t="/"){let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?cs(e):e;return{pathname:r?r.startsWith("/")?r:JS(r,t):t,search:t4(n),hash:r4(i)}}function JS(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function D0(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function QS(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function dp(e){let t=QS(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function hp(e,t,r,n=!1){let i;typeof e=="string"?i=cs(e):(i={...e},Vt(!i.pathname||!i.pathname.includes("?"),D0("?","pathname","search",i)),Vt(!i.pathname||!i.pathname.includes("#"),D0("#","pathname","hash",i)),Vt(!i.search||!i.search.includes("#"),D0("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;i.pathname=g.join("/")}l=m>=0?t[m]:"/"}let u=YS(i,l),f=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||d)&&(u.pathname+="/"),u}var Ii=e=>e.join("/").replace(/\/\/+/g,"/"),e4=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),t4=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,r4=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function n4(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var cy=["POST","PUT","PATCH","DELETE"];new Set(cy);var i4=["GET",...cy];new Set(i4);var mo=N.createContext(null);mo.displayName="DataRouter";var Af=N.createContext(null);Af.displayName="DataRouterState";var uy=N.createContext({isTransitioning:!1});uy.displayName="ViewTransition";var a4=N.createContext(new Map);a4.displayName="Fetchers";var s4=N.createContext(null);s4.displayName="Await";var ei=N.createContext(null);ei.displayName="Navigation";var Yl=N.createContext(null);Yl.displayName="Location";var ti=N.createContext({outlet:null,matches:[],isDataRoute:!1});ti.displayName="Route";var pp=N.createContext(null);pp.displayName="RouteError";function o4(e,{relative:t}={}){Vt(go(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=N.useContext(ei),{hash:i,pathname:a,search:o}=Jl(e,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:Ii([r,a])),n.createHref({pathname:l,search:o,hash:i})}function go(){return N.useContext(Yl)!=null}function Zi(){return Vt(go(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Yl).location}var fy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dy(e){N.useContext(ei).static||N.useLayoutEffect(e)}function Gi(){let{isDataRoute:e}=N.useContext(ti);return e?w4():l4()}function l4(){Vt(go(),"useNavigate() may be used only in the context of a <Router> component.");let e=N.useContext(mo),{basename:t,navigator:r}=N.useContext(ei),{matches:n}=N.useContext(ti),{pathname:i}=Zi(),a=JSON.stringify(dp(n)),o=N.useRef(!1);return dy(()=>{o.current=!0}),N.useCallback((u,f={})=>{if(Rn(o.current,fy),!o.current)return;if(typeof u=="number"){r.go(u);return}let d=hp(u,JSON.parse(a),i,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ii([t,d.pathname])),(f.replace?r.replace:r.push)(d,f.state,f)},[t,r,a,i,e])}N.createContext(null);function c4(){let{matches:e}=N.useContext(ti),t=e[e.length-1];return t?t.params:{}}function Jl(e,{relative:t}={}){let{matches:r}=N.useContext(ti),{pathname:n}=Zi(),i=JSON.stringify(dp(r));return N.useMemo(()=>hp(e,JSON.parse(i),n,t==="path"),[e,i,n,t])}function u4(e,t){return hy(e,t)}function hy(e,t,r,n){var E;Vt(go(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:a}=N.useContext(ei),{matches:o}=N.useContext(ti),l=o[o.length-1],u=l?l.params:{},f=l?l.pathname:"/",d=l?l.pathnameBase:"/",m=l&&l.route;{let w=m&&m.path||"";py(f,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let g=Zi(),_;if(t){let w=typeof t=="string"?cs(t):t;Vt(d==="/"||((E=w.pathname)==null?void 0:E.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${w.pathname}" was given in the \`location\` prop.`),_=w}else _=g;let y=_.pathname||"/",v=y;if(d!=="/"){let w=d.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(w.length).join("/")}let T=!a&&r&&r.matches&&r.matches.length>0?r.matches:sy(e,{pathname:v});Rn(m||T!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Rn(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=m4(T&&T.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:Ii([d,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:Ii([d,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n);return t&&k?N.createElement(Yl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},k):k}function f4(){let e=y4(),t=n4(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:a},"ErrorBoundary")," or"," ",N.createElement("code",{style:a},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},t),r?N.createElement("pre",{style:i},r):null,o)}var d4=N.createElement(f4,null),h4=class extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?N.createElement(ti.Provider,{value:this.props.routeContext},N.createElement(pp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function p4({routeContext:e,match:t,children:r}){let n=N.useContext(mo);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),N.createElement(ti.Provider,{value:e},r)}function m4(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,a=r==null?void 0:r.errors;if(a!=null){let u=i.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);Vt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let o=!1,l=-1;if(r)for(let u=0;u<i.length;u++){let f=i[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=u),f.route.id){let{loaderData:d,errors:m}=r,g=f.route.loader&&!d.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){o=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}return i.reduceRight((u,f,d)=>{let m,g=!1,_=null,y=null;r&&(m=a&&f.route.id?a[f.route.id]:void 0,_=f.route.errorElement||d4,o&&(l<0&&d===0?(py("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,y=null):l===d&&(g=!0,y=f.route.hydrateFallbackElement||null)));let v=t.concat(i.slice(0,d+1)),T=()=>{let k;return m?k=_:g?k=y:f.route.Component?k=N.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=u,N.createElement(p4,{match:f,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:k})};return r&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?N.createElement(h4,{location:r.location,revalidation:r.revalidation,component:_,error:m,children:T(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):T()},null)}function mp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function g4(e){let t=N.useContext(mo);return Vt(t,mp(e)),t}function x4(e){let t=N.useContext(Af);return Vt(t,mp(e)),t}function v4(e){let t=N.useContext(ti);return Vt(t,mp(e)),t}function gp(e){let t=v4(e),r=t.matches[t.matches.length-1];return Vt(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function _4(){return gp("useRouteId")}function y4(){var n;let e=N.useContext(pp),t=x4("useRouteError"),r=gp("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function w4(){let{router:e}=g4("useNavigate"),t=gp("useNavigate"),r=N.useRef(!1);return dy(()=>{r.current=!0}),N.useCallback(async(i,a={})=>{Rn(r.current,fy),r.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:t,...a}))},[e,t])}var a1={};function py(e,t,r){!t&&!a1[e]&&(a1[e]=!0,Rn(!1,r))}N.memo(k4);function k4({routes:e,future:t,state:r}){return hy(e,void 0,r,t)}function E4({basename:e,children:t,initialEntries:r,initialIndex:n}){let i=N.useRef();i.current==null&&(i.current=MS({initialEntries:r,initialIndex:n,v5Compat:!0}));let a=i.current,[o,l]=N.useState({action:a.action,location:a.location}),u=N.useCallback(f=>{N.startTransition(()=>l(f))},[l]);return N.useLayoutEffect(()=>a.listen(u),[a,u]),N.createElement(S4,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a})}function T4({to:e,replace:t,state:r,relative:n}){Vt(go(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=N.useContext(ei);Rn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=N.useContext(ti),{pathname:o}=Zi(),l=Gi(),u=hp(e,dp(a),o,n==="path"),f=JSON.stringify(u);return N.useEffect(()=>{l(JSON.parse(f),{replace:t,state:r,relative:n})},[l,f,n,t,r]),null}function zr(e){Vt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function S4({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:i,static:a=!1}){Vt(!go(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof r=="string"&&(r=cs(r));let{pathname:u="/",search:f="",hash:d="",state:m=null,key:g="default"}=r,_=N.useMemo(()=>{let y=Vi(u,o);return y==null?null:{location:{pathname:y,search:f,hash:d,state:m,key:g},navigationType:n}},[o,u,f,d,m,g,n]);return Rn(_!=null,`<Router basename="${o}"> is not able to match the URL "${u}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:N.createElement(ei.Provider,{value:l},N.createElement(Yl.Provider,{children:t,value:_}))}function C4({children:e,location:t}){return u4(Kd(e),t)}function Kd(e,t=[]){let r=[];return N.Children.forEach(e,(n,i)=>{if(!N.isValidElement(n))return;let a=[...t,i];if(n.type===N.Fragment){r.push.apply(r,Kd(n.props.children,a));return}Vt(n.type===zr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Vt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Kd(n.props.children,a)),r.push(o)}),r}var mu="get",gu="application/x-www-form-urlencoded";function Nf(e){return e!=null&&typeof e.tagName=="string"}function A4(e){return Nf(e)&&e.tagName.toLowerCase()==="button"}function N4(e){return Nf(e)&&e.tagName.toLowerCase()==="form"}function b4(e){return Nf(e)&&e.tagName.toLowerCase()==="input"}function L4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function P4(e,t){return e.button===0&&(!t||t==="_self")&&!L4(e)}var $c=null;function F4(){if($c===null)try{new FormData(document.createElement("form"),0),$c=!1}catch{$c=!0}return $c}var O4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function j0(e){return e!=null&&!O4.has(e)?(Rn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gu}"`),null):e}function R4(e,t){let r,n,i,a,o;if(N4(e)){let l=e.getAttribute("action");n=l?Vi(l,t):null,r=e.getAttribute("method")||mu,i=j0(e.getAttribute("enctype"))||gu,a=new FormData(e)}else if(A4(e)||b4(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||l.getAttribute("action");if(n=u?Vi(u,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||mu,i=j0(e.getAttribute("formenctype"))||j0(l.getAttribute("enctype"))||gu,a=new FormData(l,e),!F4()){let{name:f,type:d,value:m}=e;if(d==="image"){let g=f?`${f}.`:"";a.append(`${g}x`,"0"),a.append(`${g}y`,"0")}else f&&a.append(f,m)}}else{if(Nf(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=mu,n=null,i=gu,o=e}return a&&i==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:a,body:o}}function xp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function M4(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function I4(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function D4(e,t,r){let n=await Promise.all(e.map(async i=>{let a=t.routes[i.route.id];if(a){let o=await M4(a,r);return o.links?o.links():[]}return[]}));return U4(n.flat(1).filter(I4).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function s1(e,t,r,n,i,a){let o=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,l=(u,f)=>{var d;return r[f].pathname!==u.pathname||((d=r[f].route.path)==null?void 0:d.endsWith("*"))&&r[f].params["*"]!==u.params["*"]};return a==="assets"?t.filter((u,f)=>o(u,f)||l(u,f)):a==="data"?t.filter((u,f)=>{var m;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,f)||l(u,f))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function j4(e,t,{includeHydrateFallback:r}={}){return B4(e.map(n=>{let i=t.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function B4(e){return[...new Set(e)]}function z4(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function U4(e,t){let r=new Set;return new Set(t),e.reduce((n,i)=>{let a=JSON.stringify(z4(i));return r.has(a)||(r.add(a),n.push({key:a,link:i})),n},[])}var H4=new Set([100,101,204,205]);function V4(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Vi(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function my(){let e=N.useContext(mo);return xp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function W4(){let e=N.useContext(Af);return xp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var vp=N.createContext(void 0);vp.displayName="FrameworkContext";function gy(){let e=N.useContext(vp);return xp(e,"You must render this element inside a <HydratedRouter> element"),e}function $4(e,t){let r=N.useContext(vp),[n,i]=N.useState(!1),[a,o]=N.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:f,onMouseLeave:d,onTouchStart:m}=t,g=N.useRef(null);N.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let v=k=>{k.forEach(E=>{o(E.isIntersecting)})},T=new IntersectionObserver(v,{threshold:.5});return g.current&&T.observe(g.current),()=>{T.disconnect()}}},[e]),N.useEffect(()=>{if(n){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[n]);let _=()=>{i(!0)},y=()=>{i(!1),o(!1)};return r?e!=="intent"?[a,g,{}]:[a,g,{onFocus:Vo(l,_),onBlur:Vo(u,y),onMouseEnter:Vo(f,_),onMouseLeave:Vo(d,y),onTouchStart:Vo(m,_)}]:[!1,g,{}]}function Vo(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Z4({page:e,...t}){let{router:r}=my(),n=N.useMemo(()=>sy(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?N.createElement(X4,{page:e,matches:n,...t}):null}function G4(e){let{manifest:t,routeModules:r}=gy(),[n,i]=N.useState([]);return N.useEffect(()=>{let a=!1;return D4(e,t,r).then(o=>{a||i(o)}),()=>{a=!0}},[e,t,r]),n}function X4({page:e,matches:t,...r}){let n=Zi(),{manifest:i,routeModules:a}=gy(),{basename:o}=my(),{loaderData:l,matches:u}=W4(),f=N.useMemo(()=>s1(e,t,u,i,n,"data"),[e,t,u,i,n]),d=N.useMemo(()=>s1(e,t,u,i,n,"assets"),[e,t,u,i,n]),m=N.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let y=new Set,v=!1;if(t.forEach(k=>{var w;let E=i.routes[k.route.id];!E||!E.hasLoader||(!f.some(P=>P.route.id===k.route.id)&&k.route.id in l&&((w=a[k.route.id])!=null&&w.shouldRevalidate)||E.hasClientLoader?v=!0:y.add(k.route.id))}),y.size===0)return[];let T=V4(e,o);return v&&y.size>0&&T.searchParams.set("_routes",t.filter(k=>y.has(k.route.id)).map(k=>k.route.id).join(",")),[T.pathname+T.search]},[o,l,n,i,f,t,e,a]),g=N.useMemo(()=>j4(d,i),[d,i]),_=G4(d);return N.createElement(N.Fragment,null,m.map(y=>N.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),g.map(y=>N.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),_.map(({key:y,link:v})=>N.createElement("link",{key:y,...v})))}function K4(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var xy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xy&&(window.__reactRouterVersion="7.5.1")}catch{}var vy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hi=N.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:i,reloadDocument:a,replace:o,state:l,target:u,to:f,preventScrollReset:d,viewTransition:m,...g},_){let{basename:y}=N.useContext(ei),v=typeof f=="string"&&vy.test(f),T,k=!1;if(typeof f=="string"&&v&&(T=f,xy))try{let j=new URL(window.location.href),K=f.startsWith("//")?new URL(j.protocol+f):new URL(f),V=Vi(K.pathname,y);K.origin===j.origin&&V!=null?f=V+K.search+K.hash:k=!0}catch{Rn(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=o4(f,{relative:i}),[w,P,I]=$4(n,g),M=Q4(f,{replace:o,state:l,target:u,preventScrollReset:d,relative:i,viewTransition:m});function b(j){t&&t(j),j.defaultPrevented||M(j)}let U=N.createElement("a",{...g,...I,href:T||E,onClick:k||a?t:b,ref:K4(_,P),target:u,"data-discover":!v&&r==="render"?"true":void 0});return w&&!v?N.createElement(N.Fragment,null,U,N.createElement(Z4,{page:E})):U});hi.displayName="Link";var q4=N.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:i=!1,style:a,to:o,viewTransition:l,children:u,...f},d){let m=Jl(o,{relative:f.relative}),g=Zi(),_=N.useContext(Af),{navigator:y,basename:v}=N.useContext(ei),T=_!=null&&iC(m)&&l===!0,k=y.encodeLocation?y.encodeLocation(m).pathname:m.pathname,E=g.pathname,w=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;r||(E=E.toLowerCase(),w=w?w.toLowerCase():null,k=k.toLowerCase()),w&&v&&(w=Vi(w,v)||w);const P=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let I=E===k||!i&&E.startsWith(k)&&E.charAt(P)==="/",M=w!=null&&(w===k||!i&&w.startsWith(k)&&w.charAt(k.length)==="/"),b={isActive:I,isPending:M,isTransitioning:T},U=I?t:void 0,j;typeof n=="function"?j=n(b):j=[n,I?"active":null,M?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let K=typeof a=="function"?a(b):a;return N.createElement(hi,{...f,"aria-current":U,className:j,ref:d,style:K,to:o,viewTransition:l},typeof u=="function"?u(b):u)});q4.displayName="NavLink";var Y4=N.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:i,state:a,method:o=mu,action:l,onSubmit:u,relative:f,preventScrollReset:d,viewTransition:m,...g},_)=>{let y=rC(),v=nC(l,{relative:f}),T=o.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&vy.test(l),E=w=>{if(u&&u(w),w.defaultPrevented)return;w.preventDefault();let P=w.nativeEvent.submitter,I=(P==null?void 0:P.getAttribute("formmethod"))||o;y(P||w.currentTarget,{fetcherKey:t,method:I,navigate:r,replace:i,state:a,relative:f,preventScrollReset:d,viewTransition:m})};return N.createElement("form",{ref:_,method:T,action:v,onSubmit:n?u:E,...g,"data-discover":!k&&e==="render"?"true":void 0})});Y4.displayName="Form";function J4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _y(e){let t=N.useContext(mo);return Vt(t,J4(e)),t}function Q4(e,{target:t,replace:r,state:n,preventScrollReset:i,relative:a,viewTransition:o}={}){let l=Gi(),u=Zi(),f=Jl(e,{relative:a});return N.useCallback(d=>{if(P4(d,t)){d.preventDefault();let m=r!==void 0?r:Wu(u)===Wu(f);l(e,{replace:m,state:n,preventScrollReset:i,relative:a,viewTransition:o})}},[u,l,f,r,n,t,e,i,a,o])}var eC=0,tC=()=>`__${String(++eC)}__`;function rC(){let{router:e}=_y("useSubmit"),{basename:t}=N.useContext(ei),r=_4();return N.useCallback(async(n,i={})=>{let{action:a,method:o,encType:l,formData:u,body:f}=R4(n,t);if(i.navigate===!1){let d=i.fetcherKey||tC();await e.fetch(d,r,i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:f,formMethod:i.method||o,formEncType:i.encType||l,flushSync:i.flushSync})}else await e.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:f,formMethod:i.method||o,formEncType:i.encType||l,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,r])}function nC(e,{relative:t}={}){let{basename:r}=N.useContext(ei),n=N.useContext(ti);Vt(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...Jl(e||".",{relative:t})},o=Zi();if(e==null){a.search=o.search;let l=new URLSearchParams(a.search),u=l.getAll("index");if(u.some(d=>d==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let d=l.toString();a.search=d?`?${d}`:""}}return(!e||e===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:Ii([r,a.pathname])),Wu(a)}function iC(e,t={}){let r=N.useContext(uy);Vt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=_y("useViewTransitionState"),i=Jl(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=Vi(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Vi(r.nextLocation.pathname,n)||r.nextLocation.pathname;return $u(i.pathname,o)!=null||$u(i.pathname,a)!=null}new TextEncoder;[...H4];function yy(e,t){return function(){return e.apply(t,arguments)}}const{toString:aC}=Object.prototype,{getPrototypeOf:_p}=Object,bf=(e=>t=>{const r=aC.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ri=e=>(e=e.toLowerCase(),t=>bf(t)===e),Lf=e=>t=>typeof t===e,{isArray:xo}=Array,Il=Lf("undefined");function sC(e){return e!==null&&!Il(e)&&e.constructor!==null&&!Il(e.constructor)&&hn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const wy=ri("ArrayBuffer");function oC(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&wy(e.buffer),t}const lC=Lf("string"),hn=Lf("function"),ky=Lf("number"),Pf=e=>e!==null&&typeof e=="object",cC=e=>e===!0||e===!1,xu=e=>{if(bf(e)!=="object")return!1;const t=_p(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},uC=ri("Date"),fC=ri("File"),dC=ri("Blob"),hC=ri("FileList"),pC=e=>Pf(e)&&hn(e.pipe),mC=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||hn(e.append)&&((t=bf(e))==="formdata"||t==="object"&&hn(e.toString)&&e.toString()==="[object FormData]"))},gC=ri("URLSearchParams"),[xC,vC,_C,yC]=["ReadableStream","Request","Response","Headers"].map(ri),wC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ql(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),xo(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const a=r?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let l;for(n=0;n<o;n++)l=a[n],t.call(null,e[l],l,e)}}function Ey(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const Va=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ty=e=>!Il(e)&&e!==Va;function qd(){const{caseless:e}=Ty(this)&&this||{},t={},r=(n,i)=>{const a=e&&Ey(t,i)||i;xu(t[a])&&xu(n)?t[a]=qd(t[a],n):xu(n)?t[a]=qd({},n):xo(n)?t[a]=n.slice():t[a]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Ql(arguments[n],r);return t}const kC=(e,t,r,{allOwnKeys:n}={})=>(Ql(t,(i,a)=>{r&&hn(i)?e[a]=yy(i,r):e[a]=i},{allOwnKeys:n}),e),EC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),TC=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},SC=(e,t,r,n)=>{let i,a,o;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)o=i[a],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&_p(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},CC=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},AC=e=>{if(!e)return null;if(xo(e))return e;let t=e.length;if(!ky(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},NC=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&_p(Uint8Array)),bC=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=n.next())&&!i.done;){const a=i.value;t.call(e,a[0],a[1])}},LC=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},PC=ri("HTMLFormElement"),FC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),o1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),OC=ri("RegExp"),Sy=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Ql(r,(i,a)=>{let o;(o=t(i,a,e))!==!1&&(n[a]=o||i)}),Object.defineProperties(e,n)},RC=e=>{Sy(e,(t,r)=>{if(hn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(hn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},MC=(e,t)=>{const r={},n=i=>{i.forEach(a=>{r[a]=!0})};return xo(e)?n(e):n(String(e).split(t)),r},IC=()=>{},DC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function jC(e){return!!(e&&hn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const BC=e=>{const t=new Array(10),r=(n,i)=>{if(Pf(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[i]=n;const a=xo(n)?[]:{};return Ql(n,(o,l)=>{const u=r(o,i+1);!Il(u)&&(a[l]=u)}),t[i]=void 0,a}}return n};return r(e,0)},zC=ri("AsyncFunction"),UC=e=>e&&(Pf(e)||hn(e))&&hn(e.then)&&hn(e.catch),Cy=((e,t)=>e?setImmediate:t?((r,n)=>(Va.addEventListener("message",({source:i,data:a})=>{i===Va&&a===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Va.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",hn(Va.postMessage)),HC=typeof queueMicrotask<"u"?queueMicrotask.bind(Va):typeof process<"u"&&process.nextTick||Cy,he={isArray:xo,isArrayBuffer:wy,isBuffer:sC,isFormData:mC,isArrayBufferView:oC,isString:lC,isNumber:ky,isBoolean:cC,isObject:Pf,isPlainObject:xu,isReadableStream:xC,isRequest:vC,isResponse:_C,isHeaders:yC,isUndefined:Il,isDate:uC,isFile:fC,isBlob:dC,isRegExp:OC,isFunction:hn,isStream:pC,isURLSearchParams:gC,isTypedArray:NC,isFileList:hC,forEach:Ql,merge:qd,extend:kC,trim:wC,stripBOM:EC,inherits:TC,toFlatObject:SC,kindOf:bf,kindOfTest:ri,endsWith:CC,toArray:AC,forEachEntry:bC,matchAll:LC,isHTMLForm:PC,hasOwnProperty:o1,hasOwnProp:o1,reduceDescriptors:Sy,freezeMethods:RC,toObjectSet:MC,toCamelCase:FC,noop:IC,toFiniteNumber:DC,findKey:Ey,global:Va,isContextDefined:Ty,isSpecCompliantForm:jC,toJSONObject:BC,isAsyncFn:zC,isThenable:UC,setImmediate:Cy,asap:HC};function ot(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}he.inherits(ot,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:he.toJSONObject(this.config),code:this.code,status:this.status}}});const Ay=ot.prototype,Ny={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ny[e]={value:e}});Object.defineProperties(ot,Ny);Object.defineProperty(Ay,"isAxiosError",{value:!0});ot.from=(e,t,r,n,i,a)=>{const o=Object.create(Ay);return he.toFlatObject(e,o,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),ot.call(o,e.message,t,r,n,i),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};const VC=null;function Yd(e){return he.isPlainObject(e)||he.isArray(e)}function by(e){return he.endsWith(e,"[]")?e.slice(0,-2):e}function l1(e,t,r){return e?e.concat(t).map(function(i,a){return i=by(i),!r&&a?"["+i+"]":i}).join(r?".":""):t}function WC(e){return he.isArray(e)&&!e.some(Yd)}const $C=he.toFlatObject(he,{},null,function(t){return/^is[A-Z]/.test(t)});function Ff(e,t,r){if(!he.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=he.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,T){return!he.isUndefined(T[v])});const n=r.metaTokens,i=r.visitor||d,a=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&he.isSpecCompliantForm(t);if(!he.isFunction(i))throw new TypeError("visitor must be a function");function f(y){if(y===null)return"";if(he.isDate(y))return y.toISOString();if(!u&&he.isBlob(y))throw new ot("Blob is not supported. Use a Buffer instead.");return he.isArrayBuffer(y)||he.isTypedArray(y)?u&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function d(y,v,T){let k=y;if(y&&!T&&typeof y=="object"){if(he.endsWith(v,"{}"))v=n?v:v.slice(0,-2),y=JSON.stringify(y);else if(he.isArray(y)&&WC(y)||(he.isFileList(y)||he.endsWith(v,"[]"))&&(k=he.toArray(y)))return v=by(v),k.forEach(function(w,P){!(he.isUndefined(w)||w===null)&&t.append(o===!0?l1([v],P,a):o===null?v:v+"[]",f(w))}),!1}return Yd(y)?!0:(t.append(l1(T,v,a),f(y)),!1)}const m=[],g=Object.assign($C,{defaultVisitor:d,convertValue:f,isVisitable:Yd});function _(y,v){if(!he.isUndefined(y)){if(m.indexOf(y)!==-1)throw Error("Circular reference detected in "+v.join("."));m.push(y),he.forEach(y,function(k,E){(!(he.isUndefined(k)||k===null)&&i.call(t,k,he.isString(E)?E.trim():E,v,g))===!0&&_(k,v?v.concat(E):[E])}),m.pop()}}if(!he.isObject(e))throw new TypeError("data must be an object");return _(e),t}function c1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function yp(e,t){this._pairs=[],e&&Ff(e,this,t)}const Ly=yp.prototype;Ly.append=function(t,r){this._pairs.push([t,r])};Ly.toString=function(t){const r=t?function(n){return t.call(this,n,c1)}:c1;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function ZC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Py(e,t,r){if(!t)return e;const n=r&&r.encode||ZC;he.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let a;if(i?a=i(t,r):a=he.isURLSearchParams(t)?t.toString():new yp(t,r).toString(n),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class u1{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){he.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Fy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},GC=typeof URLSearchParams<"u"?URLSearchParams:yp,XC=typeof FormData<"u"?FormData:null,KC=typeof Blob<"u"?Blob:null,qC={isBrowser:!0,classes:{URLSearchParams:GC,FormData:XC,Blob:KC},protocols:["http","https","file","blob","url","data"]},wp=typeof window<"u"&&typeof document<"u",Jd=typeof navigator=="object"&&navigator||void 0,YC=wp&&(!Jd||["ReactNative","NativeScript","NS"].indexOf(Jd.product)<0),JC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",QC=wp&&window.location.href||"http://localhost",e3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wp,hasStandardBrowserEnv:YC,hasStandardBrowserWebWorkerEnv:JC,navigator:Jd,origin:QC},Symbol.toStringTag,{value:"Module"})),Fr={...e3,...qC};function t3(e,t){return Ff(e,new Fr.classes.URLSearchParams,Object.assign({visitor:function(r,n,i,a){return Fr.isNode&&he.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function r3(e){return he.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function n3(e){const t={},r=Object.keys(e);let n;const i=r.length;let a;for(n=0;n<i;n++)a=r[n],t[a]=e[a];return t}function Oy(e){function t(r,n,i,a){let o=r[a++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=a>=r.length;return o=!o&&he.isArray(i)?i.length:o,u?(he.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!he.isObject(i[o]))&&(i[o]=[]),t(r,n,i[o],a)&&he.isArray(i[o])&&(i[o]=n3(i[o])),!l)}if(he.isFormData(e)&&he.isFunction(e.entries)){const r={};return he.forEachEntry(e,(n,i)=>{t(r3(n),i,r,0)}),r}return null}function i3(e,t,r){if(he.isString(e))try{return(t||JSON.parse)(e),he.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const ec={transitional:Fy,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,a=he.isObject(t);if(a&&he.isHTMLForm(t)&&(t=new FormData(t)),he.isFormData(t))return i?JSON.stringify(Oy(t)):t;if(he.isArrayBuffer(t)||he.isBuffer(t)||he.isStream(t)||he.isFile(t)||he.isBlob(t)||he.isReadableStream(t))return t;if(he.isArrayBufferView(t))return t.buffer;if(he.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return t3(t,this.formSerializer).toString();if((l=he.isFileList(t))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Ff(l?{"files[]":t}:t,u&&new u,this.formSerializer)}}return a||i?(r.setContentType("application/json",!1),i3(t)):t}],transformResponse:[function(t){const r=this.transitional||ec.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(he.isResponse(t)||he.isReadableStream(t))return t;if(t&&he.isString(t)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?ot.from(l,ot.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fr.classes.FormData,Blob:Fr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};he.forEach(["delete","get","head","post","put","patch"],e=>{ec.headers[e]={}});const a3=he.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),s3=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||t[r]&&a3[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},f1=Symbol("internals");function Wo(e){return e&&String(e).trim().toLowerCase()}function vu(e){return e===!1||e==null?e:he.isArray(e)?e.map(vu):String(e)}function o3(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const l3=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function B0(e,t,r,n,i){if(he.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!he.isString(t)){if(he.isString(n))return t.indexOf(n)!==-1;if(he.isRegExp(n))return n.test(t)}}function c3(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function u3(e,t){const r=he.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,a,o){return this[n].call(this,t,i,a,o)},configurable:!0})})}class an{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function a(l,u,f){const d=Wo(u);if(!d)throw new Error("header name must be a non-empty string");const m=he.findKey(i,d);(!m||i[m]===void 0||f===!0||f===void 0&&i[m]!==!1)&&(i[m||u]=vu(l))}const o=(l,u)=>he.forEach(l,(f,d)=>a(f,d,u));if(he.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(he.isString(t)&&(t=t.trim())&&!l3(t))o(s3(t),r);else if(he.isHeaders(t))for(const[l,u]of t.entries())a(u,l,n);else t!=null&&a(r,t,n);return this}get(t,r){if(t=Wo(t),t){const n=he.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return o3(i);if(he.isFunction(r))return r.call(this,i,n);if(he.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Wo(t),t){const n=he.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||B0(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function a(o){if(o=Wo(o),o){const l=he.findKey(n,o);l&&(!r||B0(n,n[l],l,r))&&(delete n[l],i=!0)}}return he.isArray(t)?t.forEach(a):a(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const a=r[n];(!t||B0(this,this[a],a,t,!0))&&(delete this[a],i=!0)}return i}normalize(t){const r=this,n={};return he.forEach(this,(i,a)=>{const o=he.findKey(n,a);if(o){r[o]=vu(i),delete r[a];return}const l=t?c3(a):String(a).trim();l!==a&&delete r[a],r[l]=vu(i),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return he.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&he.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[f1]=this[f1]={accessors:{}}).accessors,i=this.prototype;function a(o){const l=Wo(o);n[l]||(u3(i,o),n[l]=!0)}return he.isArray(t)?t.forEach(a):a(t),this}}an.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);he.reduceDescriptors(an.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});he.freezeMethods(an);function z0(e,t){const r=this||ec,n=t||r,i=an.from(n.headers);let a=n.data;return he.forEach(e,function(l){a=l.call(r,a,i.normalize(),t?t.status:void 0)}),i.normalize(),a}function Ry(e){return!!(e&&e.__CANCEL__)}function vo(e,t,r){ot.call(this,e??"canceled",ot.ERR_CANCELED,t,r),this.name="CanceledError"}he.inherits(vo,ot,{__CANCEL__:!0});function My(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new ot("Request failed with status code "+r.status,[ot.ERR_BAD_REQUEST,ot.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function f3(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function d3(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,a=0,o;return t=t!==void 0?t:1e3,function(u){const f=Date.now(),d=n[a];o||(o=f),r[i]=u,n[i]=f;let m=a,g=0;for(;m!==i;)g+=r[m++],m=m%e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),f-o<t)return;const _=d&&f-d;return _?Math.round(g*1e3/_):void 0}}function h3(e,t){let r=0,n=1e3/t,i,a;const o=(f,d=Date.now())=>{r=d,i=null,a&&(clearTimeout(a),a=null),e.apply(null,f)};return[(...f)=>{const d=Date.now(),m=d-r;m>=n?o(f,d):(i=f,a||(a=setTimeout(()=>{a=null,o(i)},n-m)))},()=>i&&o(i)]}const Zu=(e,t,r=3)=>{let n=0;const i=d3(50,250);return h3(a=>{const o=a.loaded,l=a.lengthComputable?a.total:void 0,u=o-n,f=i(u),d=o<=l;n=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:f||void 0,estimated:f&&l&&d?(l-o)/f:void 0,event:a,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},d1=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},h1=e=>(...t)=>he.asap(()=>e(...t)),p3=Fr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Fr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Fr.origin),Fr.navigator&&/(msie|trident)/i.test(Fr.navigator.userAgent)):()=>!0,m3=Fr.hasStandardBrowserEnv?{write(e,t,r,n,i,a){const o=[e+"="+encodeURIComponent(t)];he.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),he.isString(n)&&o.push("path="+n),he.isString(i)&&o.push("domain="+i),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function g3(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function x3(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Iy(e,t,r){let n=!g3(t);return e&&(n||r==!1)?x3(e,t):t}const p1=e=>e instanceof an?{...e}:e;function ts(e,t){t=t||{};const r={};function n(f,d,m,g){return he.isPlainObject(f)&&he.isPlainObject(d)?he.merge.call({caseless:g},f,d):he.isPlainObject(d)?he.merge({},d):he.isArray(d)?d.slice():d}function i(f,d,m,g){if(he.isUndefined(d)){if(!he.isUndefined(f))return n(void 0,f,m,g)}else return n(f,d,m,g)}function a(f,d){if(!he.isUndefined(d))return n(void 0,d)}function o(f,d){if(he.isUndefined(d)){if(!he.isUndefined(f))return n(void 0,f)}else return n(void 0,d)}function l(f,d,m){if(m in t)return n(f,d);if(m in e)return n(void 0,f)}const u={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(f,d,m)=>i(p1(f),p1(d),m,!0)};return he.forEach(Object.keys(Object.assign({},e,t)),function(d){const m=u[d]||i,g=m(e[d],t[d],d);he.isUndefined(g)&&m!==l||(r[d]=g)}),r}const Dy=e=>{const t=ts({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:l}=t;t.headers=o=an.from(o),t.url=Py(Iy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let u;if(he.isFormData(r)){if(Fr.hasStandardBrowserEnv||Fr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[f,...d]=u?u.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([f||"multipart/form-data",...d].join("; "))}}if(Fr.hasStandardBrowserEnv&&(n&&he.isFunction(n)&&(n=n(t)),n||n!==!1&&p3(t.url))){const f=i&&a&&m3.read(a);f&&o.set(i,f)}return t},v3=typeof XMLHttpRequest<"u",_3=v3&&function(e){return new Promise(function(r,n){const i=Dy(e);let a=i.data;const o=an.from(i.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:f}=i,d,m,g,_,y;function v(){_&&_(),y&&y(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let T=new XMLHttpRequest;T.open(i.method.toUpperCase(),i.url,!0),T.timeout=i.timeout;function k(){if(!T)return;const w=an.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),I={data:!l||l==="text"||l==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:w,config:e,request:T};My(function(b){r(b),v()},function(b){n(b),v()},I),T=null}"onloadend"in T?T.onloadend=k:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(k)},T.onabort=function(){T&&(n(new ot("Request aborted",ot.ECONNABORTED,e,T)),T=null)},T.onerror=function(){n(new ot("Network Error",ot.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let P=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const I=i.transitional||Fy;i.timeoutErrorMessage&&(P=i.timeoutErrorMessage),n(new ot(P,I.clarifyTimeoutError?ot.ETIMEDOUT:ot.ECONNABORTED,e,T)),T=null},a===void 0&&o.setContentType(null),"setRequestHeader"in T&&he.forEach(o.toJSON(),function(P,I){T.setRequestHeader(I,P)}),he.isUndefined(i.withCredentials)||(T.withCredentials=!!i.withCredentials),l&&l!=="json"&&(T.responseType=i.responseType),f&&([g,y]=Zu(f,!0),T.addEventListener("progress",g)),u&&T.upload&&([m,_]=Zu(u),T.upload.addEventListener("progress",m),T.upload.addEventListener("loadend",_)),(i.cancelToken||i.signal)&&(d=w=>{T&&(n(!w||w.type?new vo(null,e,T):w),T.abort(),T=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const E=f3(i.url);if(E&&Fr.protocols.indexOf(E)===-1){n(new ot("Unsupported protocol "+E+":",ot.ERR_BAD_REQUEST,e));return}T.send(a||null)})},y3=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const a=function(f){if(!i){i=!0,l();const d=f instanceof Error?f:this.reason;n.abort(d instanceof ot?d:new vo(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,a(new ot(`timeout ${t} of ms exceeded`,ot.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:u}=n;return u.unsubscribe=()=>he.asap(l),u}},w3=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},k3=async function*(e,t){for await(const r of E3(e))yield*w3(r,t)},E3=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},m1=(e,t,r,n)=>{const i=k3(e,t);let a=0,o,l=u=>{o||(o=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:f,value:d}=await i.next();if(f){l(),u.close();return}let m=d.byteLength;if(r){let g=a+=m;r(g)}u.enqueue(new Uint8Array(d))}catch(f){throw l(f),f}},cancel(u){return l(u),i.return()}},{highWaterMark:2})},Of=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",jy=Of&&typeof ReadableStream=="function",T3=Of&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),By=(e,...t)=>{try{return!!e(...t)}catch{return!1}},S3=jy&&By(()=>{let e=!1;const t=new Request(Fr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),g1=64*1024,Qd=jy&&By(()=>he.isReadableStream(new Response("").body)),Gu={stream:Qd&&(e=>e.body)};Of&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Gu[t]&&(Gu[t]=he.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new ot(`Response type '${t}' is not supported`,ot.ERR_NOT_SUPPORT,n)})})})(new Response);const C3=async e=>{if(e==null)return 0;if(he.isBlob(e))return e.size;if(he.isSpecCompliantForm(e))return(await new Request(Fr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(he.isArrayBufferView(e)||he.isArrayBuffer(e))return e.byteLength;if(he.isURLSearchParams(e)&&(e=e+""),he.isString(e))return(await T3(e)).byteLength},A3=async(e,t)=>{const r=he.toFiniteNumber(e.getContentLength());return r??C3(t)},N3=Of&&(async e=>{let{url:t,method:r,data:n,signal:i,cancelToken:a,timeout:o,onDownloadProgress:l,onUploadProgress:u,responseType:f,headers:d,withCredentials:m="same-origin",fetchOptions:g}=Dy(e);f=f?(f+"").toLowerCase():"text";let _=y3([i,a&&a.toAbortSignal()],o),y;const v=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let T;try{if(u&&S3&&r!=="get"&&r!=="head"&&(T=await A3(d,n))!==0){let I=new Request(t,{method:"POST",body:n,duplex:"half"}),M;if(he.isFormData(n)&&(M=I.headers.get("content-type"))&&d.setContentType(M),I.body){const[b,U]=d1(T,Zu(h1(u)));n=m1(I.body,g1,b,U)}}he.isString(m)||(m=m?"include":"omit");const k="credentials"in Request.prototype;y=new Request(t,{...g,signal:_,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:k?m:void 0});let E=await fetch(y);const w=Qd&&(f==="stream"||f==="response");if(Qd&&(l||w&&v)){const I={};["status","statusText","headers"].forEach(j=>{I[j]=E[j]});const M=he.toFiniteNumber(E.headers.get("content-length")),[b,U]=l&&d1(M,Zu(h1(l),!0))||[];E=new Response(m1(E.body,g1,b,()=>{U&&U(),v&&v()}),I)}f=f||"text";let P=await Gu[he.findKey(Gu,f)||"text"](E,e);return!w&&v&&v(),await new Promise((I,M)=>{My(I,M,{data:P,headers:an.from(E.headers),status:E.status,statusText:E.statusText,config:e,request:y})})}catch(k){throw v&&v(),k&&k.name==="TypeError"&&/fetch/i.test(k.message)?Object.assign(new ot("Network Error",ot.ERR_NETWORK,e,y),{cause:k.cause||k}):ot.from(k,k&&k.code,e,y)}}),eh={http:VC,xhr:_3,fetch:N3};he.forEach(eh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const x1=e=>`- ${e}`,b3=e=>he.isFunction(e)||e===null||e===!1,zy={getAdapter:e=>{e=he.isArray(e)?e:[e];const{length:t}=e;let r,n;const i={};for(let a=0;a<t;a++){r=e[a];let o;if(n=r,!b3(r)&&(n=eh[(o=String(r)).toLowerCase()],n===void 0))throw new ot(`Unknown adapter '${o}'`);if(n)break;i[o||"#"+a]=n}if(!n){const a=Object.entries(i).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(x1).join(`
`):" "+x1(a[0]):"as no adapter specified";throw new ot("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:eh};function U0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new vo(null,e)}function v1(e){return U0(e),e.headers=an.from(e.headers),e.data=z0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),zy.getAdapter(e.adapter||ec.adapter)(e).then(function(n){return U0(e),n.data=z0.call(e,e.transformResponse,n),n.headers=an.from(n.headers),n},function(n){return Ry(n)||(U0(e),n&&n.response&&(n.response.data=z0.call(e,e.transformResponse,n.response),n.response.headers=an.from(n.response.headers))),Promise.reject(n)})}const Uy="1.8.4",Rf={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Rf[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const _1={};Rf.transitional=function(t,r,n){function i(a,o){return"[Axios v"+Uy+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,l)=>{if(t===!1)throw new ot(i(o," has been removed"+(r?" in "+r:"")),ot.ERR_DEPRECATED);return r&&!_1[o]&&(_1[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,o,l):!0}};Rf.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function L3(e,t,r){if(typeof e!="object")throw new ot("options must be an object",ot.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const a=n[i],o=t[a];if(o){const l=e[a],u=l===void 0||o(l,a,e);if(u!==!0)throw new ot("option "+a+" must be "+u,ot.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ot("Unknown option "+a,ot.ERR_BAD_OPTION)}}const _u={assertOptions:L3,validators:Rf},ci=_u.validators;class Ga{constructor(t){this.defaults=t,this.interceptors={request:new u1,response:new u1}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ts(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:a}=r;n!==void 0&&_u.assertOptions(n,{silentJSONParsing:ci.transitional(ci.boolean),forcedJSONParsing:ci.transitional(ci.boolean),clarifyTimeoutError:ci.transitional(ci.boolean)},!1),i!=null&&(he.isFunction(i)?r.paramsSerializer={serialize:i}:_u.assertOptions(i,{encode:ci.function,serialize:ci.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),_u.assertOptions(r,{baseUrl:ci.spelling("baseURL"),withXsrfToken:ci.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=a&&he.merge(a.common,a[r.method]);a&&he.forEach(["delete","get","head","post","put","patch","common"],y=>{delete a[y]}),r.headers=an.concat(o,a);const l=[];let u=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(r)===!1||(u=u&&v.synchronous,l.unshift(v.fulfilled,v.rejected))});const f=[];this.interceptors.response.forEach(function(v){f.push(v.fulfilled,v.rejected)});let d,m=0,g;if(!u){const y=[v1.bind(this),void 0];for(y.unshift.apply(y,l),y.push.apply(y,f),g=y.length,d=Promise.resolve(r);m<g;)d=d.then(y[m++],y[m++]);return d}g=l.length;let _=r;for(m=0;m<g;){const y=l[m++],v=l[m++];try{_=y(_)}catch(T){v.call(this,T);break}}try{d=v1.call(this,_)}catch(y){return Promise.reject(y)}for(m=0,g=f.length;m<g;)d=d.then(f[m++],f[m++]);return d}getUri(t){t=ts(this.defaults,t);const r=Iy(t.baseURL,t.url,t.allowAbsoluteUrls);return Py(r,t.params,t.paramsSerializer)}}he.forEach(["delete","get","head","options"],function(t){Ga.prototype[t]=function(r,n){return this.request(ts(n||{},{method:t,url:r,data:(n||{}).data}))}});he.forEach(["post","put","patch"],function(t){function r(n){return function(a,o,l){return this.request(ts(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Ga.prototype[t]=r(),Ga.prototype[t+"Form"]=r(!0)});class kp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(i=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](i);n._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(l=>{n.subscribe(l),a=l}).then(i);return o.cancel=function(){n.unsubscribe(a)},o},t(function(a,o,l){n.reason||(n.reason=new vo(a,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new kp(function(i){t=i}),cancel:t}}}function P3(e){return function(r){return e.apply(null,r)}}function F3(e){return he.isObject(e)&&e.isAxiosError===!0}const th={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(th).forEach(([e,t])=>{th[t]=e});function Hy(e){const t=new Ga(e),r=yy(Ga.prototype.request,t);return he.extend(r,Ga.prototype,t,{allOwnKeys:!0}),he.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return Hy(ts(e,i))},r}const $e=Hy(ec);$e.Axios=Ga;$e.CanceledError=vo;$e.CancelToken=kp;$e.isCancel=Ry;$e.VERSION=Uy;$e.toFormData=Ff;$e.AxiosError=ot;$e.Cancel=$e.CanceledError;$e.all=function(t){return Promise.all(t)};$e.spread=P3;$e.isAxiosError=F3;$e.mergeConfig=ts;$e.AxiosHeaders=an;$e.formToJSON=e=>Oy(he.isHTMLForm(e)?new FormData(e):e);$e.getAdapter=zy.getAdapter;$e.HttpStatusCode=th;$e.default=$e;const xi="http://localhost:8000/api",y1={CAMERAS:{LIST:"/cameras/cameras/",UPLOAD:"/cameras/cameras/upload_csv/",DETAIL:e=>`/cameras/cameras/${e}/`},COMMANDS:{SAVE_CONFIG:"/command/commands/save_config/",EXECUTE:"/command/execute/"},AUTH:{LOGIN:"/auth/token/",REFRESH:"/auth/token/refresh/"}};function Vy(e){var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null}let rh=null;const O3=e=>{rh=e},Xu=e=>{rh?rh(e):window.location.href=e},en=$e.create({baseURL:xi,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});en.interceptors.request.use(e=>{var t;if(["post","put","patch","delete"].includes(((t=e.method)==null?void 0:t.toLowerCase())||"")){const r=Vy("csrftoken");r&&(e.headers["X-CSRFToken"]=r)}return e});en.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refreshToken");if(n){const i=await $e.post(`${xi}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"X-CSRFToken":Vy("csrftoken")}}),{access:a}=i.data;return localStorage.setItem("token",a),en.defaults.headers.common.Authorization=`Bearer ${a}`,t.headers.Authorization=`Bearer ${a}`,en(t)}}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),Xu("/login")}}return Promise.reject(e)});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var R3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),wt=(e,t)=>{const r=N.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:u,...f},d)=>N.createElement("svg",{ref:d,...R3,width:i,height:i,stroke:n,strokeWidth:o?Number(a)*24/Number(i):a,className:["lucide",`lucide-${M3(e)}`,l].join(" "),...f},[...t.map(([m,g])=>N.createElement(m,g)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=wt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=wt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=wt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=wt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k1=wt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E1=wt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=wt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=wt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=wt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=wt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=wt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T1=wt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=wt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=wt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=wt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=wt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=wt("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=wt("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=wt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=wt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=wt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=wt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=wt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=wt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=wt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=wt("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=wt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=wt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=wt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=wt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=wt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=wt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S1=wt("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C1=wt("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);function K3({onLogin:e}){const t=Gi(),[r,n]=N.useState(""),[i,a]=N.useState(""),[o,l]=N.useState(""),[u,f]=N.useState(!1);N.useEffect(()=>{(async()=>{try{await en.get("/auth/csrf/")}catch(g){console.error("Error initializing CSRF:",g)}})()},[]);const d=async m=>{var g,_;m.preventDefault(),f(!0),l("");try{const y={username:r,password:i},v=await en.post("/auth/login/",y);localStorage.setItem("token",v.data.access),localStorage.setItem("refreshToken",v.data.refresh),en.defaults.headers.common.Authorization=`Bearer ${v.data.access}`,e(),t("/")}catch(y){console.error("Login error details:",y),(_=(g=y.response)==null?void 0:g.data)!=null&&_.detail?l(y.response.data.detail):l("Nom d'utilisateur ou mot de passe incorrect")}finally{f(!1)}};return p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:p.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[p.jsxs("div",{className:"flex items-center justify-center mb-8",children:[p.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:p.jsx(la,{className:"h-8 w-8 text-purple-600"})}),p.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),o&&p.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:o}),p.jsxs("form",{onSubmit:d,className:"space-y-6",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(ns,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",value:r,onChange:m=>n(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(la,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"password",value:i,onChange:m=>a(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),p.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50",children:u?p.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Se connecter"}),p.jsx("div",{className:"text-center mt-4",children:p.jsxs("p",{className:"text-sm text-gray-600",children:["Pas encore de compte ?"," ",p.jsx(hi,{to:"/register",className:"font-medium text-purple-600 hover:text-purple-500",children:"S'inscrire"})]})})]}),p.jsx("div",{className:"mt-6 text-center",children:p.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}const Ep="http://localhost:8000/api";$e.defaults.withCredentials=!0;const Ku=$e.create({baseURL:Ep,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}}),q3=e=>{var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null},Yy=()=>q3("csrftoken"),Y3=async()=>{try{return(await $e.get(`${Ep}/auth/csrf/`,{withCredentials:!0,headers:{Accept:"application/json"}})).data.token}catch(e){throw console.error("Error fetching CSRF token:",e),e}};let H0=null;const J3=async()=>(H0||(H0=Y3()),H0);Ku.interceptors.request.use(async e=>{var n;if(((n=e.method)==null?void 0:n.toLowerCase())==="get")return e;let t=Yy();if(!t)try{if(t=await J3(),!t)throw new Error("Failed to get CSRF token")}catch(i){throw console.error("Failed to fetch CSRF token:",i),i}t&&(e.headers["X-CSRFToken"]=t);const r=localStorage.getItem("access_token");return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));Ku.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refresh_token");if(n){const i=await $e.post(`${Ep}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"Content-Type":"application/json","X-CSRFToken":Yy()}});if(i.data.access)return localStorage.setItem("access_token",i.data.access),t.headers.Authorization=`Bearer ${i.data.access}`,Ku(t)}}catch(n){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(n)}}return Promise.reject(e)});function Q3({onRegister:e}){const t=Gi(),[r,n]=N.useState({username:"",email:"",phone_number:"",password:"",confirmPassword:"",first_name:"",last_name:""}),[i,a]=N.useState(""),[o,l]=N.useState(!1),u=d=>{const{name:m,value:g}=d.target;n(_=>({..._,[m]:g}))},f=async d=>{var m,g,_,y,v;if(d.preventDefault(),a(""),l(!0),r.password!==r.confirmPassword){a("Les mots de passe ne correspondent pas"),l(!1);return}try{const T=await Ku.post("/auth/register/",{username:r.username,email:r.email,phone_number:r.phone_number,password:r.password,first_name:r.first_name,last_name:r.last_name});T.data.access&&(localStorage.setItem("access_token",T.data.access),T.data.refresh&&localStorage.setItem("refresh_token",T.data.refresh),e?e():t("/"))}catch(T){console.error("Registration error:",T),(g=(m=T.response)==null?void 0:m.data)!=null&&g.error?a(T.response.data.error):(y=(_=T.response)==null?void 0:_.data)!=null&&y.username?a("Ce nom d'utilisateur est dj pris"):((v=T.response)==null?void 0:v.status)===403?a("Erreur CORS: Vrifiez la configuration du serveur"):a("Une erreur est survenue lors de l'inscription. Veuillez ressayer.")}finally{l(!1)}};return p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:p.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[p.jsxs("div",{className:"flex items-center justify-center mb-8",children:[p.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:p.jsx(ns,{className:"h-8 w-8 text-purple-600"})}),p.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),i&&p.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:i}),p.jsxs("form",{onSubmit:f,className:"space-y-6",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(ns,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",name:"username",value:r.username,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(E1,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Prnom",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(E1,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom",required:!0})]})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(Zy,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"email",name:"email",value:r.email,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Email",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(Gy,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"tel",name:"phone_number",value:r.phone_number,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Numro de tlphone",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(la,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"password",name:"password",value:r.password,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(la,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Confirmer le mot de passe",required:!0})]}),p.jsx("div",{children:p.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:o?"Inscription en cours...":"S'inscrire"})}),p.jsx("div",{className:"text-center",children:p.jsxs("p",{className:"text-sm text-gray-600",children:["Dj un compte ?"," ",p.jsx(hi,{to:"/login",className:"font-medium text-purple-600 hover:text-purple-500",children:"Se connecter"})]})})]}),p.jsx("div",{className:"mt-6 text-center",children:p.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}const eA=({onLogout:e})=>{const t=Zi(),r=t.pathname,n=a=>t.pathname===a,i=[{path:"/",icon:z3,label:"Tableau de bord"},{path:"/firewalls",icon:rs,label:"Pare-feux"},{path:"/history",icon:$y,label:"Historique"},{path:"/settings",icon:G3,label:"Paramtres"}];return p.jsxs("div",{className:"w-64 bg-purple-900 text-white p-6",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-8",children:[p.jsx(X3,{className:"h-6 w-6"}),p.jsx("h1",{className:"text-2xl font-bold",children:"INWI"})]}),p.jsxs("nav",{className:"space-y-4",children:[i.map(a=>{const o=a.icon;return p.jsxs(hi,{to:a.path,className:`flex items-center space-x-2 w-full p-2 rounded-lg ${n(a.path)?"bg-purple-700":"hover:bg-purple-800"}`,children:[p.jsx(o,{className:"h-5 w-5"}),p.jsx("span",{children:a.label})]},a.path)}),p.jsxs(hi,{to:"/profile",className:`flex items-center space-x-2 w-full p-2 rounded-lg ${r==="/profile"?"bg-purple-700":"hover:bg-purple-800"}`,children:[p.jsx(ns,{className:"h-5 w-5"}),p.jsx("span",{children:"Profile"})]}),p.jsxs(hi,{to:"/config",className:`flex items-center space-x-2 w-full p-2 rounded-lg ${r==="/config"?"bg-purple-700":"hover:bg-purple-800"}`,children:[p.jsx(B3,{className:"h-5 w-5"}),p.jsx("span",{children:"Sauvegarde commande firewall "})]}),p.jsxs(hi,{to:"/matrix",className:`flex items-center space-x-2 w-full p-2 rounded-lg ${r==="/matrix"?"bg-purple-700":"hover:bg-purple-800"}`,children:[p.jsx(Wy,{className:"h-5 w-5"}),p.jsx("span",{children:"configuration dynamique firewall"})]}),p.jsxs(hi,{to:"/map",className:`flex items-center space-x-2 w-full p-2 rounded-lg ${r==="/map"?"bg-purple-700":"hover:bg-purple-800"}`,children:[p.jsx(H3,{className:"h-5 w-5"}),p.jsx("span",{children:"Carte de devices"})]}),p.jsxs(hi,{to:"/templates",className:`flex items-center space-x-2 w-full p-2 rounded-lg ${r==="/templates"?"bg-purple-700":"hover:bg-purple-800"}`,children:[p.jsx(j3,{className:"h-5 w-5"}),p.jsx("span",{children:"Templates des configurations"})]}),p.jsxs("button",{onClick:e,className:"flex items-center space-x-2 w-full p-2 rounded-lg hover:bg-purple-800 mt-auto",children:[p.jsx(U3,{className:"h-5 w-5"}),p.jsx("span",{children:"Logout"})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Jy=1252,tA=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Tp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Sp=function(e){tA.indexOf(e)!=-1&&(Jy=Tp[0]=e)};function rA(){Sp(1252)}var Gn=function(e){Sp(e)};function Qy(){Gn(1200),rA()}function A1(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function nA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function e2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ko=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?nA(e.slice(2)):t==254&&r==255?e2(e.slice(2)):t==65279?e.slice(1):e},Zc=function(t){return String.fromCharCode(t)},N1=function(t){return String.fromCharCode(t)},ia,ca="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function b1(e){for(var t="",r=0,n=0,i=0,a=0,o=0,l=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,i=e.charCodeAt(f++),l=(n&15)<<2|i>>6,u=i&63,isNaN(n)?l=u=64:isNaN(i)&&(u=64),t+=ca.charAt(a)+ca.charAt(o)+ca.charAt(l)+ca.charAt(u);return t}function mn(e){var t="",r=0,n=0,i=0,a=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=ca.indexOf(e.charAt(f++)),o=ca.indexOf(e.charAt(f++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=ca.indexOf(e.charAt(f++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=ca.indexOf(e.charAt(f++)),i=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),us=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ta(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function L1(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Zn=function(t){return xt?us(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function fs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Cp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Cp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var aa=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:us(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function iA(e){for(var t=[],r=0,n=e.length+250,i=Ta(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ta(65535),n=65530)}return t.push(i.slice(0,r)),aa(t)}var Zr=/\u0000/g,qo=/[\u0001-\u0006]/g;function Qs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xn(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}function Ap(e,t){var r=""+e;return r.length>=t?r:Xt(" ",t-r.length)+r}function qu(e,t){var r=""+e;return r.length>=t?r:r+Xt(" ",t-r.length)}function aA(e,t){var r=""+Math.round(e);return r.length>=t?r:Xt("0",t-r.length)+r}function sA(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}var P1=Math.pow(2,32);function Cs(e,t){if(e>P1||e<-P1)return aA(e,t);var r=Math.round(e);return sA(r,t)}function Yu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var F1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],V0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},O1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ju(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,o=1,l=0,u=1,f=0,d=0,m=Math.floor(i);f<t&&(m=Math.floor(i),l=m*o+a,d=m*f+u,!(i-m<5e-8));)i=1/(i-m),a=o,o=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=a):(d=f,l=o)),!r)return[0,n*l,d];var g=Math.floor(n*l/d);return[g,n*l-g*d,d]}function Wa(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=pA(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var t2=new Date(1899,11,31,0,0,0),cA=t2.getTime(),uA=new Date(1900,2,1,0,0,0);function r2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=uA&&(r+=24*60*60*1e3),(r-(cA+(e.getTimezoneOffset()-t2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Np(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fA(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dA(e){var t=e<0?12:11,r=Np(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function hA(e){var t=Np(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Dl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=dA(e):t===10?r=e.toFixed(10).substr(0,12):r=hA(e),Np(fA(r.toUpperCase()))}function is(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Dl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Mn(14,r2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function pA(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function mA(e,t,r,n){var i="",a=0,o=0,l=r.y,u,f=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return V0[r.m-1][1];case 5:return V0[r.m-1][0];default:return V0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return F1[r.q][0];default:return F1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=Xn(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?Xn(u,f):"";return d}function ua(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var n2=/%/g;function gA(e,t,r){var n=t.replace(n2,""),i=t.length-n.length;return Di(e,n,r*Math.pow(10,2*i))+Xt("%",i)}function xA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Di(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function i2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+i2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var a2=/# (\?+)( ?)\/( ?)(\d+)/;function vA(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),o=i-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?Xt(" ",e[1].length+1+e[4].length):Ap(o,e[1].length)+e[2]+"/"+e[3]+Xn(l,e[4].length))}function _A(e,t,r){return r+(t===0?"":""+t)+Xt(" ",e[1].length+2+e[4].length)}var s2=/^#*0*\.([0#]+)/,o2=/\).*[0#]/,l2=/\(###\) ###\\?-####/;function Hr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function R1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function M1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function yA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function wA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Tn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(o2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tn("n",n,r):"("+Tn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xA(e,t,r);if(t.indexOf("%")!==-1)return gA(e,t,r);if(t.indexOf("E")!==-1)return i2(t,r);if(t.charCodeAt(0)===36)return"$"+Tn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Cs(u,t.length);if(t.match(/^[#?]+$/))return i=Cs(r,0),i==="0"&&(i=""),i.length>t.length?i:Hr(t.substr(0,t.length-i.length))+i;if(a=t.match(a2))return vA(a,u,f);if(t.match(/^#+0+$/))return f+Cs(u,t.length-t.indexOf("0"));if(a=t.match(s2))return i=R1(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Hr(a[1])).replace(/\.$/,"."+Hr(a[1])).replace(/\.(\d*)$/,function(y,v){return"."+v+Xt("0",Hr(a[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+R1(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ua(Cs(u,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tn(e,t,-r):ua(""+(Math.floor(r)+yA(r,a[1].length)))+"."+Xn(M1(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Tn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qs(Tn(e,t.replace(/[\\-]/g,""),r)),o=0,Qs(Qs(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match(l2))return i=Tn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Ju(u,Math.pow(10,o)-1,!1),i=""+f,d=Di("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=qu(l[2],o),d.length<a[4].length&&(d=Hr(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Ju(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ap(l[1],o)+a[2]+"/"+a[3]+qu(l[2],o):Xt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Cs(r,0),t.length<=i.length?i:Hr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,g=t.length-i.length-m;return Hr(t.substr(0,m)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=M1(r,a[1].length),r<0?"-"+Tn(e,t,-r):ua(wA(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Xn(0,3-y.length):"")+y})+"."+Xn(o,a[1].length);switch(t){case"###,##0.00":return Tn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=ua(Cs(u,0));return _!=="0"?f+_:"";case"###,###.00":return Tn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function kA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Di(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function EA(e,t,r){var n=t.replace(n2,""),i=t.length-n.length;return Di(e,n,r*Math.pow(10,2*i))+Xt("%",i)}function c2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+c2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(o2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fi("n",n,r):"("+fi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return kA(e,t,r);if(t.indexOf("%")!==-1)return EA(e,t,r);if(t.indexOf("E")!==-1)return c2(t,r);if(t.charCodeAt(0)===36)return"$"+fi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Xn(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Hr(t.substr(0,t.length-i.length))+i;if(a=t.match(a2))return _A(a,u,f);if(t.match(/^#+0+$/))return f+Xn(u,t.length-t.indexOf("0"));if(a=t.match(s2))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Hr(a[1])).replace(/\.$/,"."+Hr(a[1])),i=i.replace(/\.(\d*)$/,function(y,v){return"."+v+Xt("0",Hr(a[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ua(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fi(e,t,-r):ua(""+r)+"."+Xt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return fi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qs(fi(e,t.replace(/[\\-]/g,""),r)),o=0,Qs(Qs(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match(l2))return i=fi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Ju(u,Math.pow(10,o)-1,!1),i=""+f,d=Di("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=qu(l[2],o),d.length<a[4].length&&(d=Hr(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Ju(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ap(l[1],o)+a[2]+"/"+a[3]+qu(l[2],o):Xt(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Hr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,g=t.length-i.length-m;return Hr(t.substr(0,m)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fi(e,t,-r):ua(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Xn(0,3-y.length):"")+y})+"."+Xn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=ua(""+u);return _!=="0"?f+_:"";default:if(t.match(/\.[0#?]*$/))return fi(e,t.slice(0,t.lastIndexOf(".")),r)+Hr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Di(e,t,r){return(r|0)===r?fi(e,t,r):Tn(e,t,r)}function TA(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var u2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _o(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Yu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(u2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function SA(e,t,r,n){for(var i=[],a="",o=0,l="",u="t",f,d,m,g="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Yu(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(m=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(m);i[i.length]={t:"t",v:a},++o;break;case"\\":var _=e.charAt(++o),y=_==="("||_===")"?_:"t";i[i.length]={t:y,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=Wa(t,r,e.charAt(o+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Wa(t,r),f==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),i[i.length]={t:l,v:a},u=l;break;case"A":case"a":case"":var v={t:l,v:l};if(f==null&&(f=Wa(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(v.v=f.H>=12?"P":"A"),v.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(v.v=f.H>=12?"PM":"AM"),v.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(v.v=f.H>=12?"":""),v.t="T",o+=5,g="h"):(v.t="t",++o),f==null&&v.t==="T")return"";i[i.length]=v,u=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(u2)){if(f==null&&(f=Wa(t,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",_o(e)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;i[i.length]={t:l,v:a},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var T=0,k=0,E;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=g,u="h",T<1&&(T=1);break;case"s":(E=i[o].v.match(/\.0+$/))&&(k=Math.max(k,E[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&i[o].v.match(/[Hh]/)&&(T=1),T<2&&i[o].v.match(/[Mm]/)&&(T=2),T<3&&i[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var w="",P;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=mA(i[o].t.charCodeAt(0),i[o].v,f,k),i[o].t="t";break;case"n":case"?":for(P=o+1;i[P]!=null&&((l=i[P].t)==="?"||l==="D"||(l===" "||l==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[o].v+=i[P].v,i[P]={v:"",t:";"},++P;w+=i[o].v,o=P-1;break;case"G":i[o].t="t",i[o].v=is(t,r);break}var I="",M,b;if(w.length>0){w.charCodeAt(0)==40?(M=t<0&&w.charCodeAt(0)===45?-t:t,b=Di("n",w,M)):(M=t<0&&n>1?-t:t,b=Di("n",w,M),M<0&&i[0]&&i[0].t=="t"&&(b=b.substr(1),i[0].v="-"+i[0].v)),P=b.length-1;var U=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){U=o;break}var j=i.length;if(U===i.length&&b.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(P>=i[o].v.length-1?(P-=i[o].v.length,i[o].v=b.substr(P+1,i[o].v.length)):P<0?i[o].v="":(i[o].v=b.substr(0,P+1),P=-1),i[o].t="t",j=o);P>=0&&j<i.length&&(i[j].v=b.substr(0,P+1)+i[j].v)}else if(U!==i.length&&b.indexOf("E")===-1){for(P=b.indexOf(".")-1,o=U;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===U?i[o].v.indexOf(".")-1:i[o].v.length-1,I=i[o].v.substr(d+1);d>=0;--d)P>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(I=b.charAt(P--)+I);i[o].v=I,i[o].t="t",j=o}for(P>=0&&j<i.length&&(i[j].v=b.substr(0,P+1)+i[j].v),P=b.indexOf(".")+1,o=U;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==U)){for(d=i[o].v.indexOf(".")>-1&&o===U?i[o].v.indexOf(".")+1:0,I=i[o].v.substr(0,d);d<i[o].v.length;++d)P<b.length&&(I+=b.charAt(P++));i[o].v=I,i[o].t="t",j=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(M=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Di(i[o].t,i[o].v,M),i[o].t="t");var K="";for(o=0;o!==i.length;++o)i[o]!=null&&(K+=i[o].v);return K}var I1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function D1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function CA(e,t){var r=TA(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(I1),l=r[1].match(I1);return D1(t,o)?[n,r[0]]:D1(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function Mn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:st)[e],n==null&&(n=r.table&&r.table[O1[e]]||st[O1[e]]),n==null&&(n=lA[e]||"General");break}if(Yu(n,0))return is(t,r);t instanceof Date&&(t=r2(t,r.date1904));var i=CA(n,t);if(Yu(i[1]))return is(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return SA(i[1],t,r,i[0])}function Xa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(st[r]==null){t<0&&(t=r);continue}if(st[r]==e){t=r;break}}t<0&&(t=391)}return st[t]=e,t}function f2(){st=oA()}var AA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},d2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NA(e){var t=typeof e=="number"?st[e]:e;return t=t.replace(d2,"(\\d+)"),new RegExp("^"+t+"$")}function bA(e,t,r){var n=-1,i=-1,a=-1,o=-1,l=-1,u=-1;(t.match(d2)||[]).forEach(function(m,g){var _=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=_;break;case"d":a=_;break;case"h":o=_;break;case"s":u=_;break;case"m":o>=0?l=_:i=_;break}}),u>=0&&l==-1&&i>=0&&(l=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var LA=function(){var e={};e.version="1.2.0";function t(){for(var b=0,U=new Array(256),j=0;j!=256;++j)b=j,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,U[j]=b;return typeof Int32Array<"u"?new Int32Array(U):U}var r=t();function n(b){var U=0,j=0,K=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(K=0;K!=256;++K)V[K]=b[K];for(K=0;K!=256;++K)for(j=b[K],U=256+K;U<4096;U+=256)j=V[U]=j>>>8^b[j&255];var G=[];for(K=1;K!=16;++K)G[K-1]=typeof Int32Array<"u"?V.subarray(K*256,K*256+256):V.slice(K*256,K*256+256);return G}var i=n(r),a=i[0],o=i[1],l=i[2],u=i[3],f=i[4],d=i[5],m=i[6],g=i[7],_=i[8],y=i[9],v=i[10],T=i[11],k=i[12],E=i[13],w=i[14];function P(b,U){for(var j=U^-1,K=0,V=b.length;K<V;)j=j>>>8^r[(j^b.charCodeAt(K++))&255];return~j}function I(b,U){for(var j=U^-1,K=b.length-15,V=0;V<K;)j=w[b[V++]^j&255]^E[b[V++]^j>>8&255]^k[b[V++]^j>>16&255]^T[b[V++]^j>>>24]^v[b[V++]]^y[b[V++]]^_[b[V++]]^g[b[V++]]^m[b[V++]]^d[b[V++]]^f[b[V++]]^u[b[V++]]^l[b[V++]]^o[b[V++]]^a[b[V++]]^r[b[V++]];for(K+=15;V<K;)j=j>>>8^r[(j^b[V++])&255];return~j}function M(b,U){for(var j=U^-1,K=0,V=b.length,G=0,de=0;K<V;)G=b.charCodeAt(K++),G<128?j=j>>>8^r[(j^G)&255]:G<2048?(j=j>>>8^r[(j^(192|G>>6&31))&255],j=j>>>8^r[(j^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,de=b.charCodeAt(K++)&1023,j=j>>>8^r[(j^(240|G>>8&7))&255],j=j>>>8^r[(j^(128|G>>2&63))&255],j=j>>>8^r[(j^(128|de>>6&15|(G&3)<<4))&255],j=j>>>8^r[(j^(128|de&63))&255]):(j=j>>>8^r[(j^(224|G>>12&15))&255],j=j>>>8^r[(j^(128|G>>6&63))&255],j=j>>>8^r[(j^(128|G&63))&255]);return~j}return e.table=r,e.bstr=P,e.buf=I,e.str=M,e}(),_t=function(){var t={};t.version="1.2.1";function r(C,R){for(var F=C.split("/"),D=R.split("/"),B=0,z=0,ee=Math.min(F.length,D.length);B<ee;++B){if(z=F[B].length-D[B].length)return z;if(F[B]!=D[B])return F[B]<D[B]?-1:1}return F.length-D.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var R=C.lastIndexOf("/");return R===-1?C:C.slice(0,R+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var R=C.lastIndexOf("/");return R===-1?C:C.slice(R+1)}function a(C,R){typeof R=="string"&&(R=new Date(R));var F=R.getHours();F=F<<6|R.getMinutes(),F=F<<5|R.getSeconds()>>>1,C.write_shift(2,F);var D=R.getFullYear()-1980;D=D<<4|R.getMonth()+1,D=D<<5|R.getDate(),C.write_shift(2,D)}function o(C){var R=C.read_shift(2)&65535,F=C.read_shift(2)&65535,D=new Date,B=F&31;F>>>=5;var z=F&15;F>>>=4,D.setMilliseconds(0),D.setFullYear(F+1980),D.setMonth(z-1),D.setDate(B);var ee=R&31;R>>>=5;var me=R&63;return R>>>=6,D.setHours(R),D.setMinutes(me),D.setSeconds(ee<<1),D}function l(C){wr(C,0);for(var R={},F=0;C.l<=C.length-4;){var D=C.read_shift(2),B=C.read_shift(2),z=C.l+B,ee={};switch(D){case 21589:F=C.read_shift(1),F&1&&(ee.mtime=C.read_shift(4)),B>5&&(F&2&&(ee.atime=C.read_shift(4)),F&4&&(ee.ctime=C.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}C.l=z,R[D]=ee}return R}var u;function f(){return u||(u={})}function d(C,R){if(C[0]==80&&C[1]==75)return ut(C,R);if((C[0]|32)==109&&(C[1]|32)==105)return gt(C,R);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var F=3,D=512,B=0,z=0,ee=0,me=0,ne=0,se=[],oe=C.slice(0,512);wr(oe,0);var ke=m(oe);switch(F=ke[0],F){case 3:D=512;break;case 4:D=4096;break;case 0:if(ke[1]==0)return ut(C,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}D!==512&&(oe=C.slice(0,D),wr(oe,28));var be=C.slice(0,D);g(oe,F);var Ie=oe.read_shift(4,"i");if(F===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);oe.l+=4,ee=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),me=oe.read_shift(4,"i"),B=oe.read_shift(4,"i"),ne=oe.read_shift(4,"i"),z=oe.read_shift(4,"i");for(var Ce=-1,Re=0;Re<109&&(Ce=oe.read_shift(4,"i"),!(Ce<0));++Re)se[Re]=Ce;var qe=_(C,D);T(ne,z,qe,D,se);var Rt=E(qe,ee,se,D);Rt[ee].name="!Directory",B>0&&me!==de&&(Rt[me].name="!MiniFAT"),Rt[se[0]].name="!FAT",Rt.fat_addrs=se,Rt.ssz=D;var Mt={},hr=[],ki=[],Dn=[];w(ee,Rt,qe,hr,B,Mt,ki,me),y(ki,Dn,hr),hr.shift();var Ki={FileIndex:ki,FullPaths:Dn};return R&&R.raw&&(Ki.raw={header:be,sectors:qe}),Ki}function m(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Se,"Header Signature: "),C.l+=16;var R=C.read_shift(2,"u");return[C.read_shift(2,"u"),R]}function g(C,R){var F=9;switch(C.l+=2,F=C.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function _(C,R){for(var F=Math.ceil(C.length/R)-1,D=[],B=1;B<F;++B)D[B-1]=C.slice(B*R,(B+1)*R);return D[F-1]=C.slice(F*R),D}function y(C,R,F){for(var D=0,B=0,z=0,ee=0,me=0,ne=F.length,se=[],oe=[];D<ne;++D)se[D]=oe[D]=D,R[D]=F[D];for(;me<oe.length;++me)D=oe[me],B=C[D].L,z=C[D].R,ee=C[D].C,se[D]===D&&(B!==-1&&se[B]!==B&&(se[D]=se[B]),z!==-1&&se[z]!==z&&(se[D]=se[z])),ee!==-1&&(se[ee]=D),B!==-1&&D!=se[D]&&(se[B]=se[D],oe.lastIndexOf(B)<me&&oe.push(B)),z!==-1&&D!=se[D]&&(se[z]=se[D],oe.lastIndexOf(z)<me&&oe.push(z));for(D=1;D<ne;++D)se[D]===D&&(z!==-1&&se[z]!==z?se[D]=se[z]:B!==-1&&se[B]!==B&&(se[D]=se[B]));for(D=1;D<ne;++D)if(C[D].type!==0){if(me=D,me!=se[me])do me=se[me],R[D]=R[me]+"/"+R[D];while(me!==0&&se[me]!==-1&&me!=se[me]);se[D]=-1}for(R[0]+="/",D=1;D<ne;++D)C[D].type!==2&&(R[D]+="/")}function v(C,R,F){for(var D=C.start,B=C.size,z=[],ee=D;F&&B>0&&ee>=0;)z.push(R.slice(ee*G,ee*G+G)),B-=G,ee=ja(F,ee*4);return z.length===0?lr(0):aa(z).slice(0,C.size)}function T(C,R,F,D,B){var z=de;if(C===de){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ee=F[C],me=(D>>>2)-1;if(!ee)return;for(var ne=0;ne<me&&(z=ja(ee,ne*4))!==de;++ne)B.push(z);T(ja(ee,D-4),R-1,F,D,B)}}function k(C,R,F,D,B){var z=[],ee=[];B||(B=[]);var me=D-1,ne=0,se=0;for(ne=R;ne>=0;){B[ne]=!0,z[z.length]=ne,ee.push(C[ne]);var oe=F[Math.floor(ne*4/D)];if(se=ne*4&me,D<4+se)throw new Error("FAT boundary crossed: "+ne+" 4 "+D);if(!C[oe])break;ne=ja(C[oe],se)}return{nodes:z,data:G1([ee])}}function E(C,R,F,D){var B=C.length,z=[],ee=[],me=[],ne=[],se=D-1,oe=0,ke=0,be=0,Ie=0;for(oe=0;oe<B;++oe)if(me=[],be=oe+R,be>=B&&(be-=B),!ee[be]){ne=[];var Ce=[];for(ke=be;ke>=0;){Ce[ke]=!0,ee[ke]=!0,me[me.length]=ke,ne.push(C[ke]);var Re=F[Math.floor(ke*4/D)];if(Ie=ke*4&se,D<4+Ie)throw new Error("FAT boundary crossed: "+ke+" 4 "+D);if(!C[Re]||(ke=ja(C[Re],Ie),Ce[ke]))break}z[be]={nodes:me,data:G1([ne])}}return z}function w(C,R,F,D,B,z,ee,me){for(var ne=0,se=D.length?2:0,oe=R[C].data,ke=0,be=0,Ie;ke<oe.length;ke+=128){var Ce=oe.slice(ke,ke+128);wr(Ce,64),be=Ce.read_shift(2),Ie=Op(Ce,0,be-se),D.push(Ie);var Re={name:Ie,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},qe=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);qe!==0&&(Re.ct=P(Ce,Ce.l-8));var Rt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Rt!==0&&(Re.mt=P(Ce,Ce.l-8)),Re.start=Ce.read_shift(4,"i"),Re.size=Ce.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=de,Re.name=""),Re.type===5?(ne=Re.start,B>0&&ne!==de&&(R[ne].name="!StreamData")):Re.size>=4096?(Re.storage="fat",R[Re.start]===void 0&&(R[Re.start]=k(F,Re.start,R.fat_addrs,R.ssz)),R[Re.start].name=Re.name,Re.content=R[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:ne!==de&&Re.start!==de&&R[ne]&&(Re.content=v(Re,R[ne].data,(R[me]||{}).data))),Re.content&&wr(Re.content,0),z[Ie]=Re,ee.push(Re)}}function P(C,R){return new Date((cn(C,R+4)/1e7*Math.pow(2,32)+cn(C,R)/1e7-11644473600)*1e3)}function I(C,R){return f(),d(u.readFileSync(C),R)}function M(C,R){var F=R&&R.type;switch(F||xt&&Buffer.isBuffer(C)&&(F="buffer"),F||"base64"){case"file":return I(C,R);case"base64":return d(Zn(mn(C)),R);case"binary":return d(Zn(C),R)}return d(C,R)}function b(C,R){var F=R||{},D=F.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=D+"/",C.FileIndex[0]={name:D,type:5}),F.CLSID&&(C.FileIndex[0].clsid=F.CLSID),U(C)}function U(C){var R="Sh33tJ5";if(!_t.find(C,"/"+R)){var F=lr(4);F[0]=55,F[1]=F[3]=50,F[2]=54,C.FileIndex.push({name:R,type:2,content:F,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+R),j(C)}}function j(C,R){b(C);for(var F=!1,D=!1,B=C.FullPaths.length-1;B>=0;--B){var z=C.FileIndex[B];switch(z.type){case 0:D?F=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(z.R*z.L*z.C)&&(F=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!R)){var ee=new Date(1987,1,19),me=0,ne=Object.create?Object.create(null):{},se=[];for(B=0;B<C.FullPaths.length;++B)ne[C.FullPaths[B]]=!0,C.FileIndex[B].type!==0&&se.push([C.FullPaths[B],C.FileIndex[B]]);for(B=0;B<se.length;++B){var oe=n(se[B][0]);D=ne[oe],D||(se.push([oe,{name:i(oe).replace("/",""),type:1,clsid:Y,ct:ee,mt:ee,content:null}]),ne[oe]=!0)}for(se.sort(function(Ie,Ce){return r(Ie[0],Ce[0])}),C.FullPaths=[],C.FileIndex=[],B=0;B<se.length;++B)C.FullPaths[B]=se[B][0],C.FileIndex[B]=se[B][1];for(B=0;B<se.length;++B){var ke=C.FileIndex[B],be=C.FullPaths[B];if(ke.name=i(be).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||Y,B===0)ke.C=se.length>1?1:-1,ke.size=0,ke.type=5;else if(be.slice(-1)=="/"){for(me=B+1;me<se.length&&n(C.FullPaths[me])!=be;++me);for(ke.C=me>=se.length?-1:me,me=B+1;me<se.length&&n(C.FullPaths[me])!=n(be);++me);ke.R=me>=se.length?-1:me,ke.type=1}else n(C.FullPaths[B+1]||"")==n(be)&&(ke.R=B+1),ke.type=2}}}function K(C,R){var F=R||{};if(F.fileType=="mad")return St(C,F);switch(j(C),F.fileType){case"zip":return or(C,F)}var D=function(Ie){for(var Ce=0,Re=0,qe=0;qe<Ie.FileIndex.length;++qe){var Rt=Ie.FileIndex[qe];if(Rt.content){var Mt=Rt.content.length;Mt>0&&(Mt<4096?Ce+=Mt+63>>6:Re+=Mt+511>>9)}}for(var hr=Ie.FullPaths.length+3>>2,ki=Ce+7>>3,Dn=Ce+127>>7,Ki=ki+Re+hr+Dn,ii=Ki+127>>7,Ei=ii<=109?0:Math.ceil((ii-109)/127);Ki+ii+Ei+127>>7>ii;)Ei=++ii<=109?0:Math.ceil((ii-109)/127);var it=[1,Ei,ii,Dn,hr,Re,Ce,0];return Ie.FileIndex[0].size=Ce<<6,it[7]=(Ie.FileIndex[0].start=it[0]+it[1]+it[2]+it[3]+it[4]+it[5])+(it[6]+7>>3),it}(C),B=lr(D[7]<<9),z=0,ee=0;{for(z=0;z<8;++z)B.write_shift(1,ce[z]);for(z=0;z<8;++z)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),z=0;z<3;++z)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,D[2]),B.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:de),B.write_shift(4,D[3]),B.write_shift(-4,D[1]?D[0]-1:de),B.write_shift(4,D[1]),z=0;z<109;++z)B.write_shift(-4,z<D[2]?D[1]+z:-1)}if(D[1])for(ee=0;ee<D[1];++ee){for(;z<236+ee*127;++z)B.write_shift(-4,z<D[2]?D[1]+z:-1);B.write_shift(-4,ee===D[1]-1?de:ee+1)}var me=function(Ie){for(ee+=Ie;z<ee-1;++z)B.write_shift(-4,z+1);Ie&&(++z,B.write_shift(-4,de))};for(ee=z=0,ee+=D[1];z<ee;++z)B.write_shift(-4,xe.DIFSECT);for(ee+=D[2];z<ee;++z)B.write_shift(-4,xe.FATSECT);me(D[3]),me(D[4]);for(var ne=0,se=0,oe=C.FileIndex[0];ne<C.FileIndex.length;++ne)oe=C.FileIndex[ne],oe.content&&(se=oe.content.length,!(se<4096)&&(oe.start=ee,me(se+511>>9)));for(me(D[6]+7>>3);B.l&511;)B.write_shift(-4,xe.ENDOFCHAIN);for(ee=z=0,ne=0;ne<C.FileIndex.length;++ne)oe=C.FileIndex[ne],oe.content&&(se=oe.content.length,!(!se||se>=4096)&&(oe.start=ee,me(se+63>>6)));for(;B.l&511;)B.write_shift(-4,xe.ENDOFCHAIN);for(z=0;z<D[4]<<2;++z){var ke=C.FullPaths[z];if(!ke||ke.length===0){for(ne=0;ne<17;++ne)B.write_shift(4,0);for(ne=0;ne<3;++ne)B.write_shift(4,-1);for(ne=0;ne<12;++ne)B.write_shift(4,0);continue}oe=C.FileIndex[z],z===0&&(oe.start=oe.size?oe.start-1:de);var be=z===0&&F.root||oe.name;if(se=2*(be.length+1),B.write_shift(64,be,"utf16le"),B.write_shift(2,se),B.write_shift(1,oe.type),B.write_shift(1,oe.color),B.write_shift(-4,oe.L),B.write_shift(-4,oe.R),B.write_shift(-4,oe.C),oe.clsid)B.write_shift(16,oe.clsid,"hex");else for(ne=0;ne<4;++ne)B.write_shift(4,0);B.write_shift(4,oe.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,oe.start),B.write_shift(4,oe.size),B.write_shift(4,0)}for(z=1;z<C.FileIndex.length;++z)if(oe=C.FileIndex[z],oe.size>=4096)if(B.l=oe.start+1<<9,xt&&Buffer.isBuffer(oe.content))oe.content.copy(B,B.l,0,oe.size),B.l+=oe.size+511&-512;else{for(ne=0;ne<oe.size;++ne)B.write_shift(1,oe.content[ne]);for(;ne&511;++ne)B.write_shift(1,0)}for(z=1;z<C.FileIndex.length;++z)if(oe=C.FileIndex[z],oe.size>0&&oe.size<4096)if(xt&&Buffer.isBuffer(oe.content))oe.content.copy(B,B.l,0,oe.size),B.l+=oe.size+63&-64;else{for(ne=0;ne<oe.size;++ne)B.write_shift(1,oe.content[ne]);for(;ne&63;++ne)B.write_shift(1,0)}if(xt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function V(C,R){var F=C.FullPaths.map(function(ne){return ne.toUpperCase()}),D=F.map(function(ne){var se=ne.split("/");return se[se.length-(ne.slice(-1)=="/"?2:1)]}),B=!1;R.charCodeAt(0)===47?(B=!0,R=F[0].slice(0,-1)+R):B=R.indexOf("/")!==-1;var z=R.toUpperCase(),ee=B===!0?F.indexOf(z):D.indexOf(z);if(ee!==-1)return C.FileIndex[ee];var me=!z.match(qo);for(z=z.replace(Zr,""),me&&(z=z.replace(qo,"!")),ee=0;ee<F.length;++ee)if((me?F[ee].replace(qo,"!"):F[ee]).replace(Zr,"")==z||(me?D[ee].replace(qo,"!"):D[ee]).replace(Zr,"")==z)return C.FileIndex[ee];return null}var G=64,de=-2,Se="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:de,FREESECT:-1,HEADER_SIGNATURE:Se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(C,R,F){f();var D=K(C,F);u.writeFileSync(R,D)}function q(C){for(var R=new Array(C.length),F=0;F<C.length;++F)R[F]=String.fromCharCode(C[F]);return R.join("")}function ae(C,R){var F=K(C,R);switch(R&&R.type||"buffer"){case"file":return f(),u.writeFileSync(R.filename,F),F;case"binary":return typeof F=="string"?F:q(F);case"base64":return b1(typeof F=="string"?F:q(F));case"buffer":if(xt)return Buffer.isBuffer(F)?F:us(F);case"array":return typeof F=="string"?Zn(F):F}return F}var pe;function O(C){try{var R=C.InflateRaw,F=new R;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)pe=C;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function J(C,R){if(!pe)return Ke(C,R);var F=pe.InflateRaw,D=new F,B=D._processChunk(C.slice(C.l),D._finishFlushFlag);return C.l+=D.bytesRead,B}function X(C){return pe?pe.deflateRawSync(C):Xe(C)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(C){var R=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(R>>16|R>>8|R)&255}for(var Ae=typeof Uint8Array<"u",_e=Ae?new Uint8Array(256):[],ze=0;ze<256;++ze)_e[ze]=Le(ze);function H(C,R){var F=_e[C&255];return R<=8?F>>>8-R:(F=F<<8|_e[C>>8&255],R<=16?F>>>16-R:(F=F<<8|_e[C>>16&255],F>>>24-R))}function Ye(C,R){var F=R&7,D=R>>>3;return(C[D]|(F<=6?0:C[D+1]<<8))>>>F&3}function rt(C,R){var F=R&7,D=R>>>3;return(C[D]|(F<=5?0:C[D+1]<<8))>>>F&7}function et(C,R){var F=R&7,D=R>>>3;return(C[D]|(F<=4?0:C[D+1]<<8))>>>F&15}function Ge(C,R){var F=R&7,D=R>>>3;return(C[D]|(F<=3?0:C[D+1]<<8))>>>F&31}function Ne(C,R){var F=R&7,D=R>>>3;return(C[D]|(F<=1?0:C[D+1]<<8))>>>F&127}function le(C,R,F){var D=R&7,B=R>>>3,z=(1<<F)-1,ee=C[B]>>>D;return F<8-D||(ee|=C[B+1]<<8-D,F<16-D)||(ee|=C[B+2]<<16-D,F<24-D)||(ee|=C[B+3]<<24-D),ee&z}function Pe(C,R,F){var D=R&7,B=R>>>3;return D<=5?C[B]|=(F&7)<<D:(C[B]|=F<<D&255,C[B+1]=(F&7)>>8-D),R+3}function Fe(C,R,F){var D=R&7,B=R>>>3;return F=(F&1)<<D,C[B]|=F,R+1}function Ue(C,R,F){var D=R&7,B=R>>>3;return F<<=D,C[B]|=F&255,F>>>=8,C[B+1]=F,R+8}function nt(C,R,F){var D=R&7,B=R>>>3;return F<<=D,C[B]|=F&255,F>>>=8,C[B+1]=F&255,C[B+2]=F>>>8,R+16}function tt(C,R){var F=C.length,D=2*F>R?2*F:R+5,B=0;if(F>=R)return C;if(xt){var z=L1(D);if(C.copy)C.copy(z);else for(;B<C.length;++B)z[B]=C[B];return z}else if(Ae){var ee=new Uint8Array(D);if(ee.set)ee.set(C);else for(;B<F;++B)ee[B]=C[B];return ee}return C.length=D,C}function Ve(C){for(var R=new Array(C),F=0;F<C;++F)R[F]=0;return R}function Ot(C,R,F){var D=1,B=0,z=0,ee=0,me=0,ne=C.length,se=Ae?new Uint16Array(32):Ve(32);for(z=0;z<32;++z)se[z]=0;for(z=ne;z<F;++z)C[z]=0;ne=C.length;var oe=Ae?new Uint16Array(ne):Ve(ne);for(z=0;z<ne;++z)se[B=C[z]]++,D<B&&(D=B),oe[z]=0;for(se[0]=0,z=1;z<=D;++z)se[z+16]=me=me+se[z-1]<<1;for(z=0;z<ne;++z)me=C[z],me!=0&&(oe[z]=se[me+16]++);var ke=0;for(z=0;z<ne;++z)if(ke=C[z],ke!=0)for(me=H(oe[z],D)>>D-ke,ee=(1<<D+4-ke)-1;ee>=0;--ee)R[me|ee<<ke]=ke&15|z<<4;return D}var bt=Ae?new Uint16Array(512):Ve(512),sr=Ae?new Uint16Array(32):Ve(32);if(!Ae){for(var Ct=0;Ct<512;++Ct)bt[Ct]=0;for(Ct=0;Ct<32;++Ct)sr[Ct]=0}(function(){for(var C=[],R=0;R<32;R++)C.push(5);Ot(C,sr,32);var F=[];for(R=0;R<=143;R++)F.push(8);for(;R<=255;R++)F.push(9);for(;R<=279;R++)F.push(7);for(;R<=287;R++)F.push(8);Ot(F,bt,288)})();var $t=function(){for(var R=Ae?new Uint8Array(32768):[],F=0,D=0;F<we.length-1;++F)for(;D<we[F+1];++D)R[D]=F;for(;D<32768;++D)R[D]=29;var B=Ae?new Uint8Array(259):[];for(F=0,D=0;F<ie.length-1;++F)for(;D<ie[F+1];++D)B[D]=F;function z(me,ne){for(var se=0;se<me.length;){var oe=Math.min(65535,me.length-se),ke=se+oe==me.length;for(ne.write_shift(1,+ke),ne.write_shift(2,oe),ne.write_shift(2,~oe&65535);oe-- >0;)ne[ne.l++]=me[se++]}return ne.l}function ee(me,ne){for(var se=0,oe=0,ke=Ae?new Uint16Array(32768):[];oe<me.length;){var be=Math.min(65535,me.length-oe);if(be<10){for(se=Pe(ne,se,+(oe+be==me.length)),se&7&&(se+=8-(se&7)),ne.l=se/8|0,ne.write_shift(2,be),ne.write_shift(2,~be&65535);be-- >0;)ne[ne.l++]=me[oe++];se=ne.l*8;continue}se=Pe(ne,se,+(oe+be==me.length)+2);for(var Ie=0;be-- >0;){var Ce=me[oe];Ie=(Ie<<5^Ce)&32767;var Re=-1,qe=0;if((Re=ke[Ie])&&(Re|=oe&-32768,Re>oe&&(Re-=32768),Re<oe))for(;me[Re+qe]==me[oe+qe]&&qe<250;)++qe;if(qe>2){Ce=B[qe],Ce<=22?se=Ue(ne,se,_e[Ce+1]>>1)-1:(Ue(ne,se,3),se+=5,Ue(ne,se,_e[Ce-23]>>5),se+=3);var Rt=Ce<8?0:Ce-4>>2;Rt>0&&(nt(ne,se,qe-ie[Ce]),se+=Rt),Ce=R[oe-Re],se=Ue(ne,se,_e[Ce]>>3),se-=3;var Mt=Ce<4?0:Ce-2>>1;Mt>0&&(nt(ne,se,oe-Re-we[Ce]),se+=Mt);for(var hr=0;hr<qe;++hr)ke[Ie]=oe&32767,Ie=(Ie<<5^me[oe])&32767,++oe;be-=qe-1}else Ce<=143?Ce=Ce+48:se=Fe(ne,se,1),se=Ue(ne,se,_e[Ce]),ke[Ie]=oe&32767,++oe}se=Ue(ne,se,0)-1}return ne.l=(se+7)/8|0,ne.l}return function(ne,se){return ne.length<8?z(ne,se):ee(ne,se)}}();function Xe(C){var R=lr(50+Math.floor(C.length*1.1)),F=$t(C,R);return R.slice(0,F)}var fe=Ae?new Uint16Array(32768):Ve(32768),ge=Ae?new Uint16Array(32768):Ve(32768),Ee=Ae?new Uint16Array(128):Ve(128),Oe=1,He=1;function Tt(C,R){var F=Ge(C,R)+257;R+=5;var D=Ge(C,R)+1;R+=5;var B=et(C,R)+4;R+=4;for(var z=0,ee=Ae?new Uint8Array(19):Ve(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,se=Ae?new Uint8Array(8):Ve(8),oe=Ae?new Uint8Array(8):Ve(8),ke=ee.length,be=0;be<B;++be)ee[W[be]]=z=rt(C,R),ne<z&&(ne=z),se[z]++,R+=3;var Ie=0;for(se[0]=0,be=1;be<=ne;++be)oe[be]=Ie=Ie+se[be-1]<<1;for(be=0;be<ke;++be)(Ie=ee[be])!=0&&(me[be]=oe[Ie]++);var Ce=0;for(be=0;be<ke;++be)if(Ce=ee[be],Ce!=0){Ie=_e[me[be]]>>8-Ce;for(var Re=(1<<7-Ce)-1;Re>=0;--Re)Ee[Ie|Re<<Ce]=Ce&7|be<<3}var qe=[];for(ne=1;qe.length<F+D;)switch(Ie=Ee[Ne(C,R)],R+=Ie&7,Ie>>>=3){case 16:for(z=3+Ye(C,R),R+=2,Ie=qe[qe.length-1];z-- >0;)qe.push(Ie);break;case 17:for(z=3+rt(C,R),R+=3;z-- >0;)qe.push(0);break;case 18:for(z=11+Ne(C,R),R+=7;z-- >0;)qe.push(0);break;default:qe.push(Ie),ne<Ie&&(ne=Ie);break}var Rt=qe.slice(0,F),Mt=qe.slice(F);for(be=F;be<286;++be)Rt[be]=0;for(be=D;be<30;++be)Mt[be]=0;return Oe=Ot(Rt,fe,286),He=Ot(Mt,ge,30),R}function ct(C,R){if(C[0]==3&&!(C[1]&3))return[Ta(R),2];for(var F=0,D=0,B=L1(R||1<<18),z=0,ee=B.length>>>0,me=0,ne=0;!(D&1);){if(D=rt(C,F),F+=3,D>>>1)D>>1==1?(me=9,ne=5):(F=Tt(C,F),me=Oe,ne=He);else{F&7&&(F+=8-(F&7));var se=C[F>>>3]|C[(F>>>3)+1]<<8;if(F+=32,se>0)for(!R&&ee<z+se&&(B=tt(B,z+se),ee=B.length);se-- >0;)B[z++]=C[F>>>3],F+=8;continue}for(;;){!R&&ee<z+32767&&(B=tt(B,z+32767),ee=B.length);var oe=le(C,F,me),ke=D>>>1==1?bt[oe]:fe[oe];if(F+=ke&15,ke>>>=4,!(ke>>>8&255))B[z++]=ke;else{if(ke==256)break;ke-=257;var be=ke<8?0:ke-4>>2;be>5&&(be=0);var Ie=z+ie[ke];be>0&&(Ie+=le(C,F,be),F+=be),oe=le(C,F,ne),ke=D>>>1==1?sr[oe]:ge[oe],F+=ke&15,ke>>>=4;var Ce=ke<4?0:ke-2>>1,Re=we[ke];for(Ce>0&&(Re+=le(C,F,Ce),F+=Ce),!R&&ee<Ie&&(B=tt(B,Ie+100),ee=B.length);z<Ie;)B[z]=B[z-Re],++z}}}return R?[B,F+7>>>3]:[B.slice(0,z),F+7>>>3]}function Ke(C,R){var F=C.slice(C.l||0),D=ct(F,R);return C.l+=D[1],D[0]}function Je(C,R){if(C)typeof console<"u"&&console.error(R);else throw new Error(R)}function ut(C,R){var F=C;wr(F,0);var D=[],B=[],z={FileIndex:D,FullPaths:B};b(z,{root:R.root});for(var ee=F.length-4;(F[ee]!=80||F[ee+1]!=75||F[ee+2]!=5||F[ee+3]!=6)&&ee>=0;)--ee;F.l=ee+4,F.l+=4;var me=F.read_shift(2);F.l+=6;var ne=F.read_shift(4);for(F.l=ne,ee=0;ee<me;++ee){F.l+=20;var se=F.read_shift(4),oe=F.read_shift(4),ke=F.read_shift(2),be=F.read_shift(2),Ie=F.read_shift(2);F.l+=8;var Ce=F.read_shift(4),Re=l(F.slice(F.l+ke,F.l+ke+be));F.l+=ke+be+Ie;var qe=F.l;F.l=Ce+4,pt(F,se,oe,z,Re),F.l=qe}return z}function pt(C,R,F,D,B){C.l+=2;var z=C.read_shift(2),ee=C.read_shift(2),me=o(C);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var ne=C.read_shift(4),se=C.read_shift(4),oe=C.read_shift(4),ke=C.read_shift(2),be=C.read_shift(2),Ie="",Ce=0;Ce<ke;++Ce)Ie+=String.fromCharCode(C[C.l++]);if(be){var Re=l(C.slice(C.l,C.l+be));(Re[21589]||{}).mt&&(me=Re[21589].mt),((B||{})[21589]||{}).mt&&(me=B[21589].mt)}C.l+=be;var qe=C.slice(C.l,C.l+se);switch(ee){case 8:qe=J(C,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var Rt=!1;z&8&&(ne=C.read_shift(4),ne==134695760&&(ne=C.read_shift(4),Rt=!0),se=C.read_shift(4),oe=C.read_shift(4)),se!=R&&Je(Rt,"Bad compressed size: "+R+" != "+se),oe!=F&&Je(Rt,"Bad uncompressed size: "+F+" != "+oe),Qt(D,Ie,qe,{unsafe:!0,mt:me})}function or(C,R){var F=R||{},D=[],B=[],z=lr(1),ee=F.compression?8:0,me=0,ne=0,se=0,oe=0,ke=0,be=C.FullPaths[0],Ie=be,Ce=C.FileIndex[0],Re=[],qe=0;for(ne=1;ne<C.FullPaths.length;++ne)if(Ie=C.FullPaths[ne].slice(be.length),Ce=C.FileIndex[ne],!(!Ce.size||!Ce.content||Ie=="Sh33tJ5")){var Rt=oe,Mt=lr(Ie.length);for(se=0;se<Ie.length;++se)Mt.write_shift(1,Ie.charCodeAt(se)&127);Mt=Mt.slice(0,Mt.l),Re[ke]=LA.buf(Ce.content,0);var hr=Ce.content;ee==8&&(hr=X(hr)),z=lr(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,me),z.write_shift(2,ee),Ce.mt?a(z,Ce.mt):z.write_shift(4,0),z.write_shift(-4,Re[ke]),z.write_shift(4,hr.length),z.write_shift(4,Ce.content.length),z.write_shift(2,Mt.length),z.write_shift(2,0),oe+=z.length,D.push(z),oe+=Mt.length,D.push(Mt),oe+=hr.length,D.push(hr),z=lr(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,me),z.write_shift(2,ee),z.write_shift(4,0),z.write_shift(-4,Re[ke]),z.write_shift(4,hr.length),z.write_shift(4,Ce.content.length),z.write_shift(2,Mt.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Rt),qe+=z.l,B.push(z),qe+=Mt.length,B.push(Mt),++ke}return z=lr(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,ke),z.write_shift(2,ke),z.write_shift(4,qe),z.write_shift(4,oe),z.write_shift(2,0),aa([aa(D),aa(B),z])}var At={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lt(C,R){if(C.ctype)return C.ctype;var F=C.name||"",D=F.match(/\.([^\.]+)$/);return D&&At[D[1]]||R&&(D=(F=R).match(/[\.\\]([^\.\\])+$/),D&&At[D[1]])?At[D[1]]:"application/octet-stream"}function Q(C){for(var R=b1(C),F=[],D=0;D<R.length;D+=76)F.push(R.slice(D,D+76));return F.join(`\r
`)+`\r
`}function ve(C){var R=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var oe=se.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],D=R.split(`\r
`),B=0;B<D.length;++B){var z=D[B];if(z.length==0){F.push("");continue}for(var ee=0;ee<z.length;){var me=76,ne=z.slice(ee,ee+me);ne.charAt(me-1)=="="?me--:ne.charAt(me-2)=="="?me-=2:ne.charAt(me-3)=="="&&(me-=3),ne=z.slice(ee,ee+me),ee+=me,ee<z.length&&(ne+="="),F.push(ne)}}return F.join(`\r
`)}function Be(C){for(var R=[],F=0;F<C.length;++F){for(var D=C[F];F<=C.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+C[++F];R.push(D)}for(var B=0;B<R.length;++B)R[B]=R[B].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Zn(R.join(`\r
`))}function ft(C,R,F){for(var D="",B="",z="",ee,me=0;me<10;++me){var ne=R[me];if(!ne||ne.match(/^\s*$/))break;var se=ne.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":D=se[2].trim();break;case"content-type":z=se[2].trim();break;case"content-transfer-encoding":B=se[2].trim();break}}switch(++me,B.toLowerCase()){case"base64":ee=Zn(mn(R.slice(me).join("")));break;case"quoted-printable":ee=Be(R.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var oe=Qt(C,D.slice(F.length),ee,{unsafe:!0});z&&(oe.ctype=z)}function gt(C,R){if(q(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=R&&R.root||"",D=(xt&&Buffer.isBuffer(C)?C.toString("binary"):q(C)).split(`\r
`),B=0,z="";for(B=0;B<D.length;++B)if(z=D[B],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),F||(F=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),z.slice(0,F.length)!=F););var ee=(D[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var me="--"+(ee[1]||""),ne=[],se=[],oe={FileIndex:ne,FullPaths:se};b(oe);var ke,be=0;for(B=0;B<D.length;++B){var Ie=D[B];Ie!==me&&Ie!==me+"--"||(be++&&ft(oe,D.slice(ke,B),F),ke=B)}return oe}function St(C,R){var F=R||{},D=F.boundary||"SheetJS";D="------="+D;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],z=C.FullPaths[0],ee=z,me=C.FileIndex[0],ne=1;ne<C.FullPaths.length;++ne)if(ee=C.FullPaths[ne].slice(z.length),me=C.FileIndex[ne],!(!me.size||!me.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var se=me.content,oe=xt&&Buffer.isBuffer(se)?se.toString("binary"):q(se),ke=0,be=Math.min(1024,oe.length),Ie=0,Ce=0;Ce<=be;++Ce)(Ie=oe.charCodeAt(Ce))>=32&&Ie<128&&++ke;var Re=ke>=be*4/5;B.push(D),B.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+ee),B.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),B.push("Content-Type: "+lt(me,ee)),B.push(""),B.push(Re?ve(oe):Q(oe))}return B.push(D+`--\r
`),B.join(`\r
`)}function Zt(C){var R={};return b(R,C),R}function Qt(C,R,F,D){var B=D&&D.unsafe;B||b(C);var z=!B&&_t.find(C,R);if(!z){var ee=C.FullPaths[0];R.slice(0,ee.length)==ee?ee=R:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+R).replace("//","/")),z={name:i(R),type:2},C.FileIndex.push(z),C.FullPaths.push(ee),B||_t.utils.cfb_gc(C)}return z.content=F,z.size=F?F.length:0,D&&(D.CLSID&&(z.clsid=D.CLSID),D.mt&&(z.mt=D.mt),D.ct&&(z.ct=D.ct)),z}function ni(C,R){b(C);var F=_t.find(C,R);if(F){for(var D=0;D<C.FileIndex.length;++D)if(C.FileIndex[D]==F)return C.FileIndex.splice(D,1),C.FullPaths.splice(D,1),!0}return!1}function Cr(C,R,F){b(C);var D=_t.find(C,R);if(D){for(var B=0;B<C.FileIndex.length;++B)if(C.FileIndex[B]==D)return C.FileIndex[B].name=i(F),C.FullPaths[B]=F,!0}return!1}function De(C){j(C,!0)}return t.find=V,t.read=M,t.parse=d,t.write=ae,t.writeFile=re,t.utils={cfb_new:Zt,cfb_add:Qt,cfb_del:ni,cfb_mov:Cr,cfb_gc:De,ReadShift:cl,CheckField:R2,prep_blob:wr,bconcat:aa,use_zlib:O,_deflateRaw:Xe,_inflateRaw:Ke,consts:xe},t}();function PA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function vi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function bp(e){for(var t=[],r=vi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Qu=new Date(1899,11,30,0,0,0);function Gr(e,t){var r=e.getTime(),n=Qu.getTime()+(e.getTimezoneOffset()-Qu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var h2=new Date,FA=Qu.getTime()+(h2.getTimezoneOffset()-Qu.getTimezoneOffset())*6e4,j1=h2.getTimezoneOffset();function Mf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+FA),t.getTimezoneOffset()!==j1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-j1)*6e4),t}function OA(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var B1=new Date("2017-02-19T19:06:09.000Z"),p2=isNaN(B1.getFullYear())?new Date("2/19/17"):B1,RA=p2.getFullYear()==2017;function vr(e,t){var r=new Date(e);if(RA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(p2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function as(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Jo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Jo(e2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Jo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Jo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Er(e[r]));return t}function Xt(e,t){for(var r="";r.length<t;)r+=e;return r}function Jn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var MA=["january","february","march","april","may","june","july","august","september","october","november","december"];function co(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&MA.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var IA=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(i),o.push(a[l]);return o}}();function m2(e){return e?e.content&&e.type?as(e.content,!0):e.data?Ko(e.data):e.asNodeBuffer&&xt?Ko(e.asNodeBuffer().toString("binary")):e.asBinary?Ko(e.asBinary()):e._data&&e._data.getContent?Ko(as(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function g2(e){if(!e)return null;if(e.data)return A1(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?A1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function DA(e){return e&&e.name.slice(-4)===".bin"?g2(e):m2(e)}function Sn(e,t){for(var r=e.FullPaths||vi(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Lp(e,t){var r=Sn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function nr(e,t,r){if(!r)return DA(Lp(e,t));if(!t)return null;try{return nr(e,t)}catch{return null}}function un(e,t,r){if(!r)return m2(Lp(e,t));if(!t)return null;try{return un(e,t)}catch{return null}}function jA(e,t,r){return g2(Lp(e,t))}function z1(e){for(var t=e.FullPaths||vi(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function BA(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return xt?n=us(r):n=iA(r),_t.utils.cfb_add(e,t,n)}_t.utils.cfb_add(e,t,r)}else e.file(t,r)}function x2(e,t){switch(t.type){case"base64":return _t.read(e,{type:"base64"});case"binary":return _t.read(e,{type:"binary"});case"buffer":case"array":return _t.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Yo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var v2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,zA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,U1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,UA=/<[^>]*>/g,jr=v2.match(U1)?U1:UA,HA=/<\w*:/,VA=/<(\/?)\w+:/;function Ze(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(zA),l=0,u="",f=0,d="",m="",g=1;if(o)for(f=0;f!=o.length;++f){for(m=o[f],a=0;a!=m.length&&m.charCodeAt(a)!==61;++a);for(d=m.slice(0,a).trim();m.charCodeAt(a+1)==32;)++a;for(g=(i=m.charCodeAt(a+1))==34||i==39?1:0,u=m.slice(a+1+g,m.length-g),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var _=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[_]&&d.slice(l-3,l)=="ext")continue;n[_]=u,n[_.toLowerCase()]=u}}return n}function _i(e){return e.replace(VA,"<$1")}var _2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},WA=bp(_2),Et=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(l,u){return _2[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),$A=/[&<>'"]/g,ZA=/[\u0000-\u001f]/g;function Pp(e){var t=e+"";return t.replace($A,function(r){return WA[r]}).replace(/\n/g,"<br/>").replace(ZA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var H1=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function jt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function W0(e){for(var t="",r=0,n=0,i=0,a=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function V1(e){var t=Ta(2*e.length),r,n,i=1,a=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function W1(e){return us(e,"binary").toString("utf8")}var Gc="foo bar baz",Ft=xt&&(W1(Gc)==W0(Gc)&&W1||V1(Gc)==W0(Gc)&&V1)||W0,Jo=xt?function(e){return us(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},jl=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),y2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),GA=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),XA=/<\/?(?:vt:)?variant>/g,KA=/<(?:vt:)([^>]*)>([\s\S]*)</;function $1(e,t){var r=Ze(e),n=e.match(GA(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(XA,"").match(KA);o&&i.push({v:Ft(o[2]),t:o[1]})}),i}var qA=/(^\s|\s$|\n)/;function YA(e){return vi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function JA(e,t,r){return"<"+e+(r!=null?YA(r):"")+(t!=null?(t.match(qA)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Fp(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ft(fs(Cp(e)));throw new Error("Bad input format: expected Buffer or string")}var Bl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,QA={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},eN=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function tN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function rN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=n?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Z1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},G1=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:us(t)})):Z1(e)}:Z1,X1=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Ri(e,i)));return n.join("").replace(Zr,"")},Op=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zr,""):X1(e,t,r)}:X1,K1=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},w2=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):K1(e,t,r)}:K1,q1=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(As(e,i)));return n.join("")},nc=xt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):q1(t,r,n)}:q1,k2=function(e,t){var r=cn(e,t);return r>0?nc(e,t+4,t+4+r-1):""},E2=k2,T2=function(e,t){var r=cn(e,t);return r>0?nc(e,t+4,t+4+r-1):""},S2=T2,C2=function(e,t){var r=2*cn(e,t);return r>0?nc(e,t+4,t+4+r-1):""},A2=C2,N2=function(t,r){var n=cn(t,r);return n>0?Op(t,r+4,r+4+n):""},b2=N2,L2=function(e,t){var r=cn(e,t);return r>0?nc(e,t+4,t+4+r):""},P2=L2,F2=function(e,t){return tN(e,t)},ef=F2,O2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(E2=function(t,r){if(!Buffer.isBuffer(t))return k2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},S2=function(t,r){if(!Buffer.isBuffer(t))return T2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},A2=function(t,r){if(!Buffer.isBuffer(t))return C2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},b2=function(t,r){if(!Buffer.isBuffer(t))return N2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},P2=function(t,r){if(!Buffer.isBuffer(t))return L2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ef=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):F2(t,r)},O2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var As=function(e,t){return e[t]},Ri=function(e,t){return e[t+1]*256+e[t]},nN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},cn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ja=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},iN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function cl(e,t){var r="",n,i,a=[],o,l,u,f;switch(t){case"dbcs":if(f=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Ri(this,f)),f+=2;e*=2;break;case"utf8":r=nc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Op(this,this.l,this.l+e);break;case"wstr":return cl.call(this,e,"dbcs");case"lpstr-ansi":r=E2(this,this.l),e=4+cn(this,this.l);break;case"lpstr-cp":r=S2(this,this.l),e=4+cn(this,this.l);break;case"lpwstr":r=A2(this,this.l),e=4+2*cn(this,this.l);break;case"lpp4":e=4+cn(this,this.l),r=b2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+cn(this,this.l),r=P2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=As(this,this.l+e++))!==0;)a.push(Zc(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=Ri(this,this.l+e))!==0;)a.push(Zc(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=As(this,f),this.l=f+1,l=cl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Zc(Ri(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=As(this,f),this.l=f+1,l=cl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Zc(As(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=As(this,this.l),this.l++,n;case 2:return n=(t==="i"?nN:Ri)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ja:iN)(this,this.l),this.l+=4,n):(i=cn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=ef(this,this.l):i=ef([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=w2(this,this.l,e);break}}return this.l+=e,r}var aN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},sN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},oN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function lN(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)oN(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,aN(this,t,this.l);break;case 8:if(n=8,r==="f"){rN(this,t,this.l);break}case 16:break;case-4:n=4,sN(this,t,this.l);break}return this.l+=n,this}function R2(e,t){var r=w2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=cl,e.chk=R2,e.write_shift=lN}function Dr(e,t){e.l+=t}function lr(e){var t=Ta(e);return wr(t,0),t}function Xi(e,t,r){if(e){var n,i,a;wr(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var f=of[l]||of[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;u=e.l+a;var d=f.f&&f.f(e,a,r);if(e.l=u,t(d,f,l))return}}}function nh(){var e=[],t=xt?256:2048,r=function(f){var d=lr(f);return wr(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,t)))},o=function(){return i(),aa(e)},l=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function ul(e,t,r){var n=Er(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Y1(e,t,r){var n=Er(e);return n.s=ul(n.s,t.s,r),n.e=ul(n.e,t.s,r),n}function fl(e,t){if(e.cRel&&e.c<0)for(e=Er(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Er(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Qe(e);return!e.cRel&&e.cRel!=null&&(r=fN(r)),!e.rRel&&e.rRel!=null&&(r=cN(r)),r}function $0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fr(e.s.c)+":"+(e.e.cRel?"":"$")+fr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Tr(e.s.r)+":"+(e.e.rRel?"":"$")+Tr(e.e.r):fl(e.s,t.biff)+":"+fl(e.e,t.biff)}function Rp(e){return parseInt(uN(e),10)-1}function Tr(e){return""+(e+1)}function cN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uN(e){return e.replace(/\$(\d+)$/,"$1")}function Mp(e){for(var t=dN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function fr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fN(e){return e.replace(/^([A-Z])/,"$$$1")}function dN(e){return e.replace(/^\$([A-Z])/,"$1")}function hN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Qe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yo(e){var t=e.indexOf(":");return t==-1?{s:Wr(e),e:Wr(e)}:{s:Wr(e.slice(0,t)),e:Wr(e.slice(t+1))}}function yt(e,t){return typeof t>"u"||typeof t=="number"?yt(e.s,e.e):(typeof e!="string"&&(e=Qe(e)),typeof t!="string"&&(t=Qe(t)),e==t?e:e+":"+t)}function Kt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function J1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Mn(e.z,r?Gr(t):t)}catch{}try{return e.w=Mn((e.XF||{}).numFmtId||(r?14:0),r?Gr(t):t)}catch{return""+t}}function Wi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ps[e.v]||e.v:t==null?J1(e,e.v):J1(e,t))}function ba(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function M2(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Wr(n.origin):n.origin;o=u.r,l=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=Kt(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),o==-1&&(f.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var _={v:t[m][g]},y=o+m,v=l+g;if(f.s.r>y&&(f.s.r=y),f.s.c>v&&(f.s.c=v),f.e.r<y&&(f.e.r=y),f.e.c<v&&(f.e.c=v),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))_=t[m][g];else if(Array.isArray(_.v)&&(_.f=t[m][g][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||st[14],n.cellDates?(_.t="d",_.w=Mn(_.z,Gr(_.v))):(_.t="n",_.v=Gr(_.v),_.w=Mn(_.z,_.v))):_.t="s";if(i)a[y]||(a[y]=[]),a[y][v]&&a[y][v].z&&(_.z=a[y][v].z),a[y][v]=_;else{var T=Qe({c:v,r:y});a[T]&&a[T].z&&(_.z=a[T].z),a[T]=_}}}return f.s.c<1e7&&(a["!ref"]=yt(f)),a}function wo(e,t){return M2(null,e,t)}function pN(e){return e.read_shift(4,"i")}function Mr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function mN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ip(e,t){var r=e.l,n=e.read_shift(1),i=Mr(e),a=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)a.push(mN(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var gN=Ip;function In(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ds(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var xN=Mr;function Dp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var vN=Mr,ih=Dp;function jp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?ef([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ja(t,0)>>2;return r?i/100:i}function I2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var hs=I2;function Or(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _N(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var f=Ka[i];f&&(t.rgb=Ul(f));break;case 2:t.rgb=Ul([o,l,u]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function yN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function D2(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function wN(e){return D2(e,1)}function kN(e){return D2(e,2)}var Bp=2,Yr=3,Xc=11,Q1=12,tf=19,Kc=64,EN=65,TN=71,SN=4108,CN=4126,mr=80,j2=81,AN=[mr,j2],NN={1:{n:"CodePage",t:Bp},2:{n:"Category",t:mr},3:{n:"PresentationFormat",t:mr},4:{n:"ByteCount",t:Yr},5:{n:"LineCount",t:Yr},6:{n:"ParagraphCount",t:Yr},7:{n:"SlideCount",t:Yr},8:{n:"NoteCount",t:Yr},9:{n:"HiddenCount",t:Yr},10:{n:"MultimediaClipCount",t:Yr},11:{n:"ScaleCrop",t:Xc},12:{n:"HeadingPairs",t:SN},13:{n:"TitlesOfParts",t:CN},14:{n:"Manager",t:mr},15:{n:"Company",t:mr},16:{n:"LinksUpToDate",t:Xc},17:{n:"CharacterCount",t:Yr},19:{n:"SharedDoc",t:Xc},22:{n:"HyperlinksChanged",t:Xc},23:{n:"AppVersion",t:Yr,p:"version"},24:{n:"DigSig",t:EN},26:{n:"ContentType",t:mr},27:{n:"ContentStatus",t:mr},28:{n:"Language",t:mr},29:{n:"Version",t:mr},255:{},2147483648:{n:"Locale",t:tf},2147483651:{n:"Behavior",t:tf},1919054434:{}},bN={1:{n:"CodePage",t:Bp},2:{n:"Title",t:mr},3:{n:"Subject",t:mr},4:{n:"Author",t:mr},5:{n:"Keywords",t:mr},6:{n:"Comments",t:mr},7:{n:"Template",t:mr},8:{n:"LastAuthor",t:mr},9:{n:"RevNumber",t:mr},10:{n:"EditTime",t:Kc},11:{n:"LastPrinted",t:Kc},12:{n:"CreatedDate",t:Kc},13:{n:"ModifiedDate",t:Kc},14:{n:"PageCount",t:Yr},15:{n:"WordCount",t:Yr},16:{n:"CharCount",t:Yr},17:{n:"Thumbnail",t:TN},18:{n:"Application",t:mr},19:{n:"DocSecurity",t:Yr},255:{},2147483648:{n:"Locale",t:tf},2147483651:{n:"Behavior",t:tf},1919054434:{}},ex={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},LN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function PN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var FN=PN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ka=Er(FN),ps={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function ON(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function RN(e){var t=ON();if(!e||!e.match)return t;var r={};if((e.match(jr)||[]).forEach(function(n){var i=Ze(n);switch(i[0].replace(HA,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[tx[i.ContentType]]!==void 0&&t[tx[i.ContentType]].push(i.PartName);break}}),t.xmlns!==QA.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Ws={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ah(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function dl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(jr)||[]).forEach(function(i){var a=Ze(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Yo(a.Target,t);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}var MN="application/vnd.oasis.opendocument.spreadsheet";function IN(e,t){for(var r=Fp(e),n,i;n=Bl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ze(n[0],!1),i.path=="/"&&i.type!==MN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var hl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],DN=function(){for(var e=new Array(hl.length),t=0;t<hl.length;++t){var r=hl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function z2(e){var t={};e=Ft(e);for(var r=0;r<hl.length;++r){var n=hl[r],i=e.match(DN[r]);i!=null&&i.length>0&&(t[n[1]]=Et(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=vr(t[n[1]]))}return t}var jN=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function U2(e,t,r,n){var i=[];if(typeof e=="string")i=$1(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var o=typeof t=="string"?$1(t,n).map(function(d){return d.v}):t,l=0,u=0;if(o.length>0)for(var f=0;f!==i.length;f+=2){switch(u=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function BN(e,t,r){var n={};return t||(t={}),e=Ft(e),jN.forEach(function(i){var a=(e.match(jl(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Et(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&U2(n.HeadingPairs,n.TitlesOfParts,t,r),t}var zN=/<[^>]+>[^<]*/g;function UN(e,t){var r={},n="",i=e.match(zN);if(i)for(var a=0;a!=i.length;++a){var o=i[a],l=Ze(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Et(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Et(d);break;case"bool":r[n]=jt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=vr(d);break;case"cy":case"error":r[n]=Et(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var HN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Z0;function VN(e,t,r){Z0||(Z0=bp(HN)),t=Z0[t]||t,e[t]=r}function zp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function H2(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function V2(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function W2(e,t,r){return t===31?V2(e):H2(e,t,r)}function sh(e,t,r){return W2(e,t,r===!1?0:4)}function WN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return W2(e,t,0)}function $N(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Zr,""),e.l-i&2&&(e.l+=2)}return r}function ZN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function GN(e){var t=e.l,r=rf(e,j2);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=rf(e,Yr);return[r,n]}function XN(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(GN(e));return r}function rx(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Zr,"").replace(qo,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function $2(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function KN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function rf(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==Q1&&n!==t&&AN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Q1?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return H2(e,n,4).replace(Zr,"");case 31:return V2(e);case 64:return zp(e);case 65:return $2(e);case 71:return KN(e);case 80:return sh(e,n,!a.raw).replace(Zr,"");case 81:return WN(e,n).replace(Zr,"");case 4108:return XN(e);case 4126:case 4127:return n==4127?$N(e):ZN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function nx(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,l=0,u=-1,f={};for(o=0;o!=i;++o){var d=e.read_shift(4),m=e.read_shift(4);a[o]=[d,m+r]}a.sort(function(E,w){return E[1]-w[1]});var g={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var _=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,_=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],_=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],_=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(_=!1,e.l=a[o][1]),_)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var y=t[a[o][0]];if(g[y.n]=rf(e,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Gn(l=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(a[o][0]===1){if(l=g.CodePage=rf(e,Bp),Gn(l),u!==-1){var v=e.l;e.l=a[u][1],f=rx(e,l),e.l=v}}else if(a[o][0]===0){if(l===0){u=o,e.l=a[o+1][1];continue}f=rx(e,l)}else{var T=f[a[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=$2(e);break;case 30:e.l+=4,k=sh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=sh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Yt(e,4);break;case 64:e.l+=4,k=vr(zp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[T]=k}}return e.l=r+n,g}function ix(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var i,a,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==_t.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=nx(n,t),g={SystemIdentifier:f};for(var _ in m)g[_]=m[_];if(g.FMTID=a,i===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var y;try{y=nx(n,null)}catch{}for(_ in y)g[_]=y[_];return g.FMTID=[a,o],g}function Qi(e,t){return e.read_shift(t),null}function qN(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Yt(e,t){return e.read_shift(t)===1}function ir(e){return e.read_shift(2,"u")}function Z2(e,t){return qN(e,t,ir)}function YN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ic(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function JN(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,l,u={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*o),n&&(e.l+=l),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function ss(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ac(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ss(e,n,r)}function ms(e,t,r){if(r.biff>5)return ac(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function QN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function eb(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Zr,"");return n&&(e.l+=24),i}function tb(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(Zr,"");return r+o}function rb(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return eb(e);case"0303000000000000c000000000000046":return tb(e);default:throw new Error("Unsupported Moniker "+r)}}function qc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zr,""):"";return r}function nb(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,l,u,f="",d,m;i&16&&(a=qc(e,r-e.l)),i&128&&(o=qc(e,r-e.l)),(i&257)===257&&(l=qc(e,r-e.l)),(i&257)===1&&(u=rb(e,r-e.l)),i&8&&(f=qc(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(m=zp(e)),e.l=r;var g=o||l||u||"";g&&f&&(g+="#"+f),g||(g="#"+f),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var _={Target:g};return d&&(_.guid=d),m&&(_.time=m),a&&(_.Tooltip=a),_}function G2(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function X2(e,t){var r=G2(e);return r[3]=0,r}function yi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ib(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ab(e,t,r){return t===0?"":ms(e,t,r)}function sb(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function K2(e){var t=e.read_shift(2),r=jp(e);return[t,r]}function ob(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=ic(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function If(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function q2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var lb=q2;function Y2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function cb(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ub(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function br(e){e.l+=2,e.l+=e.read_shift(2)}var fb={0:br,4:br,5:br,6:br,7:ub,8:br,9:br,10:br,11:br,12:br,13:cb,14:br,15:br,16:br,17:br,18:br,19:br,20:br,21:Y2};function db(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(fb[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Yc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function hb(e,t){return t===0||e.read_shift(2),1200}function pb(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=ms(e,0,r);return e.read_shift(t+n-e.l),i}function mb(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gb(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=ic(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function xb(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<r;++o)a.push(JN(e));return a.Count=n,a.Unique=i,a}function vb(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function _b(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function yb(e){var t=ib(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function wb(e){return e.read_shift(2),e.read_shift(4)}function ax(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function kb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:l,Selected:u,TabRatio:f}}function Eb(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Tb(){}function Sb(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ic(e,0,r),n}function Cb(e){var t=yi(e);return t.isst=e.read_shift(4),t}function Ab(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=yi(e);r.biff==2&&e.l++;var a=ac(e,n-e.l,r);return i.val=a,i}function Nb(e,t,r){var n=e.read_shift(2),i=ms(e,0,r);return[n,i]}var bb=ms;function sx(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:a,c:l},e:{r:o,c:u}}}function Lb(e){var t=e.read_shift(2),r=e.read_shift(2),n=K2(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Pb(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(K2(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function Fb(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function Ob(e,t,r,n){var i={},a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return i.patternType=LN[l>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function Rb(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Ob(e,t,n.fStyle,r),n}function Mb(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ox(e,t,r){var n=yi(e);(r.biff==2||t==9)&&++e.l;var i=YN(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function Ib(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=yi(e),i=Or(e);return n.val=i,n}var lx=ab;function Db(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=ss(e,a),l=[];n>e.l;)l.push(ac(e));return[a,i,o,l]}function cx(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=ob(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var jb=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ux(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=ss(e,o,r);i&32&&(f=jb[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var m=n==e.l||l===0||!(d>0)?[]:_6(e,d,r,l);return{chKey:a,Name:f,itab:u,rgce:m}}function J2(e,t,r){if(r.biff<8)return Bb(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(sb(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Bb(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ic(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function zb(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=ss(e,n,r),o=ss(e,i,r);return[a,o]}function Ub(e,t,r){var n=q2(e);e.l++;var i=e.read_shift(1);return t-=8,[y6(e,t,r),i,n]}function fx(e,t,r){var n=lb(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,x6(e,t,r)]}function Hb(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Vb(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=ms(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,a]}}function Wb(e,t,r){return Vb(e,t,r)}function $b(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(If(e));return r}function Zb(e,t,r){if(r&&r.biff<8)return Xb(e,t,r);var n=Y2(e),i=db(e,t-22,n[1]);return{cmo:n,ft:i}}var Gb={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Xb(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Gb[n]||Dr)(e,t,r)),{cmo:[i,n,a],ft:o}}function Kb(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=QN(e,6,r);var l=e.read_shift(2);e.read_shift(2),ir(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],m=ss(e,e.lens[f+1]-e.lens[f]-1);if(i+=m,i.length>=(d?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function qb(e,t){var r=If(e);e.l+=16;var n=nb(e,t-24);return[r,n]}function Yb(e,t){e.read_shift(2);var r=If(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Zr,""),[r,n]}function Jb(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ex[r]||r,r=e.read_shift(2),t[1]=ex[r]||r,t}function Qb(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X2(e));return r}function eL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X2(e));return r}function tL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Q2(e,t,r){if(!r.cellStyles)return Dr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:i,e:a,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function rL(e,t){var r={};return t<32||(e.l+=16,r.header=Or(e),r.footer=Or(e),e.l+=2),r}function nL(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var iL=yi,aL=Z2,sL=ac;function oL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function lL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=yi(e);++e.l;var i=ms(e,t-7,r);return n.t="str",n.val=i,n}function cL(e){var t=yi(e);++e.l;var r=Or(e);return t.t="n",t.val=r,t}function uL(e){var t=yi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function fL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function dL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function hL(e,t,r){var n=e.l+t,i=yi(e),a=e.read_shift(2),o=ss(e,a,r);return e.l=n,i.t="str",i.val=o,i}var pL=[2,3,48,49,131,139,140,245],dx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=bp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var f=[],d=Ta(1);switch(u.type){case"base64":d=Zn(mn(l));break;case"binary":d=Zn(l);break;case"buffer":case"array":d=l;break}wr(d,0);var m=d.read_shift(1),g=!!(m&136),_=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:_=!0,g=!0;break;case 49:_=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var v=0,T=521;m==2&&(v=d.read_shift(2)),d.l+=3,m!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),m!=2&&(T=d.read_shift(2));var k=d.read_shift(2),E=u.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(E=e[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var w=[],P={},I=Math.min(d.length,m==2?521:T-10-(_?264:0)),M=y?32:11;d.l<I&&d[d.l]!=13;)switch(P={},P.name=ia.utils.decode(E,d.slice(d.l,d.l+M)).replace(/[\u0000\r\n].*$/g,""),d.l+=M,P.type=String.fromCharCode(d.read_shift(1)),m!=2&&!y&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),m==2&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&w.push(P),m!=2&&(d.l+=y?13:14),P.type){case"B":(!_||P.len!=8)&&u.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(d[d.l]!==13&&(d.l=T-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=T;var b=0,U=0;for(f[0]=[],U=0;U!=w.length;++U)f[0][U]=w[U].name;for(;v-- >0;){if(d[d.l]===42){d.l+=k;continue}for(++d.l,f[++b]=[],U=0,U=0;U!=w.length;++U){var j=d.slice(d.l,d.l+w[U].len);d.l+=w[U].len,wr(j,0);var K=ia.utils.decode(E,j);switch(w[U].type){case"C":K.trim().length&&(f[b][U]=K.replace(/\s+$/,""));break;case"D":K.length===8?f[b][U]=new Date(+K.slice(0,4),+K.slice(4,6)-1,+K.slice(6,8)):f[b][U]=K;break;case"F":f[b][U]=parseFloat(K.trim());break;case"+":case"I":f[b][U]=y?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(K.trim().toUpperCase()){case"Y":case"T":f[b][U]=!0;break;case"N":case"F":f[b][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+K+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[b][U]="##MEMO##"+(y?parseInt(K.trim(),10):j.read_shift(4));break;case"N":K=K.replace(/\u0000/g,"").trim(),K&&K!="."&&(f[b][U]=+K||0);break;case"@":f[b][U]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":f[b][U]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":f[b][U]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[b][U]=-j.read_shift(-8,"f");break;case"B":if(_&&w[U].len==8){f[b][U]=j.read_shift(8,"f");break}case"G":case"P":j.l+=w[U].len;break;case"0":if(w[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[U].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=w,f}function n(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=wo(r(l,f),f);return d["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,d}function i(l,u){try{return ba(n(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var f=u||{};if(+f.codepage>=0&&Gn(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=nh(),m=hh(l,{header:1,raw:!0,cellDates:!0}),g=m[0],_=m.slice(1),y=l["!cols"]||[],v=0,T=0,k=0,E=1;for(v=0;v<g.length;++v){if(((y[v]||{}).DBF||{}).name){g[v]=y[v].DBF.name,++k;continue}if(g[v]!=null){if(++k,typeof g[v]=="number"&&(g[v]=g[v].toString(10)),typeof g[v]!="string")throw new Error("DBF Invalid column name "+g[v]+" |"+typeof g[v]+"|");if(g.indexOf(g[v])!==v){for(T=0;T<1024;++T)if(g.indexOf(g[v]+"_"+T)==-1){g[v]+="_"+T;break}}}}var w=Kt(l["!ref"]),P=[],I=[],M=[];for(v=0;v<=w.e.c-w.s.c;++v){var b="",U="",j=0,K=[];for(T=0;T<_.length;++T)_[T][v]!=null&&K.push(_[T][v]);if(K.length==0||g[v]==null){P[v]="?";continue}for(T=0;T<K.length;++T){switch(typeof K[T]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=K[T]instanceof Date?"D":"C";break;default:U="C"}j=Math.max(j,String(K[T]).length),b=b&&b!=U?"C":U}j>250&&(j=250),U=((y[v]||{}).DBF||{}).type,U=="C"&&y[v].DBF.len>j&&(j=y[v].DBF.len),b=="B"&&U=="N"&&(b="N",M[v]=y[v].DBF.dec,j=y[v].DBF.len),I[v]=b=="C"||U=="N"?j:a[b]||0,E+=I[v],P[v]=b}var V=d.next(32);for(V.write_shift(4,318902576),V.write_shift(4,_.length),V.write_shift(2,296+32*k),V.write_shift(2,E),v=0;v<4;++v)V.write_shift(4,0);for(V.write_shift(4,0|(+t[Jy]||3)<<8),v=0,T=0;v<g.length;++v)if(g[v]!=null){var G=d.next(32),de=(g[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,de,"sbcs"),G.write_shift(1,P[v]=="?"?"C":P[v],"sbcs"),G.write_shift(4,T),G.write_shift(1,I[v]||a[P[v]]||0),G.write_shift(1,M[v]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),T+=I[v]||a[P[v]]||0}var Se=d.next(264);for(Se.write_shift(4,13),v=0;v<65;++v)Se.write_shift(4,0);for(v=0;v<_.length;++v){var ce=d.next(E);for(ce.write_shift(1,0),T=0;T<g.length;++T)if(g[T]!=null)switch(P[T]){case"L":ce.write_shift(1,_[v][T]==null?63:_[v][T]?84:70);break;case"B":ce.write_shift(8,_[v][T]||0,"f");break;case"N":var Y="0";for(typeof _[v][T]=="number"&&(Y=_[v][T].toFixed(M[T]||0)),k=0;k<I[T]-Y.length;++k)ce.write_shift(1,32);ce.write_shift(1,Y,"sbcs");break;case"D":_[v][T]?(ce.write_shift(4,("0000"+_[v][T].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(_[v][T].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+_[v][T].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var xe=String(_[v][T]!=null?_[v][T]:"").slice(0,I[T]);for(ce.write_shift(1,xe,"sbcs"),k=0;k<I[T]-xe.length;++k)ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),mL=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+vi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,_){var y=e[_];return typeof y=="number"?N1(y):y},n=function(g,_,y){var v=_.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return v==59?g:N1(v)};e["|"]=254;function i(g,_){switch(_.type){case"base64":return a(mn(g),_);case"binary":return a(g,_);case"buffer":return a(xt&&Buffer.isBuffer(g)?g.toString("binary"):fs(g),_);case"array":return a(as(g),_)}throw new Error("Unrecognized type "+_.type)}function a(g,_){var y=g.split(/[\n\r]+/),v=-1,T=-1,k=0,E=0,w=[],P=[],I=null,M={},b=[],U=[],j=[],K=0,V;for(+_.codepage>=0&&Gn(+_.codepage);k!==y.length;++k){K=0;var G=y[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),de=G.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),Se=de[0],ce;if(G.length>0)switch(Se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":de[1].charAt(0)=="P"&&P.push(G.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,xe=!1,re=!1,q=!1,ae=-1,pe=-1;for(E=1;E<de.length;++E)switch(de[E].charAt(0)){case"A":break;case"X":T=parseInt(de[E].slice(1))-1,xe=!0;break;case"Y":for(v=parseInt(de[E].slice(1))-1,xe||(T=0),V=w.length;V<=v;++V)w[V]=[];break;case"K":ce=de[E].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(Jn(ce))?isNaN(co(ce).getDate())||(ce=vr(ce)):(ce=Jn(ce),I!==null&&_o(I)&&(ce=Mf(ce))),Y=!0;break;case"E":q=!0;var O=eo(de[E].slice(1),{r:v,c:T});w[v][T]=[w[v][T],O];break;case"S":re=!0,w[v][T]=[w[v][T],"S5S"];break;case"G":break;case"R":ae=parseInt(de[E].slice(1))-1;break;case"C":pe=parseInt(de[E].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+G)}if(Y&&(w[v][T]&&w[v][T].length==2?w[v][T][0]=ce:w[v][T]=ce,I=null),re){if(q)throw new Error("SYLK shared formula cannot have own formula");var J=ae>-1&&w[ae][pe];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");w[v][T][1]=cw(J[1],{r:v-ae,c:T-pe})}break;case"F":var X=0;for(E=1;E<de.length;++E)switch(de[E].charAt(0)){case"X":T=parseInt(de[E].slice(1))-1,++X;break;case"Y":for(v=parseInt(de[E].slice(1))-1,V=w.length;V<=v;++V)w[V]=[];break;case"M":K=parseInt(de[E].slice(1))/20;break;case"F":break;case"G":break;case"P":I=P[parseInt(de[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=de[E].slice(1).split(" "),V=parseInt(j[0],10);V<=parseInt(j[1],10);++V)K=parseInt(j[2],10),U[V-1]=K===0?{hidden:!0}:{wch:K},uo(U[V-1]);break;case"C":T=parseInt(de[E].slice(1))-1,U[T]||(U[T]={});break;case"R":v=parseInt(de[E].slice(1))-1,b[v]||(b[v]={}),K>0?(b[v].hpt=K,b[v].hpx=Hl(K)):K===0&&(b[v].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+G)}X<1&&(I=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+G)}}return b.length>0&&(M["!rows"]=b),U.length>0&&(M["!cols"]=U),_&&_.sheetRows&&(w=w.slice(0,_.sheetRows)),[w,M]}function o(g,_){var y=i(g,_),v=y[0],T=y[1],k=wo(v,_);return vi(T).forEach(function(E){k[E]=T[E]}),k}function l(g,_){return ba(o(g,_),_)}function u(g,_,y,v){var T="C;Y"+(y+1)+";X"+(v+1)+";K";switch(g.t){case"n":T+=g.v||0,g.f&&!g.F&&(T+=";E"+tF(g.f,{r:y,c:v}));break;case"b":T+=g.v?"TRUE":"FALSE";break;case"e":T+=g.w||g.v;break;case"d":T+='"'+(g.w||g.v)+'"';break;case"s":T+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function f(g,_){_.forEach(function(y,v){var T="F;W"+(v+1)+" "+(v+1)+" ";y.hidden?T+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=af(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=sf(y.wpx)),typeof y.wch=="number"&&(T+=Math.round(y.wch))),T.charAt(T.length-1)!=" "&&g.push(T)})}function d(g,_){_.forEach(function(y,v){var T="F;";y.hidden?T+="M0;":y.hpt?T+="M"+20*y.hpt+";":y.hpx&&(T+="M"+20*sw(y.hpx)+";"),T.length>2&&g.push(T+"R"+(v+1))})}function m(g,_){var y=["ID;PWXL;N;E"],v=[],T=Kt(g["!ref"]),k,E=Array.isArray(g),w=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&f(y,g["!cols"]),g["!rows"]&&d(y,g["!rows"]),y.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var P=T.s.r;P<=T.e.r;++P)for(var I=T.s.c;I<=T.e.c;++I){var M=Qe({r:P,c:I});k=E?(g[P]||[])[I]:g[M],!(!k||k.v==null&&(!k.f||k.F))&&v.push(u(k,g,P,I))}return y.join(w)+w+v.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),gL=function(){function e(a,o){switch(o.type){case"base64":return t(mn(a),o);case"binary":return t(a,o);case"buffer":return t(xt&&Buffer.isBuffer(a)?a.toString("binary"):fs(a),o);case"array":return t(as(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),u=-1,f=-1,d=0,m=[];d!==l.length;++d){if(l[d].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var g=l[d].trim().split(","),_=g[0],y=g[1];++d;for(var v=l[d]||"";(v.match(/["]/g)||[]).length&1&&d<l.length-1;)v+=`
`+l[++d];switch(v=v.trim(),+_){case-1:if(v==="BOT"){m[++u]=[],f=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?m[u][f]=!0:v==="FALSE"?m[u][f]=!1:isNaN(Jn(y))?isNaN(co(y).getDate())?m[u][f]=y:m[u][f]=vr(y):m[u][f]=Jn(y),++f;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),m[u][f++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(a,o){return wo(e(a,o),o)}function n(a,o){return ba(r(a,o),o)}var i=function(){var a=function(u,f,d,m,g){u.push(f),u.push(d+","+m),u.push('"'+g.replace(/"/g,'""')+'"')},o=function(u,f,d,m){u.push(f+","+d),u.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var f=[],d=Kt(u["!ref"]),m,g=Array.isArray(u);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var _=d.s.r;_<=d.e.r;++_){o(f,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var v=Qe({r:_,c:y});if(m=g?(u[_]||[])[y]:u[v],!m){o(f,1,0,"");continue}switch(m.t){case"n":var T=m.w;!T&&m.v!=null&&(T=m.v),T==null?m.f&&!m.F?o(f,1,0,"="+m.f):o(f,1,0,""):o(f,0,T,"V");break;case"b":o(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Mn(m.z||st[14],Gr(vr(m.v)))),o(f,0,m.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var k=`\r
`,E=f.join(k);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),xL=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var _=m.split(`
`),y=-1,v=-1,T=0,k=[];T!==_.length;++T){var E=_[T].trim().split(":");if(E[0]==="cell"){var w=Wr(E[1]);if(k.length<=w.r)for(y=k.length;y<=w.r;++y)k[y]||(k[y]=[]);switch(y=w.r,v=w.c,E[2]){case"t":k[y][v]=e(E[3]);break;case"v":k[y][v]=+E[3];break;case"vtf":var P=E[E.length-1];case"vtc":switch(E[3]){case"nl":k[y][v]=!!+E[4];break;default:k[y][v]=+E[4];break}E[2]=="vtf"&&(k[y][v]=[k[y][v],P])}}}return g&&g.sheetRows&&(k=k.slice(0,g.sheetRows)),k}function n(m,g){return wo(r(m,g),g)}function i(m,g){return ba(n(m,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var g=[],_=[],y,v="",T=yo(m["!ref"]),k=Array.isArray(m),E=T.s.r;E<=T.e.r;++E)for(var w=T.s.c;w<=T.e.c;++w)if(v=Qe({r:E,c:w}),y=k?(m[E]||[])[w]:m[v],!(!y||y.v==null||y.t==="z")){switch(_=["cell",v,"t"],y.t){case"s":case"str":_.push(t(y.v));break;case"n":y.f?(_[2]="vtf",_[3]="n",_[4]=y.v,_[5]=t(y.f)):(_[2]="v",_[3]=y.v);break;case"b":_[2]="vt"+(y.f?"f":"c"),_[3]="nl",_[4]=y.v?"1":"0",_[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=Gr(vr(y.v));_[2]="vtc",_[3]="nd",_[4]=""+P,_[5]=y.w||Mn(y.z||st[14],P);break;case"e":continue}g.push(_.join(":"))}return g.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(m){return[a,o,l,o,f(m),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),zl=function(){function e(d,m,g,_,y){y.raw?m[g][_]=d:d===""||(d==="TRUE"?m[g][_]=!0:d==="FALSE"?m[g][_]=!1:isNaN(Jn(d))?isNaN(co(d).getDate())?m[g][_]=d:m[g][_]=vr(d):m[g][_]=Jn(d))}function t(d,m){var g=m||{},_=[];if(!d||d.length===0)return _;for(var y=d.split(/[\r\n]/),v=y.length-1;v>=0&&y[v].length===0;)--v;for(var T=10,k=0,E=0;E<=v;++E)k=y[E].indexOf(" "),k==-1?k=y[E].length:k++,T=Math.max(T,k);for(E=0;E<=v;++E){_[E]=[];var w=0;for(e(y[E].slice(0,T).trim(),_,E,w,g),w=1;w<=(y[E].length-T)/10+1;++w)e(y[E].slice(T+(w-1)*10,T+w*10).trim(),_,E,w,g)}return g.sheetRows&&(_=_.slice(0,g.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var m={},g=!1,_=0,y=0;_<d.length;++_)(y=d.charCodeAt(_))==34?g=!g:!g&&y in r&&(m[y]=(m[y]||0)+1);y=[];for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&y.push([m[_],_]);if(!y.length){m=n;for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&y.push([m[_],_])}return y.sort(function(v,T){return v[0]-T[0]||n[v[1]]-n[T[1]]}),r[y.pop()[1]]||44}function a(d,m){var g=m||{},_="",y=g.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(_=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(_=d.charAt(4),d=d.slice(6)):_=i(d.slice(0,1024)):g&&g.FS?_=g.FS:_=i(d.slice(0,1024));var T=0,k=0,E=0,w=0,P=0,I=_.charCodeAt(0),M=!1,b=0,U=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=g.dateNF!=null?NA(g.dateNF):null;function K(){var V=d.slice(w,P),G={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)G.t="z";else if(g.raw)G.t="s",G.v=V;else if(V.trim().length===0)G.t="s",G.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(G.t="s",G.v=V.slice(2,-1).replace(/""/g,'"')):nF(V)?(G.t="n",G.f=V.slice(1)):(G.t="s",G.v=V);else if(V=="TRUE")G.t="b",G.v=!0;else if(V=="FALSE")G.t="b",G.v=!1;else if(!isNaN(E=Jn(V)))G.t="n",g.cellText!==!1&&(G.w=V),G.v=E;else if(!isNaN(co(V).getDate())||j&&V.match(j)){G.z=g.dateNF||st[14];var de=0;j&&V.match(j)&&(V=bA(V,g.dateNF,V.match(j)||[]),de=1),g.cellDates?(G.t="d",G.v=vr(V,de)):(G.t="n",G.v=Gr(vr(V,de))),g.cellText!==!1&&(G.w=Mn(G.z,G.v instanceof Date?Gr(G.v):G.v)),g.cellNF||delete G.z}else G.t="s",G.v=V;if(G.t=="z"||(g.dense?(y[T]||(y[T]=[]),y[T][k]=G):y[Qe({c:k,r:T})]=G),w=P+1,U=d.charCodeAt(w),v.e.c<k&&(v.e.c=k),v.e.r<T&&(v.e.r=T),b==I)++k;else if(k=0,++T,g.sheetRows&&g.sheetRows<=T)return!0}e:for(;P<d.length;++P)switch(b=d.charCodeAt(P)){case 34:U===34&&(M=!M);break;case I:case 10:case 13:if(!M&&K())break e;break}return P-w>0&&K(),y["!ref"]=yt(v),y}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,m):wo(t(d,m),m)}function l(d,m){var g="",_=m.type=="string"?[0,0,0,0]:Xp(d,m);switch(m.type){case"base64":g=mn(d);break;case"binary":g=d;break;case"buffer":m.codepage==65001?g=d.toString("utf8"):m.codepage&&typeof ia<"u"?g=ia.utils.decode(m.codepage,d):g=xt&&Buffer.isBuffer(d)?d.toString("binary"):fs(d);break;case"array":g=as(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+m.type)}return _[0]==239&&_[1]==187&&_[2]==191?g=Ft(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=Ft(g):m.type=="binary"&&typeof ia<"u"&&m.codepage&&(g=ia.utils.decode(m.codepage,ia.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?xL.to_sheet(m.type=="string"?g:Ft(g),m):o(g,m)}function u(d,m){return ba(l(d,m),m)}function f(d){for(var m=[],g=Kt(d["!ref"]),_,y=Array.isArray(d),v=g.s.r;v<=g.e.r;++v){for(var T=[],k=g.s.c;k<=g.e.c;++k){var E=Qe({r:v,c:k});if(_=y?(d[v]||[])[k]:d[E],!_||_.v==null){T.push("          ");continue}for(var w=(_.w||(Wi(_),_.w)||"").slice(0,10);w.length<10;)w+=" ";T.push(w+(k===0?" ":""))}m.push(T.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}();function vL(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=mL.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return zl.to_workbook(e,t)}}var pl=function(){function e(O,J,X){if(O){wr(O,O.l||0);for(var W=X.Enum||ae;O.l<O.length;){var ie=O.read_shift(2),we=W[ie]||W[65535],Le=O.read_shift(2),Ae=O.l+Le,_e=we.f&&we.f(O,Le,X);if(O.l=Ae,J(_e,we,ie))return}}}function t(O,J){switch(J.type){case"base64":return r(Zn(mn(O)),J);case"binary":return r(Zn(O),J);case"buffer":case"array":return r(O,J)}throw"Unsupported type "+J.type}function r(O,J){if(!O)return O;var X=J||{},W=X.dense?[]:{},ie="Sheet1",we="",Le=0,Ae={},_e=[],ze=[],H={s:{r:0,c:0},e:{r:0,c:0}},Ye=X.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)X.Enum=ae,e(O,function(Ne,le,Pe){switch(Pe){case 0:X.vers=Ne,Ne>=4096&&(X.qpro=!0);break;case 6:H=Ne;break;case 204:Ne&&(we=Ne);break;case 222:we=Ne;break;case 15:case 51:X.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:Pe==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=X.dateNF||st[14],X.cellDates&&(Ne[1].t="d",Ne[1].v=Mf(Ne[1].v))),X.qpro&&Ne[3]>Le&&(W["!ref"]=yt(H),Ae[ie]=W,_e.push(ie),W=X.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Le=Ne[3],ie=we||"Sheet"+(Le+1),we="");var Fe=X.dense?(W[Ne[0].r]||[])[Ne[0].c]:W[Qe(Ne[0])];if(Fe){Fe.t=Ne[1].t,Fe.v=Ne[1].v,Ne[1].z!=null&&(Fe.z=Ne[1].z),Ne[1].f!=null&&(Fe.f=Ne[1].f);break}X.dense?(W[Ne[0].r]||(W[Ne[0].r]=[]),W[Ne[0].r][Ne[0].c]=Ne[1]):W[Qe(Ne[0])]=Ne[1];break}},X);else if(O[2]==26||O[2]==14)X.Enum=pe,O[2]==14&&(X.qpro=!0,O.l=0),e(O,function(Ne,le,Pe){switch(Pe){case 204:ie=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>Le&&(W["!ref"]=yt(H),Ae[ie]=W,_e.push(ie),W=X.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Le=Ne[3],ie="Sheet"+(Le+1)),Ye>0&&Ne[0].r>=Ye)break;X.dense?(W[Ne[0].r]||(W[Ne[0].r]=[]),W[Ne[0].r][Ne[0].c]=Ne[1]):W[Qe(Ne[0])]=Ne[1],H.e.c<Ne[0].c&&(H.e.c=Ne[0].c),H.e.r<Ne[0].r&&(H.e.r=Ne[0].r);break;case 27:Ne[14e3]&&(ze[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:ze[Ne[0]]=Ne[1],Ne[0]==Le&&(ie=Ne[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(W["!ref"]=yt(H),Ae[we||ie]=W,_e.push(we||ie),!ze.length)return{SheetNames:_e,Sheets:Ae};for(var rt={},et=[],Ge=0;Ge<ze.length;++Ge)Ae[_e[Ge]]?(et.push(ze[Ge]||_e[Ge]),rt[ze[Ge]]=Ae[ze[Ge]]||Ae[_e[Ge]]):(et.push(ze[Ge]),rt[ze[Ge]]={"!ref":"A1"});return{SheetNames:et,Sheets:rt}}function n(O,J){var X=J||{};if(+X.codepage>=0&&Gn(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var W=nh(),ie=Kt(O["!ref"]),we=Array.isArray(O),Le=[];Hn(W,0,a(1030)),Hn(W,6,u(ie));for(var Ae=Math.min(ie.e.r,8191),_e=ie.s.r;_e<=Ae;++_e)for(var ze=Tr(_e),H=ie.s.c;H<=ie.e.c;++H){_e===ie.s.r&&(Le[H]=fr(H));var Ye=Le[H]+ze,rt=we?(O[_e]||[])[H]:O[Ye];if(!(!rt||rt.t=="z"))if(rt.t=="n")(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?Hn(W,13,_(_e,H,rt.v)):Hn(W,14,v(_e,H,rt.v));else{var et=Wi(rt);Hn(W,15,m(_e,H,et.slice(0,239)))}}return Hn(W,1),W.end()}function i(O,J){var X=J||{};if(+X.codepage>=0&&Gn(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var W=nh();Hn(W,0,o(O));for(var ie=0,we=0;ie<O.SheetNames.length;++ie)(O.Sheets[O.SheetNames[ie]]||{})["!ref"]&&Hn(W,27,q(O.SheetNames[ie],we++));var Le=0;for(ie=0;ie<O.SheetNames.length;++ie){var Ae=O.Sheets[O.SheetNames[ie]];if(!(!Ae||!Ae["!ref"])){for(var _e=Kt(Ae["!ref"]),ze=Array.isArray(Ae),H=[],Ye=Math.min(_e.e.r,8191),rt=_e.s.r;rt<=Ye;++rt)for(var et=Tr(rt),Ge=_e.s.c;Ge<=_e.e.c;++Ge){rt===_e.s.r&&(H[Ge]=fr(Ge));var Ne=H[Ge]+et,le=ze?(Ae[rt]||[])[Ge]:Ae[Ne];if(!(!le||le.t=="z"))if(le.t=="n")Hn(W,23,K(rt,Ge,Le,le.v));else{var Pe=Wi(le);Hn(W,22,b(rt,Ge,Le,Pe.slice(0,239)))}}++Le}}return Hn(W,1),W.end()}function a(O){var J=lr(2);return J.write_shift(2,O),J}function o(O){var J=lr(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var X=0,W=0,ie=0,we=0;we<O.SheetNames.length;++we){var Le=O.SheetNames[we],Ae=O.Sheets[Le];if(!(!Ae||!Ae["!ref"])){++ie;var _e=yo(Ae["!ref"]);X<_e.e.r&&(X=_e.e.r),W<_e.e.c&&(W=_e.e.c)}}return X>8191&&(X=8191),J.write_shift(2,X),J.write_shift(1,ie),J.write_shift(1,W),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function l(O,J,X){var W={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&X.qpro?(W.s.c=O.read_shift(1),O.l++,W.s.r=O.read_shift(2),W.e.c=O.read_shift(1),O.l++,W.e.r=O.read_shift(2),W):(W.s.c=O.read_shift(2),W.s.r=O.read_shift(2),J==12&&X.qpro&&(O.l+=2),W.e.c=O.read_shift(2),W.e.r=O.read_shift(2),J==12&&X.qpro&&(O.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function u(O){var J=lr(8);return J.write_shift(2,O.s.c),J.write_shift(2,O.s.r),J.write_shift(2,O.e.c),J.write_shift(2,O.e.r),J}function f(O,J,X){var W=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(W[0].c=O.read_shift(1),W[3]=O.read_shift(1),W[0].r=O.read_shift(2),O.l+=2):(W[2]=O.read_shift(1),W[0].c=O.read_shift(2),W[0].r=O.read_shift(2)),W}function d(O,J,X){var W=O.l+J,ie=f(O,J,X);if(ie[1].t="s",X.vers==20768){O.l++;var we=O.read_shift(1);return ie[1].v=O.read_shift(we,"utf8"),ie}return X.qpro&&O.l++,ie[1].v=O.read_shift(W-O.l,"cstr"),ie}function m(O,J,X){var W=lr(7+X.length);W.write_shift(1,255),W.write_shift(2,J),W.write_shift(2,O),W.write_shift(1,39);for(var ie=0;ie<W.length;++ie){var we=X.charCodeAt(ie);W.write_shift(1,we>=128?95:we)}return W.write_shift(1,0),W}function g(O,J,X){var W=f(O,J,X);return W[1].v=O.read_shift(2,"i"),W}function _(O,J,X){var W=lr(7);return W.write_shift(1,255),W.write_shift(2,J),W.write_shift(2,O),W.write_shift(2,X,"i"),W}function y(O,J,X){var W=f(O,J,X);return W[1].v=O.read_shift(8,"f"),W}function v(O,J,X){var W=lr(13);return W.write_shift(1,255),W.write_shift(2,J),W.write_shift(2,O),W.write_shift(8,X,"f"),W}function T(O,J,X){var W=O.l+J,ie=f(O,J,X);if(ie[1].v=O.read_shift(8,"f"),X.qpro)O.l=W;else{var we=O.read_shift(2);P(O.slice(O.l,O.l+we),ie),O.l+=we}return ie}function k(O,J,X){var W=J&32768;return J&=-32769,J=(W?O:0)+(J>=8192?J-16384:J),(W?"":"$")+(X?fr(J):Tr(J))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(O,J){wr(O,0);for(var X=[],W=0,ie="",we="",Le="",Ae="";O.l<O.length;){var _e=O[O.l++];switch(_e){case 0:X.push(O.read_shift(8,"f"));break;case 1:we=k(J[0].c,O.read_shift(2),!0),ie=k(J[0].r,O.read_shift(2),!1),X.push(we+ie);break;case 2:{var ze=k(J[0].c,O.read_shift(2),!0),H=k(J[0].r,O.read_shift(2),!1);we=k(J[0].c,O.read_shift(2),!0),ie=k(J[0].r,O.read_shift(2),!1),X.push(ze+H+":"+we+ie)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(O.read_shift(2));break;case 6:{for(var Ye="";_e=O[O.l++];)Ye+=String.fromCharCode(_e);X.push('"'+Ye.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Ae=X.pop(),Le=X.pop(),X.push(["AND","OR"][_e-20]+"("+Le+","+Ae+")");break;default:if(_e<32&&w[_e])Ae=X.pop(),Le=X.pop(),X.push(Le+w[_e]+Ae);else if(E[_e]){if(W=E[_e][1],W==69&&(W=O[O.l++]),W>X.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+X.join("|")+"|");return}var rt=X.slice(-W);X.length-=W,X.push(E[_e][0]+"("+rt.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}X.length==1?J[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function I(O){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=O.read_shift(2),J[3]=O[O.l++],J[0].c=O[O.l++],J}function M(O,J){var X=I(O);return X[1].t="s",X[1].v=O.read_shift(J-4,"cstr"),X}function b(O,J,X,W){var ie=lr(6+W.length);ie.write_shift(2,O),ie.write_shift(1,X),ie.write_shift(1,J),ie.write_shift(1,39);for(var we=0;we<W.length;++we){var Le=W.charCodeAt(we);ie.write_shift(1,Le>=128?95:Le)}return ie.write_shift(1,0),ie}function U(O,J){var X=I(O);X[1].v=O.read_shift(2);var W=X[1].v>>1;if(X[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return X[1].v=W,X}function j(O,J){var X=I(O),W=O.read_shift(4),ie=O.read_shift(4),we=O.read_shift(2);if(we==65535)return W===0&&ie===3221225472?(X[1].t="e",X[1].v=15):W===0&&ie===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var Le=we&32768;return we=(we&32767)-16446,X[1].v=(1-Le*2)*(ie*Math.pow(2,we+32)+W*Math.pow(2,we)),X}function K(O,J,X,W){var ie=lr(14);if(ie.write_shift(2,O),ie.write_shift(1,X),ie.write_shift(1,J),W==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var we=0,Le=0,Ae=0,_e=0;return W<0&&(we=1,W=-W),Le=Math.log2(W)|0,W/=Math.pow(2,Le-31),_e=W>>>0,_e&2147483648||(W/=2,++Le,_e=W>>>0),W-=_e,_e|=2147483648,_e>>>=0,W*=Math.pow(2,32),Ae=W>>>0,ie.write_shift(4,Ae),ie.write_shift(4,_e),Le+=16383+(we?32768:0),ie.write_shift(2,Le),ie}function V(O,J){var X=j(O);return O.l+=J-14,X}function G(O,J){var X=I(O),W=O.read_shift(4);return X[1].v=W>>6,X}function de(O,J){var X=I(O),W=O.read_shift(8,"f");return X[1].v=W,X}function Se(O,J){var X=de(O);return O.l+=J-10,X}function ce(O,J){return O[O.l+J-1]==0?O.read_shift(J,"cstr"):""}function Y(O,J){var X=O[O.l++];X>J-1&&(X=J-1);for(var W="";W.length<X;)W+=String.fromCharCode(O[O.l++]);return W}function xe(O,J,X){if(!(!X.qpro||J<21)){var W=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var ie=O.read_shift(J-21,"cstr");return[W,ie]}}function re(O,J){for(var X={},W=O.l+J;O.l<W;){var ie=O.read_shift(2);if(ie==14e3){for(X[ie]=[0,""],X[ie][0]=O.read_shift(2);O[O.l];)X[ie][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return X}function q(O,J){var X=lr(5+O.length);X.write_shift(2,14e3),X.write_shift(2,J);for(var W=0;W<O.length;++W){var ie=O.charCodeAt(W);X[X.l++]=ie>127?95:ie}return X[X.l++]=0,X}var ae={0:{n:"BOF",f:ir},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:de},40:{n:"FORMULA28",f:Se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function _L(e){var t={},r=e.match(jr),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=Ze(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Tp[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var yL=function(){var e=jl("t"),t=jl("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Et(o[1])},u=a.match(t);return u&&(l.s=_L(u[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),wL=function(){var t=/(\r\n|\n)/g;function r(i,a,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),kL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,EL=/<(?:\w+:)?r>/,TL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Up(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Et(Ft(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ft(e),r&&(n.h=Pp(n.t))):e.match(EL)&&(n.r=Ft(e),n.t=Et(Ft((e.replace(TL,"").match(kL)||[]).join("").replace(jr,""))),r&&(n.h=wL(yL(n.r)))),n):{t:""}}var SL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,CL=/<(?:\w+:)?(?:si|sstItem)>/g,AL=/<\/(?:\w+:)?(?:si|sstItem)>/;function NL(e,t){var r=[],n="";if(!e)return r;var i=e.match(SL);if(i){n=i[2].replace(CL,"").split(AL);for(var a=0;a!=n.length;++a){var o=Up(n[a].trim(),t);o!=null&&(r[r.length]=o)}i=Ze(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function bL(e){return[e.read_shift(4),e.read_shift(4)]}function LL(e,t){var r=[],n=!1;return Xi(e,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function ew(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ji(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function PL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ji(e,4),t.U=ji(e,4),t.W=ji(e,4),t}function FL(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function OL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(FL(e));return t}function RL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function ML(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ji(e,4),t.U=ji(e,4),t.W=ji(e,4),t}function IL(e){var t=ML(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function tw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function rw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function DL(e){var t=ji(e);switch(t.Minor){case 2:return[t.Minor,jL(e)];case 3:return[t.Minor,BL()];case 4:return[t.Minor,zL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function jL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=tw(e,r),i=rw(e,e.length-e.l);return{t:"Std",h:n,v:i}}function BL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(jr,function(a){var o=Ze(a);switch(_i(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function UL(e,t){var r={},n=r.EncryptionVersionInfo=ji(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=tw(e,i),t-=i,r.EncryptionVerifier=rw(e,t),r}function HL(e){var t={},r=t.EncryptionVersionInfo=ji(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function VL(e){var t=0,r,n=ew(e),i=n.length+1,a,o,l,u,f;for(r=Ta(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],l=t&16384?1:0,u=t<<1&32767,f=l|u,t=f^o;return t^52811}var nw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},a=function(o){for(var l=t[o.length-1],u=104,f=o.length-1;f>=0;--f)for(var d=o[f],m=0;m!=7;++m)d&64&&(l^=r[u]),d*=2,--u;return l};return function(o){for(var l=ew(o),u=a(l),f=l.length,d=Ta(16),m=0;m!=16;++m)d[m]=0;var g,_,y;for((f&1)===1&&(g=u>>8,d[f]=i(e[0],g),--f,g=u&255,_=l[l.length-1],d[f]=i(_,g));f>0;)--f,g=u>>8,d[f]=i(l[f],g),--f,g=u&255,d[f]=i(l[f],g);for(f=15,y=15-l.length;y>0;)g=u>>8,d[f]=i(e[y],g),--f,--y,g=u&255,d[f]=i(l[f],g),--f,--y;return d}}(),WL=function(e,t,r,n,i){i||(i=t),n||(n=nw(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},$L=function(e){var t=0,r=nw(e);return function(n){var i=WL("",n,t,r);return t=i[1],i[0]}};function ZL(e,t,r,n){var i={key:ir(e),verificationBytes:ir(e)};return r.password&&(i.verifier=VL(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=$L(r.password)),i}function GL(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=HL(e):n.Data=UL(e,t),n}function XL(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?GL(e,t-2,n):ZL(e,r.biff>=8?t:t-2,r,n),n}var KL=function(){function e(i,a){switch(a.type){case"base64":return t(mn(i),a);case"binary":return t(i,a);case"buffer":return t(xt&&Buffer.isBuffer(i)?i.toString("binary"):fs(i),a);case"array":return t(as(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},l=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,m){Array.isArray(l)&&(l[m]=[]);for(var g=/\\\w+\b/g,_=0,y,v=-1;y=g.exec(d);){switch(y[0]){case"\\cell":var T=d.slice(_,g.lastIndex-y[0].length);if(T[0]==" "&&(T=T.slice(1)),++v,T.length){var k={v:T,t:"s"};Array.isArray(l)?l[m][v]=k:l[Qe({r:m,c:v})]=k}break}_=g.lastIndex}v>f.e.c&&(f.e.c=v)}),l["!ref"]=yt(f),l}function r(i,a){return ba(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Kt(i["!ref"]),l,u=Array.isArray(i),f=o.s.r;f<=o.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=Qe({r:f,c:d});l=u?(i[f]||[])[d]:i[m],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Wi(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function qL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ul(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function YL(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var l=0,u=0,f=i+a;switch(u=o/(f>1?2-f:f),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,f/2]}function JL(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=i*l,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-l),o[0]+=u,o[1]+=i;break;case 2:u=i*(l-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-l),o[1]+=u,o[2]+=i;break;case 4:u=i*(l-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-l),o[2]+=u,o[0]+=i;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function nf(e,t){if(t===0)return e;var r=YL(qL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Ul(JL(r))}var iw=6,QL=15,eP=1,Vr=iw;function af(e){return Math.floor((e+Math.round(128/Vr)/256)*Vr)}function sf(e){return Math.floor((e-5)/Vr*100+.5)/100}function oh(e){return Math.round((e*Vr+5)/Vr*256)/256}function G0(e){return oh(sf(af(e)))}function Hp(e){var t=Math.abs(e-G0(e)),r=Vr;if(t>.005)for(Vr=eP;Vr<QL;++Vr)Math.abs(e-G0(e))<=t&&(t=Math.abs(e-G0(e)),r=Vr);Vr=r}function uo(e){e.width?(e.wpx=af(e.width),e.wch=sf(e.wpx),e.MDW=Vr):e.wpx?(e.wch=sf(e.wpx),e.width=oh(e.wch),e.MDW=Vr):typeof e.wch=="number"&&(e.width=oh(e.wch),e.wpx=af(e.width),e.MDW=Vr),e.customWidth&&delete e.customWidth}var tP=96,aw=tP;function sw(e){return e*96/aw}function Hl(e){return e*aw/96}var rP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function nP(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(jr)||[]).forEach(function(o){var l=Ze(o);switch(_i(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=jt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=jt(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function iP(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(jr)||[]).forEach(function(o){var l=Ze(o);switch(_i(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function aP(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(jr)||[]).forEach(function(o){var l=Ze(o);switch(_i(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Ft(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?jt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?jt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?jt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?jt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?jt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?jt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?jt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Tp[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=jt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var u=Ka[i.color.index];i.color.index==81&&(u=Ka[1]),u||(u=Ka[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=nf(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function sP(e,t,r){t.NumberFmt=[];for(var n=vi(st),i=0;i<n.length;++i)t.NumberFmt[n[i]]=st[n[i]];var a=e[0].match(jr);if(a)for(i=0;i<a.length;++i){var o=Ze(a[i]);switch(_i(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Et(Ft(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}Xa(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Jc=["numFmtId","fillId","fontId","borderId","xfId"],Qc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oP(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(jr)||[]).forEach(function(a){var o=Ze(a),l=0;switch(_i(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Jc.length;++l)n[Jc[l]]&&(n[Jc[l]]=parseInt(n[Jc[l]],10));for(l=0;l<Qc.length;++l)n[Qc[l]]&&(n[Qc[l]]=jt(n[Qc[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=jt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var lP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,f){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&sP(m,d,f),(m=l.match(i))&&aP(m,d,u,f),(m=l.match(n))&&iP(m,d,u,f),(m=l.match(a))&&nP(m,d,u,f),(m=l.match(r))&&oP(m,d,f),d}}();function cP(e,t){var r=e.read_shift(2),n=Mr(e);return[r,n]}function uP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=yN(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=_N(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Mr(e),n}var fP=Dr;function dP(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var hP=Dr;function pP(e,t,r){var n={};n.NumberFmt=[];for(var i in st)n.NumberFmt[i]=st[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Xi(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],Xa(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=nf(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d),o=!0;break;case 38:a.pop(),o=!1;break;default:if(f.T>0)a.push(d);else if(f.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var mP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function gP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(jr)||[]).forEach(function(i){var a=Ze(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[mP.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function xP(){}function vP(){}var _P=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,yP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,wP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function kP(e,t,r){t.themeElements={};var n;[["clrScheme",_P,gP],["fontScheme",yP,xP],["fmtScheme",wP,vP]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var EP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ow(e,t){(!e||e.length===0)&&(e=TP());var r,n={};if(!(r=e.match(EP)))throw new Error("themeElements not found in theme");return kP(r[0],n,t),n.raw=e,n}function TP(e,t){var r=[v2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function SP(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=x2(a,{type:"array"})}catch{return}var l=un(o,"theme/theme/theme1.xml",!0);if(l)return ow(l,r)}}function CP(e){return e.read_shift(4)}function AP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=NP(e,4);break;case 2:t.xclrValue=G2(e);break;case 3:t.xclrValue=CP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function NP(e,t){return Dr(e,t)}function bP(e,t){return Dr(e,t)}function LP(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=AP(e);break;case 6:n[1]=bP(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function PP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(LP(e,r-e.l));return{ixfe:n,ext:a}}function FP(e,t){t.forEach(function(r){switch(r[0]){}})}function OP(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Mr(e)}}function RP(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function MP(e){return e.l+=4,e.read_shift(4)!=0}function IP(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,l=2;return Xi(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:a.push(d),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!f.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function DP(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(jr,function(l){var u=Ze(l);switch(_i(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(o=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function jP(e){var t=[];if(!e)return t;var r=1;return(e.match(jr)||[]).forEach(function(n){var i=Ze(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function BP(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Qe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function zP(e,t,r){var n=[];return Xi(e,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function UP(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Xi(e,function(l,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function HP(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function hx(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(o){var l=Wr(o.ref);if(i?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[o.ref],!a){a={t:"z"},i?e[l.r][l.c]=a:e[o.ref]=a;var u=Kt(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var f=yt(u);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var m=a.c.length-1;m>=0;--m){if(!r&&a.c[m].T)return;r&&!a.c[m].T&&a.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(d.a==n[m].id){d.a=n[m].name||d.a;break}}a.c.push(d)})}function VP(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Ze(l[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Wr(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&Up(m[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function WP(e,t){var r=[],n=!1,i={},a=0;return e.replace(jr,function(l,u){var f=Ze(l);switch(_i(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+l.length;break;case"</text>":i.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return l}),r}function $P(e,t){var r=[],n=!1;return e.replace(jr,function(a){var o=Ze(a);switch(_i(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function ZP(e){var t={};t.iauthor=e.read_shift(4);var r=hs(e);return t.rfx=r.s,t.ref=Qe(r.s),e.l+=16,t}var GP=Mr;function XP(e,t){var r=[],n=[],i={},a=!1;return Xi(e,function(l,u,f){switch(f){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var KP="application/vnd.ms-office.vbaProject";function qP(e){var t=_t.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_t.utils.cfb_add(t,i,e.FileIndex[n].content)}}),_t.write(t)}function YP(){return{"!type":"dialog"}}function JP(){return{"!type":"dialog"}}function QP(){return{"!type":"macro"}}function eF(){return{"!type":"macro"}}var eo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,o){var l=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,i+(l?"":"$")+fr(d)+(u?"":"$")+Tr(f)}return function(i,a){return t=a,i.replace(e,r)}}(),lw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tF=function(){return function(t,r){return t.replace(lw,function(n,i,a,o,l,u){var f=Mp(o)-(a?0:r.c),d=Rp(u)-(l?0:r.r),m=d==0?"":l?d+1:"["+d+"]",g=f==0?"":a?f+1:"["+f+"]";return i+"R"+m+"C"+g})}}();function cw(e,t){return e.replace(lw,function(r,n,i,a,o,l){return n+(i=="$"?i+a:fr(Mp(a)+t.c))+(o=="$"?o+l:Tr(Rp(l)+t.r))})}function rF(e,t,r){var n=yo(t),i=n.s,a=Wr(r),o={r:a.r-i.r,c:a.c-i.c};return cw(e,o)}function nF(e){return e.length!=1}function px(e){return e.replace(/_xlfn\./g,"")}function rr(e){e.l+=1}function Sa(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function uw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return fw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=Sa(e),l=Sa(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function fw(e){var t=Sa(e),r=Sa(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function iF(e,t,r){if(r.biff<8)return fw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Sa(e),o=Sa(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function dw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return aF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Sa(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function aF(e){var t=Sa(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function sF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function oF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return lF(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:l}}function lF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function cF(e,t,r){var n=(e[e.l++]&96)>>5,i=uw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function uF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=uw(e,a,r);return[n,i,o]}function fF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function dF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function hF(e,t,r){var n=(e[e.l++]&96)>>5,i=iF(e,t-1,r);return[n,i]}function pF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function mx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function mF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function gF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function vF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function _F(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function hw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function yF(e){return e.read_shift(2),hw(e)}function wF(e){return e.read_shift(2),hw(e)}function kF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=dw(e,0,r);return[n,i]}function EF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=oF(e,0,r);return[n,i]}function TF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=dw(e,0,r);return[n,i,a]}function SF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[C6[i],gw[i],n]}function CF(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:AF(e);return[i,(a[0]===0?gw:S6)[a[1]]]}function AF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function NF(e,t,r){e.l+=r&&r.biff==2?3:4}function bF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function LF(e){return e.l++,ps[e.read_shift(1)]}function PF(e){return e.l++,e.read_shift(2)}function FF(e){return e.l++,e.read_shift(1)!==0}function OF(e){return e.l++,Or(e)}function RF(e,t,r){return e.l++,ic(e,t-1,r)}function MF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Yt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ps[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Or(e);break;case 2:r[1]=ms(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function IF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?hs:If)(e));return i}function DF(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=i;++l)o[a][l]=MF(e,r.biff);return o}function jF(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function BF(e,t,r){if(r.biff==5)return zF(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function zF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function UF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function HF(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function VF(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function WF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var $F=Dr,ZF=Dr,GF=Dr;function sc(e,t,r){return e.l+=2,[sF(e)]}function Vp(e){return e.l+=6,[]}var XF=sc,KF=Vp,qF=Vp,YF=sc;function pw(e){return e.l+=2,[ir(e),e.read_shift(2)&1]}var JF=sc,QF=pw,e6=Vp,t6=sc,r6=sc,n6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function i6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=n6[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function a6(e){return e.l+=2,[e.read_shift(4)]}function s6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function o6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function l6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function c6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function u6(e){return e.l+=4,[0,0]}var gx={1:{n:"PtgExp",f:bF},2:{n:"PtgTbl",f:GF},3:{n:"PtgAdd",f:rr},4:{n:"PtgSub",f:rr},5:{n:"PtgMul",f:rr},6:{n:"PtgDiv",f:rr},7:{n:"PtgPower",f:rr},8:{n:"PtgConcat",f:rr},9:{n:"PtgLt",f:rr},10:{n:"PtgLe",f:rr},11:{n:"PtgEq",f:rr},12:{n:"PtgGe",f:rr},13:{n:"PtgGt",f:rr},14:{n:"PtgNe",f:rr},15:{n:"PtgIsect",f:rr},16:{n:"PtgUnion",f:rr},17:{n:"PtgRange",f:rr},18:{n:"PtgUplus",f:rr},19:{n:"PtgUminus",f:rr},20:{n:"PtgPercent",f:rr},21:{n:"PtgParen",f:rr},22:{n:"PtgMissArg",f:rr},23:{n:"PtgStr",f:RF},26:{n:"PtgSheet",f:s6},27:{n:"PtgEndSheet",f:o6},28:{n:"PtgErr",f:LF},29:{n:"PtgBool",f:FF},30:{n:"PtgInt",f:PF},31:{n:"PtgNum",f:OF},32:{n:"PtgArray",f:pF},33:{n:"PtgFunc",f:SF},34:{n:"PtgFuncVar",f:CF},35:{n:"PtgName",f:jF},36:{n:"PtgRef",f:kF},37:{n:"PtgArea",f:cF},38:{n:"PtgMemArea",f:UF},39:{n:"PtgMemErr",f:$F},40:{n:"PtgMemNoMem",f:ZF},41:{n:"PtgMemFunc",f:HF},42:{n:"PtgRefErr",f:VF},43:{n:"PtgAreaErr",f:fF},44:{n:"PtgRefN",f:EF},45:{n:"PtgAreaN",f:hF},46:{n:"PtgMemAreaN",f:l6},47:{n:"PtgMemNoMemN",f:c6},57:{n:"PtgNameX",f:BF},58:{n:"PtgRef3d",f:TF},59:{n:"PtgArea3d",f:uF},60:{n:"PtgRefErr3d",f:WF},61:{n:"PtgAreaErr3d",f:dF},255:{}},f6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},d6={1:{n:"PtgElfLel",f:pw},2:{n:"PtgElfRw",f:t6},3:{n:"PtgElfCol",f:XF},6:{n:"PtgElfRwV",f:r6},7:{n:"PtgElfColV",f:YF},10:{n:"PtgElfRadical",f:JF},11:{n:"PtgElfRadicalS",f:e6},13:{n:"PtgElfColS",f:KF},15:{n:"PtgElfColSV",f:qF},16:{n:"PtgElfRadicalLel",f:QF},25:{n:"PtgList",f:i6},29:{n:"PtgSxName",f:a6},255:{}},h6={0:{n:"PtgAttrNoop",f:u6},1:{n:"PtgAttrSemi",f:_F},2:{n:"PtgAttrIf",f:xF},4:{n:"PtgAttrChoose",f:mF},8:{n:"PtgAttrGoto",f:gF},16:{n:"PtgAttrSum",f:NF},32:{n:"PtgAttrBaxcel",f:mx},33:{n:"PtgAttrBaxcel",f:mx},64:{n:"PtgAttrSpace",f:yF},65:{n:"PtgAttrSpaceSemi",f:wF},128:{n:"PtgAttrIfError",f:vF},255:{}};function oc(e,t,r,n){if(n.biff<8)return Dr(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=DF(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=IF(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(Dr(e,t)),a}function lc(e,t,r){for(var n=e.l+t,i,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],i=gx[a]||gx[f6[a]],(a===24||a===25)&&(i=(a===24?d6:h6)[e[e.l+1]]),!i||!i.f?Dr(e,t):o.push([i.n,i.f(e,t,r)]);return o}function p6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var m6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function g6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function mw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xx(e,t,r){var n=mw(e,t,r);return n=="#REF"?n:g6(n,r)}function Lr(e,t,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],u,f,d,m=0,g=0,_,y="";if(!e[0]||!e[0][0])return"";for(var v=-1,T="",k=0,E=e[0].length;k<E;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),v>=0){switch(e[0][v][1][0]){case 0:T=Xt(" ",e[0][v][1][1]);break;case 1:T=Xt("\r",e[0][v][1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}f=f+T,v=-1}l.push(f+m6[w[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=ul(w[1][1],o,i),l.push(fl(d,a));break;case"PtgRefN":d=r?ul(w[1][1],r,i):w[1][1],l.push(fl(d,a));break;case"PtgRef3d":m=w[1][1],d=ul(w[1][2],o,i),y=xx(n,m,i),l.push(y+"!"+fl(d,a));break;case"PtgFunc":case"PtgFuncVar":var P=w[1][0],I=w[1][1];P||(P=0),P&=127;var M=P==0?[]:l.slice(-P);l.length-=P,I==="User"&&(I=M.shift()),l.push(I+"("+M.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":_=Y1(w[1][1],r?{s:r}:o,i),l.push($0(_,i));break;case"PtgArea":_=Y1(w[1][1],o,i),l.push($0(_,i));break;case"PtgArea3d":m=w[1][1],_=w[1][2],y=xx(n,m,i),l.push(y+"!"+$0(_,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=w[1][2];var b=(n.names||[])[g-1]||(n[0]||[])[g],U=b?b.Name:"SH33TJSNAME"+String(g);U&&U.slice(0,6)=="_xlfn."&&!i.xlfn&&(U=U.slice(6)),l.push(U);break;case"PtgNameX":var j=w[1][1];g=w[1][2];var K;if(i.biff<=5)j<0&&(j=-j),n[j]&&(K=n[j][g]);else{var V="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][g]&&n[j][g].itab>0&&(V=n.SheetNames[n[j][g].itab-1]+"!"):V=n.SheetNames[g-1]+"!"),n[j]&&n[j][g])V+=n[j][g].Name;else if(n[0]&&n[0][g])V+=n[0][g].Name;else{var G=(mw(n,j,i)||"").split(";;");G[g-1]?V=G[g-1]:V+="SH33TJSERRX"}l.push(V);break}K||(K={Name:"SH33TJSERRY"}),l.push(K.Name);break;case"PtgParen":var de="(",Se=")";if(v>=0){switch(T="",e[0][v][1][0]){case 2:de=Xt(" ",e[0][v][1][1])+de;break;case 3:de=Xt("\r",e[0][v][1][1])+de;break;case 4:Se=Xt(" ",e[0][v][1][1])+Se;break;case 5:Se=Xt("\r",e[0][v][1][1])+Se;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}l.push(de+l.pop()+Se);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var ce={c:r.c,r:r.r};if(n.sharedf[Qe(d)]){var Y=n.sharedf[Qe(d)];l.push(Lr(Y,o,ce,n,i))}else{var xe=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(Lr(f[1],o,ce,n,i)),xe=!0;break}xe||l.push(w[1])}break;case"PtgArray":l.push("{"+p6(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&re.indexOf(e[0][k][0])==-1){w=e[0][v];var q=!0;switch(w[1][0]){case 4:q=!1;case 0:T=Xt(" ",w[1][1]);break;case 5:q=!1;case 1:T=Xt("\r",w[1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((q?T:"")+l.pop()+(q?"":T)),v=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function x6(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Dr(e,t-2)];var l=lc(e,o,r);return t!==o+i&&(a=oc(e,t-o-i,l,r)),e.l=n,[l,a]}function v6(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Dr(e,t-2)];var l=lc(e,o,r);return t!==o+i&&(a=oc(e,t-o-i,l,r)),e.l=n,[l,a]}function _6(e,t,r,n){var i=e.l+t,a=lc(e,n,r),o;return i!==e.l&&(o=oc(e,i-e.l,a,r)),[a,o]}function y6(e,t,r){var n=e.l+t,i,a=e.read_shift(2),o=lc(e,a,r);return a==65535?[[],Dr(e,t-2)]:(t!==a+2&&(i=oc(e,n-a-2,o,r)),[o,i])}function w6(e){var t;if(Ri(e,e.l+6)!==65535)return[Or(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function X0(e,t,r){var n=e.l+t,i=yi(e);r.biff==2&&++e.l;var a=w6(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=v6(e,n-e.l,r);return{cell:i,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function Df(e,t,r){var n=e.read_shift(4),i=lc(e,n,r),a=e.read_shift(4),o=a>0?oc(e,a,i,r):null;return[i,o]}var k6=Df,jf=Df,E6=Df,T6=Df,S6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},C6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function K0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var ml={},to={};function gl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function xw(e,t,r,n,i,a){try{n.cellNF&&(e.z=st[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=vr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(st[t]==null&&Xa(AA[t]||"General",t),e.t==="e")e.w=e.w||ps[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v);else if(e.t==="d"){var o=Gr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Dl(o)}else{if(e.v===void 0)return"";e.w=is(e.v,to)}else e.t==="d"?e.w=Mn(t,Gr(e.v),to):e.w=Mn(t,e.v,to)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=nf(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=nf(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function A6(e,t){var r=Kt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=yt(r))}var N6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,b6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,L6=/<(?:\w:)?hyperlink [^>]*>/mg,P6=/"(\w*:\w*)"/,F6=/<(?:\w:)?col\b[^>]*[\/]?>/g,O6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,R6=/<(?:\w:)?pageMargins[^>]*\/>/g,vw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,M6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,I6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function D6(e,t,r,n,i,a,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",m=e.match(b6);m?(f=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):f=d=e;var g=f.match(vw);g?Wp(g[0],l,i,r):(g=f.match(M6))&&j6(g[0],g[1]||"",l,i,r);var _=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var y=f.slice(_,_+50).match(P6);y&&A6(l,y[1])}var v=f.match(I6);v&&v[1]&&W6(v[1],i);var T=[];if(t.cellStyles){var k=f.match(F6);k&&U6(T,k)}m&&$6(m[1],l,t,u,a,o);var E=d.match(O6);E&&(l["!autofilter"]=H6(E[0]));var w=[],P=d.match(N6);if(P)for(_=0;_!=P.length;++_)w[_]=Kt(P[_].slice(P[_].indexOf('"')+1));var I=d.match(L6);I&&B6(l,I,n);var M=d.match(R6);if(M&&(l["!margins"]=z6(Ze(M[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=yt(u)),t.sheetRows>0&&l["!ref"]){var b=Kt(l["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>u.e.r&&(b.e.r=u.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>u.e.c&&(b.e.c=u.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),l["!fullref"]=l["!ref"],l["!ref"]=yt(b))}return T.length>0&&(l["!cols"]=T),w.length>0&&(l["!merges"]=w),l}function Wp(e,t,r,n){var i=Ze(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Et(Ft(i.codeName)))}function j6(e,t,r,n,i){Wp(e.slice(0,e.indexOf(">")),r,n,i)}function B6(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=Ze(Ft(t[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+Et(a.location))):(a.Target="#"+Et(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=Kt(a.ref),u=l.s.r;u<=l.e.r;++u)for(var f=l.s.c;f<=l.e.c;++f){var d=Qe({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function z6(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function U6(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Ze(t[n],!0);i.hidden&&(i.hidden=jt(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Hp(i.width)),uo(i);a<=o;)e[a++]=Er(i)}}function H6(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var V6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function W6(e,t){t.Views||(t.Views=[{}]),(e.match(V6)||[]).forEach(function(r,n){var i=Ze(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),jt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var $6=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=jl("v"),o=jl("f");return function(u,f,d,m,g,_){for(var y=0,v="",T=[],k=[],E=0,w=0,P=0,I="",M,b,U=0,j=0,K,V,G=0,de=0,Se=Array.isArray(_.CellXf),ce,Y=[],xe=[],re=Array.isArray(f),q=[],ae={},pe=!1,O=!!d.sheetStubs,J=u.split(t),X=0,W=J.length;X!=W;++X){v=J[X].trim();var ie=v.length;if(ie!==0){var we=0;e:for(y=0;y<ie;++y)switch(v[y]){case">":if(v[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(b=Ze(v.slice(we,y),!0),U=b.r!=null?parseInt(b.r,10):U+1,j=-1,d.sheetRows&&d.sheetRows<U)continue;ae={},pe=!1,b.ht&&(pe=!0,ae.hpt=parseFloat(b.ht),ae.hpx=Hl(ae.hpt)),b.hidden=="1"&&(pe=!0,ae.hidden=!0),b.outlineLevel!=null&&(pe=!0,ae.level=+b.outlineLevel),pe&&(q[U-1]=ae)}break;case"<":we=y;break}if(we>=y)break;if(b=Ze(v.slice(we,y),!0),U=b.r!=null?parseInt(b.r,10):U+1,j=-1,!(d.sheetRows&&d.sheetRows<U)){m.s.r>U-1&&(m.s.r=U-1),m.e.r<U-1&&(m.e.r=U-1),d&&d.cellStyles&&(ae={},pe=!1,b.ht&&(pe=!0,ae.hpt=parseFloat(b.ht),ae.hpx=Hl(ae.hpt)),b.hidden=="1"&&(pe=!0,ae.hidden=!0),b.outlineLevel!=null&&(pe=!0,ae.level=+b.outlineLevel),pe&&(q[U-1]=ae)),T=v.slice(y).split(e);for(var Le=0;Le!=T.length&&T[Le].trim().charAt(0)=="<";++Le);for(T=T.slice(Le),y=0;y!=T.length;++y)if(v=T[y].trim(),v.length!==0){if(k=v.match(r),E=y,w=0,P=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,k!=null&&k.length===2){for(E=0,I=k[1],w=0;w!=I.length&&!((P=I.charCodeAt(w)-64)<1||P>26);++w)E=26*E+P;--E,j=E}else++j;for(w=0;w!=v.length&&v.charCodeAt(w)!==62;++w);if(++w,b=Ze(v.slice(0,w),!0),b.r||(b.r=Qe({r:U-1,c:j})),I=v.slice(w),M={t:""},(k=I.match(a))!=null&&k[1]!==""&&(M.v=Et(k[1])),d.cellFormula){if((k=I.match(o))!=null&&k[1]!==""){if(M.f=Et(Ft(k[1])).replace(/\r\n/g,`
`),d.xlfn||(M.f=px(M.f)),k[0].indexOf('t="array"')>-1)M.F=(I.match(i)||[])[1],M.F.indexOf(":")>-1&&Y.push([Kt(M.F),M.F]);else if(k[0].indexOf('t="shared"')>-1){V=Ze(k[0]);var Ae=Et(Ft(k[1]));d.xlfn||(Ae=px(Ae)),xe[parseInt(V.si,10)]=[V,Ae,b.r]}}else(k=I.match(/<f[^>]*\/>/))&&(V=Ze(k[0]),xe[V.si]&&(M.f=rF(xe[V.si][1],xe[V.si][2],b.r)));var _e=Wr(b.r);for(w=0;w<Y.length;++w)_e.r>=Y[w][0].s.r&&_e.r<=Y[w][0].e.r&&_e.c>=Y[w][0].s.c&&_e.c<=Y[w][0].e.c&&(M.F=Y[w][1])}if(b.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(O)M.t="z";else continue;else M.t=b.t||"n";switch(m.s.c>j&&(m.s.c=j),m.e.c<j&&(m.e.c=j),M.t){case"n":if(M.v==""||M.v==null){if(!O)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!O)continue;M.t="z"}else K=ml[parseInt(M.v,10)],M.v=K.t,M.r=K.r,d.cellHTML&&(M.h=K.h);break;case"str":M.t="s",M.v=M.v!=null?Ft(M.v):"",d.cellHTML&&(M.h=Pp(M.v));break;case"inlineStr":k=I.match(n),M.t="s",k!=null&&(K=Up(k[1]))?(M.v=K.t,d.cellHTML&&(M.h=K.h)):M.v="";break;case"b":M.v=jt(M.v);break;case"d":d.cellDates?M.v=vr(M.v,1):(M.v=Gr(vr(M.v,1)),M.t="n");break;case"e":(!d||d.cellText!==!1)&&(M.w=M.v),M.v=B2[M.v];break}if(G=de=0,ce=null,Se&&b.s!==void 0&&(ce=_.CellXf[b.s],ce!=null&&(ce.numFmtId!=null&&(G=ce.numFmtId),d.cellStyles&&ce.fillId!=null&&(de=ce.fillId))),xw(M,G,de,d,g,_),d.cellDates&&Se&&M.t=="n"&&_o(st[G])&&(M.t="d",M.v=Mf(M.v)),b.cm&&d.xlmeta){var ze=(d.xlmeta.Cell||[])[+b.cm-1];ze&&ze.type=="XLDAPR"&&(M.D=!0)}if(re){var H=Wr(b.r);f[H.r]||(f[H.r]=[]),f[H.r][H.c]=M}else f[b.r]=M}}}}q.length>0&&(f["!rows"]=q)}}();function Z6(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var G6=hs;function X6(){}function K6(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=xN(e),r}function q6(e){var t=In(e);return[t]}function Y6(e){var t=ds(e);return[t]}function J6(e){var t=In(e),r=e.read_shift(1);return[t,r,"b"]}function Q6(e){var t=ds(e),r=e.read_shift(1);return[t,r,"b"]}function e5(e){var t=In(e),r=e.read_shift(1);return[t,r,"e"]}function t5(e){var t=ds(e),r=e.read_shift(1);return[t,r,"e"]}function r5(e){var t=In(e),r=e.read_shift(4);return[t,r,"s"]}function n5(e){var t=ds(e),r=e.read_shift(4);return[t,r,"s"]}function i5(e){var t=In(e),r=Or(e);return[t,r,"n"]}function _w(e){var t=ds(e),r=Or(e);return[t,r,"n"]}function a5(e){var t=In(e),r=jp(e);return[t,r,"n"]}function s5(e){var t=ds(e),r=jp(e);return[t,r,"n"]}function o5(e){var t=In(e),r=Ip(e);return[t,r,"is"]}function l5(e){var t=In(e),r=Mr(e);return[t,r,"str"]}function c5(e){var t=ds(e),r=Mr(e);return[t,r,"str"]}function u5(e,t,r){var n=e.l+t,i=In(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var l=jf(e,n-e.l,r);o[3]=Lr(l,null,i,r.supbooks,r)}else e.l=n;return o}function f5(e,t,r){var n=e.l+t,i=In(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var l=jf(e,n-e.l,r);o[3]=Lr(l,null,i,r.supbooks,r)}else e.l=n;return o}function d5(e,t,r){var n=e.l+t,i=In(e);i.r=r["!row"];var a=Or(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var l=jf(e,n-e.l,r);o[3]=Lr(l,null,i,r.supbooks,r)}else e.l=n;return o}function h5(e,t,r){var n=e.l+t,i=In(e);i.r=r["!row"];var a=Mr(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var l=jf(e,n-e.l,r);o[3]=Lr(l,null,i,r.supbooks,r)}else e.l=n;return o}var p5=hs;function m5(e,t){var r=e.l+t,n=hs(e),i=Dp(e),a=Mr(e),o=Mr(e),l=Mr(e);e.l=r;var u={rfx:n,relId:i,loc:a,display:l};return o&&(u.Tooltip=o),u}function g5(){}function x5(e,t,r){var n=e.l+t,i=I2(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var l=k6(e,n-e.l,r);o[1]=l}else e.l=n;return o}function v5(e,t,r){var n=e.l+t,i=hs(e),a=[i];if(r.cellFormula){var o=T6(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}var _5=["left","right","top","bottom","header","footer"];function y5(e){var t={};return _5.forEach(function(r){t[r]=Or(e)}),t}function w5(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function k5(){}function E5(){}function T5(e,t,r,n,i,a,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,_,y,v,T,k,E,w,P,I,M=[];l.biff=12,l["!row"]=0;var b=0,U=!1,j=[],K={},V=l.supbooks||i.supbooks||[[]];if(V.sharedf=K,V.arrayf=j,V.SheetNames=i.SheetNames||i.Sheets.map(function(re){return re.name}),!l.supbooks&&(l.supbooks=V,i.Names))for(var G=0;G<i.Names.length;++G)V[0][G+1]=i.Names[G];var de=[],Se=[],ce=!1;of[16]={n:"BrtShortReal",f:_w};var Y;if(Xi(e,function(q,ae,pe){if(!g)switch(pe){case 148:f=q;break;case 0:_=q,l.sheetRows&&l.sheetRows<=_.r&&(g=!0),P=Tr(T=_.r),l["!row"]=_.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=Hl(q.hpt)),Se[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:q[2]},q[2]){case"n":y.v=q[1];break;case"s":w=ml[q[1]],y.v=w.t,y.r=w.r;break;case"b":y.v=!!q[1];break;case"e":y.v=q[1],l.cellText!==!1&&(y.w=ps[y.v]);break;case"str":y.t="s",y.v=q[1];break;case"is":y.t="s",y.v=q[1].t;break}if((v=o.CellXf[q[0].iStyleRef])&&xw(y,v.numFmtId,null,l,a,o),k=q[0].c==-1?k+1:q[0].c,l.dense?(u[T]||(u[T]=[]),u[T][k]=y):u[fr(k)+P]=y,l.cellFormula){for(U=!1,b=0;b<j.length;++b){var O=j[b];_.r>=O[0].s.r&&_.r<=O[0].e.r&&k>=O[0].s.c&&k<=O[0].e.c&&(y.F=yt(O[0]),U=!0)}!U&&q.length>3&&(y.f=q[3])}if(d.s.r>_.r&&(d.s.r=_.r),d.s.c>k&&(d.s.c=k),d.e.r<_.r&&(d.e.r=_.r),d.e.c<k&&(d.e.c=k),l.cellDates&&v&&y.t=="n"&&_o(st[v.numFmtId])){var J=Wa(y.v);J&&(y.t="d",y.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Y&&(Y.type=="XLDAPR"&&(y.D=!0),Y=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;y={t:"z",v:void 0},k=q[0].c==-1?k+1:q[0].c,l.dense?(u[T]||(u[T]=[]),u[T][k]=y):u[fr(k)+P]=y,d.s.r>_.r&&(d.s.r=_.r),d.s.c>k&&(d.s.c=k),d.e.r<_.r&&(d.e.r=_.r),d.e.c<k&&(d.e.c=k),Y&&(Y.type=="XLDAPR"&&(y.D=!0),Y=void 0);break;case 176:M.push(q);break;case 49:Y=((l.xlmeta||{}).Cell||[])[q-1];break;case 494:var X=n["!id"][q.relId];for(X?(q.Target=X.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=X):q.relId==""&&(q.Target="#"+q.loc),T=q.rfx.s.r;T<=q.rfx.e.r;++T)for(k=q.rfx.s.c;k<=q.rfx.e.c;++k)l.dense?(u[T]||(u[T]=[]),u[T][k]||(u[T][k]={t:"z",v:void 0}),u[T][k].l=q):(E=Qe({c:k,r:T}),u[E]||(u[E]={t:"z",v:void 0}),u[E].l=q);break;case 426:if(!l.cellFormula)break;j.push(q),I=l.dense?u[T][k]:u[fr(k)+P],I.f=Lr(q[1],d,{r:_.r,c:k},V,l),I.F=yt(q[0]);break;case 427:if(!l.cellFormula)break;K[Qe(q[0].s)]=q[1],I=l.dense?u[T][k]:u[fr(k)+P],I.f=Lr(q[1],d,{r:_.r,c:k},V,l);break;case 60:if(!l.cellStyles)break;for(;q.e>=q.s;)de[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},ce||(ce=!0,Hp(q.w/256)),uo(de[q.e+1]);break;case 161:u["!autofilter"]={ref:yt(q)};break;case 476:u["!margins"]=q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),q.name&&(i.Sheets[r].CodeName=q.name),(q.above||q.left)&&(u["!outline"]={above:q.above,left:q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!ae.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+pe.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=yt(f||d)),l.sheetRows&&u["!ref"]){var xe=Kt(u["!ref"]);l.sheetRows<=+xe.e.r&&(xe.e.r=l.sheetRows-1,xe.e.r>d.e.r&&(xe.e.r=d.e.r),xe.e.r<xe.s.r&&(xe.s.r=xe.e.r),xe.e.c>d.e.c&&(xe.e.c=d.e.c),xe.e.c<xe.s.c&&(xe.s.c=xe.e.c),u["!fullref"]=u["!ref"],u["!ref"]=yt(xe))}return M.length>0&&(u["!merges"]=M),de.length>0&&(u["!cols"]=de),Se.length>0&&(u["!rows"]=Se),u}function S5(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function C5(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var l=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=S5(m);d.s.r=d.s.c=0,d.e.c=l,f=fr(l),g[0].forEach(function(_,y){o[f+Tr(y)]={t:"n",v:_,z:g[1]},u=y}),d.e.r<u&&(d.e.r=u),++l}),l>0&&(o["!ref"]=yt(d)),o}function A5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(vw);return l&&Wp(l[0],a,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function N5(e,t){e.l+=10;var r=Mr(e);return{name:r}}function b5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Xi(e,function(u,f,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var yw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],L5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],P5=[],F5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _x(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=jt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function yx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=jt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ww(e){yx(e.WBProps,yw),yx(e.CalcPr,F5),_x(e.WBView,L5),_x(e.Sheets,P5),to.date1904=jt(e.WBProps.date1904)}var O5="][*?/\\".split("");function R5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return O5.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var M5=/<\w+:workbook/;function I5(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(jr,function(u,f){var d=Ze(u);switch(_i(d[0])){case"<?xml":break;case"<workbook":u.match(M5)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":yw.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=jt(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=Ft(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Et(Ft(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Ft(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),jt(d.hidden||"0")&&(a.Hidden=!0),o=f+u.length;break;case"</definedName>":a.Ref=Et(Ft(e.slice(o,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),eN.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ww(r),r}function D5(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ih(e),r.name=Mr(e),r}function j5(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Mr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function B5(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function z5(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=vN(e),o=E6(e,0,r),l=Dp(e);e.l=n;var u={Name:a,Ptg:o};return i<268435455&&(u.Sheet=i),l&&(u.Comment=l),u}function U5(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],of[16]={n:"BrtFRTArchID$",f:B5},Xi(e,function(u,f,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Lr(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),ww(r),r.Names=a,r.supbooks=o,r}function H5(e,t,r){return t.slice(-4)===".bin"?U5(e,r):I5(e,r)}function V5(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?T5(e,n,r,i,a,o,l):D6(e,n,r,i,a,o,l)}function W5(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?b5(e,n,r,i,a):A5(e,n,r,i,a)}function $5(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?QP():eF()}function Z5(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?YP():JP()}function G5(e,t,r,n){return t.slice(-4)===".bin"?pP(e,r,n):lP(e,r,n)}function X5(e,t,r){return ow(e,r)}function K5(e,t,r){return t.slice(-4)===".bin"?LL(e,r):NL(e,r)}function q5(e,t,r){return t.slice(-4)===".bin"?XP(e,r):VP(e,r)}function Y5(e,t,r){return t.slice(-4)===".bin"?zP(e):jP(e)}function J5(e,t,r,n){return r.slice(-4)===".bin"?UP(e,t,r,n):void 0}function Q5(e,t,r){return t.slice(-4)===".bin"?IP(e,t,r):DP(e,t,r)}var kw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ew=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Un(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(kw),a,o,l,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(Ew),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function e8(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(kw),i,a,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(Ew),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var xl;function t8(e,t){var r=xl[e]||Et(e);return r==="General"?is(t):Mn(r,t)}function r8(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=jt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Et(t)]=i}function n8(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ps[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v):e.w=is(e.v):e.w=t8(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=xl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&_o(n)){var i=Wa(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function i8(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=rP[n.Pattern]||n.Pattern)}e[t.ID]=t}function a8(e,t,r,n,i,a,o,l,u,f){var d="General",m=n.StyleID,g={};f=f||{};var _=[],y=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);a[m]!==void 0&&(a[m].nf&&(d=a[m].nf),a[m].Interior&&_.push(a[m].Interior),!!a[m].Parent);)m=a[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=jt(e);break;case"String":n.t="s",n.r=H1(Et(e)),n.v=e.indexOf("<")>-1?Et(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(vr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Et(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=B2[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=H1(t||e));break}if(n8(n,d,f),f.cellFormula!==!1)if(n.Formula){var v=Et(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=eo(v,i),delete n.Formula,n.ArrayRange=="RC"?n.F=eo("RC:RC",i):n.ArrayRange&&(n.F=eo(n.ArrayRange,i),u.push([Kt(n.F),n.F]))}else for(y=0;y<u.length;++y)i.r>=u[y][0].s.r&&i.r<=u[y][0].e.r&&i.c>=u[y][0].s.c&&i.c<=u[y][0].e.c&&(n.F=u[y][1]);f.cellStyles&&(_.forEach(function(T){!g.patternType&&T.patternType&&(g.patternType=T.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function s8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function q0(e,t){var r=t||{};f2();var n=Ko(Fp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ft(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Er(r);return o.type="string",zl.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(le){i.indexOf("<"+le)>=0&&(a=!0)}),a)return m8(n,r);xl={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],f,d={},m=[],g=r.dense?[]:{},_="",y={},v={},T=Un('<Data ss:Type="String">'),k=0,E=0,w=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},M={},b="",U=0,j=[],K={},V={},G=0,de=[],Se=[],ce={},Y=[],xe,re=!1,q=[],ae=[],pe={},O=0,J=0,X={Sheets:[],WBProps:{date1904:!1}},W={};Bl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";l=Bl.exec(n);)switch(l[3]=(ie=l[3]).toLowerCase()){case"data":if(ie=="data"){if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?a8(n.slice(k,l.index),b,T,u[u.length-1][0]=="comment"?ce:y,{c:E,r:w},I,Y[E],v,q,r):(b="",T=Un(l[0]),k=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Se.length>0&&(y.c=Se),(!r.sheetRows||r.sheetRows>w)&&y.v!==void 0&&(r.dense?(g[w]||(g[w]=[]),g[w][E]=y):g[fr(E)+Tr(w)]=y),y.HRef&&(y.l={Target:Et(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(O=E+(parseInt(y.MergeAcross,10)|0),J=w+(parseInt(y.MergeDown,10)|0),j.push({s:{c:E,r:w},e:{c:O,r:J}})),!r.sheetStubs)y.MergeAcross?E=O+1:++E;else if(y.MergeAcross||y.MergeDown){for(var we=E;we<=O;++we)for(var Le=w;Le<=J;++Le)(we>E||Le>w)&&(r.dense?(g[Le]||(g[Le]=[]),g[Le][we]={t:"z"}):g[fr(we)+Tr(Le)]={t:"z"});E=O+1}else++E;else y=e8(l[0]),y.Index&&(E=+y.Index-1),E<P.s.c&&(P.s.c=E),E>P.e.c&&(P.e.c=E),l[0].slice(-2)==="/>"&&++E,Se=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<P.s.r&&(P.s.r=w),w>P.e.r&&(P.e.r=w),l[0].slice(-2)==="/>"&&(v=Un(l[0]),v.Index&&(w=+v.Index-1)),E=0,++w):(v=Un(l[0]),v.Index&&(w=+v.Index-1),pe={},(v.AutoFitHeight=="0"||v.Height)&&(pe.hpx=parseInt(v.Height,10),pe.hpt=sw(pe.hpx),ae[w]=pe),v.Hidden=="1"&&(pe.hidden=!0,ae[w]=pe));break;case"worksheet":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));m.push(_),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(g["!ref"]=yt(P),r.sheetRows&&r.sheetRows<=P.e.r&&(g["!fullref"]=g["!ref"],P.e.r=r.sheetRows-1,g["!ref"]=yt(P))),j.length&&(g["!merges"]=j),Y.length>0&&(g["!cols"]=Y),ae.length>0&&(g["!rows"]=ae),d[_]=g}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=E=0,u.push([l[3],!1]),f=Un(l[0]),_=Et(f.Name),g=r.dense?[]:{},j=[],q=[],ae=[],W={name:_,Hidden:0},X.Sheets.push(W);break;case"table":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),Y=[],re=!1}break;case"style":l[1]==="/"?i8(I,M,r):M=Un(l[0]);break;case"numberformat":M.nf=Et(Un(l[0]).Format||"General"),xl[M.nf]&&(M.nf=xl[M.nf]);for(var Ae=0;Ae!=392&&st[Ae]!=M.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(st[Ae]==null){Xa(M.nf,Ae);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(xe=Un(l[0]),xe.Hidden&&(xe.hidden=!0,delete xe.Hidden),xe.Width&&(xe.wpx=parseInt(xe.Width,10)),!re&&xe.wpx>10){re=!0,Vr=iw;for(var _e=0;_e<Y.length;++_e)Y[_e]&&uo(Y[_e])}re&&uo(xe),Y[xe.Index-1||Y.length]=xe;for(var ze=0;ze<+xe.Span;++ze)Y[Y.length]=Er(xe);break;case"namedrange":if(l[1]==="/")break;X.Names||(X.Names=[]);var H=Ze(l[0]),Ye={Name:H.Name,Ref:eo(H.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(Ye.Sheet=X.Sheets.length-1),X.Names.push(Ye);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?b+=n.slice(U,l.index):U=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;M.Interior=Un(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?VN(K,ie,n.slice(G,l.index)):G=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));s8(ce),Se.push(ce)}else u.push([l[3],!1]),f=Un(l[0]),ce={a:f.Author};break;case"autofilter":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var rt=Un(l[0]);g["!autofilter"]={ref:eo(rt.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return Cx(n,r);var et=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(l[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:et=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(G,l.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else G=l.index+l[0].length;break;case"header":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+Ze(l[0]).Margin)||(g["!margins"].header=+Ze(l[0]).Margin);break;case"footer":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+Ze(l[0]).Margin)||(g["!margins"].footer=+Ze(l[0]).Margin);break;case"pagemargins":var Ge=Ze(l[0]);g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+Ge.Top)||(g["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(g["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(g["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(g["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:et=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:et=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:et=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:et=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1;break}if(et||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?r8(V,ie,de,n.slice(G,l.index)):(de=l,G=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var Ne={};return!r.bookSheets&&!r.bookProps&&(Ne.Sheets=d),Ne.SheetNames=m,Ne.Workbook=X,Ne.SSF=Er(st),Ne.Props=K,Ne.Custprops=V,Ne}function lh(e,t){switch(Gp(t=t||{}),t.type||"base64"){case"base64":return q0(mn(e),t);case"binary":case"buffer":case"file":return q0(e,t);case"array":return q0(fs(e),t)}}function o8(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=wN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=kN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var l8=[60,1084,2066,2165,2175];function c8(e,t,r,n,i){var a=n,o=[],l=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=a;for(var u=Ri(r,r.l),f=ch[u],d=0;f!=null&&l8.indexOf(u)>-1;)a=Ri(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),l=r.slice(d,r.l+4+a),o.push(l),r.l+=4+a,f=ch[u=Ri(r,r.l)];var m=aa(o);wr(m,0);var g=0;m.lens=[];for(var _=0;_<o.length;++_)m.lens.push(g),g+=o[_].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,i)}function ui(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=st[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ps[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v):e.w=is(e.v):e.w=Mn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&_o(st[n]||String(n))){var i=Wa(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function eu(e,t,r){return{v:e,ixfe:t,t:r}}function u8(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},o={},l=null,u=[],f="",d={},m,g="",_,y,v,T,k={},E=[],w,P,I=[],M=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},j=function(Xe){return Xe<8?Ka[Xe]:Xe<64&&M[Xe-8]||Ka[Xe]},K=function(Xe,fe,ge){var Ee=fe.XF.data;if(!(!Ee||!Ee.patternType||!ge||!ge.cellStyles)){fe.s={},fe.s.patternType=Ee.patternType;var Oe;(Oe=Ul(j(Ee.icvFore)))&&(fe.s.fgColor={rgb:Oe}),(Oe=Ul(j(Ee.icvBack)))&&(fe.s.bgColor={rgb:Oe})}},V=function(Xe,fe,ge){if(!(pe>1)&&!(ge.sheetRows&&Xe.r>=ge.sheetRows)){if(ge.cellStyles&&fe.XF&&fe.XF.data&&K(Xe,fe,ge),delete fe.ixfe,delete fe.XF,m=Xe,g=Qe(Xe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<o.s.r&&(o.s.r=Xe.r),Xe.c<o.s.c&&(o.s.c=Xe.c),Xe.r+1>o.e.r&&(o.e.r=Xe.r+1),Xe.c+1>o.e.c&&(o.e.c=Xe.c+1),ge.cellFormula&&fe.f){for(var Ee=0;Ee<E.length;++Ee)if(!(E[Ee][0].s.c>Xe.c||E[Ee][0].s.r>Xe.r)&&!(E[Ee][0].e.c<Xe.c||E[Ee][0].e.r<Xe.r)){fe.F=yt(E[Ee][0]),(E[Ee][0].s.c!=Xe.c||E[Ee][0].s.r!=Xe.r)&&delete fe.f,fe.f&&(fe.f=""+Lr(E[Ee][1],o,Xe,q,G));break}}ge.dense?(i[Xe.r]||(i[Xe.r]=[]),i[Xe.r][Xe.c]=fe):i[g]=fe}},G={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(G.password=t.password);var de,Se=[],ce=[],Y=[],xe=[],re=!1,q=[];q.SheetNames=G.snames,q.sharedf=G.sharedf,q.arrayf=G.arrayf,q.names=[],q.XTI=[];var ae=0,pe=0,O=0,J=[],X=[],W;G.codepage=1200,Gn(1200);for(var ie=!1;e.l<e.length-1;){var we=e.l,Le=e.read_shift(2);if(Le===0&&ae===10)break;var Ae=e.l===e.length?0:e.read_shift(2),_e=ch[Le];if(_e&&_e.f){if(t.bookSheets&&ae===133&&Le!==133)break;if(ae=Le,_e.r===2||_e.r==12){var ze=e.read_shift(2);if(Ae-=2,!G.enc&&ze!==Le&&((ze&255)<<8|ze>>8)!==Le)throw new Error("rt mismatch: "+ze+"!="+Le);_e.r==12&&(e.l+=10,Ae-=10)}var H={};if(Le===10?H=_e.f(e,Ae,G):H=c8(Le,_e,e,Ae,G),pe==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(Le){case 34:r.opts.Date1904=b.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(G.enc||(e.l=0),G.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:G.lastuser=H;break;case 66:var Ye=Number(H);switch(Ye){case 21010:Ye=1200;break;case 32768:Ye=1e4;break;case 32769:Ye=1252;break}Gn(G.codepage=Ye),ie=!0;break;case 317:G.rrtabid=H;break;case 25:G.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:G.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:I.push(H);break;case 430:q.push([H]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(H);break;case 24:case 536:W={Name:H.Name,Ref:Lr(H.rgce,o,null,q,G)},H.itab>0&&(W.Sheet=H.itab-1),q.names.push(W),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(X[H.itab-1]={ref:yt(H.rgce[0][0][1][2])});break;case 22:G.ExternCount=H;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(H),q.XTI=q.XTI.concat(H);break;case 2196:if(G.biff<8)break;W!=null&&(W.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&G.WTF&&console.error("Password verifier: "+H);break;case 133:a[H.pos]=H,G.snames.push(H.name);break;case 10:{if(--pe)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=yt(o),t.sheetRows&&t.sheetRows<=o.e.r){var rt=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=yt(o),o.e.r=rt}o.e.r++,o.e.c++}Se.length>0&&(i["!merges"]=Se),ce.length>0&&(i["!objects"]=ce),Y.length>0&&(i["!cols"]=Y),xe.length>0&&(i["!rows"]=xe),b.Sheets.push(U)}f===""?d=i:n[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(G.biff===8&&(G.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),G.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(G.biff=5,ie=!0,Gn(G.codepage=28591)),G.biff==8&&H.BIFFVer==0&&H.dt==16&&(G.biff=2),pe++)break;if(i=t.dense?[]:{},G.biff<8&&!ie&&(ie=!0,Gn(G.codepage=t.codepage||1252)),G.biff<5||H.BIFFVer==0&&H.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var et={pos:e.l-Ae,name:f};a[et.pos]=et,G.snames.push(f)}else f=(a[we]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),Se=[],ce=[],G.arrayf=E=[],Y=[],xe=[],re=!1,U={Hidden:(a[we]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[H.r]||[])[H.c]:i[Qe({c:H.c,r:H.r})])&&++H.c,w={ixfe:H.ixfe,XF:I[H.ixfe]||{},v:H.val,t:"n"},O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:H.c,r:H.r},w,t);break;case 5:case 517:w={ixfe:H.ixfe,XF:I[H.ixfe],v:H.val,t:H.t},O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:H.c,r:H.r},w,t);break;case 638:w={ixfe:H.ixfe,XF:I[H.ixfe],v:H.rknum,t:"n"},O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:H.c,r:H.r},w,t);break;case 189:for(var Ge=H.c;Ge<=H.C;++Ge){var Ne=H.rkrec[Ge-H.c][0];w={ixfe:Ne,XF:I[Ne],v:H.rkrec[Ge-H.c][1],t:"n"},O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:Ge,r:H.r},w,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){l=H;break}if(w=eu(H.val,H.cell.ixfe,H.tt),w.XF=I[w.ixfe],t.cellFormula){var le=H.formula;if(le&&le[0]&&le[0][0]&&le[0][0][0]=="PtgExp"){var Pe=le[0][0][1][0],Fe=le[0][0][1][1],Ue=Qe({r:Pe,c:Fe});k[Ue]?w.f=""+Lr(H.formula,o,H.cell,q,G):w.F=((t.dense?(i[Pe]||[])[Fe]:i[Ue])||{}).F}else w.f=""+Lr(H.formula,o,H.cell,q,G)}O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V(H.cell,w,t),l=H}break;case 7:case 519:if(l)l.val=H,w=eu(H,l.cell.ixfe,"s"),w.XF=I[w.ixfe],t.cellFormula&&(w.f=""+Lr(l.formula,o,l.cell,q,G)),O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(H);var nt=Qe(H[0].s);if(_=t.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[nt],t.cellFormula&&_){if(!l||!nt||!_)break;_.f=""+Lr(H[1],o,H[0],q,G),_.F=yt(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!l)break;k[Qe(l.cell)]=H[0],_=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Qe(l.cell)],(_||{}).f=""+Lr(H[0],o,m,q,G)}}break;case 253:w=eu(u[H.isst].t,H.ixfe,"s"),u[H.isst].h&&(w.h=u[H.isst].h),w.XF=I[w.ixfe],O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:H.c,r:H.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:H.ixfe,XF:I[H.ixfe],t:"z"},O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:H.c,r:H.r},w,t));break;case 190:if(t.sheetStubs)for(var tt=H.c;tt<=H.C;++tt){var Ve=H.ixfe[tt-H.c];w={ixfe:Ve,XF:I[Ve],t:"z"},O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:tt,r:H.r},w,t)}break;case 214:case 516:case 4:w=eu(H.val,H.ixfe,"s"),w.XF=I[w.ixfe],O>0&&(w.z=J[w.ixfe>>8&63]),ui(w,t,r.opts.Date1904),V({c:H.c,r:H.r},w,t);break;case 0:case 512:pe===1&&(o=H);break;case 252:u=H;break;case 1054:if(G.biff==4){J[O++]=H[1];for(var Ot=0;Ot<O+163&&st[Ot]!=H[1];++Ot);Ot>=163&&Xa(H[1],O+163)}else Xa(H[1],H[0]);break;case 30:{J[O++]=H;for(var bt=0;bt<O+163&&st[bt]!=H;++bt);bt>=163&&Xa(H,O+163)}break;case 229:Se=Se.concat(H);break;case 93:ce[H.cmo[0]]=G.lastobj=H;break;case 438:G.lastobj.TxO=H;break;case 127:G.lastobj.ImData=H;break;case 440:for(T=H[0].s.r;T<=H[0].e.r;++T)for(v=H[0].s.c;v<=H[0].e.c;++v)_=t.dense?(i[T]||[])[v]:i[Qe({c:v,r:T})],_&&(_.l=H[1]);break;case 2048:for(T=H[0].s.r;T<=H[0].e.r;++T)for(v=H[0].s.c;v<=H[0].e.c;++v)_=t.dense?(i[T]||[])[v]:i[Qe({c:v,r:T})],_&&_.l&&(_.l.Tooltip=H[1]);break;case 28:{if(G.biff<=5&&G.biff>=2)break;_=t.dense?(i[H[0].r]||[])[H[0].c]:i[Qe(H[0])];var sr=ce[H[2]];_||(t.dense?(i[H[0].r]||(i[H[0].r]=[]),_=i[H[0].r][H[0].c]={t:"z"}):_=i[Qe(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),_.c||(_.c=[]),y={a:H[1],t:sr.TxO.t},_.c.push(y)}break;case 2173:FP(I[H.ixfe],H.ext);break;case 125:{if(!G.cellStyles)break;for(;H.e>=H.s;)Y[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},re||(re=!0,Hp(H.w/256)),uo(Y[H.e+1])}break;case 520:{var Ct={};H.level!=null&&(xe[H.r]=Ct,Ct.level=H.level),H.hidden&&(xe[H.r]=Ct,Ct.hidden=!0),H.hpt&&(xe[H.r]=Ct,Ct.hpt=H.hpt,Ct.hpx=Hl(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||gl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=H;break;case 161:i["!margins"]||gl(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(b.Views[0].RTL=!0);break;case 146:M=H;break;case 2198:de=H;break;case 140:P=H;break;case 442:f?U.CodeName=H||U.name:b.WBProps.CodeName=H||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),e.l+=Ae}return r.SheetNames=vi(a).sort(function($t,Xe){return Number($t)-Number(Xe)}).map(function($t){return a[$t].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&X.forEach(function($t,Xe){r.Sheets[r.SheetNames[Xe]]["!autofilter"]=$t}),r.Strings=u,r.SSF=Er(st),G.enc&&(r.Encryption=G.enc),de&&(r.Themes=de),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),q.names.length>0&&(b.Names=q.names),r.Workbook=b,r}var wx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function f8(e,t,r){var n=_t.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ix(n,NN,wx.DSI);for(var a in i)t[a]=i[a]}catch(f){if(r.WTF)throw f}var o=_t.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=ix(o,bN,wx.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(U2(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Tw(e,t){t||(t={}),Gp(t),Qy(),t.codepage&&Sp(t.codepage);var r,n;if(e.FullPaths){if(_t.find(e,"/encryption"))throw new Error("File is password-protected");r=_t.find(e,"!CompObj"),n=_t.find(e,"/Workbook")||_t.find(e,"/Book")}else{switch(t.type){case"base64":e=Zn(mn(e));break;case"binary":e=Zn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var i,a;if(r&&o8(r),t.bookProps&&!t.bookSheets)i={};else{var o=xt?"buffer":"array";if(n&&n.content)i=u8(n.content,t);else if((a=_t.find(e,"PerfectOffice_MAIN"))&&a.content)i=pl.to_workbook(a.content,(t.type=o,t));else if((a=_t.find(e,"NativeContent_MAIN"))&&a.content)i=pl.to_workbook(a.content,(t.type=o,t));else throw(a=_t.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&_t.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=qP(e))}var l={};return e.FullPaths&&f8(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}var of={0:{f:Z6},1:{f:q6},2:{f:a5},3:{f:e5},4:{f:J6},5:{f:i5},6:{f:l5},7:{f:r5},8:{f:h5},9:{f:d5},10:{f:u5},11:{f:f5},12:{f:Y6},13:{f:s5},14:{f:t5},15:{f:Q6},16:{f:_w},17:{f:c5},18:{f:n5},19:{f:Ip},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:z5},40:{},42:{},43:{f:uP},44:{f:cP},45:{f:fP},46:{f:hP},47:{f:dP},48:{},49:{f:pN},50:{},51:{f:RP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Q2},62:{f:o5},63:{f:BP},64:{f:k5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Dr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:w5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:K6},148:{f:G6,p:16},151:{f:g5},152:{},153:{f:j5},154:{},155:{},156:{f:D5},157:{},158:{},159:{T:1,f:bL},160:{T:-1},161:{T:1,f:hs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:p5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:OP},336:{T:-1},337:{f:MP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ih},357:{},358:{},359:{},360:{T:1},361:{},362:{f:J2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:x5},427:{f:v5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:y5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:X6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:m5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ih},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:GP},633:{T:1},634:{T:-1},635:{T:1,f:ZP},636:{T:-1},637:{f:gN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:N5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:E5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ch={6:{f:X0},10:{f:Qi},12:{f:ir},13:{f:ir},14:{f:Yt},15:{f:Yt},16:{f:Or},17:{f:Yt},18:{f:Yt},19:{f:ir},20:{f:lx},21:{f:lx},23:{f:J2},24:{f:ux},25:{f:Yt},26:{},27:{},28:{f:Wb},29:{},34:{f:Yt},35:{f:cx},38:{f:Or},39:{f:Or},40:{f:Or},41:{f:Or},42:{f:Yt},43:{f:Yt},47:{f:XL},49:{f:Sb},51:{f:ir},60:{},61:{f:kb},64:{f:Yt},65:{f:Tb},66:{f:ir},77:{},80:{},81:{},82:{},85:{f:ir},89:{},90:{},91:{},92:{f:pb},93:{f:Zb},94:{},95:{f:Yt},96:{},97:{},99:{f:Yt},125:{f:Q2},128:{f:Mb},129:{f:mb},130:{f:ir},131:{f:Yt},132:{f:Yt},133:{f:gb},134:{},140:{f:Jb},141:{f:ir},144:{},146:{f:eL},151:{},152:{},153:{},154:{},155:{},156:{f:ir},157:{},158:{},160:{f:aL},161:{f:rL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Pb},190:{f:Fb},193:{f:Qi},197:{},198:{},199:{},200:{},201:{},202:{f:Yt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ir},220:{},221:{f:Yt},222:{},224:{f:Rb},225:{f:hb},226:{f:Qi},227:{},229:{f:$b},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:xb},253:{f:Cb},255:{f:vb},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Z2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Yt},353:{f:Qi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Db},431:{f:Yt},432:{},433:{},434:{},437:{},438:{f:Kb},439:{f:Yt},440:{f:qb},441:{},442:{f:ac},443:{},444:{f:ir},445:{},446:{},448:{f:Qi},449:{f:wb,r:2},450:{f:Qi},512:{f:sx},513:{f:iL},515:{f:Ib},516:{f:Ab},517:{f:ox},519:{f:sL},520:{f:_b},523:{},545:{f:fx},549:{f:ax},566:{},574:{f:Eb},638:{f:Lb},659:{},1048:{},1054:{f:Nb},1084:{},1212:{f:Ub},2048:{f:Yb},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Yc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tL,r:12},2173:{f:PP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Yt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:zb,r:12},2197:{},2198:{f:SP,r:12},2199:{},2200:{},2201:{},2202:{f:Hb,r:12},2203:{f:Qi},2204:{},2205:{},2206:{},2207:{},2211:{f:yb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ir},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:nL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Qb},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sx},1:{},2:{f:uL},3:{f:cL},4:{f:lL},5:{f:ox},7:{f:fL},8:{},9:{f:Yc},11:{},22:{f:ir},30:{f:bb},31:{},32:{},33:{f:fx},36:{},37:{f:ax},50:{f:dL},62:{},52:{},67:{},68:{f:ir},69:{},86:{},126:{},127:{f:oL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hL},223:{},234:{},354:{},421:{},518:{f:X0},521:{f:Yc},536:{f:ux},547:{f:cx},561:{},579:{},1030:{f:X0},1033:{f:Yc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Hn(e,t,r,n){var i=t;if(!isNaN(i)){var a=(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&O2(r)&&e.push(r)}}function kx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,l=a&&a.index||e.length,u=IA(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,m=0,g=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<u.length;++o){var v=u[o].trim(),T=v.slice(0,3).toLowerCase();if(T=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(T!="<td"&&T!="<th")){var k=v.split(/<\/t[dh]>/i);for(l=0;l<k.length;++l){var E=k[l].trim();if(E.match(/<t[dh]/i)){for(var w=E,P=0;w.charAt(0)=="<"&&(P=w.indexOf(">"))>-1;)w=w.slice(P+1);for(var I=0;I<y.length;++I){var M=y[I];M.s.c==d&&M.s.r<f&&f<=M.e.r&&(d=M.e.c+1,I=-1)}var b=Ze(E.slice(0,E.indexOf(">")));g=b.colspan?+b.colspan:1,((m=+b.rowspan)>1||g>1)&&y.push({s:{r:f,c:d},e:{r:f+(m||1)-1,c:d+g-1}});var U=b.t||b["data-t"]||"";if(!w.length){d+=g;continue}if(w=y2(w),_.s.r>f&&(_.s.r=f),_.e.r<f&&(_.e.r=f),_.s.c>d&&(_.s.c=d),_.e.c<d&&(_.e.c=d),!w.length){d+=g;continue}var j={t:"s",v:w};r.raw||!w.trim().length||U=="s"||(w==="TRUE"?j={t:"b",v:!0}:w==="FALSE"?j={t:"b",v:!1}:isNaN(Jn(w))?isNaN(co(w).getDate())||(j={t:"d",v:vr(w)},r.cellDates||(j={t:"n",v:Gr(j.v)}),j.z=r.dateNF||st[14]):j={t:"n",v:Jn(w)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=j):n[Qe({r:f,c:d})]=j,d+=g}}}}return n["!ref"]=yt(_),y.length&&(n["!merges"]=y),n}function d8(e,t,r,n){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>o)&&!(i[f].e.r<r||i[f].e.c<o)){if(i[f].s.r<r||i[f].s.c<o){l=-1;break}l=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(l<0)){var d=Qe({r,c:o}),m=n.dense?(e[r]||[])[o]:e[d],g=m&&m.v!=null&&(m.h||Pp(m.w||(Wi(m),m.w)||""))||"",_={};l>1&&(_.rowspan=l),u>1&&(_.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":m&&(_["data-t"]=m&&m.t||"z",m.v!=null&&(_["data-v"]=m.v),m.z!=null&&(_["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),_.id=(n.id||"sjs")+"-"+d,a.push(JA("td",g,_))}}var y="<tr>";return y+a.join("")+"</tr>"}var h8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',p8="</body></html>";function m8(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ba(kx(r[0],t),t);var n=Kp();return r.forEach(function(i,a){qp(n,kx(i,t),"Sheet"+(a+1))}),n}function g8(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function x8(e,t){var r=t||{},n=r.header!=null?r.header:h8,i=r.footer!=null?r.footer:p8,a=[n],o=yo(e["!ref"]);r.dense=Array.isArray(e),a.push(g8(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(d8(e,o,l,r));return a.push("</table>"+i),a.join("")}function Sw(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Wr(n.origin):n.origin;i=o.r,a=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=yo(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var m=[],g=0,_=e["!rows"]||(e["!rows"]=[]),y=0,v=0,T=0,k=0,E=0,w=0;for(e["!cols"]||(e["!cols"]=[]);y<l.length&&v<u;++y){var P=l[y];if(Ex(P)){if(n.display)continue;_[v]={hidden:!0}}var I=P.children;for(T=k=0;T<I.length;++T){var M=I[T];if(!(n.display&&Ex(M))){var b=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):y2(M.innerHTML),U=M.getAttribute("data-z")||M.getAttribute("z");for(g=0;g<m.length;++g){var j=m[g];j.s.c==k+a&&j.s.r<v+i&&v+i<=j.e.r&&(k=j.e.c+1-a,g=-1)}w=+M.getAttribute("colspan")||1,((E=+M.getAttribute("rowspan")||1)>1||w>1)&&m.push({s:{r:v+i,c:k+a},e:{r:v+i+(E||1)-1,c:k+a+(w||1)-1}});var K={t:"s",v:b},V=M.getAttribute("data-t")||M.getAttribute("t")||"";b!=null&&(b.length==0?K.t=V||"z":n.raw||b.trim().length==0||V=="s"||(b==="TRUE"?K={t:"b",v:!0}:b==="FALSE"?K={t:"b",v:!1}:isNaN(Jn(b))?isNaN(co(b).getDate())||(K={t:"d",v:vr(b)},n.cellDates||(K={t:"n",v:Gr(K.v)}),K.z=n.dateNF||st[14]):K={t:"n",v:Jn(b)})),K.z===void 0&&U!=null&&(K.z=U);var G="",de=M.getElementsByTagName("A");if(de&&de.length)for(var Se=0;Se<de.length&&!(de[Se].hasAttribute("href")&&(G=de[Se].getAttribute("href"),G.charAt(0)!="#"));++Se);G&&G.charAt(0)!="#"&&(K.l={Target:G}),n.dense?(e[v+i]||(e[v+i]=[]),e[v+i][k+a]=K):e[Qe({c:k+a,r:v+i})]=K,f.e.c<k+a&&(f.e.c=k+a),k+=w}}++v}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,v-1+i),e["!ref"]=yt(f),v>=u&&(e["!fullref"]=yt((f.e.r=l.length-y+v-1+i,f))),e}function Cw(e,t){var r=t||{},n=r.dense?[]:{};return Sw(n,e,t)}function v8(e,t){return ba(Cw(e,t),t)}function Ex(e){var t="",r=_8(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function _8(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function y8(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Et(t.replace(/<[^>]*>/g,""));return[r]}var Tx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Aw(e,t){var r=t||{},n=Fp(e),i=[],a,o,l={name:""},u="",f=0,d,m,g={},_=[],y=r.dense?[]:{},v,T,k={value:""},E="",w=0,P=[],I=-1,M=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,j={},K=[],V={},G=0,de=0,Se=[],ce=1,Y=1,xe=[],re={Names:[]},q={},ae=["",""],pe=[],O={},J="",X=0,W=!1,ie=!1,we=0;for(Bl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Bl.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?y["!ref"]=yt(b):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(y["!fullref"]=y["!ref"],b.e.r=r.sheetRows-1,y["!ref"]=yt(b)),K.length&&(y["!merges"]=K),Se.length&&(y["!rows"]=Se),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),_.push(d.name),g[d.name]=y,ie=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Ze(v[0],!1),I=M=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,y=r.dense?[]:{},K=[],Se=[],ie=!0);break;case"table-row-group":v[1]==="/"?--U:++U;break;case"table-row":case"":if(v[1]==="/"){I+=ce,ce=1;break}if(m=Ze(v[0],!1),m.?I=m.-1:I==-1&&(I=0),ce=+m["number-rows-repeated"]||1,ce<10)for(we=0;we<ce;++we)U>0&&(Se[I+we]={level:U});M=-1;break;case"covered-table-cell":v[1]!=="/"&&++M,r.sheetStubs&&(r.dense?(y[I]||(y[I]=[]),y[I][M]={t:"z"}):y[Qe({r:I,c:M})]={t:"z"}),E="",P=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++M,k=Ze(v[0],!1),Y=parseInt(k["number-columns-repeated"]||"1",10),T={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(T.f=vx(Et(k.formula))),(k.||k["value-type"])=="string"&&(T.t="s",T.v=Et(k["string-value"]||""),r.dense?(y[I]||(y[I]=[]),y[I][M]=T):y[Qe({r:I,c:M})]=T),M+=Y-1;else if(v[1]!=="/"){++M,E="",w=0,P=[],Y=1;var Le=ce?I+ce-1:I;if(M>b.e.c&&(b.e.c=M),M<b.s.c&&(b.s.c=M),I<b.s.r&&(b.s.r=I),Le>b.e.r&&(b.e.r=Le),k=Ze(v[0],!1),pe=[],O={},T={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Et(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(G=parseInt(k["number-matrix-rows-spanned"],10)||0,de=parseInt(k["number-matrix-columns-spanned"],10)||0,V={s:{r:I,c:M},e:{r:I+G-1,c:M+de-1}},T.F=yt(V),xe.push([V,T.F])),k.formula)T.f=vx(k.formula);else for(we=0;we<xe.length;++we)I>=xe[we][0].s.r&&I<=xe[we][0].e.r&&M>=xe[we][0].s.c&&M<=xe[we][0].e.c&&(T.F=xe[we][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(G=parseInt(k["number-rows-spanned"],10)||0,de=parseInt(k["number-columns-spanned"],10)||0,V={s:{r:I,c:M},e:{r:I+G-1,c:M+de-1}},K.push(V)),k["number-columns-repeated"]&&(Y=parseInt(k["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=jt(k["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(k.value);break;case"percentage":T.t="n",T.v=parseFloat(k.value);break;case"currency":T.t="n",T.v=parseFloat(k.value);break;case"date":T.t="d",T.v=vr(k["date-value"]),r.cellDates||(T.t="n",T.v=Gr(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=OA(k["time-value"])/86400,r.cellDates&&(T.t="d",T.v=Mf(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(k.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",k["string-value"]!=null&&(E=Et(k["string-value"]),P=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(W=!1,T.t==="s"&&(T.v=E||"",P.length&&(T.R=P),W=w==0),q.Target&&(T.l=q),pe.length>0&&(T.c=pe,pe=[]),E&&r.cellText!==!1&&(T.w=E),W&&(T.t="z",delete T.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var Ae=0;Ae<ce;++Ae){if(Y=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(y[I+Ae]||(y[I+Ae]=[]),y[I+Ae][M]=Ae==0?T:Er(T);--Y>0;)y[I+Ae][M+Y]=Er(T);else for(y[Qe({r:I+Ae,c:M})]=T;--Y>0;)y[Qe({r:I+Ae,c:M+Y})]=Er(T);b.e.c<=M&&(b.e.c=M)}Y=parseInt(k["number-columns-repeated"]||"1",10),M+=Y-1,Y=0,T={},E="",P=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=i.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=i.pop())[0]!==v[3])throw"Bad state: "+a;O.t=E,P.length&&(O.R=P),O.a=J,pe.push(O)}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);J="",X=0,E="",w=0,P=[];break;case"creator":v[1]==="/"?J=n.slice(X,v.index):X=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=i.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);E="",w=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(j[l.name]=u,(a=i.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(u="",l=Ze(v[0],!1),i.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ze(v[0],!1),u+=Tx[v[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ze(v[0],!1),u+=Tx[v[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,v.index);break}else f=v.index+v[0].length;break;case"named-range":o=Ze(v[0],!1),ae=K0(o["cell-range-address"]);var _e={Name:o.name,Ref:ae[0]+"!"+ae[1]};ie&&(_e.Sheet=_.length),re.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(v[1]==="/"&&(!k||!k["string-value"])){var ze=y8(n.slice(w,v.index));E=(E.length>0?E+`
`:"")+ze[0]}else Ze(v[0],!1),w=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ae=K0(Ze(v[0])["target-range-address"]),g[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(q=Ze(v[0],!1),!q.href)break;q.Target=Et(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(ae=K0(q.Target.slice(1)),q.Target="#"+ae[0]+"!"+ae[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var H={Sheets:g,SheetNames:_,Workbook:re};return r.bookSheets&&delete H.Sheets,H}function Sx(e,t){t=t||{},Sn(e,"META-INF/manifest.xml")&&IN(nr(e,"META-INF/manifest.xml"),t);var r=un(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Aw(Ft(r),t);return Sn(e,"meta.xml")&&(n.Props=z2(nr(e,"meta.xml"))),n}function Cx(e,t){return Aw(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $p(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function uh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ft(fs(e))}function fh(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Ax(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function w8(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Vl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function dr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Rr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Vl(e,r),a=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(a){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Vl(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:l,type:a};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function Zp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function k8(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Vl(e,n),a=Rr(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:dr(a[1][0].data),messages:[]};a[2].forEach(function(l){var u=Rr(l.data),f=dr(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(o.merge=dr(a[3][0].data)>>>0>0),r.push(o)}return r}function E8(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Vl(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[fh(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=fh(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function T8(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(E8(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return fh(t)}function S8(e,t,r,n){var i=$p(e),a=i.getUint32(4,!0),o=(n>1?12:8)+Ax(a&(n>1?3470:398))*4,l=-1,u=-1,f=NaN,d=new Date(2001,0,1);a&512&&(l=i.getUint32(o,!0),o+=4),o+=Ax(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(o,!0),o+=4),a&32&&(f=i.getFloat64(o,!0),o+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function C8(e,t,r){var n=$p(e),i=n.getUint32(8,!0),a=12,o=-1,l=-1,u=NaN,f=NaN,d=new Date(2001,0,1);i&1&&(u=w8(e,a),a+=16),i&2&&(f=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(l=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return m}function A8(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return S8(e,t,r,e[0]);case 5:return C8(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function _a(e){var t=Rr(e);return Vl(t[1][0].data)}function Nx(e,t){var r=Rr(t.data),n=dr(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var l=Rr(o.data),u=dr(l[1][0].data)>>>0;switch(n){case 1:a[u]=uh(l[3][0].data);break;case 8:{var f=e[_a(l[9][0].data)][0],d=Rr(f.data),m=e[_a(d[1][0].data)][0],g=dr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var _=Rr(m.data);a[u]=_[3].map(function(y){return uh(y.data)}).join("")}break}}),a}function N8(e,t){var r,n,i,a,o,l,u,f,d,m,g,_,y,v,T=Rr(e),k=dr(T[1][0].data)>>>0,E=dr(T[2][0].data)>>>0,w=((n=(r=T[8])==null?void 0:r[0])==null?void 0:n.data)&&dr(T[8][0].data)>0||!1,P,I;if((a=(i=T[7])==null?void 0:i[0])!=null&&a.data&&t!=0)P=(l=(o=T[7])==null?void 0:o[0])==null?void 0:l.data,I=(f=(u=T[6])==null?void 0:u[0])==null?void 0:f.data;else if((m=(d=T[4])==null?void 0:d[0])!=null&&m.data&&t!=1)P=(_=(g=T[4])==null?void 0:g[0])==null?void 0:_.data,I=(v=(y=T[3])==null?void 0:y[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var M=w?4:1,b=$p(P),U=[],j=0;j<P.length/2;++j){var K=b.getUint16(j*2,!0);K<65535&&U.push([j,K])}if(U.length!=E)throw"Expected ".concat(E," cells, found ").concat(U.length);var V=[];for(j=0;j<U.length-1;++j)V[U[j][0]]=I.subarray(U[j][1]*M,U[j+1][1]*M);return U.length>=1&&(V[U[U.length-1][0]]=I.subarray(U[U.length-1][1]*M)),{R:k,cells:V}}function b8(e,t){var r,n=Rr(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?dr(n[7][0].data)>>>0>0?1:0:-1,a=Zp(n[5],function(o){return N8(o,i)});return{nrows:dr(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,f){if(o[l.R][f])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(f));o[l.R][f]=u}),o},[])}}function L8(e,t,r){var n,i=Rr(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(dr(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(dr(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=yt(a);var o=Rr(i[4][0].data),l=Nx(e,e[_a(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?Nx(e,e[_a(o[17][0].data)][0]):[],f=Rr(o[3][0].data),d=0;f[1].forEach(function(m){var g=Rr(m.data),_=e[_a(g[2][0].data)][0],y=dr(_.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var v=b8(e,_);v.data.forEach(function(T,k){T.forEach(function(E,w){var P=Qe({r:d+k,c:w}),I=A8(E,l,u);I&&(r[P]=I)})}),d+=v.nrows})}function P8(e,t){var r=Rr(t.data),n={"!ref":"A1"},i=e[_a(r[2][0].data)],a=dr(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return L8(e,i[0],n),n}function F8(e,t){var r,n=Rr(t.data),i={name:(r=n[1])!=null&&r[0]?uh(n[1][0].data):"",sheets:[]},a=Zp(n[2],_a);return a.forEach(function(o){e[o].forEach(function(l){var u=dr(l.meta[1][0].data);u==6e3&&i.sheets.push(P8(e,l))})}),i}function O8(e,t){var r=Kp(),n=Rr(t.data),i=Zp(n[1],_a);if(i.forEach(function(a){e[a].forEach(function(o){var l=dr(o.meta[1][0].data);if(l==2){var u=F8(e,o);u.sheets.forEach(function(f,d){qp(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Y0(e){var t,r,n,i,a={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=T8(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var d;try{d=k8(f)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){a[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&dr(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(u){a[u].forEach(function(f){var d=dr(f.meta[1][0].data)>>>0;if(d==1)if(!l)l=f;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return O8(a,l)}function R8(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Gp(e){R8([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function M8(e){return Ws.WS.indexOf(e)>-1?"sheet":e==Ws.CS?"chart":e==Ws.DS?"dialog":e==Ws.MS?"macro":e&&e.length?e:"sheet"}function I8(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,M8(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function D8(e,t,r,n,i,a,o,l,u,f,d,m){try{a[n]=dl(un(e,r,!0),t);var g=nr(e,t),_;switch(l){case"sheet":_=V5(g,t,i,u,a[n],f,d,m);break;case"chart":if(_=W5(g,t,i,u,a[n],f,d,m),!_||!_["!drawel"])break;var y=Yo(_["!drawel"].Target,t),v=ah(y),T=HP(un(e,y,!0),dl(un(e,v,!0),y)),k=Yo(T,y),E=ah(k);_=C5(un(e,k,!0),k,u,dl(un(e,E,!0),k),f,_);break;case"macro":_=$5(g,t,i,u,a[n],f,d,m);break;case"dialog":_=Z5(g,t,i,u,a[n],f,d,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=_;var w=[];a&&a[n]&&vi(a[n]).forEach(function(P){var I="";if(a[n][P].Type==Ws.CMNT){I=Yo(a[n][P].Target,t);var M=q5(nr(e,I,!0),I,u);if(!M||!M.length)return;hx(_,M,!1)}a[n][P].Type==Ws.TCMNT&&(I=Yo(a[n][P].Target,t),w=w.concat(WP(nr(e,I,!0),u)))}),w&&w.length&&hx(_,w,!0,u.people||[])}catch(P){if(u.WTF)throw P}}function wn(e){return e.charAt(0)=="/"?e.slice(1):e}function j8(e,t){if(f2(),t=t||{},Gp(t),Sn(e,"META-INF/manifest.xml")||Sn(e,"objectdata.xml"))return Sx(e,t);if(Sn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Y0<"u"){if(e.FileIndex)return Y0(e);var r=_t.utils.cfb_new();return z1(e).forEach(function(Se){BA(r,Se,jA(e,Se))}),Y0(r)}throw new Error("Unsupported NUMBERS file")}if(!Sn(e,"[Content_Types].xml"))throw Sn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Sn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=z1(e),i=RN(un(e,"[Content_Types].xml")),a=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",nr(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!nr(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(ml=[],i.sst)try{ml=K5(nr(e,wn(i.sst)),i.sst,t)}catch(Se){if(t.WTF)throw Se}t.cellStyles&&i.themes.length&&(u=X5(un(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=G5(nr(e,wn(i.style)),i.style,u,t))}i.links.map(function(Se){try{var ce=dl(un(e,ah(wn(Se))),Se);return J5(nr(e,wn(Se)),ce,Se,t)}catch{}});var d=H5(nr(e,wn(i.workbooks[0])),i.workbooks[0],t),m={},g="";i.coreprops.length&&(g=nr(e,wn(i.coreprops[0]),!0),g&&(m=z2(g)),i.extprops.length!==0&&(g=nr(e,wn(i.extprops[0]),!0),g&&BN(g,m,t)));var _={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(g=un(e,wn(i.custprops[0]),!0),g&&(_=UN(g,t)));var y={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(ce){return ce.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(y.Props=m,y.Custprops=_),t.bookSheets&&typeof o<"u"&&(y.SheetNames=o),t.bookSheets?y.SheetNames:t.bookProps))return y;o={};var v={};t.bookDeps&&i.calcchain&&(v=Y5(nr(e,wn(i.calcchain)),i.calcchain));var T=0,k={},E,w;{var P=d.Sheets;m.Worksheets=P.length,m.SheetNames=[];for(var I=0;I!=P.length;++I)m.SheetNames[I]=P[I].name}var M=a?"bin":"xml",b=i.workbooks[0].lastIndexOf("/"),U=(i.workbooks[0].slice(0,b+1)+"_rels/"+i.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");Sn(e,U)||(U="xl/_rels/workbook."+M+".rels");var j=dl(un(e,U,!0),U.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Q5(nr(e,wn(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=$P(nr(e,wn(i.people[0])),t)),j&&(j=I8(j,d.Sheets));var K=nr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=m.Worksheets;++T){var V="sheet";if(j&&j[T]?(E="xl/"+j[T][1].replace(/[\/]?xl\//,""),Sn(e,E)||(E=j[T][1]),Sn(e,E)||(E=U.replace(/_rels\/.*$/,"")+j[T][1]),V=j[T][2]):(E="xl/worksheets/sheet"+(T+1-K)+"."+M,E=E.replace(/sheet0\./,"sheet.")),w=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(T!=t.sheets)continue e;break;case"string":if(m.SheetNames[T].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var G=!1,de=0;de!=t.sheets.length;++de)typeof t.sheets[de]=="number"&&t.sheets[de]==T&&(G=1),typeof t.sheets[de]=="string"&&t.sheets[de].toLowerCase()==m.SheetNames[T].toLowerCase()&&(G=1);if(!G)continue e}}D8(e,E,w,m.SheetNames[T],T,k,o,V,t,d,u,f)}return y={Directory:i,Workbook:d,Props:m,Custprops:_,Deps:v,Sheets:o,SheetNames:m.SheetNames,Strings:ml,Styles:f,Themes:u,SSF:Er(st)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(Se,ce){Se=Se.replace(/^Root Entry[\/]/,""),y.keys.push(Se),y.files[Se]=e.FileIndex[ce]}))),t&&t.bookVBA&&(i.vba.length>0?y.vbaraw=nr(e,wn(i.vba[0]),!0):i.defaults&&i.defaults.bin===KP&&(y.vbaraw=nr(e,"xl/vbaProject.bin",!0))),y}function B8(e,t){var r=t||{},n="Workbook",i=_t.find(e,n);try{if(n="/!DataSpaces/Version",i=_t.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(PL(i.content),n="/!DataSpaces/DataSpaceMap",i=_t.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=OL(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=_t.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=RL(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=_t.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);IL(i.content)}catch{}if(n="/EncryptionInfo",i=_t.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=DL(i.content);if(n="/EncryptedPackage",i=_t.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Xp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=mn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function z8(e,t){return _t.find(e,"EncryptedPackage")?B8(e,t):Tw(e,t)}function U8(e,t){var r,n=e,i=t||{};return i.type||(i.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r=x2(n,i),j8(r,i)}function Nw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return lh(e.slice(r),t);default:break e}return zl.to_workbook(e,t)}function H8(e,t){var r="",n=Xp(e,t);switch(t.type){case"base64":r=mn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=as(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ft(r)),t.type="binary",Nw(r,t)}function V8(e,t){var r=e;return t.type=="base64"&&(r=mn(r)),r=ia.utils.decode(1200,r.slice(2),"str"),t.type="binary",Nw(r,t)}function W8(e){return e.match(/[^\x00-\x7F]/)?Jo(e):e}function J0(e,t,r,n){return n?(r.type="string",zl.to_workbook(e,r)):zl.to_workbook(t,r)}function dh(e,t){Qy();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return dh(new Uint8Array(e),(r=Er(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),to={},r.dateNF&&(to.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",n=PA(e),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=W8(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Er(r),r.type="array",dh(Cp(n),r)}switch((i=Xp(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return z8(_t.read(n,r),r);break;case 9:if(i[1]<=8)return Tw(n,r);break;case 60:return lh(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return vL(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return gL.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?U8(n,r):J0(e,n,r,a);case 239:return i[3]===60?lh(n,r):J0(e,n,r,a);case 255:if(i[1]===254)return V8(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return pl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return pl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return dx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return KL.to_workbook(n,r);break;case 10:case 13:case 32:return H8(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pL.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?dx.to_workbook(n,r):J0(e,n,r,a)}function $8(e,t,r,n,i,a,o,l){var u=Tr(r),f=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!o||e[r])for(var _=t.s.c;_<=t.e.c;++_){var y=o?e[r][_]:e[n[_]+u];if(y===void 0||y.t===void 0){if(f===void 0)continue;a[_]!=null&&(g[a[_]]=f);continue}var v=y.v;switch(y.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(a[_]!=null){if(v==null)if(y.t=="e"&&v===null)g[a[_]]=null;else if(f!==void 0)g[a[_]]=f;else if(d&&v===null)g[a[_]]=null;else continue;else g[a[_]]=d&&(y.t!=="n"||y.t==="n"&&l.rawNumbers!==!1)?v:Wi(y,v,l);v!=null&&(m=!1)}}return{row:g,isempty:m}}function hh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=Kt(d);break;case"number":u=Kt(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var m=Tr(u.s.r),g=[],_=[],y=0,v=0,T=Array.isArray(e),k=u.s.r,E=0,w={};T&&!e[k]&&(e[k]=[]);var P=f.skipHidden&&e["!cols"]||[],I=f.skipHidden&&e["!rows"]||[];for(E=u.s.c;E<=u.e.c;++E)if(!(P[E]||{}).hidden)switch(g[E]=fr(E),r=T?e[k][E]:e[g[E]+m],n){case 1:a[E]=E-u.s.c;break;case 2:a[E]=g[E];break;case 3:a[E]=f.header[E-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Wi(r,null,f),v=w[o]||0,!v)w[o]=1;else{do l=o+"_"+v++;while(w[l]);w[o]=v,w[l]=1}a[E]=l}for(k=u.s.r+i;k<=u.e.r;++k)if(!(I[k]||{}).hidden){var M=$8(e,u,k,g,n,a,T,f);(M.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(_[y++]=M.row)}return _.length=y,_}var bx=/"/g;function Z8(e,t,r,n,i,a,o,l){for(var u=!0,f=[],d="",m=Tr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var _=l.dense?(e[r]||[])[g]:e[n[g]+m];if(_==null)d="";else if(_.v!=null){u=!1,d=""+(l.rawNumbers&&_.t=="n"?_.v:Wi(_,null,l));for(var y=0,v=0;y!==d.length;++y)if((v=d.charCodeAt(y))===i||v===a||v===34||l.forceQuotes){d='"'+d.replace(bx,'""')+'"';break}d=="ID"&&(d='"ID"')}else _.f!=null&&!_.F?(u=!1,d="="+_.f,d.indexOf(",")>=0&&(d='"'+d.replace(bx,'""')+'"')):d="";f.push(d)}return l.blankrows===!1&&u?null:f.join(o)}function bw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Kt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],_=n.skipHidden&&e["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(m[y]=fr(y));for(var v=0,T=i.s.r;T<=i.e.r;++T)(_[T]||{}).hidden||(d=Z8(e,i,T,m,o,u,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((v++?l:"")+d)));return delete n.dense,r.join("")}function G8(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=bw(e,t);return r}function X8(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Kt(e["!ref"]),a="",o=[],l,u=[],f=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=fr(l);for(var d=i.s.r;d<=i.e.r;++d)for(a=Tr(d),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+a,r=f?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function Lw(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Wr(n.origin):n.origin;o=u.r,l=u.c}var f,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(a["!ref"]){var m=Kt(a["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var g=n.header||[],_=0;t.forEach(function(v,T){vi(v).forEach(function(k){(_=g.indexOf(k))==-1&&(g[_=g.length]=k);var E=v[k],w="z",P="",I=Qe({c:l+_,r:o+T+i});f=Wl(a,I),E&&typeof E=="object"&&!(E instanceof Date)?a[I]=E:(typeof E=="number"?w="n":typeof E=="boolean"?w="b":typeof E=="string"?w="s":E instanceof Date?(w="d",n.cellDates||(w="n",E=Gr(E)),P=n.dateNF||st[14]):E===null&&n.nullError&&(w="e",E=0),f?(f.t=w,f.v=E,delete f.w,delete f.R,P&&(f.z=P)):a[I]=f={t:w,v:E},P&&(f.z=P))})}),d.e.c=Math.max(d.e.c,l+g.length-1);var y=Tr(o);if(i)for(_=0;_<g.length;++_)a[fr(_+l)+y]={t:"s",v:g[_]};return a["!ref"]=yt(d),a}function K8(e,t){return Lw(null,e,t)}function Wl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Wr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wl(e,Qe(t)):Wl(e,Qe({r:t,c:r||0}))}function q8(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Kp(){return{SheetNames:[],Sheets:{}}}function qp(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(R5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Y8(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=q8(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function J8(e,t){return e.z=t,e}function Pw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Q8(e,t,r){return Pw(e,"#"+t,r)}function eO(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function tO(e,t,r,n){for(var i=typeof t!="string"?t:Kt(t),a=typeof t=="string"?t:yt(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var u=Wl(e,o,l);u.t="n",u.F=a,delete u.v,o==i.s.r&&l==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var rO={encode_col:fr,encode_row:Tr,encode_cell:Qe,encode_range:yt,decode_col:Mp,decode_row:Rp,split_cell:hN,decode_cell:Wr,decode_range:yo,format_cell:Wi,sheet_add_aoa:M2,sheet_add_json:Lw,sheet_add_dom:Sw,aoa_to_sheet:wo,json_to_sheet:K8,table_to_sheet:Cw,table_to_book:v8,sheet_to_csv:bw,sheet_to_txt:G8,sheet_to_json:hh,sheet_to_html:x8,sheet_to_formulae:X8,sheet_to_row_object_array:hh,sheet_get_cell:Wl,book_new:Kp,book_append_sheet:qp,book_set_sheet_visibility:Y8,cell_set_number_format:J8,cell_set_hyperlink:Pw,cell_set_internal_link:Q8,cell_add_comment:eO,sheet_set_array_formula:tO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Pi=()=>localStorage.getItem("token"),Fw="http://localhost:8000/api",nO=async(e,t)=>{var r,n;try{return(await $e.post(`${Fw}/command/execute/`,{firewall_id:e,command:t},{headers:{Authorization:`Bearer ${Pi()}`,"Content-Type":"application/json"}})).data}catch(i){throw $e.isAxiosError(i)?new Error(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.error)||"Failed to execute command"):i}},iO=async e=>{var t,r;try{return(await $e.get(`${Fw}/commands/`,{params:{firewall_id:e},headers:{Authorization:`Bearer ${Pi()}`}})).data}catch(n){throw $e.isAxiosError(n)?new Error(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.error)||"Failed to fetch command history"):n}},Da="http://localhost:8000/api",Ns=$e.create({baseURL:Da,headers:{"Content-Type":"application/json"}});Ns.interceptors.request.use(e=>{const t=Pi();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const aO=[{name:"Name",description:"Template name"},{name:"Source Address",description:"Source IP address or network"},{name:"Source Description",description:"Description of the source"},{name:"Source Interface",description:"Source network interface"},{name:"Destination Address",description:"Destination IP address or network"},{name:"Destination Description",description:"Description of the destination"},{name:"Destination Interface",description:"Destination network interface"},{name:"Service",description:"Network service or port"}],bs={getTemplates:async()=>{try{const e=await Ns.get("/templates/");return console.log("Templates API response:",e.data),Array.isArray(e.data)?e.data:e.data.results&&Array.isArray(e.data.results)?e.data.results:(console.error("Unexpected API response format:",e.data),[])}catch(e){throw console.error("Error fetching templates:",e),e}},getTemplate:async e=>{try{return(await Ns.get(`/templates/${e}/`)).data}catch(t){throw console.error("Error fetching template:",t),t}},createTemplate:async e=>{try{console.log("Creating template with data:",e);const t=await Ns.post("/templates/",e);return console.log("Template created successfully:",t.data),t.data}catch(t){throw console.error("Error creating template:",t),t}},updateTemplate:async(e,t)=>{try{return(await Ns.put(`/templates/${e}/`,t)).data}catch(r){throw console.error("Error updating template:",r),r}},deleteTemplate:async e=>{try{await Ns.delete(`/templates/${e}/`)}catch(t){throw console.error("Error deleting template:",t),t}}},Ls={getVariables:async()=>{var e,t,r;try{const n=Pi();if(!n)return console.error("No authentication token found"),[];let i=[],a=`${Da}/templates/variables/`;for(;a;){const o=await $e.get(a,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(Array.isArray(o.data))i=[...i,...o.data],a=null;else if(o.data.results&&Array.isArray(o.data.results))i=[...i,...o.data.results],a=o.data.next;else{console.error("Unexpected API response format:",o.data);break}}return i}catch(n){return console.error("Error fetching variables:",n),$e.isAxiosError(n)&&console.error("Error details:",{status:(e=n.response)==null?void 0:e.status,data:(t=n.response)==null?void 0:t.data,headers:(r=n.response)==null?void 0:r.headers}),[]}},createVariable:async e=>{try{return(await $e.post(`${Da}/templates/variables/`,e,{headers:{Authorization:`Bearer ${Pi()}`,"Content-Type":"application/json"}})).data}catch(t){throw console.error("Error creating variable:",t),t}},updateVariable:async(e,t)=>{try{return(await $e.put(`${Da}/templates/variables/${e}/`,t,{headers:{Authorization:`Bearer ${Pi()}`,"Content-Type":"application/json"}})).data}catch(r){throw console.error("Error updating variable:",r),r}},deleteVariable:async e=>{try{await $e.delete(`${Da}/templates/variables/${e}/`,{headers:{Authorization:`Bearer ${Pi()}`,"Content-Type":"application/json"}})}catch(t){throw console.error("Error deleting variable:",t),t}},addVariableToTemplate:async(e,t)=>{try{await $e.post(`${Da}/templates/${e}/add_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${Pi()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error adding variable to template:",r),r}},removeVariableFromTemplate:async(e,t)=>{try{await $e.post(`${Da}/templates/${e}/remove_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${Pi()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error removing variable from template:",r),r}},async ensureRequiredVariables(){const e=await this.getVariables(),t=new Set(e.map(r=>r.name));for(const r of aO)t.has(r.name)||await this.createVariable(r)}},Lx=(e,t)=>{let r;return function(...i){const a=()=>{clearTimeout(r),e(...i)};clearTimeout(r),r=setTimeout(a,t)}},sO=()=>localStorage.getItem("token"),bi=$e.create({baseURL:xi});bi.interceptors.request.use(e=>{const t=sO();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));bi.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),Xu("/login")),Promise.reject(e)));const oO=()=>{var pt,or,At,lt;const[e,t]=N.useState([]),[r,n]=N.useState(null),[i,a]=N.useState({hostname:"",ipAddress:"",vdom:"",setName:"",srcaddr:"",srcaddrDesc:"",srcintf:"",dstaddr:"",dstaddrDesc:"",dstintf:"",service:""});N.useState(""),N.useState("");const[o,l]=N.useState([]),[u,f]=N.useState([]),[d,m]=N.useState([]),[g,_]=N.useState(null),[y,v]=N.useState(!1),[T,k]=N.useState(""),[E,w]=N.useState(""),[P,I]=N.useState([]),[M,b]=N.useState([]),[U,j]=N.useState([]),[K,V]=N.useState({}),[G,de]=N.useState(""),[Se,ce]=N.useState(""),[Y,xe]=N.useState([]),[re,q]=N.useState(!1),[ae,pe]=N.useState(null),[O,J]=N.useState(""),[X,W]=N.useState([]),[ie,we]=N.useState(!1),[Le,Ae]=N.useState(null);N.useEffect(()=>{(async()=>{try{we(!0),Ae(null);const ve=await bs.getTemplates();W(ve)}catch(ve){console.error("Error loading templates:",ve),Ae("Failed to load templates")}finally{we(!1)}})()},[]);const[_e,ze]=N.useState(null),[H,Ye]=N.useState(!1),[rt,et]=N.useState(null),[Ge,Ne]=N.useState(null),[le,Pe]=N.useState(!1),[Fe,Ue]=N.useState(null),[nt,tt]=N.useState([]);N.useEffect(()=>{(async()=>{try{v(!0);const ve=await bi.get("/datacenters/hierarchy/");tt(ve.data)}catch(ve){console.error("Error fetching hierarchy:",ve)}finally{v(!1)}})()},[]);const Ve=()=>{if(!T)return[];const Q=nt.find(ve=>ve.id===T);return Q?Q.firewall_types:[]},Ot=()=>{if(!E)return[];const Q=nt.find(Be=>Be.id===T);if(!Q)return[];const ve=Q.firewall_types.find(Be=>Be.id===E);return ve?ve.firewalls:[]},bt=Q=>{const ve=Q.target.value;k(ve),w(""),_(null)},sr=Q=>{const ve=Q.target.value;w(ve),_(null)},Ct=Q=>{var gt,St;const ve=Q.target.value,ft=Ot().find(Zt=>Zt.id===ve);if(ft){const Zt={id:ft.id,name:ft.name,ip_address:ft.ip_address,data_center:{id:T,name:((gt=nt.find(Qt=>Qt.id===T))==null?void 0:gt.name)||""},firewall_type:{id:E,name:((St=Ve().find(Qt=>Qt.id===E))==null?void 0:St.name)||""},config:{id:"",config_data:{}},created_at:new Date().toISOString()};_(Zt)}};N.useEffect(()=>{$t()},[]);const $t=async()=>{try{v(!0);let Q=[],ve="/firewalls/firewalls/";for(;ve;){const F=(await bi.get(ve)).data;Q=[...Q,...F.results||[]],ve=F.next}const[Be,ft]=await Promise.all([bi.get("/firewalls/firewall-types/"),bi.get("/datacenters/")]);console.log("API Responses:",{firewallTypes:Be.data,dataCenters:ft.data,firewalls:Q});const St=(Be.data.results||[]).map(R=>({id:R.id,name:R.name,data_center:R.data_center,attributes_schema:R.attributes_schema||{}}));l(St);const Qt=(ft.data.results||[]).map(R=>({id:R.id,name:R.name}));f(Qt);const ni=Q.map(R=>({id:R.id,name:R.name,ip_address:R.ip_address,data_center:R.data_center&&R.data_center.id&&R.data_center.name?{id:R.data_center.id,name:R.data_center.name}:null,firewall_type:R.firewall_type&&R.firewall_type.id&&R.firewall_type.name?{id:R.firewall_type.id,name:R.firewall_type.name}:null,config:R.config||{id:"",config_data:{}},created_at:R.created_at}));m(ni);const Cr=localStorage.getItem("dataCenter"),De=localStorage.getItem("firewallType"),C=localStorage.getItem("selectedFirewallId");if(Cr&&k(Cr),De&&w(De),C){const R=ni.find(F=>F.id===C);R&&(_(R),a(F=>({...F,ipAddress:R.ip_address})))}}catch(Q){console.error("Error fetching data:",Q)}finally{v(!1)}};N.useEffect(()=>{if(T){const Q=o.filter(ve=>{if(!ve.data_center)return console.log("No data_center for type:",ve),!1;const Be=ve.data_center===T;return console.log("Type matches:",{typeId:ve.id,typeDataCenter:ve.data_center,selectedDataCenter:T,matches:Be}),Be});console.log("Filtered Firewall Types:",{selectedDataCenter:T,allTypes:o,filteredTypes:Q}),I(Q),E&&!Q.some(ve=>ve.id===E)&&(w(""),localStorage.removeItem("firewallType"))}else I([]),w("")},[T,o]),N.useEffect(()=>{var Q;if(E){const ve=P.find(Be=>Be.id===E);if(console.log("Selected Type:",ve),(Q=ve==null?void 0:ve.attributes_schema)!=null&&Q.properties){const Be=Object.entries(ve.attributes_schema.properties).map(([ft,gt])=>({name:ft,label:gt.title||ft,required:gt.required||!1,type:gt.type||"string"}));console.log("Generated Form Fields:",Be),j(Be)}else console.log("No attributes schema found for type:",ve),j([])}else j([])},[E,P]),N.useEffect(()=>{if(E&&T){const Q=d.filter(ve=>{if(!ve.firewall_type||!ve.data_center)return!1;const Be=ve.firewall_type.id===E,ft=ve.data_center.id===T;return console.log("Firewall Filter Check:",{firewallId:ve.id,firewallType:ve.firewall_type.id,dataCenter:ve.data_center.id,selectedType:E,selectedDC:T,matchesType:Be,matchesDataCenter:ft}),Be&&ft});console.log("Filtered Firewalls:",{selectedFirewallType:E,selectedDataCenter:T,allFirewalls:d,filteredFirewalls:Q}),b(Q),g&&!Q.some(ve=>ve.id===g.id)&&(_(null),localStorage.removeItem("selectedFirewallId"))}else b([]),_(null)},[E,T,d]),N.useEffect(()=>{const Q=localStorage.getItem("dataCenter"),ve=localStorage.getItem("firewallType"),Be=localStorage.getItem("selectedFirewallId");if(console.log("Loading saved selections:",{savedDataCenter:Q,savedFirewallType:ve,savedFirewallId:Be}),Q&&k(Q),ve&&w(ve),Be){const ft=d.find(gt=>gt.id===Be);ft&&(_(ft),a(gt=>({...gt,ipAddress:ft.ip_address})))}},[d]);const Xe=Q=>{var ve;try{const Be=dh(Q,{type:"array"});if(!Be.SheetNames.length)throw new Error("No sheets found in the Excel file");const ft=Be.SheetNames[0],gt=Be.Sheets[ft],St=P.find(C=>C.id===E);if(!St)throw new Error("No firewall type selected");if(!((ve=St.attributes_schema)!=null&&ve.properties))throw new Error("No attributes defined for the selected firewall type");const Zt=Object.entries(St.attributes_schema.properties).filter(([C,R])=>R.required).map(([C])=>C),Qt=rO.sheet_to_json(gt,{raw:!1,header:1});if(!Array.isArray(Qt)||Qt.length===0)throw new Error("No data found in the Excel file");const ni=Qt[0];if(!Array.isArray(ni)||ni.length===0)throw new Error("No headers found in the Excel file");const De=Qt.slice(1).map((C,R)=>{var z;const F={};Array.isArray(C)&&ni.forEach((ee,me)=>{const ne=C[me];F[ee]=ne});const D=Zt.filter(ee=>!F[ee]);if(D.length>0)throw new Error(`Missing required fields in row ${R+2}: ${D.join(", ")}`);const B={};return(z=St==null?void 0:St.attributes_schema)!=null&&z.properties&&Object.entries(St.attributes_schema.properties).forEach(([ee,me])=>{const ne=Object.keys(F).find(se=>{const oe=se.toLowerCase().replace(/\s+/g,""),ke=ee.toLowerCase().replace(/\s+/g,""),be={ipaddress:["ip","ipaddress","ipaddr","ip_address","ipaddress","IP Adresse"],sourceaddress:["source","src","sourceaddr","source_address","sourceaddress","source"],destinationinterface:["dstintf","destinationintf","destination_interface","dstinterface","destinationinterface","destination"],name:["name","nom","hostname","device"],vdom:["vdom","virtualdomain"],service:["service","services","protocol"],hostname:["hostname","name","device"],sourcedescription:["sourcedescription","srcdesc","source_desc"],sourceinterface:["sourceinterface","srcintf","source_intf"],destinationaddress:["destinationaddress","dstaddr","destination_addr"],destinationdescription:["destinationdescription","dstdesc","destination_desc"]};return oe===ke?!0:be[ke]?be[ke].includes(oe):!1});ne?B[ee]=F[ne]||"":B[ee]=""}),B});t(De),De.length>0&&(n(De[0]),V(De[0])),alert(`${De.length} configurations loaded successfully`)}catch(Be){alert(`Error processing Excel file: ${Be.message}`)}},fe=Q=>{var Be;const ve=(Be=Q.target.files)==null?void 0:Be[0];if(ve){if(!E){alert("Please select a firewall type before uploading the file");return}const ft=new FileReader;ft.onload=gt=>{var Zt;const St=(Zt=gt.target)==null?void 0:Zt.result;Xe(St)},ft.readAsArrayBuffer(ve)}},ge=Kn.useCallback(Lx(async Q=>{var ve,Be,ft,gt;if(!(!g||!Q)){Ye(!0),et(null),ze(null);try{const St=await bi.post("/analysis/flow-matrix/analyze-ip/",{source_ip:Q,firewall_id:g.id,data_center_name:((ve=g.data_center)==null?void 0:ve.name)||"",firewall_type_name:((Be=g.firewall_type)==null?void 0:Be.name)||""});ze(St.data)}catch(St){et(((gt=(ft=St.response)==null?void 0:ft.data)==null?void 0:gt.error)||"Failed to search address")}finally{Ye(!1)}}},500),[g]),Ee=Kn.useCallback(Lx(async Q=>{var ve,Be,ft,gt;if(!(!g||!Q)){Pe(!0),Ue(null),Ne(null);try{const St=await bi.post("/analysis/flow-matrix/analyze-ip/",{source_ip:Q,firewall_id:g.id,data_center_name:((ve=g.data_center)==null?void 0:ve.name)||"",firewall_type_name:((Be=g.firewall_type)==null?void 0:Be.name)||""});Ne(St.data)}catch(St){Ue(((gt=(ft=St.response)==null?void 0:ft.data)==null?void 0:gt.error)||"Failed to search address")}finally{Pe(!1)}}},500),[g]),Oe=(Q,ve)=>{V(Be=>({...Be,[Q]:ve})),Q==="SourceAddress"?ge(ve):Q==="DestinationAddress"&&Ee(ve)},He=r&&{fields:[{name:"hostname",label:"Hostname",required:!0},{name:"ipAddress",label:"IP Address",required:!0},{name:"vdom",label:"VDOM",required:!0},{name:"setName",label:"Set Name",required:!0},{name:"srcaddr",label:"Source Address",required:!0},{name:"srcaddrDesc",label:"Source Description",required:!1},{name:"srcintf",label:"Source Interface",required:!0},{name:"dstaddr",label:"Destination Address",required:!0},{name:"dstaddrDesc",label:"Destination Description",required:!1},{name:"dstintf",label:"Destination Interface",required:!0},{name:"service",label:"Service",required:!0}]};He!=null&&He.fields;const Tt=async Q=>{if(!g){ut("Please select a firewall first");return}try{const ve=await nO(g.id,Q);xe(Be=>Array.isArray(Be)?[...Be,ve]:[ve]),de(""),ut(null)}catch(ve){ut(ve instanceof Error?ve.message:"Failed to execute command")}};N.useEffect(()=>{(async()=>{if(g)try{const ve=parseInt(g.id);if(!isNaN(ve)){const Be=await iO(ve);xe(Array.isArray(Be)?Be:[])}}catch(ve){console.error("Error loading command history:",ve),xe([])}})()},[g]);const ct=()=>{if(!O)return;const Q=X.find(Zt=>Zt.name===O);if(!Q)return;const ve=/{{([^}]+)}}/g,Be=new Set;let ft;for(;(ft=ve.exec(Q.content))!==null;){const Zt=ft[1].trim();Be.add(Zt)}const gt={};Be.forEach(Zt=>{const Qt=K[Zt]||"";gt[`{{ ${Zt} }}`]=Qt});let St=Q.content;Object.entries(gt).forEach(([Zt,Qt])=>{St=St.replace(new RegExp(Zt,"g"),Qt)}),de(St)},Ke=async()=>{var Q,ve,Be,ft;if(!g||!K.SourceAddress){et("Please select a firewall and enter a source address");return}Ye(!0),et(null),ze(null);try{const gt=await bi.post("/analysis/flow-matrix/analyze-ip/",{source_ip:K.SourceAddress,firewall_id:g.id,data_center_name:((Q=g.data_center)==null?void 0:Q.name)||"",firewall_type_name:((ve=g.firewall_type)==null?void 0:ve.name)||""});ze(gt.data)}catch(gt){et(((ft=(Be=gt.response)==null?void 0:Be.data)==null?void 0:ft.error)||"Failed to search source address")}finally{Ye(!1)}};N.useState(!1);const[Je,ut]=N.useState(null);return N.useState([]),N.useState(!1),N.useState(null),N.useState([]),N.useState([]),N.useState(""),N.useState(""),N.useState(""),p.jsxs("div",{className:"p-8",children:[p.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:p.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(tc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),p.jsxs("select",{value:T,onChange:bt,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[p.jsx("option",{value:"",children:"All data centers"}),nt.map(Q=>p.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(rs,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),p.jsxs("select",{value:E,onChange:sr,disabled:!T,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${T?"":"bg-gray-100"}`,children:[p.jsx("option",{value:"",children:"Select a firewall type"}),Ve().map(Q=>p.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(rc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),p.jsxs("select",{value:(g==null?void 0:g.id)||"",onChange:Ct,disabled:!E,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${E?"":"bg-gray-100"}`,children:[p.jsx("option",{value:"",children:"Select a firewall"}),Ot().map(Q=>p.jsxs("option",{value:Q.id,children:[Q.name," - ",Q.ip_address]},Q.id))]})]})]})]})}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Configuration"}),p.jsx("div",{className:"space-y-4",children:U.length>0?U.map(Q=>p.jsxs("div",{className:"mb-6",children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[Q.label,Q.required&&p.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),p.jsx("div",{className:"relative",children:p.jsx("input",{type:Q.type==="string"?"text":Q.type,value:K[Q.name]||"",onChange:ve=>Oe(Q.name,ve.target.value),required:Q.required,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2",placeholder:`Enter ${Q.label.toLowerCase()}`})})]},Q.name)):p.jsx("div",{className:"text-center py-4 text-gray-500",children:E?"No fields defined for this firewall type":"Select a firewall type to see available fields"})})]})}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Slectionner une configuration"}),e.length>0?p.jsxs(p.Fragment,{children:[p.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg mb-4",value:(r==null?void 0:r.hostname)||"",onChange:Q=>{const ve=e.find(Be=>Be.hostname===Q.target.value);if(ve){n(ve),a(ve);const Be={};Object.entries(ve).forEach(([ft,gt])=>{Be[ft]=String(gt)}),V(Be)}},children:[p.jsx("option",{value:"",children:"Choisir une configuration"}),e.map((Q,ve)=>p.jsxs("option",{value:Q.hostname,children:[Q.hostname," - ",Q.ipAddress]},ve))]}),r&&p.jsxs("button",{onClick:()=>{a(r);const Q={};Object.entries(r).forEach(([ve,Be])=>{Q[ve]=String(Be)}),V(Q)},className:"w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 flex items-center justify-center",children:[p.jsx(Xy,{className:"w-5 h-5 mr-2"}),"Appliquer la configuration"]})]}):p.jsx("div",{className:"text-center py-4 text-gray-500",children:"Aucune configuration disponible. Veuillez importer un fichier Excel ou crer une configuration manuelle."})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Importer une configuration"}),p.jsx("div",{className:"space-y-4",children:E?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"mb-4",children:p.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Format Excel requis:"}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[p.jsx("thead",{className:"bg-gray-50",children:p.jsx("tr",{children:Object.entries(((or=(pt=P.find(Q=>Q.id===E))==null?void 0:pt.attributes_schema)==null?void 0:or.properties)||{}).map(([Q,ve])=>p.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider border-b border-gray-200",children:[ve.title," ",ve.required&&p.jsx("span",{className:"text-red-500 ml-1",children:"*"})]},Q))})}),p.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.jsx("tr",{children:Object.entries(((lt=(At=P.find(Q=>Q.id===E))==null?void 0:At.attributes_schema)==null?void 0:lt.properties)||{}).map(([Q,ve])=>p.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 border-b border-gray-200",children:ve.type==="string"?"Texte":ve.type},Q))})})]})}),p.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[p.jsx("span",{className:"text-red-500",children:"*"})," Champs obligatoires"]})]})}),p.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[p.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:fe,className:"hidden",id:"file-upload"}),p.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center",children:[p.jsx(qy,{className:"h-12 w-12 text-gray-400 mb-4"}),p.jsx("span",{className:"text-gray-600",children:"Choisir un fichier Excel"}),p.jsx("span",{className:"text-sm text-gray-500 mt-2",children:"Format: .xlsx, .xls"})]})]})]}):p.jsx("div",{className:"text-center py-8",children:p.jsx("p",{className:"text-gray-500",children:"Veuillez slectionner un type de pare-feu pour voir les champs requis"})})})]})]})]}),p.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Source Address Search"}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("input",{type:"text",value:K.SourceAddress||"",onChange:Q=>Oe("SourceAddress",Q.target.value),placeholder:"Enter source address",className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),p.jsx("button",{onClick:Ke,disabled:H||!g||!K.SourceAddress,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:H?"Searching...":"Search Address"})]}),rt&&p.jsx("div",{className:"mt-4 p-4 bg-red-50 text-red-700 rounded-md",children:rt}),_e&&p.jsx("div",{className:"mt-4 space-y-4",children:p.jsxs("div",{className:"p-4 bg-green-50 rounded-md",children:[p.jsx("h4",{className:"font-medium text-green-800 mb-4",children:"Search Results"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Source Address"}),p.jsx("p",{className:"font-medium text-gray-900",children:_e.ip})]}),p.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Config Path"}),p.jsx("p",{className:"font-medium text-gray-900",children:_e.config_path})]})]}),p.jsxs("div",{className:"mt-6",children:[p.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Matched Address Objects"}),_e.matches&&_e.matches.length>0?p.jsx("div",{className:"space-y-4",children:_e.matches.map((Q,ve)=>p.jsxs("div",{className:"border-l-4 border-green-500 pl-3",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),p.jsx("span",{className:"font-medium text-gray-900",children:Q.name})]}),Q.comment&&p.jsx("div",{className:"ml-4 mt-1",children:p.jsx("p",{className:"text-xs text-gray-500 italic",children:Q.comment})}),Q.groups&&Q.groups.length>0&&p.jsxs("div",{className:"ml-4 mt-2 text-sm text-blue-600",children:["Groups: ",Q.groups.join(", ")]})]},ve))}):p.jsx("p",{className:"text-gray-500 italic mt-2",children:"No matches found"})]}),_e.matches&&_e.matches.length>0&&p.jsxs("details",{className:"mt-4",children:[p.jsx("summary",{className:"text-sm text-gray-500 cursor-pointer",children:"Debug Information"}),p.jsx("div",{className:"mt-2 space-y-2",children:_e.matches.map((Q,ve)=>p.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[p.jsxs("p",{children:[p.jsx("span",{className:"text-gray-500",children:"Name:"})," ",Q.name]}),Q.comment&&p.jsxs("p",{children:[p.jsx("span",{className:"text-gray-500",children:"Comment:"})," ",Q.comment]}),Q.groups&&Q.groups.length>0&&p.jsxs("p",{children:[p.jsx("span",{className:"text-gray-500",children:"Groups:"})," ",Q.groups.join(", ")]})]},ve))})]})]})})]}),p.jsxs("div",{className:"mt-8 bg-gray-900 rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[p.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),p.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),p.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),p.jsx("h2",{className:"text-xl font-semibold text-gray-200 ml-2",children:"Terminal"})]}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"text-gray-400",children:"Selected Firewall:"}),p.jsx("span",{className:"text-purple-400",children:g?`${g.name} (${g.ip_address})`:"None"})]}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"text-gray-400",children:"Template:"})]}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsxs("select",{value:O,onChange:Q=>J(Q.target.value),className:"flex-1 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:ie,children:[p.jsx("option",{value:"",children:"Select a template..."}),X.map(Q=>p.jsx("option",{value:Q.name,children:Q.name},Q.id))]}),p.jsx("button",{onClick:ct,disabled:!O||ie,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:ie?"Loading...":"Apply Template"})]}),Le&&p.jsx("div",{className:"mt-2 text-sm text-red-400",children:Le})]}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsxs("div",{className:"flex-1 relative",children:[p.jsx("span",{className:"absolute left-3 top-2 text-green-400",children:"$"}),p.jsx("textarea",{value:G,onChange:Q=>de(Q.target.value),placeholder:"Enter command...",className:"w-full h-32 pl-8 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm resize-none",onKeyDown:Q=>{Q.key==="Enter"&&!Q.shiftKey&&(Q.preventDefault(),Tt(G))}})]}),p.jsxs("div",{className:"flex flex-col space-y-2",children:[p.jsx("button",{onClick:Q=>{Q.preventDefault(),Tt(G)},disabled:re||!g||!G.trim(),className:`px-4 py-2 rounded-md transition-colors duration-200 ${re?"bg-yellow-600 text-white":!g||!G.trim()?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:re?p.jsxs("div",{className:"flex items-center",children:[p.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Executing..."]}):"Execute"}),p.jsx("button",{onClick:()=>de(""),className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors duration-200",children:"Clear"})]})]})]}),Se&&p.jsxs("div",{className:"mb-4 p-4 bg-gray-800 rounded-md border border-gray-700",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("span",{className:"text-gray-400 text-lg",children:"Output:"}),p.jsx("button",{onClick:()=>ce(""),className:"text-gray-500 hover:text-gray-400",children:"Clear"})]}),p.jsx("pre",{className:"text-sm overflow-auto max-h-96 font-mono text-gray-300 p-4 bg-gray-900 rounded-md",children:Se})]}),ae&&p.jsxs("div",{className:"mb-4 p-4 bg-red-900/50 text-red-400 rounded-md border border-red-700",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-red-500 font-semibold",children:"Error:"}),p.jsx("button",{onClick:()=>pe(null),className:"text-red-500 hover:text-red-400",children:"Clear"})]}),p.jsx("p",{className:"mt-2",children:ae})]}),Y.length>0&&p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"text-gray-400",children:"History:"})]}),p.jsx("button",{onClick:()=>xe([]),className:"text-gray-500 hover:text-gray-400 text-sm",children:"Clear History"})]}),p.jsx("div",{className:"space-y-2",children:Y.map((Q,ve)=>p.jsxs("div",{className:"bg-gray-800 rounded-md p-3 border border-gray-700",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:"text-green-400",children:"$"}),p.jsx("span",{className:"font-mono text-sm text-gray-300",children:Q.command})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:`px-2 py-1 rounded text-xs ${Q.status==="completed"?"bg-green-900 text-green-300":Q.status==="failed"?"bg-red-900 text-red-300":Q.status==="executing"?"bg-yellow-900 text-yellow-300":"bg-gray-900 text-gray-300"}`,children:Q.status}),p.jsx("span",{className:"text-xs text-gray-500",children:new Date(Q.executed_at).toLocaleString()})]})]}),Q.output&&p.jsx("pre",{className:`text-sm overflow-auto max-h-40 font-mono ${Q.status==="completed"?"text-gray-300":"text-red-400"}`,children:Q.output}),Q.error_message&&p.jsxs("div",{className:"mt-2 text-sm text-red-400",children:["Error: ",Q.error_message]})]},`${Q.id}-${Q.executed_at}-${ve}`))})]})]})]})},lO=()=>localStorage.getItem("token"),lf=$e.create({baseURL:xi});lf.interceptors.request.use(e=>{const t=lO();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));lf.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function cO(){Gi();const[e,t]=N.useState(""),[r,n]=N.useState("show"),[i,a]=N.useState(!1),[o,l]=N.useState(null),[u,f]=N.useState(null),[d,m]=N.useState([]);N.useState(!1);const[g,_]=N.useState([]),[y,v]=N.useState(""),[T,k]=N.useState(""),[E,w]=N.useState(null);N.useEffect(()=>{(async()=>{try{a(!0),l(null);const G=await lf.get("/datacenters/hierarchy/");_(G.data)}catch(G){console.error("Error fetching hierarchy:",G),l("Failed to fetch hierarchy data")}finally{a(!1)}})()},[]);const P=()=>{if(!y)return[];const V=g.find(G=>G.id===y);return V?V.firewall_types:[]},I=()=>{if(!T)return[];const V=g.find(de=>de.id===y);if(!V)return[];const G=V.firewall_types.find(de=>de.id===T);return G?G.firewalls:[]},M=V=>{const G=V.target.value;v(G),k(""),w(null),m([])},b=V=>{const G=V.target.value;k(G),w(null),m([])},U=()=>{const V=I();d.length===V.length?m([]):m(V.map(G=>G.id))},j=V=>{m(G=>G.includes(V)?G.filter(de=>de!==V):[...G,V])},K=async()=>{if(!d.length&&!T){l("Please select firewalls or a firewall type");return}a(!0),l(null),f(null);try{const V=d.length>0?I().filter(ce=>d.includes(ce.id)):I(),G=await Promise.all(V.map(async ce=>{try{const Y=await lf.post("/command/commands/save_config/",{firewall_id:ce.id,command:r},{responseType:"blob"}),xe=window.URL.createObjectURL(new Blob([Y.data])),re=document.createElement("a"),q=Y.headers["x-file-name"]||`${ce.name}_config.txt`;return re.href=xe,re.setAttribute("download",q),document.body.appendChild(re),re.click(),re.remove(),window.URL.revokeObjectURL(xe),{success:!0,firewall:ce.name}}catch(Y){return console.error(`Error saving config for ${ce.name}:`,Y),{success:!1,firewall:ce.name,error:Y}}})),de=G.filter(ce=>ce.success),Se=G.filter(ce=>!ce.success);de.length>0&&f(`${de.length} configurations saved and downloaded successfully`),Se.length>0&&l(`Failed to save ${Se.length} firewalls: ${Se.map(ce=>ce.firewall).join(", ")}`)}catch(V){console.error("Error during bulk save:",V),l("Failed to save configurations")}finally{a(!1)}};return i?p.jsx("div",{className:"p-8",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),p.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):o?p.jsx("div",{className:"p-8",children:p.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[p.jsx("strong",{className:"font-bold",children:"Error!"}),p.jsxs("span",{className:"block sm:inline",children:[" ",o]})]})}):p.jsxs("div",{className:"p-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall Configuration"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"Manage firewall configurations"}),p.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:p.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(tc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),p.jsxs("select",{value:y,onChange:M,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[p.jsx("option",{value:"",children:"All data centers"}),g.map(V=>p.jsx("option",{value:V.id,children:V.name},V.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(rs,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),p.jsxs("select",{value:T,onChange:b,disabled:!y,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${y?"":"bg-gray-100"}`,children:[p.jsx("option",{value:"",children:"Select a firewall type"}),P().map(V=>p.jsx("option",{value:V.id,children:V.name},V.id))]})]})]}),p.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[p.jsx(rc,{className:"h-6 w-6 text-purple-600"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),p.jsxs("div",{className:"mt-1 space-y-2",children:[p.jsx("button",{onClick:U,disabled:!T,className:`w-full px-3 py-1 text-sm rounded-md ${d.length===I().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${T?"":"opacity-50 cursor-not-allowed"}`,children:d.length===I().length?"Deselect All":"Select All"}),p.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:I().map(V=>p.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${d.includes(V.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>j(V.id),children:[p.jsx("input",{type:"checkbox",checked:d.includes(V.id),onChange:()=>j(V.id),className:"mr-2"}),p.jsxs("span",{className:"text-sm",children:[V.name," - ",V.ip_address]})]},V.id))})]})]})]})]})}),p.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP Address"}),p.jsx("input",{type:"text",value:e,onChange:V=>t(V.target.value),placeholder:"e.g., 192.168.1.1",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Command"}),p.jsx("input",{type:"text",value:r,onChange:V=>n(V.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),o&&p.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md",children:o}),u&&p.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md",children:u}),p.jsx("div",{className:"flex space-x-4",children:p.jsxs("button",{onClick:K,disabled:i||!d.length&&!T,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[p.jsx(Xy,{className:"h-5 w-5 mr-2"}),i?"Saving...":"Save Configuration"]})})]})})]})}const Px=["Hostname","IP Adresse","VDOM","Name","SourceAddress","SourceDescription","SourceInterface","DestinationAddress","DestinationDescription","DestinationInterface","service"];function uO(){const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState([]),[o,l]=N.useState({name:"",description:"",location:"",latitude:"",longitude:""}),[u,f]=N.useState({name:"",description:""}),[d,m]=N.useState([]),[g,_]=N.useState({}),[y,v]=N.useState(!1),[T,k]=N.useState(null),[E,w]=N.useState({}),[P,I]=N.useState(""),[M,b]=N.useState(""),[U,j]=N.useState(!1),[K,V]=N.useState(null),[G,de]=N.useState(null),[Se,ce]=N.useState(null);N.useState(1);const[Y,xe]=N.useState(null),[re,q]=N.useState(!1),[ae,pe]=N.useState(null),[O,J]=N.useState(!1),[X,W]=N.useState({name:"",ip_address:"",firewall_type:""}),[ie,we]=N.useState(!1),[Le,Ae]=N.useState(""),_e=()=>{const fe=localStorage.getItem("token");if(!fe)throw new Error("No authentication token found");return fe},ze=$e.create({baseURL:xi,headers:{"Content-Type":"application/json"}});ze.interceptors.request.use(fe=>{var ge;try{const Ee=_e();return Ee&&(fe.headers.Authorization=`Bearer ${Ee}`),(ge=fe.url)!=null&&ge.startsWith("/api/")&&(fe.url=fe.url.replace("/api/","/")),fe}catch(Ee){console.error("Authentication error:",Ee),Xu("/login")}return fe},fe=>Promise.reject(fe)),ze.interceptors.response.use(fe=>fe,fe=>(fe.response&&fe.response.status===401&&(localStorage.removeItem("token"),Xu("/login")),Promise.reject(fe)));const H=async()=>{var fe,ge,Ee;try{v(!0);const[Oe,He,Tt]=await Promise.all([ze.get("/firewalls/firewall-types/"),ze.get("/datacenters/"),ze.get("/firewalls/")]);console.log("API Responses:",{firewallTypes:Oe.data,dataCenters:He.data,firewalls:Tt.data});const ct=Array.isArray((fe=Oe.data)==null?void 0:fe.results)?Oe.data.results:[],Ke=Array.isArray((ge=He.data)==null?void 0:ge.results)?He.data.results:[],Je=Array.isArray((Ee=Tt.data)==null?void 0:Ee.results)?Tt.data.results:[],ut=Ke.map(lt=>({id:lt.id,name:lt.name,description:lt.description||"",location:lt.location||"",latitude:lt.latitude?parseFloat(lt.latitude):null,longitude:lt.longitude?parseFloat(lt.longitude):null,owner:lt.owner||"",owner_username:lt.owner_username||"",created_at:lt.created_at,updated_at:lt.updated_at,is_active:lt.is_active,firewall_count:lt.firewall_count||0,firewall_type_count:lt.firewall_type_count||0,firewalls:Je.filter(Q=>{var ve;return((ve=Q.data_center)==null?void 0:ve.id)===lt.id}),firewall_types:ct.filter(Q=>Q.data_center===lt.id)}));console.log("Formatted Data Centers:",ut),t(ut);const pt=localStorage.getItem("selectedFirewallId"),or=localStorage.getItem("firewallType"),At=localStorage.getItem("dataCenter");if(pt){const lt=Je.find(Q=>Q.id===pt);lt&&(k(lt),w(Q=>({...Q,ipAddress:lt.ip_address})))}or&&I(or),At&&b(At)}catch(Oe){console.error("Error fetching data:",Oe),alert("Erreur lors du chargement des donnes. Veuillez rafrachir la page.")}finally{v(!1)}};N.useEffect(()=>{H()},[]);const Ye=async()=>{await H()},rt=fe=>{n(ge=>ge.includes(fe)?ge.filter(Ee=>Ee!==fe):[...ge,fe])},et=fe=>{a(ge=>ge.includes(fe)?ge.filter(Ee=>Ee!==fe):[...ge,fe])},Ge=async()=>{var fe,ge,Ee,Oe,He,Tt,ct,Ke,Je,ut;if(o.name)try{let pt=null,or=null;if(o.latitude){const Q=parseFloat(o.latitude);if(!isNaN(Q)&&Q>=-90&&Q<=90)pt=Number(Q.toFixed(6));else{alert("La latitude doit tre comprise entre -90 et 90 degrs");return}}if(o.longitude){const Q=parseFloat(o.longitude);if(!isNaN(Q)&&Q>=-180&&Q<=180)or=Number(Q.toFixed(6));else{alert("La longitude doit tre comprise entre -180 et 180 degrs");return}}const At={name:o.name.trim(),description:o.description.trim()||null,location:o.location.trim()||null,latitude:pt,longitude:or,is_active:!0};if(At.latitude!==null&&At.longitude===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(At.latitude===null&&At.longitude!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}console.log("Sending data to API:",At);const lt=await ze.post("/datacenters/",At);console.log("API Response:",lt.data),l({name:"",description:"",location:"",latitude:"",longitude:""}),await Ye()}catch(pt){if(console.error("Error creating data center:",pt),console.error("Error response:",(fe=pt.response)==null?void 0:fe.data),(Ee=(ge=pt.response)==null?void 0:ge.data)!=null&&Ee.longitude)alert(`Erreur de longitude: ${pt.response.data.longitude[0]}`);else if((He=(Oe=pt.response)==null?void 0:Oe.data)!=null&&He.latitude)alert(`Erreur de latitude: ${pt.response.data.latitude[0]}`);else{const or=((ct=(Tt=pt.response)==null?void 0:Tt.data)==null?void 0:ct.detail)||((ut=(Je=(Ke=pt.response)==null?void 0:Ke.data)==null?void 0:Je.non_field_errors)==null?void 0:ut[0])||"Erreur lors de la cration du datacenter. Veuillez ressayer.";alert(or)}}else alert("Le nom du datacenter est requis")},Ne=async fe=>{var Oe,He,Tt,ct,Ke,Je;const{name:ge,description:Ee}=u;if(ge)try{const ut=Object.entries(g).filter(([At,lt])=>lt).map(([At])=>At),pt={name:ge,description:Ee||"",data_center:fe,attributes_schema:{type:"object",properties:ut.reduce((At,lt)=>{const Q=d.find(ve=>ve.name===lt);return Q&&(At[lt]={type:"string",title:Q.label,required:Q.required}),At},{}),required:ut.filter(At=>{const lt=d.find(Q=>Q.name===At);return lt==null?void 0:lt.required})}};console.log("Creating firewall type with data:",pt);const or=await ze.post("/firewalls/firewall-types/",pt,{headers:{"Content-Type":"application/json",Accept:"application/json"}});console.log("Firewall type created successfully:",or.data),f({name:"",description:""}),_(d.reduce((At,lt)=>({...At,[lt.name]:!1}),{})),await Ye()}catch(ut){console.error("Error creating firewall type:",ut),console.error("Error response:",(Oe=ut.response)==null?void 0:Oe.data);const pt=((Tt=(He=ut.response)==null?void 0:He.data)==null?void 0:Tt.detail)||((Je=(Ke=(ct=ut.response)==null?void 0:ct.data)==null?void 0:Ke.owner)==null?void 0:Je[0])||"Erreur lors de la cration du type de pare-feu.";alert(pt)}},le=async fe=>{var ge,Ee;try{await ze.delete(`/datacenters/${fe}/`),await Ye()}catch(Oe){console.error("Error deleting data center:",Oe);const He=((Ee=(ge=Oe.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||"Erreur lors de la suppression du datacenter.";alert(He)}},Pe=async fe=>{var ge,Ee;if(window.confirm("tes-vous sr de vouloir supprimer ce type de pare-feu ?"))try{await ze.delete(`/firewalls/firewall-types/${fe}/`),await Ye()}catch(Oe){console.error("Error deleting firewall type:",Oe);const He=((Ee=(ge=Oe.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||"Erreur lors de la suppression du type de pare-feu.";alert(He)}},Fe=N.useCallback(fe=>{fe.preventDefault(),j(!0)},[]),Ue=N.useCallback(fe=>{fe.preventDefault(),j(!1)},[]),nt=N.useCallback(async(fe,ge)=>{var He,Tt;fe.preventDefault(),j(!1),de(null),V(0);const Oe=Array.from(fe.dataTransfer.files).filter(ct=>ct.type==="text/csv"||ct.name.endsWith(".csv"));if(Oe.length===0){de("Veuillez dposer uniquement des fichiers CSV");return}for(const ct of Oe)try{const Ke=new FormData;Ke.append("file",ct),Ke.append("firewall_type",ge);const Je=await ze.post("/api/firewalls/upload-csv/",Ke,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:ut=>{const pt=ut.total?Math.round(ut.loaded*100/ut.total):0;V(pt)}});if(Je.data.success)ce(`Fichier tlcharg avec succs. ${Je.data.created_count} pare-feu(s) cr(s).`),de(null),await Ye();else{const ut=Je.data.error||"Erreur lors du tlchargement",pt=Je.data.errors||[];de(`${ut}
${pt.join(`
`)}`)}}catch(Ke){console.error("Error uploading CSV:",Ke);const Je=((Tt=(He=Ke.response)==null?void 0:He.data)==null?void 0:Tt.error)||"Erreur lors du tlchargement du fichier";de(Je)}},[Ye]),tt=fe=>{xe(fe),q(!0)},Ve=async()=>{var fe,ge,Ee,Oe,He,Tt,ct;if(Y)try{let Ke=Y.latitude,Je=Y.longitude;if(Ke!==null&&(Ke<-90||Ke>90)){alert("La latitude doit tre comprise entre -90 et 90 degrs");return}if(Je!==null&&(Je<-180||Je>180)){alert("La longitude doit tre comprise entre -180 et 180 degrs");return}if(Ke!==null&&Je===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(Ke===null&&Je!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}const ut={name:Y.name.trim(),description:((fe=Y.description)==null?void 0:fe.trim())||null,location:((ge=Y.location)==null?void 0:ge.trim())||null,latitude:Ke,longitude:Je,is_active:Y.is_active};await ze.put(`/datacenters/${Y.id}/`,ut),q(!1),xe(null),await Ye()}catch(Ke){console.error("Error updating data center:",Ke);const Je=((Oe=(Ee=Ke.response)==null?void 0:Ee.data)==null?void 0:Oe.detail)||((ct=(Tt=(He=Ke.response)==null?void 0:He.data)==null?void 0:Tt.non_field_errors)==null?void 0:ct[0])||"Erreur lors de la mise  jour du datacenter.";alert(Je)}},Ot=fe=>{pe(fe),J(!0)},bt=async()=>{var fe,ge,Ee,Oe,He,Tt;if(ae)try{const ct=Object.entries(g).filter(([Je,ut])=>ut).map(([Je])=>Je),Ke={name:ae.name.trim(),description:((fe=ae.description)==null?void 0:fe.trim())||"",data_center:ae.data_center,attributes_schema:{type:"object",properties:ct.reduce((Je,ut)=>{const pt=d.find(or=>or.name===ut);return pt&&(Je[ut]={type:"string",title:pt.label,required:pt.required}),Je},{}),required:ct.filter(Je=>{const ut=d.find(pt=>pt.name===Je);return ut==null?void 0:ut.required})}};await ze.put(`/firewalls/firewall-types/${ae.id}/`,Ke),J(!1),pe(null),await Ye()}catch(ct){console.error("Error updating firewall type:",ct);const Ke=((Ee=(ge=ct.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||((Tt=(He=(Oe=ct.response)==null?void 0:Oe.data)==null?void 0:He.non_field_errors)==null?void 0:Tt[0])||"Erreur lors de la mise  jour du type de pare-feu.";alert(Ke)}},sr=async fe=>{var ge,Ee;if(!X.name||!X.ip_address){alert("Le nom et l'adresse IP sont requis");return}try{const Oe=e.flatMap(Je=>Je.firewall_types).find(Je=>Je.id===fe);if(!Oe)throw new Error("Type de firewall non trouv");let He;const Tt=localStorage.getItem("userData");if(Tt?He=JSON.parse(Tt).id:He=(await ze.get("/auth/users/me/")).data.id,!He)throw new Error("Impossible de rcuprer l'ID de l'utilisateur");const ct={name:X.name.trim(),ip_address:X.ip_address.trim(),firewall_type:fe,data_center:Oe.data_center,owner:He};console.log("Sending data to API:",ct);const Ke=await ze.post("/firewalls/firewalls/",ct);console.log("API Response:",Ke.data),W({name:"",ip_address:"",firewall_type:""}),we(!1),await Ye()}catch(Oe){console.error("Error creating firewall:",Oe),console.error("Error response:",(ge=Oe.response)==null?void 0:ge.data);let He="Erreur lors de la cration du pare-feu.";(Ee=Oe.response)!=null&&Ee.data&&(typeof Oe.response.data=="object"?He=`Erreurs de validation:
${Object.entries(Oe.response.data).map(([ct,Ke])=>`${ct}: ${Array.isArray(Ke)?Ke.join(", "):Ke}`).join(`
`)}`:typeof Oe.response.data=="string"?He=Oe.response.data:Oe.response.data.detail&&(He=Oe.response.data.detail)),alert(He)}},Ct=async fe=>{var ge,Ee;if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await ze.delete(`/firewalls/${fe}/`),await Ye()}catch(Oe){console.error("Error deleting firewall:",Oe);const He=((Ee=(ge=Oe.response)==null?void 0:ge.data)==null?void 0:Ee.detail)||"Erreur lors de la suppression du pare-feu.";alert(He)}},$t=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Liste des Datacenters et Types de Firewall"}),p.jsx("div",{className:"space-y-4",children:e.map(fe=>{var ge;return p.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[p.jsxs("div",{className:"bg-gray-50 p-4 flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:fe.name}),p.jsx("p",{className:"text-sm text-gray-500",children:fe.location})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("button",{onClick:()=>tt(fe),className:"px-3 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-2",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),p.jsxs("button",{onClick:()=>le(fe.id),className:"px-3 py-1.5 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-2",children:[p.jsx(Nn,{className:"h-4 w-4"}),"Supprimer"]})]})]}),p.jsxs("div",{className:"p-4",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Types de Firewall"}),p.jsx("div",{className:"space-y-3",children:(ge=fe.firewall_types)==null?void 0:ge.map(Ee=>{var Oe;return p.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-gray-900",children:Ee.name}),p.jsx("p",{className:"text-sm text-gray-500",children:Ee.description}),p.jsxs("div",{className:"mt-2",children:[p.jsx("p",{className:"text-xs text-gray-500",children:"Attributs configurs:"}),p.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:((Oe=Ee.attributes_schema)==null?void 0:Oe.properties)&&Object.entries(Ee.attributes_schema.properties).sort(([He],[Tt])=>{const ct=Px.indexOf(He),Ke=Px.indexOf(Tt);return ct===-1?1:Ke===-1?-1:ct-Ke}).map(([He,Tt])=>p.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:He},He))})]})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("button",{onClick:()=>{Ae(Ee.id),we(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[p.jsx(Vs,{className:"h-3 w-3"}),"Ajouter Firewall"]}),p.jsxs("button",{onClick:()=>Ot(Ee),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),p.jsxs("button",{onClick:()=>Pe(Ee.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[p.jsx(Nn,{className:"h-3 w-3"}),"Supprimer"]})]})]})},Ee.id)})})]})]},fe.id)})})]}),Xe=(fe,ge)=>{var Ee;return p.jsxs("div",{className:"ml-6 mb-4",children:[p.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-md",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:()=>et(ge.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:i.includes(ge.id)?p.jsx(w1,{size:20}):p.jsx(k1,{size:20})}),p.jsx("span",{className:"font-medium",children:ge.name})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("button",{onClick:()=>{Ae(ge.id),we(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[p.jsx(Vs,{className:"h-3 w-3"}),"Ajouter Firewall"]}),p.jsxs("button",{onClick:()=>Ot(ge),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),p.jsxs("button",{onClick:()=>Pe(ge.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[p.jsx(Nn,{className:"h-3 w-3"}),"Supprimer"]})]})]}),i.includes(ge.id)&&p.jsxs("div",{className:"mt-2 p-4 bg-white rounded-md shadow",children:[p.jsxs("div",{className:"mb-4",children:[p.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pare-feu existants"}),p.jsx("div",{className:"space-y-2",children:(Ee=ge.firewalls)==null?void 0:Ee.map(Oe=>p.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-gray-900",children:Oe.name}),p.jsx("p",{className:"text-sm text-gray-500",children:Oe.ip_address})]}),p.jsx("button",{onClick:()=>Ct(Oe.id),className:"text-red-500 hover:text-red-700",children:p.jsx(Nn,{className:"h-4 w-4"})})]},Oe.id))})]}),p.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center ${U?"border-purple-500 bg-purple-50":"border-gray-300"}`,onDragOver:Fe,onDragLeave:Ue,onDrop:Oe=>nt(Oe,ge.id),children:[p.jsx(qy,{className:"mx-auto h-12 w-12 text-gray-400"}),p.jsxs("div",{className:"mt-4",children:[p.jsx("p",{className:"text-sm text-gray-600",children:"Glissez et dposez vos fichiers CSV ici"}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ou cliquez pour slectionner des fichiers"})]}),K!==null&&p.jsxs("div",{className:"mt-4",children:[p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:p.jsx("div",{className:"bg-purple-600 h-2.5 rounded-full",style:{width:`${K}%`}})}),p.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Progression: ",K,"%"]})]}),G&&p.jsx("p",{className:"text-red-500 text-sm mt-2",children:G})]})]})]},ge.id)};return N.useEffect(()=>{(async()=>{try{const Ee=(await Ls.getVariables()).map(Oe=>({name:Oe.name,label:Oe.name,required:!1}));m(Ee),_(Ee.reduce((Oe,He)=>({...Oe,[He.name]:!1}),{}))}catch(ge){console.error("Error loading variables:",ge)}})()},[]),p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Paramtres CMS"}),p.jsx("p",{className:"text-gray-600",children:"Grez la structure des data centers et leurs types de firewalls"})]}),p.jsxs("button",{onClick:Ye,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Rafrachir"]})]}),y?p.jsx("div",{className:"flex justify-center items-center h-64",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):p.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[$t(),p.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Structure"}),p.jsx("div",{className:"mb-6 p-4 border border-dashed border-gray-300 rounded-lg",children:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"text",placeholder:"Nom du Data Center *",value:o.name,onChange:fe=>l(ge=>({...ge,name:fe.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",required:!0}),p.jsx("button",{onClick:Ge,className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:p.jsx(Vs,{className:"w-4 h-4"})})]}),p.jsx("textarea",{placeholder:"Description",value:o.description,onChange:fe=>l(ge=>({...ge,description:fe.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),p.jsx("input",{type:"text",placeholder:"Adresse physique",value:o.location,onChange:fe=>l(ge=>({...ge,location:fe.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm"}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("div",{children:[p.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude (-90  90)",value:o.latitude,onChange:fe=>{const ge=fe.target.value;(ge===""||parseFloat(ge)>=-90&&parseFloat(ge)<=90)&&l(Ee=>({...Ee,latitude:ge}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: 33.552084"})]}),p.jsxs("div",{children:[p.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude (-180  180)",value:o.longitude,onChange:fe=>{const ge=fe.target.value;(ge===""||parseFloat(ge)>=-180&&parseFloat(ge)<=180)&&l(Ee=>({...Ee,longitude:ge}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"}),p.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: -7.657616"})]})]})]})}),p.jsx("div",{className:"space-y-2",children:Array.isArray(e)&&e.map(fe=>{var ge;return p.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[p.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-t-lg",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:()=>rt(fe.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:r.includes(fe.id)?p.jsx(w1,{className:"w-4 h-4"}):p.jsx(k1,{className:"w-4 h-4"})}),p.jsx("span",{className:"font-medium",children:fe.name})]}),p.jsx("button",{onClick:()=>le(fe.id),className:"text-red-500 hover:text-red-700",children:p.jsx(Nn,{className:"w-4 h-4"})})]}),r.includes(fe.id)&&p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsx("div",{className:"p-4 border border-dashed border-gray-300 rounded-lg",children:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"text",placeholder:"Nom du type de pare-feu",value:u.name,onChange:Ee=>f(Oe=>({...Oe,name:Ee.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm"}),p.jsx("button",{onClick:()=>Ne(fe.id),className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:p.jsx(Vs,{className:"w-4 h-4"})})]}),p.jsx("textarea",{placeholder:"Description",value:u.description,onChange:Ee=>f(Oe=>({...Oe,description:Ee.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(Ee=>p.jsxs("label",{className:"flex items-center space-x-2",children:[p.jsx("input",{type:"checkbox",checked:g[Ee.name],onChange:Oe=>_(He=>({...He,[Ee.name]:Oe.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),p.jsx("span",{className:"text-sm text-gray-700",children:Ee.label})]},Ee.name))})]})}),p.jsx("div",{className:"space-y-2",children:(ge=fe.firewall_types)==null?void 0:ge.map(Ee=>Xe(fe,Ee))})]})]},fe.id)})})]})})})]}),re&&Y&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Data Center"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),p.jsx("input",{type:"text",value:Y.name,onChange:fe=>xe(ge=>ge?{...ge,name:fe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),p.jsx("textarea",{value:Y.description||"",onChange:fe=>xe(ge=>ge?{...ge,description:fe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse physique"}),p.jsx("input",{type:"text",value:Y.location||"",onChange:fe=>xe(ge=>ge?{...ge,location:fe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm"})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude (-90  90)"}),p.jsx("input",{type:"number",step:"0.000001",value:Y.latitude||"",onChange:fe=>{const ge=fe.target.value===""?null:parseFloat(fe.target.value);(ge===null||ge>=-90&&ge<=90)&&xe(Ee=>Ee?{...Ee,latitude:ge}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude (-180  180)"}),p.jsx("input",{type:"number",step:"0.000001",value:Y.longitude||"",onChange:fe=>{const ge=fe.target.value===""?null:parseFloat(fe.target.value);(ge===null||ge>=-180&&ge<=180)&&xe(Ee=>Ee?{...Ee,longitude:ge}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"})]})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx("input",{type:"checkbox",checked:Y.is_active,onChange:fe=>xe(ge=>ge?{...ge,is_active:fe.target.checked}:null),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),p.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Actif"})]})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx("button",{onClick:()=>{q(!1),xe(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),p.jsx("button",{onClick:Ve,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),O&&ae&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Type de Pare-feu"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),p.jsx("input",{type:"text",value:ae.name,onChange:fe=>pe(ge=>ge?{...ge,name:fe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),p.jsx("textarea",{value:ae.description||"",onChange:fe=>pe(ge=>ge?{...ge,description:fe.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attributs de configuration"}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(fe=>p.jsxs("label",{className:"flex items-center space-x-2",children:[p.jsx("input",{type:"checkbox",checked:g[fe.name],onChange:ge=>_(Ee=>({...Ee,[fe.name]:ge.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),p.jsx("span",{className:"text-sm text-gray-700",children:fe.label})]},fe.name))})]})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx("button",{onClick:()=>{J(!1),pe(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),p.jsx("button",{onClick:bt,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),ie&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ajouter un Pare-feu"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),p.jsx("input",{type:"text",value:X.name,onChange:fe=>W(ge=>({...ge,name:fe.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP *"}),p.jsx("input",{type:"text",value:X.ip_address,onChange:fe=>W(ge=>({...ge,ip_address:fe.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0,placeholder:"Ex: 192.168.1.1"})]})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx("button",{onClick:()=>{we(!1),W({name:"",ip_address:"",firewall_type:""})},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),p.jsx("button",{onClick:()=>sr(Le),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Ajouter"})]})]})})]})}const Ba=$e.create({baseURL:xi});Ba.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ba.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));const Fx={getFirewalls:async()=>{try{return(await Ba.get("/firewalls/firewalls/")).data.results||[]}catch(e){throw e}},getFirewall:async e=>{try{return(await Ba.get(`/firewalls/firewalls/${e}/`)).data}catch(t){throw t}},createFirewall:async e=>{try{return(await Ba.post("/firewalls/firewalls/",e)).data}catch(t){throw t}},updateFirewall:async(e,t)=>{try{return(await Ba.put(`/firewalls/firewalls/${e}/`,t)).data}catch(r){throw r}},deleteFirewall:async e=>{try{await Ba.delete(`/firewalls/firewalls/${e}/`)}catch(t){throw t}}},fO=()=>{const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState(""),[o,l]=N.useState(!0),[u,f]=N.useState(null),[d,m]=N.useState(0);N.useEffect(()=>{(async()=>{try{l(!0);const v=await Fx.getFirewalls(),T=Array.isArray(v)?v:v.results||[];t(T),n(T),f(null)}catch(v){f(`Erreur lors de la rcupration des pare-feux: ${v.message||"Erreur inconnue"}`)}finally{l(!1)}})()},[d]),N.useEffect(()=>{if(!i.trim()){n(e);return}const y=i.toLowerCase().trim(),v=e.filter(T=>T.name.toLowerCase().includes(y)||T.ip_address.toLowerCase().includes(y));n(v)},[i,e]);const g=()=>{m(y=>y+1)},_=async y=>{if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await Fx.deleteFirewall(y),t(e.filter(v=>v.id!==y))}catch{f("Erreur lors de la suppression du pare-feu")}};return o?p.jsx("div",{className:"flex items-center justify-center h-screen",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Liste des Pare-feux"}),p.jsx("p",{className:"text-gray-600",children:"Grez vos pare-feux et leurs configurations"})]}),p.jsxs("button",{onClick:g,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[p.jsx($3,{className:"w-4 h-4"}),"Rafrachir"]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx(Z3,{className:"h-5 w-5 text-gray-400"})}),p.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Rechercher par nom ou adresse IP...",value:i,onChange:y=>a(y.target.value)})]}),i&&p.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:[r.length," pare-feu",r.length!==1?"x":""," trouv",r.length!==1?"s":""]})]}),u&&p.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md",children:u}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(y=>{var v;return p.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200",children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex items-start justify-between",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx(rs,{className:"h-8 w-8 text-purple-600 mr-3"}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:y.name}),p.jsx("p",{className:"text-gray-500 text-sm",children:y.ip_address})]})]}),p.jsx("div",{className:"flex space-x-2",children:p.jsx("button",{onClick:()=>_(y.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors duration-200",children:p.jsx(Nn,{className:"h-5 w-5"})})})]}),p.jsxs("div",{className:"mt-4 space-y-3",children:[p.jsxs("div",{className:"flex items-center text-gray-600",children:[p.jsx(tc,{className:"h-5 w-5 mr-2"}),p.jsxs("span",{children:["Data Center: ",((v=y.data_center_info)==null?void 0:v.name)||"N/A"]})]}),p.jsxs("div",{className:"flex items-center text-gray-600",children:[p.jsx(rc,{className:"h-5 w-5 mr-2"}),p.jsxs("span",{children:["Type: ",typeof y.firewall_type=="object"&&y.firewall_type?y.firewall_type.name:"N/A"]})]})]})]})},y.id)})}),r.length===0&&!o&&p.jsxs("div",{className:"text-center py-12",children:[p.jsx(rs,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i?"Aucun rsultat trouv":"Aucun pare-feu trouv"}),p.jsx("p",{className:"text-gray-500 mt-2",children:i?"Essayez de modifier votre recherche":"Commencez par ajouter un nouveau pare-feu."})]})]})};function Yp(e,t){const r=N.useRef(t);N.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function dO(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const Ow=1;function Rw(e){return Object.freeze({__version:Ow,map:e})}function Jp(e,t){return Object.freeze({...e,...t})}const Qp=N.createContext(null),em=Qp.Provider;function ko(){const e=N.useContext(Qp);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function tm(e){function t(r,n){const{instance:i,context:a}=e(r).current;return N.useImperativeHandle(n,()=>i),r.children==null?null:Kn.createElement(em,{value:a},r.children)}return N.forwardRef(t)}function Mw(e){function t(r,n){const[i,a]=N.useState(!1),{instance:o}=e(r,a).current;N.useImperativeHandle(n,()=>o),N.useEffect(function(){i&&o.update()},[o,i,r.children]);const l=o._contentNode;return l?iy.createPortal(r.children,l):null}return N.forwardRef(t)}function rm(e){function t(r,n){const{instance:i}=e(r).current;return N.useImperativeHandle(n,()=>i),null}return N.forwardRef(t)}function Iw(e){return function(r){const n=ko(),i=e(r,n),{instance:a}=i.current,o=N.useRef(r.position),{position:l}=r;return N.useEffect(function(){return a.addTo(n.map),function(){a.remove()}},[n.map,a]),N.useEffect(function(){l!=null&&l!==o.current&&(a.setPosition(l),o.current=l)},[a,l]),i}}function Bf(e,t){const r=N.useRef();N.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function cc(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function Dw(e,t){return function(n,i){const a=ko(),o=e(cc(n,a),a);return Yp(a.map,n.attribution),Bf(o.current,n.eventHandlers),t(o.current,a,n,i),o}}var ph={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(wa,function(r){var n="1.9.4";function i(s){var c,h,x,S;for(h=1,x=arguments.length;h<x;h++){S=arguments[h];for(c in S)s[c]=S[c]}return s}var a=Object.create||function(){function s(){}return function(c){return s.prototype=c,new s}}();function o(s,c){var h=Array.prototype.slice;if(s.bind)return s.bind.apply(s,h.call(arguments,1));var x=h.call(arguments,2);return function(){return s.apply(c,x.length?x.concat(h.call(arguments)):arguments)}}var l=0;function u(s){return"_leaflet_id"in s||(s._leaflet_id=++l),s._leaflet_id}function f(s,c,h){var x,S,A,Z;return Z=function(){x=!1,S&&(A.apply(h,S),S=!1)},A=function(){x?S=arguments:(s.apply(h,arguments),setTimeout(Z,c),x=!0)},A}function d(s,c,h){var x=c[1],S=c[0],A=x-S;return s===x&&h?s:((s-S)%A+A)%A+S}function m(){return!1}function g(s,c){if(c===!1)return s;var h=Math.pow(10,c===void 0?6:c);return Math.round(s*h)/h}function _(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function y(s){return _(s).split(/\s+/)}function v(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?a(s.options):{});for(var h in c)s.options[h]=c[h];return s.options}function T(s,c,h){var x=[];for(var S in s)x.push(encodeURIComponent(h?S.toUpperCase():S)+"="+encodeURIComponent(s[S]));return(!c||c.indexOf("?")===-1?"?":"&")+x.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function E(s,c){return s.replace(k,function(h,x){var S=c[x];if(S===void 0)throw new Error("No value provided for variable "+h);return typeof S=="function"&&(S=S(c)),S})}var w=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function P(s,c){for(var h=0;h<s.length;h++)if(s[h]===c)return h;return-1}var I="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function M(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var b=0;function U(s){var c=+new Date,h=Math.max(0,16-(c-b));return b=c+h,window.setTimeout(s,h)}var j=window.requestAnimationFrame||M("RequestAnimationFrame")||U,K=window.cancelAnimationFrame||M("CancelAnimationFrame")||M("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function V(s,c,h){if(h&&j===U)s.call(c);else return j.call(window,o(s,c))}function G(s){s&&K.call(window,s)}var de={__proto__:null,extend:i,create:a,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:d,falseFn:m,formatNum:g,trim:_,splitWords:y,setOptions:v,getParamString:T,template:E,isArray:w,indexOf:P,emptyImageUrl:I,requestFn:j,cancelFn:K,requestAnimFrame:V,cancelAnimFrame:G};function Se(){}Se.extend=function(s){var c=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,x=a(h);x.constructor=c,c.prototype=x;for(var S in this)Object.prototype.hasOwnProperty.call(this,S)&&S!=="prototype"&&S!=="__super__"&&(c[S]=this[S]);return s.statics&&i(c,s.statics),s.includes&&(ce(s.includes),i.apply(null,[x].concat(s.includes))),i(x,s),delete x.statics,delete x.includes,x.options&&(x.options=h.options?a(h.options):{},i(x.options,s.options)),x._initHooks=[],x.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var A=0,Z=x._initHooks.length;A<Z;A++)x._initHooks[A].call(this)}},c},Se.include=function(s){var c=this.prototype.options;return i(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},Se.mergeOptions=function(s){return i(this.prototype.options,s),this},Se.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),h=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function ce(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=w(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Y={on:function(s,c,h){if(typeof s=="object")for(var x in s)this._on(x,s[x],c);else{s=y(s);for(var S=0,A=s.length;S<A;S++)this._on(s[S],c,h)}return this},off:function(s,c,h){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var x in s)this._off(x,s[x],c);else{s=y(s);for(var S=arguments.length===1,A=0,Z=s.length;A<Z;A++)S?this._off(s[A]):this._off(s[A],c,h)}return this},_on:function(s,c,h,x){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,h)===!1){h===this&&(h=void 0);var S={fn:c,ctx:h};x&&(S.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(S)}},_off:function(s,c,h){var x,S,A;if(this._events&&(x=this._events[s],!!x)){if(arguments.length===1){if(this._firingCount)for(S=0,A=x.length;S<A;S++)x[S].fn=m;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var Z=this._listens(s,c,h);if(Z!==!1){var te=x[Z];this._firingCount&&(te.fn=m,this._events[s]=x=x.slice()),x.splice(Z,1)}}},fire:function(s,c,h){if(!this.listens(s,h))return this;var x=i({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var S=this._events[s];if(S){this._firingCount=this._firingCount+1||1;for(var A=0,Z=S.length;A<Z;A++){var te=S[A],ue=te.fn;te.once&&this.off(s,ue,te.ctx),ue.call(te.ctx||this,x)}this._firingCount--}}return h&&this._propagateEvent(x),this},listens:function(s,c,h,x){typeof s!="string"&&console.warn('"string" type argument expected');var S=c;typeof c!="function"&&(x=!!c,S=void 0,h=void 0);var A=this._events&&this._events[s];if(A&&A.length&&this._listens(s,S,h)!==!1)return!0;if(x){for(var Z in this._eventParents)if(this._eventParents[Z].listens(s,c,h,x))return!0}return!1},_listens:function(s,c,h){if(!this._events)return!1;var x=this._events[s]||[];if(!c)return!!x.length;h===this&&(h=void 0);for(var S=0,A=x.length;S<A;S++)if(x[S].fn===c&&x[S].ctx===h)return S;return!1},once:function(s,c,h){if(typeof s=="object")for(var x in s)this._on(x,s[x],c,!0);else{s=y(s);for(var S=0,A=s.length;S<A;S++)this._on(s[S],c,h,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[u(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[u(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,i({layer:s.target,propagatedFrom:s.target},s),!0)}};Y.addEventListener=Y.on,Y.removeEventListener=Y.clearAllEventListeners=Y.off,Y.addOneTimeEventListener=Y.once,Y.fireEvent=Y.fire,Y.hasEventListeners=Y.listens;var xe=Se.extend(Y);function re(s,c,h){this.x=h?Math.round(s):s,this.y=h?Math.round(c):c}var q=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};re.prototype={clone:function(){return new re(this.x,this.y)},add:function(s){return this.clone()._add(ae(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ae(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new re(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new re(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=q(this.x),this.y=q(this.y),this},distanceTo:function(s){s=ae(s);var c=s.x-this.x,h=s.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(s){return s=ae(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ae(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function ae(s,c,h){return s instanceof re?s:w(s)?new re(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new re(s.x,s.y):new re(s,c,h)}function pe(s,c){if(s)for(var h=c?[s,c]:s,x=0,S=h.length;x<S;x++)this.extend(h[x])}pe.prototype={extend:function(s){var c,h;if(!s)return this;if(s instanceof re||typeof s[0]=="number"||"x"in s)c=h=ae(s);else if(s=O(s),c=s.min,h=s.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(s){return ae((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ae(this.min.x,this.max.y)},getTopRight:function(){return ae(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,h;return typeof s[0]=="number"||s instanceof re?s=ae(s):s=O(s),s instanceof pe?(c=s.min,h=s.max):c=h=s,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(s){s=O(s);var c=this.min,h=this.max,x=s.min,S=s.max,A=S.x>=c.x&&x.x<=h.x,Z=S.y>=c.y&&x.y<=h.y;return A&&Z},overlaps:function(s){s=O(s);var c=this.min,h=this.max,x=s.min,S=s.max,A=S.x>c.x&&x.x<h.x,Z=S.y>c.y&&x.y<h.y;return A&&Z},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,h=this.max,x=Math.abs(c.x-h.x)*s,S=Math.abs(c.y-h.y)*s;return O(ae(c.x-x,c.y-S),ae(h.x+x,h.y+S))},equals:function(s){return s?(s=O(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function O(s,c){return!s||s instanceof pe?s:new pe(s,c)}function J(s,c){if(s)for(var h=c?[s,c]:s,x=0,S=h.length;x<S;x++)this.extend(h[x])}J.prototype={extend:function(s){var c=this._southWest,h=this._northEast,x,S;if(s instanceof W)x=s,S=s;else if(s instanceof J){if(x=s._southWest,S=s._northEast,!x||!S)return this}else return s?this.extend(ie(s)||X(s)):this;return!c&&!h?(this._southWest=new W(x.lat,x.lng),this._northEast=new W(S.lat,S.lng)):(c.lat=Math.min(x.lat,c.lat),c.lng=Math.min(x.lng,c.lng),h.lat=Math.max(S.lat,h.lat),h.lng=Math.max(S.lng,h.lng)),this},pad:function(s){var c=this._southWest,h=this._northEast,x=Math.abs(c.lat-h.lat)*s,S=Math.abs(c.lng-h.lng)*s;return new J(new W(c.lat-x,c.lng-S),new W(h.lat+x,h.lng+S))},getCenter:function(){return new W((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new W(this.getNorth(),this.getWest())},getSouthEast:function(){return new W(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof W||"lat"in s?s=ie(s):s=X(s);var c=this._southWest,h=this._northEast,x,S;return s instanceof J?(x=s.getSouthWest(),S=s.getNorthEast()):x=S=s,x.lat>=c.lat&&S.lat<=h.lat&&x.lng>=c.lng&&S.lng<=h.lng},intersects:function(s){s=X(s);var c=this._southWest,h=this._northEast,x=s.getSouthWest(),S=s.getNorthEast(),A=S.lat>=c.lat&&x.lat<=h.lat,Z=S.lng>=c.lng&&x.lng<=h.lng;return A&&Z},overlaps:function(s){s=X(s);var c=this._southWest,h=this._northEast,x=s.getSouthWest(),S=s.getNorthEast(),A=S.lat>c.lat&&x.lat<h.lat,Z=S.lng>c.lng&&x.lng<h.lng;return A&&Z},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=X(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function X(s,c){return s instanceof J?s:new J(s,c)}function W(s,c,h){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,h!==void 0&&(this.alt=+h)}W.prototype={equals:function(s,c){if(!s)return!1;s=ie(s);var h=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return h<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+g(this.lat,s)+", "+g(this.lng,s)+")"},distanceTo:function(s){return Le.distance(this,ie(s))},wrap:function(){return Le.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,h=c/Math.cos(Math.PI/180*this.lat);return X([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new W(this.lat,this.lng,this.alt)}};function ie(s,c,h){return s instanceof W?s:w(s)&&typeof s[0]!="object"?s.length===3?new W(s[0],s[1],s[2]):s.length===2?new W(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new W(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new W(s,c,h)}var we={latLngToPoint:function(s,c){var h=this.projection.project(s),x=this.scale(c);return this.transformation._transform(h,x)},pointToLatLng:function(s,c){var h=this.scale(c),x=this.transformation.untransform(s,h);return this.projection.unproject(x)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(s),x=this.transformation.transform(c.min,h),S=this.transformation.transform(c.max,h);return new pe(x,S)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?d(s.lng,this.wrapLng,!0):s.lng,h=this.wrapLat?d(s.lat,this.wrapLat,!0):s.lat,x=s.alt;return new W(h,c,x)},wrapLatLngBounds:function(s){var c=s.getCenter(),h=this.wrapLatLng(c),x=c.lat-h.lat,S=c.lng-h.lng;if(x===0&&S===0)return s;var A=s.getSouthWest(),Z=s.getNorthEast(),te=new W(A.lat-x,A.lng-S),ue=new W(Z.lat-x,Z.lng-S);return new J(te,ue)}},Le=i({},we,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var h=Math.PI/180,x=s.lat*h,S=c.lat*h,A=Math.sin((c.lat-s.lat)*h/2),Z=Math.sin((c.lng-s.lng)*h/2),te=A*A+Math.cos(x)*Math.cos(S)*Z*Z,ue=2*Math.atan2(Math.sqrt(te),Math.sqrt(1-te));return this.R*ue}}),Ae=6378137,_e={R:Ae,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,h=this.MAX_LATITUDE,x=Math.max(Math.min(h,s.lat),-h),S=Math.sin(x*c);return new re(this.R*s.lng*c,this.R*Math.log((1+S)/(1-S))/2)},unproject:function(s){var c=180/Math.PI;return new W((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:function(){var s=Ae*Math.PI;return new pe([-s,-s],[s,s])}()};function ze(s,c,h,x){if(w(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=h,this._d=x}ze.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new re((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function H(s,c,h,x){return new ze(s,c,h,x)}var Ye=i({},Le,{code:"EPSG:3857",projection:_e,transformation:function(){var s=.5/(Math.PI*_e.R);return H(s,.5,-s,.5)}()}),rt=i({},Ye,{code:"EPSG:900913"});function et(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Ge(s,c){var h="",x,S,A,Z,te,ue;for(x=0,A=s.length;x<A;x++){for(te=s[x],S=0,Z=te.length;S<Z;S++)ue=te[S],h+=(S?"L":"M")+ue.x+" "+ue.y;h+=c?De.svg?"z":"x":""}return h||"M0 0"}var Ne=document.documentElement.style,le="ActiveXObject"in window,Pe=le&&!document.addEventListener,Fe="msLaunchUri"in navigator&&!("documentMode"in document),Ue=Cr("webkit"),nt=Cr("android"),tt=Cr("android 2")||Cr("android 3"),Ve=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ot=nt&&Cr("Google")&&Ve<537&&!("AudioNode"in window),bt=!!window.opera,sr=!Fe&&Cr("chrome"),Ct=Cr("gecko")&&!Ue&&!bt&&!le,$t=!sr&&Cr("safari"),Xe=Cr("phantom"),fe="OTransition"in Ne,ge=navigator.platform.indexOf("Win")===0,Ee=le&&"transition"in Ne,Oe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!tt,He="MozPerspective"in Ne,Tt=!window.L_DISABLE_3D&&(Ee||Oe||He)&&!fe&&!Xe,ct=typeof orientation<"u"||Cr("mobile"),Ke=ct&&Ue,Je=ct&&Oe,ut=!window.PointerEvent&&window.MSPointerEvent,pt=!!(window.PointerEvent||ut),or="ontouchstart"in window||!!window.TouchEvent,At=!window.L_NO_TOUCH&&(or||pt),lt=ct&&bt,Q=ct&&Ct,ve=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Be=function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return s}(),ft=function(){return!!document.createElement("canvas").getContext}(),gt=!!(document.createElementNS&&et("svg").createSVGRect),St=!!gt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Zt=!gt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Qt=navigator.platform.indexOf("Mac")===0,ni=navigator.platform.indexOf("Linux")===0;function Cr(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var De={ie:le,ielt9:Pe,edge:Fe,webkit:Ue,android:nt,android23:tt,androidStock:Ot,opera:bt,chrome:sr,gecko:Ct,safari:$t,phantom:Xe,opera12:fe,win:ge,ie3d:Ee,webkit3d:Oe,gecko3d:He,any3d:Tt,mobile:ct,mobileWebkit:Ke,mobileWebkit3d:Je,msPointer:ut,pointer:pt,touch:At,touchNative:or,mobileOpera:lt,mobileGecko:Q,retina:ve,passiveEvents:Be,canvas:ft,svg:gt,vml:Zt,inlineSvg:St,mac:Qt,linux:ni},C=De.msPointer?"MSPointerDown":"pointerdown",R=De.msPointer?"MSPointerMove":"pointermove",F=De.msPointer?"MSPointerUp":"pointerup",D=De.msPointer?"MSPointerCancel":"pointercancel",B={touchstart:C,touchmove:R,touchend:F,touchcancel:D},z={touchstart:Re,touchmove:Ce,touchend:Ce,touchcancel:Ce},ee={},me=!1;function ne(s,c,h){return c==="touchstart"&&Ie(),z[c]?(h=z[c].bind(this,h),s.addEventListener(B[c],h,!1),h):(console.warn("wrong event specified:",c),m)}function se(s,c,h){if(!B[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(B[c],h,!1)}function oe(s){ee[s.pointerId]=s}function ke(s){ee[s.pointerId]&&(ee[s.pointerId]=s)}function be(s){delete ee[s.pointerId]}function Ie(){me||(document.addEventListener(C,oe,!0),document.addEventListener(R,ke,!0),document.addEventListener(F,be,!0),document.addEventListener(D,be,!0),me=!0)}function Ce(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in ee)c.touches.push(ee[h]);c.changedTouches=[c],s(c)}}function Re(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&_r(c),Ce(s,c)}function qe(s){var c={},h,x;for(x in s)h=s[x],c[x]=h&&h.bind?h.bind(s):h;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Rt=200;function Mt(s,c){s.addEventListener("dblclick",c);var h=0,x;function S(A){if(A.detail!==1){x=A.detail;return}if(!(A.pointerType==="mouse"||A.sourceCapabilities&&!A.sourceCapabilities.firesTouchEvents)){var Z=cm(A);if(!(Z.some(function(ue){return ue instanceof HTMLLabelElement&&ue.attributes.for})&&!Z.some(function(ue){return ue instanceof HTMLInputElement||ue instanceof HTMLSelectElement}))){var te=Date.now();te-h<=Rt?(x++,x===2&&c(qe(A))):x=1,h=te}}}return s.addEventListener("click",S),{dblclick:c,simDblclick:S}}function hr(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var ki=hc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Dn=hc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ki=Dn==="webkitTransition"||Dn==="OTransition"?Dn+"End":"transitionend";function ii(s){return typeof s=="string"?document.getElementById(s):s}function Ei(s,c){var h=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var x=document.defaultView.getComputedStyle(s,null);h=x?x[c]:null}return h==="auto"?null:h}function it(s,c,h){var x=document.createElement(s);return x.className=c||"",h&&h.appendChild(x),x}function zt(s){var c=s.parentNode;c&&c.removeChild(s)}function fc(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function gs(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function xs(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function Uf(s,c){if(s.classList!==void 0)return s.classList.contains(c);var h=dc(s);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function dt(s,c){if(s.classList!==void 0)for(var h=y(c),x=0,S=h.length;x<S;x++)s.classList.add(h[x]);else if(!Uf(s,c)){var A=dc(s);Hf(s,(A?A+" ":"")+c)}}function qt(s,c){s.classList!==void 0?s.classList.remove(c):Hf(s,_((" "+dc(s)+" ").replace(" "+c+" "," ")))}function Hf(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function dc(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function vn(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&ak(s,c)}function ak(s,c){var h=!1,x="DXImageTransform.Microsoft.Alpha";try{h=s.filters.item(x)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):s.style.filter+=" progid:"+x+"(opacity="+c+")"}function hc(s){for(var c=document.documentElement.style,h=0;h<s.length;h++)if(s[h]in c)return s[h];return!1}function La(s,c,h){var x=c||new re(0,0);s.style[ki]=(De.ie3d?"translate("+x.x+"px,"+x.y+"px)":"translate3d("+x.x+"px,"+x.y+"px,0)")+(h?" scale("+h+")":"")}function er(s,c){s._leaflet_pos=c,De.any3d?La(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function Pa(s){return s._leaflet_pos||new re(0,0)}var So,Co,Vf;if("onselectstart"in document)So=function(){at(window,"selectstart",_r)},Co=function(){Lt(window,"selectstart",_r)};else{var Ao=hc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);So=function(){if(Ao){var s=document.documentElement.style;Vf=s[Ao],s[Ao]="none"}},Co=function(){Ao&&(document.documentElement.style[Ao]=Vf,Vf=void 0)}}function Wf(){at(window,"dragstart",_r)}function $f(){Lt(window,"dragstart",_r)}var pc,Zf;function Gf(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(mc(),pc=s,Zf=s.style.outlineStyle,s.style.outlineStyle="none",at(window,"keydown",mc))}function mc(){pc&&(pc.style.outlineStyle=Zf,pc=void 0,Zf=void 0,Lt(window,"keydown",mc))}function om(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Xf(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var sk={__proto__:null,TRANSFORM:ki,TRANSITION:Dn,TRANSITION_END:Ki,get:ii,getStyle:Ei,create:it,remove:zt,empty:fc,toFront:gs,toBack:xs,hasClass:Uf,addClass:dt,removeClass:qt,setClass:Hf,getClass:dc,setOpacity:vn,testProp:hc,setTransform:La,setPosition:er,getPosition:Pa,get disableTextSelection(){return So},get enableTextSelection(){return Co},disableImageDrag:Wf,enableImageDrag:$f,preventOutline:Gf,restoreOutline:mc,getSizedParentNode:om,getScale:Xf};function at(s,c,h,x){if(c&&typeof c=="object")for(var S in c)qf(s,S,c[S],h);else{c=y(c);for(var A=0,Z=c.length;A<Z;A++)qf(s,c[A],h,x)}return this}var ai="_leaflet_events";function Lt(s,c,h,x){if(arguments.length===1)lm(s),delete s[ai];else if(c&&typeof c=="object")for(var S in c)Yf(s,S,c[S],h);else if(c=y(c),arguments.length===2)lm(s,function(te){return P(c,te)!==-1});else for(var A=0,Z=c.length;A<Z;A++)Yf(s,c[A],h,x);return this}function lm(s,c){for(var h in s[ai]){var x=h.split(/\d/)[0];(!c||c(x))&&Yf(s,x,null,null,h)}}var Kf={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function qf(s,c,h,x){var S=c+u(h)+(x?"_"+u(x):"");if(s[ai]&&s[ai][S])return this;var A=function(te){return h.call(x||s,te||window.event)},Z=A;!De.touchNative&&De.pointer&&c.indexOf("touch")===0?A=ne(s,c,A):De.touch&&c==="dblclick"?A=Mt(s,A):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(Kf[c]||c,A,De.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(A=function(te){te=te||window.event,Qf(s,te)&&Z(te)},s.addEventListener(Kf[c],A,!1)):s.addEventListener(c,Z,!1):s.attachEvent("on"+c,A),s[ai]=s[ai]||{},s[ai][S]=A}function Yf(s,c,h,x,S){S=S||c+u(h)+(x?"_"+u(x):"");var A=s[ai]&&s[ai][S];if(!A)return this;!De.touchNative&&De.pointer&&c.indexOf("touch")===0?se(s,c,A):De.touch&&c==="dblclick"?hr(s,A):"removeEventListener"in s?s.removeEventListener(Kf[c]||c,A,!1):s.detachEvent("on"+c,A),s[ai][S]=null}function Fa(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Jf(s){return qf(s,"wheel",Fa),this}function No(s){return at(s,"mousedown touchstart dblclick contextmenu",Fa),s._leaflet_disable_click=!0,this}function _r(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Oa(s){return _r(s),Fa(s),this}function cm(s){if(s.composedPath)return s.composedPath();for(var c=[],h=s.target;h;)c.push(h),h=h.parentNode;return c}function um(s,c){if(!c)return new re(s.clientX,s.clientY);var h=Xf(c),x=h.boundingClientRect;return new re((s.clientX-x.left)/h.x-c.clientLeft,(s.clientY-x.top)/h.y-c.clientTop)}var ok=De.linux&&De.chrome?window.devicePixelRatio:De.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function fm(s){return De.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/ok:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Qf(s,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==s;)h=h.parentNode}catch{return!1}return h!==s}var lk={__proto__:null,on:at,off:Lt,stopPropagation:Fa,disableScrollPropagation:Jf,disableClickPropagation:No,preventDefault:_r,stop:Oa,getPropagationPath:cm,getMousePosition:um,getWheelDelta:fm,isExternalTarget:Qf,addListener:at,removeListener:Lt},dm=xe.extend({run:function(s,c,h,x){this.stop(),this._el=s,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(x||.5,.2),this._startPos=Pa(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=V(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var h=this._startPos.add(this._offset.multiplyBy(s));c&&h._round(),er(this._el,h),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),vt=xe.extend({options:{crs:Ye,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=v(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(ie(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Dn&&De.any3d&&!De.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),at(this._proxy,Ki,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(ie(s),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=i({animate:h.animate},h.zoom),h.pan=i({animate:h.animate,duration:h.duration},h.pan));var x=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,h.zoom):this._tryAnimatedPan(s,h.pan);if(x)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,h){var x=this.getZoomScale(c),S=this.getSize().divideBy(2),A=s instanceof re?s:this.latLngToContainerPoint(s),Z=A.subtract(S).multiplyBy(1-1/x),te=this.containerPointToLatLng(S.add(Z));return this.setView(te,c,{zoom:h})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():X(s);var h=ae(c.paddingTopLeft||c.padding||[0,0]),x=ae(c.paddingBottomRight||c.padding||[0,0]),S=this.getBoundsZoom(s,!1,h.add(x));if(S=typeof c.maxZoom=="number"?Math.min(c.maxZoom,S):S,S===1/0)return{center:s.getCenter(),zoom:S};var A=x.subtract(h).divideBy(2),Z=this.project(s.getSouthWest(),S),te=this.project(s.getNorthEast(),S),ue=this.unproject(Z.add(te).divideBy(2).add(A),S);return{center:ue,zoom:S}},fitBounds:function(s,c){if(s=X(s),!s.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(s,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=ae(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new dm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){dt(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,h){if(h=h||{},h.animate===!1||!De.any3d)return this.setView(s,c,h);this._stop();var x=this.project(this.getCenter()),S=this.project(s),A=this.getSize(),Z=this._zoom;s=ie(s),c=c===void 0?Z:c;var te=Math.max(A.x,A.y),ue=te*this.getZoomScale(Z,c),ye=S.distanceTo(x)||1,Me=1.42,We=Me*Me;function ht(tr){var Ac=tr?-1:1,qk=tr?ue:te,Yk=ue*ue-te*te+Ac*We*We*ye*ye,Jk=2*qk*We*ye,u0=Yk/Jk,Zm=Math.sqrt(u0*u0+1)-u0,Qk=Zm<1e-9?-18:Math.log(Zm);return Qk}function Br(tr){return(Math.exp(tr)-Math.exp(-tr))/2}function pr(tr){return(Math.exp(tr)+Math.exp(-tr))/2}function yn(tr){return Br(tr)/pr(tr)}var qr=ht(0);function Es(tr){return te*(pr(qr)/pr(qr+Me*tr))}function Zk(tr){return te*(pr(qr)*yn(qr+Me*tr)-Br(qr))/We}function Gk(tr){return 1-Math.pow(1-tr,1.5)}var Xk=Date.now(),Wm=(ht(1)-qr)/Me,Kk=h.duration?1e3*h.duration:1e3*Wm*.8;function $m(){var tr=(Date.now()-Xk)/Kk,Ac=Gk(tr)*Wm;tr<=1?(this._flyToFrame=V($m,this),this._move(this.unproject(x.add(S.subtract(x).multiplyBy(Zk(Ac)/ye)),Z),this.getScaleZoom(te/Es(Ac),Z),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),$m.call(this),this},flyToBounds:function(s,c){var h=this._getBoundsCenterZoom(s,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(s){return s=X(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var h=this.getCenter(),x=this._limitCenter(h,this._zoom,X(s));return h.equals(x)||this.panTo(x,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var h=ae(c.paddingTopLeft||c.padding||[0,0]),x=ae(c.paddingBottomRight||c.padding||[0,0]),S=this.project(this.getCenter()),A=this.project(s),Z=this.getPixelBounds(),te=O([Z.min.add(h),Z.max.subtract(x)]),ue=te.getSize();if(!te.contains(A)){this._enforcingBounds=!0;var ye=A.subtract(te.getCenter()),Me=te.extend(A).getSize().subtract(ue);S.x+=ye.x<0?-Me.x:Me.x,S.y+=ye.y<0?-Me.y:Me.y,this.panTo(this.unproject(S),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=i({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),x=c.divideBy(2).round(),S=h.divideBy(2).round(),A=x.subtract(S);return!A.x&&!A.y?this:(s.animate&&s.pan?this.panBy(A):(s.pan&&this._rawPanBy(A),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=i({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),h=o(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,s):navigator.geolocation.getCurrentPosition(c,h,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,h=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,h=s.coords.longitude,x=new W(c,h),S=x.toBounds(s.coords.accuracy*2),A=this._locateOptions;if(A.setView){var Z=this.getBoundsZoom(S);this.setView(x,A.maxZoom?Math.min(Z,A.maxZoom):Z)}var te={latlng:x,bounds:S,timestamp:s.timestamp};for(var ue in s.coords)typeof s.coords[ue]=="number"&&(te[ue]=s.coords[ue]);this.fire("locationfound",te)}},addHandler:function(s,c){if(!c)return this;var h=this[s]=new c(this);return this._handlers.push(h),this.options[s]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),zt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)zt(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var h="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),x=it("div",h,c||this._mapPane);return s&&(this._panes[s]=x),x},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),h=this.unproject(s.getTopRight());return new J(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,h){s=X(s),h=ae(h||[0,0]);var x=this.getZoom()||0,S=this.getMinZoom(),A=this.getMaxZoom(),Z=s.getNorthWest(),te=s.getSouthEast(),ue=this.getSize().subtract(h),ye=O(this.project(te,x),this.project(Z,x)).getSize(),Me=De.any3d?this.options.zoomSnap:1,We=ue.x/ye.x,ht=ue.y/ye.y,Br=c?Math.max(We,ht):Math.min(We,ht);return x=this.getScaleZoom(Br,x),Me&&(x=Math.round(x/(Me/100))*(Me/100),x=c?Math.ceil(x/Me)*Me:Math.floor(x/Me)*Me),Math.max(S,Math.min(A,x))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new re(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var h=this._getTopLeftPoint(s,c);return new pe(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(s)/h.scale(c)},getScaleZoom:function(s,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var x=h.zoom(s*h.scale(c));return isNaN(x)?1/0:x},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(ie(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ae(s),c)},layerPointToLatLng:function(s){var c=ae(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(ie(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(ie(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(X(s))},distance:function(s,c){return this.options.crs.distance(ie(s),ie(c))},containerPointToLayerPoint:function(s){return ae(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ae(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(ae(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ie(s)))},mouseEventToContainerPoint:function(s){return um(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=ii(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");at(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&De.any3d,dt(s,"leaflet-container"+(De.touch?" leaflet-touch":"")+(De.retina?" leaflet-retina":"")+(De.ielt9?" leaflet-oldie":"")+(De.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Ei(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),er(this._mapPane,new re(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(dt(s.markerPane,"leaflet-zoom-hide"),dt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,h){er(this._mapPane,new re(0,0));var x=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var S=this._zoom!==c;this._moveStart(S,h)._move(s,c)._moveEnd(S),this.fire("viewreset"),x&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,h,x){c===void 0&&(c=this._zoom);var S=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),x?h&&h.pinch&&this.fire("zoom",h):((S||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){er(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[u(this._container)]=this;var c=s?Lt:at;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),De.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=V(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var h=[],x,S=c==="mouseout"||c==="mouseover",A=s.target||s.srcElement,Z=!1;A;){if(x=this._targets[u(A)],x&&(c==="click"||c==="preclick")&&this._draggableMoved(x)){Z=!0;break}if(x&&x.listens(c,!0)&&(S&&!Qf(A,s)||(h.push(x),S))||A===this._container)break;A=A.parentNode}return!h.length&&!Z&&!S&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var h=s.type;h==="mousedown"&&Gf(c),this._fireDOMEvent(s,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,h){if(s.type==="click"){var x=i({},s);x.type="preclick",this._fireDOMEvent(x,x.type,h)}var S=this._findEventTargets(s,c);if(h){for(var A=[],Z=0;Z<h.length;Z++)h[Z].listens(c,!0)&&A.push(h[Z]);S=A.concat(S)}if(S.length){c==="contextmenu"&&_r(s);var te=S[0],ue={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ye=te.getLatLng&&(!te._radius||te._radius<=10);ue.containerPoint=ye?this.latLngToContainerPoint(te.getLatLng()):this.mouseEventToContainerPoint(s),ue.layerPoint=this.containerPointToLayerPoint(ue.containerPoint),ue.latlng=ye?te.getLatLng():this.layerPointToLatLng(ue.layerPoint)}for(Z=0;Z<S.length;Z++)if(S[Z].fire(c,ue,!0),ue.originalEvent._stopped||S[Z].options.bubblingMouseEvents===!1&&P(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return Pa(this._mapPane)||new re(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var h=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var h=this.getSize()._divideBy(2);return this.project(s,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,h){var x=this._getNewPixelOrigin(h,c);return this.project(s,c)._subtract(x)},_latLngBoundsToNewLayerBounds:function(s,c,h){var x=this._getNewPixelOrigin(h,c);return O([this.project(s.getSouthWest(),c)._subtract(x),this.project(s.getNorthWest(),c)._subtract(x),this.project(s.getSouthEast(),c)._subtract(x),this.project(s.getNorthEast(),c)._subtract(x)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,h){if(!h)return s;var x=this.project(s,c),S=this.getSize().divideBy(2),A=new pe(x.subtract(S),x.add(S)),Z=this._getBoundsOffset(A,h,c);return Math.abs(Z.x)<=1&&Math.abs(Z.y)<=1?s:this.unproject(x.add(Z),c)},_limitOffset:function(s,c){if(!c)return s;var h=this.getPixelBounds(),x=new pe(h.min.add(s),h.max.add(s));return s.add(this._getBoundsOffset(x,c))},_getBoundsOffset:function(s,c,h){var x=O(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),S=x.min.subtract(s.min),A=x.max.subtract(s.max),Z=this._rebound(S.x,-A.x),te=this._rebound(S.y,-A.y);return new re(Z,te)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),h=this.getMaxZoom(),x=De.any3d?this.options.zoomSnap:1;return x&&(s=Math.round(s/x)*x),Math.max(c,Math.min(h,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){qt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var h=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var s=this._proxy=it("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var h=ki,x=this._proxy.style[h];La(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),x===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){zt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();La(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var x=this.getZoomScale(c),S=this._getCenterOffset(s)._divideBy(1-1/x);return h.animate!==!0&&!this.getSize().contains(S)?!1:(V(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,h,x){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:x}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&qt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ck(s,c){return new vt(s,c)}var jn=Se.extend({options:{position:"topright"},initialize:function(s){v(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),h=this.getPosition(),x=s._controlCorners[h];return dt(c,"leaflet-control"),h.indexOf("bottom")!==-1?x.insertBefore(c,x.firstChild):x.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(zt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),bo=function(s){return new jn(s)};vt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",h=this._controlContainer=it("div",c+"control-container",this._container);function x(S,A){var Z=c+S+" "+c+A;s[S+A]=it("div",Z,h)}x("top","left"),x("top","right"),x("bottom","left"),x("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)zt(this._controlCorners[s]);zt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var hm=jn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,h,x){return h<x?-1:x<h?1:0}},initialize:function(s,c,h){v(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var x in s)this._addLayer(s[x],x);for(x in c)this._addLayer(c[x],x,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return jn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):qt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return qt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=it("div",s),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),No(c),Jf(c);var x=this._section=it("section",s+"-list");h&&(this._map.on("click",this.collapse,this),at(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var S=this._layersLink=it("a",s+"-toggle",c);S.href="#",S.title="Layers",S.setAttribute("role","button"),at(S,{keydown:function(A){A.keyCode===13&&this._expandSafely()},click:function(A){_r(A),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=it("div",s+"-base",x),this._separator=it("div",s+"-separator",x),this._overlaysList=it("div",s+"-overlays",x),c.appendChild(x)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,h){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(o(function(x,S){return this.options.sortFunction(x.layer,S.layer,x.name,S.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;fc(this._baseLayersList),fc(this._overlaysList),this._layerControlInputs=[];var s,c,h,x,S=0;for(h=0;h<this._layers.length;h++)x=this._layers[h],this._addItem(x),c=c||x.overlay,s=s||!x.overlay,S+=x.overlay?0:1;return this.options.hideSingleBase&&(s=s&&S>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(u(s.target)),h=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(s,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",x=document.createElement("div");return x.innerHTML=h,x.firstChild},_addItem:function(s){var c=document.createElement("label"),h=this._map.hasLayer(s.layer),x;s.overlay?(x=document.createElement("input"),x.type="checkbox",x.className="leaflet-control-layers-selector",x.defaultChecked=h):x=this._createRadioElement("leaflet-base-layers_"+u(this),h),this._layerControlInputs.push(x),x.layerId=u(s.layer),at(x,"click",this._onInputClick,this);var S=document.createElement("span");S.innerHTML=" "+s.name;var A=document.createElement("span");c.appendChild(A),A.appendChild(x),A.appendChild(S);var Z=s.overlay?this._overlaysList:this._baseLayersList;return Z.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,h,x=[],S=[];this._handlingClick=!0;for(var A=s.length-1;A>=0;A--)c=s[A],h=this._getLayer(c.layerId).layer,c.checked?x.push(h):c.checked||S.push(h);for(A=0;A<S.length;A++)this._map.hasLayer(S[A])&&this._map.removeLayer(S[A]);for(A=0;A<x.length;A++)this._map.hasLayer(x[A])||this._map.addLayer(x[A]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,h,x=this._map.getZoom(),S=s.length-1;S>=0;S--)c=s[S],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&x<h.options.minZoom||h.options.maxZoom!==void 0&&x>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,at(s,"click",_r),this.expand();var c=this;setTimeout(function(){Lt(s,"click",_r),c._preventClick=!1})}}),uk=function(s,c,h){return new hm(s,c,h)},e0=jn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",h=it("div",c+" leaflet-bar"),x=this.options;return this._zoomInButton=this._createButton(x.zoomInText,x.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(x.zoomOutText,x.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,h,x,S){var A=it("a",h,x);return A.innerHTML=s,A.href="#",A.title=c,A.setAttribute("role","button"),A.setAttribute("aria-label",c),No(A),at(A,"click",Oa),at(A,"click",S,this),at(A,"click",this._refocusOnMap,this),A},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";qt(this._zoomInButton,c),qt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(dt(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(dt(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});vt.mergeOptions({zoomControl:!0}),vt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new e0,this.addControl(this.zoomControl))});var fk=function(s){return new e0(s)},pm=jn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",h=it("div",c),x=this.options;return this._addScales(x,c+"-line",h),s.on(x.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),h},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,h){s.metric&&(this._mScale=it("div",c,h)),s.imperial&&(this._iScale=it("div",c,h))},_update:function(){var s=this._map,c=s.getSize().y/2,h=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/s)},_updateImperial:function(s){var c=s*3.2808399,h,x,S;c>5280?(h=c/5280,x=this._getRoundNum(h),this._updateScale(this._iScale,x+" mi",x/h)):(S=this._getRoundNum(c),this._updateScale(this._iScale,S+" ft",S/c))},_updateScale:function(s,c,h){s.style.width=Math.round(this.options.maxWidth*h)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),h=s/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),dk=function(s){return new pm(s)},hk='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',t0=jn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(De.inlineSvg?hk+" ":"")+"Leaflet</a>"},initialize:function(s){v(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=it("div","leaflet-control-attribution"),No(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),s.length&&h.push(s.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});vt.mergeOptions({attributionControl:!0}),vt.addInitHook(function(){this.options.attributionControl&&new t0().addTo(this)});var pk=function(s){return new t0(s)};jn.Layers=hm,jn.Zoom=e0,jn.Scale=pm,jn.Attribution=t0,bo.layers=uk,bo.zoom=fk,bo.scale=dk,bo.attribution=pk;var si=Se.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});si.addTo=function(s,c){return s.addHandler(c,this),this};var mk={Events:Y},mm=De.touch?"touchstart mousedown":"mousedown",qi=xe.extend({options:{clickTolerance:3},initialize:function(s,c,h,x){v(this,x),this._element=s,this._dragStartTarget=c||s,this._preventOutline=h},enable:function(){this._enabled||(at(this._dragStartTarget,mm,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(qi._dragging===this&&this.finishDrag(!0),Lt(this._dragStartTarget,mm,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Uf(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){qi._dragging===this&&this.finishDrag();return}if(!(qi._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(qi._dragging=this,this._preventOutline&&Gf(this._element),Wf(),So(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,h=om(this._element);this._startPoint=new re(c.clientX,c.clientY),this._startPos=Pa(this._element),this._parentScale=Xf(h);var x=s.type==="mousedown";at(document,x?"mousemove":"touchmove",this._onMove,this),at(document,x?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,h=new re(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,_r(s),this._moved||(this.fire("dragstart"),this._moved=!0,dt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),er(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){qt(document.body,"leaflet-dragging"),this._lastTarget&&(qt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Lt(document,"mousemove touchmove",this._onMove,this),Lt(document,"mouseup touchend touchcancel",this._onUp,this),$f(),Co();var c=this._moved&&this._moving;this._moving=!1,qi._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function gm(s,c,h){var x,S=[1,4,2,8],A,Z,te,ue,ye,Me,We,ht;for(A=0,Me=s.length;A<Me;A++)s[A]._code=Ra(s[A],c);for(te=0;te<4;te++){for(We=S[te],x=[],A=0,Me=s.length,Z=Me-1;A<Me;Z=A++)ue=s[A],ye=s[Z],ue._code&We?ye._code&We||(ht=gc(ye,ue,We,c,h),ht._code=Ra(ht,c),x.push(ht)):(ye._code&We&&(ht=gc(ye,ue,We,c,h),ht._code=Ra(ht,c),x.push(ht)),x.push(ue));s=x}return s}function xm(s,c){var h,x,S,A,Z,te,ue,ye,Me;if(!s||s.length===0)throw new Error("latlngs not passed");_n(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var We=ie([0,0]),ht=X(s),Br=ht.getNorthWest().distanceTo(ht.getSouthWest())*ht.getNorthEast().distanceTo(ht.getNorthWest());Br<1700&&(We=r0(s));var pr=s.length,yn=[];for(h=0;h<pr;h++){var qr=ie(s[h]);yn.push(c.project(ie([qr.lat-We.lat,qr.lng-We.lng])))}for(te=ue=ye=0,h=0,x=pr-1;h<pr;x=h++)S=yn[h],A=yn[x],Z=S.y*A.x-A.y*S.x,ue+=(S.x+A.x)*Z,ye+=(S.y+A.y)*Z,te+=Z*3;te===0?Me=yn[0]:Me=[ue/te,ye/te];var Es=c.unproject(ae(Me));return ie([Es.lat+We.lat,Es.lng+We.lng])}function r0(s){for(var c=0,h=0,x=0,S=0;S<s.length;S++){var A=ie(s[S]);c+=A.lat,h+=A.lng,x++}return ie([c/x,h/x])}var gk={__proto__:null,clipPolygon:gm,polygonCenter:xm,centroid:r0};function vm(s,c){if(!c||!s.length)return s.slice();var h=c*c;return s=_k(s,h),s=vk(s,h),s}function _m(s,c,h){return Math.sqrt(Lo(s,c,h,!0))}function xk(s,c,h){return Lo(s,c,h)}function vk(s,c){var h=s.length,x=typeof Uint8Array<"u"?Uint8Array:Array,S=new x(h);S[0]=S[h-1]=1,n0(s,S,c,0,h-1);var A,Z=[];for(A=0;A<h;A++)S[A]&&Z.push(s[A]);return Z}function n0(s,c,h,x,S){var A=0,Z,te,ue;for(te=x+1;te<=S-1;te++)ue=Lo(s[te],s[x],s[S],!0),ue>A&&(Z=te,A=ue);A>h&&(c[Z]=1,n0(s,c,h,x,Z),n0(s,c,h,Z,S))}function _k(s,c){for(var h=[s[0]],x=1,S=0,A=s.length;x<A;x++)yk(s[x],s[S])>c&&(h.push(s[x]),S=x);return S<A-1&&h.push(s[A-1]),h}var ym;function wm(s,c,h,x,S){var A=x?ym:Ra(s,h),Z=Ra(c,h),te,ue,ye;for(ym=Z;;){if(!(A|Z))return[s,c];if(A&Z)return!1;te=A||Z,ue=gc(s,c,te,h,S),ye=Ra(ue,h),te===A?(s=ue,A=ye):(c=ue,Z=ye)}}function gc(s,c,h,x,S){var A=c.x-s.x,Z=c.y-s.y,te=x.min,ue=x.max,ye,Me;return h&8?(ye=s.x+A*(ue.y-s.y)/Z,Me=ue.y):h&4?(ye=s.x+A*(te.y-s.y)/Z,Me=te.y):h&2?(ye=ue.x,Me=s.y+Z*(ue.x-s.x)/A):h&1&&(ye=te.x,Me=s.y+Z*(te.x-s.x)/A),new re(ye,Me,S)}function Ra(s,c){var h=0;return s.x<c.min.x?h|=1:s.x>c.max.x&&(h|=2),s.y<c.min.y?h|=4:s.y>c.max.y&&(h|=8),h}function yk(s,c){var h=c.x-s.x,x=c.y-s.y;return h*h+x*x}function Lo(s,c,h,x){var S=c.x,A=c.y,Z=h.x-S,te=h.y-A,ue=Z*Z+te*te,ye;return ue>0&&(ye=((s.x-S)*Z+(s.y-A)*te)/ue,ye>1?(S=h.x,A=h.y):ye>0&&(S+=Z*ye,A+=te*ye)),Z=s.x-S,te=s.y-A,x?Z*Z+te*te:new re(S,A)}function _n(s){return!w(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function km(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),_n(s)}function Em(s,c){var h,x,S,A,Z,te,ue,ye;if(!s||s.length===0)throw new Error("latlngs not passed");_n(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Me=ie([0,0]),We=X(s),ht=We.getNorthWest().distanceTo(We.getSouthWest())*We.getNorthEast().distanceTo(We.getNorthWest());ht<1700&&(Me=r0(s));var Br=s.length,pr=[];for(h=0;h<Br;h++){var yn=ie(s[h]);pr.push(c.project(ie([yn.lat-Me.lat,yn.lng-Me.lng])))}for(h=0,x=0;h<Br-1;h++)x+=pr[h].distanceTo(pr[h+1])/2;if(x===0)ye=pr[0];else for(h=0,A=0;h<Br-1;h++)if(Z=pr[h],te=pr[h+1],S=Z.distanceTo(te),A+=S,A>x){ue=(A-x)/S,ye=[te.x-ue*(te.x-Z.x),te.y-ue*(te.y-Z.y)];break}var qr=c.unproject(ae(ye));return ie([qr.lat+Me.lat,qr.lng+Me.lng])}var wk={__proto__:null,simplify:vm,pointToSegmentDistance:_m,closestPointOnSegment:xk,clipSegment:wm,_getEdgeIntersection:gc,_getBitCode:Ra,_sqClosestPointOnSegment:Lo,isFlat:_n,_flat:km,polylineCenter:Em},i0={project:function(s){return new re(s.lng,s.lat)},unproject:function(s){return new W(s.y,s.x)},bounds:new pe([-180,-90],[180,90])},a0={R:6378137,R_MINOR:6356752314245179e-9,bounds:new pe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,h=this.R,x=s.lat*c,S=this.R_MINOR/h,A=Math.sqrt(1-S*S),Z=A*Math.sin(x),te=Math.tan(Math.PI/4-x/2)/Math.pow((1-Z)/(1+Z),A/2);return x=-h*Math.log(Math.max(te,1e-10)),new re(s.lng*c*h,x)},unproject:function(s){for(var c=180/Math.PI,h=this.R,x=this.R_MINOR/h,S=Math.sqrt(1-x*x),A=Math.exp(-s.y/h),Z=Math.PI/2-2*Math.atan(A),te=0,ue=.1,ye;te<15&&Math.abs(ue)>1e-7;te++)ye=S*Math.sin(Z),ye=Math.pow((1-ye)/(1+ye),S/2),ue=Math.PI/2-2*Math.atan(A*ye)-Z,Z+=ue;return new W(Z*c,s.x*c/h)}},kk={__proto__:null,LonLat:i0,Mercator:a0,SphericalMercator:_e},Ek=i({},Le,{code:"EPSG:3395",projection:a0,transformation:function(){var s=.5/(Math.PI*a0.R);return H(s,.5,-s,.5)}()}),Tm=i({},Le,{code:"EPSG:4326",projection:i0,transformation:H(1/180,1,-1/180,.5)}),Tk=i({},we,{projection:i0,transformation:H(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var h=c.lng-s.lng,x=c.lat-s.lat;return Math.sqrt(h*h+x*x)},infinite:!0});we.Earth=Le,we.EPSG3395=Ek,we.EPSG3857=Ye,we.EPSG900913=rt,we.EPSG4326=Tm,we.Simple=Tk;var Bn=xe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[u(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[u(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});vt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=u(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return u(s)in this._layers},eachLayer:function(s,c){for(var h in this._layers)s.call(c,this._layers[h]);return this},_addLayers:function(s){s=s?w(s)?s:[s]:[];for(var c=0,h=s.length;c<h;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[u(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=u(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,h=this._getZoomSpan();for(var x in this._zoomBoundLayers){var S=this._zoomBoundLayers[x].options;s=S.minZoom===void 0?s:Math.min(s,S.minZoom),c=S.maxZoom===void 0?c:Math.max(c,S.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var vs=Bn.extend({initialize:function(s,c){v(this,c),this._layers={};var h,x;if(s)for(h=0,x=s.length;h<x;h++)this.addLayer(s[h])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),h,x;for(h in this._layers)x=this._layers[h],x[s]&&x[s].apply(x,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var h in this._layers)s.call(c,this._layers[h]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return u(s)}}),Sk=function(s,c){return new vs(s,c)},Ti=vs.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),vs.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),vs.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new J;for(var c in this._layers){var h=this._layers[c];s.extend(h.getBounds?h.getBounds():h.getLatLng())}return s}}),Ck=function(s,c){return new Ti(s,c)},_s=Se.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){v(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var h=this._getIconUrl(s);if(!h){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var x=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(x,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),x},_setIconStyles:function(s,c){var h=this.options,x=h[c+"Size"];typeof x=="number"&&(x=[x,x]);var S=ae(x),A=ae(c==="shadow"&&h.shadowAnchor||h.iconAnchor||S&&S.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(h.className||""),A&&(s.style.marginLeft=-A.x+"px",s.style.marginTop=-A.y+"px"),S&&(s.style.width=S.x+"px",s.style.height=S.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return De.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Ak(s){return new _s(s)}var Po=_s.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Po.imagePath!="string"&&(Po.imagePath=this._detectIconPath()),(this.options.imagePath||Po.imagePath)+_s.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(h,x,S){var A=x.exec(h);return A&&A[S]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=it("div","leaflet-default-icon-path",document.body),c=Ei(s,"background-image")||Ei(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),Sm=si.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new qi(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),dt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&qt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,h=c._map,x=this._marker.options.autoPanSpeed,S=this._marker.options.autoPanPadding,A=Pa(c._icon),Z=h.getPixelBounds(),te=h.getPixelOrigin(),ue=O(Z.min._subtract(te).add(S),Z.max._subtract(te).subtract(S));if(!ue.contains(A)){var ye=ae((Math.max(ue.max.x,A.x)-ue.max.x)/(Z.max.x-ue.max.x)-(Math.min(ue.min.x,A.x)-ue.min.x)/(Z.min.x-ue.min.x),(Math.max(ue.max.y,A.y)-ue.max.y)/(Z.max.y-ue.max.y)-(Math.min(ue.min.y,A.y)-ue.min.y)/(Z.min.y-ue.min.y)).multiplyBy(x);h.panBy(ye,{animate:!1}),this._draggable._newPos._add(ye),this._draggable._startPos._add(ye),er(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=V(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=V(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,h=c._shadow,x=Pa(c._icon),S=c._map.layerPointToLatLng(x);h&&er(h,x),c._latlng=S,s.latlng=S,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),xc=Bn.extend({options:{icon:new Po,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){v(this,c),this._latlng=ie(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=ie(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=s.icon.createIcon(this._icon),x=!1;h!==this._icon&&(this._icon&&this._removeIcon(),x=!0,s.title&&(h.title=s.title),h.tagName==="IMG"&&(h.alt=s.alt||"")),dt(h,c),s.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&at(h,"focus",this._panOnFocus,this);var S=s.icon.createShadow(this._shadow),A=!1;S!==this._shadow&&(this._removeShadow(),A=!0),S&&(dt(S,c),S.alt=""),this._shadow=S,s.opacity<1&&this._updateOpacity(),x&&this.getPane().appendChild(this._icon),this._initInteraction(),S&&A&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Lt(this._icon,"focus",this._panOnFocus,this),zt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&zt(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&er(this._icon,s),this._shadow&&er(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Sm)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Sm(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&vn(this._icon,s),this._shadow&&vn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,h=c.iconSize?ae(c.iconSize):ae(0,0),x=c.iconAnchor?ae(c.iconAnchor):ae(0,0);s.panInside(this._latlng,{paddingTopLeft:x,paddingBottomRight:h.subtract(x)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Nk(s,c){return new xc(s,c)}var Yi=Bn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return v(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),vc=Yi.extend({options:{fill:!0,radius:10},initialize:function(s,c){v(this,c),this._latlng=ie(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=ie(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return Yi.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,h=this._clickTolerance(),x=[s+h,c+h];this._pxBounds=new pe(this._point.subtract(x),this._point.add(x))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function bk(s,c){return new vc(s,c)}var s0=vc.extend({initialize:function(s,c,h){if(typeof c=="number"&&(c=i({},h,{radius:c})),v(this,c),this._latlng=ie(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new J(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Yi.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,h=this._map,x=h.options.crs;if(x.distance===Le.distance){var S=Math.PI/180,A=this._mRadius/Le.R/S,Z=h.project([c+A,s]),te=h.project([c-A,s]),ue=Z.add(te).divideBy(2),ye=h.unproject(ue).lat,Me=Math.acos((Math.cos(A*S)-Math.sin(c*S)*Math.sin(ye*S))/(Math.cos(c*S)*Math.cos(ye*S)))/S;(isNaN(Me)||Me===0)&&(Me=A/Math.cos(Math.PI/180*c)),this._point=ue.subtract(h.getPixelOrigin()),this._radius=isNaN(Me)?0:ue.x-h.project([ye,s-Me]).x,this._radiusY=ue.y-Z.y}else{var We=x.unproject(x.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(We).x}this._updateBounds()}});function Lk(s,c,h){return new s0(s,c,h)}var Si=Yi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){v(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,h=null,x=Lo,S,A,Z=0,te=this._parts.length;Z<te;Z++)for(var ue=this._parts[Z],ye=1,Me=ue.length;ye<Me;ye++){S=ue[ye-1],A=ue[ye];var We=x(s,S,A,!0);We<c&&(c=We,h=x(s,S,A))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Em(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=ie(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new J,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return _n(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],h=_n(s),x=0,S=s.length;x<S;x++)h?(c[x]=ie(s[x]),this._bounds.extend(c[x])):c[x]=this._convertLatLngs(s[x]);return c},_project:function(){var s=new pe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new re(s,s);this._rawPxBounds&&(this._pxBounds=new pe([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,h){var x=s[0]instanceof W,S=s.length,A,Z;if(x){for(Z=[],A=0;A<S;A++)Z[A]=this._map.latLngToLayerPoint(s[A]),h.extend(Z[A]);c.push(Z)}else for(A=0;A<S;A++)this._projectLatlngs(s[A],c,h)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,x,S,A,Z,te,ue;for(h=0,S=0,A=this._rings.length;h<A;h++)for(ue=this._rings[h],x=0,Z=ue.length;x<Z-1;x++)te=wm(ue[x],ue[x+1],s,x,!0),te&&(c[S]=c[S]||[],c[S].push(te[0]),(te[1]!==ue[x+1]||x===Z-2)&&(c[S].push(te[1]),S++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,h=0,x=s.length;h<x;h++)s[h]=vm(s[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var h,x,S,A,Z,te,ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(h=0,A=this._parts.length;h<A;h++)for(te=this._parts[h],x=0,Z=te.length,S=Z-1;x<Z;S=x++)if(!(!c&&x===0)&&_m(s,te[S],te[x])<=ue)return!0;return!1}});function Pk(s,c){return new Si(s,c)}Si._flat=km;var ys=Si.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xm(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=Si.prototype._convertLatLngs.call(this,s),h=c.length;return h>=2&&c[0]instanceof W&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(s){Si.prototype._setLatLngs.call(this,s),_n(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return _n(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,h=new re(c,c);if(s=new pe(s.min.subtract(h),s.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var x=0,S=this._rings.length,A;x<S;x++)A=gm(this._rings[x],s,!0),A.length&&this._parts.push(A)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,h,x,S,A,Z,te,ue,ye;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(A=0,ue=this._parts.length;A<ue;A++)for(h=this._parts[A],Z=0,ye=h.length,te=ye-1;Z<ye;te=Z++)x=h[Z],S=h[te],x.y>s.y!=S.y>s.y&&s.x<(S.x-x.x)*(s.y-x.y)/(S.y-x.y)+x.x&&(c=!c);return c||Si.prototype._containsPoint.call(this,s,!0)}});function Fk(s,c){return new ys(s,c)}var Ci=Ti.extend({initialize:function(s,c){v(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=w(s)?s:s.features,h,x,S;if(c){for(h=0,x=c.length;h<x;h++)S=c[h],(S.geometries||S.geometry||S.features||S.coordinates)&&this.addData(S);return this}var A=this.options;if(A.filter&&!A.filter(s))return this;var Z=_c(s,A);return Z?(Z.feature=kc(s),Z.defaultOptions=Z.options,this.resetStyle(Z),A.onEachFeature&&A.onEachFeature(s,Z),this.addLayer(Z)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=i({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function _c(s,c){var h=s.type==="Feature"?s.geometry:s,x=h?h.coordinates:null,S=[],A=c&&c.pointToLayer,Z=c&&c.coordsToLatLng||o0,te,ue,ye,Me;if(!x&&!h)return null;switch(h.type){case"Point":return te=Z(x),Cm(A,s,te,c);case"MultiPoint":for(ye=0,Me=x.length;ye<Me;ye++)te=Z(x[ye]),S.push(Cm(A,s,te,c));return new Ti(S);case"LineString":case"MultiLineString":return ue=yc(x,h.type==="LineString"?0:1,Z),new Si(ue,c);case"Polygon":case"MultiPolygon":return ue=yc(x,h.type==="Polygon"?1:2,Z),new ys(ue,c);case"GeometryCollection":for(ye=0,Me=h.geometries.length;ye<Me;ye++){var We=_c({geometry:h.geometries[ye],type:"Feature",properties:s.properties},c);We&&S.push(We)}return new Ti(S);case"FeatureCollection":for(ye=0,Me=h.features.length;ye<Me;ye++){var ht=_c(h.features[ye],c);ht&&S.push(ht)}return new Ti(S);default:throw new Error("Invalid GeoJSON object.")}}function Cm(s,c,h,x){return s?s(c,h):new xc(h,x&&x.markersInheritOptions&&x)}function o0(s){return new W(s[1],s[0],s[2])}function yc(s,c,h){for(var x=[],S=0,A=s.length,Z;S<A;S++)Z=c?yc(s[S],c-1,h):(h||o0)(s[S]),x.push(Z);return x}function l0(s,c){return s=ie(s),s.alt!==void 0?[g(s.lng,c),g(s.lat,c),g(s.alt,c)]:[g(s.lng,c),g(s.lat,c)]}function wc(s,c,h,x){for(var S=[],A=0,Z=s.length;A<Z;A++)S.push(c?wc(s[A],_n(s[A])?0:c-1,h,x):l0(s[A],x));return!c&&h&&S.length>0&&S.push(S[0].slice()),S}function ws(s,c){return s.feature?i({},s.feature,{geometry:c}):kc(c)}function kc(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var c0={toGeoJSON:function(s){return ws(this,{type:"Point",coordinates:l0(this.getLatLng(),s)})}};xc.include(c0),s0.include(c0),vc.include(c0),Si.include({toGeoJSON:function(s){var c=!_n(this._latlngs),h=wc(this._latlngs,c?1:0,!1,s);return ws(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),ys.include({toGeoJSON:function(s){var c=!_n(this._latlngs),h=c&&!_n(this._latlngs[0]),x=wc(this._latlngs,h?2:c?1:0,!0,s);return c||(x=[x]),ws(this,{type:(h?"Multi":"")+"Polygon",coordinates:x})}}),vs.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(s).geometry.coordinates)}),ws(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var h=c==="GeometryCollection",x=[];return this.eachLayer(function(S){if(S.toGeoJSON){var A=S.toGeoJSON(s);if(h)x.push(A.geometry);else{var Z=kc(A);Z.type==="FeatureCollection"?x.push.apply(x,Z.features):x.push(Z)}}}),h?ws(this,{geometries:x,type:"GeometryCollection"}):{type:"FeatureCollection",features:x}}});function Am(s,c){return new Ci(s,c)}var Ok=Am,Ec=Bn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,h){this._url=s,this._bounds=X(c),v(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){zt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&gs(this._image),this},bringToBack:function(){return this._map&&xs(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=X(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:it("img");if(dt(c,"leaflet-image-layer"),this._zoomAnimated&&dt(c,"leaflet-zoom-animated"),this.options.className&&dt(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;La(this._image,h,c)},_reset:function(){var s=this._image,c=new pe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();er(s,c.min),s.style.width=h.x+"px",s.style.height=h.y+"px"},_updateOpacity:function(){vn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Rk=function(s,c,h){return new Ec(s,c,h)},Nm=Ec.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:it("video");if(dt(c,"leaflet-image-layer"),this._zoomAnimated&&dt(c,"leaflet-zoom-animated"),this.options.className&&dt(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),s){for(var h=c.getElementsByTagName("source"),x=[],S=0;S<h.length;S++)x.push(h[S].src);this._url=h.length>0?x:[c.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var A=0;A<this._url.length;A++){var Z=it("source");Z.src=this._url[A],c.appendChild(Z)}}});function Mk(s,c,h){return new Nm(s,c,h)}var bm=Ec.extend({_initImage:function(){var s=this._image=this._url;dt(s,"leaflet-image-layer"),this._zoomAnimated&&dt(s,"leaflet-zoom-animated"),this.options.className&&dt(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function Ik(s,c,h){return new bm(s,c,h)}var oi=Bn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof W||w(s))?(this._latlng=ie(s),v(this,c)):(v(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&vn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&vn(this._container,1),this.bringToFront(),this.options.interactive&&(dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(vn(this._container,0),this._removeTimeout=setTimeout(o(zt,void 0,this._container),200)):zt(this._container),this.options.interactive&&(qt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=ie(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&gs(this._container),this},bringToBack:function(){return this._map&&xs(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof Ti){c=null;var h=this._source._layers;for(var x in h)if(h[x]._map){c=h[x];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=ae(this.options.offset),h=this._getAnchor();this._zoomAnimated?er(this._container,s.add(h)):c=c.add(s).add(h);var x=this._containerBottom=-c.y,S=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=x+"px",this._container.style.left=S+"px"}},_getAnchor:function(){return[0,0]}});vt.include({_initOverlay:function(s,c,h,x){var S=c;return S instanceof s||(S=new s(x).setContent(c)),h&&S.setLatLng(h),S}}),Bn.include({_initOverlay:function(s,c,h,x){var S=h;return S instanceof s?(v(S,x),S._source=this):(S=c&&!x?c:new s(x,this),S.setContent(h)),S}});var Tc=oi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,oi.prototype.openOn.call(this,s)},onAdd:function(s){oi.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Yi||this._source.on("preclick",Fa))},onRemove:function(s){oi.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Yi||this._source.off("preclick",Fa))},getEvents:function(){var s=oi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=it("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=it("div",s+"-content-wrapper",c);if(this._contentNode=it("div",s+"-content",h),No(c),Jf(this._contentNode),at(c,"contextmenu",Fa),this._tipContainer=it("div",s+"-tip-container",c),this._tip=it("div",s+"-tip",this._tipContainer),this.options.closeButton){var x=this._closeButton=it("a",s+"-close-button",c);x.setAttribute("role","button"),x.setAttribute("aria-label","Close popup"),x.href="#close",x.innerHTML='<span aria-hidden="true">&#215;</span>',at(x,"click",function(S){_r(S),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var h=s.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var x=s.offsetHeight,S=this.options.maxHeight,A="leaflet-popup-scrolled";S&&x>S?(c.height=S+"px",dt(s,A)):qt(s,A),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),h=this._getAnchor();er(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(Ei(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,x=this._containerWidth,S=new re(this._containerLeft,-h-this._containerBottom);S._add(Pa(this._container));var A=s.layerPointToContainerPoint(S),Z=ae(this.options.autoPanPadding),te=ae(this.options.autoPanPaddingTopLeft||Z),ue=ae(this.options.autoPanPaddingBottomRight||Z),ye=s.getSize(),Me=0,We=0;A.x+x+ue.x>ye.x&&(Me=A.x+x-ye.x+ue.x),A.x-Me-te.x<0&&(Me=A.x-te.x),A.y+h+ue.y>ye.y&&(We=A.y+h-ye.y+ue.y),A.y-We-te.y<0&&(We=A.y-te.y),(Me||We)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Me,We]))}},_getAnchor:function(){return ae(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Dk=function(s,c){return new Tc(s,c)};vt.mergeOptions({closePopupOnClick:!0}),vt.include({openPopup:function(s,c,h){return this._initOverlay(Tc,s,c,h).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Bn.include({bindPopup:function(s,c){return this._popup=this._initOverlay(Tc,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Ti||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Oa(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof Yi)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Sc=oi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){oi.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){oi.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=oi.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=it("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,h,x=this._map,S=this._container,A=x.latLngToContainerPoint(x.getCenter()),Z=x.layerPointToContainerPoint(s),te=this.options.direction,ue=S.offsetWidth,ye=S.offsetHeight,Me=ae(this.options.offset),We=this._getAnchor();te==="top"?(c=ue/2,h=ye):te==="bottom"?(c=ue/2,h=0):te==="center"?(c=ue/2,h=ye/2):te==="right"?(c=0,h=ye/2):te==="left"?(c=ue,h=ye/2):Z.x<A.x?(te="right",c=0,h=ye/2):(te="left",c=ue+(Me.x+We.x)*2,h=ye/2),s=s.subtract(ae(c,h,!0)).add(Me).add(We),qt(S,"leaflet-tooltip-right"),qt(S,"leaflet-tooltip-left"),qt(S,"leaflet-tooltip-top"),qt(S,"leaflet-tooltip-bottom"),dt(S,"leaflet-tooltip-"+te),er(S,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&vn(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return ae(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),jk=function(s,c){return new Sc(s,c)};vt.include({openTooltip:function(s,c,h){return this._initOverlay(Sc,s,c,h).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Bn.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Sc,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Ti||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(at(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),at(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,h,x;this._tooltip.options.sticky&&s.originalEvent&&(h=this._map.mouseEventToContainerPoint(s.originalEvent),x=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(x)),this._tooltip.setLatLng(c)}});var Lm=_s.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),h=this.options;if(h.html instanceof Element?(fc(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var x=ae(h.bgPos);c.style.backgroundPosition=-x.x+"px "+-x.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Bk(s){return new Lm(s)}_s.Default=Po;var Fo=Bn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:De.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){v(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),zt(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(gs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(xs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof re?s:new re(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,h=-s(-1/0,1/0),x=0,S=c.length,A;x<S;x++)A=c[x].style.zIndex,c[x]!==this._container&&A&&(h=s(h,+A));isFinite(h)&&(this.options.zIndex=h+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!De.ielt9){vn(this._container,this.options.opacity);var s=+new Date,c=!1,h=!1;for(var x in this._tiles){var S=this._tiles[x];if(!(!S.current||!S.loaded)){var A=Math.min(1,(s-S.loaded)/200);vn(S.el,A),A<1?c=!0:(S.active?h=!0:this._onOpaqueTile(S),S.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(G(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=it("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===s?(this._levels[h].el.style.zIndex=c-Math.abs(s-h),this._onUpdateLevel(h)):(zt(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var x=this._levels[s],S=this._map;return x||(x=this._levels[s]={},x.el=it("div","leaflet-tile-container leaflet-zoom-animated",this._container),x.el.style.zIndex=c,x.origin=S.project(S.unproject(S.getPixelOrigin()),s).round(),x.zoom=s,this._setZoomTransform(x,S.getCenter(),S.getZoom()),m(x.el.offsetWidth),this._onCreateLevel(x)),this._level=x,x}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var x=c.coords;this._retainParent(x.x,x.y,x.z,x.z-5)||this._retainChildren(x.x,x.y,x.z,x.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)zt(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,h,x){var S=Math.floor(s/2),A=Math.floor(c/2),Z=h-1,te=new re(+S,+A);te.z=+Z;var ue=this._tileCoordsToKey(te),ye=this._tiles[ue];return ye&&ye.active?(ye.retain=!0,!0):(ye&&ye.loaded&&(ye.retain=!0),Z>x?this._retainParent(S,A,Z,x):!1)},_retainChildren:function(s,c,h,x){for(var S=2*s;S<2*s+2;S++)for(var A=2*c;A<2*c+2;A++){var Z=new re(S,A);Z.z=h+1;var te=this._tileCoordsToKey(Z),ue=this._tiles[te];if(ue&&ue.active){ue.retain=!0;continue}else ue&&ue.loaded&&(ue.retain=!0);h+1<x&&this._retainChildren(S,A,h+1,x)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,h,x){var S=Math.round(c);this.options.maxZoom!==void 0&&S>this.options.maxZoom||this.options.minZoom!==void 0&&S<this.options.minZoom?S=void 0:S=this._clampZoom(S);var A=this.options.updateWhenZooming&&S!==this._tileZoom;(!x||A)&&(this._tileZoom=S,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),S!==void 0&&this._update(s),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],s,c)},_setZoomTransform:function(s,c,h){var x=this._map.getZoomScale(h,s.zoom),S=s.origin.multiplyBy(x).subtract(this._map._getNewPixelOrigin(c,h)).round();De.any3d?La(s.el,S,x):er(s.el,S)},_resetGrid:function(){var s=this._map,c=s.options.crs,h=this._tileSize=this.getTileSize(),x=this._tileZoom,S=this._map.getPixelWorldBounds(this._tileZoom);S&&(this._globalTileRange=this._pxBoundsToTileRange(S)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],x).x/h.x),Math.ceil(s.project([0,c.wrapLng[1]],x).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],x).y/h.x),Math.ceil(s.project([c.wrapLat[1],0],x).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),x=c.getZoomScale(h,this._tileZoom),S=c.project(s,this._tileZoom).floor(),A=c.getSize().divideBy(x*2);return new pe(S.subtract(A),S.add(A))},_update:function(s){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var x=this._getTiledPixelBounds(s),S=this._pxBoundsToTileRange(x),A=S.getCenter(),Z=[],te=this.options.keepBuffer,ue=new pe(S.getBottomLeft().subtract([te,-te]),S.getTopRight().add([te,-te]));if(!(isFinite(S.min.x)&&isFinite(S.min.y)&&isFinite(S.max.x)&&isFinite(S.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ye in this._tiles){var Me=this._tiles[ye].coords;(Me.z!==this._tileZoom||!ue.contains(new re(Me.x,Me.y)))&&(this._tiles[ye].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(s,h);return}for(var We=S.min.y;We<=S.max.y;We++)for(var ht=S.min.x;ht<=S.max.x;ht++){var Br=new re(ht,We);if(Br.z=this._tileZoom,!!this._isValidTile(Br)){var pr=this._tiles[this._tileCoordsToKey(Br)];pr?pr.current=!0:Z.push(Br)}}if(Z.sort(function(qr,Es){return qr.distanceTo(A)-Es.distanceTo(A)}),Z.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var yn=document.createDocumentFragment();for(ht=0;ht<Z.length;ht++)this._addTile(Z[ht],yn);this._level.el.appendChild(yn)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(s.x<h.min.x||s.x>h.max.x)||!c.wrapLat&&(s.y<h.min.y||s.y>h.max.y))return!1}if(!this.options.bounds)return!0;var x=this._tileCoordsToBounds(s);return X(this.options.bounds).overlaps(x)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,h=this.getTileSize(),x=s.scaleBy(h),S=x.add(h),A=c.unproject(x,s.z),Z=c.unproject(S,s.z);return[A,Z]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),h=new J(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),h=new re(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(s){var c=this._tiles[s];c&&(zt(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){dt(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=m,s.onmousemove=m,De.ielt9&&this.options.opacity<1&&vn(s,this.options.opacity)},_addTile:function(s,c){var h=this._getTilePos(s),x=this._tileCoordsToKey(s),S=this.createTile(this._wrapCoords(s),o(this._tileReady,this,s));this._initTile(S),this.createTile.length<2&&V(o(this._tileReady,this,s,null,S)),er(S,h),this._tiles[x]={el:S,coords:s,current:!0},c.appendChild(S),this.fire("tileloadstart",{tile:S,coords:s})},_tileReady:function(s,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:s});var x=this._tileCoordsToKey(s);h=this._tiles[x],h&&(h.loaded=+new Date,this._map._fadeAnimated?(vn(h.el,0),G(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(dt(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),De.ielt9||!this._map._fadeAnimated?V(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new re(this._wrapX?d(s.x,this._wrapX):s.x,this._wrapY?d(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new pe(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function zk(s){return new Fo(s)}var ks=Fo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=v(this,c),c.detectRetina&&De.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var h=document.createElement("img");return at(h,"load",o(this._tileOnLoad,this,c,h)),at(h,"error",o(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(s),h},getTileUrl:function(s){var c={r:De.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=h),c["-y"]=h}return E(this._url,i(c,this.options))},_tileOnLoad:function(s,c){De.ielt9?setTimeout(o(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,h){var x=this.options.errorTileUrl;x&&c.getAttribute("src")!==x&&(c.src=x),s(h,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,x=this.options.zoomOffset;return h&&(s=c-s),s+x},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=m,c.onerror=m,!c.complete)){c.src=I;var h=this._tiles[s].coords;zt(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",I),Fo.prototype._removeTile.call(this,s)},_tileReady:function(s,c,h){if(!(!this._map||h&&h.getAttribute("src")===I))return Fo.prototype._tileReady.call(this,s,c,h)}});function Pm(s,c){return new ks(s,c)}var Fm=ks.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var h=i({},this.defaultWmsParams);for(var x in c)x in this.options||(h[x]=c[x]);c=v(this,c);var S=c.detectRetina&&De.retina?2:1,A=this.getTileSize();h.width=A.x*S,h.height=A.y*S,this.wmsParams=h},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,ks.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),h=this._crs,x=O(h.project(c[0]),h.project(c[1])),S=x.min,A=x.max,Z=(this._wmsVersion>=1.3&&this._crs===Tm?[S.y,S.x,A.y,A.x]:[S.x,S.y,A.x,A.y]).join(","),te=ks.prototype.getTileUrl.call(this,s);return te+T(this.wmsParams,te,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Z},setParams:function(s,c){return i(this.wmsParams,s),c||this.redraw(),this}});function Uk(s,c){return new Fm(s,c)}ks.WMS=Fm,Pm.wms=Uk;var Ai=Bn.extend({options:{padding:.1},initialize:function(s){v(this,s),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var h=this._map.getZoomScale(c,this._zoom),x=this._map.getSize().multiplyBy(.5+this.options.padding),S=this._map.project(this._center,c),A=x.multiplyBy(-h).add(S).subtract(this._map._getNewPixelOrigin(s,c));De.any3d?La(this._container,A,h):er(this._container,A)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new pe(h,h.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Om=Ai.extend({options:{tolerance:0},getEvents:function(){var s=Ai.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ai.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");at(s,"mousemove",this._onMouseMove,this),at(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),at(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,zt(this._container),Lt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ai.prototype._update.call(this);var s=this._bounds,c=this._container,h=s.getSize(),x=De.retina?2:1;er(c,s.min),c.width=x*h.x,c.height=x*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",De.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Ai.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[u(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,h=c.next,x=c.prev;h?h.prev=x:this._drawLast=x,x?x.next=h:this._drawFirst=h,delete s._order,delete this._layers[u(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),h=[],x,S;for(S=0;S<c.length;S++){if(x=Number(c[S]),isNaN(x))return;h.push(x)}s.options._dashArray=h}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||V(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new pe,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var x=this._drawFirst;x;x=x.next)s=x.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var h,x,S,A,Z=s._parts,te=Z.length,ue=this._ctx;if(te){for(ue.beginPath(),h=0;h<te;h++){for(x=0,S=Z[h].length;x<S;x++)A=Z[h][x],ue[x?"lineTo":"moveTo"](A.x,A.y);c&&ue.closePath()}this._fillStroke(ue,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,h=this._ctx,x=Math.max(Math.round(s._radius),1),S=(Math.max(Math.round(s._radiusY),1)||x)/x;S!==1&&(h.save(),h.scale(1,S)),h.beginPath(),h.arc(c.x,c.y/S,x,0,Math.PI*2,!1),S!==1&&h.restore(),this._fillStroke(h,s)}},_fillStroke:function(s,c){var h=c.options;h.fill&&(s.globalAlpha=h.fillOpacity,s.fillStyle=h.fillColor||h.color,s.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=h.opacity,s.lineWidth=h.weight,s.strokeStyle=h.color,s.lineCap=h.lineCap,s.lineJoin=h.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),h,x,S=this._drawFirst;S;S=S.next)h=S.layer,h.options.interactive&&h._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(h))&&(x=h);this._fireEvent(x?[x]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(qt(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var h,x,S=this._drawFirst;S;S=S.next)h=S.layer,h.options.interactive&&h._containsPoint(c)&&(x=h);x!==this._hoveredLayer&&(this._handleMouseOut(s),x&&(dt(this._container,"leaflet-interactive"),this._fireEvent([x],s,"mouseover"),this._hoveredLayer=x)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,h){this._map._fireDOMEvent(c,h||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var h=c.next,x=c.prev;if(h)h.prev=x;else return;x?x.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var h=c.next,x=c.prev;if(x)x.next=h;else return;h?h.prev=x:x&&(this._drawLast=x),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function Rm(s){return De.canvas?new Om(s):null}var Oo=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Hk={_initContainer:function(){this._container=it("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ai.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=Oo("shape");dt(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=Oo("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;zt(c),s.removeInteractiveTarget(c),delete this._layers[u(s)]},_updateStyle:function(s){var c=s._stroke,h=s._fill,x=s.options,S=s._container;S.stroked=!!x.stroke,S.filled=!!x.fill,x.stroke?(c||(c=s._stroke=Oo("stroke")),S.appendChild(c),c.weight=x.weight+"px",c.color=x.color,c.opacity=x.opacity,x.dashArray?c.dashStyle=w(x.dashArray)?x.dashArray.join(" "):x.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=x.lineCap.replace("butt","flat"),c.joinstyle=x.lineJoin):c&&(S.removeChild(c),s._stroke=null),x.fill?(h||(h=s._fill=Oo("fill")),S.appendChild(h),h.color=x.fillColor||x.color,h.opacity=x.fillOpacity):h&&(S.removeChild(h),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),h=Math.round(s._radius),x=Math.round(s._radiusY||h);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+x+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){gs(s._container)},_bringToBack:function(s){xs(s._container)}},Cc=De.vml?Oo:et,Ro=Ai.extend({_initContainer:function(){this._container=Cc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Cc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){zt(this._container),Lt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ai.prototype._update.call(this);var s=this._bounds,c=s.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),er(h,s.min),h.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=Cc("path");s.options.className&&dt(c,s.options.className),s.options.interactive&&dt(c,"leaflet-interactive"),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){zt(s._path),s.removeInteractiveTarget(s._path),delete this._layers[u(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,h=s.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,Ge(s._parts,c))},_updateCircle:function(s){var c=s._point,h=Math.max(Math.round(s._radius),1),x=Math.max(Math.round(s._radiusY),1)||h,S="a"+h+","+x+" 0 1,0 ",A=s._empty()?"M0 0":"M"+(c.x-h)+","+c.y+S+h*2+",0 "+S+-h*2+",0 ";this._setPath(s,A)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){gs(s._path)},_bringToBack:function(s){xs(s._path)}});De.vml&&Ro.include(Hk);function Mm(s){return De.svg||De.vml?new Ro(s):null}vt.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&Rm(s)||Mm(s)}});var Im=ys.extend({initialize:function(s,c){ys.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=X(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Vk(s,c){return new Im(s,c)}Ro.create=Cc,Ro.pointsToPath=Ge,Ci.geometryToLayer=_c,Ci.coordsToLatLng=o0,Ci.coordsToLatLngs=yc,Ci.latLngToCoords=l0,Ci.latLngsToCoords=wc,Ci.getFeature=ws,Ci.asFeature=kc,vt.mergeOptions({boxZoom:!0});var Dm=si.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){at(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Lt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){zt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),So(),Wf(),this._startPoint=this._map.mouseEventToContainerPoint(s),at(document,{contextmenu:Oa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=it("div","leaflet-zoom-box",this._container),dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new pe(this._point,this._startPoint),h=c.getSize();er(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(zt(this._box),qt(this._container,"leaflet-crosshair")),Co(),$f(),Lt(document,{contextmenu:Oa,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new J(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});vt.addInitHook("addHandler","boxZoom",Dm),vt.mergeOptions({doubleClickZoom:!0});var jm=si.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,h=c.getZoom(),x=c.options.zoomDelta,S=s.originalEvent.shiftKey?h-x:h+x;c.options.doubleClickZoom==="center"?c.setZoom(S):c.setZoomAround(s.containerPoint,S)}});vt.addInitHook("addHandler","doubleClickZoom",jm),vt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Bm=si.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new qi(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){qt(this._map._container,"leaflet-grab"),qt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=X(this._map.options.maxBounds);this._offsetLimit=O(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),h=this._initialWorldOffset,x=this._draggable._newPos.x,S=(x-c+h)%s+c-h,A=(x+c+h)%s-c-h,Z=Math.abs(S+h)<Math.abs(A+h)?S:A;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Z},_onDragEnd:function(s){var c=this._map,h=c.options,x=!h.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),x)c.fire("moveend");else{this._prunePositions(+new Date);var S=this._lastPos.subtract(this._positions[0]),A=(this._lastTime-this._times[0])/1e3,Z=h.easeLinearity,te=S.multiplyBy(Z/A),ue=te.distanceTo([0,0]),ye=Math.min(h.inertiaMaxSpeed,ue),Me=te.multiplyBy(ye/ue),We=ye/(h.inertiaDeceleration*Z),ht=Me.multiplyBy(-We/2).round();!ht.x&&!ht.y?c.fire("moveend"):(ht=c._limitOffset(ht,c.options.maxBounds),V(function(){c.panBy(ht,{duration:We,easeLinearity:Z,noMoveStart:!0,animate:!0})}))}}});vt.addInitHook("addHandler","dragging",Bm),vt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var zm=si.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),at(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Lt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,h=s.scrollTop||c.scrollTop,x=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(x,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},h=this.keyCodes,x,S;for(x=0,S=h.left.length;x<S;x++)c[h.left[x]]=[-1*s,0];for(x=0,S=h.right.length;x<S;x++)c[h.right[x]]=[s,0];for(x=0,S=h.down.length;x<S;x++)c[h.down[x]]=[0,s];for(x=0,S=h.up.length;x<S;x++)c[h.up[x]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},h=this.keyCodes,x,S;for(x=0,S=h.zoomIn.length;x<S;x++)c[h.zoomIn[x]]=s;for(x=0,S=h.zoomOut.length;x<S;x++)c[h.zoomOut[x]]=-s},_addHooks:function(){at(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Lt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,h=this._map,x;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(x=this._panKeys[c],s.shiftKey&&(x=ae(x).multiplyBy(3)),h.options.maxBounds&&(x=h._limitOffset(ae(x),h.options.maxBounds)),h.options.worldCopyJump){var S=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(x)));h.panTo(S)}else h.panBy(x)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Oa(s)}}});vt.addInitHook("addHandler","keyboard",zm),vt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Um=si.extend({addHooks:function(){at(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Lt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=fm(s),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var x=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),x),Oa(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),h=this._map.options.zoomSnap||0;s._stop();var x=this._delta/(this._map.options.wheelPxPerZoomLevel*4),S=4*Math.log(2/(1+Math.exp(-Math.abs(x))))/Math.LN2,A=h?Math.ceil(S/h)*h:S,Z=s._limitZoom(c+(this._delta>0?A:-A))-c;this._delta=0,this._startTime=null,Z&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+Z):s.setZoomAround(this._lastMousePos,c+Z))}});vt.addInitHook("addHandler","scrollWheelZoom",Um);var Wk=600;vt.mergeOptions({tapHold:De.touchNative&&De.safari&&De.mobile,tapTolerance:15});var Hm=si.extend({addHooks:function(){at(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Lt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new re(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(at(document,"touchend",_r),at(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),Wk),at(document,"touchend touchcancel contextmenu",this._cancel,this),at(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Lt(document,"touchend",_r),Lt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Lt(document,"touchend touchcancel contextmenu",this._cancel,this),Lt(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new re(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var h=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});vt.addInitHook("addHandler","tapHold",Hm),vt.mergeOptions({touchZoom:De.touch,bounceAtZoomLimits:!0});var Vm=si.extend({addHooks:function(){dt(this._map._container,"leaflet-touch-zoom"),at(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){qt(this._map._container,"leaflet-touch-zoom"),Lt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(s.touches[0]),x=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(x)._divideBy(2))),this._startDist=h.distanceTo(x),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),at(document,"touchmove",this._onTouchMove,this),at(document,"touchend touchcancel",this._onTouchEnd,this),_r(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(s.touches[0]),x=c.mouseEventToContainerPoint(s.touches[1]),S=h.distanceTo(x)/this._startDist;if(this._zoom=c.getScaleZoom(S,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&S<1||this._zoom>c.getMaxZoom()&&S>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,S===1)return}else{var A=h._add(x)._divideBy(2)._subtract(this._centerPoint);if(S===1&&A.x===0&&A.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(A),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var Z=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=V(Z,this,!0),_r(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),Lt(document,"touchmove",this._onTouchMove,this),Lt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});vt.addInitHook("addHandler","touchZoom",Vm),vt.BoxZoom=Dm,vt.DoubleClickZoom=jm,vt.Drag=Bm,vt.Keyboard=zm,vt.ScrollWheelZoom=Um,vt.TapHold=Hm,vt.TouchZoom=Vm,r.Bounds=pe,r.Browser=De,r.CRS=we,r.Canvas=Om,r.Circle=s0,r.CircleMarker=vc,r.Class=Se,r.Control=jn,r.DivIcon=Lm,r.DivOverlay=oi,r.DomEvent=lk,r.DomUtil=sk,r.Draggable=qi,r.Evented=xe,r.FeatureGroup=Ti,r.GeoJSON=Ci,r.GridLayer=Fo,r.Handler=si,r.Icon=_s,r.ImageOverlay=Ec,r.LatLng=W,r.LatLngBounds=J,r.Layer=Bn,r.LayerGroup=vs,r.LineUtil=wk,r.Map=vt,r.Marker=xc,r.Mixin=mk,r.Path=Yi,r.Point=re,r.PolyUtil=gk,r.Polygon=ys,r.Polyline=Si,r.Popup=Tc,r.PosAnimation=dm,r.Projection=kk,r.Rectangle=Im,r.Renderer=Ai,r.SVG=Ro,r.SVGOverlay=bm,r.TileLayer=ks,r.Tooltip=Sc,r.Transformation=ze,r.Util=de,r.VideoOverlay=Nm,r.bind=o,r.bounds=O,r.canvas=Rm,r.circle=Lk,r.circleMarker=bk,r.control=bo,r.divIcon=Bk,r.extend=i,r.featureGroup=Ck,r.geoJSON=Am,r.geoJson=Ok,r.gridLayer=zk,r.icon=Ak,r.imageOverlay=Rk,r.latLng=ie,r.latLngBounds=X,r.layerGroup=Sk,r.map=ck,r.marker=Nk,r.point=ae,r.polygon=Fk,r.polyline=Pk,r.popup=Dk,r.rectangle=Vk,r.setOptions=v,r.stamp=u,r.svg=Mm,r.svgOverlay=Ik,r.tileLayer=Pm,r.tooltip=jk,r.transformation=H,r.version=n,r.videoOverlay=Mk;var $k=window.L;r.noConflict=function(){return window.L=$k,this},window.L=r})})(ph,ph.exports);var wi=ph.exports;const Ln=$x(wi);function jw(e){return e.split(" ").filter(Boolean)}function Bw(e,t){jw(t).forEach(r=>{wi.DomUtil.addClass(e,r)})}function zw(e,t){jw(t).forEach(r=>{wi.DomUtil.removeClass(e,r)})}function hO(e,t,r){e!=null&&r!==t&&(t!=null&&t.length>0&&zw(e,t),r!=null&&r.length>0&&Bw(e,r))}function Eo(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function To(e,t){return t==null?function(n,i){const a=N.useRef();return a.current||(a.current=e(n,i)),a}:function(n,i){const a=N.useRef();a.current||(a.current=e(n,i));const o=N.useRef(n),{instance:l}=a.current;return N.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,i]),a}}function nm(e,t){N.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var a;(a=t.layerContainer)==null||a.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function im(e){return function(r){const n=ko(),i=e(cc(r,n),n);return Yp(n.map,r.attribution),Bf(i.current,r.eventHandlers),nm(i.current,n),i}}function Uw(e,t){const r=N.useRef();N.useEffect(function(){if(t.pathOptions!==r.current){const i=t.pathOptions??{};e.instance.setStyle(i),r.current=i}},[e,t])}function Hw(e){return function(r){const n=ko(),i=e(cc(r,n),n);return Bf(i.current,r.eventHandlers),nm(i.current,n),Uw(i.current,r),i}}function pO(e){function t(i,a){return Eo(e(i),a)}const r=To(t),n=Iw(r);return rm(n)}function Vw(e,t){const r=To(e,t),n=im(r);return tm(n)}function Ww(e,t){const r=To(e),n=Dw(r,t);return Mw(n)}function $w(e,t){const r=To(e,t),n=Hw(r);return tm(n)}function Zw(e,t){const r=To(e,t),n=im(r);return rm(n)}function Gw(e,t,r){const{opacity:n,zIndex:i}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),i!=null&&i!==r.zIndex&&e.setZIndex(i)}function mO(e,t,r){t.bounds instanceof wi.LatLngBounds&&t.bounds!==r.bounds&&e.setBounds(t.bounds),t.opacity!=null&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),t.zIndex!=null&&t.zIndex!==r.zIndex&&e.setZIndex(t.zIndex)}const gO=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_VERSION:Ow,LeafletContext:Qp,LeafletProvider:em,addClassName:Bw,createContainerComponent:tm,createControlComponent:pO,createControlHook:Iw,createDivOverlayComponent:Mw,createDivOverlayHook:Dw,createElementHook:To,createElementObject:Eo,createLayerComponent:Vw,createLayerHook:im,createLeafComponent:rm,createLeafletContext:Rw,createOverlayComponent:Ww,createPathComponent:$w,createPathHook:Hw,createTileLayerComponent:Zw,extendContext:Jp,removeClassName:zw,updateCircle:dO,updateClassName:hO,updateGridLayer:Gw,updateMediaOverlay:mO,useAttribution:Yp,useEventHandlers:Bf,useLayerLifecycle:nm,useLeafletContext:ko,usePathOptions:Uw,withPane:cc},Symbol.toStringTag,{value:"Module"}));function xO(){return ko().map}function vO(e){const t=xO();return N.useEffect(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}const _O=$w(function({data:t,...r},n){const i=new wi.GeoJSON(t,r);return Eo(i,Jp(n,{overlayContainer:i}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function mh(){return mh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mh.apply(this,arguments)}function yO({bounds:e,boundsOptions:t,center:r,children:n,className:i,id:a,placeholder:o,style:l,whenReady:u,zoom:f,...d},m){const[g]=N.useState({className:i,id:a,style:l}),[_,y]=N.useState(null);N.useImperativeHandle(m,()=>(_==null?void 0:_.map)??null,[_]);const v=N.useCallback(k=>{if(k!==null&&_===null){const E=new wi.Map(k,d);r!=null&&f!=null?E.setView(r,f):e!=null&&E.fitBounds(e,t),u!=null&&E.whenReady(u),y(Rw(E))}},[]);N.useEffect(()=>()=>{_==null||_.map.remove()},[_]);const T=_?Kn.createElement(em,{value:_},n):o??null;return Kn.createElement("div",mh({},g,{ref:v}),T)}const wO=N.forwardRef(yO),Ox=Vw(function({position:t,...r},n){const i=new wi.Marker(t,r);return Eo(i,Jp(n,{overlayContainer:i}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),Rx=Ww(function(t,r){const n=new wi.Popup(t,r.overlayContainer);return Eo(n,r)},function(t,r,{position:n},i){N.useEffect(function(){const{instance:o}=t;function l(f){f.popup===o&&(o.update(),i(!0))}function u(f){f.popup===o&&i(!1)}return r.map.on({popupopen:l,popupclose:u}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var d;r.map.off({popupopen:l,popupclose:u}),(d=r.overlayContainer)==null||d.unbindPopup(),r.map.removeLayer(o)}},[t,r,i,n])}),kO=Zw(function({url:t,...r},n){const i=new wi.TileLayer(t,cc(r,n));return Eo(i,n)},function(t,r,n){Gw(t,r,n);const{url:i}=r;i!=null&&i!==n.url&&t.setUrl(i)}),Xw=N.createContext({token:null,setToken:()=>{},isAuthenticated:!1,user:null,setUser:()=>{}}),Kw=()=>N.useContext(Xw),EO=({children:e})=>{const[t,r]=N.useState(localStorage.getItem("token")),[n,i]=N.useState(null),a=!!t;return p.jsx(Xw.Provider,{value:{token:t,setToken:r,isAuthenticated:a,user:n,setUser:i},children:e})};var qw={};const TO=uf(gO);var Mx={exports:{}};(function(e,t){(function(r,n){n(t)})(wa,function(r){var n=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){L.Util.setOptions(this,a),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var o=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,o?this._withAnimation:this._noAnimation),this._markerCluster=o?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof L.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this.fire("layeradd",{layer:a}),this;if(!this._map)return this._needsClustering.push(a),this.fire("layeradd",{layer:a}),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(a,this._maxZoom),this.fire("layeradd",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var o=a,l=this._zoom;if(a.__parent)for(;o.__parent._zoom>=l;)o=o.__parent;return this._currentShownBounds.contains(o.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,o):this._animationAddLayerNonAnimated(a,o)),this},removeLayer:function(a){return a instanceof L.LayerGroup?this.removeLayers([a]):a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this.fire("layerremove",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),a.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push({layer:a,latlng:a._latlng}),this.fire("layerremove",{layer:a}),this):(this._nonPointGroup.removeLayer(a),this.fire("layerremove",{layer:a}),this)},addLayers:function(a,o){if(!L.Util.isArray(a))return this.addLayer(a);var l=this._featureGroup,u=this._nonPointGroup,f=this.options.chunkedLoading,d=this.options.chunkInterval,m=this.options.chunkProgress,g=a.length,_=0,y=!0,v;if(this._map){var T=new Date().getTime(),k=L.bind(function(){var w=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();_<g;_++){if(f&&_%200===0){var P=new Date().getTime()-w;if(P>d)break}if(v=a[_],v instanceof L.LayerGroup){y&&(a=a.slice(),y=!1),this._extractNonGroupLayers(v,a),g=a.length;continue}if(!v.getLatLng){u.addLayer(v),o||this.fire("layeradd",{layer:v});continue}if(!this.hasLayer(v)&&(this._addLayer(v,this._maxZoom),o||this.fire("layeradd",{layer:v}),v.__parent&&v.__parent.getChildCount()===2)){var I=v.__parent.getAllChildMarkers(),M=I[0]===v?I[1]:I[0];l.removeLayer(M)}}m&&m(_,g,new Date().getTime()-T),_===g?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(k,this.options.chunkDelay)},this);k()}else for(var E=this._needsClustering;_<g;_++){if(v=a[_],v instanceof L.LayerGroup){y&&(a=a.slice(),y=!1),this._extractNonGroupLayers(v,a),g=a.length;continue}if(!v.getLatLng){u.addLayer(v);continue}this.hasLayer(v)||E.push(v)}return this},removeLayers:function(a){var o,l,u=a.length,f=this._featureGroup,d=this._nonPointGroup,m=!0;if(!this._map){for(o=0;o<u;o++){if(l=a[o],l instanceof L.LayerGroup){m&&(a=a.slice(),m=!1),this._extractNonGroupLayers(l,a),u=a.length;continue}this._arraySplice(this._needsClustering,l),d.removeLayer(l),this.hasLayer(l)&&this._needsRemoving.push({layer:l,latlng:l._latlng}),this.fire("layerremove",{layer:l})}return this}if(this._unspiderfy){this._unspiderfy();var g=a.slice(),_=u;for(o=0;o<_;o++){if(l=g[o],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,g),_=g.length;continue}this._unspiderfyLayer(l)}}for(o=0;o<u;o++){if(l=a[o],l instanceof L.LayerGroup){m&&(a=a.slice(),m=!1),this._extractNonGroupLayers(l,a),u=a.length;continue}if(!l.__parent){d.removeLayer(l),this.fire("layerremove",{layer:l});continue}this._removeLayer(l,!0,!0),this.fire("layerremove",{layer:l}),f.hasLayer(l)&&(f.removeLayer(l),l.clusterShow&&l.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){a.off(this._childMarkerEventHandlers,this),delete a.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new L.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var o=this._needsClustering.length-1;o>=0;o--)a.extend(this._needsClustering[o].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,o){var l=this._needsClustering.slice(),u=this._needsRemoving,f,d,m;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(l),d=l.length-1;d>=0;d--){for(f=!0,m=u.length-1;m>=0;m--)if(u[m].layer===l[d]){f=!1;break}f&&a.call(o,l[d])}this._nonPointGroup.eachLayer(a,o)},getLayers:function(){var a=[];return this.eachLayer(function(o){a.push(o)}),a},getLayer:function(a){var o=null;return a=parseInt(a,10),this.eachLayer(function(l){L.stamp(l)===a&&(o=l)}),o},hasLayer:function(a){if(!a)return!1;var o,l=this._needsClustering;for(o=l.length-1;o>=0;o--)if(l[o]===a)return!0;for(l=this._needsRemoving,o=l.length-1;o>=0;o--)if(l[o].layer===a)return!1;return!!(a.__parent&&a.__parent._group===this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,o){var l=this._map;typeof o!="function"&&(o=function(){});var u=function(){(l.hasLayer(a)||l.hasLayer(a.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),l.hasLayer(a)?o():a.__parent._icon&&(this.once("spiderfied",o,this),a.__parent.spiderfy()))};a._icon&&this._map.getBounds().contains(a.getLatLng())?o():a.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(a.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var o,l,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(a),this._nonPointGroup.addTo(a),this._gridClusters||this._generateInitialClusters(),this._maxLat=a.options.crs.projection.MAX_LATITUDE,o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),l=this._needsClustering,this._needsClustering=[],this.addLayers(l,!0)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(a){for(var o=a;o&&!o._icon;)o=o.__parent;return o||null},_arraySplice:function(a,o){for(var l=a.length-1;l>=0;l--)if(a[l]===o)return a.splice(l,1),!0},_removeFromGridUnclustered:function(a,o){for(var l=this._map,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());o>=f&&u[o].removeObject(a,l.project(a.getLatLng(),o));o--);},_childMarkerDragStart:function(a){a.target.__dragStart=a.target._latlng},_childMarkerMoved:function(a){if(!this._ignoreMove&&!a.target.__dragStart){var o=a.target._popup&&a.target._popup.isOpen();this._moveChild(a.target,a.oldLatLng,a.latlng),o&&a.target.openPopup()}},_moveChild:function(a,o,l){a._latlng=o,this.removeLayer(a),a._latlng=l,this.addLayer(a)},_childMarkerDragEnd:function(a){var o=a.target.__dragStart;delete a.target.__dragStart,o&&this._moveChild(a.target,o,a.target._latlng)},_removeLayer:function(a,o,l){var u=this._gridClusters,f=this._gridUnclustered,d=this._featureGroup,m=this._map,g=Math.floor(this._map.getMinZoom());o&&this._removeFromGridUnclustered(a,this._maxZoom);var _=a.__parent,y=_._markers,v;for(this._arraySplice(y,a);_&&(_._childCount--,_._boundsNeedUpdate=!0,!(_._zoom<g));)o&&_._childCount<=1?(v=_._markers[0]===a?_._markers[1]:_._markers[0],u[_._zoom].removeObject(_,m.project(_._cLatLng,_._zoom)),f[_._zoom].addObject(v,m.project(v.getLatLng(),_._zoom)),this._arraySplice(_.__parent._childClusters,_),_.__parent._markers.push(v),v.__parent=_.__parent,_._icon&&(d.removeLayer(_),l||d.addLayer(v))):_._iconNeedsUpdate=!0,_=_.__parent;delete a.__parent},_isOrIsParent:function(a,o){for(;o;){if(a===o)return!0;o=o.parentNode}return!1},fire:function(a,o,l){if(o&&o.layer instanceof L.MarkerCluster){if(o.originalEvent&&this._isOrIsParent(o.layer._icon,o.originalEvent.relatedTarget))return;a="cluster"+a}L.FeatureGroup.prototype.fire.call(this,a,o,l)},listens:function(a,o){return L.FeatureGroup.prototype.listens.call(this,a,o)||L.FeatureGroup.prototype.listens.call(this,"cluster"+a,o)},_defaultIconCreateFunction:function(a){var o=a.getChildCount(),l=" marker-cluster-";return o<10?l+="small":o<100?l+="medium":l+="large",new L.DivIcon({html:"<div><span>"+o+"</span></div>",className:"marker-cluster"+l,iconSize:new L.Point(40,40)})},_bindEvents:function(){var a=this._map,o=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(o||u||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){var o=a.layer,l=o;if(!(a.type==="clusterkeypress"&&a.originalEvent&&a.originalEvent.keyCode!==13)){for(;l._childClusters.length===1;)l=l._childClusters[0];l._zoom===this._maxZoom&&l._childCount===o._childCount&&this.options.spiderfyOnMaxZoom?o.spiderfy():this.options.zoomToBoundsOnClick&&o.zoomToBounds(),this.options.spiderfyOnEveryZoom&&o.spiderfy(),a.originalEvent&&a.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(a){var o=this._map;this._inZoomAnimation||(this._shownPolygon&&o.removeLayer(this._shownPolygon),a.layer.getChildCount()>2&&a.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),o.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,f=this._map;(a||l||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a),this._currentShownBounds=a}},_generateInitialClusters:function(){var a=Math.ceil(this._map.getMaxZoom()),o=Math.floor(this._map.getMinZoom()),l=this.options.maxClusterRadius,u=l;typeof l!="function"&&(u=function(){return l}),this.options.disableClusteringAtZoom!==null&&(a=this.options.disableClusteringAtZoom-1),this._maxZoom=a,this._gridClusters={},this._gridUnclustered={};for(var f=a;f>=o;f--)this._gridClusters[f]=new L.DistanceGrid(u(f)),this._gridUnclustered[f]=new L.DistanceGrid(u(f));this._topClusterLevel=new this._markerCluster(this,o-1)},_addLayer:function(a,o){var l=this._gridClusters,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),d,m;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(a),a.on(this._childMarkerEventHandlers,this);o>=f;o--){d=this._map.project(a.getLatLng(),o);var g=l[o].getNearObject(d);if(g){g._addChild(a),a.__parent=g;return}if(g=u[o].getNearObject(d),g){var _=g.__parent;_&&this._removeLayer(g,!1);var y=new this._markerCluster(this,o,g,a);l[o].addObject(y,this._map.project(y._cLatLng,o)),g.__parent=y,a.__parent=y;var v=y;for(m=o-1;m>_._zoom;m--)v=new this._markerCluster(this,m,v),l[m].addObject(v,this._map.project(g.getLatLng(),m));_._addChild(v),this._removeFromGridUnclustered(g,o);return}u[o].addObject(a,d)}this._topClusterLevel._addChild(a),a.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof L.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue(),this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(a){var o=this._maxLat;return o!==void 0&&(a.getNorth()>=o&&(a._northEast.lat=1/0),a.getSouth()<=-o&&(a._southWest.lat=-1/0)),a},_animationAddLayerNonAnimated:function(a,o){if(o===a)this._featureGroup.addLayer(a);else if(o._childCount===2){o._addToMap();var l=o.getAllChildMarkers();this._featureGroup.removeLayer(l[0]),this._featureGroup.removeLayer(l[1])}else o._updateIcon()},_extractNonGroupLayers:function(a,o){var l=a.getLayers(),u=0,f;for(o=o||[];u<l.length;u++){if(f=l[u],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,o);continue}o.push(f)}return o},_overrideMarkerIcon:function(a){var o=a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}});return o}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(a,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(a,o){this._animationAddLayerNonAnimated(a,o)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(a,o){var l=this._getExpandedVisibleBounds(),u=this._featureGroup,f=Math.floor(this._map.getMinZoom()),d;this._ignoreMove=!0,this._topClusterLevel._recursively(l,a,f,function(m){var g=m._latlng,_=m._markers,y;for(l.contains(g)||(g=null),m._isSingleParent()&&a+1===o?(u.removeLayer(m),m._recursivelyAddChildrenToMap(null,o,l)):(m.clusterHide(),m._recursivelyAddChildrenToMap(g,o,l)),d=_.length-1;d>=0;d--)y=_[d],l.contains(y._latlng)||u.removeLayer(y)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(l,o),u.eachLayer(function(m){!(m instanceof L.MarkerCluster)&&m._icon&&m.clusterShow()}),this._topClusterLevel._recursively(l,a,o,function(m){m._recursivelyRestoreChildPositions(o)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(l,a,f,function(m){u.removeLayer(m),m.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(a,o){this._animationZoomOutSingle(this._topClusterLevel,a-1,o),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,o){var l=this,u=this._featureGroup;u.addLayer(a),o!==a&&(o._childCount>2?(o._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(o.getLatLng())),a.clusterHide(),this._enqueue(function(){u.removeLayer(a),a.clusterShow(),l._animationEnd()})):(this._forceLayout(),l._animationStart(),l._animationZoomOutSingle(o,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(a,o,l){var u=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());a._recursivelyAnimateChildrenInAndAddSelfToMap(u,f,o+1,l);var d=this;this._forceLayout(),a._recursivelyBecomeVisible(u,l),this._enqueue(function(){if(a._childCount===1){var m=a._markers[0];this._ignoreMove=!0,m.setLatLng(m.getLatLng()),this._ignoreMove=!1,m.clusterShow&&m.clusterShow()}else a._recursively(u,l,f,function(g){g._recursivelyRemoveChildrenFromMap(u,f,o+1)});d._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(a){return new L.MarkerClusterGroup(a)};var i=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(a,o,l,u){L.Marker.prototype.initialize.call(this,l?l._cLatLng||l.getLatLng():new L.LatLng(0,0),{icon:this,pane:a.options.clusterPane}),this._group=a,this._zoom=o,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,l&&this._addChild(l),u&&this._addChild(u)},getAllChildMarkers:function(a,o){a=a||[];for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l].getAllChildMarkers(a,o);for(var u=this._markers.length-1;u>=0;u--)o&&this._markers[u].__dragStart||a.push(this._markers[u]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(a){for(var o=this._childClusters.slice(),l=this._group._map,u=l.getBoundsZoom(this._bounds),f=this._zoom+1,d=l.getZoom(),m;o.length>0&&u>f;){f++;var g=[];for(m=0;m<o.length;m++)g=g.concat(o[m]._childClusters);o=g}u>f?this._group._map.setView(this._latlng,f):u<=d?this._group._map.setView(this._latlng,d+1):this._group._map.fitBounds(this._bounds,a)},getBounds:function(){var a=new L.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,o){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(a),a instanceof L.MarkerCluster?(o||(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(o||this._markers.push(a),this._childCount++),this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=1/0,a._southWest.lng=1/0),a._northEast&&(a._northEast.lat=-1/0,a._northEast.lng=-1/0)},_recalculateBounds:function(){var a=this._markers,o=this._childClusters,l=0,u=0,f=this._childCount,d,m,g,_;if(f!==0){for(this._resetBounds(),d=0;d<a.length;d++)g=a[d]._latlng,this._bounds.extend(g),l+=g.lat,u+=g.lng;for(d=0;d<o.length;d++)m=o[d],m._boundsNeedUpdate&&m._recalculateBounds(),this._bounds.extend(m._bounds),g=m._wLatLng,_=m._childCount,l+=g.lat*_,u+=g.lng*_;this._latlng=this._wLatLng=new L.LatLng(l/f,u/f),this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,o,l){this._recursively(a,this._group._map.getMinZoom(),l-1,function(u){var f=u._markers,d,m;for(d=f.length-1;d>=0;d--)m=f[d],m._icon&&(m._setPos(o),m.clusterHide())},function(u){var f=u._childClusters,d,m;for(d=f.length-1;d>=0;d--)m=f[d],m._icon&&(m._setPos(o),m.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,o,l,u){this._recursively(a,u,o,function(f){f._recursivelyAnimateChildrenIn(a,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),l),f._isSingleParent()&&l-1===u?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(a,o,l)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(a,o){this._recursively(a,this._group._map.getMinZoom(),o,null,function(l){l.clusterShow()})},_recursivelyAddChildrenToMap:function(a,o,l){this._recursively(l,this._group._map.getMinZoom()-1,o,function(u){if(o!==u._zoom)for(var f=u._markers.length-1;f>=0;f--){var d=u._markers[f];l.contains(d._latlng)&&(a&&(d._backupLatlng=d.getLatLng(),d.setLatLng(a),d.clusterHide&&d.clusterHide()),u._group._featureGroup.addLayer(d))}},function(u){u._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var o=this._markers.length-1;o>=0;o--){var l=this._markers[o];l._backupLatlng&&(l.setLatLng(l._backupLatlng),delete l._backupLatlng)}if(a-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,o,l,u){var f,d;this._recursively(a,o-1,l-1,function(m){for(d=m._markers.length-1;d>=0;d--)f=m._markers[d],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(m){for(d=m._childClusters.length-1;d>=0;d--)f=m._childClusters[d],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(a,o,l,u,f){var d=this._childClusters,m=this._zoom,g,_;if(o<=m&&(u&&u(this),f&&m===l&&f(this)),m<o||m<l)for(g=d.length-1;g>=0;g--)_=d[g],_._boundsNeedUpdate&&_._recalculateBounds(),a.intersects(_._bounds)&&_._recursively(a,o,l,u,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var a=this.options.opacity;return this.setOpacity(0),this.options.opacity=a,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(a){this._cellSize=a,this._sqCellSize=a*a,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(a,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,d=f[u]=f[u]||{},m=d[l]=d[l]||[],g=L.Util.stamp(a);this._objectPoint[g]=o,m.push(a)},updateObject:function(a,o){this.removeObject(a),this.addObject(a,o)},removeObject:function(a,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,d=f[u]=f[u]||{},m=d[l]=d[l]||[],g,_;for(delete this._objectPoint[L.Util.stamp(a)],g=0,_=m.length;g<_;g++)if(m[g]===a)return m.splice(g,1),_===1&&delete d[l],!0},eachObject:function(a,o){var l,u,f,d,m,g,_,y=this._grid;for(l in y){m=y[l];for(u in m)for(g=m[u],f=0,d=g.length;f<d;f++)_=a.call(o,g[f]),_&&(f--,d--)}},getNearObject:function(a){var o=this._getCoord(a.x),l=this._getCoord(a.y),u,f,d,m,g,_,y,v,T=this._objectPoint,k=this._sqCellSize,E=null;for(u=l-1;u<=l+1;u++)if(m=this._grid[u],m){for(f=o-1;f<=o+1;f++)if(g=m[f],g)for(d=0,_=g.length;d<_;d++)y=g[d],v=this._sqDist(T[L.Util.stamp(y)],a),(v<k||v<=k&&E===null)&&(k=v,E=y)}return E},_getCoord:function(a){var o=Math.floor(a/this._cellSize);return isFinite(o)?o:a},_sqDist:function(a,o){var l=o.x-a.x,u=o.y-a.y;return l*l+u*u}},function(){L.QuickHull={getDistant:function(a,o){var l=o[1].lat-o[0].lat,u=o[0].lng-o[1].lng;return u*(a.lat-o[0].lat)+l*(a.lng-o[0].lng)},findMostDistantPointFromBaseLine:function(a,o){var l=0,u=null,f=[],d,m,g;for(d=o.length-1;d>=0;d--){if(m=o[d],g=this.getDistant(m,a),g>0)f.push(m);else continue;g>l&&(l=g,u=m)}return{maxPoint:u,newPoints:f}},buildConvexHull:function(a,o){var l=[],u=this.findMostDistantPointFromBaseLine(a,o);return u.maxPoint?(l=l.concat(this.buildConvexHull([a[0],u.maxPoint],u.newPoints)),l=l.concat(this.buildConvexHull([u.maxPoint,a[1]],u.newPoints)),l):[a[0]]},getConvexHull:function(a){var o=!1,l=!1,u=!1,f=!1,d=null,m=null,g=null,_=null,y=null,v=null,T;for(T=a.length-1;T>=0;T--){var k=a[T];(o===!1||k.lat>o)&&(d=k,o=k.lat),(l===!1||k.lat<l)&&(m=k,l=k.lat),(u===!1||k.lng>u)&&(g=k,u=k.lng),(f===!1||k.lng<f)&&(_=k,f=k.lng)}l!==o?(v=m,y=d):(v=_,y=g);var E=[].concat(this.buildConvexHull([v,y],a),this.buildConvexHull([y,v],a));return E}}}(),L.MarkerCluster.include({getConvexHull:function(){var a=this.getAllChildMarkers(),o=[],l,u;for(u=a.length-1;u>=0;u--)l=a[u].getLatLng(),o.push(l);return L.QuickHull.getConvexHull(o)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var a=this.getAllChildMarkers(null,!0),o=this._group,l=o._map,u=l.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(a.length,u):a.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(a.length,u):(u.y+=10,f=this._generatePointsCircle(a.length,u)),this._animationSpiderfy(a,f)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,o){var l=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a),u=l/this._2PI,f=this._2PI/a,d=[],m,g;for(u=Math.max(u,35),d.length=a,m=0;m<a;m++)g=this._circleStartAngle+m*f,d[m]=new L.Point(o.x+u*Math.cos(g),o.y+u*Math.sin(g))._round();return d},_generatePointsSpiral:function(a,o){var l=this._group.options.spiderfyDistanceMultiplier,u=l*this._spiralLengthStart,f=l*this._spiralFootSeparation,d=l*this._spiralLengthFactor*this._2PI,m=0,g=[],_;for(g.length=a,_=a;_>=0;_--)_<a&&(g[_]=new L.Point(o.x+u*Math.cos(m),o.y+u*Math.sin(m))._round()),m+=f/u+_*5e-4,u+=d/m;return g},_noanimationUnspiderfy:function(){var a=this._group,o=a._map,l=a._featureGroup,u=this.getAllChildMarkers(null,!0),f,d;for(a._ignoreMove=!0,this.setOpacity(1),d=u.length-1;d>=0;d--)f=u[d],l.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(o.removeLayer(f._spiderLeg),delete f._spiderLeg);a.fire("unspiderfied",{cluster:this,markers:u}),a._ignoreMove=!1,a._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(a,o){var l=this._group,u=l._map,f=l._featureGroup,d=this._group.options.spiderLegPolylineOptions,m,g,_,y;for(l._ignoreMove=!0,m=0;m<a.length;m++)y=u.layerPointToLatLng(o[m]),g=a[m],_=new L.Polyline([this._latlng,y],d),u.addLayer(_),g._spiderLeg=_,g._preSpiderfyLatlng=g._latlng,g.setLatLng(y),g.setZIndexOffset&&g.setZIndexOffset(1e6),f.addLayer(g);this.setOpacity(.3),l._ignoreMove=!1,l.fire("spiderfied",{cluster:this,markers:a})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(a,o){var l=this,u=this._group,f=u._map,d=u._featureGroup,m=this._latlng,g=f.latLngToLayerPoint(m),_=L.Path.SVG,y=L.extend({},this._group.options.spiderLegPolylineOptions),v=y.opacity,T,k,E,w,P,I;for(v===void 0&&(v=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),_?(y.opacity=0,y.className=(y.className||"")+" leaflet-cluster-spider-leg"):y.opacity=v,u._ignoreMove=!0,T=0;T<a.length;T++)k=a[T],I=f.layerPointToLatLng(o[T]),E=new L.Polyline([m,I],y),f.addLayer(E),k._spiderLeg=E,_&&(w=E._path,P=w.getTotalLength()+.1,w.style.strokeDasharray=P,w.style.strokeDashoffset=P),k.setZIndexOffset&&k.setZIndexOffset(1e6),k.clusterHide&&k.clusterHide(),d.addLayer(k),k._setPos&&k._setPos(g);for(u._forceLayout(),u._animationStart(),T=a.length-1;T>=0;T--)I=f.layerPointToLatLng(o[T]),k=a[T],k._preSpiderfyLatlng=k._latlng,k.setLatLng(I),k.clusterShow&&k.clusterShow(),_&&(E=k._spiderLeg,w=E._path,w.style.strokeDashoffset=0,E.setStyle({opacity:v}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:l,markers:a})},200)},_animationUnspiderfy:function(a){var o=this,l=this._group,u=l._map,f=l._featureGroup,d=a?u._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):u.latLngToLayerPoint(this._latlng),m=this.getAllChildMarkers(null,!0),g=L.Path.SVG,_,y,v,T,k,E;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),y=m.length-1;y>=0;y--)_=m[y],_._preSpiderfyLatlng&&(_.closePopup(),_.setLatLng(_._preSpiderfyLatlng),delete _._preSpiderfyLatlng,E=!0,_._setPos&&(_._setPos(d),E=!1),_.clusterHide&&(_.clusterHide(),E=!1),E&&f.removeLayer(_),g&&(v=_._spiderLeg,T=v._path,k=T.getTotalLength()+.1,T.style.strokeDashoffset=k,v.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var w=0;for(y=m.length-1;y>=0;y--)_=m[y],_._spiderLeg&&w++;for(y=m.length-1;y>=0;y--)_=m[y],_._spiderLeg&&(_.clusterShow&&_.clusterShow(),_.setZIndexOffset&&_.setZIndexOffset(0),w>1&&f.removeLayer(_),u.removeLayer(_._spiderLeg),delete _._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:o,markers:m})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(a){return a?a instanceof L.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof L.LayerGroup?a=a._layers:a instanceof L.MarkerCluster?a=a.getAllChildMarkers():a instanceof L.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(a),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a),this},_flagParentsIconsNeedUpdate:function(a){var o,l;for(o in a)for(l=a[o].__parent;l;)l._iconNeedsUpdate=!0,l=l.__parent},_refreshSingleMarkerModeMarkers:function(a){var o,l;for(o in a)l=a[o],this.hasLayer(l)&&l.setIcon(this._overrideMarkerIcon(l))}}),L.Marker.include({refreshIconOptions:function(a,o){var l=this.options.icon;return L.setOptions(l,a),this.setIcon(l),o&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),r.MarkerClusterGroup=n,r.MarkerCluster=i,Object.defineProperty(r,"__esModule",{value:!0})})})(Mx,Mx.exports);const SO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",CO=Object.freeze(Object.defineProperty({__proto__:null,default:SO},Symbol.toStringTag,{value:"Module"})),AO=uf(CO),NO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",bO=Object.freeze(Object.defineProperty({__proto__:null,default:NO},Symbol.toStringTag,{value:"Module"})),LO=uf(bO),PO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",FO=Object.freeze(Object.defineProperty({__proto__:null,default:PO},Symbol.toStringTag,{value:"Module"})),OO=uf(FO);var $s=wa&&wa.__assign||function(){return $s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},$s.apply(this,arguments)},RO=wa&&wa.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r},MO=wa&&wa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qw,"__esModule",{value:!0});var gh=TO,am=MO(wi);delete am.default.Icon.Default.prototype._getIconUrl;am.default.Icon.Default.mergeOptions({iconRetinaUrl:AO.default,iconUrl:LO.default,shadowUrl:OO.default});function IO(e){var t={},r={};e.children;var n=RO(e,["children"]);return Object.entries(n).forEach(function(i){var a,o,l=i[0],u=i[1];l.startsWith("on")?r=$s($s({},r),(a={},a[l]=u,a)):t=$s($s({},t),(o={},o[l]=u,o))}),{clusterProps:t,clusterEvents:r}}function DO(e,t){var r=IO(e),n=r.clusterProps,i=r.clusterEvents,a=new am.default.MarkerClusterGroup(n);return Object.entries(i).forEach(function(o){var l=o[0],u=o[1],f="cluster".concat(l.substring(2).toLowerCase());a.on(f,u)}),(0,gh.createElementObject)(a,(0,gh.extendContext)(t,{layerContainer:a}))}var jO=function(e,t,r){},BO=(0,gh.createPathComponent)(DO,jO),zO=qw.default=BO;const on=$e.create({baseURL:xi,headers:{"Content-Type":"application/json",Accept:"application/json"}});on.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));on.interceptors.response.use(e=>e,e=>{if(e.response){if(e.response.status===401)localStorage.removeItem("token"),window.location.href="/login";else if(e.response.status===404)return console.error("Endpoint not found:",e.response.config.url),Promise.reject(new Error("Endpoint non trouv. Veuillez vrifier la configuration du serveur."))}return Promise.reject(e)});const UO=Ln.icon({iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),HO=Ln.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#22c55e">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),VO=Ln.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#ef4444">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),Ix=Ln.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#2563eb">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),WO=Ln.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),$O=Ln.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#ef4444" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),ZO=Ln.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#f97316" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),GO=Ln.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#22c55e" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),XO=`
  .custom-camera-icon {
    background: none;
    border: none;
  }
  .custom-camera-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-camera-icon:hover svg {
    transform: scale(1.1);
  }
  .custom-datacenter-icon {
    background: none;
    border: none;
  }
  .custom-datacenter-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-datacenter-icon:hover svg {
    transform: scale(1.1);
  }
  .leaflet-popup-content-wrapper {
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  .leaflet-popup-content {
    margin: 0;
    min-width: 300px;
    max-width: 500px;
  }
  .datacenter-popup-content {
    padding: 1rem;
    min-width: 300px;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    background: white;
    border-radius: 8px;
  }
`,Yw=document.createElement("style");Yw.innerText=XO;document.head.appendChild(Yw);const Dx=(e,t)=>{const r=Math.abs(e),n=Math.floor(r),i=Math.floor((r-n)*60),a=((r-n-i/60)*3600).toFixed(1),o=t?e>=0?"N":"S":e>=0?"E":"W";return`${n}${i}'${a}"${o}`},KO=({onClose:e,position:t,onSuccess:r,onError:n,onCamerasUpdate:i})=>{const[a,o]=N.useState({name:"",ip_address:"",location:`${Dx(t[0],!0)} ${Dx(t[1],!1)}`,latitude:t[0].toString(),longitude:t[1].toString()}),{isAuthenticated:l,token:u}=Kw(),f=N.useRef(null),[d,m]=N.useState(!1),g=async y=>{var v,T,k;if(y.preventDefault(),!l||!u){n("Veuillez vous connecter pour ajouter une camra");return}m(!0);try{if((await on.post("/cameras/cameras/",a,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}})).status===201){r("Camra ajoute avec succs");const w=await on.get("/cameras/cameras/",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});i(w.data.results||[]),e()}}catch(E){console.error("Error adding camera:",E),$e.isAxiosError(E)?((v=E.response)==null?void 0:v.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):n(((k=(T=E.response)==null?void 0:T.data)==null?void 0:k.error)||"Erreur lors de l'ajout de la camra"):n("Erreur lors de l'ajout de la camra")}finally{m(!1)}},_=async y=>{var k,E,w,P,I;if(!l||!u){n("Veuillez vous connecter pour importer des camras");return}const v=(k=y.target.files)==null?void 0:k[0];if(!v)return;if(!v.name.endsWith(".csv")){n("Le fichier doit tre au format CSV");return}m(!0);const T=new FormData;T.append("file",v);try{const M=await on.post("/cameras/cameras/upload_csv/",T,{headers:{Authorization:`Bearer ${u}`,Accept:"application/json","Content-Type":"multipart/form-data"}});if(M.status===200){r(`Import russi: ${M.data.created} cres, ${M.data.updated} mises  jour`);const b=await on.get("/cameras/cameras/",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});i(b.data.results||[]),e()}}catch(M){console.error("Error uploading CSV:",M),$e.isAxiosError(M)?((E=M.response)==null?void 0:E.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):((w=M.response)==null?void 0:w.status)===400?n(M.response.data.error||"Format de fichier invalide ou donnes manquantes"):n(((I=(P=M.response)==null?void 0:P.data)==null?void 0:I.error)||"Erreur lors de l'importation du fichier CSV"):n("Erreur lors de l'importation du fichier CSV")}finally{m(!1),f.current&&(f.current.value="")}};return p.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white p-4 rounded-t-lg shadow-lg z-50",children:p.jsxs("div",{className:"max-w-4xl mx-auto",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h3",{className:"text-lg font-semibold",children:"Ajouter une camra"}),p.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",disabled:d,children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom"}),p.jsx("input",{type:"text",value:a.name,onChange:y=>o({...a,name:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP"}),p.jsx("input",{type:"text",value:a.ip_address,onChange:y=>o({...a,ip_address:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Emplacement"}),p.jsx("input",{type:"text",value:a.location,onChange:y=>o({...a,location:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Format: Latitude, Longitude",disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude"}),p.jsx("input",{type:"text",value:a.latitude,onChange:y=>o({...a,latitude:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude"}),p.jsx("input",{type:"text",value:a.longitude,onChange:y=>o({...a,longitude:y.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0,disabled:d})]}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("input",{type:"file",ref:f,onChange:_,accept:".csv",className:"hidden",id:"csv-upload",disabled:d}),p.jsx("label",{htmlFor:"csv-upload",className:`px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 cursor-pointer ${d?"opacity-50 cursor-not-allowed":""}`,children:d?"Import en cours...":"Importer CSV"}),p.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:d,children:"Annuler"}),p.jsx("button",{type:"submit",className:`px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 ${d?"opacity-50 cursor-not-allowed":""}`,disabled:d,children:d?"Ajout en cours...":"Ajouter"})]})]})]})})},qO=({onMapClick:e})=>(vO({click:t=>{e(t.latlng.lat,t.latlng.lng)}}),null),YO=()=>{const[e,t]=N.useState(null),[r,n]=N.useState([]),[i,a]=N.useState([]),[o,l]=N.useState({}),[u,f]=N.useState({}),[d,m]=N.useState(!1),[g,_]=N.useState([0,0]),[y,v]=N.useState(null),[T,k]=N.useState(null),[E,w]=N.useState({}),[P,I]=N.useState({}),{isAuthenticated:M,token:b}=Kw(),U=N.useRef(null),[j,K]=N.useState(!1);N.useState(null);const[V,G]=N.useState("all"),[de,Se]=N.useState("all"),[ce,Y]=N.useState(""),[xe,re]=N.useState(!1),q=N.useRef(null),[ae,pe]=N.useState({}),O=le=>{pe(Pe=>({...Pe,[le]:!Pe[le]}))},J=async()=>{var le;try{const Pe=localStorage.getItem("token");if(!Pe){v("Token non trouv. Veuillez vous reconnecter.");return}const Fe=await on.get("/datacenters/",{headers:{Authorization:`Bearer ${Pe}`,"Content-Type":"application/json",Accept:"application/json"}});Fe.data.results&&a(Fe.data.results)}catch(Pe){console.error("Error fetching datacenters:",Pe),$e.isAxiosError(Pe)&&(((le=Pe.response)==null?void 0:le.status)===401?(v("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):v("Erreur lors du chargement des datacenters"))}},X=async le=>{var Pe;try{f(tt=>({...tt,[le]:!0}));const Fe=localStorage.getItem("token");if(!Fe){v("Token non trouv. Veuillez vous reconnecter.");return}const Ue=await on.get("/datacenters/hierarchy/",{headers:{Authorization:`Bearer ${Fe}`,"Content-Type":"application/json",Accept:"application/json"}});console.log("Hirarchie reue:",Ue.data);const nt=Ue.data.find(tt=>tt.id===le);nt?(console.log("Datacenter trouv:",nt),l(tt=>({...tt,[le]:nt.firewall_types}))):(console.log("Datacenter non trouv"),l(tt=>({...tt,[le]:[]})))}catch(Fe){console.error("Erreur lors de la rcupration des types de firewall:",Fe),$e.isAxiosError(Fe)&&(((Pe=Fe.response)==null?void 0:Pe.status)===401?(v("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):v("Erreur lors du chargement des types de firewall"))}finally{f(Fe=>({...Fe,[le]:!1}))}},W=le=>{v(le),q.current&&clearTimeout(q.current),q.current=window.setTimeout(()=>{window.location.reload()},3e3)};N.useEffect(()=>{const le=localStorage.getItem("token");if(!le){W("Veuillez vous connecter pour accder  cette page");return}return on.get(y1.CAMERAS.LIST,{headers:{Authorization:`Bearer ${le}`,"Content-Type":"application/json",Accept:"application/json"}}).then(()=>{re(!0)}).catch(Pe=>{var Fe;((Fe=Pe.response)==null?void 0:Fe.status)===401?(W("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):v("Erreur de connexion au serveur")}),()=>{q.current&&clearTimeout(q.current)}},[]),N.useEffect(()=>{xe&&(Ln.Marker.prototype.options.icon=UO,t(e))},[xe]),N.useEffect(()=>xe?((async()=>{var Pe;try{const Fe=localStorage.getItem("token");if(!Fe){v("Token non trouv. Veuillez vous reconnecter.");return}let Ue=[],nt=y1.CAMERAS.LIST;for(;nt;){const tt=await on.get(nt,{headers:{Authorization:`Bearer ${Fe}`,"Content-Type":"application/json",Accept:"application/json"}});tt.data.results&&(Ue=[...Ue,...tt.data.results]),nt=tt.data.next}n(Ue),v(null)}catch(Fe){console.error("Error fetching cameras:",Fe),$e.isAxiosError(Fe)&&((Pe=Fe.response)==null?void 0:Pe.status)===401?(v("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):v("Erreur lors du chargement des camras"),n([])}})(),J(),()=>{Ln.Marker.prototype.options.icon=void 0}):void 0,[xe]);const ie=(le,Pe)=>{if(!M||!b){W("Veuillez vous connecter pour ajouter une camra");return}_([le,Pe]),m(!0)},we=async le=>{try{w(Ue=>({...Ue,[le]:{status:"loading",responseTime:null}}));const Fe=await(await fetch(`${xi}/cameras/cameras/${le}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();w(Ue=>({...Ue,[le]:{status:Fe.status,responseTime:Fe.response_time,lastUpdate:Date.now()}}))}catch(Pe){console.error("Error pinging camera:",Pe),w(Fe=>({...Fe,[le]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},Le=async le=>{try{I(Ue=>({...Ue,[le]:{status:"loading",responseTime:null}}));const Fe=await(await fetch(`${xi}/firewalls/${le}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();I(Ue=>({...Ue,[le]:{status:Fe.status,responseTime:Fe.response_time,lastUpdate:Date.now()}}))}catch(Pe){console.error("Error pinging firewall:",Pe),I(Fe=>({...Fe,[le]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},Ae=async()=>{if(!M){v("Veuillez vous connecter pour effectuer un ping");return}K(!0);try{const le=await on.post("/cameras/cameras/ping_all/"),Pe={};le.data.results.forEach(Ve=>{Pe[Ve.id]={status:Ve.status,responseTime:Ve.response_time}}),w(Pe);const Fe=await on.post("/firewalls/ping-all/"),Ue={};Fe.data.results.forEach(Ve=>{Ue[Ve.id]={status:Ve.status,responseTime:Ve.response_time}}),I(Ue);const nt=Object.values(Pe).filter(Ve=>Ve.status==="online").length+Object.values(Ue).filter(Ve=>Ve.status==="online").length,tt=Object.values(Pe).filter(Ve=>Ve.status==="offline"||Ve.status==="error").length+Object.values(Ue).filter(Ve=>Ve.status==="offline"||Ve.status==="error").length;k(`Ping termin: ${nt} en ligne, ${tt} hors ligne`)}catch(le){console.error("Error pinging all elements:",le),v("Erreur lors du ping des lments")}finally{K(!1)}},_e=le=>{try{return decodeURIComponent(escape(le))}catch(Pe){return console.warn("Error fixing encoding:",Pe),le}},ze=le=>{if(!le)return!0;const Pe=5*60*1e3;return Date.now()-le>Pe},H=le=>{const Pe=E[le];if(!Pe||ze(Pe.lastUpdate))return Ix;switch(Pe.status){case"online":return HO;case"offline":return VO;default:return Ix}},Ye=()=>{const le=ce.toLowerCase(),Pe=r.filter(Ue=>{var Ve;if(!(V!=="datacenters"&&(Ue.name.toLowerCase().includes(le)||Ue.ip_address.toLowerCase().includes(le)||Ue.location.toLowerCase().includes(le))))return!1;if(de==="all")return!0;const tt=(Ve=E[Ue.id])==null?void 0:Ve.status;return de==="online"?tt==="online":de==="offline"?tt==="offline"||tt==="error":!0}),Fe=i.filter(Ue=>V!=="cameras"&&(Ue.name.toLowerCase().includes(le)||Ue.location.toLowerCase().includes(le))?de==="all"?!0:de==="online"?Ue.is_active:de==="offline"?!Ue.is_active:!0:!1);return{cameras:Pe,datacenters:Fe}},{cameras:rt,datacenters:et}=Ye(),Ge=le=>{var nt;let Pe=0,Fe=0,Ue=!1;return(nt=o[le])==null||nt.forEach(tt=>{var Ve;(Ve=tt.firewalls)==null||Ve.forEach(Ot=>{const bt=P[Ot.id];bt&&!ze(bt.lastUpdate)?(Pe++,bt.status==="online"&&Fe++):Ue=!0})}),Pe===0||Ue?WO:Fe===Pe?GO:Fe===0?$O:ZO},Ne=async le=>{var Pe,Fe,Ue;if(!M||!b){v("Veuillez vous connecter pour supprimer une camra");return}try{(await on.delete(`/cameras/cameras/${le}/`,{headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json",Accept:"application/json"}})).status===204&&(k("Camra supprime avec succs"),n(tt=>tt.filter(Ve=>Ve.id!==le)))}catch(nt){console.error("Error deleting camera:",nt),$e.isAxiosError(nt)?((Pe=nt.response)==null?void 0:Pe.status)===401?(v("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):v(((Ue=(Fe=nt.response)==null?void 0:Fe.data)==null?void 0:Ue.error)||"Erreur lors de la suppression de la camra"):v("Erreur lors de la suppression de la camra")}};return p.jsxs("div",{className:"w-[1270px] h-[550px] rounded-lg overflow-hidden shadow-lg relative",children:[p.jsxs("div",{className:"absolute top-4 right-4 z-[1000] bg-white rounded-lg shadow-lg p-4 space-y-4 w-80",children:[p.jsxs("div",{className:"flex space-x-2 mb-2",children:[p.jsx("button",{onClick:()=>G("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${V==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tout"}),p.jsx("button",{onClick:()=>G("cameras"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${V==="cameras"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Camras"}),p.jsx("button",{onClick:()=>G("datacenters"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${V==="datacenters"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Datacenters"})]}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"text",value:ce,onChange:le=>Y(le.target.value),placeholder:`Rechercher ${V==="all"?"des lments":V==="cameras"?"une camra":"un datacenter"}...`,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),ce&&p.jsx("button",{onClick:()=>Y(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]}),p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:()=>Se("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${de==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous"}),p.jsx("button",{onClick:()=>Se("online"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${de==="online"?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"En ligne"}),p.jsx("button",{onClick:()=>Se("offline"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${de==="offline"?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Hors ligne"})]}),p.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[p.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Statistiques"}),p.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"Camras:"}),p.jsx("span",{className:"font-semibold",children:rt.length})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"Datacenters:"}),p.jsx("span",{className:"font-semibold",children:et.length})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"En ligne:"}),p.jsx("span",{className:"text-green-500 font-semibold",children:Object.values(E).filter(le=>le.status==="online").length+Object.values(P).filter(le=>le.status==="online").length+et.filter(le=>le.is_active).length})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"Hors ligne:"}),p.jsx("span",{className:"text-red-500 font-semibold",children:Object.values(E).filter(le=>le.status==="offline"||le.status==="error").length+Object.values(P).filter(le=>le.status==="offline"||le.status==="error").length+et.filter(le=>!le.is_active).length})]})]})]}),p.jsx("button",{onClick:Ae,disabled:j,className:`w-full px-4 py-2 rounded-md text-white text-sm flex items-center justify-center gap-2 ${j?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:j?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Test en cours..."]}):p.jsxs(p.Fragment,{children:[p.jsx(V3,{className:"w-4 h-4"}),"Tester tous les lments"]})})]}),p.jsxs(wO,{center:[31.7917,-7.0926],zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,ref:U,children:[p.jsx(kO,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),p.jsx(qO,{onMapClick:ie}),e&&p.jsx(_O,{data:e,style:{color:"#2563eb",weight:2,fillOpacity:.1,fillColor:"#3b82f6"},onEachFeature:(le,Pe)=>{var Fe;Pe.bindPopup(`
                <div class="p-2">
                  <h3 class="font-semibold text-lg">${le.properties.ADMIN}</h3>
                  <p class="text-sm">Population: ${((Fe=le.properties.POP_EST)==null?void 0:Fe.toLocaleString())||"N/A"}</p>
                </div>
              `)}}),p.jsx(zO,{chunkedLoading:!0,maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:le=>Ln.divIcon({html:`<div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${le.getChildCount()}</div>`,className:"custom-cluster-icon",iconSize:Ln.point(32,32)}),children:rt.map(le=>{var Pe,Fe,Ue,nt,tt,Ve,Ot,bt;if(le.latitude&&le.longitude){const sr=parseFloat(le.latitude),Ct=parseFloat(le.longitude);if(!isNaN(sr)&&!isNaN(Ct))return p.jsx(Ox,{position:[sr,Ct],icon:H(le.id),riseOnHover:!0,children:p.jsx(Rx,{children:p.jsxs("div",{className:"p-2 min-w-[200px]",children:[p.jsx("h3",{className:"font-semibold text-lg",children:_e(le.name)}),p.jsxs("p",{className:"text-sm",children:["IP: ",le.ip_address]}),p.jsxs("p",{className:"text-sm",children:["Latitude: ",sr]}),p.jsxs("p",{className:"text-sm",children:["Longitude: ",Ct]}),p.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[p.jsxs("button",{onClick:$t=>{$t.preventDefault(),we(le.id)},className:`px-3 py-1 rounded-md text-white text-sm flex items-center gap-2 ${((Pe=E[le.id])==null?void 0:Pe.status)==="loading"?"bg-gray-400":((Fe=E[le.id])==null?void 0:Fe.status)==="online"?"bg-green-500":((Ue=E[le.id])==null?void 0:Ue.status)==="offline"?"bg-red-500":"bg-blue-500"}`,disabled:((nt=E[le.id])==null?void 0:nt.status)==="loading",children:[((tt=E[le.id])==null?void 0:tt.status)==="loading"?p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((Ve=E[le.id])==null?void 0:Ve.status)==="online"?p.jsx(C1,{className:"w-4 h-4"}):((Ot=E[le.id])==null?void 0:Ot.status)==="offline"?p.jsx(S1,{className:"w-4 h-4"}):"Ping",((bt=E[le.id])==null?void 0:bt.status)==="online"&&E[le.id].responseTime&&p.jsxs("span",{children:[Math.round(E[le.id].responseTime||0),"ms"]})]}),p.jsxs("button",{onClick:$t=>{$t.preventDefault(),window.confirm("tes-vous sr de vouloir supprimer cette camra ?")&&Ne(le.id)},className:"px-3 py-1 rounded-md text-white text-sm bg-red-500 hover:bg-red-600 flex items-center gap-2",children:[p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Supprimer"]})]})]})})},le.id)}return null})}),et.map(le=>le.latitude&&le.longitude?p.jsx(Ox,{position:[le.latitude,le.longitude],icon:Ge(le.id),riseOnHover:!0,eventHandlers:{click:()=>{o[le.id]||X(le.id)}},children:p.jsx(Rx,{children:p.jsxs("div",{className:"datacenter-popup-content",children:[p.jsxs("div",{className:"border-b border-gray-200 pb-3 mb-4",children:[p.jsxs("h3",{className:"font-semibold text-lg text-purple-700 flex items-center gap-2",children:[p.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.5L20 8v8l-8 4-8-4V8l8-3.5z",fill:"currentColor"})}),le.name]}),le.location&&p.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[p.jsx("span",{className:"font-medium",children:"Adresse:"})," ",le.location]}),p.jsx("div",{className:"mt-2",children:p.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${le.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:le.is_active?"Actif":"Inactif"})})]}),p.jsxs("div",{className:"mt-4",children:[p.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-3 flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),"Types de Firewall"]}),u[le.id]?p.jsxs("div",{className:"flex items-center justify-center py-4",children:[p.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-purple-500 border-t-transparent"}),p.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Chargement des firewalls..."})]}):o[le.id]?p.jsx("div",{className:"space-y-3",children:o[le.id].map(Pe=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[p.jsx("div",{className:"bg-purple-50 p-3 border-b border-purple-100 cursor-pointer hover:bg-purple-100 transition-colors",onClick:()=>O(Pe.id),children:p.jsxs("div",{className:"font-medium text-sm text-purple-700 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),Pe.name]}),p.jsx("svg",{className:`w-4 h-4 transform transition-transform ${ae[Pe.id]?"rotate-180":""}`,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M7 10l5 5 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),ae[Pe.id]&&p.jsx("div",{className:"p-3",children:Pe.firewalls&&Pe.firewalls.length>0?p.jsx("div",{className:"space-y-2",children:Pe.firewalls.map(Fe=>{var Ue,nt,tt,Ve,Ot,bt,sr,Ct;return p.jsx("div",{className:"bg-gray-50 rounded-md p-3 hover:bg-gray-100 transition-colors",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm",children:p.jsx("svg",{className:"w-4 h-4 text-purple-600",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:p.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})})}),p.jsxs("div",{children:[p.jsx("div",{className:"font-medium text-sm",children:Fe.name}),p.jsx("div",{className:"text-xs text-gray-500 mt-1",children:Fe.ip_address})]})]}),p.jsxs("button",{onClick:$t=>{$t.stopPropagation(),Le(Fe.id)},className:`px-3 py-1.5 rounded-md text-white text-sm flex items-center gap-2 transition-colors ${((Ue=P[Fe.id])==null?void 0:Ue.status)==="loading"?"bg-gray-400":((nt=P[Fe.id])==null?void 0:nt.status)==="online"?"bg-green-500 hover:bg-green-600":((tt=P[Fe.id])==null?void 0:tt.status)==="offline"?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600"}`,disabled:((Ve=P[Fe.id])==null?void 0:Ve.status)==="loading",children:[((Ot=P[Fe.id])==null?void 0:Ot.status)==="loading"?p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((bt=P[Fe.id])==null?void 0:bt.status)==="online"?p.jsx(C1,{className:"w-4 h-4"}):((sr=P[Fe.id])==null?void 0:sr.status)==="offline"?p.jsx(S1,{className:"w-4 h-4"}):"Ping",((Ct=P[Fe.id])==null?void 0:Ct.status)==="online"&&P[Fe.id].responseTime&&p.jsxs("span",{children:[Math.round(P[Fe.id].responseTime||0),"ms"]})]})]})},Fe.id)})}):p.jsx("div",{className:"text-sm text-gray-500 italic text-center py-2",children:"Aucun firewall associ"})})]},Pe.id))}):p.jsx("div",{className:"text-sm text-gray-500 text-center py-4",children:"Aucun type de firewall trouv"})]})]})})},`dc-${le.id}`):null)]}),d&&M&&b&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1000]",onClick:()=>m(!1)}),p.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-[1001]",children:p.jsx(KO,{onClose:()=>m(!1),position:g,onSuccess:le=>{k(le),setTimeout(()=>k(null),3e3)},onError:le=>{v(le),setTimeout(()=>v(null),3e3)},onCamerasUpdate:n})})]}),y&&p.jsxs("div",{className:"absolute top-4 left-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-[1002] flex items-center justify-between",children:[p.jsx("span",{children:y}),y.includes("connecter")&&p.jsx("button",{onClick:()=>window.location.reload(),className:"ml-4 px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Rafrachir"})]}),T&&p.jsx("div",{className:"absolute top-4 left-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded z-[1002]",children:T})]})};function JO(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jx(Object(r),!0).forEach(function(n){JO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QO(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function eR(e,t){if(e==null)return{};var r=QO(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tR(e,t){return rR(e)||nR(e,t)||iR(e,t)||aR()}function rR(e){if(Array.isArray(e))return e}function nR(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(u){i=!0,a=u}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return r}}function iR(e,t){if(e){if(typeof e=="string")return zx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zx(e,t)}}function zx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sR(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ux(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ux(Object(r),!0).forEach(function(n){sR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ux(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oR(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(i,a){return a(i)},n)}}function Qo(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.length>=e.length?e.apply(this,i):function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return t.apply(r,[].concat(i,l))}}}function cf(e){return{}.toString.call(e).includes("Object")}function lR(e){return!Object.keys(e).length}function $l(e){return typeof e=="function"}function cR(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function uR(e,t){return cf(t)||ya("changeType"),Object.keys(t).some(function(r){return!cR(e,r)})&&ya("changeField"),t}function fR(e){$l(e)||ya("selectorType")}function dR(e){$l(e)||cf(e)||ya("handlerType"),cf(e)&&Object.values(e).some(function(t){return!$l(t)})&&ya("handlersType")}function hR(e){e||ya("initialIsRequired"),cf(e)||ya("initialType"),lR(e)&&ya("initialContent")}function pR(e,t){throw new Error(e[t]||e.default)}var mR={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},ya=Qo(pR)(mR),tu={changes:uR,selector:fR,handler:dR,initial:hR};function gR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tu.initial(e),tu.handler(t);var r={current:e},n=Qo(_R)(r,t),i=Qo(vR)(r),a=Qo(tu.changes)(e),o=Qo(xR)(r);function l(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(d){return d};return tu.selector(f),f(r.current)}function u(f){oR(n,i,a,o)(f)}return[l,u]}function xR(e,t){return $l(t)?t(e.current):t}function vR(e,t){return e.current=Hx(Hx({},e.current),t),t}function _R(e,t,r){return $l(t)?t(e.current):Object.keys(r).forEach(function(n){var i;return(i=t[n])===null||i===void 0?void 0:i.call(t,e.current[n])}),r}var yR={create:gR},wR={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function kR(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.length>=e.length?e.apply(this,i):function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return t.apply(r,[].concat(i,l))}}}function ER(e){return{}.toString.call(e).includes("Object")}function TR(e){return e||Vx("configIsRequired"),ER(e)||Vx("configType"),e.urls?(SR(),{paths:{vs:e.urls.monacoBase}}):e}function SR(){console.warn(Jw.deprecation)}function CR(e,t){throw new Error(e[t]||e.default)}var Jw={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Vx=kR(CR)(Jw),AR={config:TR},NR=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(i){return r.reduceRight(function(a,o){return o(a)},i)}};function Qw(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],Qw(e[r],t[r]))}),Bx(Bx({},e),t)}var bR={type:"cancelation",msg:"operation is manually canceled"};function Q0(e){var t=!1,r=new Promise(function(n,i){e.then(function(a){return t?i(bR):n(a)}),e.catch(i)});return r.cancel=function(){return t=!0},r}var LR=yR.create({config:wR,isInitialized:!1,resolve:null,reject:null,monaco:null}),ek=tR(LR,2),uc=ek[0],zf=ek[1];function PR(e){var t=AR.config(e),r=t.monaco,n=eR(t,["monaco"]);zf(function(i){return{config:Qw(i.config,n),monaco:r}})}function FR(){var e=uc(function(t){var r=t.monaco,n=t.isInitialized,i=t.resolve;return{monaco:r,isInitialized:n,resolve:i}});if(!e.isInitialized){if(zf({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),Q0(ed);if(window.monaco&&window.monaco.editor)return tk(window.monaco),e.resolve(window.monaco),Q0(ed);NR(OR,MR)(IR)}return Q0(ed)}function OR(e){return document.body.appendChild(e)}function RR(e){var t=document.createElement("script");return e&&(t.src=e),t}function MR(e){var t=uc(function(n){var i=n.config,a=n.reject;return{config:i,reject:a}}),r=RR("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function IR(){var e=uc(function(r){var n=r.config,i=r.resolve,a=r.reject;return{config:n,resolve:i,reject:a}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){tk(r),e.resolve(r)},function(r){e.reject(r)})}function tk(e){uc().monaco||zf({monaco:e})}function DR(){return uc(function(e){var t=e.monaco;return t})}var ed=new Promise(function(e,t){return zf({resolve:e,reject:t})}),sm={config:PR,init:FR,__getMonacoInstance:DR},jR={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},td=jR,BR={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},zR=BR;function UR({children:e}){return Kn.createElement("div",{style:zR.container},e)}var HR=UR,VR=HR;function WR({width:e,height:t,isEditorReady:r,loading:n,_ref:i,className:a,wrapperProps:o}){return Kn.createElement("section",{style:{...td.wrapper,width:e,height:t},...o},!r&&Kn.createElement(VR,null,n),Kn.createElement("div",{ref:i,style:{...td.fullWidth,...!r&&td.hide},className:a}))}var $R=WR,rk=N.memo($R);function ZR(e){N.useEffect(e,[])}var nk=ZR;function GR(e,t,r=!0){let n=N.useRef(!0);N.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var ln=GR;function vl(){}function Zs(e,t,r,n){return XR(e,n)||KR(e,t,r,n)}function XR(e,t){return e.editor.getModel(ik(e,t))}function KR(e,t,r,n){return e.editor.createModel(t,r,n?ik(e,n):void 0)}function ik(e,t){return e.Uri.parse(t)}function qR({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:i,originalModelPath:a,modifiedModelPath:o,keepCurrentOriginalModel:l=!1,keepCurrentModifiedModel:u=!1,theme:f="light",loading:d="Loading...",options:m={},height:g="100%",width:_="100%",className:y,wrapperProps:v={},beforeMount:T=vl,onMount:k=vl}){let[E,w]=N.useState(!1),[P,I]=N.useState(!0),M=N.useRef(null),b=N.useRef(null),U=N.useRef(null),j=N.useRef(k),K=N.useRef(T),V=N.useRef(!1);nk(()=>{let ce=sm.init();return ce.then(Y=>(b.current=Y)&&I(!1)).catch(Y=>(Y==null?void 0:Y.type)!=="cancelation"&&console.error("Monaco initialization: error:",Y)),()=>M.current?Se():ce.cancel()}),ln(()=>{if(M.current&&b.current){let ce=M.current.getOriginalEditor(),Y=Zs(b.current,e||"",n||r||"text",a||"");Y!==ce.getModel()&&ce.setModel(Y)}},[a],E),ln(()=>{if(M.current&&b.current){let ce=M.current.getModifiedEditor(),Y=Zs(b.current,t||"",i||r||"text",o||"");Y!==ce.getModel()&&ce.setModel(Y)}},[o],E),ln(()=>{let ce=M.current.getModifiedEditor();ce.getOption(b.current.editor.EditorOption.readOnly)?ce.setValue(t||""):t!==ce.getValue()&&(ce.executeEdits("",[{range:ce.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),ce.pushUndoStop())},[t],E),ln(()=>{var ce,Y;(Y=(ce=M.current)==null?void 0:ce.getModel())==null||Y.original.setValue(e||"")},[e],E),ln(()=>{let{original:ce,modified:Y}=M.current.getModel();b.current.editor.setModelLanguage(ce,n||r||"text"),b.current.editor.setModelLanguage(Y,i||r||"text")},[r,n,i],E),ln(()=>{var ce;(ce=b.current)==null||ce.editor.setTheme(f)},[f],E),ln(()=>{var ce;(ce=M.current)==null||ce.updateOptions(m)},[m],E);let G=N.useCallback(()=>{var xe;if(!b.current)return;K.current(b.current);let ce=Zs(b.current,e||"",n||r||"text",a||""),Y=Zs(b.current,t||"",i||r||"text",o||"");(xe=M.current)==null||xe.setModel({original:ce,modified:Y})},[r,t,i,e,n,a,o]),de=N.useCallback(()=>{var ce;!V.current&&U.current&&(M.current=b.current.editor.createDiffEditor(U.current,{automaticLayout:!0,...m}),G(),(ce=b.current)==null||ce.editor.setTheme(f),w(!0),V.current=!0)},[m,f,G]);N.useEffect(()=>{E&&j.current(M.current,b.current)},[E]),N.useEffect(()=>{!P&&!E&&de()},[P,E,de]);function Se(){var Y,xe,re,q;let ce=(Y=M.current)==null?void 0:Y.getModel();l||((xe=ce==null?void 0:ce.original)==null||xe.dispose()),u||((re=ce==null?void 0:ce.modified)==null||re.dispose()),(q=M.current)==null||q.dispose()}return Kn.createElement(rk,{width:_,height:g,isEditorReady:E,loading:d,_ref:U,className:y,wrapperProps:v})}var YR=qR;N.memo(YR);function JR(e){let t=N.useRef();return N.useEffect(()=>{t.current=e},[e]),t.current}var QR=JR,ru=new Map;function eM({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:i,path:a,theme:o="light",line:l,loading:u="Loading...",options:f={},overrideServices:d={},saveViewState:m=!0,keepCurrentModel:g=!1,width:_="100%",height:y="100%",className:v,wrapperProps:T={},beforeMount:k=vl,onMount:E=vl,onChange:w,onValidate:P=vl}){let[I,M]=N.useState(!1),[b,U]=N.useState(!0),j=N.useRef(null),K=N.useRef(null),V=N.useRef(null),G=N.useRef(E),de=N.useRef(k),Se=N.useRef(),ce=N.useRef(n),Y=QR(a),xe=N.useRef(!1),re=N.useRef(!1);nk(()=>{let pe=sm.init();return pe.then(O=>(j.current=O)&&U(!1)).catch(O=>(O==null?void 0:O.type)!=="cancelation"&&console.error("Monaco initialization: error:",O)),()=>K.current?ae():pe.cancel()}),ln(()=>{var O,J,X,W;let pe=Zs(j.current,e||n||"",t||i||"",a||r||"");pe!==((O=K.current)==null?void 0:O.getModel())&&(m&&ru.set(Y,(J=K.current)==null?void 0:J.saveViewState()),(X=K.current)==null||X.setModel(pe),m&&((W=K.current)==null||W.restoreViewState(ru.get(a))))},[a],I),ln(()=>{var pe;(pe=K.current)==null||pe.updateOptions(f)},[f],I),ln(()=>{!K.current||n===void 0||(K.current.getOption(j.current.editor.EditorOption.readOnly)?K.current.setValue(n):n!==K.current.getValue()&&(re.current=!0,K.current.executeEdits("",[{range:K.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),K.current.pushUndoStop(),re.current=!1))},[n],I),ln(()=>{var O,J;let pe=(O=K.current)==null?void 0:O.getModel();pe&&i&&((J=j.current)==null||J.editor.setModelLanguage(pe,i))},[i],I),ln(()=>{var pe;l!==void 0&&((pe=K.current)==null||pe.revealLine(l))},[l],I),ln(()=>{var pe;(pe=j.current)==null||pe.editor.setTheme(o)},[o],I);let q=N.useCallback(()=>{var pe;if(!(!V.current||!j.current)&&!xe.current){de.current(j.current);let O=a||r,J=Zs(j.current,n||e||"",t||i||"",O||"");K.current=(pe=j.current)==null?void 0:pe.editor.create(V.current,{model:J,automaticLayout:!0,...f},d),m&&K.current.restoreViewState(ru.get(O)),j.current.editor.setTheme(o),l!==void 0&&K.current.revealLine(l),M(!0),xe.current=!0}},[e,t,r,n,i,a,f,d,m,o,l]);N.useEffect(()=>{I&&G.current(K.current,j.current)},[I]),N.useEffect(()=>{!b&&!I&&q()},[b,I,q]),ce.current=n,N.useEffect(()=>{var pe,O;I&&w&&((pe=Se.current)==null||pe.dispose(),Se.current=(O=K.current)==null?void 0:O.onDidChangeModelContent(J=>{re.current||w(K.current.getValue(),J)}))},[I,w]),N.useEffect(()=>{if(I){let pe=j.current.editor.onDidChangeMarkers(O=>{var X;let J=(X=K.current.getModel())==null?void 0:X.uri;if(J&&O.find(W=>W.path===J.path)){let W=j.current.editor.getModelMarkers({resource:J});P==null||P(W)}});return()=>{pe==null||pe.dispose()}}return()=>{}},[I,P]);function ae(){var pe,O;(pe=Se.current)==null||pe.dispose(),g?m&&ru.set(a,K.current.saveViewState()):(O=K.current.getModel())==null||O.dispose(),K.current.dispose()}return Kn.createElement(rk,{width:_,height:y,isEditorReady:I,loading:u,_ref:V,className:v,wrapperProps:T})}var tM=eM,rM=N.memo(tM),nM=rM;sm.config({paths:{vs:"/static/vs"}});window.MonacoEnvironment={getWorkerUrl:function(e,t){const r="/static/vs/",n={json:"language/json/json.worker.js",css:"language/css/css.worker.js",scss:"language/css/css.worker.js",less:"language/css/css.worker.js",html:"language/html/html.worker.js",handlebars:"language/html/html.worker.js",razor:"language/html/html.worker.js",typescript:"language/typescript/ts.worker.js",javascript:"language/typescript/ts.worker.js",editor:"editor/editor.worker.js"},i=n[t]||n.editor;return`${r}${i}`}};function rd(){const{id:e}=c4(),t=Gi(),[r,n]=N.useState(""),[i,a]=N.useState(""),[o,l]=N.useState([]),[u,f]=N.useState([]),[d,m]=N.useState({name:"",description:""}),[g,_]=N.useState(null),[y,v]=N.useState(!1),[T,k]=N.useState(null),E=N.useRef(null),[w,P]=N.useState(!1),I=async()=>{try{const Y=await Ls.getVariables();if(Array.isArray(Y)){const xe=Y.sort((re,q)=>re.name.localeCompare(q.name));l(xe)}else l([])}catch{k("Erreur lors du chargement des variables"),l([])}},M=async()=>{try{v(!0);const Y=await bs.getTemplates();Array.isArray(Y)?f(Y):f([])}catch{k("Erreur lors du chargement des templates"),f([])}finally{v(!1)}};N.useEffect(()=>{e&&b(e),I(),M()},[e]);const b=async Y=>{try{v(!0);const xe=await bs.getTemplate(parseInt(Y)),re=await Ls.getVariables();a(xe.name),n(xe.content),l(re)}catch{k("Erreur lors du chargement du template")}finally{v(!1)}},U=(Y,xe)=>{E.current=Y,P(!0),Y.updateOptions({minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0,theme:"vs-dark"}),xe.languages.register({id:"template"}),xe.languages.setMonarchTokensProvider("template",{tokenizer:{root:[[/{{.*?}}/,"variable"],[/[{}]/,"delimiter"]]}})},j=Y=>{if(E.current){const xe=E.current.getSelection(),re={major:1,minor:1},q=`{{ ${Y} }}`,ae={identifier:re,range:xe,text:q,forceMoveMarkers:!0};E.current.executeEdits("my-source",[ae]),E.current.focus()}},K=async()=>{if(!d.name||!d.description){k("Veuillez remplir tous les champs de la variable");return}try{v(!0);const Y=await Ls.createVariable(d);e&&await Ls.addVariableToTemplate(parseInt(e),Y.id),m({name:"",description:""}),await I()}catch{k("Erreur lors de l'ajout de la variable")}finally{v(!1)}},V=async Y=>{try{v(!0),await Ls.deleteVariable(Y),await I()}catch{k("Erreur lors de la suppression de la variable")}finally{v(!1)}},G=async()=>{if(!i){k("Veuillez donner un nom au template");return}try{v(!0);const Y={name:i,content:r};e?await bs.updateTemplate(parseInt(e),Y):await bs.createTemplate(Y),t("/templates")}catch{k("Erreur lors de la sauvegarde du template")}finally{v(!1)}},de=async Y=>{if(window.confirm("tes-vous sr de vouloir supprimer ce template ?"))try{v(!0),await bs.deleteTemplate(Y),await M()}catch{k("Erreur lors de la suppression du template")}finally{v(!1)}},Se=async Y=>{try{v(!0);const xe=await $e.get(`${xi}/templates/${Y}/download_excel/`,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),re=new Blob([xe.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),q=window.URL.createObjectURL(re),ae=document.createElement("a");ae.href=q,ae.download=`template_${Y}_${new Date().toISOString()}.xlsx`,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),window.URL.revokeObjectURL(q)}catch(xe){console.error("Error downloading Excel file:",xe),k("Failed to download Excel file")}finally{v(!1)}},ce=async()=>{v(!0);try{await Promise.all([I(),M()])}catch{k("Erreur lors du rafrachissement")}finally{v(!1)}};return y?p.jsx("div",{className:"p-8 flex items-center justify-center",children:p.jsx(Ss,{className:"w-8 h-8 animate-spin text-purple-600"})}):p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"Modifier le Template":"Nouveau Template"}),p.jsx("p",{className:"text-gray-600",children:"Crez et modifiez vos templates avec des variables dynamiques"})]}),p.jsx("button",{onClick:ce,disabled:y,className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",title:"Rafrachir",children:y?p.jsx(Ss,{className:"w-5 h-5 animate-spin"}):p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:p.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})})]}),T&&p.jsx("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded-md",children:T}),p.jsxs("div",{className:"flex gap-6",children:[p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{htmlFor:"templateName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du Template"}),p.jsx("input",{id:"templateName",name:"templateName",type:"text",value:i,onChange:Y=>a(Y.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"Entrez le nom du template"})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[!w&&p.jsx("div",{className:"flex items-center justify-center h-[500px] bg-gray-50",children:p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsx(Ss,{className:"w-8 h-8 animate-spin text-purple-600 mb-2"}),p.jsx("p",{className:"text-gray-600",children:"Loading editor..."})]})}),p.jsx(nM,{height:"500px",defaultLanguage:"template",value:r,onChange:Y=>n(Y||""),onMount:U,options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0,theme:"vs-dark"}})]}),p.jsxs("div",{className:"mt-4 flex gap-4",children:[p.jsxs("button",{onClick:G,disabled:y,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:[y?p.jsx(Ss,{className:"w-5 h-5 mr-2 animate-spin"}):p.jsx(Ky,{className:"w-5 h-5 mr-2"}),y?"Enregistrement...":"Enregistrer"]}),p.jsxs("button",{onClick:()=>t("/templates"),className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[p.jsx(I3,{className:"w-5 h-5 mr-2"}),"Retour"]}),e&&p.jsxs("button",{onClick:()=>de(parseInt(e)),disabled:y,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:[p.jsx(Nn,{className:"w-5 h-5 mr-2"}),"Supprimer"]})]})]}),p.jsx("div",{className:"w-80",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Variables Disponibles"}),p.jsx("div",{className:"space-y-4 mb-6",children:o&&o.length>0?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"mb-4",children:[p.jsxs("h3",{className:"text-sm font-medium text-purple-600 mb-2 flex items-center",children:[p.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),"Variables Requises"]}),p.jsx("div",{className:"space-y-2",children:o.filter(Y=>["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(Y.name)).map(Y=>p.jsxs("div",{className:"group relative",children:[p.jsxs("div",{className:"flex items-center justify-between p-2 bg-purple-50 hover:bg-purple-100 rounded-md transition-colors duration-200",children:[p.jsx("button",{onClick:()=>j(Y.name),className:"flex-1 text-left flex items-center",children:p.jsx("span",{className:"text-purple-700 font-medium",children:Y.name})}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(T1,{className:"w-4 h-4 text-purple-400"}),p.jsx("button",{onClick:()=>V(Y.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:p.jsx(Nn,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===Y.name&&p.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:Y.description})]},`variable-${Y.id||Y.name}`))})]}),p.jsxs("div",{children:[p.jsxs("h3",{className:"text-sm font-medium text-gray-600 mb-2 flex items-center",children:[p.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),"Variables Personnalises"]}),p.jsx("div",{className:"space-y-2",children:o.filter(Y=>!["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(Y.name)).map(Y=>p.jsxs("div",{className:"group relative",children:[p.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 hover:bg-gray-100 rounded-md transition-colors duration-200",children:[p.jsx("button",{onClick:()=>j(Y.name),className:"flex-1 text-left flex items-center",children:p.jsx("span",{className:"text-gray-700",children:Y.name})}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(T1,{className:"w-4 h-4 text-gray-400"}),p.jsx("button",{onClick:()=>V(Y.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:p.jsx(Nn,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===Y.name&&p.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:Y.description})]},`variable-${Y.id||Y.name}`))})]})]}):p.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucune variable disponible"})}),p.jsxs("div",{className:"border-t pt-4",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Ajouter une variable"}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"variableName",className:"block text-sm text-gray-600 mb-1",children:"Nom de la variable"}),p.jsx("input",{id:"variableName",name:"variableName",type:"text",value:d.name,onChange:Y=>m({...d,name:Y.target.value}),placeholder:"Nom de la variable",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"variableDescription",className:"block text-sm text-gray-600 mb-1",children:"Description"}),p.jsx("input",{id:"variableDescription",name:"variableDescription",type:"text",value:d.description,onChange:Y=>m({...d,description:Y.target.value}),placeholder:"Description",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),p.jsxs("button",{onClick:K,disabled:y,className:"w-full flex items-center justify-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:[y?p.jsx(Ss,{className:"w-4 h-4 mr-2 animate-spin"}):p.jsx(Vs,{className:"w-4 h-4 mr-2"}),"Ajouter"]})]})]}),p.jsxs("div",{className:"border-t mt-6 pt-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Templates"}),p.jsxs("button",{onClick:()=>t("/templates/new"),className:"flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm",children:[p.jsx(Vs,{className:"w-4 h-4 mr-1"}),"Nouveau"]})]}),p.jsx("div",{className:"space-y-3",children:y?p.jsx("div",{className:"flex justify-center py-4",children:p.jsx(Ss,{className:"w-6 h-6 animate-spin text-purple-600"})}):u&&u.length>0?u.map(Y=>p.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 hover:bg-gray-100 rounded-md",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("div",{className:"font-medium text-gray-900",children:Y.name}),p.jsxs("div",{className:"text-sm text-gray-500",children:["Cr le: ",new Date(Y.created_at).toLocaleDateString()]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:()=>t(`/templates/${Y.id}`),className:"p-1 text-blue-500 hover:text-blue-700",title:"Modifier",children:p.jsx(W3,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>Se(Y.id),className:"p-1 text-green-500 hover:text-green-700",title:"Tlcharger Excel",children:p.jsx(D3,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>de(Y.id),className:"p-1 text-red-500 hover:text-red-700",title:"Supprimer",children:p.jsx(Nn,{className:"w-4 h-4"})})]})]},`template-${Y.id}`)):p.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucun template disponible"})})]})]})})]})]})}function iM(){const e=Gi(),[t,r]=N.useState(null),[n,i]=N.useState(!1),[a,o]=N.useState({}),[l,u]=N.useState(null),[f,d]=N.useState(null),[m,g]=N.useState(null),[_,y]=N.useState(!1),[v,T]=N.useState(null),[k,E]=N.useState(!1),[w,P]=N.useState({current_password:"",new_password:"",confirm_password:""});N.useEffect(()=>{(async()=>{try{console.log("Fetching user profile data...");const j=await en.get("/auth/users/me/");console.log("User profile response:",j.data),r(j.data),o(j.data),u(null)}catch(j){console.error("Error fetching user profile data:",j),u(j.message)}})()},[]);const I=async U=>{U.preventDefault();try{console.log("Updating user data:",a);const j=await en.put("/auth/users/update_user_info/",a);console.log("Update response:",j.data),j.data&&(r(j.data.user),i(!1),u(null))}catch(j){console.error("Error updating user data:",j),u(j.message)}},M=async U=>{var j,K;if(U.preventDefault(),d(null),g(null),w.new_password!==w.confirm_password){d("Les mots de passe ne correspondent pas");return}if(w.new_password.length<8){d("Le mot de passe doit contenir au moins 8 caractres");return}try{(await en.put("/auth/users/update_user_info/",{current_password:w.current_password,password:w.new_password})).data&&(g("Mot de passe mis  jour avec succs"),P({current_password:"",new_password:"",confirm_password:""}))}catch(V){console.error("Error updating password:",V),d(((K=(j=V.response)==null?void 0:j.data)==null?void 0:K.error)||"Erreur lors de la mise  jour du mot de passe")}},b=async()=>{var U,j;E(!0),T(null);try{await en.delete("/auth/users/me/"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e("/login")}catch(K){console.error("Error deleting profile:",K),T(((j=(U=K.response)==null?void 0:U.data)==null?void 0:j.error)||"Erreur lors de la suppression du profil"),y(!1)}finally{E(!1)}};return l?p.jsx("div",{className:"max-w-2xl mx-auto p-6",children:p.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:p.jsxs("p",{className:"text-red-600",children:["Error: ",l]})})}):t?p.jsx("div",{className:"max-w-2xl mx-auto p-6",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[p.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[p.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:p.jsx(ns,{className:"h-8 w-8 text-purple-600"})}),p.jsxs("div",{children:[p.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[t.first_name," ",t.last_name]}),p.jsxs("p",{className:"text-gray-600",children:["@",t.username]})]})]}),p.jsxs("form",{onSubmit:I,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(ns,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"text",value:a.username||"",onChange:U=>o({...a,username:U.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),p.jsx("input",{type:"text",value:a.first_name||"",onChange:U=>o({...a,first_name:U.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),p.jsx("input",{type:"text",value:a.last_name||"",onChange:U=>o({...a,last_name:U.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(Zy,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"email",value:a.email||"",onChange:U=>o({...a,email:U.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(Gy,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"tel",value:a.phone_number||"",onChange:U=>o({...a,phone_number:U.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),p.jsx("div",{className:"flex justify-end space-x-4 mt-6",children:n?p.jsxs(p.Fragment,{children:[p.jsx("button",{type:"button",onClick:()=>{i(!1),o(t)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),p.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[p.jsx(Ky,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}):p.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Edit Profile"})})]}),p.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[p.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),p.jsxs("form",{onSubmit:M,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(la,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"password",value:w.current_password,onChange:U=>P({...w,current_password:U.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(la,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"password",value:w.new_password,onChange:U=>P({...w,new_password:U.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),p.jsxs("div",{className:"mt-1 flex items-center",children:[p.jsx(la,{className:"h-5 w-5 text-gray-400 mr-2"}),p.jsx("input",{type:"password",value:w.confirm_password,onChange:U=>P({...w,confirm_password:U.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),f&&p.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:p.jsx("p",{className:"text-red-600",children:f})}),m&&p.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:p.jsx("p",{className:"text-green-600",children:m})}),p.jsx("div",{className:"flex justify-end",children:p.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[p.jsx(la,{className:"h-4 w-4 mr-2"}),"Change Password"]})})]})]}),p.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[p.jsx("h2",{className:"text-lg font-medium text-red-600 mb-4",children:"Zone de danger"}),p.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[p.jsx("p",{className:"text-red-600 mb-4",children:"La suppression de votre compte est irrversible. Toutes vos donnes seront dfinitivement supprimes."}),p.jsxs("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center",children:[p.jsx(Nn,{className:"h-4 w-4 mr-2"}),"Supprimer mon compte"]})]})]}),_&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:p.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[p.jsx("h3",{className:"text-lg font-medium text-red-600 mb-4",children:"Confirmer la suppression"}),p.jsx("p",{className:"text-gray-600 mb-4",children:"tes-vous sr de vouloir supprimer votre compte ? Cette action est irrversible."}),v&&p.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:p.jsx("p",{className:"text-red-600",children:v})}),p.jsxs("div",{className:"flex justify-end space-x-4",children:[p.jsx("button",{onClick:()=>y(!1),disabled:k,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Annuler"}),p.jsx("button",{onClick:b,disabled:k,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center disabled:opacity-50",children:k?p.jsxs(p.Fragment,{children:[p.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Suppression en cours..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Nn,{className:"h-4 w-4 mr-2"}),"Confirmer la suppression"]})})]})]})})]})}):p.jsx("div",{className:"max-w-2xl mx-auto p-6",children:p.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:p.jsxs("div",{className:"animate-pulse",children:[p.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"h-4 bg-gray-200 rounded"}),p.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),p.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]})})})}const aM=()=>{const[e,t]=N.useState([]),[r,n]=N.useState(!0),[i,a]=N.useState(null);N.useEffect(()=>{(async()=>{try{n(!0);const f=await fetch("http://localhost:8000/api/history/");if(!f.ok)throw new Error("Erreur lors de la rcupration de l'historique");const d=await f.json();t(d.results||[])}catch(f){a(f.message)}finally{n(!1)}})()},[]);const o=u=>{switch(u){case"firewall":return p.jsx(rs,{className:"h-5 w-5 text-purple-600"});case"data_center":return p.jsx(tc,{className:"h-5 w-5 text-blue-600"});case"firewall_type":return p.jsx(rc,{className:"h-5 w-5 text-green-600"});default:return null}},l=u=>{const f=new Date(u);return new Intl.DateTimeFormat("fr-FR",{dateStyle:"medium",timeStyle:"short"}).format(f)};return r?p.jsx("div",{className:"flex items-center justify-center h-screen",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"mb-6",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Historique des Actions"}),p.jsx("p",{className:"text-gray-600",children:"Consultez l'historique des modifications sur les pare-feux et les centres de donnes"})]}),i&&p.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md",children:i}),p.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[p.jsx("div",{className:"divide-y divide-gray-200",children:e.map(u=>p.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:p.jsxs("div",{className:"flex items-start space-x-4",children:[p.jsx("div",{className:"flex-shrink-0",children:o(u.entity_type)}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[u.action," - ",u.entity_name]}),p.jsx("p",{className:"text-sm text-gray-500",children:l(u.timestamp)})]}),p.jsxs("div",{className:"mt-1 flex items-center text-sm text-gray-500",children:[p.jsx(ns,{className:"h-4 w-4 mr-1"}),p.jsx("span",{children:u.user})]}),u.details&&p.jsx("p",{className:"mt-2 text-sm text-gray-600",children:u.details})]})]})},u.id))}),e.length===0&&!r&&p.jsxs("div",{className:"text-center py-12",children:[p.jsx($y,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Aucun historique disponible"}),p.jsx("p",{className:"text-gray-500 mt-2",children:"Les actions effectues apparatront ici."})]})]})]})},Wx=()=>p.jsxs("div",{className:"p-8",children:[p.jsxs("div",{className:"mb-6",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Tableau de Bord"}),p.jsx("p",{className:"text-gray-600",children:"Vue d'ensemble de votre infrastructure"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[p.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600",children:p.jsx(rs,{className:"h-6 w-6"})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("h2",{className:"text-gray-600 text-sm",children:"Pare-feux"}),p.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:"0"})]})]})}),p.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600",children:p.jsx(tc,{className:"h-6 w-6"})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("h2",{className:"text-gray-600 text-sm",children:"Centres de donnes"}),p.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:"0"})]})]})}),p.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-600",children:p.jsx(rc,{className:"h-6 w-6"})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("h2",{className:"text-gray-600 text-sm",children:"Types de pare-feux"}),p.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:"0"})]})]})}),p.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-3 rounded-full bg-yellow-100 text-yellow-600",children:p.jsx(Wy,{className:"h-6 w-6"})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("h2",{className:"text-gray-600 text-sm",children:"Actions aujourd'hui"}),p.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:"0"})]})]})})]}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activit rcente"}),p.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucune activit rcente"})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statut des pare-feux"}),p.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucun pare-feu configur"})]})]})]}),kn=({children:e})=>localStorage.getItem("token")?p.jsx(p.Fragment,{children:e}):p.jsx(T4,{to:"/login"}),En=({children:e})=>{const[t,r]=N.useState(!1),n=Gi(),i=async()=>{try{await en.post("/auth/logout/")}catch(a){console.error("Logout error:",a)}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),delete en.defaults.headers.common.Authorization,n("/login")}};return t?p.jsx("div",{className:"flex items-center justify-center h-full",children:p.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-900"})}):p.jsxs("div",{className:"flex h-screen bg-gray-100",children:[p.jsx(eA,{onLogout:i}),p.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:p.jsx("main",{className:"flex-1 overflow-y-auto",children:e})})]})},sM=()=>{const[e,t]=N.useState(!1),r=Gi();return N.useEffect(()=>{O3(r)},[r]),N.useEffect(()=>{const n=localStorage.getItem("token"),i=localStorage.getItem("refreshToken");n&&i&&(t(!0),en.defaults.headers.common.Authorization=`Bearer ${n}`)},[]),p.jsxs(C4,{children:[p.jsx(zr,{path:"/login",element:p.jsx(K3,{onLogin:()=>t(!0)})}),p.jsx(zr,{path:"/register",element:p.jsx(Q3,{onRegister:()=>t(!0)})}),p.jsx(zr,{path:"/",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(Wx,{})})})}),p.jsx(zr,{path:"/dashboard",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(Wx,{})})})}),p.jsx(zr,{path:"/firewalls",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(fO,{})})})}),p.jsx(zr,{path:"/profile",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(iM,{})})})}),p.jsx(zr,{path:"/templates",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(rd,{})})})}),p.jsx(zr,{path:"/templates/new",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(rd,{})})})}),p.jsx(zr,{path:"/templates/:id",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(rd,{})})})}),p.jsx(zr,{path:"/config",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(cO,{})})})}),p.jsx(zr,{path:"/matrix",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(oO,{})})})}),p.jsx(zr,{path:"/map",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(YO,{})})})}),p.jsx(zr,{path:"/settings",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(uO,{})})})}),p.jsx(zr,{path:"/history",element:p.jsx(kn,{children:p.jsx(En,{children:p.jsx(aM,{})})})})]})};function oM(){return p.jsx(E4,{children:p.jsx(EO,{children:p.jsx(sM,{})})})}ay(document.getElementById("root")).render(p.jsx(N.StrictMode,{children:p.jsx(oM,{})}));
