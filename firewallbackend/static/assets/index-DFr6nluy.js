(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var bi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Nf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var hv={exports:{}},Af={},pv={exports:{}},ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ic=Symbol.for("react.element"),kE=Symbol.for("react.portal"),EE=Symbol.for("react.fragment"),SE=Symbol.for("react.strict_mode"),TE=Symbol.for("react.profiler"),CE=Symbol.for("react.provider"),bE=Symbol.for("react.context"),NE=Symbol.for("react.forward_ref"),AE=Symbol.for("react.suspense"),LE=Symbol.for("react.memo"),PE=Symbol.for("react.lazy"),_1=Symbol.iterator;function FE(e){return e===null||typeof e!="object"?null:(e=_1&&e[_1]||e["@@iterator"],typeof e=="function"?e:null)}var mv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gv=Object.assign,xv={};function To(e,t,r){this.props=e,this.context=t,this.refs=xv,this.updater=r||mv}To.prototype.isReactComponent={};To.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};To.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vv(){}vv.prototype=To.prototype;function Uh(e,t,r){this.props=e,this.context=t,this.refs=xv,this.updater=r||mv}var Hh=Uh.prototype=new vv;Hh.constructor=Uh;gv(Hh,To.prototype);Hh.isPureReactComponent=!0;var y1=Array.isArray,_v=Object.prototype.hasOwnProperty,Vh={current:null},yv={key:!0,ref:!0,__self:!0,__source:!0};function wv(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)_v.call(t,n)&&!yv.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var u=Array(l),f=0;f<l;f++)u[f]=arguments[f+2];a.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:ic,type:e,key:i,ref:o,props:a,_owner:Vh.current}}function OE(e,t){return{$$typeof:ic,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wh(e){return typeof e=="object"&&e!==null&&e.$$typeof===ic}function ME(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var w1=/\/+/g;function L0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ME(""+e.key):t.toString(36)}function xu(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ic:case kE:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+L0(o,0):n,y1(a)?(r="",e!=null&&(r=e.replace(w1,"$&/")+"/"),xu(a,t,r,"",function(f){return f})):a!=null&&(Wh(a)&&(a=OE(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(w1,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",y1(e))for(var l=0;l<e.length;l++){i=e[l];var u=n+L0(i,l);o+=xu(i,t,r,u,a)}else if(u=FE(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=n+L0(i,l++),o+=xu(i,t,r,u,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Vc(e,t,r){if(e==null)return e;var n=[],a=0;return xu(e,n,"","",function(i){return t.call(r,i,a++)}),n}function RE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jr={current:null},vu={transition:null},DE={ReactCurrentDispatcher:Jr,ReactCurrentBatchConfig:vu,ReactCurrentOwner:Vh};function kv(){throw Error("act(...) is not supported in production builds of React.")}ft.Children={map:Vc,forEach:function(e,t,r){Vc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Vc(e,function(){t++}),t},toArray:function(e){return Vc(e,function(t){return t})||[]},only:function(e){if(!Wh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ft.Component=To;ft.Fragment=EE;ft.Profiler=TE;ft.PureComponent=Uh;ft.StrictMode=SE;ft.Suspense=AE;ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DE;ft.act=kv;ft.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=gv({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Vh.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)_v.call(t,u)&&!yv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var f=0;f<u;f++)l[f]=arguments[f+2];n.children=l}return{$$typeof:ic,type:e.type,key:a,ref:i,props:n,_owner:o}};ft.createContext=function(e){return e={$$typeof:bE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:CE,_context:e},e.Consumer=e};ft.createElement=wv;ft.createFactory=function(e){var t=wv.bind(null,e);return t.type=e,t};ft.createRef=function(){return{current:null}};ft.forwardRef=function(e){return{$$typeof:NE,render:e}};ft.isValidElement=Wh;ft.lazy=function(e){return{$$typeof:PE,_payload:{_status:-1,_result:e},_init:RE}};ft.memo=function(e,t){return{$$typeof:LE,type:e,compare:t===void 0?null:t}};ft.startTransition=function(e){var t=vu.transition;vu.transition={};try{e()}finally{vu.transition=t}};ft.unstable_act=kv;ft.useCallback=function(e,t){return Jr.current.useCallback(e,t)};ft.useContext=function(e){return Jr.current.useContext(e)};ft.useDebugValue=function(){};ft.useDeferredValue=function(e){return Jr.current.useDeferredValue(e)};ft.useEffect=function(e,t){return Jr.current.useEffect(e,t)};ft.useId=function(){return Jr.current.useId()};ft.useImperativeHandle=function(e,t,r){return Jr.current.useImperativeHandle(e,t,r)};ft.useInsertionEffect=function(e,t){return Jr.current.useInsertionEffect(e,t)};ft.useLayoutEffect=function(e,t){return Jr.current.useLayoutEffect(e,t)};ft.useMemo=function(e,t){return Jr.current.useMemo(e,t)};ft.useReducer=function(e,t,r){return Jr.current.useReducer(e,t,r)};ft.useRef=function(e){return Jr.current.useRef(e)};ft.useState=function(e){return Jr.current.useState(e)};ft.useSyncExternalStore=function(e,t,r){return Jr.current.useSyncExternalStore(e,t,r)};ft.useTransition=function(){return Jr.current.useTransition()};ft.version="18.3.1";pv.exports=ft;var C=pv.exports;const os=dv(C);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IE=C,jE=Symbol.for("react.element"),BE=Symbol.for("react.fragment"),zE=Object.prototype.hasOwnProperty,UE=IE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,HE={key:!0,ref:!0,__self:!0,__source:!0};function Ev(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)zE.call(t,n)&&!HE.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:jE,type:e,key:i,ref:o,props:a,_owner:UE.current}}Af.Fragment=BE;Af.jsx=Ev;Af.jsxs=Ev;hv.exports=Af;var d=hv.exports,vd={},Sv={exports:{}},yn={},Tv={exports:{}},Cv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Q,U){var te=Q.length;Q.push(U);e:for(;0<te;){var fe=te-1>>>1,F=Q[fe];if(0<a(F,U))Q[fe]=U,Q[te]=F,te=fe;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var U=Q[0],te=Q.pop();if(te!==U){Q[0]=te;e:for(var fe=0,F=Q.length,ee=F>>>1;fe<ee;){var q=2*(fe+1)-1,X=Q[q],ae=q+1,ke=Q[ae];if(0>a(X,te))ae<F&&0>a(ke,X)?(Q[fe]=ke,Q[ae]=te,fe=ae):(Q[fe]=X,Q[q]=te,fe=q);else if(ae<F&&0>a(ke,te))Q[fe]=ke,Q[ae]=te,fe=ae;else break e}}return U}function a(Q,U){var te=Q.sortIndex-U.sortIndex;return te!==0?te:Q.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],f=[],h=1,m=null,g=3,x=!1,_=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Q){for(var U=r(f);U!==null;){if(U.callback===null)n(f);else if(U.startTime<=Q)n(f),U.sortIndex=U.expirationTime,t(u,U);else break;U=r(f)}}function A(Q){if(y=!1,w(Q),!_)if(r(u)!==null)_=!0,de(I);else{var U=r(f);U!==null&&J(A,U.startTime-Q)}}function I(Q,U){_=!1,y&&(y=!1,k(W),W=-1),x=!0;var te=g;try{for(w(U),m=r(u);m!==null&&(!(m.expirationTime>U)||Q&&!B());){var fe=m.callback;if(typeof fe=="function"){m.callback=null,g=m.priorityLevel;var F=fe(m.expirationTime<=U);U=e.unstable_now(),typeof F=="function"?m.callback=F:m===r(u)&&n(u),w(U)}else n(u);m=r(u)}if(m!==null)var ee=!0;else{var q=r(f);q!==null&&J(A,q.startTime-U),ee=!1}return ee}finally{m=null,g=te,x=!1}}var D=!1,P=null,W=-1,j=5,V=-1;function B(){return!(e.unstable_now()-V<j)}function Z(){if(P!==null){var Q=e.unstable_now();V=Q;var U=!0;try{U=P(!0,Q)}finally{U?K():(D=!1,P=null)}}else D=!1}var K;if(typeof S=="function")K=function(){S(Z)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,_e=ve.port2;ve.port1.onmessage=Z,K=function(){_e.postMessage(null)}}else K=function(){E(Z,0)};function de(Q){P=Q,D||(D=!0,K())}function J(Q,U){W=E(function(){Q(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_continueExecution=function(){_||x||(_=!0,de(I))},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(Q){switch(g){case 1:case 2:case 3:var U=3;break;default:U=g}var te=g;g=U;try{return Q()}finally{g=te}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Q,U){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var te=g;g=Q;try{return U()}finally{g=te}},e.unstable_scheduleCallback=function(Q,U,te){var fe=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?fe+te:fe):te=fe,Q){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=te+F,Q={id:h++,callback:U,priorityLevel:Q,startTime:te,expirationTime:F,sortIndex:-1},te>fe?(Q.sortIndex=te,t(f,Q),r(u)===null&&Q===r(f)&&(y?(k(W),W=-1):y=!0,J(A,te-fe))):(Q.sortIndex=F,t(u,Q),_||x||(_=!0,de(I))),Q},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(Q){var U=g;return function(){var te=g;g=U;try{return Q.apply(this,arguments)}finally{g=te}}}})(Cv);Tv.exports=Cv;var VE=Tv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WE=C,vn=VE;function be(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bv=new Set,Fl={};function vs(e,t){mo(e,t),mo(e+"Capture",t)}function mo(e,t){for(Fl[e]=t,e=0;e<t.length;e++)bv.add(t[e])}var $a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_d=Object.prototype.hasOwnProperty,$E=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k1={},E1={};function GE(e){return _d.call(E1,e)?!0:_d.call(k1,e)?!1:$E.test(e)?E1[e]=!0:(k1[e]=!0,!1)}function ZE(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XE(e,t,r,n){if(t===null||typeof t>"u"||ZE(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qr(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){br[e]=new Qr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];br[t]=new Qr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){br[e]=new Qr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){br[e]=new Qr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){br[e]=new Qr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){br[e]=new Qr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){br[e]=new Qr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){br[e]=new Qr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){br[e]=new Qr(e,5,!1,e.toLowerCase(),null,!1,!1)});var $h=/[\-:]([a-z])/g;function Gh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($h,Gh);br[t]=new Qr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($h,Gh);br[t]=new Qr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($h,Gh);br[t]=new Qr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){br[e]=new Qr(e,1,!1,e.toLowerCase(),null,!1,!1)});br.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){br[e]=new Qr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zh(e,t,r,n){var a=br.hasOwnProperty(t)?br[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(XE(t,r,a,n)&&(r=null),n||a===null?GE(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ja=WE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wc=Symbol.for("react.element"),Vs=Symbol.for("react.portal"),Ws=Symbol.for("react.fragment"),Xh=Symbol.for("react.strict_mode"),yd=Symbol.for("react.profiler"),Nv=Symbol.for("react.provider"),Av=Symbol.for("react.context"),qh=Symbol.for("react.forward_ref"),wd=Symbol.for("react.suspense"),kd=Symbol.for("react.suspense_list"),Yh=Symbol.for("react.memo"),oi=Symbol.for("react.lazy"),Lv=Symbol.for("react.offscreen"),S1=Symbol.iterator;function Zo(e){return e===null||typeof e!="object"?null:(e=S1&&e[S1]||e["@@iterator"],typeof e=="function"?e:null)}var Wt=Object.assign,P0;function al(e){if(P0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);P0=t&&t[1]||""}return`
`+P0+e}var F0=!1;function O0(e,t){if(!e||F0)return"";F0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var a=f.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var u=`
`+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{F0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?al(e):""}function qE(e){switch(e.tag){case 5:return al(e.type);case 16:return al("Lazy");case 13:return al("Suspense");case 19:return al("SuspenseList");case 0:case 2:case 15:return e=O0(e.type,!1),e;case 11:return e=O0(e.type.render,!1),e;case 1:return e=O0(e.type,!0),e;default:return""}}function Ed(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ws:return"Fragment";case Vs:return"Portal";case yd:return"Profiler";case Xh:return"StrictMode";case wd:return"Suspense";case kd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Av:return(e.displayName||"Context")+".Consumer";case Nv:return(e._context.displayName||"Context")+".Provider";case qh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yh:return t=e.displayName||null,t!==null?t:Ed(e.type)||"Memo";case oi:t=e._payload,e=e._init;try{return Ed(e(t))}catch{}}return null}function YE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ed(t);case 8:return t===Xh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ni(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Pv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function KE(e){var t=Pv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $c(e){e._valueTracker||(e._valueTracker=KE(e))}function Fv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Pv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ru(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Sd(e,t){var r=t.checked;return Wt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function T1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ni(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ov(e,t){t=t.checked,t!=null&&Zh(e,"checked",t,!1)}function Td(e,t){Ov(e,t);var r=Ni(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Cd(e,t.type,r):t.hasOwnProperty("defaultValue")&&Cd(e,t.type,Ni(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function C1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Cd(e,t,r){(t!=="number"||Ru(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var il=Array.isArray;function ao(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ni(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function bd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(be(91));return Wt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function b1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(be(92));if(il(r)){if(1<r.length)throw Error(be(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ni(r)}}function Mv(e,t){var r=Ni(t.value),n=Ni(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function N1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Rv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Rv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gc,Dv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gc=Gc||document.createElement("div"),Gc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ol(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var hl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JE=["Webkit","ms","Moz","O"];Object.keys(hl).forEach(function(e){JE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hl[t]=hl[e]})});function Iv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||hl.hasOwnProperty(e)&&hl[e]?(""+t).trim():t+"px"}function jv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Iv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var QE=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ad(e,t){if(t){if(QE[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(be(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(be(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(be(61))}if(t.style!=null&&typeof t.style!="object")throw Error(be(62))}}function Ld(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pd=null;function Kh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fd=null,io=null,so=null;function A1(e){if(e=lc(e)){if(typeof Fd!="function")throw Error(be(280));var t=e.stateNode;t&&(t=Mf(t),Fd(e.stateNode,e.type,t))}}function Bv(e){io?so?so.push(e):so=[e]:io=e}function zv(){if(io){var e=io,t=so;if(so=io=null,A1(e),t)for(e=0;e<t.length;e++)A1(t[e])}}function Uv(e,t){return e(t)}function Hv(){}var M0=!1;function Vv(e,t,r){if(M0)return e(t,r);M0=!0;try{return Uv(e,t,r)}finally{M0=!1,(io!==null||so!==null)&&(Hv(),zv())}}function Ml(e,t){var r=e.stateNode;if(r===null)return null;var n=Mf(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(be(231,t,typeof r));return r}var Od=!1;if($a)try{var Xo={};Object.defineProperty(Xo,"passive",{get:function(){Od=!0}}),window.addEventListener("test",Xo,Xo),window.removeEventListener("test",Xo,Xo)}catch{Od=!1}function e4(e,t,r,n,a,i,o,l,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(h){this.onError(h)}}var pl=!1,Du=null,Iu=!1,Md=null,t4={onError:function(e){pl=!0,Du=e}};function r4(e,t,r,n,a,i,o,l,u){pl=!1,Du=null,e4.apply(t4,arguments)}function n4(e,t,r,n,a,i,o,l,u){if(r4.apply(this,arguments),pl){if(pl){var f=Du;pl=!1,Du=null}else throw Error(be(198));Iu||(Iu=!0,Md=f)}}function _s(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Wv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function L1(e){if(_s(e)!==e)throw Error(be(188))}function a4(e){var t=e.alternate;if(!t){if(t=_s(e),t===null)throw Error(be(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return L1(a),e;if(i===n)return L1(a),t;i=i.sibling}throw Error(be(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(be(189))}}if(r.alternate!==n)throw Error(be(190))}if(r.tag!==3)throw Error(be(188));return r.stateNode.current===r?e:t}function $v(e){return e=a4(e),e!==null?Gv(e):null}function Gv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Gv(e);if(t!==null)return t;e=e.sibling}return null}var Zv=vn.unstable_scheduleCallback,P1=vn.unstable_cancelCallback,i4=vn.unstable_shouldYield,s4=vn.unstable_requestPaint,Jt=vn.unstable_now,o4=vn.unstable_getCurrentPriorityLevel,Jh=vn.unstable_ImmediatePriority,Xv=vn.unstable_UserBlockingPriority,ju=vn.unstable_NormalPriority,l4=vn.unstable_LowPriority,qv=vn.unstable_IdlePriority,Lf=null,_a=null;function c4(e){if(_a&&typeof _a.onCommitFiberRoot=="function")try{_a.onCommitFiberRoot(Lf,e,void 0,(e.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:d4,u4=Math.log,f4=Math.LN2;function d4(e){return e>>>=0,e===0?32:31-(u4(e)/f4|0)|0}var Zc=64,Xc=4194304;function sl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Bu(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=sl(l):(i&=o,i!==0&&(n=sl(i)))}else o=r&~a,o!==0?n=sl(o):i!==0&&(n=sl(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Yn(t),a=1<<r,n|=e[r],t&=~a;return n}function h4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function p4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Yn(i),l=1<<o,u=a[o];u===-1?(!(l&r)||l&n)&&(a[o]=h4(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function Rd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yv(){var e=Zc;return Zc<<=1,!(Zc&4194240)&&(Zc=64),e}function R0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function sc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yn(t),e[t]=r}function m4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Yn(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Qh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Yn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var bt=0;function Kv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Jv,ep,Qv,e_,t_,Dd=!1,qc=[],vi=null,_i=null,yi=null,Rl=new Map,Dl=new Map,ci=[],g4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function F1(e,t){switch(e){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Rl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dl.delete(t.pointerId)}}function qo(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=lc(t),t!==null&&ep(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function x4(e,t,r,n,a){switch(t){case"focusin":return vi=qo(vi,e,t,r,n,a),!0;case"dragenter":return _i=qo(_i,e,t,r,n,a),!0;case"mouseover":return yi=qo(yi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Rl.set(i,qo(Rl.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Dl.set(i,qo(Dl.get(i)||null,e,t,r,n,a)),!0}return!1}function r_(e){var t=qi(e.target);if(t!==null){var r=_s(t);if(r!==null){if(t=r.tag,t===13){if(t=Wv(r),t!==null){e.blockedOn=t,t_(e.priority,function(){Qv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _u(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Id(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Pd=n,r.target.dispatchEvent(n),Pd=null}else return t=lc(r),t!==null&&ep(t),e.blockedOn=r,!1;t.shift()}return!0}function O1(e,t,r){_u(e)&&r.delete(t)}function v4(){Dd=!1,vi!==null&&_u(vi)&&(vi=null),_i!==null&&_u(_i)&&(_i=null),yi!==null&&_u(yi)&&(yi=null),Rl.forEach(O1),Dl.forEach(O1)}function Yo(e,t){e.blockedOn===t&&(e.blockedOn=null,Dd||(Dd=!0,vn.unstable_scheduleCallback(vn.unstable_NormalPriority,v4)))}function Il(e){function t(a){return Yo(a,e)}if(0<qc.length){Yo(qc[0],e);for(var r=1;r<qc.length;r++){var n=qc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(vi!==null&&Yo(vi,e),_i!==null&&Yo(_i,e),yi!==null&&Yo(yi,e),Rl.forEach(t),Dl.forEach(t),r=0;r<ci.length;r++)n=ci[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ci.length&&(r=ci[0],r.blockedOn===null);)r_(r),r.blockedOn===null&&ci.shift()}var oo=Ja.ReactCurrentBatchConfig,zu=!0;function _4(e,t,r,n){var a=bt,i=oo.transition;oo.transition=null;try{bt=1,tp(e,t,r,n)}finally{bt=a,oo.transition=i}}function y4(e,t,r,n){var a=bt,i=oo.transition;oo.transition=null;try{bt=4,tp(e,t,r,n)}finally{bt=a,oo.transition=i}}function tp(e,t,r,n){if(zu){var a=Id(e,t,r,n);if(a===null)$0(e,t,n,Uu,r),F1(e,n);else if(x4(a,e,t,r,n))n.stopPropagation();else if(F1(e,n),t&4&&-1<g4.indexOf(e)){for(;a!==null;){var i=lc(a);if(i!==null&&Jv(i),i=Id(e,t,r,n),i===null&&$0(e,t,n,Uu,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else $0(e,t,n,null,r)}}var Uu=null;function Id(e,t,r,n){if(Uu=null,e=Kh(n),e=qi(e),e!==null)if(t=_s(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Wv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Uu=e,null}function n_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(o4()){case Jh:return 1;case Xv:return 4;case ju:case l4:return 16;case qv:return 536870912;default:return 16}default:return 16}}var pi=null,rp=null,yu=null;function a_(){if(yu)return yu;var e,t=rp,r=t.length,n,a="value"in pi?pi.value:pi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return yu=a.slice(e,1<n?1-n:void 0)}function wu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yc(){return!0}function M1(){return!1}function wn(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Yc:M1,this.isPropagationStopped=M1,this}return Wt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yc)},persist:function(){},isPersistent:Yc}),t}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},np=wn(Co),oc=Wt({},Co,{view:0,detail:0}),w4=wn(oc),D0,I0,Ko,Pf=Wt({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ap,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ko&&(Ko&&e.type==="mousemove"?(D0=e.screenX-Ko.screenX,I0=e.screenY-Ko.screenY):I0=D0=0,Ko=e),D0)},movementY:function(e){return"movementY"in e?e.movementY:I0}}),R1=wn(Pf),k4=Wt({},Pf,{dataTransfer:0}),E4=wn(k4),S4=Wt({},oc,{relatedTarget:0}),j0=wn(S4),T4=Wt({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),C4=wn(T4),b4=Wt({},Co,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),N4=wn(b4),A4=Wt({},Co,{data:0}),D1=wn(A4),L4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},F4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=F4[e])?!!t[e]:!1}function ap(){return O4}var M4=Wt({},oc,{key:function(e){if(e.key){var t=L4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?P4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ap,charCode:function(e){return e.type==="keypress"?wu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),R4=wn(M4),D4=Wt({},Pf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),I1=wn(D4),I4=Wt({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ap}),j4=wn(I4),B4=Wt({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),z4=wn(B4),U4=Wt({},Pf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),H4=wn(U4),V4=[9,13,27,32],ip=$a&&"CompositionEvent"in window,ml=null;$a&&"documentMode"in document&&(ml=document.documentMode);var W4=$a&&"TextEvent"in window&&!ml,i_=$a&&(!ip||ml&&8<ml&&11>=ml),j1=" ",B1=!1;function s_(e,t){switch(e){case"keyup":return V4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function o_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $s=!1;function $4(e,t){switch(e){case"compositionend":return o_(t);case"keypress":return t.which!==32?null:(B1=!0,j1);case"textInput":return e=t.data,e===j1&&B1?null:e;default:return null}}function G4(e,t){if($s)return e==="compositionend"||!ip&&s_(e,t)?(e=a_(),yu=rp=pi=null,$s=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return i_&&t.locale!=="ko"?null:t.data;default:return null}}var Z4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function z1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Z4[e.type]:t==="textarea"}function l_(e,t,r,n){Bv(n),t=Hu(t,"onChange"),0<t.length&&(r=new np("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var gl=null,jl=null;function X4(e){__(e,0)}function Ff(e){var t=Xs(e);if(Fv(t))return e}function q4(e,t){if(e==="change")return t}var c_=!1;if($a){var B0;if($a){var z0="oninput"in document;if(!z0){var U1=document.createElement("div");U1.setAttribute("oninput","return;"),z0=typeof U1.oninput=="function"}B0=z0}else B0=!1;c_=B0&&(!document.documentMode||9<document.documentMode)}function H1(){gl&&(gl.detachEvent("onpropertychange",u_),jl=gl=null)}function u_(e){if(e.propertyName==="value"&&Ff(jl)){var t=[];l_(t,jl,e,Kh(e)),Vv(X4,t)}}function Y4(e,t,r){e==="focusin"?(H1(),gl=t,jl=r,gl.attachEvent("onpropertychange",u_)):e==="focusout"&&H1()}function K4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ff(jl)}function J4(e,t){if(e==="click")return Ff(t)}function Q4(e,t){if(e==="input"||e==="change")return Ff(t)}function eS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qn=typeof Object.is=="function"?Object.is:eS;function Bl(e,t){if(Qn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!_d.call(t,a)||!Qn(e[a],t[a]))return!1}return!0}function V1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function W1(e,t){var r=V1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=V1(r)}}function f_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?f_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function d_(){for(var e=window,t=Ru();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ru(e.document)}return t}function sp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tS(e){var t=d_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&f_(r.ownerDocument.documentElement,r)){if(n!==null&&sp(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=W1(r,i);var o=W1(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var rS=$a&&"documentMode"in document&&11>=document.documentMode,Gs=null,jd=null,xl=null,Bd=!1;function $1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Bd||Gs==null||Gs!==Ru(n)||(n=Gs,"selectionStart"in n&&sp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),xl&&Bl(xl,n)||(xl=n,n=Hu(jd,"onSelect"),0<n.length&&(t=new np("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gs)))}function Kc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Zs={animationend:Kc("Animation","AnimationEnd"),animationiteration:Kc("Animation","AnimationIteration"),animationstart:Kc("Animation","AnimationStart"),transitionend:Kc("Transition","TransitionEnd")},U0={},h_={};$a&&(h_=document.createElement("div").style,"AnimationEvent"in window||(delete Zs.animationend.animation,delete Zs.animationiteration.animation,delete Zs.animationstart.animation),"TransitionEvent"in window||delete Zs.transitionend.transition);function Of(e){if(U0[e])return U0[e];if(!Zs[e])return e;var t=Zs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in h_)return U0[e]=t[r];return e}var p_=Of("animationend"),m_=Of("animationiteration"),g_=Of("animationstart"),x_=Of("transitionend"),v_=new Map,G1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(e,t){v_.set(e,t),vs(t,[e])}for(var H0=0;H0<G1.length;H0++){var V0=G1[H0],nS=V0.toLowerCase(),aS=V0[0].toUpperCase()+V0.slice(1);Oi(nS,"on"+aS)}Oi(p_,"onAnimationEnd");Oi(m_,"onAnimationIteration");Oi(g_,"onAnimationStart");Oi("dblclick","onDoubleClick");Oi("focusin","onFocus");Oi("focusout","onBlur");Oi(x_,"onTransitionEnd");mo("onMouseEnter",["mouseout","mouseover"]);mo("onMouseLeave",["mouseout","mouseover"]);mo("onPointerEnter",["pointerout","pointerover"]);mo("onPointerLeave",["pointerout","pointerover"]);vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function Z1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,n4(n,t,void 0,e),e.currentTarget=null}function __(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,f=l.currentTarget;if(l=l.listener,u!==i&&a.isPropagationStopped())break e;Z1(a,l,f),i=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,f=l.currentTarget,l=l.listener,u!==i&&a.isPropagationStopped())break e;Z1(a,l,f),i=u}}}if(Iu)throw e=Md,Iu=!1,Md=null,e}function Mt(e,t){var r=t[Wd];r===void 0&&(r=t[Wd]=new Set);var n=e+"__bubble";r.has(n)||(y_(t,e,2,!1),r.add(n))}function W0(e,t,r){var n=0;t&&(n|=4),y_(r,e,n,t)}var Jc="_reactListening"+Math.random().toString(36).slice(2);function zl(e){if(!e[Jc]){e[Jc]=!0,bv.forEach(function(r){r!=="selectionchange"&&(iS.has(r)||W0(r,!1,e),W0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jc]||(t[Jc]=!0,W0("selectionchange",!1,t))}}function y_(e,t,r,n){switch(n_(t)){case 1:var a=_4;break;case 4:a=y4;break;default:a=tp}r=a.bind(null,t,r,e),a=void 0,!Od||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function $0(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;o=o.return}for(;l!==null;){if(o=qi(l),o===null)return;if(u=o.tag,u===5||u===6){n=i=o;continue e}l=l.parentNode}}n=n.return}Vv(function(){var f=i,h=Kh(r),m=[];e:{var g=v_.get(e);if(g!==void 0){var x=np,_=e;switch(e){case"keypress":if(wu(r)===0)break e;case"keydown":case"keyup":x=R4;break;case"focusin":_="focus",x=j0;break;case"focusout":_="blur",x=j0;break;case"beforeblur":case"afterblur":x=j0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=R1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=E4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=j4;break;case p_:case m_:case g_:x=C4;break;case x_:x=z4;break;case"scroll":x=w4;break;case"wheel":x=H4;break;case"copy":case"cut":case"paste":x=N4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=I1}var y=(t&4)!==0,E=!y&&e==="scroll",k=y?g!==null?g+"Capture":null:g;y=[];for(var S=f,w;S!==null;){w=S;var A=w.stateNode;if(w.tag===5&&A!==null&&(w=A,k!==null&&(A=Ml(S,k),A!=null&&y.push(Ul(S,A,w)))),E)break;S=S.return}0<y.length&&(g=new x(g,_,null,r,h),m.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",g&&r!==Pd&&(_=r.relatedTarget||r.fromElement)&&(qi(_)||_[Ga]))break e;if((x||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,x?(_=r.relatedTarget||r.toElement,x=f,_=_?qi(_):null,_!==null&&(E=_s(_),_!==E||_.tag!==5&&_.tag!==6)&&(_=null)):(x=null,_=f),x!==_)){if(y=R1,A="onMouseLeave",k="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(y=I1,A="onPointerLeave",k="onPointerEnter",S="pointer"),E=x==null?g:Xs(x),w=_==null?g:Xs(_),g=new y(A,S+"leave",x,r,h),g.target=E,g.relatedTarget=w,A=null,qi(h)===f&&(y=new y(k,S+"enter",_,r,h),y.target=w,y.relatedTarget=E,A=y),E=A,x&&_)t:{for(y=x,k=_,S=0,w=y;w;w=Ds(w))S++;for(w=0,A=k;A;A=Ds(A))w++;for(;0<S-w;)y=Ds(y),S--;for(;0<w-S;)k=Ds(k),w--;for(;S--;){if(y===k||k!==null&&y===k.alternate)break t;y=Ds(y),k=Ds(k)}y=null}else y=null;x!==null&&X1(m,g,x,y,!1),_!==null&&E!==null&&X1(m,E,_,y,!0)}}e:{if(g=f?Xs(f):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var I=q4;else if(z1(g))if(c_)I=Q4;else{I=K4;var D=Y4}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(I=J4);if(I&&(I=I(e,f))){l_(m,I,r,h);break e}D&&D(e,g,f),e==="focusout"&&(D=g._wrapperState)&&D.controlled&&g.type==="number"&&Cd(g,"number",g.value)}switch(D=f?Xs(f):window,e){case"focusin":(z1(D)||D.contentEditable==="true")&&(Gs=D,jd=f,xl=null);break;case"focusout":xl=jd=Gs=null;break;case"mousedown":Bd=!0;break;case"contextmenu":case"mouseup":case"dragend":Bd=!1,$1(m,r,h);break;case"selectionchange":if(rS)break;case"keydown":case"keyup":$1(m,r,h)}var P;if(ip)e:{switch(e){case"compositionstart":var W="onCompositionStart";break e;case"compositionend":W="onCompositionEnd";break e;case"compositionupdate":W="onCompositionUpdate";break e}W=void 0}else $s?s_(e,r)&&(W="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(W="onCompositionStart");W&&(i_&&r.locale!=="ko"&&($s||W!=="onCompositionStart"?W==="onCompositionEnd"&&$s&&(P=a_()):(pi=h,rp="value"in pi?pi.value:pi.textContent,$s=!0)),D=Hu(f,W),0<D.length&&(W=new D1(W,e,null,r,h),m.push({event:W,listeners:D}),P?W.data=P:(P=o_(r),P!==null&&(W.data=P)))),(P=W4?$4(e,r):G4(e,r))&&(f=Hu(f,"onBeforeInput"),0<f.length&&(h=new D1("onBeforeInput","beforeinput",null,r,h),m.push({event:h,listeners:f}),h.data=P))}__(m,t)})}function Ul(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Hu(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ml(e,r),i!=null&&n.unshift(Ul(e,i,a)),i=Ml(e,t),i!=null&&n.push(Ul(e,i,a))),e=e.return}return n}function Ds(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function X1(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,f=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&f!==null&&(l=f,a?(u=Ml(r,i),u!=null&&o.unshift(Ul(r,u,l))):a||(u=Ml(r,i),u!=null&&o.push(Ul(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var sS=/\r\n?/g,oS=/\u0000|\uFFFD/g;function q1(e){return(typeof e=="string"?e:""+e).replace(sS,`
`).replace(oS,"")}function Qc(e,t,r){if(t=q1(t),q1(e)!==t&&r)throw Error(be(425))}function Vu(){}var zd=null,Ud=null;function Hd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Vd=typeof setTimeout=="function"?setTimeout:void 0,lS=typeof clearTimeout=="function"?clearTimeout:void 0,Y1=typeof Promise=="function"?Promise:void 0,cS=typeof queueMicrotask=="function"?queueMicrotask:typeof Y1<"u"?function(e){return Y1.resolve(null).then(e).catch(uS)}:Vd;function uS(e){setTimeout(function(){throw e})}function G0(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Il(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Il(t)}function wi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function K1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var bo=Math.random().toString(36).slice(2),ga="__reactFiber$"+bo,Hl="__reactProps$"+bo,Ga="__reactContainer$"+bo,Wd="__reactEvents$"+bo,fS="__reactListeners$"+bo,dS="__reactHandles$"+bo;function qi(e){var t=e[ga];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ga]||r[ga]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=K1(e);e!==null;){if(r=e[ga])return r;e=K1(e)}return t}e=r,r=e.parentNode}return null}function lc(e){return e=e[ga]||e[Ga],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Xs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(be(33))}function Mf(e){return e[Hl]||null}var $d=[],qs=-1;function Mi(e){return{current:e}}function Rt(e){0>qs||(e.current=$d[qs],$d[qs]=null,qs--)}function Lt(e,t){qs++,$d[qs]=e.current,e.current=t}var Ai={},Ur=Mi(Ai),sn=Mi(!1),ls=Ai;function go(e,t){var r=e.type.contextTypes;if(!r)return Ai;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function on(e){return e=e.childContextTypes,e!=null}function Wu(){Rt(sn),Rt(Ur)}function J1(e,t,r){if(Ur.current!==Ai)throw Error(be(168));Lt(Ur,t),Lt(sn,r)}function w_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(be(108,YE(e)||"Unknown",a));return Wt({},r,n)}function $u(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ai,ls=Ur.current,Lt(Ur,e),Lt(sn,sn.current),!0}function Q1(e,t,r){var n=e.stateNode;if(!n)throw Error(be(169));r?(e=w_(e,t,ls),n.__reactInternalMemoizedMergedChildContext=e,Rt(sn),Rt(Ur),Lt(Ur,e)):Rt(sn),Lt(sn,r)}var Da=null,Rf=!1,Z0=!1;function k_(e){Da===null?Da=[e]:Da.push(e)}function hS(e){Rf=!0,k_(e)}function Ri(){if(!Z0&&Da!==null){Z0=!0;var e=0,t=bt;try{var r=Da;for(bt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Da=null,Rf=!1}catch(a){throw Da!==null&&(Da=Da.slice(e+1)),Zv(Jh,Ri),a}finally{bt=t,Z0=!1}}return null}var Ys=[],Ks=0,Gu=null,Zu=0,Nn=[],An=0,cs=null,Ia=1,ja="";function Vi(e,t){Ys[Ks++]=Zu,Ys[Ks++]=Gu,Gu=e,Zu=t}function E_(e,t,r){Nn[An++]=Ia,Nn[An++]=ja,Nn[An++]=cs,cs=e;var n=Ia;e=ja;var a=32-Yn(n)-1;n&=~(1<<a),r+=1;var i=32-Yn(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Ia=1<<32-Yn(t)+a|r<<a|n,ja=i+e}else Ia=1<<i|r<<a|n,ja=e}function op(e){e.return!==null&&(Vi(e,1),E_(e,1,0))}function lp(e){for(;e===Gu;)Gu=Ys[--Ks],Ys[Ks]=null,Zu=Ys[--Ks],Ys[Ks]=null;for(;e===cs;)cs=Nn[--An],Nn[An]=null,ja=Nn[--An],Nn[An]=null,Ia=Nn[--An],Nn[An]=null}var gn=null,mn=null,It=!1,Gn=null;function S_(e,t){var r=Pn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function eg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,gn=e,mn=wi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,gn=e,mn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=cs!==null?{id:Ia,overflow:ja}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Pn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,gn=e,mn=null,!0):!1;default:return!1}}function Gd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zd(e){if(It){var t=mn;if(t){var r=t;if(!eg(e,t)){if(Gd(e))throw Error(be(418));t=wi(r.nextSibling);var n=gn;t&&eg(e,t)?S_(n,r):(e.flags=e.flags&-4097|2,It=!1,gn=e)}}else{if(Gd(e))throw Error(be(418));e.flags=e.flags&-4097|2,It=!1,gn=e}}}function tg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;gn=e}function eu(e){if(e!==gn)return!1;if(!It)return tg(e),It=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Hd(e.type,e.memoizedProps)),t&&(t=mn)){if(Gd(e))throw T_(),Error(be(418));for(;t;)S_(e,t),t=wi(t.nextSibling)}if(tg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(be(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){mn=wi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}mn=null}}else mn=gn?wi(e.stateNode.nextSibling):null;return!0}function T_(){for(var e=mn;e;)e=wi(e.nextSibling)}function xo(){mn=gn=null,It=!1}function cp(e){Gn===null?Gn=[e]:Gn.push(e)}var pS=Ja.ReactCurrentBatchConfig;function Jo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(be(309));var n=r.stateNode}if(!n)throw Error(be(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(be(284));if(!r._owner)throw Error(be(290,e))}return e}function tu(e,t){throw e=Object.prototype.toString.call(t),Error(be(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rg(e){var t=e._init;return t(e._payload)}function C_(e){function t(k,S){if(e){var w=k.deletions;w===null?(k.deletions=[S],k.flags|=16):w.push(S)}}function r(k,S){if(!e)return null;for(;S!==null;)t(k,S),S=S.sibling;return null}function n(k,S){for(k=new Map;S!==null;)S.key!==null?k.set(S.key,S):k.set(S.index,S),S=S.sibling;return k}function a(k,S){return k=Ti(k,S),k.index=0,k.sibling=null,k}function i(k,S,w){return k.index=w,e?(w=k.alternate,w!==null?(w=w.index,w<S?(k.flags|=2,S):w):(k.flags|=2,S)):(k.flags|=1048576,S)}function o(k){return e&&k.alternate===null&&(k.flags|=2),k}function l(k,S,w,A){return S===null||S.tag!==6?(S=ed(w,k.mode,A),S.return=k,S):(S=a(S,w),S.return=k,S)}function u(k,S,w,A){var I=w.type;return I===Ws?h(k,S,w.props.children,A,w.key):S!==null&&(S.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===oi&&rg(I)===S.type)?(A=a(S,w.props),A.ref=Jo(k,S,w),A.return=k,A):(A=Nu(w.type,w.key,w.props,null,k.mode,A),A.ref=Jo(k,S,w),A.return=k,A)}function f(k,S,w,A){return S===null||S.tag!==4||S.stateNode.containerInfo!==w.containerInfo||S.stateNode.implementation!==w.implementation?(S=td(w,k.mode,A),S.return=k,S):(S=a(S,w.children||[]),S.return=k,S)}function h(k,S,w,A,I){return S===null||S.tag!==7?(S=ns(w,k.mode,A,I),S.return=k,S):(S=a(S,w),S.return=k,S)}function m(k,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return S=ed(""+S,k.mode,w),S.return=k,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Wc:return w=Nu(S.type,S.key,S.props,null,k.mode,w),w.ref=Jo(k,null,S),w.return=k,w;case Vs:return S=td(S,k.mode,w),S.return=k,S;case oi:var A=S._init;return m(k,A(S._payload),w)}if(il(S)||Zo(S))return S=ns(S,k.mode,w,null),S.return=k,S;tu(k,S)}return null}function g(k,S,w,A){var I=S!==null?S.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return I!==null?null:l(k,S,""+w,A);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wc:return w.key===I?u(k,S,w,A):null;case Vs:return w.key===I?f(k,S,w,A):null;case oi:return I=w._init,g(k,S,I(w._payload),A)}if(il(w)||Zo(w))return I!==null?null:h(k,S,w,A,null);tu(k,w)}return null}function x(k,S,w,A,I){if(typeof A=="string"&&A!==""||typeof A=="number")return k=k.get(w)||null,l(S,k,""+A,I);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Wc:return k=k.get(A.key===null?w:A.key)||null,u(S,k,A,I);case Vs:return k=k.get(A.key===null?w:A.key)||null,f(S,k,A,I);case oi:var D=A._init;return x(k,S,w,D(A._payload),I)}if(il(A)||Zo(A))return k=k.get(w)||null,h(S,k,A,I,null);tu(S,A)}return null}function _(k,S,w,A){for(var I=null,D=null,P=S,W=S=0,j=null;P!==null&&W<w.length;W++){P.index>W?(j=P,P=null):j=P.sibling;var V=g(k,P,w[W],A);if(V===null){P===null&&(P=j);break}e&&P&&V.alternate===null&&t(k,P),S=i(V,S,W),D===null?I=V:D.sibling=V,D=V,P=j}if(W===w.length)return r(k,P),It&&Vi(k,W),I;if(P===null){for(;W<w.length;W++)P=m(k,w[W],A),P!==null&&(S=i(P,S,W),D===null?I=P:D.sibling=P,D=P);return It&&Vi(k,W),I}for(P=n(k,P);W<w.length;W++)j=x(P,k,W,w[W],A),j!==null&&(e&&j.alternate!==null&&P.delete(j.key===null?W:j.key),S=i(j,S,W),D===null?I=j:D.sibling=j,D=j);return e&&P.forEach(function(B){return t(k,B)}),It&&Vi(k,W),I}function y(k,S,w,A){var I=Zo(w);if(typeof I!="function")throw Error(be(150));if(w=I.call(w),w==null)throw Error(be(151));for(var D=I=null,P=S,W=S=0,j=null,V=w.next();P!==null&&!V.done;W++,V=w.next()){P.index>W?(j=P,P=null):j=P.sibling;var B=g(k,P,V.value,A);if(B===null){P===null&&(P=j);break}e&&P&&B.alternate===null&&t(k,P),S=i(B,S,W),D===null?I=B:D.sibling=B,D=B,P=j}if(V.done)return r(k,P),It&&Vi(k,W),I;if(P===null){for(;!V.done;W++,V=w.next())V=m(k,V.value,A),V!==null&&(S=i(V,S,W),D===null?I=V:D.sibling=V,D=V);return It&&Vi(k,W),I}for(P=n(k,P);!V.done;W++,V=w.next())V=x(P,k,W,V.value,A),V!==null&&(e&&V.alternate!==null&&P.delete(V.key===null?W:V.key),S=i(V,S,W),D===null?I=V:D.sibling=V,D=V);return e&&P.forEach(function(Z){return t(k,Z)}),It&&Vi(k,W),I}function E(k,S,w,A){if(typeof w=="object"&&w!==null&&w.type===Ws&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Wc:e:{for(var I=w.key,D=S;D!==null;){if(D.key===I){if(I=w.type,I===Ws){if(D.tag===7){r(k,D.sibling),S=a(D,w.props.children),S.return=k,k=S;break e}}else if(D.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===oi&&rg(I)===D.type){r(k,D.sibling),S=a(D,w.props),S.ref=Jo(k,D,w),S.return=k,k=S;break e}r(k,D);break}else t(k,D);D=D.sibling}w.type===Ws?(S=ns(w.props.children,k.mode,A,w.key),S.return=k,k=S):(A=Nu(w.type,w.key,w.props,null,k.mode,A),A.ref=Jo(k,S,w),A.return=k,k=A)}return o(k);case Vs:e:{for(D=w.key;S!==null;){if(S.key===D)if(S.tag===4&&S.stateNode.containerInfo===w.containerInfo&&S.stateNode.implementation===w.implementation){r(k,S.sibling),S=a(S,w.children||[]),S.return=k,k=S;break e}else{r(k,S);break}else t(k,S);S=S.sibling}S=td(w,k.mode,A),S.return=k,k=S}return o(k);case oi:return D=w._init,E(k,S,D(w._payload),A)}if(il(w))return _(k,S,w,A);if(Zo(w))return y(k,S,w,A);tu(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,S!==null&&S.tag===6?(r(k,S.sibling),S=a(S,w),S.return=k,k=S):(r(k,S),S=ed(w,k.mode,A),S.return=k,k=S),o(k)):r(k,S)}return E}var vo=C_(!0),b_=C_(!1),Xu=Mi(null),qu=null,Js=null,up=null;function fp(){up=Js=qu=null}function dp(e){var t=Xu.current;Rt(Xu),e._currentValue=t}function Xd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function lo(e,t){qu=e,up=Js=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(nn=!0),e.firstContext=null)}function On(e){var t=e._currentValue;if(up!==e)if(e={context:e,memoizedValue:t,next:null},Js===null){if(qu===null)throw Error(be(308));Js=e,qu.dependencies={lanes:0,firstContext:e}}else Js=Js.next=e;return t}var Yi=null;function hp(e){Yi===null?Yi=[e]:Yi.push(e)}function N_(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,hp(t)):(r.next=a.next,a.next=r),t.interleaved=r,Za(e,n)}function Za(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var li=!1;function pp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function A_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ua(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ki(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,yt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Za(e,r)}return a=n.interleaved,a===null?(t.next=t,hp(n)):(t.next=a.next,a.next=t),n.interleaved=t,Za(e,r)}function ku(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qh(e,r)}}function ng(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Yu(e,t,r,n){var a=e.updateQueue;li=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var u=l,f=u.next;u.next=null,o===null?i=f:o.next=f,o=u;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=f:l.next=f,h.lastBaseUpdate=u))}if(i!==null){var m=a.baseState;o=0,h=f=u=null,l=i;do{var g=l.lane,x=l.eventTime;if((n&g)===g){h!==null&&(h=h.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=e,y=l;switch(g=t,x=r,y.tag){case 1:if(_=y.payload,typeof _=="function"){m=_.call(x,m,g);break e}m=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=y.payload,g=typeof _=="function"?_.call(x,m,g):_,g==null)break e;m=Wt({},m,g);break e;case 2:li=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=a.effects,g===null?a.effects=[l]:g.push(l))}else x={eventTime:x,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(f=h=x,u=m):h=h.next=x,o|=g;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;g=l,l=g.next,g.next=null,a.lastBaseUpdate=g,a.shared.pending=null}}while(!0);if(h===null&&(u=m),a.baseState=u,a.firstBaseUpdate=f,a.lastBaseUpdate=h,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);fs|=o,e.lanes=o,e.memoizedState=m}}function ag(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(be(191,a));a.call(n)}}}var cc={},ya=Mi(cc),Vl=Mi(cc),Wl=Mi(cc);function Ki(e){if(e===cc)throw Error(be(174));return e}function mp(e,t){switch(Lt(Wl,t),Lt(Vl,e),Lt(ya,cc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Nd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Nd(t,e)}Rt(ya),Lt(ya,t)}function _o(){Rt(ya),Rt(Vl),Rt(Wl)}function L_(e){Ki(Wl.current);var t=Ki(ya.current),r=Nd(t,e.type);t!==r&&(Lt(Vl,e),Lt(ya,r))}function gp(e){Vl.current===e&&(Rt(ya),Rt(Vl))}var Ut=Mi(0);function Ku(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var X0=[];function xp(){for(var e=0;e<X0.length;e++)X0[e]._workInProgressVersionPrimary=null;X0.length=0}var Eu=Ja.ReactCurrentDispatcher,q0=Ja.ReactCurrentBatchConfig,us=0,Ht=null,lr=null,gr=null,Ju=!1,vl=!1,$l=0,mS=0;function Pr(){throw Error(be(321))}function vp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Qn(e[r],t[r]))return!1;return!0}function _p(e,t,r,n,a,i){if(us=i,Ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Eu.current=e===null||e.memoizedState===null?_S:yS,e=r(n,a),vl){i=0;do{if(vl=!1,$l=0,25<=i)throw Error(be(301));i+=1,gr=lr=null,t.updateQueue=null,Eu.current=wS,e=r(n,a)}while(vl)}if(Eu.current=Qu,t=lr!==null&&lr.next!==null,us=0,gr=lr=Ht=null,Ju=!1,t)throw Error(be(300));return e}function yp(){var e=$l!==0;return $l=0,e}function ha(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gr===null?Ht.memoizedState=gr=e:gr=gr.next=e,gr}function Mn(){if(lr===null){var e=Ht.alternate;e=e!==null?e.memoizedState:null}else e=lr.next;var t=gr===null?Ht.memoizedState:gr.next;if(t!==null)gr=t,lr=e;else{if(e===null)throw Error(be(310));lr=e,e={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},gr===null?Ht.memoizedState=gr=e:gr=gr.next=e}return gr}function Gl(e,t){return typeof t=="function"?t(e):t}function Y0(e){var t=Mn(),r=t.queue;if(r===null)throw Error(be(311));r.lastRenderedReducer=e;var n=lr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,u=null,f=i;do{var h=f.lane;if((us&h)===h)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var m={lane:h,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,Ht.lanes|=h,fs|=h}f=f.next}while(f!==null&&f!==i);u===null?o=n:u.next=l,Qn(n,t.memoizedState)||(nn=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Ht.lanes|=i,fs|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function K0(e){var t=Mn(),r=t.queue;if(r===null)throw Error(be(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Qn(i,t.memoizedState)||(nn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function P_(){}function F_(e,t){var r=Ht,n=Mn(),a=t(),i=!Qn(n.memoizedState,a);if(i&&(n.memoizedState=a,nn=!0),n=n.queue,wp(R_.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||gr!==null&&gr.memoizedState.tag&1){if(r.flags|=2048,Zl(9,M_.bind(null,r,n,a,t),void 0,null),xr===null)throw Error(be(349));us&30||O_(r,t,a)}return a}function O_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ht.updateQueue,t===null?(t={lastEffect:null,stores:null},Ht.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function M_(e,t,r,n){t.value=r,t.getSnapshot=n,D_(t)&&I_(e)}function R_(e,t,r){return r(function(){D_(t)&&I_(e)})}function D_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qn(e,r)}catch{return!0}}function I_(e){var t=Za(e,1);t!==null&&Kn(t,e,1,-1)}function ig(e){var t=ha();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:e},t.queue=e,e=e.dispatch=vS.bind(null,Ht,e),[t.memoizedState,e]}function Zl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ht.updateQueue,t===null?(t={lastEffect:null,stores:null},Ht.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function j_(){return Mn().memoizedState}function Su(e,t,r,n){var a=ha();Ht.flags|=e,a.memoizedState=Zl(1|t,r,void 0,n===void 0?null:n)}function Df(e,t,r,n){var a=Mn();n=n===void 0?null:n;var i=void 0;if(lr!==null){var o=lr.memoizedState;if(i=o.destroy,n!==null&&vp(n,o.deps)){a.memoizedState=Zl(t,r,i,n);return}}Ht.flags|=e,a.memoizedState=Zl(1|t,r,i,n)}function sg(e,t){return Su(8390656,8,e,t)}function wp(e,t){return Df(2048,8,e,t)}function B_(e,t){return Df(4,2,e,t)}function z_(e,t){return Df(4,4,e,t)}function U_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function H_(e,t,r){return r=r!=null?r.concat([e]):null,Df(4,4,U_.bind(null,t,e),r)}function kp(){}function V_(e,t){var r=Mn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&vp(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function W_(e,t){var r=Mn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&vp(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function $_(e,t,r){return us&21?(Qn(r,t)||(r=Yv(),Ht.lanes|=r,fs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,nn=!0),e.memoizedState=r)}function gS(e,t){var r=bt;bt=r!==0&&4>r?r:4,e(!0);var n=q0.transition;q0.transition={};try{e(!1),t()}finally{bt=r,q0.transition=n}}function G_(){return Mn().memoizedState}function xS(e,t,r){var n=Si(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Z_(e))X_(t,r);else if(r=N_(e,t,r,n),r!==null){var a=qr();Kn(r,e,n,a),q_(r,t,n)}}function vS(e,t,r){var n=Si(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Z_(e))X_(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,Qn(l,o)){var u=t.interleaved;u===null?(a.next=a,hp(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}r=N_(e,t,a,n),r!==null&&(a=qr(),Kn(r,e,n,a),q_(r,t,n))}}function Z_(e){var t=e.alternate;return e===Ht||t!==null&&t===Ht}function X_(e,t){vl=Ju=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function q_(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qh(e,r)}}var Qu={readContext:On,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},_S={readContext:On,useCallback:function(e,t){return ha().memoizedState=[e,t===void 0?null:t],e},useContext:On,useEffect:sg,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Su(4194308,4,U_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Su(4194308,4,e,t)},useInsertionEffect:function(e,t){return Su(4,2,e,t)},useMemo:function(e,t){var r=ha();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ha();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=xS.bind(null,Ht,e),[n.memoizedState,e]},useRef:function(e){var t=ha();return e={current:e},t.memoizedState=e},useState:ig,useDebugValue:kp,useDeferredValue:function(e){return ha().memoizedState=e},useTransition:function(){var e=ig(!1),t=e[0];return e=gS.bind(null,e[1]),ha().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ht,a=ha();if(It){if(r===void 0)throw Error(be(407));r=r()}else{if(r=t(),xr===null)throw Error(be(349));us&30||O_(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,sg(R_.bind(null,n,i,e),[e]),n.flags|=2048,Zl(9,M_.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=ha(),t=xr.identifierPrefix;if(It){var r=ja,n=Ia;r=(n&~(1<<32-Yn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=$l++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=mS++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},yS={readContext:On,useCallback:V_,useContext:On,useEffect:wp,useImperativeHandle:H_,useInsertionEffect:B_,useLayoutEffect:z_,useMemo:W_,useReducer:Y0,useRef:j_,useState:function(){return Y0(Gl)},useDebugValue:kp,useDeferredValue:function(e){var t=Mn();return $_(t,lr.memoizedState,e)},useTransition:function(){var e=Y0(Gl)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:P_,useSyncExternalStore:F_,useId:G_,unstable_isNewReconciler:!1},wS={readContext:On,useCallback:V_,useContext:On,useEffect:wp,useImperativeHandle:H_,useInsertionEffect:B_,useLayoutEffect:z_,useMemo:W_,useReducer:K0,useRef:j_,useState:function(){return K0(Gl)},useDebugValue:kp,useDeferredValue:function(e){var t=Mn();return lr===null?t.memoizedState=e:$_(t,lr.memoizedState,e)},useTransition:function(){var e=K0(Gl)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:P_,useSyncExternalStore:F_,useId:G_,unstable_isNewReconciler:!1};function Wn(e,t){if(e&&e.defaultProps){t=Wt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function qd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Wt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var If={isMounted:function(e){return(e=e._reactInternals)?_s(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qr(),a=Si(e),i=Ua(n,a);i.payload=t,r!=null&&(i.callback=r),t=ki(e,i,a),t!==null&&(Kn(t,e,a,n),ku(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qr(),a=Si(e),i=Ua(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ki(e,i,a),t!==null&&(Kn(t,e,a,n),ku(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qr(),n=Si(e),a=Ua(r,n);a.tag=2,t!=null&&(a.callback=t),t=ki(e,a,n),t!==null&&(Kn(t,e,n,r),ku(t,e,n))}};function og(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Bl(r,n)||!Bl(a,i):!0}function Y_(e,t,r){var n=!1,a=Ai,i=t.contextType;return typeof i=="object"&&i!==null?i=On(i):(a=on(t)?ls:Ur.current,n=t.contextTypes,i=(n=n!=null)?go(e,a):Ai),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=If,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function lg(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&If.enqueueReplaceState(t,t.state,null)}function Yd(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},pp(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=On(i):(i=on(t)?ls:Ur.current,a.context=go(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(qd(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&If.enqueueReplaceState(a,a.state,null),Yu(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function yo(e,t){try{var r="",n=t;do r+=qE(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function J0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Kd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var kS=typeof WeakMap=="function"?WeakMap:Map;function K_(e,t,r){r=Ua(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){tf||(tf=!0,oh=n),Kd(e,t)},r}function J_(e,t,r){r=Ua(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Kd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Kd(e,t),typeof n!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function cg(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new kS;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=DS.bind(null,e,t,r),t.then(e,e))}function ug(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fg(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ua(-1,1),t.tag=2,ki(r,t,1))),r.lanes|=1),e)}var ES=Ja.ReactCurrentOwner,nn=!1;function $r(e,t,r,n){t.child=e===null?b_(t,null,r,n):vo(t,e.child,r,n)}function dg(e,t,r,n,a){r=r.render;var i=t.ref;return lo(t,a),n=_p(e,t,r,n,i,a),r=yp(),e!==null&&!nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xa(e,t,a)):(It&&r&&op(t),t.flags|=1,$r(e,t,n,a),t.child)}function hg(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Lp(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Q_(e,t,i,n,a)):(e=Nu(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Bl,r(o,n)&&e.ref===t.ref)return Xa(e,t,a)}return t.flags|=1,e=Ti(i,n),e.ref=t.ref,e.return=t,t.child=e}function Q_(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Bl(i,n)&&e.ref===t.ref)if(nn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(nn=!0);else return t.lanes=e.lanes,Xa(e,t,a)}return Jd(e,t,r,n,a)}function ey(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(eo,dn),dn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Lt(eo,dn),dn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Lt(eo,dn),dn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Lt(eo,dn),dn|=n;return $r(e,t,a,r),t.child}function ty(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Jd(e,t,r,n,a){var i=on(r)?ls:Ur.current;return i=go(t,i),lo(t,a),r=_p(e,t,r,n,i,a),n=yp(),e!==null&&!nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xa(e,t,a)):(It&&n&&op(t),t.flags|=1,$r(e,t,r,a),t.child)}function pg(e,t,r,n,a){if(on(r)){var i=!0;$u(t)}else i=!1;if(lo(t,a),t.stateNode===null)Tu(e,t),Y_(t,r,n),Yd(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,f=r.contextType;typeof f=="object"&&f!==null?f=On(f):(f=on(r)?ls:Ur.current,f=go(t,f));var h=r.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==f)&&lg(t,o,n,f),li=!1;var g=t.memoizedState;o.state=g,Yu(t,n,o,a),u=t.memoizedState,l!==n||g!==u||sn.current||li?(typeof h=="function"&&(qd(t,r,h,n),u=t.memoizedState),(l=li||og(t,r,l,n,g,u,f))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=f,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,A_(e,t),l=t.memoizedProps,f=t.type===t.elementType?l:Wn(t.type,l),o.props=f,m=t.pendingProps,g=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=On(u):(u=on(r)?ls:Ur.current,u=go(t,u));var x=r.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==u)&&lg(t,o,n,u),li=!1,g=t.memoizedState,o.state=g,Yu(t,n,o,a);var _=t.memoizedState;l!==m||g!==_||sn.current||li?(typeof x=="function"&&(qd(t,r,x,n),_=t.memoizedState),(f=li||og(t,r,f,n,g,_,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,_,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,_,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=_),o.props=n,o.state=_,o.context=u,n=f):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return Qd(e,t,r,n,i,a)}function Qd(e,t,r,n,a,i){ty(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&Q1(t,r,!1),Xa(e,t,i);n=t.stateNode,ES.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=vo(t,e.child,null,i),t.child=vo(t,null,l,i)):$r(e,t,l,i),t.memoizedState=n.state,a&&Q1(t,r,!0),t.child}function ry(e){var t=e.stateNode;t.pendingContext?J1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&J1(e,t.context,!1),mp(e,t.containerInfo)}function mg(e,t,r,n,a){return xo(),cp(a),t.flags|=256,$r(e,t,r,n),t.child}var eh={dehydrated:null,treeContext:null,retryLane:0};function th(e){return{baseLanes:e,cachePool:null,transitions:null}}function ny(e,t,r){var n=t.pendingProps,a=Ut.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Lt(Ut,a&1),e===null)return Zd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=zf(o,n,0,null),e=ns(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=th(r),t.memoizedState=eh,e):Ep(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return SS(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Ti(a,u),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Ti(l,i):(i=ns(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?th(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=eh,n}return i=e.child,e=i.sibling,n=Ti(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ep(e,t){return t=zf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ru(e,t,r,n){return n!==null&&cp(n),vo(t,e.child,null,r),e=Ep(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function SS(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=J0(Error(be(422))),ru(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=zf({mode:"visible",children:n.children},a,0,null),i=ns(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&vo(t,e.child,null,o),t.child.memoizedState=th(o),t.memoizedState=eh,i);if(!(t.mode&1))return ru(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(be(419)),n=J0(i,n,void 0),ru(e,t,o,n)}if(l=(o&e.childLanes)!==0,nn||l){if(n=xr,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Za(e,a),Kn(n,e,a,-1))}return Ap(),n=J0(Error(be(421))),ru(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=IS.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,mn=wi(a.nextSibling),gn=t,It=!0,Gn=null,e!==null&&(Nn[An++]=Ia,Nn[An++]=ja,Nn[An++]=cs,Ia=e.id,ja=e.overflow,cs=t),t=Ep(t,n.children),t.flags|=4096,t)}function gg(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Xd(e.return,t,r)}function Q0(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function ay(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if($r(e,t,n.children,r),n=Ut.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gg(e,r,t);else if(e.tag===19)gg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Lt(Ut,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Ku(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Q0(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ku(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Q0(t,!0,r,null,i);break;case"together":Q0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Tu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),fs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(be(153));if(t.child!==null){for(e=t.child,r=Ti(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ti(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function TS(e,t,r){switch(t.tag){case 3:ry(t),xo();break;case 5:L_(t);break;case 1:on(t.type)&&$u(t);break;case 4:mp(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Lt(Xu,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Lt(Ut,Ut.current&1),t.flags|=128,null):r&t.child.childLanes?ny(e,t,r):(Lt(Ut,Ut.current&1),e=Xa(e,t,r),e!==null?e.sibling:null);Lt(Ut,Ut.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return ay(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Lt(Ut,Ut.current),n)break;return null;case 22:case 23:return t.lanes=0,ey(e,t,r)}return Xa(e,t,r)}var iy,rh,sy,oy;iy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};rh=function(){};sy=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ki(ya.current);var i=null;switch(r){case"input":a=Sd(e,a),n=Sd(e,n),i=[];break;case"select":a=Wt({},a,{value:void 0}),n=Wt({},n,{value:void 0}),i=[];break;case"textarea":a=bd(e,a),n=bd(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Vu)}Ad(r,n);var o;r=null;for(f in a)if(!n.hasOwnProperty(f)&&a.hasOwnProperty(f)&&a[f]!=null)if(f==="style"){var l=a[f];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Fl.hasOwnProperty(f)?i||(i=[]):(i=i||[]).push(f,null));for(f in n){var u=n[f];if(l=a!=null?a[f]:void 0,n.hasOwnProperty(f)&&u!==l&&(u!=null||l!=null))if(f==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(i||(i=[]),i.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Fl.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Mt("scroll",e),i||l===u||(i=[])):(i=i||[]).push(f,u))}r&&(i=i||[]).push("style",r);var f=i;(t.updateQueue=f)&&(t.flags|=4)}};oy=function(e,t,r,n){r!==n&&(t.flags|=4)};function Qo(e,t){if(!It)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function CS(e,t,r){var n=t.pendingProps;switch(lp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(t),null;case 1:return on(t.type)&&Wu(),Fr(t),null;case 3:return n=t.stateNode,_o(),Rt(sn),Rt(Ur),xp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(eu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gn!==null&&(uh(Gn),Gn=null))),rh(e,t),Fr(t),null;case 5:gp(t);var a=Ki(Wl.current);if(r=t.type,e!==null&&t.stateNode!=null)sy(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(be(166));return Fr(t),null}if(e=Ki(ya.current),eu(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ga]=t,n[Hl]=i,e=(t.mode&1)!==0,r){case"dialog":Mt("cancel",n),Mt("close",n);break;case"iframe":case"object":case"embed":Mt("load",n);break;case"video":case"audio":for(a=0;a<ol.length;a++)Mt(ol[a],n);break;case"source":Mt("error",n);break;case"img":case"image":case"link":Mt("error",n),Mt("load",n);break;case"details":Mt("toggle",n);break;case"input":T1(n,i),Mt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Mt("invalid",n);break;case"textarea":b1(n,i),Mt("invalid",n)}Ad(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Qc(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Qc(n.textContent,l,e),a=["children",""+l]):Fl.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Mt("scroll",n)}switch(r){case"input":$c(n),C1(n,i,!0);break;case"textarea":$c(n),N1(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Vu)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Rv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[ga]=t,e[Hl]=n,iy(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ld(r,n),r){case"dialog":Mt("cancel",e),Mt("close",e),a=n;break;case"iframe":case"object":case"embed":Mt("load",e),a=n;break;case"video":case"audio":for(a=0;a<ol.length;a++)Mt(ol[a],e);a=n;break;case"source":Mt("error",e),a=n;break;case"img":case"image":case"link":Mt("error",e),Mt("load",e),a=n;break;case"details":Mt("toggle",e),a=n;break;case"input":T1(e,n),a=Sd(e,n),Mt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Wt({},n,{value:void 0}),Mt("invalid",e);break;case"textarea":b1(e,n),a=bd(e,n),Mt("invalid",e);break;default:a=n}Ad(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?jv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Dv(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Ol(e,u):typeof u=="number"&&Ol(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fl.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Mt("scroll",e):u!=null&&Zh(e,i,u,o))}switch(r){case"input":$c(e),C1(e,n,!1);break;case"textarea":$c(e),N1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ni(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?ao(e,!!n.multiple,i,!1):n.defaultValue!=null&&ao(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Vu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Fr(t),null;case 6:if(e&&t.stateNode!=null)oy(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(be(166));if(r=Ki(Wl.current),Ki(ya.current),eu(t)){if(n=t.stateNode,r=t.memoizedProps,n[ga]=t,(i=n.nodeValue!==r)&&(e=gn,e!==null))switch(e.tag){case 3:Qc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ga]=t,t.stateNode=n}return Fr(t),null;case 13:if(Rt(Ut),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(It&&mn!==null&&t.mode&1&&!(t.flags&128))T_(),xo(),t.flags|=98560,i=!1;else if(i=eu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(be(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(be(317));i[ga]=t}else xo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Fr(t),i=!1}else Gn!==null&&(uh(Gn),Gn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ut.current&1?cr===0&&(cr=3):Ap())),t.updateQueue!==null&&(t.flags|=4),Fr(t),null);case 4:return _o(),rh(e,t),e===null&&zl(t.stateNode.containerInfo),Fr(t),null;case 10:return dp(t.type._context),Fr(t),null;case 17:return on(t.type)&&Wu(),Fr(t),null;case 19:if(Rt(Ut),i=t.memoizedState,i===null)return Fr(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Qo(i,!1);else{if(cr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ku(e),o!==null){for(t.flags|=128,Qo(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Lt(Ut,Ut.current&1|2),t.child}e=e.sibling}i.tail!==null&&Jt()>wo&&(t.flags|=128,n=!0,Qo(i,!1),t.lanes=4194304)}else{if(!n)if(e=Ku(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Qo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!It)return Fr(t),null}else 2*Jt()-i.renderingStartTime>wo&&r!==1073741824&&(t.flags|=128,n=!0,Qo(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Jt(),t.sibling=null,r=Ut.current,Lt(Ut,n?r&1|2:r&1),t):(Fr(t),null);case 22:case 23:return Np(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?dn&1073741824&&(Fr(t),t.subtreeFlags&6&&(t.flags|=8192)):Fr(t),null;case 24:return null;case 25:return null}throw Error(be(156,t.tag))}function bS(e,t){switch(lp(t),t.tag){case 1:return on(t.type)&&Wu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _o(),Rt(sn),Rt(Ur),xp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return gp(t),null;case 13:if(Rt(Ut),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(be(340));xo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Rt(Ut),null;case 4:return _o(),null;case 10:return dp(t.type._context),null;case 22:case 23:return Np(),null;case 24:return null;default:return null}}var nu=!1,Dr=!1,NS=typeof WeakSet=="function"?WeakSet:Set,je=null;function Qs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Zt(e,t,n)}else r.current=null}function nh(e,t,r){try{r()}catch(n){Zt(e,t,n)}}var xg=!1;function AS(e,t){if(zd=zu,e=d_(),sp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,f=0,h=0,m=e,g=null;t:for(;;){for(var x;m!==r||a!==0&&m.nodeType!==3||(l=o+a),m!==i||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)g=m,m=x;for(;;){if(m===e)break t;if(g===r&&++f===a&&(l=o),g===i&&++h===n&&(u=o),(x=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=x}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ud={focusedElem:e,selectionRange:r},zu=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var _=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var y=_.memoizedProps,E=_.memoizedState,k=t.stateNode,S=k.getSnapshotBeforeUpdate(t.elementType===t.type?y:Wn(t.type,y),E);k.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(be(163))}}catch(A){Zt(t,t.return,A)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return _=xg,xg=!1,_}function _l(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&nh(t,r,i)}a=a.next}while(a!==n)}}function jf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ah(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ly(e){var t=e.alternate;t!==null&&(e.alternate=null,ly(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ga],delete t[Hl],delete t[Wd],delete t[fS],delete t[dS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function cy(e){return e.tag===5||e.tag===3||e.tag===4}function vg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ih(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Vu));else if(n!==4&&(e=e.child,e!==null))for(ih(e,t,r),e=e.sibling;e!==null;)ih(e,t,r),e=e.sibling}function sh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(sh(e,t,r),e=e.sibling;e!==null;)sh(e,t,r),e=e.sibling}var yr=null,$n=!1;function ai(e,t,r){for(r=r.child;r!==null;)uy(e,t,r),r=r.sibling}function uy(e,t,r){if(_a&&typeof _a.onCommitFiberUnmount=="function")try{_a.onCommitFiberUnmount(Lf,r)}catch{}switch(r.tag){case 5:Dr||Qs(r,t);case 6:var n=yr,a=$n;yr=null,ai(e,t,r),yr=n,$n=a,yr!==null&&($n?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&($n?(e=yr,r=r.stateNode,e.nodeType===8?G0(e.parentNode,r):e.nodeType===1&&G0(e,r),Il(e)):G0(yr,r.stateNode));break;case 4:n=yr,a=$n,yr=r.stateNode.containerInfo,$n=!0,ai(e,t,r),yr=n,$n=a;break;case 0:case 11:case 14:case 15:if(!Dr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&nh(r,t,o),a=a.next}while(a!==n)}ai(e,t,r);break;case 1:if(!Dr&&(Qs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Zt(r,t,l)}ai(e,t,r);break;case 21:ai(e,t,r);break;case 22:r.mode&1?(Dr=(n=Dr)||r.memoizedState!==null,ai(e,t,r),Dr=n):ai(e,t,r);break;default:ai(e,t,r)}}function _g(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new NS),t.forEach(function(n){var a=jS.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Un(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:yr=l.stateNode,$n=!1;break e;case 3:yr=l.stateNode.containerInfo,$n=!0;break e;case 4:yr=l.stateNode.containerInfo,$n=!0;break e}l=l.return}if(yr===null)throw Error(be(160));uy(i,o,a),yr=null,$n=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(f){Zt(a,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)fy(t,e),t=t.sibling}function fy(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Un(t,e),ca(e),n&4){try{_l(3,e,e.return),jf(3,e)}catch(y){Zt(e,e.return,y)}try{_l(5,e,e.return)}catch(y){Zt(e,e.return,y)}}break;case 1:Un(t,e),ca(e),n&512&&r!==null&&Qs(r,r.return);break;case 5:if(Un(t,e),ca(e),n&512&&r!==null&&Qs(r,r.return),e.flags&32){var a=e.stateNode;try{Ol(a,"")}catch(y){Zt(e,e.return,y)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Ov(a,i),Ld(l,o);var f=Ld(l,i);for(o=0;o<u.length;o+=2){var h=u[o],m=u[o+1];h==="style"?jv(a,m):h==="dangerouslySetInnerHTML"?Dv(a,m):h==="children"?Ol(a,m):Zh(a,h,m,f)}switch(l){case"input":Td(a,i);break;case"textarea":Mv(a,i);break;case"select":var g=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?ao(a,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?ao(a,!!i.multiple,i.defaultValue,!0):ao(a,!!i.multiple,i.multiple?[]:"",!1))}a[Hl]=i}catch(y){Zt(e,e.return,y)}}break;case 6:if(Un(t,e),ca(e),n&4){if(e.stateNode===null)throw Error(be(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(y){Zt(e,e.return,y)}}break;case 3:if(Un(t,e),ca(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Il(t.containerInfo)}catch(y){Zt(e,e.return,y)}break;case 4:Un(t,e),ca(e);break;case 13:Un(t,e),ca(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Cp=Jt())),n&4&&_g(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(Dr=(f=Dr)||h,Un(t,e),Dr=f):Un(t,e),ca(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!h&&e.mode&1)for(je=e,h=e.child;h!==null;){for(m=je=h;je!==null;){switch(g=je,x=g.child,g.tag){case 0:case 11:case 14:case 15:_l(4,g,g.return);break;case 1:Qs(g,g.return);var _=g.stateNode;if(typeof _.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(y){Zt(n,r,y)}}break;case 5:Qs(g,g.return);break;case 22:if(g.memoizedState!==null){wg(m);continue}}x!==null?(x.return=g,je=x):wg(m)}h=h.sibling}e:for(h=null,m=e;;){if(m.tag===5){if(h===null){h=m;try{a=m.stateNode,f?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Iv("display",o))}catch(y){Zt(e,e.return,y)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(y){Zt(e,e.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Un(t,e),ca(e),n&4&&_g(e);break;case 21:break;default:Un(t,e),ca(e)}}function ca(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(cy(r)){var n=r;break e}r=r.return}throw Error(be(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ol(a,""),n.flags&=-33);var i=vg(e);sh(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=vg(e);ih(e,l,o);break;default:throw Error(be(161))}}catch(u){Zt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function LS(e,t,r){je=e,dy(e)}function dy(e,t,r){for(var n=(e.mode&1)!==0;je!==null;){var a=je,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||nu;if(!o){var l=a.alternate,u=l!==null&&l.memoizedState!==null||Dr;l=nu;var f=Dr;if(nu=o,(Dr=u)&&!f)for(je=a;je!==null;)o=je,u=o.child,o.tag===22&&o.memoizedState!==null?kg(a):u!==null?(u.return=o,je=u):kg(a);for(;i!==null;)je=i,dy(i),i=i.sibling;je=a,nu=l,Dr=f}yg(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,je=i):yg(e)}}function yg(e){for(;je!==null;){var t=je;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Dr||jf(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Dr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Wn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&ag(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ag(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var h=f.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Il(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(be(163))}Dr||t.flags&512&&ah(t)}catch(g){Zt(t,t.return,g)}}if(t===e){je=null;break}if(r=t.sibling,r!==null){r.return=t.return,je=r;break}je=t.return}}function wg(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var r=t.sibling;if(r!==null){r.return=t.return,je=r;break}je=t.return}}function kg(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{jf(4,t)}catch(u){Zt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(u){Zt(t,a,u)}}var i=t.return;try{ah(t)}catch(u){Zt(t,i,u)}break;case 5:var o=t.return;try{ah(t)}catch(u){Zt(t,o,u)}}}catch(u){Zt(t,t.return,u)}if(t===e){je=null;break}var l=t.sibling;if(l!==null){l.return=t.return,je=l;break}je=t.return}}var PS=Math.ceil,ef=Ja.ReactCurrentDispatcher,Sp=Ja.ReactCurrentOwner,Fn=Ja.ReactCurrentBatchConfig,yt=0,xr=null,ir=null,Sr=0,dn=0,eo=Mi(0),cr=0,Xl=null,fs=0,Bf=0,Tp=0,yl=null,rn=null,Cp=0,wo=1/0,Oa=null,tf=!1,oh=null,Ei=null,au=!1,mi=null,rf=0,wl=0,lh=null,Cu=-1,bu=0;function qr(){return yt&6?Jt():Cu!==-1?Cu:Cu=Jt()}function Si(e){return e.mode&1?yt&2&&Sr!==0?Sr&-Sr:pS.transition!==null?(bu===0&&(bu=Yv()),bu):(e=bt,e!==0||(e=window.event,e=e===void 0?16:n_(e.type)),e):1}function Kn(e,t,r,n){if(50<wl)throw wl=0,lh=null,Error(be(185));sc(e,r,n),(!(yt&2)||e!==xr)&&(e===xr&&(!(yt&2)&&(Bf|=r),cr===4&&ui(e,Sr)),ln(e,n),r===1&&yt===0&&!(t.mode&1)&&(wo=Jt()+500,Rf&&Ri()))}function ln(e,t){var r=e.callbackNode;p4(e,t);var n=Bu(e,e===xr?Sr:0);if(n===0)r!==null&&P1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&P1(r),t===1)e.tag===0?hS(Eg.bind(null,e)):k_(Eg.bind(null,e)),cS(function(){!(yt&6)&&Ri()}),r=null;else{switch(Kv(n)){case 1:r=Jh;break;case 4:r=Xv;break;case 16:r=ju;break;case 536870912:r=qv;break;default:r=ju}r=yy(r,hy.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function hy(e,t){if(Cu=-1,bu=0,yt&6)throw Error(be(327));var r=e.callbackNode;if(co()&&e.callbackNode!==r)return null;var n=Bu(e,e===xr?Sr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=nf(e,n);else{t=n;var a=yt;yt|=2;var i=my();(xr!==e||Sr!==t)&&(Oa=null,wo=Jt()+500,rs(e,t));do try{MS();break}catch(l){py(e,l)}while(!0);fp(),ef.current=i,yt=a,ir!==null?t=0:(xr=null,Sr=0,t=cr)}if(t!==0){if(t===2&&(a=Rd(e),a!==0&&(n=a,t=ch(e,a))),t===1)throw r=Xl,rs(e,0),ui(e,n),ln(e,Jt()),r;if(t===6)ui(e,n);else{if(a=e.current.alternate,!(n&30)&&!FS(a)&&(t=nf(e,n),t===2&&(i=Rd(e),i!==0&&(n=i,t=ch(e,i))),t===1))throw r=Xl,rs(e,0),ui(e,n),ln(e,Jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(be(345));case 2:Wi(e,rn,Oa);break;case 3:if(ui(e,n),(n&130023424)===n&&(t=Cp+500-Jt(),10<t)){if(Bu(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){qr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Vd(Wi.bind(null,e,rn,Oa),t);break}Wi(e,rn,Oa);break;case 4:if(ui(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Yn(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*PS(n/1960))-n,10<n){e.timeoutHandle=Vd(Wi.bind(null,e,rn,Oa),n);break}Wi(e,rn,Oa);break;case 5:Wi(e,rn,Oa);break;default:throw Error(be(329))}}}return ln(e,Jt()),e.callbackNode===r?hy.bind(null,e):null}function ch(e,t){var r=yl;return e.current.memoizedState.isDehydrated&&(rs(e,t).flags|=256),e=nf(e,t),e!==2&&(t=rn,rn=r,t!==null&&uh(t)),e}function uh(e){rn===null?rn=e:rn.push.apply(rn,e)}function FS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Qn(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ui(e,t){for(t&=~Tp,t&=~Bf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Yn(t),n=1<<r;e[r]=-1,t&=~n}}function Eg(e){if(yt&6)throw Error(be(327));co();var t=Bu(e,0);if(!(t&1))return ln(e,Jt()),null;var r=nf(e,t);if(e.tag!==0&&r===2){var n=Rd(e);n!==0&&(t=n,r=ch(e,n))}if(r===1)throw r=Xl,rs(e,0),ui(e,t),ln(e,Jt()),r;if(r===6)throw Error(be(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Wi(e,rn,Oa),ln(e,Jt()),null}function bp(e,t){var r=yt;yt|=1;try{return e(t)}finally{yt=r,yt===0&&(wo=Jt()+500,Rf&&Ri())}}function ds(e){mi!==null&&mi.tag===0&&!(yt&6)&&co();var t=yt;yt|=1;var r=Fn.transition,n=bt;try{if(Fn.transition=null,bt=1,e)return e()}finally{bt=n,Fn.transition=r,yt=t,!(yt&6)&&Ri()}}function Np(){dn=eo.current,Rt(eo)}function rs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,lS(r)),ir!==null)for(r=ir.return;r!==null;){var n=r;switch(lp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Wu();break;case 3:_o(),Rt(sn),Rt(Ur),xp();break;case 5:gp(n);break;case 4:_o();break;case 13:Rt(Ut);break;case 19:Rt(Ut);break;case 10:dp(n.type._context);break;case 22:case 23:Np()}r=r.return}if(xr=e,ir=e=Ti(e.current,null),Sr=dn=t,cr=0,Xl=null,Tp=Bf=fs=0,rn=yl=null,Yi!==null){for(t=0;t<Yi.length;t++)if(r=Yi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Yi=null}return e}function py(e,t){do{var r=ir;try{if(fp(),Eu.current=Qu,Ju){for(var n=Ht.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Ju=!1}if(us=0,gr=lr=Ht=null,vl=!1,$l=0,Sp.current=null,r===null||r.return===null){cr=1,Xl=t,ir=null;break}e:{var i=e,o=r.return,l=r,u=t;if(t=Sr,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,h=l,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=ug(o);if(x!==null){x.flags&=-257,fg(x,o,l,i,t),x.mode&1&&cg(i,f,t),t=x,u=f;var _=t.updateQueue;if(_===null){var y=new Set;y.add(u),t.updateQueue=y}else _.add(u);break e}else{if(!(t&1)){cg(i,f,t),Ap();break e}u=Error(be(426))}}else if(It&&l.mode&1){var E=ug(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),fg(E,o,l,i,t),cp(yo(u,l));break e}}i=u=yo(u,l),cr!==4&&(cr=2),yl===null?yl=[i]:yl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var k=K_(i,u,t);ng(i,k);break e;case 1:l=u;var S=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof S.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ei===null||!Ei.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var A=J_(i,l,t);ng(i,A);break e}}i=i.return}while(i!==null)}xy(r)}catch(I){t=I,ir===r&&r!==null&&(ir=r=r.return);continue}break}while(!0)}function my(){var e=ef.current;return ef.current=Qu,e===null?Qu:e}function Ap(){(cr===0||cr===3||cr===2)&&(cr=4),xr===null||!(fs&268435455)&&!(Bf&268435455)||ui(xr,Sr)}function nf(e,t){var r=yt;yt|=2;var n=my();(xr!==e||Sr!==t)&&(Oa=null,rs(e,t));do try{OS();break}catch(a){py(e,a)}while(!0);if(fp(),yt=r,ef.current=n,ir!==null)throw Error(be(261));return xr=null,Sr=0,cr}function OS(){for(;ir!==null;)gy(ir)}function MS(){for(;ir!==null&&!i4();)gy(ir)}function gy(e){var t=_y(e.alternate,e,dn);e.memoizedProps=e.pendingProps,t===null?xy(e):ir=t,Sp.current=null}function xy(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=bS(r,t),r!==null){r.flags&=32767,ir=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cr=6,ir=null;return}}else if(r=CS(r,t,dn),r!==null){ir=r;return}if(t=t.sibling,t!==null){ir=t;return}ir=t=e}while(t!==null);cr===0&&(cr=5)}function Wi(e,t,r){var n=bt,a=Fn.transition;try{Fn.transition=null,bt=1,RS(e,t,r,n)}finally{Fn.transition=a,bt=n}return null}function RS(e,t,r,n){do co();while(mi!==null);if(yt&6)throw Error(be(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(be(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(m4(e,i),e===xr&&(ir=xr=null,Sr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||au||(au=!0,yy(ju,function(){return co(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Fn.transition,Fn.transition=null;var o=bt;bt=1;var l=yt;yt|=4,Sp.current=null,AS(e,r),fy(r,e),tS(Ud),zu=!!zd,Ud=zd=null,e.current=r,LS(r),s4(),yt=l,bt=o,Fn.transition=i}else e.current=r;if(au&&(au=!1,mi=e,rf=a),i=e.pendingLanes,i===0&&(Ei=null),c4(r.stateNode),ln(e,Jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(tf)throw tf=!1,e=oh,oh=null,e;return rf&1&&e.tag!==0&&co(),i=e.pendingLanes,i&1?e===lh?wl++:(wl=0,lh=e):wl=0,Ri(),null}function co(){if(mi!==null){var e=Kv(rf),t=Fn.transition,r=bt;try{if(Fn.transition=null,bt=16>e?16:e,mi===null)var n=!1;else{if(e=mi,mi=null,rf=0,yt&6)throw Error(be(331));var a=yt;for(yt|=4,je=e.current;je!==null;){var i=je,o=i.child;if(je.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var f=l[u];for(je=f;je!==null;){var h=je;switch(h.tag){case 0:case 11:case 15:_l(8,h,i)}var m=h.child;if(m!==null)m.return=h,je=m;else for(;je!==null;){h=je;var g=h.sibling,x=h.return;if(ly(h),h===f){je=null;break}if(g!==null){g.return=x,je=g;break}je=x}}}var _=i.alternate;if(_!==null){var y=_.child;if(y!==null){_.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}je=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,je=o;else e:for(;je!==null;){if(i=je,i.flags&2048)switch(i.tag){case 0:case 11:case 15:_l(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,je=k;break e}je=i.return}}var S=e.current;for(je=S;je!==null;){o=je;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,je=w;else e:for(o=S;je!==null;){if(l=je,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:jf(9,l)}}catch(I){Zt(l,l.return,I)}if(l===o){je=null;break e}var A=l.sibling;if(A!==null){A.return=l.return,je=A;break e}je=l.return}}if(yt=a,Ri(),_a&&typeof _a.onPostCommitFiberRoot=="function")try{_a.onPostCommitFiberRoot(Lf,e)}catch{}n=!0}return n}finally{bt=r,Fn.transition=t}}return!1}function Sg(e,t,r){t=yo(r,t),t=K_(e,t,1),e=ki(e,t,1),t=qr(),e!==null&&(sc(e,1,t),ln(e,t))}function Zt(e,t,r){if(e.tag===3)Sg(e,e,r);else for(;t!==null;){if(t.tag===3){Sg(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ei===null||!Ei.has(n))){e=yo(r,e),e=J_(t,e,1),t=ki(t,e,1),e=qr(),t!==null&&(sc(t,1,e),ln(t,e));break}}t=t.return}}function DS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=qr(),e.pingedLanes|=e.suspendedLanes&r,xr===e&&(Sr&r)===r&&(cr===4||cr===3&&(Sr&130023424)===Sr&&500>Jt()-Cp?rs(e,0):Tp|=r),ln(e,t)}function vy(e,t){t===0&&(e.mode&1?(t=Xc,Xc<<=1,!(Xc&130023424)&&(Xc=4194304)):t=1);var r=qr();e=Za(e,t),e!==null&&(sc(e,t,r),ln(e,r))}function IS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),vy(e,r)}function jS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(be(314))}n!==null&&n.delete(t),vy(e,r)}var _y;_y=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||sn.current)nn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return nn=!1,TS(e,t,r);nn=!!(e.flags&131072)}else nn=!1,It&&t.flags&1048576&&E_(t,Zu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Tu(e,t),e=t.pendingProps;var a=go(t,Ur.current);lo(t,r),a=_p(null,t,n,e,a,r);var i=yp();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,on(n)?(i=!0,$u(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,pp(t),a.updater=If,t.stateNode=a,a._reactInternals=t,Yd(t,n,e,r),t=Qd(null,t,n,!0,i,r)):(t.tag=0,It&&i&&op(t),$r(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Tu(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=zS(n),e=Wn(n,e),a){case 0:t=Jd(null,t,n,e,r);break e;case 1:t=pg(null,t,n,e,r);break e;case 11:t=dg(null,t,n,e,r);break e;case 14:t=hg(null,t,n,Wn(n.type,e),r);break e}throw Error(be(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),Jd(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),pg(e,t,n,a,r);case 3:e:{if(ry(t),e===null)throw Error(be(387));n=t.pendingProps,i=t.memoizedState,a=i.element,A_(e,t),Yu(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=yo(Error(be(423)),t),t=mg(e,t,n,r,a);break e}else if(n!==a){a=yo(Error(be(424)),t),t=mg(e,t,n,r,a);break e}else for(mn=wi(t.stateNode.containerInfo.firstChild),gn=t,It=!0,Gn=null,r=b_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(xo(),n===a){t=Xa(e,t,r);break e}$r(e,t,n,r)}t=t.child}return t;case 5:return L_(t),e===null&&Zd(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,Hd(n,a)?o=null:i!==null&&Hd(n,i)&&(t.flags|=32),ty(e,t),$r(e,t,o,r),t.child;case 6:return e===null&&Zd(t),null;case 13:return ny(e,t,r);case 4:return mp(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=vo(t,null,n,r):$r(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),dg(e,t,n,a,r);case 7:return $r(e,t,t.pendingProps,r),t.child;case 8:return $r(e,t,t.pendingProps.children,r),t.child;case 12:return $r(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Lt(Xu,n._currentValue),n._currentValue=o,i!==null)if(Qn(i.value,o)){if(i.children===a.children&&!sn.current){t=Xa(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=Ua(-1,r&-r),u.tag=2;var f=i.updateQueue;if(f!==null){f=f.shared;var h=f.pending;h===null?u.next=u:(u.next=h.next,h.next=u),f.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Xd(i.return,r,t),l.lanes|=r;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(be(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Xd(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}$r(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,lo(t,r),a=On(a),n=n(a),t.flags|=1,$r(e,t,n,r),t.child;case 14:return n=t.type,a=Wn(n,t.pendingProps),a=Wn(n.type,a),hg(e,t,n,a,r);case 15:return Q_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Wn(n,a),Tu(e,t),t.tag=1,on(n)?(e=!0,$u(t)):e=!1,lo(t,r),Y_(t,n,a),Yd(t,n,a,r),Qd(null,t,n,!0,e,r);case 19:return ay(e,t,r);case 22:return ey(e,t,r)}throw Error(be(156,t.tag))};function yy(e,t){return Zv(e,t)}function BS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(e,t,r,n){return new BS(e,t,r,n)}function Lp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zS(e){if(typeof e=="function")return Lp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===qh)return 11;if(e===Yh)return 14}return 2}function Ti(e,t){var r=e.alternate;return r===null?(r=Pn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Nu(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")Lp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ws:return ns(r.children,a,i,t);case Xh:o=8,a|=8;break;case yd:return e=Pn(12,r,t,a|2),e.elementType=yd,e.lanes=i,e;case wd:return e=Pn(13,r,t,a),e.elementType=wd,e.lanes=i,e;case kd:return e=Pn(19,r,t,a),e.elementType=kd,e.lanes=i,e;case Lv:return zf(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Nv:o=10;break e;case Av:o=9;break e;case qh:o=11;break e;case Yh:o=14;break e;case oi:o=16,n=null;break e}throw Error(be(130,e==null?e:typeof e,""))}return t=Pn(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function ns(e,t,r,n){return e=Pn(7,e,n,t),e.lanes=r,e}function zf(e,t,r,n){return e=Pn(22,e,n,t),e.elementType=Lv,e.lanes=r,e.stateNode={isHidden:!1},e}function ed(e,t,r){return e=Pn(6,e,null,t),e.lanes=r,e}function td(e,t,r){return t=Pn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function US(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=R0(0),this.expirationTimes=R0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=R0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Pp(e,t,r,n,a,i,o,l,u){return e=new US(e,t,r,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Pn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},pp(i),e}function HS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function wy(e){if(!e)return Ai;e=e._reactInternals;e:{if(_s(e)!==e||e.tag!==1)throw Error(be(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(on(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(be(171))}if(e.tag===1){var r=e.type;if(on(r))return w_(e,r,t)}return t}function ky(e,t,r,n,a,i,o,l,u){return e=Pp(r,n,!0,e,a,i,o,l,u),e.context=wy(null),r=e.current,n=qr(),a=Si(r),i=Ua(n,a),i.callback=t??null,ki(r,i,a),e.current.lanes=a,sc(e,a,n),ln(e,n),e}function Uf(e,t,r,n){var a=t.current,i=qr(),o=Si(a);return r=wy(r),t.context===null?t.context=r:t.pendingContext=r,t=Ua(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ki(a,t,o),e!==null&&(Kn(e,a,o,i),ku(e,a,o)),o}function af(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Tg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Fp(e,t){Tg(e,t),(e=e.alternate)&&Tg(e,t)}function VS(){return null}var Ey=typeof reportError=="function"?reportError:function(e){console.error(e)};function Op(e){this._internalRoot=e}Hf.prototype.render=Op.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(be(409));Uf(e,t,null,null)};Hf.prototype.unmount=Op.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ds(function(){Uf(null,e,null,null)}),t[Ga]=null}};function Hf(e){this._internalRoot=e}Hf.prototype.unstable_scheduleHydration=function(e){if(e){var t=e_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ci.length&&t!==0&&t<ci[r].priority;r++);ci.splice(r,0,e),r===0&&r_(e)}};function Mp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Cg(){}function WS(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var f=af(o);i.call(f)}}var o=ky(t,n,e,0,null,!1,!1,"",Cg);return e._reactRootContainer=o,e[Ga]=o.current,zl(e.nodeType===8?e.parentNode:e),ds(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var f=af(u);l.call(f)}}var u=Pp(e,0,!1,null,null,!1,!1,"",Cg);return e._reactRootContainer=u,e[Ga]=u.current,zl(e.nodeType===8?e.parentNode:e),ds(function(){Uf(t,u,r,n)}),u}function Wf(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var u=af(o);l.call(u)}}Uf(t,o,e,a)}else o=WS(r,t,e,a,n);return af(o)}Jv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=sl(t.pendingLanes);r!==0&&(Qh(t,r|1),ln(t,Jt()),!(yt&6)&&(wo=Jt()+500,Ri()))}break;case 13:ds(function(){var n=Za(e,1);if(n!==null){var a=qr();Kn(n,e,1,a)}}),Fp(e,1)}};ep=function(e){if(e.tag===13){var t=Za(e,134217728);if(t!==null){var r=qr();Kn(t,e,134217728,r)}Fp(e,134217728)}};Qv=function(e){if(e.tag===13){var t=Si(e),r=Za(e,t);if(r!==null){var n=qr();Kn(r,e,t,n)}Fp(e,t)}};e_=function(){return bt};t_=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}};Fd=function(e,t,r){switch(t){case"input":if(Td(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Mf(n);if(!a)throw Error(be(90));Fv(n),Td(n,a)}}}break;case"textarea":Mv(e,r);break;case"select":t=r.value,t!=null&&ao(e,!!r.multiple,t,!1)}};Uv=bp;Hv=ds;var $S={usingClientEntryPoint:!1,Events:[lc,Xs,Mf,Bv,zv,bp]},el={findFiberByHostInstance:qi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GS={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ja.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=$v(e),e===null?null:e.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||VS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{Lf=iu.inject(GS),_a=iu}catch{}}yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$S;yn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mp(t))throw Error(be(200));return HS(e,t,null,r)};yn.createRoot=function(e,t){if(!Mp(e))throw Error(be(299));var r=!1,n="",a=Ey;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Pp(e,1,!1,null,null,r,!1,n,a),e[Ga]=t.current,zl(e.nodeType===8?e.parentNode:e),new Op(t)};yn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(be(188)):(e=Object.keys(e).join(","),Error(be(268,e)));return e=$v(t),e=e===null?null:e.stateNode,e};yn.flushSync=function(e){return ds(e)};yn.hydrate=function(e,t,r){if(!Vf(t))throw Error(be(200));return Wf(null,e,t,!0,r)};yn.hydrateRoot=function(e,t,r){if(!Mp(e))throw Error(be(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=Ey;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=ky(t,null,e,1,r??null,a,!1,i,o),e[Ga]=t.current,zl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Hf(t)};yn.render=function(e,t,r){if(!Vf(t))throw Error(be(200));return Wf(null,e,t,!1,r)};yn.unmountComponentAtNode=function(e){if(!Vf(e))throw Error(be(40));return e._reactRootContainer?(ds(function(){Wf(null,null,e,!1,function(){e._reactRootContainer=null,e[Ga]=null})}),!0):!1};yn.unstable_batchedUpdates=bp;yn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Vf(r))throw Error(be(200));if(e==null||e._reactInternals===void 0)throw Error(be(38));return Wf(e,t,r,!1,n)};yn.version="18.3.1-next-f1338f8080-20240426";function Sy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sy)}catch(e){console.error(e)}}Sy(),Sv.exports=yn;var Ty=Sv.exports,bg=Ty;vd.createRoot=bg.createRoot,vd.hydrateRoot=bg.hydrateRoot;var Rp={};Object.defineProperty(Rp,"__esModule",{value:!0});Rp.parse=QS;Rp.serialize=eT;const ZS=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,XS=/^[\u0021-\u003A\u003C-\u007E]*$/,qS=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,YS=/^[\u0020-\u003A\u003D-\u007E]*$/,KS=Object.prototype.toString,JS=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function QS(e,t){const r=new JS,n=e.length;if(n<2)return r;const a=(t==null?void 0:t.decode)||tT;let i=0;do{const o=e.indexOf("=",i);if(o===-1)break;const l=e.indexOf(";",i),u=l===-1?n:l;if(o>u){i=e.lastIndexOf(";",o-1)+1;continue}const f=Ng(e,i,o),h=Ag(e,o,f),m=e.slice(f,h);if(r[m]===void 0){let g=Ng(e,o+1,u),x=Ag(e,u,g);const _=a(e.slice(g,x));r[m]=_}i=u+1}while(i<n);return r}function Ng(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function Ag(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function eT(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!ZS.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=n(t);if(!XS.test(a))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+a;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!qS.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!YS.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!rT(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function tT(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function rT(e){return KS.call(e)==="[object Date]"}/**
 * react-router v7.5.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nT(e={}){let{initialEntries:t=["/"],initialIndex:r,v5Compat:n=!1}=e,a;a=t.map((x,_)=>h(x,typeof x=="string"?null:x.state,_===0?"default":void 0));let i=u(r??a.length-1),o="POP",l=null;function u(x){return Math.min(Math.max(x,0),a.length-1)}function f(){return a[i]}function h(x,_=null,y){let E=iT(a?f().pathname:"/",x,_,y);return Rn(E.pathname.charAt(0)==="/",`relative pathnames are not supported in memory history: ${JSON.stringify(x)}`),E}function m(x){return typeof x=="string"?x:sf(x)}return{get index(){return i},get action(){return o},get location(){return f()},createHref:m,createURL(x){return new URL(m(x),"http://localhost")},encodeLocation(x){let _=typeof x=="string"?ys(x):x;return{pathname:_.pathname||"",search:_.search||"",hash:_.hash||""}},push(x,_){o="PUSH";let y=h(x,_);i+=1,a.splice(i,a.length,y),n&&l&&l({action:o,location:y,delta:1})},replace(x,_){o="REPLACE";let y=h(x,_);a[i]=y,n&&l&&l({action:o,location:y,delta:0})},go(x){o="POP";let _=u(i+x),y=a[_];i=_,l&&l({action:o,location:y,delta:x})},listen(x){return l=x,()=>{l=null}}}}function Vt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Rn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aT(){return Math.random().toString(36).substring(2,10)}function iT(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ys(t):t,state:r,key:t&&t.key||n||aT()}}function sf({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ys(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function Cy(e,t,r="/"){return sT(e,t,r,!1)}function sT(e,t,r,n){let a=typeof t=="string"?ys(t):t,i=qa(a.pathname||"/",r);if(i==null)return null;let o=by(e);oT(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let f=vT(i);l=gT(o[u],f,n)}return l}function by(e,t=[],r=[],n=""){let a=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Vt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let f=Ha([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(Vt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),by(i.children,t,h,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:pT(f,i.index),routesMeta:h})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let u of Ny(i.path))a(i,o,u)}),t}function Ny(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Ny(n.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function oT(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:mT(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var lT=/^:[\w-]+$/,cT=3,uT=2,fT=1,dT=10,hT=-2,Lg=e=>e==="*";function pT(e,t){let r=e.split("/"),n=r.length;return r.some(Lg)&&(n+=hT),t&&(n+=uT),r.filter(a=>!Lg(a)).reduce((a,i)=>a+(lT.test(i)?cT:i===""?fT:dT),n)}function mT(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function gT(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],f=l===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",m=of({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},h),g=u.route;if(!m&&f&&r&&!n[n.length-1].route.index&&(m=of({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!m)return null;Object.assign(a,m.params),o.push({params:a,pathname:Ha([i,m.pathname]),pathnameBase:kT(Ha([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=Ha([i,m.pathnameBase]))}return o}function of(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=xT(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:m},g)=>{if(h==="*"){let _=l[g]||"";o=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const x=l[g];return m&&!x?f[h]=void 0:f[h]=(x||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:o,pattern:e}}function xT(e,t=!1,r=!0){Rn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function vT(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Rn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function qa(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function _T(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?ys(e):e;return{pathname:r?r.startsWith("/")?r:yT(r,t):t,search:ET(n),hash:ST(a)}}function yT(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function rd(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Dp(e){let t=wT(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Ip(e,t,r,n=!1){let a;typeof e=="string"?a=ys(e):(a={...e},Vt(!a.pathname||!a.pathname.includes("?"),rd("?","pathname","search",a)),Vt(!a.pathname||!a.pathname.includes("#"),rd("#","pathname","hash",a)),Vt(!a.search||!a.search.includes("#"),rd("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;a.pathname=g.join("/")}l=m>=0?t[m]:"/"}let u=_T(a,l),f=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||h)&&(u.pathname+="/"),u}var Ha=e=>e.join("/").replace(/\/\/+/g,"/"),kT=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ET=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ST=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function TT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Ay=["POST","PUT","PATCH","DELETE"];new Set(Ay);var CT=["GET",...Ay];new Set(CT);var No=C.createContext(null);No.displayName="DataRouter";var $f=C.createContext(null);$f.displayName="DataRouterState";var Ly=C.createContext({isTransitioning:!1});Ly.displayName="ViewTransition";var bT=C.createContext(new Map);bT.displayName="Fetchers";var NT=C.createContext(null);NT.displayName="Await";var ea=C.createContext(null);ea.displayName="Navigation";var uc=C.createContext(null);uc.displayName="Location";var ta=C.createContext({outlet:null,matches:[],isDataRoute:!1});ta.displayName="Route";var jp=C.createContext(null);jp.displayName="RouteError";function AT(e,{relative:t}={}){Vt(Ao(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=C.useContext(ea),{hash:a,pathname:i,search:o}=fc(e,{relative:t}),l=i;return r!=="/"&&(l=i==="/"?r:Ha([r,i])),n.createHref({pathname:l,search:o,hash:a})}function Ao(){return C.useContext(uc)!=null}function Qa(){return Vt(Ao(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(uc).location}var Py="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Fy(e){C.useContext(ea).static||C.useLayoutEffect(e)}function ka(){let{isDataRoute:e}=C.useContext(ta);return e?VT():LT()}function LT(){Vt(Ao(),"useNavigate() may be used only in the context of a <Router> component.");let e=C.useContext(No),{basename:t,navigator:r}=C.useContext(ea),{matches:n}=C.useContext(ta),{pathname:a}=Qa(),i=JSON.stringify(Dp(n)),o=C.useRef(!1);return Fy(()=>{o.current=!0}),C.useCallback((u,f={})=>{if(Rn(o.current,Py),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=Ip(u,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ha([t,h.pathname])),(f.replace?r.replace:r.push)(h,f.state,f)},[t,r,i,a,e])}C.createContext(null);function PT(){let{matches:e}=C.useContext(ta),t=e[e.length-1];return t?t.params:{}}function fc(e,{relative:t}={}){let{matches:r}=C.useContext(ta),{pathname:n}=Qa(),a=JSON.stringify(Dp(r));return C.useMemo(()=>Ip(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function FT(e,t){return Oy(e,t)}function Oy(e,t,r,n){var S;Vt(Ao(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=C.useContext(ea),{matches:o}=C.useContext(ta),l=o[o.length-1],u=l?l.params:{},f=l?l.pathname:"/",h=l?l.pathnameBase:"/",m=l&&l.route;{let w=m&&m.path||"";My(f,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let g=Qa(),x;if(t){let w=typeof t=="string"?ys(t):t;Vt(h==="/"||((S=w.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${w.pathname}" was given in the \`location\` prop.`),x=w}else x=g;let _=x.pathname||"/",y=_;if(h!=="/"){let w=h.replace(/^\//,"").split("/");y="/"+_.replace(/^\//,"").split("/").slice(w.length).join("/")}let E=!i&&r&&r.matches&&r.matches.length>0?r.matches:Cy(e,{pathname:y});Rn(m||E!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),Rn(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=IT(E&&E.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:Ha([h,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?h:Ha([h,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n);return t&&k?C.createElement(uc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},k):k}function OT(){let e=HT(),t=TT(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:i},"ErrorBoundary")," or"," ",C.createElement("code",{style:i},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:a},r):null,o)}var MT=C.createElement(OT,null),RT=class extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(ta.Provider,{value:this.props.routeContext},C.createElement(jp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function DT({routeContext:e,match:t,children:r}){let n=C.useContext(No);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(ta.Provider,{value:e},r)}function IT(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let u=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);Vt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,l=-1;if(r)for(let u=0;u<a.length;u++){let f=a[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=u),f.route.id){let{loaderData:h,errors:m}=r,g=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((u,f,h)=>{let m,g=!1,x=null,_=null;r&&(m=i&&f.route.id?i[f.route.id]:void 0,x=f.route.errorElement||MT,o&&(l<0&&h===0?(My("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,_=null):l===h&&(g=!0,_=f.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,h+1)),E=()=>{let k;return m?k=x:g?k=_:f.route.Component?k=C.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=u,C.createElement(DT,{match:f,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:k})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?C.createElement(RT,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:E(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):E()},null)}function Bp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jT(e){let t=C.useContext(No);return Vt(t,Bp(e)),t}function BT(e){let t=C.useContext($f);return Vt(t,Bp(e)),t}function zT(e){let t=C.useContext(ta);return Vt(t,Bp(e)),t}function zp(e){let t=zT(e),r=t.matches[t.matches.length-1];return Vt(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function UT(){return zp("useRouteId")}function HT(){var n;let e=C.useContext(jp),t=BT("useRouteError"),r=zp("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function VT(){let{router:e}=jT("useNavigate"),t=zp("useNavigate"),r=C.useRef(!1);return Fy(()=>{r.current=!0}),C.useCallback(async(a,i={})=>{Rn(r.current,Py),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var Pg={};function My(e,t,r){!t&&!Pg[e]&&(Pg[e]=!0,Rn(!1,r))}C.memo(WT);function WT({routes:e,future:t,state:r}){return Oy(e,void 0,r,t)}function $T({basename:e,children:t,initialEntries:r,initialIndex:n}){let a=C.useRef();a.current==null&&(a.current=nT({initialEntries:r,initialIndex:n,v5Compat:!0}));let i=a.current,[o,l]=C.useState({action:i.action,location:i.location}),u=C.useCallback(f=>{C.startTransition(()=>l(f))},[l]);return C.useLayoutEffect(()=>i.listen(u),[i,u]),C.createElement(ZT,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i})}function GT({to:e,replace:t,state:r,relative:n}){Vt(Ao(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=C.useContext(ea);Rn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=C.useContext(ta),{pathname:o}=Qa(),l=ka(),u=Ip(e,Dp(i),o,n==="path"),f=JSON.stringify(u);return C.useEffect(()=>{l(JSON.parse(f),{replace:t,state:r,relative:n})},[l,f,n,t,r]),null}function Mr(e){Vt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ZT({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){Vt(!Ao(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=C.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof r=="string"&&(r=ys(r));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:g="default"}=r,x=C.useMemo(()=>{let _=qa(u,o);return _==null?null:{location:{pathname:_,search:f,hash:h,state:m,key:g},navigationType:n}},[o,u,f,h,m,g,n]);return Rn(x!=null,`<Router basename="${o}"> is not able to match the URL "${u}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:C.createElement(ea.Provider,{value:l},C.createElement(uc.Provider,{children:t,value:x}))}function XT({children:e,location:t}){return FT(fh(e),t)}function fh(e,t=[]){let r=[];return C.Children.forEach(e,(n,a)=>{if(!C.isValidElement(n))return;let i=[...t,a];if(n.type===C.Fragment){r.push.apply(r,fh(n.props.children,i));return}Vt(n.type===Mr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Vt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=fh(n.props.children,i)),r.push(o)}),r}var Au="get",Lu="application/x-www-form-urlencoded";function Gf(e){return e!=null&&typeof e.tagName=="string"}function qT(e){return Gf(e)&&e.tagName.toLowerCase()==="button"}function YT(e){return Gf(e)&&e.tagName.toLowerCase()==="form"}function KT(e){return Gf(e)&&e.tagName.toLowerCase()==="input"}function JT(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function QT(e,t){return e.button===0&&(!t||t==="_self")&&!JT(e)}var su=null;function e3(){if(su===null)try{new FormData(document.createElement("form"),0),su=!1}catch{su=!0}return su}var t3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nd(e){return e!=null&&!t3.has(e)?(Rn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lu}"`),null):e}function r3(e,t){let r,n,a,i,o;if(YT(e)){let l=e.getAttribute("action");n=l?qa(l,t):null,r=e.getAttribute("method")||Au,a=nd(e.getAttribute("enctype"))||Lu,i=new FormData(e)}else if(qT(e)||KT(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||l.getAttribute("action");if(n=u?qa(u,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||Au,a=nd(e.getAttribute("formenctype"))||nd(l.getAttribute("enctype"))||Lu,i=new FormData(l,e),!e3()){let{name:f,type:h,value:m}=e;if(h==="image"){let g=f?`${f}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else f&&i.append(f,m)}}else{if(Gf(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Au,n=null,a=Lu,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}function Up(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function n3(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function a3(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function i3(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let o=await n3(i,r);return o.links?o.links():[]}return[]}));return c3(n.flat(1).filter(a3).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Fg(e,t,r,n,a,i){let o=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,l=(u,f)=>{var h;return r[f].pathname!==u.pathname||((h=r[f].route.path)==null?void 0:h.endsWith("*"))&&r[f].params["*"]!==u.params["*"]};return i==="assets"?t.filter((u,f)=>o(u,f)||l(u,f)):i==="data"?t.filter((u,f)=>{var m;let h=n.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,f)||l(u,f))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((m=r[0])==null?void 0:m.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function s3(e,t,{includeHydrateFallback:r}={}){return o3(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function o3(e){return[...new Set(e)]}function l3(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function c3(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(l3(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}var u3=new Set([100,101,204,205]);function f3(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&qa(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function Ry(){let e=C.useContext(No);return Up(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function d3(){let e=C.useContext($f);return Up(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Hp=C.createContext(void 0);Hp.displayName="FrameworkContext";function Dy(){let e=C.useContext(Hp);return Up(e,"You must render this element inside a <HydratedRouter> element"),e}function h3(e,t){let r=C.useContext(Hp),[n,a]=C.useState(!1),[i,o]=C.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:f,onMouseLeave:h,onTouchStart:m}=t,g=C.useRef(null);C.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let y=k=>{k.forEach(S=>{o(S.isIntersecting)})},E=new IntersectionObserver(y,{threshold:.5});return g.current&&E.observe(g.current),()=>{E.disconnect()}}},[e]),C.useEffect(()=>{if(n){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[n]);let x=()=>{a(!0)},_=()=>{a(!1),o(!1)};return r?e!=="intent"?[i,g,{}]:[i,g,{onFocus:tl(l,x),onBlur:tl(u,_),onMouseEnter:tl(f,x),onMouseLeave:tl(h,_),onTouchStart:tl(m,x)}]:[!1,g,{}]}function tl(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function p3({page:e,...t}){let{router:r}=Ry(),n=C.useMemo(()=>Cy(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?C.createElement(g3,{page:e,matches:n,...t}):null}function m3(e){let{manifest:t,routeModules:r}=Dy(),[n,a]=C.useState([]);return C.useEffect(()=>{let i=!1;return i3(e,t,r).then(o=>{i||a(o)}),()=>{i=!0}},[e,t,r]),n}function g3({page:e,matches:t,...r}){let n=Qa(),{manifest:a,routeModules:i}=Dy(),{basename:o}=Ry(),{loaderData:l,matches:u}=d3(),f=C.useMemo(()=>Fg(e,t,u,a,n,"data"),[e,t,u,a,n]),h=C.useMemo(()=>Fg(e,t,u,a,n,"assets"),[e,t,u,a,n]),m=C.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let _=new Set,y=!1;if(t.forEach(k=>{var w;let S=a.routes[k.route.id];!S||!S.hasLoader||(!f.some(A=>A.route.id===k.route.id)&&k.route.id in l&&((w=i[k.route.id])!=null&&w.shouldRevalidate)||S.hasClientLoader?y=!0:_.add(k.route.id))}),_.size===0)return[];let E=f3(e,o);return y&&_.size>0&&E.searchParams.set("_routes",t.filter(k=>_.has(k.route.id)).map(k=>k.route.id).join(",")),[E.pathname+E.search]},[o,l,n,a,f,t,e,i]),g=C.useMemo(()=>s3(h,a),[h,a]),x=m3(h);return C.createElement(C.Fragment,null,m.map(_=>C.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...r})),g.map(_=>C.createElement("link",{key:_,rel:"modulepreload",href:_,...r})),x.map(({key:_,link:y})=>C.createElement("link",{key:_,...y})))}function x3(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Iy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Iy&&(window.__reactRouterVersion="7.5.1")}catch{}var jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dc=C.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:l,target:u,to:f,preventScrollReset:h,viewTransition:m,...g},x){let{basename:_}=C.useContext(ea),y=typeof f=="string"&&jy.test(f),E,k=!1;if(typeof f=="string"&&y&&(E=f,Iy))try{let j=new URL(window.location.href),V=f.startsWith("//")?new URL(j.protocol+f):new URL(f),B=qa(V.pathname,_);V.origin===j.origin&&B!=null?f=B+V.search+V.hash:k=!0}catch{Rn(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let S=AT(f,{relative:a}),[w,A,I]=h3(n,g),D=w3(f,{replace:o,state:l,target:u,preventScrollReset:h,relative:a,viewTransition:m});function P(j){t&&t(j),j.defaultPrevented||D(j)}let W=C.createElement("a",{...g,...I,href:E||S,onClick:k||i?t:P,ref:x3(x,A),target:u,"data-discover":!y&&r==="render"?"true":void 0});return w&&!y?C.createElement(C.Fragment,null,W,C.createElement(p3,{page:S})):W});dc.displayName="Link";var v3=C.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:l,children:u,...f},h){let m=fc(o,{relative:f.relative}),g=Qa(),x=C.useContext($f),{navigator:_,basename:y}=C.useContext(ea),E=x!=null&&C3(m)&&l===!0,k=_.encodeLocation?_.encodeLocation(m).pathname:m.pathname,S=g.pathname,w=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;r||(S=S.toLowerCase(),w=w?w.toLowerCase():null,k=k.toLowerCase()),w&&y&&(w=qa(w,y)||w);const A=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let I=S===k||!a&&S.startsWith(k)&&S.charAt(A)==="/",D=w!=null&&(w===k||!a&&w.startsWith(k)&&w.charAt(k.length)==="/"),P={isActive:I,isPending:D,isTransitioning:E},W=I?t:void 0,j;typeof n=="function"?j=n(P):j=[n,I?"active":null,D?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let V=typeof i=="function"?i(P):i;return C.createElement(dc,{...f,"aria-current":W,className:j,ref:h,style:V,to:o,viewTransition:l},typeof u=="function"?u(P):u)});v3.displayName="NavLink";var _3=C.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Au,action:l,onSubmit:u,relative:f,preventScrollReset:h,viewTransition:m,...g},x)=>{let _=S3(),y=T3(l,{relative:f}),E=o.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&jy.test(l),S=w=>{if(u&&u(w),w.defaultPrevented)return;w.preventDefault();let A=w.nativeEvent.submitter,I=(A==null?void 0:A.getAttribute("formmethod"))||o;_(A||w.currentTarget,{fetcherKey:t,method:I,navigate:r,replace:a,state:i,relative:f,preventScrollReset:h,viewTransition:m})};return C.createElement("form",{ref:x,method:E,action:y,onSubmit:n?u:S,...g,"data-discover":!k&&e==="render"?"true":void 0})});_3.displayName="Form";function y3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function By(e){let t=C.useContext(No);return Vt(t,y3(e)),t}function w3(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o}={}){let l=ka(),u=Qa(),f=fc(e,{relative:i});return C.useCallback(h=>{if(QT(h,t)){h.preventDefault();let m=r!==void 0?r:sf(u)===sf(f);l(e,{replace:m,state:n,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,f,r,n,t,e,a,i,o])}var k3=0,E3=()=>`__${String(++k3)}__`;function S3(){let{router:e}=By("useSubmit"),{basename:t}=C.useContext(ea),r=UT();return C.useCallback(async(n,a={})=>{let{action:i,method:o,encType:l,formData:u,body:f}=r3(n,t);if(a.navigate===!1){let h=a.fetcherKey||E3();await e.fetch(h,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function T3(e,{relative:t}={}){let{basename:r}=C.useContext(ea),n=C.useContext(ta);Vt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...fc(e||".",{relative:t})},o=Qa();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(h=>h==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let h=l.toString();i.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Ha([r,i.pathname])),sf(i)}function C3(e,t={}){let r=C.useContext(Ly);Vt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=By("useViewTransitionState"),a=fc(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=qa(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=qa(r.nextLocation.pathname,n)||r.nextLocation.pathname;return of(a.pathname,o)!=null||of(a.pathname,i)!=null}new TextEncoder;[...u3];function zy(e,t){return function(){return e.apply(t,arguments)}}const{toString:b3}=Object.prototype,{getPrototypeOf:Vp}=Object,Zf=(e=>t=>{const r=b3.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ra=e=>(e=e.toLowerCase(),t=>Zf(t)===e),Xf=e=>t=>typeof t===e,{isArray:Lo}=Array,ql=Xf("undefined");function N3(e){return e!==null&&!ql(e)&&e.constructor!==null&&!ql(e.constructor)&&xn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Uy=ra("ArrayBuffer");function A3(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Uy(e.buffer),t}const L3=Xf("string"),xn=Xf("function"),Hy=Xf("number"),qf=e=>e!==null&&typeof e=="object",P3=e=>e===!0||e===!1,Pu=e=>{if(Zf(e)!=="object")return!1;const t=Vp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},F3=ra("Date"),O3=ra("File"),M3=ra("Blob"),R3=ra("FileList"),D3=e=>qf(e)&&xn(e.pipe),I3=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||xn(e.append)&&((t=Zf(e))==="formdata"||t==="object"&&xn(e.toString)&&e.toString()==="[object FormData]"))},j3=ra("URLSearchParams"),[B3,z3,U3,H3]=["ReadableStream","Request","Response","Headers"].map(ra),V3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Lo(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,e[l],l,e)}}function Vy(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Ji=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Wy=e=>!ql(e)&&e!==Ji;function dh(){const{caseless:e}=Wy(this)&&this||{},t={},r=(n,a)=>{const i=e&&Vy(t,a)||a;Pu(t[i])&&Pu(n)?t[i]=dh(t[i],n):Pu(n)?t[i]=dh({},n):Lo(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&hc(arguments[n],r);return t}const W3=(e,t,r,{allOwnKeys:n}={})=>(hc(t,(a,i)=>{r&&xn(a)?e[i]=zy(a,r):e[i]=a},{allOwnKeys:n}),e),$3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),G3=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Z3=(e,t,r,n)=>{let a,i,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&Vp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},X3=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},q3=e=>{if(!e)return null;if(Lo(e))return e;let t=e.length;if(!Hy(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Y3=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Vp(Uint8Array)),K3=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},J3=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},Q3=ra("HTMLFormElement"),eC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Og=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),tC=ra("RegExp"),$y=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};hc(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},rC=e=>{$y(e,(t,r)=>{if(xn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(xn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},nC=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return Lo(e)?n(e):n(String(e).split(t)),r},aC=()=>{},iC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function sC(e){return!!(e&&xn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const oC=e=>{const t=new Array(10),r=(n,a)=>{if(qf(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=Lo(n)?[]:{};return hc(n,(o,l)=>{const u=r(o,a+1);!ql(u)&&(i[l]=u)}),t[a]=void 0,i}}return n};return r(e,0)},lC=ra("AsyncFunction"),cC=e=>e&&(qf(e)||xn(e))&&xn(e.then)&&xn(e.catch),Gy=((e,t)=>e?setImmediate:t?((r,n)=>(Ji.addEventListener("message",({source:a,data:i})=>{a===Ji&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Ji.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",xn(Ji.postMessage)),uC=typeof queueMicrotask<"u"?queueMicrotask.bind(Ji):typeof process<"u"&&process.nextTick||Gy,pe={isArray:Lo,isArrayBuffer:Uy,isBuffer:N3,isFormData:I3,isArrayBufferView:A3,isString:L3,isNumber:Hy,isBoolean:P3,isObject:qf,isPlainObject:Pu,isReadableStream:B3,isRequest:z3,isResponse:U3,isHeaders:H3,isUndefined:ql,isDate:F3,isFile:O3,isBlob:M3,isRegExp:tC,isFunction:xn,isStream:D3,isURLSearchParams:j3,isTypedArray:Y3,isFileList:R3,forEach:hc,merge:dh,extend:W3,trim:V3,stripBOM:$3,inherits:G3,toFlatObject:Z3,kindOf:Zf,kindOfTest:ra,endsWith:X3,toArray:q3,forEachEntry:K3,matchAll:J3,isHTMLForm:Q3,hasOwnProperty:Og,hasOwnProp:Og,reduceDescriptors:$y,freezeMethods:rC,toObjectSet:nC,toCamelCase:eC,noop:aC,toFiniteNumber:iC,findKey:Vy,global:Ji,isContextDefined:Wy,isSpecCompliantForm:sC,toJSONObject:oC,isAsyncFn:lC,isThenable:cC,setImmediate:Gy,asap:uC};function rt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}pe.inherits(rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:pe.toJSONObject(this.config),code:this.code,status:this.status}}});const Zy=rt.prototype,Xy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Xy[e]={value:e}});Object.defineProperties(rt,Xy);Object.defineProperty(Zy,"isAxiosError",{value:!0});rt.from=(e,t,r,n,a,i)=>{const o=Object.create(Zy);return pe.toFlatObject(e,o,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),rt.call(o,e.message,t,r,n,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const fC=null;function hh(e){return pe.isPlainObject(e)||pe.isArray(e)}function qy(e){return pe.endsWith(e,"[]")?e.slice(0,-2):e}function Mg(e,t,r){return e?e.concat(t).map(function(a,i){return a=qy(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function dC(e){return pe.isArray(e)&&!e.some(hh)}const hC=pe.toFlatObject(pe,{},null,function(t){return/^is[A-Z]/.test(t)});function Yf(e,t,r){if(!pe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=pe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,E){return!pe.isUndefined(E[y])});const n=r.metaTokens,a=r.visitor||h,i=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&pe.isSpecCompliantForm(t);if(!pe.isFunction(a))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(pe.isDate(_))return _.toISOString();if(!u&&pe.isBlob(_))throw new rt("Blob is not supported. Use a Buffer instead.");return pe.isArrayBuffer(_)||pe.isTypedArray(_)?u&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function h(_,y,E){let k=_;if(_&&!E&&typeof _=="object"){if(pe.endsWith(y,"{}"))y=n?y:y.slice(0,-2),_=JSON.stringify(_);else if(pe.isArray(_)&&dC(_)||(pe.isFileList(_)||pe.endsWith(y,"[]"))&&(k=pe.toArray(_)))return y=qy(y),k.forEach(function(w,A){!(pe.isUndefined(w)||w===null)&&t.append(o===!0?Mg([y],A,i):o===null?y:y+"[]",f(w))}),!1}return hh(_)?!0:(t.append(Mg(E,y,i),f(_)),!1)}const m=[],g=Object.assign(hC,{defaultVisitor:h,convertValue:f,isVisitable:hh});function x(_,y){if(!pe.isUndefined(_)){if(m.indexOf(_)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(_),pe.forEach(_,function(k,S){(!(pe.isUndefined(k)||k===null)&&a.call(t,k,pe.isString(S)?S.trim():S,y,g))===!0&&x(k,y?y.concat(S):[S])}),m.pop()}}if(!pe.isObject(e))throw new TypeError("data must be an object");return x(e),t}function Rg(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Wp(e,t){this._pairs=[],e&&Yf(e,this,t)}const Yy=Wp.prototype;Yy.append=function(t,r){this._pairs.push([t,r])};Yy.toString=function(t){const r=t?function(n){return t.call(this,n,Rg)}:Rg;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function pC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ky(e,t,r){if(!t)return e;const n=r&&r.encode||pC;pe.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=pe.isURLSearchParams(t)?t.toString():new Wp(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Dg{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){pe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Jy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mC=typeof URLSearchParams<"u"?URLSearchParams:Wp,gC=typeof FormData<"u"?FormData:null,xC=typeof Blob<"u"?Blob:null,vC={isBrowser:!0,classes:{URLSearchParams:mC,FormData:gC,Blob:xC},protocols:["http","https","file","blob","url","data"]},$p=typeof window<"u"&&typeof document<"u",ph=typeof navigator=="object"&&navigator||void 0,_C=$p&&(!ph||["ReactNative","NativeScript","NS"].indexOf(ph.product)<0),yC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wC=$p&&window.location.href||"http://localhost",kC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$p,hasStandardBrowserEnv:_C,hasStandardBrowserWebWorkerEnv:yC,navigator:ph,origin:wC},Symbol.toStringTag,{value:"Module"})),Ir={...kC,...vC};function EC(e,t){return Yf(e,new Ir.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Ir.isNode&&pe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function SC(e){return pe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function TC(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function Qy(e){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=i>=r.length;return o=!o&&pe.isArray(a)?a.length:o,u?(pe.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!pe.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&pe.isArray(a[o])&&(a[o]=TC(a[o])),!l)}if(pe.isFormData(e)&&pe.isFunction(e.entries)){const r={};return pe.forEachEntry(e,(n,a)=>{t(SC(n),a,r,0)}),r}return null}function CC(e,t,r){if(pe.isString(e))try{return(t||JSON.parse)(e),pe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const pc={transitional:Jy,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=pe.isObject(t);if(i&&pe.isHTMLForm(t)&&(t=new FormData(t)),pe.isFormData(t))return a?JSON.stringify(Qy(t)):t;if(pe.isArrayBuffer(t)||pe.isBuffer(t)||pe.isStream(t)||pe.isFile(t)||pe.isBlob(t)||pe.isReadableStream(t))return t;if(pe.isArrayBufferView(t))return t.buffer;if(pe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return EC(t,this.formSerializer).toString();if((l=pe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Yf(l?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),CC(t)):t}],transformResponse:[function(t){const r=this.transitional||pc.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(pe.isResponse(t)||pe.isReadableStream(t))return t;if(t&&pe.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(o)throw l.name==="SyntaxError"?rt.from(l,rt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ir.classes.FormData,Blob:Ir.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};pe.forEach(["delete","get","head","post","put","patch"],e=>{pc.headers[e]={}});const bC=pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NC=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&bC[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Ig=Symbol("internals");function rl(e){return e&&String(e).trim().toLowerCase()}function Fu(e){return e===!1||e==null?e:pe.isArray(e)?e.map(Fu):String(e)}function AC(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const LC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ad(e,t,r,n,a){if(pe.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!pe.isString(t)){if(pe.isString(n))return t.indexOf(n)!==-1;if(pe.isRegExp(n))return n.test(t)}}function PC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function FC(e,t){const r=pe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}class cn{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(l,u,f){const h=rl(u);if(!h)throw new Error("header name must be a non-empty string");const m=pe.findKey(a,h);(!m||a[m]===void 0||f===!0||f===void 0&&a[m]!==!1)&&(a[m||u]=Fu(l))}const o=(l,u)=>pe.forEach(l,(f,h)=>i(f,h,u));if(pe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(pe.isString(t)&&(t=t.trim())&&!LC(t))o(NC(t),r);else if(pe.isHeaders(t))for(const[l,u]of t.entries())i(u,l,n);else t!=null&&i(r,t,n);return this}get(t,r){if(t=rl(t),t){const n=pe.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return AC(a);if(pe.isFunction(r))return r.call(this,a,n);if(pe.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=rl(t),t){const n=pe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||ad(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=rl(o),o){const l=pe.findKey(n,o);l&&(!r||ad(n,n[l],l,r))&&(delete n[l],a=!0)}}return pe.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||ad(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return pe.forEach(this,(a,i)=>{const o=pe.findKey(n,i);if(o){r[o]=Fu(a),delete r[i];return}const l=t?PC(i):String(i).trim();l!==i&&delete r[i],r[l]=Fu(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return pe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&pe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[Ig]=this[Ig]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=rl(o);n[l]||(FC(a,o),n[l]=!0)}return pe.isArray(t)?t.forEach(i):i(t),this}}cn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);pe.reduceDescriptors(cn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});pe.freezeMethods(cn);function id(e,t){const r=this||pc,n=t||r,a=cn.from(n.headers);let i=n.data;return pe.forEach(e,function(l){i=l.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function e2(e){return!!(e&&e.__CANCEL__)}function Po(e,t,r){rt.call(this,e??"canceled",rt.ERR_CANCELED,t,r),this.name="CanceledError"}pe.inherits(Po,rt,{__CANCEL__:!0});function t2(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new rt("Request failed with status code "+r.status,[rt.ERR_BAD_REQUEST,rt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function OC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function MC(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(u){const f=Date.now(),h=n[i];o||(o=f),r[a]=u,n[a]=f;let m=i,g=0;for(;m!==a;)g+=r[m++],m=m%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),f-o<t)return;const x=h&&f-h;return x?Math.round(g*1e3/x):void 0}}function RC(e,t){let r=0,n=1e3/t,a,i;const o=(f,h=Date.now())=>{r=h,a=null,i&&(clearTimeout(i),i=null),e.apply(null,f)};return[(...f)=>{const h=Date.now(),m=h-r;m>=n?o(f,h):(a=f,i||(i=setTimeout(()=>{i=null,o(a)},n-m)))},()=>a&&o(a)]}const lf=(e,t,r=3)=>{let n=0;const a=MC(50,250);return RC(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,u=o-n,f=a(u),h=o<=l;n=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:f||void 0,estimated:f&&l&&h?(l-o)/f:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},jg=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Bg=e=>(...t)=>pe.asap(()=>e(...t)),DC=Ir.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Ir.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Ir.origin),Ir.navigator&&/(msie|trident)/i.test(Ir.navigator.userAgent)):()=>!0,IC=Ir.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];pe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),pe.isString(n)&&o.push("path="+n),pe.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function jC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function BC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function r2(e,t,r){let n=!jC(t);return e&&(n||r==!1)?BC(e,t):t}const zg=e=>e instanceof cn?{...e}:e;function hs(e,t){t=t||{};const r={};function n(f,h,m,g){return pe.isPlainObject(f)&&pe.isPlainObject(h)?pe.merge.call({caseless:g},f,h):pe.isPlainObject(h)?pe.merge({},h):pe.isArray(h)?h.slice():h}function a(f,h,m,g){if(pe.isUndefined(h)){if(!pe.isUndefined(f))return n(void 0,f,m,g)}else return n(f,h,m,g)}function i(f,h){if(!pe.isUndefined(h))return n(void 0,h)}function o(f,h){if(pe.isUndefined(h)){if(!pe.isUndefined(f))return n(void 0,f)}else return n(void 0,h)}function l(f,h,m){if(m in t)return n(f,h);if(m in e)return n(void 0,f)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(f,h,m)=>a(zg(f),zg(h),m,!0)};return pe.forEach(Object.keys(Object.assign({},e,t)),function(h){const m=u[h]||a,g=m(e[h],t[h],h);pe.isUndefined(g)&&m!==l||(r[h]=g)}),r}const n2=e=>{const t=hs({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=t;t.headers=o=cn.from(o),t.url=Ky(r2(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let u;if(pe.isFormData(r)){if(Ir.hasStandardBrowserEnv||Ir.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[f,...h]=u?u.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([f||"multipart/form-data",...h].join("; "))}}if(Ir.hasStandardBrowserEnv&&(n&&pe.isFunction(n)&&(n=n(t)),n||n!==!1&&DC(t.url))){const f=a&&i&&IC.read(i);f&&o.set(a,f)}return t},zC=typeof XMLHttpRequest<"u",UC=zC&&function(e){return new Promise(function(r,n){const a=n2(e);let i=a.data;const o=cn.from(a.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:f}=a,h,m,g,x,_;function y(){x&&x(),_&&_(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let E=new XMLHttpRequest;E.open(a.method.toUpperCase(),a.url,!0),E.timeout=a.timeout;function k(){if(!E)return;const w=cn.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),I={data:!l||l==="text"||l==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:w,config:e,request:E};t2(function(P){r(P),y()},function(P){n(P),y()},I),E=null}"onloadend"in E?E.onloadend=k:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(k)},E.onabort=function(){E&&(n(new rt("Request aborted",rt.ECONNABORTED,e,E)),E=null)},E.onerror=function(){n(new rt("Network Error",rt.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let A=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const I=a.transitional||Jy;a.timeoutErrorMessage&&(A=a.timeoutErrorMessage),n(new rt(A,I.clarifyTimeoutError?rt.ETIMEDOUT:rt.ECONNABORTED,e,E)),E=null},i===void 0&&o.setContentType(null),"setRequestHeader"in E&&pe.forEach(o.toJSON(),function(A,I){E.setRequestHeader(I,A)}),pe.isUndefined(a.withCredentials)||(E.withCredentials=!!a.withCredentials),l&&l!=="json"&&(E.responseType=a.responseType),f&&([g,_]=lf(f,!0),E.addEventListener("progress",g)),u&&E.upload&&([m,x]=lf(u),E.upload.addEventListener("progress",m),E.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(h=w=>{E&&(n(!w||w.type?new Po(null,e,E):w),E.abort(),E=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const S=OC(a.url);if(S&&Ir.protocols.indexOf(S)===-1){n(new rt("Unsupported protocol "+S+":",rt.ERR_BAD_REQUEST,e));return}E.send(i||null)})},HC=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(f){if(!a){a=!0,l();const h=f instanceof Error?f:this.reason;n.abort(h instanceof rt?h:new Po(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,i(new rt(`timeout ${t} of ms exceeded`,rt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),e=null)};e.forEach(f=>f.addEventListener("abort",i));const{signal:u}=n;return u.unsubscribe=()=>pe.asap(l),u}},VC=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},WC=async function*(e,t){for await(const r of $C(e))yield*VC(r,t)},$C=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Ug=(e,t,r,n)=>{const a=WC(e,t);let i=0,o,l=u=>{o||(o=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:f,value:h}=await a.next();if(f){l(),u.close();return}let m=h.byteLength;if(r){let g=i+=m;r(g)}u.enqueue(new Uint8Array(h))}catch(f){throw l(f),f}},cancel(u){return l(u),a.return()}},{highWaterMark:2})},Kf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",a2=Kf&&typeof ReadableStream=="function",GC=Kf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),i2=(e,...t)=>{try{return!!e(...t)}catch{return!1}},ZC=a2&&i2(()=>{let e=!1;const t=new Request(Ir.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Hg=64*1024,mh=a2&&i2(()=>pe.isReadableStream(new Response("").body)),cf={stream:mh&&(e=>e.body)};Kf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!cf[t]&&(cf[t]=pe.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new rt(`Response type '${t}' is not supported`,rt.ERR_NOT_SUPPORT,n)})})})(new Response);const XC=async e=>{if(e==null)return 0;if(pe.isBlob(e))return e.size;if(pe.isSpecCompliantForm(e))return(await new Request(Ir.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(pe.isArrayBufferView(e)||pe.isArrayBuffer(e))return e.byteLength;if(pe.isURLSearchParams(e)&&(e=e+""),pe.isString(e))return(await GC(e)).byteLength},qC=async(e,t)=>{const r=pe.toFiniteNumber(e.getContentLength());return r??XC(t)},YC=Kf&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:u,responseType:f,headers:h,withCredentials:m="same-origin",fetchOptions:g}=n2(e);f=f?(f+"").toLowerCase():"text";let x=HC([a,i&&i.toAbortSignal()],o),_;const y=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let E;try{if(u&&ZC&&r!=="get"&&r!=="head"&&(E=await qC(h,n))!==0){let I=new Request(t,{method:"POST",body:n,duplex:"half"}),D;if(pe.isFormData(n)&&(D=I.headers.get("content-type"))&&h.setContentType(D),I.body){const[P,W]=jg(E,lf(Bg(u)));n=Ug(I.body,Hg,P,W)}}pe.isString(m)||(m=m?"include":"omit");const k="credentials"in Request.prototype;_=new Request(t,{...g,signal:x,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:k?m:void 0});let S=await fetch(_);const w=mh&&(f==="stream"||f==="response");if(mh&&(l||w&&y)){const I={};["status","statusText","headers"].forEach(j=>{I[j]=S[j]});const D=pe.toFiniteNumber(S.headers.get("content-length")),[P,W]=l&&jg(D,lf(Bg(l),!0))||[];S=new Response(Ug(S.body,Hg,P,()=>{W&&W(),y&&y()}),I)}f=f||"text";let A=await cf[pe.findKey(cf,f)||"text"](S,e);return!w&&y&&y(),await new Promise((I,D)=>{t2(I,D,{data:A,headers:cn.from(S.headers),status:S.status,statusText:S.statusText,config:e,request:_})})}catch(k){throw y&&y(),k&&k.name==="TypeError"&&/fetch/i.test(k.message)?Object.assign(new rt("Network Error",rt.ERR_NETWORK,e,_),{cause:k.cause||k}):rt.from(k,k&&k.code,e,_)}}),gh={http:fC,xhr:UC,fetch:YC};pe.forEach(gh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Vg=e=>`- ${e}`,KC=e=>pe.isFunction(e)||e===null||e===!1,s2={getAdapter:e=>{e=pe.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!KC(r)&&(n=gh[(o=String(r)).toLowerCase()],n===void 0))throw new rt(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(Vg).join(`
`):" "+Vg(i[0]):"as no adapter specified";throw new rt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:gh};function sd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Po(null,e)}function Wg(e){return sd(e),e.headers=cn.from(e.headers),e.data=id.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),s2.getAdapter(e.adapter||pc.adapter)(e).then(function(n){return sd(e),n.data=id.call(e,e.transformResponse,n),n.headers=cn.from(n.headers),n},function(n){return e2(n)||(sd(e),n&&n.response&&(n.response.data=id.call(e,e.transformResponse,n.response),n.response.headers=cn.from(n.response.headers))),Promise.reject(n)})}const o2="1.8.4",Jf={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Jf[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const $g={};Jf.transitional=function(t,r,n){function a(i,o){return"[Axios v"+o2+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new rt(a(o," has been removed"+(r?" in "+r:"")),rt.ERR_DEPRECATED);return r&&!$g[o]&&($g[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};Jf.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function JC(e,t,r){if(typeof e!="object")throw new rt("options must be an object",rt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const l=e[i],u=l===void 0||o(l,i,e);if(u!==!0)throw new rt("option "+i+" must be "+u,rt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new rt("Unknown option "+i,rt.ERR_BAD_OPTION)}}const Ou={assertOptions:JC,validators:Jf},ua=Ou.validators;class as{constructor(t){this.defaults=t,this.interceptors={request:new Dg,response:new Dg}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=hs(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Ou.assertOptions(n,{silentJSONParsing:ua.transitional(ua.boolean),forcedJSONParsing:ua.transitional(ua.boolean),clarifyTimeoutError:ua.transitional(ua.boolean)},!1),a!=null&&(pe.isFunction(a)?r.paramsSerializer={serialize:a}:Ou.assertOptions(a,{encode:ua.function,serialize:ua.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ou.assertOptions(r,{baseUrl:ua.spelling("baseURL"),withXsrfToken:ua.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&pe.merge(i.common,i[r.method]);i&&pe.forEach(["delete","get","head","post","put","patch","common"],_=>{delete i[_]}),r.headers=cn.concat(o,i);const l=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(u=u&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const f=[];this.interceptors.response.forEach(function(y){f.push(y.fulfilled,y.rejected)});let h,m=0,g;if(!u){const _=[Wg.bind(this),void 0];for(_.unshift.apply(_,l),_.push.apply(_,f),g=_.length,h=Promise.resolve(r);m<g;)h=h.then(_[m++],_[m++]);return h}g=l.length;let x=r;for(m=0;m<g;){const _=l[m++],y=l[m++];try{x=_(x)}catch(E){y.call(this,E);break}}try{h=Wg.call(this,x)}catch(_){return Promise.reject(_)}for(m=0,g=f.length;m<g;)h=h.then(f[m++],f[m++]);return h}getUri(t){t=hs(this.defaults,t);const r=r2(t.baseURL,t.url,t.allowAbsoluteUrls);return Ky(r,t.params,t.paramsSerializer)}}pe.forEach(["delete","get","head","options"],function(t){as.prototype[t]=function(r,n){return this.request(hs(n||{},{method:t,url:r,data:(n||{}).data}))}});pe.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(hs(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}as.prototype[t]=r(),as.prototype[t+"Form"]=r(!0)});class Gp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new Po(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Gp(function(a){t=a}),cancel:t}}}function QC(e){return function(r){return e.apply(null,r)}}function eb(e){return pe.isObject(e)&&e.isAxiosError===!0}const xh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(xh).forEach(([e,t])=>{xh[t]=e});function l2(e){const t=new as(e),r=zy(as.prototype.request,t);return pe.extend(r,as.prototype,t,{allOwnKeys:!0}),pe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return l2(hs(e,a))},r}const Ue=l2(pc);Ue.Axios=as;Ue.CanceledError=Po;Ue.CancelToken=Gp;Ue.isCancel=e2;Ue.VERSION=o2;Ue.toFormData=Yf;Ue.AxiosError=rt;Ue.Cancel=Ue.CanceledError;Ue.all=function(t){return Promise.all(t)};Ue.spread=QC;Ue.isAxiosError=eb;Ue.mergeConfig=hs;Ue.AxiosHeaders=cn;Ue.formToJSON=e=>Qy(pe.isHTMLForm(e)?new FormData(e):e);Ue.getAdapter=s2.getAdapter;Ue.HttpStatusCode=xh;Ue.default=Ue;const jt="http://localhost:8000/api",Gg={CAMERAS:{LIST:"/cameras/cameras/",UPLOAD:"/cameras/cameras/upload_csv/",DETAIL:e=>`/cameras/cameras/${e}/`,PING_ALL:"/cameras/cameras/ping_all/"},COMMANDS:{SAVE_CONFIG:"/command/commands/save_config/",EXECUTE:"/command/execute/"},AUTH:{LOGIN:"/auth/token/",REFRESH:"/auth/token/refresh/"},DATACENTERS:"/datacenters/",FIREWALL_TYPES:"/firewalls/firewall-type/",FIREWALLS:"/firewalls/firewall/"},c2=e=>{var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null};let vh=null;const tb=e=>{vh=e},uf=e=>{vh?vh(e):window.location.href=e},an=Ue.create({baseURL:jt,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});an.interceptors.request.use(e=>{var t;if(["post","put","patch","delete"].includes(((t=e.method)==null?void 0:t.toLowerCase())||"")){const r=c2("csrftoken");r&&(e.headers["X-CSRFToken"]=r)}return e});an.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refreshToken");if(n){const a=await Ue.post(`${jt}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"X-CSRFToken":c2("csrftoken")}}),{access:i}=a.data;return localStorage.setItem("token",i),an.defaults.headers.common.Authorization=`Bearer ${i}`,t.headers.Authorization=`Bearer ${i}`,an(t)}}catch{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),uf("/login")}}return Promise.reject(e)});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),vt=(e,t)=>{const r=C.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,...f},h)=>C.createElement("svg",{ref:h,...rb,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${nb(e)}`,l].join(" "),...f},[...t.map(([m,g])=>C.createElement(m,g)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=vt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=vt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=vt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=vt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=vt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=vt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=vt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=vt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=vt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=vt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=vt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=vt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=vt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=vt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=vt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=vt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=vt("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=vt("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=vt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=vt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=vt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=vt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=vt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=vt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=vt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=vt("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=vt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=vt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=vt("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=vt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=vt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=vt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=vt("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=vt("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),Xp="http://localhost:8000";Ue.defaults.withCredentials=!0;const hf=Ue.create({baseURL:Xp,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}}),mb=e=>{var n;const r=`; ${document.cookie}`.split(`; ${e}=`);return r.length===2&&((n=r.pop())==null?void 0:n.split(";").shift())||null},qp=()=>mb("csrftoken"),pf=async()=>{try{const t=(await Ue.get(`${Xp}/api/auth/csrf/`,{withCredentials:!0,headers:{Accept:"application/json"}})).data.token;return t&&(document.cookie=`csrftoken=${t}; path=/`),t}catch(e){throw console.error("Error fetching CSRF token:",e),e}};hf.interceptors.request.use(async e=>{var n;if(((n=e.method)==null?void 0:n.toLowerCase())==="get")return e;let t=qp();if(!t)try{if(t=await pf(),!t)throw new Error("Failed to get CSRF token")}catch(a){throw console.error("Failed to fetch CSRF token:",a),a}t&&(e.headers["X-CSRFToken"]=t,e.headers["X-Requested-With"]="XMLHttpRequest");const r=localStorage.getItem("access_token");return r&&(e.headers.Authorization=`Bearer ${r}`),e.withCredentials=!0,e},e=>Promise.reject(e));hf.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refresh_token");if(n){const a=await Ue.post(`${Xp}/auth/token/refresh/`,{refresh:n},{withCredentials:!0,headers:{"Content-Type":"application/json","X-CSRFToken":qp()}});if(a.data.access)return localStorage.setItem("access_token",a.data.access),t.headers.Authorization=`Bearer ${a.data.access}`,hf(t)}}catch(n){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(n)}}return Promise.reject(e)});function gb({onLogin:e}){const t=ka(),[r,n]=C.useState(""),[a,i]=C.useState(""),[o,l]=C.useState(""),[u,f]=C.useState(!1);C.useEffect(()=>{(async()=>{try{await pf()}catch(g){console.error("Error initializing CSRF:",g)}})()},[]);const h=async m=>{var g,x;m.preventDefault(),f(!0),l("");try{const _={username:r,password:a},y=await an.post("/auth/login/",_);localStorage.setItem("token",y.data.access),localStorage.setItem("refreshToken",y.data.refresh),an.defaults.headers.common.Authorization=`Bearer ${y.data.access}`,e(),t("/")}catch(_){console.error("Login error details:",_),(x=(g=_.response)==null?void 0:g.data)!=null&&x.detail?l(_.response.data.detail):l("Nom d'utilisateur ou mot de passe incorrect")}finally{f(!1)}};return d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:d.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[d.jsxs("div",{className:"flex items-center justify-center mb-8",children:[d.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:d.jsx(Ba,{className:"h-8 w-8 text-purple-600"})}),d.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),o&&d.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:o}),d.jsxs("form",{onSubmit:h,className:"space-y-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ko,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",value:r,onChange:m=>n(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(Ba,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"password",value:a,onChange:m=>i(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),d.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50",children:u?d.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):"Se connecter"}),d.jsx("div",{className:"text-center mt-4",children:d.jsxs("p",{className:"text-sm text-gray-600",children:["Pas encore de compte ?"," ",d.jsx(dc,{to:"/register",className:"font-medium text-purple-600 hover:text-purple-500",children:"S'inscrire"})]})})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}function xb({onRegister:e}){const t=ka(),[r,n]=C.useState({username:"",email:"",phone_number:"",password:"",confirmPassword:"",first_name:"",last_name:""}),[a,i]=C.useState(""),[o,l]=C.useState(!1);C.useEffect(()=>{(async()=>{try{await pf()}catch(m){console.error("Failed to fetch CSRF token:",m),i("Erreur de configuration CSRF. Veuillez rafrachir la page.")}})()},[]);const u=h=>{const{name:m,value:g}=h.target;n(x=>({...x,[m]:g}))},f=async h=>{var m,g,x,_,y;if(h.preventDefault(),i(""),l(!0),r.password!==r.confirmPassword){i("Les mots de passe ne correspondent pas"),l(!1);return}try{qp()||await pf();const k=await hf.post("/api/auth/register/",{username:r.username,email:r.email,phone_number:r.phone_number,password:r.password,first_name:r.first_name,last_name:r.last_name});k.data.access&&(localStorage.setItem("access_token",k.data.access),k.data.refresh&&localStorage.setItem("refresh_token",k.data.refresh),e?e():t("/"))}catch(E){console.error("Registration error:",E),(g=(m=E.response)==null?void 0:m.data)!=null&&g.error?i(E.response.data.error):(_=(x=E.response)==null?void 0:x.data)!=null&&_.username?i("Ce nom d'utilisateur est dj pris"):((y=E.response)==null?void 0:y.status)===403?i("Erreur CORS: Vrifiez la configuration du serveur"):i("Une erreur est survenue lors de l'inscription. Veuillez ressayer.")}finally{l(!1)}};return d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 to-pink-600",children:d.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl w-96",children:[d.jsxs("div",{className:"flex items-center justify-center mb-8",children:[d.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:d.jsx(ko,{className:"h-8 w-8 text-purple-600"})}),d.jsx("h1",{className:"text-2xl font-bold ml-2 text-purple-900",children:"INWI"})]}),a&&d.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:a}),d.jsxs("form",{onSubmit:f,className:"space-y-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ko,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",name:"username",value:r.username,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom d'utilisateur",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(Zg,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Prnom",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(Zg,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Nom",required:!0})]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(u2,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"email",name:"email",value:r.email,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Email",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(d2,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"tel",name:"phone_number",value:r.phone_number,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Numro de tlphone",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(Ba,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"password",name:"password",value:r.password,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Mot de passe",required:!0})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(Ba,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:u,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Confirmer le mot de passe",required:!0})]}),d.jsx("div",{children:d.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:o?"Inscription en cours...":"S'inscrire"})}),d.jsx("div",{className:"text-center",children:d.jsxs("p",{className:"text-sm text-gray-600",children:["Dj un compte ?"," ",d.jsx(dc,{to:"/login",className:"font-medium text-purple-600 hover:text-purple-500",children:"Se connecter"})]})})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsx("p",{className:"text-sm text-gray-600",children:" 2024 INWI. Tous droits rservs."})})]})})}const vb="data:image/svg+xml,%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20viewBox='0%200%20512%20156'%20style='enable-background:new%200%200%20512%20156'%20xml:space='preserve'%3e%3cpath%20d='M44.6,44.5V109c0,4.3,0.8,8.4,2.3,12c1.7,3.7,3.8,7.1,6.5,10.3H41.9c-5.9,0-11.5-1.5-16.8-4.5%20c-11-5.2-16.6-14.5-16.6-28.1V44.5c0-6.4,1.6-11.2,4.8-14.5c3.2-3.5,7.7-5.3,13.5-5.3c5.3,0,9.7,1.8,13,5.3%20C43,33.3,44.6,38.2,44.6,44.5z%20M173.8,35c10.5,8.2,15.7,20.4,15.5,36.6v39.9c0,6.2-1.5,11-4.5,14.3c-3.3,3.7-7.9,5.5-13.5,5.5%20c-5.5,0-9.9-1.8-13.3-5.5c-3-3.3-4.5-8.1-4.5-14.3V71.6c0-5.8-1.4-10.5-4.3-14c-3.2-3.7-7.9-5.5-14-5.5c-6.2,0-10.9,1.8-14,5.5%20c-2.8,3.5-4.3,8.2-4.3,14v39.9c0,6.2-1.5,11-4.5,14.3c-3.3,3.7-7.8,5.5-13.3,5.5c-5.7,0-10.2-1.8-13.5-5.5c-3-3.3-4.5-8.1-4.5-14.3%20V71.6C81,55.2,86.1,43,96.5,35c9-6.9,21.9-10.3,38.6-10.3C151.8,24.7,164.7,28.1,173.8,35z%20M395.7,30c3.2,3.5,4.8,8.4,4.8,14.5%20v39.9c0,16.2-5.2,28.3-15.5,36.4c-9.2,7-22.1,10.5-38.6,10.5c-15.2,0-27.4-3-36.6-9c-8.9,6-20.8,9-35.9,9%20c-16.7,0-29.7-3.5-38.9-10.5c-10.2-8-15.3-20.1-15.3-36.4V44.5c0-6.4,1.5-11.2,4.5-14.5c3.2-3.5,7.7-5.3,13.5-5.3%20c5.5,0,9.9,1.8,13.3,5.3c3,3.3,4.5,8.2,4.5,14.5v39.4c0,6.2,1.4,11,4.3,14.3c3.2,3.7,7.9,5.5,14,5.5c6.2,0,10.8-1.8,13.8-5.5%20c2.8-3.3,4.3-8.1,4.3-14.3V44.5c0-6.4,1.6-11.2,4.8-14.5c3.2-3.5,7.7-5.3,13.5-5.3c5.5,0,9.9,1.8,13.3,5.3c3,3.3,4.5,8.2,4.5,14.5%20v39.4c0,6.2,1.4,11,4.3,14.3c3.2,3.7,7.9,5.5,14,5.5c6.2,0,10.8-1.8,13.8-5.5c2.8-3.3,4.3-8.1,4.3-14.3V44.5%20c0-6.4,1.6-11.2,4.8-14.5c3.3-3.5,7.7-5.3,13-5.3C388,24.7,392.5,26.5,395.7,30z%20M436.8,46.8c0-4.3-0.8-8.4-2.3-12%20c-1.7-3.5-3.8-6.9-6.5-10h11.5l5,0.8c4.3,0.3,8.2,1.5,11.5,3.5c11.2,5.2,16.8,14.6,16.8,28.3v54.2c0,6.2-1.7,11-5,14.3%20c-3,3.7-7.4,5.5-13.3,5.5c-5.4,0-9.7-1.8-13-5.5c-3.2-3.3-4.8-8.1-4.8-14.3V46.8z%20M484.9,27.5c0.7,0,1-0.4,1-1.3v-0.5%20c0-0.7-0.3-1-1-1h-11c-0.7,0-1,0.3-1,1v0.5c0,0.8,0.3,1.3,1,1.3h4v11.8c0,0.8,0.3,1.3,1,1.3h0.5c1.2,0,1.7-0.4,1.5-1.3V27.5H484.9z%20M503.5,26.2L503,25l-0.8-0.3H501l-1,0.3c0,0.2,0,0.3-0.1,0.5c-0.1,0.2-0.2,0.3-0.4,0.3L496,34l-3-8.3l-0.3-0.8l-1.3-0.3h-1.3%20c-1.2,0-1.7,0.5-1.5,1.5v13c0,0.8,0.4,1.3,1.3,1.3h0.3c0.8,0,1.3-0.4,1.3-1.3V28.5l3.5,8.3l0.3,0.3l0.8,0.5l1.3-0.5l0.5-0.3%20l3.3-8.3v10.8c0,0.5,0.1,0.8,0.3,1c0.2,0.2,0.4,0.3,0.8,0.3h0.3c0.8,0,1.3-0.4,1.3-1.3V26.2z'%20style='fill:%23AD2184'/%3e%3c/svg%3e",_b=({onLogout:e})=>{const t=Qa(),[r,n]=C.useState({main:!0,firewall:!0,tools:!0}),a=l=>{n(u=>({...u,[l]:!u[l]}))},i=l=>t.pathname===l,o=[{title:"Main",items:[{path:"/firewalls",icon:ps,label:"Pare-feux"},{path:"/daily-check",icon:df,label:"Daily Check"},{path:"/config",icon:lb,label:"Backup config"}]},{title:"Maps",items:[{path:"/map",icon:ub,label:" Mapping CCTV"},{path:"/network-map",icon:f2,label:"Mapping FWs"}]},{title:"Settings",items:[{path:"/settings",icon:kh,label:"Paramtres"},{path:"/templates",icon:yh,label:"Configuration templates"},{path:"/matrix",icon:ab,label:"Dynamic configuration"}]},{title:"Tools",items:[{path:"/profile",icon:ko,label:"Profile"},{path:"/history",icon:df,label:"Historique"}]}];return d.jsxs("div",{className:"w-64 bg-[#120247] text-white p-6 h-screen flex flex-col",children:[d.jsx("div",{className:"flex items-center justify-center mb-8",children:d.jsx("img",{src:vb,alt:"INWI Logo",className:"h-12 w-auto"})}),d.jsx("nav",{className:"space-y-6 flex-grow overflow-y-auto custom-sidebar-scrollbar",children:o.map(l=>d.jsxs("div",{className:"space-y-2",children:[d.jsxs("button",{onClick:()=>a(l.title.toLowerCase()),className:"flex items-center justify-between w-full p-2 rounded-lg hover:bg-[#7a487a]",children:[d.jsx("span",{className:"font-semibold",children:l.title}),r[l.title.toLowerCase()]?d.jsx(ff,{className:"h-4 w-4"}):d.jsx(_h,{className:"h-4 w-4"})]}),r[l.title.toLowerCase()]&&d.jsx("div",{className:"space-y-1 pl-2",children:l.items.map(u=>{const f=u.icon;return d.jsxs(dc,{to:u.path,className:`flex items-center space-x-2 w-full p-2 rounded-lg transition-colors duration-200 ${i(u.path)?"bg-[#6b3d6b] text-white":"hover:bg-[#7a487a] text-purple-100"}`,children:[d.jsx(f,{className:"h-5 w-5"}),d.jsx("span",{children:u.label})]},u.path)})})]},l.title))}),d.jsxs("button",{onClick:e,className:"flex items-center space-x-2 w-full p-2 rounded-lg hover:bg-[#7a487a] mt-auto",children:[d.jsx(cb,{className:"h-5 w-5"}),d.jsx("span",{children:"Logout"})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var m2=1252,yb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Yp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Kp=function(e){yb.indexOf(e)!=-1&&(m2=Yp[0]=e)};function wb(){Kp(1252)}var Xn=function(e){Kp(e)};function g2(){Xn(1200),wb()}function Xg(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function kb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function x2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ll=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?kb(e.slice(2)):t==254&&r==255?x2(e.slice(2)):t==65279?e.slice(1):e},ou=function(t){return String.fromCharCode(t)},qg=function(t){return String.fromCharCode(t)},fi,gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yg(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),i=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,a=e.charCodeAt(f++),l=(n&15)<<2|a>>6,u=a&63,isNaN(n)?l=u=64:isNaN(a)&&(u=64),t+=gi.charAt(i)+gi.charAt(o)+gi.charAt(l)+gi.charAt(u);return t}function _n(e){var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=gi.indexOf(e.charAt(f++)),o=gi.indexOf(e.charAt(f++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=gi.indexOf(e.charAt(f++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=gi.indexOf(e.charAt(f++)),a=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var ht=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ws=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Li(e){return ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Kg(e){return ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Zn=function(t){return ht?ws(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ks(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Jp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Jp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var di=ht?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ws(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Eb(e){for(var t=[],r=0,n=e.length+250,a=Li(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Li(65535),n=65530)}return t.push(a.slice(0,r)),di(t)}var Yr=/\u0000/g,cl=/[\u0001-\u0006]/g;function uo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function qn(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}function Qp(e,t){var r=""+e;return r.length>=t?r:Xt(" ",t-r.length)+r}function mf(e,t){var r=""+e;return r.length>=t?r:r+Xt(" ",t-r.length)}function Sb(e,t){var r=""+Math.round(e);return r.length>=t?r:Xt("0",t-r.length)+r}function Tb(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}var Jg=Math.pow(2,32);function Is(e,t){if(e>Jg||e<-Jg)return Sb(e,t);var r=Math.round(e);return Tb(r,t)}function gf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Qg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],od=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Cb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var tt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ex={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xf(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,u=1,f=0,h=0,m=Math.floor(a);f<t&&(m=Math.floor(a),l=m*o+i,h=m*f+u,!(a-m<5e-8));)a=1/(a-m),i=o,o=l,u=f,f=h;if(h>t&&(f>t?(h=u,l=i):(h=f,l=o)),!r)return[0,n*l,h];var g=Math.floor(n*l/h);return[g,n*l-g*h,h]}function es(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=Ob(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var v2=new Date(1899,11,31,0,0,0),Nb=v2.getTime(),Ab=new Date(1900,2,1,0,0,0);function _2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Ab&&(r+=24*60*60*1e3),(r-(Nb+(e.getTimezoneOffset()-v2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function em(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Lb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Pb(e){var t=e<0?12:11,r=em(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Fb(e){var t=em(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Yl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Pb(e):t===10?r=e.toFixed(10).substr(0,12):r=Fb(e),em(Lb(r.toUpperCase()))}function ms(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dn(14,_2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Ob(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Mb(e,t,r,n){var a="",i=0,o=0,l=r.y,u,f=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return od[r.m-1][1];case 5:return od[r.m-1][0];default:return od[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return Qg[r.q][0];default:return Qg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?qn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=qn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var h=f>0?qn(u,f):"";return h}function xi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var y2=/%/g;function Rb(e,t,r){var n=t.replace(y2,""),a=t.length-n.length;return Va(e,n,r*Math.pow(10,2*a))+Xt("%",a)}function Db(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Va(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function w2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+w2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,h){return u+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var k2=/# (\?+)( ?)\/( ?)(\d+)/;function Ib(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?Xt(" ",e[1].length+1+e[4].length):Qp(o,e[1].length)+e[2]+"/"+e[3]+qn(l,e[4].length))}function jb(e,t,r){return r+(t===0?"":""+t)+Xt(" ",e[1].length+2+e[4].length)}var E2=/^#*0*\.([0#]+)/,S2=/\).*[0#]/,T2=/\(###\) ###\\?-####/;function Gr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function tx(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function rx(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Bb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function zb(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Cn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(S2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cn("n",n,r):"("+Cn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Db(e,t,r);if(t.indexOf("%")!==-1)return Rb(e,t,r);if(t.indexOf("E")!==-1)return w2(t,r);if(t.charCodeAt(0)===36)return"$"+Cn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Is(u,t.length);if(t.match(/^[#?]+$/))return a=Is(r,0),a==="0"&&(a=""),a.length>t.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(k2))return Ib(i,u,f);if(t.match(/^#+0+$/))return f+Is(u,t.length-t.indexOf("0"));if(i=t.match(E2))return a=tx(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Gr(i[1])).replace(/\.$/,"."+Gr(i[1])).replace(/\.(\d*)$/,function(_,y){return"."+y+Xt("0",Gr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+tx(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+xi(Is(u,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cn(e,t,-r):xi(""+(Math.floor(r)+Bb(r,i[1].length)))+"."+qn(rx(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Cn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=uo(Cn(e,t.replace(/[\\-]/g,""),r)),o=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<a.length?a.charAt(o++):_==="0"?"0":""}));if(t.match(T2))return a=Cn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=xf(u,Math.pow(10,o)-1,!1),a=""+f,h=Va("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=mf(l[2],o),h.length<i[4].length&&(h=Gr(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=xf(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Qp(l[1],o)+i[2]+"/"+i[3]+mf(l[2],o):Xt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Is(r,0),t.length<=a.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return Gr(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=rx(r,i[1].length),r<0?"-"+Cn(e,t,-r):xi(zb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?qn(0,3-_.length):"")+_})+"."+qn(o,i[1].length);switch(t){case"###,##0.00":return Cn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=xi(Is(u,0));return x!=="0"?f+x:"";case"###,###.00":return Cn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Cn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ub(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Va(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Hb(e,t,r){var n=t.replace(y2,""),a=t.length-n.length;return Va(e,n,r*Math.pow(10,2*a))+Xt("%",a)}function C2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,h){return u+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function da(e,t,r){if(e.charCodeAt(0)===40&&!t.match(S2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?da("n",n,r):"("+da("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ub(e,t,r);if(t.indexOf("%")!==-1)return Hb(e,t,r);if(t.indexOf("E")!==-1)return C2(t,r);if(t.charCodeAt(0)===36)return"$"+da(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+qn(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(k2))return jb(i,u,f);if(t.match(/^#+0+$/))return f+qn(u,t.length-t.indexOf("0"));if(i=t.match(E2))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Gr(i[1])).replace(/\.$/,"."+Gr(i[1])),a=a.replace(/\.(\d*)$/,function(_,y){return"."+y+Xt("0",Gr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+xi(""+u);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+da(e,t,-r):xi(""+r)+"."+Xt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return da(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=uo(da(e,t.replace(/[\\-]/g,""),r)),o=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<a.length?a.charAt(o++):_==="0"?"0":""}));if(t.match(T2))return a=da(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=xf(u,Math.pow(10,o)-1,!1),a=""+f,h=Va("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=mf(l[2],o),h.length<i[4].length&&(h=Gr(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=xf(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Qp(l[1],o)+i[2]+"/"+i[3]+mf(l[2],o):Xt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Gr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var m=t.indexOf(".")-o,g=t.length-a.length-m;return Gr(t.substr(0,m)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+da(e,t,-r):xi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?qn(0,3-_.length):"")+_})+"."+qn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=xi(""+u);return x!=="0"?f+x:"";default:if(t.match(/\.[0#?]*$/))return da(e,t.slice(0,t.lastIndexOf(".")),r)+Gr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Va(e,t,r){return(r|0)===r?da(e,t,r):Cn(e,t,r)}function Vb(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var b2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":gf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(b2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Wb(e,t,r,n){for(var a=[],i="",o=0,l="",u="t",f,h,m,g="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!gf(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++o;break;case"\\":var x=e.charAt(++o),_=x==="("||x===")"?x:"t";a[a.length]={t:_,v:x},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=es(t,r,e.charAt(o+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=es(t,r),f==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),a[a.length]={t:l,v:i},u=l;break;case"A":case"a":case"":var y={t:l,v:l};if(f==null&&(f=es(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",o+=5,g="h"):(y.t="t",++o),f==null&&y.t==="T")return"";a[a.length]=y,u=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(b2)){if(f==null&&(f=es(t,r),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fo(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var E=0,k=0,S;for(o=a.length-1,u="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=g,u="h",E<1&&(E=1);break;case"s":(S=a[o].v.match(/\.0+$/))&&(k=Math.max(k,S[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":u=a[o].t;break;case"m":u==="s"&&(a[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[o].v.match(/[Hh]/)&&(E=1),E<2&&a[o].v.match(/[Mm]/)&&(E=2),E<3&&a[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var w="",A;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=Mb(a[o].t.charCodeAt(0),a[o].v,f,k),a[o].t="t";break;case"n":case"?":for(A=o+1;a[A]!=null&&((l=a[A].t)==="?"||l==="D"||(l===" "||l==="t")&&a[A+1]!=null&&(a[A+1].t==="?"||a[A+1].t==="t"&&a[A+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[A].v==="/"||a[A].v===" "&&a[A+1]!=null&&a[A+1].t=="?"));)a[o].v+=a[A].v,a[A]={v:"",t:";"},++A;w+=a[o].v,o=A-1;break;case"G":a[o].t="t",a[o].v=ms(t,r);break}var I="",D,P;if(w.length>0){w.charCodeAt(0)==40?(D=t<0&&w.charCodeAt(0)===45?-t:t,P=Va("n",w,D)):(D=t<0&&n>1?-t:t,P=Va("n",w,D),D<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),A=P.length-1;var W=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){W=o;break}var j=a.length;if(W===a.length&&P.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(A>=a[o].v.length-1?(A-=a[o].v.length,a[o].v=P.substr(A+1,a[o].v.length)):A<0?a[o].v="":(a[o].v=P.substr(0,A+1),A=-1),a[o].t="t",j=o);A>=0&&j<a.length&&(a[j].v=P.substr(0,A+1)+a[j].v)}else if(W!==a.length&&P.indexOf("E")===-1){for(A=P.indexOf(".")-1,o=W;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(h=a[o].v.indexOf(".")>-1&&o===W?a[o].v.indexOf(".")-1:a[o].v.length-1,I=a[o].v.substr(h+1);h>=0;--h)A>=0&&(a[o].v.charAt(h)==="0"||a[o].v.charAt(h)==="#")&&(I=P.charAt(A--)+I);a[o].v=I,a[o].t="t",j=o}for(A>=0&&j<a.length&&(a[j].v=P.substr(0,A+1)+a[j].v),A=P.indexOf(".")+1,o=W;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==W)){for(h=a[o].v.indexOf(".")>-1&&o===W?a[o].v.indexOf(".")+1:0,I=a[o].v.substr(0,h);h<a[o].v.length;++h)A<P.length&&(I+=P.charAt(A++));a[o].v=I,a[o].t="t",j=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(D=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Va(a[o].t,a[o].v,D),a[o].t="t");var V="";for(o=0;o!==a.length;++o)a[o]!=null&&(V+=a[o].v);return V}var nx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ax(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function $b(e,t){var r=Vb(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(nx),l=r[1].match(nx);return ax(t,o)?[n,r[0]]:ax(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function Dn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:tt)[e],n==null&&(n=r.table&&r.table[ex[e]]||tt[ex[e]]),n==null&&(n=bb[e]||"General");break}if(gf(n,0))return ms(t,r);t instanceof Date&&(t=_2(t,r.date1904));var a=$b(n,t);if(gf(a[1]))return ms(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Wb(a[1],t,r,a[0])}function is(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(tt[r]==null){t<0&&(t=r);continue}if(tt[r]==e){t=r;break}}t<0&&(t=391)}return tt[t]=e,t}function N2(){tt=Cb()}var Gb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},A2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Zb(e){var t=typeof e=="number"?tt[e]:e;return t=t.replace(A2,"(\\d+)"),new RegExp("^"+t+"$")}function Xb(e,t,r){var n=-1,a=-1,i=-1,o=-1,l=-1,u=-1;(t.match(A2)||[]).forEach(function(m,g){var x=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=x;break;case"d":i=x;break;case"h":o=x;break;case"s":u=x;break;case"m":o>=0?l=x:a=x;break}}),u>=0&&l==-1&&a>=0&&(l=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?f:n==-1&&a==-1&&i==-1?h:f+"T"+h}var qb=function(){var e={};e.version="1.2.0";function t(){for(var P=0,W=new Array(256),j=0;j!=256;++j)P=j,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,W[j]=P;return typeof Int32Array<"u"?new Int32Array(W):W}var r=t();function n(P){var W=0,j=0,V=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)B[V]=P[V];for(V=0;V!=256;++V)for(j=P[V],W=256+V;W<4096;W+=256)j=B[W]=j>>>8^P[j&255];var Z=[];for(V=1;V!=16;++V)Z[V-1]=typeof Int32Array<"u"?B.subarray(V*256,V*256+256):B.slice(V*256,V*256+256);return Z}var a=n(r),i=a[0],o=a[1],l=a[2],u=a[3],f=a[4],h=a[5],m=a[6],g=a[7],x=a[8],_=a[9],y=a[10],E=a[11],k=a[12],S=a[13],w=a[14];function A(P,W){for(var j=W^-1,V=0,B=P.length;V<B;)j=j>>>8^r[(j^P.charCodeAt(V++))&255];return~j}function I(P,W){for(var j=W^-1,V=P.length-15,B=0;B<V;)j=w[P[B++]^j&255]^S[P[B++]^j>>8&255]^k[P[B++]^j>>16&255]^E[P[B++]^j>>>24]^y[P[B++]]^_[P[B++]]^x[P[B++]]^g[P[B++]]^m[P[B++]]^h[P[B++]]^f[P[B++]]^u[P[B++]]^l[P[B++]]^o[P[B++]]^i[P[B++]]^r[P[B++]];for(V+=15;B<V;)j=j>>>8^r[(j^P[B++])&255];return~j}function D(P,W){for(var j=W^-1,V=0,B=P.length,Z=0,K=0;V<B;)Z=P.charCodeAt(V++),Z<128?j=j>>>8^r[(j^Z)&255]:Z<2048?(j=j>>>8^r[(j^(192|Z>>6&31))&255],j=j>>>8^r[(j^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,K=P.charCodeAt(V++)&1023,j=j>>>8^r[(j^(240|Z>>8&7))&255],j=j>>>8^r[(j^(128|Z>>2&63))&255],j=j>>>8^r[(j^(128|K>>6&15|(Z&3)<<4))&255],j=j>>>8^r[(j^(128|K&63))&255]):(j=j>>>8^r[(j^(224|Z>>12&15))&255],j=j>>>8^r[(j^(128|Z>>6&63))&255],j=j>>>8^r[(j^(128|Z&63))&255]);return~j}return e.table=r,e.bstr=A,e.buf=I,e.str=D,e}(),gt=function(){var t={};t.version="1.2.1";function r(b,M){for(var O=b.split("/"),R=M.split("/"),z=0,H=0,ne=Math.min(O.length,R.length);z<ne;++z){if(H=O[z].length-R[z].length)return H;if(O[z]!=R[z])return O[z]<R[z]?-1:1}return O.length-R.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var M=b.lastIndexOf("/");return M===-1?b:b.slice(0,M+1)}function a(b){if(b.charAt(b.length-1)=="/")return a(b.slice(0,-1));var M=b.lastIndexOf("/");return M===-1?b:b.slice(M+1)}function i(b,M){typeof M=="string"&&(M=new Date(M));var O=M.getHours();O=O<<6|M.getMinutes(),O=O<<5|M.getSeconds()>>>1,b.write_shift(2,O);var R=M.getFullYear()-1980;R=R<<4|M.getMonth()+1,R=R<<5|M.getDate(),b.write_shift(2,R)}function o(b){var M=b.read_shift(2)&65535,O=b.read_shift(2)&65535,R=new Date,z=O&31;O>>>=5;var H=O&15;O>>>=4,R.setMilliseconds(0),R.setFullYear(O+1980),R.setMonth(H-1),R.setDate(z);var ne=M&31;M>>>=5;var ge=M&63;return M>>>=6,R.setHours(M),R.setMinutes(ge),R.setSeconds(ne<<1),R}function l(b){wr(b,0);for(var M={},O=0;b.l<=b.length-4;){var R=b.read_shift(2),z=b.read_shift(2),H=b.l+z,ne={};switch(R){case 21589:O=b.read_shift(1),O&1&&(ne.mtime=b.read_shift(4)),z>5&&(O&2&&(ne.atime=b.read_shift(4)),O&4&&(ne.ctime=b.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}b.l=H,M[R]=ne}return M}var u;function f(){return u||(u={})}function h(b,M){if(b[0]==80&&b[1]==75)return lt(b,M);if((b[0]|32)==109&&(b[1]|32)==105)return dt(b,M);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var O=3,R=512,z=0,H=0,ne=0,ge=0,se=0,oe=[],le=b.slice(0,512);wr(le,0);var Te=m(le);switch(O=Te[0],O){case 3:R=512;break;case 4:R=4096;break;case 0:if(Te[1]==0)return lt(b,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}R!==512&&(le=b.slice(0,R),wr(le,28));var Pe=b.slice(0,R);g(le,O);var De=le.read_shift(4,"i");if(O===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ge=le.read_shift(4,"i"),z=le.read_shift(4,"i"),se=le.read_shift(4,"i"),H=le.read_shift(4,"i");for(var Ae=-1,Oe=0;Oe<109&&(Ae=le.read_shift(4,"i"),!(Ae<0));++Oe)oe[Oe]=Ae;var qe=x(b,R);E(se,H,qe,R,oe);var Ft=S(qe,ne,oe,R);Ft[ne].name="!Directory",z>0&&ge!==K&&(Ft[ge].name="!MiniFAT"),Ft[oe[0]].name="!FAT",Ft.fat_addrs=oe,Ft.ssz=R;var Ot={},hr=[],Ca=[],jn=[];w(ne,Ft,qe,hr,z,Ot,Ca,ge),_(Ca,jn,hr),hr.shift();var ti={FileIndex:Ca,FullPaths:jn};return M&&M.raw&&(ti.raw={header:Pe,sectors:qe}),ti}function m(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(ve,"Header Signature: "),b.l+=16;var M=b.read_shift(2,"u");return[b.read_shift(2,"u"),M]}function g(b,M){var O=9;switch(b.l+=2,O=b.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function x(b,M){for(var O=Math.ceil(b.length/M)-1,R=[],z=1;z<O;++z)R[z-1]=b.slice(z*M,(z+1)*M);return R[O-1]=b.slice(O*M),R}function _(b,M,O){for(var R=0,z=0,H=0,ne=0,ge=0,se=O.length,oe=[],le=[];R<se;++R)oe[R]=le[R]=R,M[R]=O[R];for(;ge<le.length;++ge)R=le[ge],z=b[R].L,H=b[R].R,ne=b[R].C,oe[R]===R&&(z!==-1&&oe[z]!==z&&(oe[R]=oe[z]),H!==-1&&oe[H]!==H&&(oe[R]=oe[H])),ne!==-1&&(oe[ne]=R),z!==-1&&R!=oe[R]&&(oe[z]=oe[R],le.lastIndexOf(z)<ge&&le.push(z)),H!==-1&&R!=oe[R]&&(oe[H]=oe[R],le.lastIndexOf(H)<ge&&le.push(H));for(R=1;R<se;++R)oe[R]===R&&(H!==-1&&oe[H]!==H?oe[R]=oe[H]:z!==-1&&oe[z]!==z&&(oe[R]=oe[z]));for(R=1;R<se;++R)if(b[R].type!==0){if(ge=R,ge!=oe[ge])do ge=oe[ge],M[R]=M[ge]+"/"+M[R];while(ge!==0&&oe[ge]!==-1&&ge!=oe[ge]);oe[R]=-1}for(M[0]+="/",R=1;R<se;++R)b[R].type!==2&&(M[R]+="/")}function y(b,M,O){for(var R=b.start,z=b.size,H=[],ne=R;O&&z>0&&ne>=0;)H.push(M.slice(ne*Z,ne*Z+Z)),z-=Z,ne=Zi(O,ne*4);return H.length===0?or(0):di(H).slice(0,b.size)}function E(b,M,O,R,z){var H=K;if(b===K){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ne=O[b],ge=(R>>>2)-1;if(!ne)return;for(var se=0;se<ge&&(H=Zi(ne,se*4))!==K;++se)z.push(H);E(Zi(ne,R-4),M-1,O,R,z)}}function k(b,M,O,R,z){var H=[],ne=[];z||(z=[]);var ge=R-1,se=0,oe=0;for(se=M;se>=0;){z[se]=!0,H[H.length]=se,ne.push(b[se]);var le=O[Math.floor(se*4/R)];if(oe=se*4&ge,R<4+oe)throw new Error("FAT boundary crossed: "+se+" 4 "+R);if(!b[le])break;se=Zi(b[le],oe)}return{nodes:H,data:px([ne])}}function S(b,M,O,R){var z=b.length,H=[],ne=[],ge=[],se=[],oe=R-1,le=0,Te=0,Pe=0,De=0;for(le=0;le<z;++le)if(ge=[],Pe=le+M,Pe>=z&&(Pe-=z),!ne[Pe]){se=[];var Ae=[];for(Te=Pe;Te>=0;){Ae[Te]=!0,ne[Te]=!0,ge[ge.length]=Te,se.push(b[Te]);var Oe=O[Math.floor(Te*4/R)];if(De=Te*4&oe,R<4+De)throw new Error("FAT boundary crossed: "+Te+" 4 "+R);if(!b[Oe]||(Te=Zi(b[Oe],De),Ae[Te]))break}H[Pe]={nodes:ge,data:px([se])}}return H}function w(b,M,O,R,z,H,ne,ge){for(var se=0,oe=R.length?2:0,le=M[b].data,Te=0,Pe=0,De;Te<le.length;Te+=128){var Ae=le.slice(Te,Te+128);wr(Ae,64),Pe=Ae.read_shift(2),De=im(Ae,0,Pe-oe),R.push(De);var Oe={name:De,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},qe=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);qe!==0&&(Oe.ct=A(Ae,Ae.l-8));var Ft=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Ft!==0&&(Oe.mt=A(Ae,Ae.l-8)),Oe.start=Ae.read_shift(4,"i"),Oe.size=Ae.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=K,Oe.name=""),Oe.type===5?(se=Oe.start,z>0&&se!==K&&(M[se].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",M[Oe.start]===void 0&&(M[Oe.start]=k(O,Oe.start,M.fat_addrs,M.ssz)),M[Oe.start].name=Oe.name,Oe.content=M[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:se!==K&&Oe.start!==K&&M[se]&&(Oe.content=y(Oe,M[se].data,(M[ge]||{}).data))),Oe.content&&wr(Oe.content,0),H[De]=Oe,ne.push(Oe)}}function A(b,M){return new Date((hn(b,M+4)/1e7*Math.pow(2,32)+hn(b,M)/1e7-11644473600)*1e3)}function I(b,M){return f(),h(u.readFileSync(b),M)}function D(b,M){var O=M&&M.type;switch(O||ht&&Buffer.isBuffer(b)&&(O="buffer"),O||"base64"){case"file":return I(b,M);case"base64":return h(Zn(_n(b)),M);case"binary":return h(Zn(b),M)}return h(b,M)}function P(b,M){var O=M||{},R=O.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=R+"/",b.FileIndex[0]={name:R,type:5}),O.CLSID&&(b.FileIndex[0].clsid=O.CLSID),W(b)}function W(b){var M="Sh33tJ5";if(!gt.find(b,"/"+M)){var O=or(4);O[0]=55,O[1]=O[3]=50,O[2]=54,b.FileIndex.push({name:M,type:2,content:O,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+M),j(b)}}function j(b,M){P(b);for(var O=!1,R=!1,z=b.FullPaths.length-1;z>=0;--z){var H=b.FileIndex[z];switch(H.type){case 0:R?O=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(H.R*H.L*H.C)&&(O=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!M)){var ne=new Date(1987,1,19),ge=0,se=Object.create?Object.create(null):{},oe=[];for(z=0;z<b.FullPaths.length;++z)se[b.FullPaths[z]]=!0,b.FileIndex[z].type!==0&&oe.push([b.FullPaths[z],b.FileIndex[z]]);for(z=0;z<oe.length;++z){var le=n(oe[z][0]);R=se[le],R||(oe.push([le,{name:a(le).replace("/",""),type:1,clsid:de,ct:ne,mt:ne,content:null}]),se[le]=!0)}for(oe.sort(function(De,Ae){return r(De[0],Ae[0])}),b.FullPaths=[],b.FileIndex=[],z=0;z<oe.length;++z)b.FullPaths[z]=oe[z][0],b.FileIndex[z]=oe[z][1];for(z=0;z<oe.length;++z){var Te=b.FileIndex[z],Pe=b.FullPaths[z];if(Te.name=a(Pe).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||de,z===0)Te.C=oe.length>1?1:-1,Te.size=0,Te.type=5;else if(Pe.slice(-1)=="/"){for(ge=z+1;ge<oe.length&&n(b.FullPaths[ge])!=Pe;++ge);for(Te.C=ge>=oe.length?-1:ge,ge=z+1;ge<oe.length&&n(b.FullPaths[ge])!=n(Pe);++ge);Te.R=ge>=oe.length?-1:ge,Te.type=1}else n(b.FullPaths[z+1]||"")==n(Pe)&&(Te.R=z+1),Te.type=2}}}function V(b,M){var O=M||{};if(O.fileType=="mad")return St(b,O);switch(j(b),O.fileType){case"zip":return sr(b,O)}var R=function(De){for(var Ae=0,Oe=0,qe=0;qe<De.FileIndex.length;++qe){var Ft=De.FileIndex[qe];if(Ft.content){var Ot=Ft.content.length;Ot>0&&(Ot<4096?Ae+=Ot+63>>6:Oe+=Ot+511>>9)}}for(var hr=De.FullPaths.length+3>>2,Ca=Ae+7>>3,jn=Ae+127>>7,ti=Ca+Oe+hr+jn,ia=ti+127>>7,ba=ia<=109?0:Math.ceil((ia-109)/127);ti+ia+ba+127>>7>ia;)ba=++ia<=109?0:Math.ceil((ia-109)/127);var Qe=[1,ba,ia,jn,hr,Oe,Ae,0];return De.FileIndex[0].size=Ae<<6,Qe[7]=(De.FileIndex[0].start=Qe[0]+Qe[1]+Qe[2]+Qe[3]+Qe[4]+Qe[5])+(Qe[6]+7>>3),Qe}(b),z=or(R[7]<<9),H=0,ne=0;{for(H=0;H<8;++H)z.write_shift(1,_e[H]);for(H=0;H<8;++H)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),H=0;H<3;++H)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,R[2]),z.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:K),z.write_shift(4,R[3]),z.write_shift(-4,R[1]?R[0]-1:K),z.write_shift(4,R[1]),H=0;H<109;++H)z.write_shift(-4,H<R[2]?R[1]+H:-1)}if(R[1])for(ne=0;ne<R[1];++ne){for(;H<236+ne*127;++H)z.write_shift(-4,H<R[2]?R[1]+H:-1);z.write_shift(-4,ne===R[1]-1?K:ne+1)}var ge=function(De){for(ne+=De;H<ne-1;++H)z.write_shift(-4,H+1);De&&(++H,z.write_shift(-4,K))};for(ne=H=0,ne+=R[1];H<ne;++H)z.write_shift(-4,J.DIFSECT);for(ne+=R[2];H<ne;++H)z.write_shift(-4,J.FATSECT);ge(R[3]),ge(R[4]);for(var se=0,oe=0,le=b.FileIndex[0];se<b.FileIndex.length;++se)le=b.FileIndex[se],le.content&&(oe=le.content.length,!(oe<4096)&&(le.start=ne,ge(oe+511>>9)));for(ge(R[6]+7>>3);z.l&511;)z.write_shift(-4,J.ENDOFCHAIN);for(ne=H=0,se=0;se<b.FileIndex.length;++se)le=b.FileIndex[se],le.content&&(oe=le.content.length,!(!oe||oe>=4096)&&(le.start=ne,ge(oe+63>>6)));for(;z.l&511;)z.write_shift(-4,J.ENDOFCHAIN);for(H=0;H<R[4]<<2;++H){var Te=b.FullPaths[H];if(!Te||Te.length===0){for(se=0;se<17;++se)z.write_shift(4,0);for(se=0;se<3;++se)z.write_shift(4,-1);for(se=0;se<12;++se)z.write_shift(4,0);continue}le=b.FileIndex[H],H===0&&(le.start=le.size?le.start-1:K);var Pe=H===0&&O.root||le.name;if(oe=2*(Pe.length+1),z.write_shift(64,Pe,"utf16le"),z.write_shift(2,oe),z.write_shift(1,le.type),z.write_shift(1,le.color),z.write_shift(-4,le.L),z.write_shift(-4,le.R),z.write_shift(-4,le.C),le.clsid)z.write_shift(16,le.clsid,"hex");else for(se=0;se<4;++se)z.write_shift(4,0);z.write_shift(4,le.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,le.start),z.write_shift(4,le.size),z.write_shift(4,0)}for(H=1;H<b.FileIndex.length;++H)if(le=b.FileIndex[H],le.size>=4096)if(z.l=le.start+1<<9,ht&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+511&-512;else{for(se=0;se<le.size;++se)z.write_shift(1,le.content[se]);for(;se&511;++se)z.write_shift(1,0)}for(H=1;H<b.FileIndex.length;++H)if(le=b.FileIndex[H],le.size>0&&le.size<4096)if(ht&&Buffer.isBuffer(le.content))le.content.copy(z,z.l,0,le.size),z.l+=le.size+63&-64;else{for(se=0;se<le.size;++se)z.write_shift(1,le.content[se]);for(;se&63;++se)z.write_shift(1,0)}if(ht)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function B(b,M){var O=b.FullPaths.map(function(se){return se.toUpperCase()}),R=O.map(function(se){var oe=se.split("/");return oe[oe.length-(se.slice(-1)=="/"?2:1)]}),z=!1;M.charCodeAt(0)===47?(z=!0,M=O[0].slice(0,-1)+M):z=M.indexOf("/")!==-1;var H=M.toUpperCase(),ne=z===!0?O.indexOf(H):R.indexOf(H);if(ne!==-1)return b.FileIndex[ne];var ge=!H.match(cl);for(H=H.replace(Yr,""),ge&&(H=H.replace(cl,"!")),ne=0;ne<O.length;++ne)if((ge?O[ne].replace(cl,"!"):O[ne]).replace(Yr,"")==H||(ge?R[ne].replace(cl,"!"):R[ne]).replace(Yr,"")==H)return b.FileIndex[ne];return null}var Z=64,K=-2,ve="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(b,M,O){f();var R=V(b,O);u.writeFileSync(M,R)}function U(b){for(var M=new Array(b.length),O=0;O<b.length;++O)M[O]=String.fromCharCode(b[O]);return M.join("")}function te(b,M){var O=V(b,M);switch(M&&M.type||"buffer"){case"file":return f(),u.writeFileSync(M.filename,O),O;case"binary":return typeof O=="string"?O:U(O);case"base64":return Yg(typeof O=="string"?O:U(O));case"buffer":if(ht)return Buffer.isBuffer(O)?O:ws(O);case"array":return typeof O=="string"?Zn(O):O}return O}var fe;function F(b){try{var M=b.InflateRaw,O=new M;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)fe=b;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function ee(b,M){if(!fe)return Xe(b,M);var O=fe.InflateRaw,R=new O,z=R._processChunk(b.slice(b.l),R._finishFlushFlag);return b.l+=R.bytesRead,z}function q(b){return fe?fe.deflateRawSync(b):Ze(b)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ke=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(b){var M=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(M>>16|M>>8|M)&255}for(var Ne=typeof Uint8Array<"u",we=Ne?new Uint8Array(256):[],Be=0;Be<256;++Be)we[Be]=Le(Be);function G(b,M){var O=we[b&255];return M<=8?O>>>8-M:(O=O<<8|we[b>>8&255],M<=16?O>>>16-M:(O=O<<8|we[b>>16&255],O>>>24-M))}function Ge(b,M){var O=M&7,R=M>>>3;return(b[R]|(O<=6?0:b[R+1]<<8))>>>O&3}function Je(b,M){var O=M&7,R=M>>>3;return(b[R]|(O<=5?0:b[R+1]<<8))>>>O&7}function me(b,M){var O=M&7,R=M>>>3;return(b[R]|(O<=4?0:b[R+1]<<8))>>>O&15}function Se(b,M){var O=M&7,R=M>>>3;return(b[R]|(O<=3?0:b[R+1]<<8))>>>O&31}function he(b,M){var O=M&7,R=M>>>3;return(b[R]|(O<=1?0:b[R+1]<<8))>>>O&127}function Me(b,M,O){var R=M&7,z=M>>>3,H=(1<<O)-1,ne=b[z]>>>R;return O<8-R||(ne|=b[z+1]<<8-R,O<16-R)||(ne|=b[z+2]<<16-R,O<24-R)||(ne|=b[z+3]<<24-R),ne&H}function He(b,M,O){var R=M&7,z=M>>>3;return R<=5?b[z]|=(O&7)<<R:(b[z]|=O<<R&255,b[z+1]=(O&7)>>8-R),M+3}function nt(b,M,O){var R=M&7,z=M>>>3;return O=(O&1)<<R,b[z]|=O,M+1}function kt(b,M,O){var R=M&7,z=M>>>3;return O<<=R,b[z]|=O&255,O>>>=8,b[z+1]=O,M+8}function Bt(b,M,O){var R=M&7,z=M>>>3;return O<<=R,b[z]|=O&255,O>>>=8,b[z+1]=O&255,b[z+2]=O>>>8,M+16}function pt(b,M){var O=b.length,R=2*O>M?2*O:M+5,z=0;if(O>=M)return b;if(ht){var H=Kg(R);if(b.copy)b.copy(H);else for(;z<b.length;++z)H[z]=b[z];return H}else if(Ne){var ne=new Uint8Array(R);if(ne.set)ne.set(b);else for(;z<O;++z)ne[z]=b[z];return ne}return b.length=R,b}function _t(b){for(var M=new Array(b),O=0;O<b;++O)M[O]=0;return M}function Nt(b,M,O){var R=1,z=0,H=0,ne=0,ge=0,se=b.length,oe=Ne?new Uint16Array(32):_t(32);for(H=0;H<32;++H)oe[H]=0;for(H=se;H<O;++H)b[H]=0;se=b.length;var le=Ne?new Uint16Array(se):_t(se);for(H=0;H<se;++H)oe[z=b[H]]++,R<z&&(R=z),le[H]=0;for(oe[0]=0,H=1;H<=R;++H)oe[H+16]=ge=ge+oe[H-1]<<1;for(H=0;H<se;++H)ge=b[H],ge!=0&&(le[H]=oe[ge+16]++);var Te=0;for(H=0;H<se;++H)if(Te=b[H],Te!=0)for(ge=G(le[H],R)>>R-Te,ne=(1<<R+4-Te)-1;ne>=0;--ne)M[ge|ne<<Te]=Te&15|H<<4;return R}var dr=Ne?new Uint16Array(512):_t(512),Nr=Ne?new Uint16Array(32):_t(32);if(!Ne){for(var $t=0;$t<512;++$t)dr[$t]=0;for($t=0;$t<32;++$t)Nr[$t]=0}(function(){for(var b=[],M=0;M<32;M++)b.push(5);Nt(b,Nr,32);var O=[];for(M=0;M<=143;M++)O.push(8);for(;M<=255;M++)O.push(9);for(;M<=279;M++)O.push(7);for(;M<=287;M++)O.push(8);Nt(O,dr,288)})();var Ar=function(){for(var M=Ne?new Uint8Array(32768):[],O=0,R=0;O<ke.length-1;++O)for(;R<ke[O+1];++R)M[R]=O;for(;R<32768;++R)M[R]=29;var z=Ne?new Uint8Array(259):[];for(O=0,R=0;O<ae.length-1;++O)for(;R<ae[O+1];++R)z[R]=O;function H(ge,se){for(var oe=0;oe<ge.length;){var le=Math.min(65535,ge.length-oe),Te=oe+le==ge.length;for(se.write_shift(1,+Te),se.write_shift(2,le),se.write_shift(2,~le&65535);le-- >0;)se[se.l++]=ge[oe++]}return se.l}function ne(ge,se){for(var oe=0,le=0,Te=Ne?new Uint16Array(32768):[];le<ge.length;){var Pe=Math.min(65535,ge.length-le);if(Pe<10){for(oe=He(se,oe,+(le+Pe==ge.length)),oe&7&&(oe+=8-(oe&7)),se.l=oe/8|0,se.write_shift(2,Pe),se.write_shift(2,~Pe&65535);Pe-- >0;)se[se.l++]=ge[le++];oe=se.l*8;continue}oe=He(se,oe,+(le+Pe==ge.length)+2);for(var De=0;Pe-- >0;){var Ae=ge[le];De=(De<<5^Ae)&32767;var Oe=-1,qe=0;if((Oe=Te[De])&&(Oe|=le&-32768,Oe>le&&(Oe-=32768),Oe<le))for(;ge[Oe+qe]==ge[le+qe]&&qe<250;)++qe;if(qe>2){Ae=z[qe],Ae<=22?oe=kt(se,oe,we[Ae+1]>>1)-1:(kt(se,oe,3),oe+=5,kt(se,oe,we[Ae-23]>>5),oe+=3);var Ft=Ae<8?0:Ae-4>>2;Ft>0&&(Bt(se,oe,qe-ae[Ae]),oe+=Ft),Ae=M[le-Oe],oe=kt(se,oe,we[Ae]>>3),oe-=3;var Ot=Ae<4?0:Ae-2>>1;Ot>0&&(Bt(se,oe,le-Oe-ke[Ae]),oe+=Ot);for(var hr=0;hr<qe;++hr)Te[De]=le&32767,De=(De<<5^ge[le])&32767,++le;Pe-=qe-1}else Ae<=143?Ae=Ae+48:oe=nt(se,oe,1),oe=kt(se,oe,we[Ae]),Te[De]=le&32767,++le}oe=kt(se,oe,0)-1}return se.l=(oe+7)/8|0,se.l}return function(se,oe){return se.length<8?H(se,oe):ne(se,oe)}}();function Ze(b){var M=or(50+Math.floor(b.length*1.1)),O=Ar(b,M);return M.slice(0,O)}var ue=Ne?new Uint16Array(32768):_t(32768),xe=Ne?new Uint16Array(32768):_t(32768),Ce=Ne?new Uint16Array(128):_t(128),Fe=1,Ve=1;function Et(b,M){var O=Se(b,M)+257;M+=5;var R=Se(b,M)+1;M+=5;var z=me(b,M)+4;M+=4;for(var H=0,ne=Ne?new Uint8Array(19):_t(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,oe=Ne?new Uint8Array(8):_t(8),le=Ne?new Uint8Array(8):_t(8),Te=ne.length,Pe=0;Pe<z;++Pe)ne[X[Pe]]=H=Je(b,M),se<H&&(se=H),oe[H]++,M+=3;var De=0;for(oe[0]=0,Pe=1;Pe<=se;++Pe)le[Pe]=De=De+oe[Pe-1]<<1;for(Pe=0;Pe<Te;++Pe)(De=ne[Pe])!=0&&(ge[Pe]=le[De]++);var Ae=0;for(Pe=0;Pe<Te;++Pe)if(Ae=ne[Pe],Ae!=0){De=we[ge[Pe]]>>8-Ae;for(var Oe=(1<<7-Ae)-1;Oe>=0;--Oe)Ce[De|Oe<<Ae]=Ae&7|Pe<<3}var qe=[];for(se=1;qe.length<O+R;)switch(De=Ce[he(b,M)],M+=De&7,De>>>=3){case 16:for(H=3+Ge(b,M),M+=2,De=qe[qe.length-1];H-- >0;)qe.push(De);break;case 17:for(H=3+Je(b,M),M+=3;H-- >0;)qe.push(0);break;case 18:for(H=11+he(b,M),M+=7;H-- >0;)qe.push(0);break;default:qe.push(De),se<De&&(se=De);break}var Ft=qe.slice(0,O),Ot=qe.slice(O);for(Pe=O;Pe<286;++Pe)Ft[Pe]=0;for(Pe=R;Pe<30;++Pe)Ot[Pe]=0;return Fe=Nt(Ft,ue,286),Ve=Nt(Ot,xe,30),M}function it(b,M){if(b[0]==3&&!(b[1]&3))return[Li(M),2];for(var O=0,R=0,z=Kg(M||1<<18),H=0,ne=z.length>>>0,ge=0,se=0;!(R&1);){if(R=Je(b,O),O+=3,R>>>1)R>>1==1?(ge=9,se=5):(O=Et(b,O),ge=Fe,se=Ve);else{O&7&&(O+=8-(O&7));var oe=b[O>>>3]|b[(O>>>3)+1]<<8;if(O+=32,oe>0)for(!M&&ne<H+oe&&(z=pt(z,H+oe),ne=z.length);oe-- >0;)z[H++]=b[O>>>3],O+=8;continue}for(;;){!M&&ne<H+32767&&(z=pt(z,H+32767),ne=z.length);var le=Me(b,O,ge),Te=R>>>1==1?dr[le]:ue[le];if(O+=Te&15,Te>>>=4,!(Te>>>8&255))z[H++]=Te;else{if(Te==256)break;Te-=257;var Pe=Te<8?0:Te-4>>2;Pe>5&&(Pe=0);var De=H+ae[Te];Pe>0&&(De+=Me(b,O,Pe),O+=Pe),le=Me(b,O,se),Te=R>>>1==1?Nr[le]:xe[le],O+=Te&15,Te>>>=4;var Ae=Te<4?0:Te-2>>1,Oe=ke[Te];for(Ae>0&&(Oe+=Me(b,O,Ae),O+=Ae),!M&&ne<De&&(z=pt(z,De+100),ne=z.length);H<De;)z[H]=z[H-Oe],++H}}}return M?[z,O+7>>>3]:[z.slice(0,H),O+7>>>3]}function Xe(b,M){var O=b.slice(b.l||0),R=it(O,M);return b.l+=R[1],R[0]}function Ye(b,M){if(b)typeof console<"u"&&console.error(M);else throw new Error(M)}function lt(b,M){var O=b;wr(O,0);var R=[],z=[],H={FileIndex:R,FullPaths:z};P(H,{root:M.root});for(var ne=O.length-4;(O[ne]!=80||O[ne+1]!=75||O[ne+2]!=5||O[ne+3]!=6)&&ne>=0;)--ne;O.l=ne+4,O.l+=4;var ge=O.read_shift(2);O.l+=6;var se=O.read_shift(4);for(O.l=se,ne=0;ne<ge;++ne){O.l+=20;var oe=O.read_shift(4),le=O.read_shift(4),Te=O.read_shift(2),Pe=O.read_shift(2),De=O.read_shift(2);O.l+=8;var Ae=O.read_shift(4),Oe=l(O.slice(O.l+Te,O.l+Te+Pe));O.l+=Te+Pe+De;var qe=O.l;O.l=Ae+4,ut(O,oe,le,H,Oe),O.l=qe}return H}function ut(b,M,O,R,z){b.l+=2;var H=b.read_shift(2),ne=b.read_shift(2),ge=o(b);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var se=b.read_shift(4),oe=b.read_shift(4),le=b.read_shift(4),Te=b.read_shift(2),Pe=b.read_shift(2),De="",Ae=0;Ae<Te;++Ae)De+=String.fromCharCode(b[b.l++]);if(Pe){var Oe=l(b.slice(b.l,b.l+Pe));(Oe[21589]||{}).mt&&(ge=Oe[21589].mt),((z||{})[21589]||{}).mt&&(ge=z[21589].mt)}b.l+=Pe;var qe=b.slice(b.l,b.l+oe);switch(ne){case 8:qe=ee(b,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var Ft=!1;H&8&&(se=b.read_shift(4),se==134695760&&(se=b.read_shift(4),Ft=!0),oe=b.read_shift(4),le=b.read_shift(4)),oe!=M&&Ye(Ft,"Bad compressed size: "+M+" != "+oe),le!=O&&Ye(Ft,"Bad uncompressed size: "+O+" != "+le),Qt(R,De,qe,{unsafe:!0,mt:ge})}function sr(b,M){var O=M||{},R=[],z=[],H=or(1),ne=O.compression?8:0,ge=0,se=0,oe=0,le=0,Te=0,Pe=b.FullPaths[0],De=Pe,Ae=b.FileIndex[0],Oe=[],qe=0;for(se=1;se<b.FullPaths.length;++se)if(De=b.FullPaths[se].slice(Pe.length),Ae=b.FileIndex[se],!(!Ae.size||!Ae.content||De=="Sh33tJ5")){var Ft=le,Ot=or(De.length);for(oe=0;oe<De.length;++oe)Ot.write_shift(1,De.charCodeAt(oe)&127);Ot=Ot.slice(0,Ot.l),Oe[Te]=qb.buf(Ae.content,0);var hr=Ae.content;ne==8&&(hr=q(hr)),H=or(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ge),H.write_shift(2,ne),Ae.mt?i(H,Ae.mt):H.write_shift(4,0),H.write_shift(-4,Oe[Te]),H.write_shift(4,hr.length),H.write_shift(4,Ae.content.length),H.write_shift(2,Ot.length),H.write_shift(2,0),le+=H.length,R.push(H),le+=Ot.length,R.push(Ot),le+=hr.length,R.push(hr),H=or(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ge),H.write_shift(2,ne),H.write_shift(4,0),H.write_shift(-4,Oe[Te]),H.write_shift(4,hr.length),H.write_shift(4,Ae.content.length),H.write_shift(2,Ot.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,Ft),qe+=H.l,z.push(H),qe+=Ot.length,z.push(Ot),++Te}return H=or(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Te),H.write_shift(2,Te),H.write_shift(4,qe),H.write_shift(4,le),H.write_shift(2,0),di([di(R),di(z),H])}var Tt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function at(b,M){if(b.ctype)return b.ctype;var O=b.name||"",R=O.match(/\.([^\.]+)$/);return R&&Tt[R[1]]||M&&(R=(O=M).match(/[\.\\]([^\.\\])+$/),R&&Tt[R[1]])?Tt[R[1]]:"application/octet-stream"}function re(b){for(var M=Yg(b),O=[],R=0;R<M.length;R+=76)O.push(M.slice(R,R+76));return O.join(`\r
`)+`\r
`}function ye(b){var M=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],R=M.split(`\r
`),z=0;z<R.length;++z){var H=R[z];if(H.length==0){O.push("");continue}for(var ne=0;ne<H.length;){var ge=76,se=H.slice(ne,ne+ge);se.charAt(ge-1)=="="?ge--:se.charAt(ge-2)=="="?ge-=2:se.charAt(ge-3)=="="&&(ge-=3),se=H.slice(ne,ne+ge),ne+=ge,ne<H.length&&(se+="="),O.push(se)}}return O.join(`\r
`)}function ze(b){for(var M=[],O=0;O<b.length;++O){for(var R=b[O];O<=b.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+b[++O];M.push(R)}for(var z=0;z<M.length;++z)M[z]=M[z].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Zn(M.join(`\r
`))}function st(b,M,O){for(var R="",z="",H="",ne,ge=0;ge<10;++ge){var se=M[ge];if(!se||se.match(/^\s*$/))break;var oe=se.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":R=oe[2].trim();break;case"content-type":H=oe[2].trim();break;case"content-transfer-encoding":z=oe[2].trim();break}}switch(++ge,z.toLowerCase()){case"base64":ne=Zn(_n(M.slice(ge).join("")));break;case"quoted-printable":ne=ze(M.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var le=Qt(b,R.slice(O.length),ne,{unsafe:!0});H&&(le.ctype=H)}function dt(b,M){if(U(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=M&&M.root||"",R=(ht&&Buffer.isBuffer(b)?b.toString("binary"):U(b)).split(`\r
`),z=0,H="";for(z=0;z<R.length;++z)if(H=R[z],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),O||(O=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),H.slice(0,O.length)!=O););var ne=(R[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var ge="--"+(ne[1]||""),se=[],oe=[],le={FileIndex:se,FullPaths:oe};P(le);var Te,Pe=0;for(z=0;z<R.length;++z){var De=R[z];De!==ge&&De!==ge+"--"||(Pe++&&st(le,R.slice(Te,z),O),Te=z)}return le}function St(b,M){var O=M||{},R=O.boundary||"SheetJS";R="------="+R;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],H=b.FullPaths[0],ne=H,ge=b.FileIndex[0],se=1;se<b.FullPaths.length;++se)if(ne=b.FullPaths[se].slice(H.length),ge=b.FileIndex[se],!(!ge.size||!ge.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var oe=ge.content,le=ht&&Buffer.isBuffer(oe)?oe.toString("binary"):U(oe),Te=0,Pe=Math.min(1024,le.length),De=0,Ae=0;Ae<=Pe;++Ae)(De=le.charCodeAt(Ae))>=32&&De<128&&++Te;var Oe=Te>=Pe*4/5;z.push(R),z.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ne),z.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),z.push("Content-Type: "+at(ge,ne)),z.push(""),z.push(Oe?ye(le):re(le))}return z.push(R+`--\r
`),z.join(`\r
`)}function Gt(b){var M={};return P(M,b),M}function Qt(b,M,O,R){var z=R&&R.unsafe;z||P(b);var H=!z&&gt.find(b,M);if(!H){var ne=b.FullPaths[0];M.slice(0,ne.length)==ne?ne=M:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+M).replace("//","/")),H={name:a(M),type:2},b.FileIndex.push(H),b.FullPaths.push(ne),z||gt.utils.cfb_gc(b)}return H.content=O,H.size=O?O.length:0,R&&(R.CLSID&&(H.clsid=R.CLSID),R.mt&&(H.mt=R.mt),R.ct&&(H.ct=R.ct)),H}function aa(b,M){P(b);var O=gt.find(b,M);if(O){for(var R=0;R<b.FileIndex.length;++R)if(b.FileIndex[R]==O)return b.FileIndex.splice(R,1),b.FullPaths.splice(R,1),!0}return!1}function Lr(b,M,O){P(b);var R=gt.find(b,M);if(R){for(var z=0;z<b.FileIndex.length;++z)if(b.FileIndex[z]==R)return b.FileIndex[z].name=a(O),b.FullPaths[z]=O,!0}return!1}function Ie(b){j(b,!0)}return t.find=B,t.read=D,t.parse=h,t.write=te,t.writeFile=Q,t.utils={cfb_new:Gt,cfb_add:Qt,cfb_del:aa,cfb_mov:Lr,cfb_gc:Ie,ReadShift:kl,CheckField:K2,prep_blob:wr,bconcat:di,use_zlib:F,_deflateRaw:Ze,_inflateRaw:Xe,consts:J},t}();function Yb(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function wa(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function tm(e){for(var t=[],r=wa(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var vf=new Date(1899,11,30,0,0,0);function Kr(e,t){var r=e.getTime(),n=vf.getTime()+(e.getTimezoneOffset()-vf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var L2=new Date,Kb=vf.getTime()+(L2.getTimezoneOffset()-vf.getTimezoneOffset())*6e4,ix=L2.getTimezoneOffset();function Qf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Kb),t.getTimezoneOffset()!==ix&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ix)*6e4),t}function Jb(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var sx=new Date("2017-02-19T19:06:09.000Z"),P2=isNaN(sx.getFullYear())?new Date("2/19/17"):sx,Qb=P2.getFullYear()==2017;function vr(e,t){var r=new Date(e);if(Qb)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(P2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function gs(e,t){if(ht&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return fl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return fl(x2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return fl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return fl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Tr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Tr(e[r]));return t}function Xt(e,t){for(var r="";r.length<t;)r+=e;return r}function Jn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var eN=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&eN.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var tN=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(a),o.push(i[l]);return o}}();function F2(e){return e?e.content&&e.type?gs(e.content,!0):e.data?ll(e.data):e.asNodeBuffer&&ht?ll(e.asNodeBuffer().toString("binary")):e.asBinary?ll(e.asBinary()):e._data&&e._data.getContent?ll(gs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function O2(e){if(!e)return null;if(e.data)return Xg(e.data);if(e.asNodeBuffer&&ht)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Xg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function rN(e){return e&&e.name.slice(-4)===".bin"?O2(e):F2(e)}function bn(e,t){for(var r=e.FullPaths||wa(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function rm(e,t){var r=bn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function nr(e,t,r){if(!r)return rN(rm(e,t));if(!t)return null;try{return nr(e,t)}catch{return null}}function pn(e,t,r){if(!r)return F2(rm(e,t));if(!t)return null;try{return pn(e,t)}catch{return null}}function nN(e,t,r){return O2(rm(e,t))}function ox(e){for(var t=e.FullPaths||wa(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function aN(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ht?n=ws(r):n=Eb(r),gt.utils.cfb_add(e,t,n)}gt.utils.cfb_add(e,t,r)}else e.file(t,r)}function M2(e,t){switch(t.type){case"base64":return gt.read(e,{type:"base64"});case"binary":return gt.read(e,{type:"binary"});case"buffer":case"array":return gt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ul(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var R2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,iN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,lx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,sN=/<[^>]*>/g,Vr=R2.match(lx)?lx:sN,oN=/<\w*:/,lN=/<(\/?)\w+:/;function $e(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(iN),l=0,u="",f=0,h="",m="",g=1;if(o)for(f=0;f!=o.length;++f){for(m=o[f],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(h=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(g=(a=m.charCodeAt(i+1))==34||a==39?1:0,u=m.slice(i+1+g,m.length-g),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=u,n[h.toLowerCase()]=u;else{var x=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[x]&&h.slice(l-3,l)=="ext")continue;n[x]=u,n[x.toLowerCase()]=u}}return n}function Ea(e){return e.replace(lN,"<$1")}var D2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cN=tm(D2),wt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,u){return D2[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),uN=/[&<>'"]/g,fN=/[\u0000-\u001f]/g;function nm(e){var t=e+"";return t.replace(uN,function(r){return cN[r]}).replace(/\n/g,"<br/>").replace(fN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var cx=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Dt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ld(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function ux(e){var t=Li(2*e.length),r,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function fx(e){return ws(e,"binary").toString("utf8")}var lu="foo bar baz",Pt=ht&&(fx(lu)==ld(lu)&&fx||ux(lu)==ld(lu)&&ux)||ld,fl=ht?function(e){return ws(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Kl=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),I2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),dN=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),hN=/<\/?(?:vt:)?variant>/g,pN=/<(?:vt:)([^>]*)>([\s\S]*)</;function dx(e,t){var r=$e(e),n=e.match(dN(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(hN,"").match(pN);o&&a.push({v:Pt(o[2]),t:o[1]})}),a}var mN=/(^\s|\s$|\n)/;function gN(e){return wa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function xN(e,t,r){return"<"+e+(r!=null?gN(r):"")+(t!=null?(t.match(mN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function am(e){if(ht&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pt(ks(Jp(e)));throw new Error("Bad input format: expected Buffer or string")}var Jl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vN={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_N=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function yN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function wN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var hx=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},px=ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ws(t)})):hx(e)}:hx,mx=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(za(e,a)));return n.join("").replace(Yr,"")},im=ht?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Yr,""):mx(e,t,r)}:mx,gx=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},j2=ht?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gx(e,t,r)}:gx,xx=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Bs(e,a)));return n.join("")},xc=ht?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):xx(t,r,n)}:xx,B2=function(e,t){var r=hn(e,t);return r>0?xc(e,t+4,t+4+r-1):""},z2=B2,U2=function(e,t){var r=hn(e,t);return r>0?xc(e,t+4,t+4+r-1):""},H2=U2,V2=function(e,t){var r=2*hn(e,t);return r>0?xc(e,t+4,t+4+r-1):""},W2=V2,$2=function(t,r){var n=hn(t,r);return n>0?im(t,r+4,r+4+n):""},G2=$2,Z2=function(e,t){var r=hn(e,t);return r>0?xc(e,t+4,t+4+r):""},X2=Z2,q2=function(e,t){return yN(e,t)},_f=q2,Y2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ht&&(z2=function(t,r){if(!Buffer.isBuffer(t))return B2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},H2=function(t,r){if(!Buffer.isBuffer(t))return U2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},W2=function(t,r){if(!Buffer.isBuffer(t))return V2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},G2=function(t,r){if(!Buffer.isBuffer(t))return $2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},X2=function(t,r){if(!Buffer.isBuffer(t))return Z2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},_f=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):q2(t,r)},Y2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Bs=function(e,t){return e[t]},za=function(e,t){return e[t+1]*256+e[t]},kN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},hn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},EN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kl(e,t){var r="",n,a,i=[],o,l,u,f;switch(t){case"dbcs":if(f=this.l,ht&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(za(this,f)),f+=2;e*=2;break;case"utf8":r=xc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=im(this,this.l,this.l+e);break;case"wstr":return kl.call(this,e,"dbcs");case"lpstr-ansi":r=z2(this,this.l),e=4+hn(this,this.l);break;case"lpstr-cp":r=H2(this,this.l),e=4+hn(this,this.l);break;case"lpwstr":r=W2(this,this.l),e=4+2*hn(this,this.l);break;case"lpp4":e=4+hn(this,this.l),r=G2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+hn(this,this.l),r=X2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Bs(this,this.l+e++))!==0;)i.push(ou(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=za(this,this.l+e))!==0;)i.push(ou(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Bs(this,f),this.l=f+1,l=kl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(ou(za(this,f))),f+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Bs(this,f),this.l=f+1,l=kl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(ou(Bs(this,f))),f+=1}r=i.join("");break;default:switch(e){case 1:return n=Bs(this,this.l),this.l++,n;case 2:return n=(t==="i"?kN:za)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Zi:EN)(this,this.l),this.l+=4,n):(a=hn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=_f(this,this.l):a=_f([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=j2(this,this.l,e);break}}return this.l+=e,r}var SN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},TN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},CN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function bN(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)CN(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,SN(this,t,this.l);break;case 8:if(n=8,r==="f"){wN(this,t,this.l);break}case 16:break;case-4:n=4,TN(this,t,this.l);break}return this.l+=n,this}function K2(e,t){var r=j2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=kl,e.chk=K2,e.write_shift=bN}function Hr(e,t){e.l+=t}function or(e){var t=Li(e);return wr(t,0),t}function ei(e,t,r){if(e){var n,a,i;wr(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var f=Tf[l]||Tf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;u=e.l+i;var h=f.f&&f.f(e,i,r);if(e.l=u,t(h,f,l))return}}}function Th(){var e=[],t=ht?256:2048,r=function(f){var h=or(f);return wr(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},o=function(){return a(),di(e)},l=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function El(e,t,r){var n=Tr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vx(e,t,r){var n=Tr(e);return n.s=El(n.s,t.s,r),n.e=El(n.e,t.s,r),n}function Sl(e,t){if(e.cRel&&e.c<0)for(e=Tr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Tr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ke(e);return!e.cRel&&e.cRel!=null&&(r=LN(r)),!e.rRel&&e.rRel!=null&&(r=NN(r)),r}function cd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ur(e.s.c)+":"+(e.e.cRel?"":"$")+ur(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Cr(e.s.r)+":"+(e.e.rRel?"":"$")+Cr(e.e.r):Sl(e.s,t.biff)+":"+Sl(e.e,t.biff)}function sm(e){return parseInt(AN(e),10)-1}function Cr(e){return""+(e+1)}function NN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function AN(e){return e.replace(/\$(\d+)$/,"$1")}function om(e){for(var t=PN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ur(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function LN(e){return e.replace(/^([A-Z])/,"$$$1")}function PN(e){return e.replace(/^\$([A-Z])/,"$1")}function FN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ke(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Oo(e){var t=e.indexOf(":");return t==-1?{s:Xr(e),e:Xr(e)}:{s:Xr(e.slice(0,t)),e:Xr(e.slice(t+1))}}function xt(e,t){return typeof t>"u"||typeof t=="number"?xt(e.s,e.e):(typeof e!="string"&&(e=Ke(e)),typeof t!="string"&&(t=Ke(t)),e==t?e:e+":"+t)}function qt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function _x(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dn(e.z,r?Kr(t):t)}catch{}try{return e.w=Dn((e.XF||{}).numFmtId||(r?14:0),r?Kr(t):t)}catch{return""+t}}function Ya(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ts[e.v]||e.v:t==null?_x(e,e.v):_x(e,t))}function Di(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function J2(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Xr(n.origin):n.origin;o=u.r,l=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=qt(i["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(f.e.r=o=h.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var x={v:t[m][g]},_=o+m,y=l+g;if(f.s.r>_&&(f.s.r=_),f.s.c>y&&(f.s.c=y),f.e.r<_&&(f.e.r=_),f.e.c<y&&(f.e.c=y),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))x=t[m][g];else if(Array.isArray(x.v)&&(x.f=t[m][g][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||tt[14],n.cellDates?(x.t="d",x.w=Dn(x.z,Kr(x.v))):(x.t="n",x.v=Kr(x.v),x.w=Dn(x.z,x.v))):x.t="s";if(a)i[_]||(i[_]=[]),i[_][y]&&i[_][y].z&&(x.z=i[_][y].z),i[_][y]=x;else{var E=Ke({c:y,r:_});i[E]&&i[E].z&&(x.z=i[E].z),i[E]=x}}}return f.s.c<1e7&&(i["!ref"]=xt(f)),i}function Mo(e,t){return J2(null,e,t)}function ON(e){return e.read_shift(4,"i")}function zr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function MN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lm(e,t){var r=e.l,n=e.read_shift(1),a=zr(e),i=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)i.push(MN(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var RN=lm;function In(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Es(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var DN=zr;function cm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var IN=zr,Ch=cm;function um(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?_f([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zi(t,0)>>2;return r?a/100:a}function Q2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ss=Q2;function jr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function jN(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=ss[a];f&&(t.rgb=ec(f));break;case 2:t.rgb=ec([o,l,u]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function BN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function ew(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function zN(e){return ew(e,1)}function UN(e){return ew(e,2)}var fm=2,tn=3,cu=11,yx=12,yf=19,uu=64,HN=65,VN=71,WN=4108,$N=4126,mr=80,tw=81,GN=[mr,tw],ZN={1:{n:"CodePage",t:fm},2:{n:"Category",t:mr},3:{n:"PresentationFormat",t:mr},4:{n:"ByteCount",t:tn},5:{n:"LineCount",t:tn},6:{n:"ParagraphCount",t:tn},7:{n:"SlideCount",t:tn},8:{n:"NoteCount",t:tn},9:{n:"HiddenCount",t:tn},10:{n:"MultimediaClipCount",t:tn},11:{n:"ScaleCrop",t:cu},12:{n:"HeadingPairs",t:WN},13:{n:"TitlesOfParts",t:$N},14:{n:"Manager",t:mr},15:{n:"Company",t:mr},16:{n:"LinksUpToDate",t:cu},17:{n:"CharacterCount",t:tn},19:{n:"SharedDoc",t:cu},22:{n:"HyperlinksChanged",t:cu},23:{n:"AppVersion",t:tn,p:"version"},24:{n:"DigSig",t:HN},26:{n:"ContentType",t:mr},27:{n:"ContentStatus",t:mr},28:{n:"Language",t:mr},29:{n:"Version",t:mr},255:{},2147483648:{n:"Locale",t:yf},2147483651:{n:"Behavior",t:yf},1919054434:{}},XN={1:{n:"CodePage",t:fm},2:{n:"Title",t:mr},3:{n:"Subject",t:mr},4:{n:"Author",t:mr},5:{n:"Keywords",t:mr},6:{n:"Comments",t:mr},7:{n:"Template",t:mr},8:{n:"LastAuthor",t:mr},9:{n:"RevNumber",t:mr},10:{n:"EditTime",t:uu},11:{n:"LastPrinted",t:uu},12:{n:"CreatedDate",t:uu},13:{n:"ModifiedDate",t:uu},14:{n:"PageCount",t:tn},15:{n:"WordCount",t:tn},16:{n:"CharCount",t:tn},17:{n:"Thumbnail",t:VN},18:{n:"Application",t:mr},19:{n:"DocSecurity",t:tn},255:{},2147483648:{n:"Locale",t:yf},2147483651:{n:"Behavior",t:yf},1919054434:{}},wx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},qN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function YN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var KN=YN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ss=Tr(KN),Ts={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},kx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function JN(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function QN(e){var t=JN();if(!e||!e.match)return t;var r={};if((e.match(Vr)||[]).forEach(function(n){var a=$e(n);switch(a[0].replace(oN,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[kx[a.ContentType]]!==void 0&&t[kx[a.ContentType]].push(a.PartName);break}}),t.xmlns!==vN.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var to={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function bh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Tl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Vr)||[]).forEach(function(a){var i=$e(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:ul(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}var eA="application/vnd.oasis.opendocument.spreadsheet";function tA(e,t){for(var r=am(e),n,a;n=Jl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=$e(n[0],!1),a.path=="/"&&a.type!==eA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Cl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],rA=function(){for(var e=new Array(Cl.length),t=0;t<Cl.length;++t){var r=Cl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function nw(e){var t={};e=Pt(e);for(var r=0;r<Cl.length;++r){var n=Cl[r],a=e.match(rA[r]);a!=null&&a.length>0&&(t[n[1]]=wt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=vr(t[n[1]]))}return t}var nA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function aw(e,t,r,n){var a=[];if(typeof e=="string")a=dx(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var o=typeof t=="string"?dx(t,n).map(function(h){return h.v}):t,l=0,u=0;if(o.length>0)for(var f=0;f!==a.length;f+=2){switch(u=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function aA(e,t,r){var n={};return t||(t={}),e=Pt(e),nA.forEach(function(a){var i=(e.match(Kl(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=wt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&aw(n.HeadingPairs,n.TitlesOfParts,t,r),t}var iA=/<[^>]+>[^<]*/g;function sA(e,t){var r={},n="",a=e.match(iA);if(a)for(var i=0;i!=a.length;++i){var o=a[i],l=$e(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),f=u[0].slice(4),h=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=wt(h);break;case"bool":r[n]=Dt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=vr(h);break;case"cy":case"error":r[n]=wt(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var oA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ud;function lA(e,t,r){ud||(ud=tm(oA)),t=ud[t]||t,e[t]=r}function dm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function iw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function sw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function ow(e,t,r){return t===31?sw(e):iw(e,t,r)}function Nh(e,t,r){return ow(e,t,r===!1?0:4)}function cA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ow(e,t,0)}function uA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Yr,""),e.l-a&2&&(e.l+=2)}return r}function fA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Yr,"");return r}function dA(e){var t=e.l,r=wf(e,tw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=wf(e,tn);return[r,n]}function hA(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(dA(e));return r}function Ex(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Yr,"").replace(cl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function lw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function pA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function wf(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==yx&&n!==t&&GN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===yx?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return iw(e,n,4).replace(Yr,"");case 31:return sw(e);case 64:return dm(e);case 65:return lw(e);case 71:return pA(e);case 80:return Nh(e,n,!i.raw).replace(Yr,"");case 81:return cA(e,n).replace(Yr,"");case 4108:return hA(e);case 4126:case 4127:return n==4127?uA(e):fA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Sx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,l=0,u=-1,f={};for(o=0;o!=a;++o){var h=e.read_shift(4),m=e.read_shift(4);i[o]=[h,m+r]}i.sort(function(S,w){return S[1]-w[1]});var g={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var x=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],x=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(x=!1,e.l=i[o][1]),x)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var _=t[i[o][0]];if(g[_.n]=wf(e,_.t,{raw:!0}),_.p==="version"&&(g[_.n]=String(g[_.n]>>16)+"."+("0000"+String(g[_.n]&65535)).slice(-4)),_.n=="CodePage")switch(g[_.n]){case 0:g[_.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xn(l=g[_.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[_.n])}}else if(i[o][0]===1){if(l=g.CodePage=wf(e,fm),Xn(l),u!==-1){var y=e.l;e.l=i[u][1],f=Ex(e,l),e.l=y}}else if(i[o][0]===0){if(l===0){u=o,e.l=i[o+1][1];continue}f=Ex(e,l)}else{var E=f[i[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=lw(e);break;case 30:e.l+=4,k=Nh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Nh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Kt(e,4);break;case 64:e.l+=4,k=vr(dm(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[E]=k}}return e.l=r+n,g}function Tx(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var a,i,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==gt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=Sx(n,t),g={SystemIdentifier:f};for(var x in m)g[x]=m[x];if(g.FMTID=i,a===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var _;try{_=Sx(n,null)}catch{}for(x in _)g[x]=_[x];return g.FMTID=[i,o],g}function ii(e,t){return e.read_shift(t),null}function mA(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Kt(e,t){return e.read_shift(t)===1}function ar(e){return e.read_shift(2,"u")}function cw(e,t){return mA(e,t,ar)}function gA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function vc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function xA(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,l,u={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*o),n&&(e.l+=l),u.t=h,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function xs(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function _c(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):xs(e,n,r)}function Cs(e,t,r){if(r.biff>5)return _c(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function vA(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function _A(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Yr,"");return n&&(e.l+=24),a}function yA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Yr,"");return r+o}function wA(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return _A(e);case"0303000000000000c000000000000046":return yA(e);default:throw new Error("Unsupported Moniker "+r)}}function fu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Yr,""):"";return r}function kA(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,l,u,f="",h,m;a&16&&(i=fu(e,r-e.l)),a&128&&(o=fu(e,r-e.l)),(a&257)===257&&(l=fu(e,r-e.l)),(a&257)===1&&(u=wA(e,r-e.l)),a&8&&(f=fu(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(m=dm(e)),e.l=r;var g=o||l||u||"";g&&f&&(g+="#"+f),g||(g="#"+f),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var x={Target:g};return h&&(x.guid=h),m&&(x.time=m),i&&(x.Tooltip=i),x}function uw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function fw(e,t){var r=uw(e);return r[3]=0,r}function Sa(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function EA(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function SA(e,t,r){return t===0?"":Cs(e,t,r)}function TA(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function dw(e){var t=e.read_shift(2),r=um(e);return[t,r]}function CA(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=vc(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function e0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function hw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var bA=hw;function pw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function NA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function AA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Or(e){e.l+=2,e.l+=e.read_shift(2)}var LA={0:Or,4:Or,5:Or,6:Or,7:AA,8:Or,9:Or,10:Or,11:Or,12:Or,13:NA,14:Or,15:Or,16:Or,17:Or,18:Or,19:Or,20:Or,21:pw};function PA(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(LA[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function du(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function FA(e,t){return t===0||e.read_shift(2),1200}function OA(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Cs(e,0,r);return e.read_shift(t+n-e.l),a}function MA(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function RA(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=vc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function DA(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(xA(e));return i.Count=n,i.Unique=a,i}function IA(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function jA(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function BA(e){var t=EA(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function zA(e){return e.read_shift(2),e.read_shift(4)}function Cx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function UA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:l,Selected:u,TabRatio:f}}function HA(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function VA(){}function WA(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=vc(e,0,r),n}function $A(e){var t=Sa(e);return t.isst=e.read_shift(4),t}function GA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Sa(e);r.biff==2&&e.l++;var i=_c(e,n-e.l,r);return a.val=i,a}function ZA(e,t,r){var n=e.read_shift(2),a=Cs(e,0,r);return[n,a]}var XA=Cs;function bx(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c:u}}}function qA(e){var t=e.read_shift(2),r=e.read_shift(2),n=dw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function YA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(dw(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function KA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function JA(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return a.patternType=qN[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function QA(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=JA(e,t,n.fStyle,r),n}function e5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Nx(e,t,r){var n=Sa(e);(r.biff==2||t==9)&&++e.l;var a=gA(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function t5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Sa(e),a=jr(e);return n.val=a,n}var Ax=SA;function r5(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=xs(e,i),l=[];n>e.l;)l.push(_c(e));return[i,a,o,l]}function Lx(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=CA(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var n5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Px(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=xs(e,o,r);a&32&&(f=n5[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var m=n==e.l||l===0||!(h>0)?[]:j6(e,h,r,l);return{chKey:i,Name:f,itab:u,rgce:m}}function mw(e,t,r){if(r.biff<8)return a5(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(TA(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function a5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=vc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function i5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=xs(e,n,r),o=xs(e,a,r);return[i,o]}function s5(e,t,r){var n=hw(e);e.l++;var a=e.read_shift(1);return t-=8,[B6(e,t,r),a,n]}function Fx(e,t,r){var n=bA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,D6(e,t,r)]}function o5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function l5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Cs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,i]}}function c5(e,t,r){return l5(e,t,r)}function u5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(e0(e));return r}function f5(e,t,r){if(r&&r.biff<8)return h5(e,t,r);var n=pw(e),a=PA(e,t-22,n[1]);return{cmo:n,ft:a}}var d5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function h5(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((d5[n]||Hr)(e,t,r)),{cmo:[a,n,i],ft:o}}function p5(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=vA(e,6,r);var l=e.read_shift(2);e.read_shift(2),ar(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],m=xs(e,e.lens[f+1]-e.lens[f]-1);if(a+=m,a.length>=(h?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function m5(e,t){var r=e0(e);e.l+=16;var n=kA(e,t-24);return[r,n]}function g5(e,t){e.read_shift(2);var r=e0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Yr,""),[r,n]}function x5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=wx[r]||r,r=e.read_shift(2),t[1]=wx[r]||r,t}function v5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fw(e));return r}function _5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fw(e));return r}function y5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function gw(e,t,r){if(!r.cellStyles)return Hr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function w5(e,t){var r={};return t<32||(e.l+=16,r.header=jr(e),r.footer=jr(e),e.l+=2),r}function k5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var E5=Sa,S5=cw,T5=_c;function C5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function b5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Sa(e);++e.l;var a=Cs(e,t-7,r);return n.t="str",n.val=a,n}function N5(e){var t=Sa(e);++e.l;var r=jr(e);return t.t="n",t.val=r,t}function A5(e){var t=Sa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function L5(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function P5(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function F5(e,t,r){var n=e.l+t,a=Sa(e),i=e.read_shift(2),o=xs(e,i,r);return e.l=n,a.t="str",a.val=o,a}var O5=[2,3,48,49,131,139,140,245],Ox=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=tm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var f=[],h=Li(1);switch(u.type){case"base64":h=Zn(_n(l));break;case"binary":h=Zn(l);break;case"buffer":case"array":h=l;break}wr(h,0);var m=h.read_shift(1),g=!!(m&136),x=!1,_=!1;switch(m){case 2:break;case 3:break;case 48:x=!0,g=!0;break;case 49:x=!0,g=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,E=521;m==2&&(y=h.read_shift(2)),h.l+=3,m!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(E=h.read_shift(2));var k=h.read_shift(2),S=u.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=e[h[h.l]]),h.l+=1,h.l+=2),_&&(h.l+=36);for(var w=[],A={},I=Math.min(h.length,m==2?521:E-10-(x?264:0)),D=_?32:11;h.l<I&&h[h.l]!=13;)switch(A={},A.name=fi.utils.decode(S,h.slice(h.l,h.l+D)).replace(/[\u0000\r\n].*$/g,""),h.l+=D,A.type=String.fromCharCode(h.read_shift(1)),m!=2&&!_&&(A.offset=h.read_shift(4)),A.len=h.read_shift(1),m==2&&(A.offset=h.read_shift(2)),A.dec=h.read_shift(1),A.name.length&&w.push(A),m!=2&&(h.l+=_?13:14),A.type){case"B":(!x||A.len!=8)&&u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var P=0,W=0;for(f[0]=[],W=0;W!=w.length;++W)f[0][W]=w[W].name;for(;y-- >0;){if(h[h.l]===42){h.l+=k;continue}for(++h.l,f[++P]=[],W=0,W=0;W!=w.length;++W){var j=h.slice(h.l,h.l+w[W].len);h.l+=w[W].len,wr(j,0);var V=fi.utils.decode(S,j);switch(w[W].type){case"C":V.trim().length&&(f[P][W]=V.replace(/\s+$/,""));break;case"D":V.length===8?f[P][W]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):f[P][W]=V;break;case"F":f[P][W]=parseFloat(V.trim());break;case"+":case"I":f[P][W]=_?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":f[P][W]=!0;break;case"N":case"F":f[P][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[P][W]="##MEMO##"+(_?parseInt(V.trim(),10):j.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(f[P][W]=+V||0);break;case"@":f[P][W]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":f[P][W]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":f[P][W]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[P][W]=-j.read_shift(-8,"f");break;case"B":if(x&&w[W].len==8){f[P][W]=j.read_shift(8,"f");break}case"G":case"P":j.l+=w[W].len;break;case"0":if(w[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[W].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=w,f}function n(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var h=Mo(r(l,f),f);return h["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,h}function a(l,u){try{return Di(n(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var f=u||{};if(+f.codepage>=0&&Xn(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=Th(),m=Rh(l,{header:1,raw:!0,cellDates:!0}),g=m[0],x=m.slice(1),_=l["!cols"]||[],y=0,E=0,k=0,S=1;for(y=0;y<g.length;++y){if(((_[y]||{}).DBF||{}).name){g[y]=_[y].DBF.name,++k;continue}if(g[y]!=null){if(++k,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(E=0;E<1024;++E)if(g.indexOf(g[y]+"_"+E)==-1){g[y]+="_"+E;break}}}}var w=qt(l["!ref"]),A=[],I=[],D=[];for(y=0;y<=w.e.c-w.s.c;++y){var P="",W="",j=0,V=[];for(E=0;E<x.length;++E)x[E][y]!=null&&V.push(x[E][y]);if(V.length==0||g[y]==null){A[y]="?";continue}for(E=0;E<V.length;++E){switch(typeof V[E]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=V[E]instanceof Date?"D":"C";break;default:W="C"}j=Math.max(j,String(V[E]).length),P=P&&P!=W?"C":W}j>250&&(j=250),W=((_[y]||{}).DBF||{}).type,W=="C"&&_[y].DBF.len>j&&(j=_[y].DBF.len),P=="B"&&W=="N"&&(P="N",D[y]=_[y].DBF.dec,j=_[y].DBF.len),I[y]=P=="C"||W=="N"?j:i[P]||0,S+=I[y],A[y]=P}var B=h.next(32);for(B.write_shift(4,318902576),B.write_shift(4,x.length),B.write_shift(2,296+32*k),B.write_shift(2,S),y=0;y<4;++y)B.write_shift(4,0);for(B.write_shift(4,0|(+t[m2]||3)<<8),y=0,E=0;y<g.length;++y)if(g[y]!=null){var Z=h.next(32),K=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,K,"sbcs"),Z.write_shift(1,A[y]=="?"?"C":A[y],"sbcs"),Z.write_shift(4,E),Z.write_shift(1,I[y]||i[A[y]]||0),Z.write_shift(1,D[y]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),E+=I[y]||i[A[y]]||0}var ve=h.next(264);for(ve.write_shift(4,13),y=0;y<65;++y)ve.write_shift(4,0);for(y=0;y<x.length;++y){var _e=h.next(S);for(_e.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(A[E]){case"L":_e.write_shift(1,x[y][E]==null?63:x[y][E]?84:70);break;case"B":_e.write_shift(8,x[y][E]||0,"f");break;case"N":var de="0";for(typeof x[y][E]=="number"&&(de=x[y][E].toFixed(D[E]||0)),k=0;k<I[E]-de.length;++k)_e.write_shift(1,32);_e.write_shift(1,de,"sbcs");break;case"D":x[y][E]?(_e.write_shift(4,("0000"+x[y][E].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(x[y][E].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+x[y][E].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var J=String(x[y][E]!=null?x[y][E]:"").slice(0,I[E]);for(_e.write_shift(1,J,"sbcs"),k=0;k<I[E]-J.length;++k)_e.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),M5=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,x){var _=e[x];return typeof _=="number"?qg(_):_},n=function(g,x,_){var y=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return y==59?g:qg(y)};e["|"]=254;function a(g,x){switch(x.type){case"base64":return i(_n(g),x);case"binary":return i(g,x);case"buffer":return i(ht&&Buffer.isBuffer(g)?g.toString("binary"):ks(g),x);case"array":return i(gs(g),x)}throw new Error("Unrecognized type "+x.type)}function i(g,x){var _=g.split(/[\n\r]+/),y=-1,E=-1,k=0,S=0,w=[],A=[],I=null,D={},P=[],W=[],j=[],V=0,B;for(+x.codepage>=0&&Xn(+x.codepage);k!==_.length;++k){V=0;var Z=_[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),K=Z.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),ve=K[0],_e;if(Z.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&A.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,J=!1,Q=!1,U=!1,te=-1,fe=-1;for(S=1;S<K.length;++S)switch(K[S].charAt(0)){case"A":break;case"X":E=parseInt(K[S].slice(1))-1,J=!0;break;case"Y":for(y=parseInt(K[S].slice(1))-1,J||(E=0),B=w.length;B<=y;++B)w[B]=[];break;case"K":_e=K[S].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Jn(_e))?isNaN(Eo(_e).getDate())||(_e=vr(_e)):(_e=Jn(_e),I!==null&&Fo(I)&&(_e=Qf(_e))),de=!0;break;case"E":U=!0;var F=fo(K[S].slice(1),{r:y,c:E});w[y][E]=[w[y][E],F];break;case"S":Q=!0,w[y][E]=[w[y][E],"S5S"];break;case"G":break;case"R":te=parseInt(K[S].slice(1))-1;break;case"C":fe=parseInt(K[S].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Z)}if(de&&(w[y][E]&&w[y][E].length==2?w[y][E][0]=_e:w[y][E]=_e,I=null),Q){if(U)throw new Error("SYLK shared formula cannot have own formula");var ee=te>-1&&w[te][fe];if(!ee||!ee[1])throw new Error("SYLK shared formula cannot find base");w[y][E][1]=Cw(ee[1],{r:y-te,c:E-fe})}break;case"F":var q=0;for(S=1;S<K.length;++S)switch(K[S].charAt(0)){case"X":E=parseInt(K[S].slice(1))-1,++q;break;case"Y":for(y=parseInt(K[S].slice(1))-1,B=w.length;B<=y;++B)w[B]=[];break;case"M":V=parseInt(K[S].slice(1))/20;break;case"F":break;case"G":break;case"P":I=A[parseInt(K[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=K[S].slice(1).split(" "),B=parseInt(j[0],10);B<=parseInt(j[1],10);++B)V=parseInt(j[2],10),W[B-1]=V===0?{hidden:!0}:{wch:V},So(W[B-1]);break;case"C":E=parseInt(K[S].slice(1))-1,W[E]||(W[E]={});break;case"R":y=parseInt(K[S].slice(1))-1,P[y]||(P[y]={}),V>0?(P[y].hpt=V,P[y].hpx=tc(V)):V===0&&(P[y].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Z)}q<1&&(I=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Z)}}return P.length>0&&(D["!rows"]=P),W.length>0&&(D["!cols"]=W),x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),[w,D]}function o(g,x){var _=a(g,x),y=_[0],E=_[1],k=Mo(y,x);return wa(E).forEach(function(S){k[S]=E[S]}),k}function l(g,x){return Di(o(g,x),x)}function u(g,x,_,y){var E="C;Y"+(_+1)+";X"+(y+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+yP(g.f,{r:_,c:y}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function f(g,x){x.forEach(function(_,y){var E="F;W"+(y+1)+" "+(y+1)+" ";_.hidden?E+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Ef(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Sf(_.wpx)),typeof _.wch=="number"&&(E+=Math.round(_.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function h(g,x){x.forEach(function(_,y){var E="F;";_.hidden?E+="M0;":_.hpt?E+="M"+20*_.hpt+";":_.hpx&&(E+="M"+20*Ew(_.hpx)+";"),E.length>2&&g.push(E+"R"+(y+1))})}function m(g,x){var _=["ID;PWXL;N;E"],y=[],E=qt(g["!ref"]),k,S=Array.isArray(g),w=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),g["!cols"]&&f(_,g["!cols"]),g["!rows"]&&h(_,g["!rows"]),_.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var A=E.s.r;A<=E.e.r;++A)for(var I=E.s.c;I<=E.e.c;++I){var D=Ke({r:A,c:I});k=S?(g[A]||[])[I]:g[D],!(!k||k.v==null&&(!k.f||k.F))&&y.push(u(k,g,A,I))}return _.join(w)+w+y.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),R5=function(){function e(i,o){switch(o.type){case"base64":return t(_n(i),o);case"binary":return t(i,o);case"buffer":return t(ht&&Buffer.isBuffer(i)?i.toString("binary"):ks(i),o);case"array":return t(gs(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),u=-1,f=-1,h=0,m=[];h!==l.length;++h){if(l[h].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var g=l[h].trim().split(","),x=g[0],_=g[1];++h;for(var y=l[h]||"";(y.match(/["]/g)||[]).length&1&&h<l.length-1;)y+=`
`+l[++h];switch(y=y.trim(),+x){case-1:if(y==="BOT"){m[++u]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[u][f]=!0:y==="FALSE"?m[u][f]=!1:isNaN(Jn(_))?isNaN(Eo(_).getDate())?m[u][f]=_:m[u][f]=vr(_):m[u][f]=Jn(_),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[u][f++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return Mo(e(i,o),o)}function n(i,o){return Di(r(i,o),o)}var a=function(){var i=function(u,f,h,m,g){u.push(f),u.push(h+","+m),u.push('"'+g.replace(/"/g,'""')+'"')},o=function(u,f,h,m){u.push(f+","+h),u.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var f=[],h=qt(u["!ref"]),m,g=Array.isArray(u);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,h.e.r-h.s.r+1,""),i(f,"TUPLES",0,h.e.c-h.s.c+1,""),i(f,"DATA",0,0,"");for(var x=h.s.r;x<=h.e.r;++x){o(f,-1,0,"BOT");for(var _=h.s.c;_<=h.e.c;++_){var y=Ke({r:x,c:_});if(m=g?(u[x]||[])[_]:u[y],!m){o(f,1,0,"");continue}switch(m.t){case"n":var E=m.w;!E&&m.v!=null&&(E=m.v),E==null?m.f&&!m.F?o(f,1,0,"="+m.f):o(f,1,0,""):o(f,0,E,"V");break;case"b":o(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Dn(m.z||tt[14],Kr(vr(m.v)))),o(f,0,m.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var k=`\r
`,S=f.join(k);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),D5=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var x=m.split(`
`),_=-1,y=-1,E=0,k=[];E!==x.length;++E){var S=x[E].trim().split(":");if(S[0]==="cell"){var w=Xr(S[1]);if(k.length<=w.r)for(_=k.length;_<=w.r;++_)k[_]||(k[_]=[]);switch(_=w.r,y=w.c,S[2]){case"t":k[_][y]=e(S[3]);break;case"v":k[_][y]=+S[3];break;case"vtf":var A=S[S.length-1];case"vtc":switch(S[3]){case"nl":k[_][y]=!!+S[4];break;default:k[_][y]=+S[4];break}S[2]=="vtf"&&(k[_][y]=[k[_][y],A])}}}return g&&g.sheetRows&&(k=k.slice(0,g.sheetRows)),k}function n(m,g){return Mo(r(m,g),g)}function a(m,g){return Di(n(m,g),g)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var g=[],x=[],_,y="",E=Oo(m["!ref"]),k=Array.isArray(m),S=E.s.r;S<=E.e.r;++S)for(var w=E.s.c;w<=E.e.c;++w)if(y=Ke({r:S,c:w}),_=k?(m[S]||[])[w]:m[y],!(!_||_.v==null||_.t==="z")){switch(x=["cell",y,"t"],_.t){case"s":case"str":x.push(t(_.v));break;case"n":_.f?(x[2]="vtf",x[3]="n",x[4]=_.v,x[5]=t(_.f)):(x[2]="v",x[3]=_.v);break;case"b":x[2]="vt"+(_.f?"f":"c"),x[3]="nl",x[4]=_.v?"1":"0",x[5]=t(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var A=Kr(vr(_.v));x[2]="vtc",x[3]="nd",x[4]=""+A,x[5]=_.w||Dn(_.z||tt[14],A);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(m){return[i,o,l,o,f(m),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),Ql=function(){function e(h,m,g,x,_){_.raw?m[g][x]=h:h===""||(h==="TRUE"?m[g][x]=!0:h==="FALSE"?m[g][x]=!1:isNaN(Jn(h))?isNaN(Eo(h).getDate())?m[g][x]=h:m[g][x]=vr(h):m[g][x]=Jn(h))}function t(h,m){var g=m||{},x=[];if(!h||h.length===0)return x;for(var _=h.split(/[\r\n]/),y=_.length-1;y>=0&&_[y].length===0;)--y;for(var E=10,k=0,S=0;S<=y;++S)k=_[S].indexOf(" "),k==-1?k=_[S].length:k++,E=Math.max(E,k);for(S=0;S<=y;++S){x[S]=[];var w=0;for(e(_[S].slice(0,E).trim(),x,S,w,g),w=1;w<=(_[S].length-E)/10+1;++w)e(_[S].slice(E+(w-1)*10,E+w*10).trim(),x,S,w,g)}return g.sheetRows&&(x=x.slice(0,g.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var m={},g=!1,x=0,_=0;x<h.length;++x)(_=h.charCodeAt(x))==34?g=!g:!g&&_ in r&&(m[_]=(m[_]||0)+1);_=[];for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&_.push([m[x],x]);if(!_.length){m=n;for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&_.push([m[x],x])}return _.sort(function(y,E){return y[0]-E[0]||n[y[1]]-n[E[1]]}),r[_.pop()[1]]||44}function i(h,m){var g=m||{},x="",_=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(x=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(x=h.charAt(4),h=h.slice(6)):x=a(h.slice(0,1024)):g&&g.FS?x=g.FS:x=a(h.slice(0,1024));var E=0,k=0,S=0,w=0,A=0,I=x.charCodeAt(0),D=!1,P=0,W=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var j=g.dateNF!=null?Zb(g.dateNF):null;function V(){var B=h.slice(w,A),Z={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)Z.t="z";else if(g.raw)Z.t="s",Z.v=B;else if(B.trim().length===0)Z.t="s",Z.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(Z.t="s",Z.v=B.slice(2,-1).replace(/""/g,'"')):kP(B)?(Z.t="n",Z.f=B.slice(1)):(Z.t="s",Z.v=B);else if(B=="TRUE")Z.t="b",Z.v=!0;else if(B=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(S=Jn(B)))Z.t="n",g.cellText!==!1&&(Z.w=B),Z.v=S;else if(!isNaN(Eo(B).getDate())||j&&B.match(j)){Z.z=g.dateNF||tt[14];var K=0;j&&B.match(j)&&(B=Xb(B,g.dateNF,B.match(j)||[]),K=1),g.cellDates?(Z.t="d",Z.v=vr(B,K)):(Z.t="n",Z.v=Kr(vr(B,K))),g.cellText!==!1&&(Z.w=Dn(Z.z,Z.v instanceof Date?Kr(Z.v):Z.v)),g.cellNF||delete Z.z}else Z.t="s",Z.v=B;if(Z.t=="z"||(g.dense?(_[E]||(_[E]=[]),_[E][k]=Z):_[Ke({c:k,r:E})]=Z),w=A+1,W=h.charCodeAt(w),y.e.c<k&&(y.e.c=k),y.e.r<E&&(y.e.r=E),P==I)++k;else if(k=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;A<h.length;++A)switch(P=h.charCodeAt(A)){case 34:W===34&&(D=!D);break;case I:case 10:case 13:if(!D&&V())break e;break}return A-w>0&&V(),_["!ref"]=xt(y),_}function o(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,m):Mo(t(h,m),m)}function l(h,m){var g="",x=m.type=="string"?[0,0,0,0]:ym(h,m);switch(m.type){case"base64":g=_n(h);break;case"binary":g=h;break;case"buffer":m.codepage==65001?g=h.toString("utf8"):m.codepage&&typeof fi<"u"?g=fi.utils.decode(m.codepage,h):g=ht&&Buffer.isBuffer(h)?h.toString("binary"):ks(h);break;case"array":g=gs(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+m.type)}return x[0]==239&&x[1]==187&&x[2]==191?g=Pt(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=Pt(g):m.type=="binary"&&typeof fi<"u"&&m.codepage&&(g=fi.utils.decode(m.codepage,fi.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?D5.to_sheet(m.type=="string"?g:Pt(g),m):o(g,m)}function u(h,m){return Di(l(h,m),m)}function f(h){for(var m=[],g=qt(h["!ref"]),x,_=Array.isArray(h),y=g.s.r;y<=g.e.r;++y){for(var E=[],k=g.s.c;k<=g.e.c;++k){var S=Ke({r:y,c:k});if(x=_?(h[y]||[])[k]:h[S],!x||x.v==null){E.push("          ");continue}for(var w=(x.w||(Ya(x),x.w)||"").slice(0,10);w.length<10;)w+=" ";E.push(w+(k===0?" ":""))}m.push(E.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}();function I5(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=M5.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Ql.to_workbook(e,t)}}var bl=function(){function e(F,ee,q){if(F){wr(F,F.l||0);for(var X=q.Enum||te;F.l<F.length;){var ae=F.read_shift(2),ke=X[ae]||X[65535],Le=F.read_shift(2),Ne=F.l+Le,we=ke.f&&ke.f(F,Le,q);if(F.l=Ne,ee(we,ke,ae))return}}}function t(F,ee){switch(ee.type){case"base64":return r(Zn(_n(F)),ee);case"binary":return r(Zn(F),ee);case"buffer":case"array":return r(F,ee)}throw"Unsupported type "+ee.type}function r(F,ee){if(!F)return F;var q=ee||{},X=q.dense?[]:{},ae="Sheet1",ke="",Le=0,Ne={},we=[],Be=[],G={s:{r:0,c:0},e:{r:0,c:0}},Ge=q.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)q.Enum=te,e(F,function(he,Me,He){switch(He){case 0:q.vers=he,he>=4096&&(q.qpro=!0);break;case 6:G=he;break;case 204:he&&(ke=he);break;case 222:ke=he;break;case 15:case 51:q.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:He==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=q.dateNF||tt[14],q.cellDates&&(he[1].t="d",he[1].v=Qf(he[1].v))),q.qpro&&he[3]>Le&&(X["!ref"]=xt(G),Ne[ae]=X,we.push(ae),X=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Le=he[3],ae=ke||"Sheet"+(Le+1),ke="");var nt=q.dense?(X[he[0].r]||[])[he[0].c]:X[Ke(he[0])];if(nt){nt.t=he[1].t,nt.v=he[1].v,he[1].z!=null&&(nt.z=he[1].z),he[1].f!=null&&(nt.f=he[1].f);break}q.dense?(X[he[0].r]||(X[he[0].r]=[]),X[he[0].r][he[0].c]=he[1]):X[Ke(he[0])]=he[1];break}},q);else if(F[2]==26||F[2]==14)q.Enum=fe,F[2]==14&&(q.qpro=!0,F.l=0),e(F,function(he,Me,He){switch(He){case 204:ae=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>Le&&(X["!ref"]=xt(G),Ne[ae]=X,we.push(ae),X=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Le=he[3],ae="Sheet"+(Le+1)),Ge>0&&he[0].r>=Ge)break;q.dense?(X[he[0].r]||(X[he[0].r]=[]),X[he[0].r][he[0].c]=he[1]):X[Ke(he[0])]=he[1],G.e.c<he[0].c&&(G.e.c=he[0].c),G.e.r<he[0].r&&(G.e.r=he[0].r);break;case 27:he[14e3]&&(Be[he[14e3][0]]=he[14e3][1]);break;case 1537:Be[he[0]]=he[1],he[0]==Le&&(ae=he[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(X["!ref"]=xt(G),Ne[ke||ae]=X,we.push(ke||ae),!Be.length)return{SheetNames:we,Sheets:Ne};for(var Je={},me=[],Se=0;Se<Be.length;++Se)Ne[we[Se]]?(me.push(Be[Se]||we[Se]),Je[Be[Se]]=Ne[Be[Se]]||Ne[we[Se]]):(me.push(Be[Se]),Je[Be[Se]]={"!ref":"A1"});return{SheetNames:me,Sheets:Je}}function n(F,ee){var q=ee||{};if(+q.codepage>=0&&Xn(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Th(),ae=qt(F["!ref"]),ke=Array.isArray(F),Le=[];Vn(X,0,i(1030)),Vn(X,6,u(ae));for(var Ne=Math.min(ae.e.r,8191),we=ae.s.r;we<=Ne;++we)for(var Be=Cr(we),G=ae.s.c;G<=ae.e.c;++G){we===ae.s.r&&(Le[G]=ur(G));var Ge=Le[G]+Be,Je=ke?(F[we]||[])[G]:F[Ge];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?Vn(X,13,x(we,G,Je.v)):Vn(X,14,y(we,G,Je.v));else{var me=Ya(Je);Vn(X,15,m(we,G,me.slice(0,239)))}}return Vn(X,1),X.end()}function a(F,ee){var q=ee||{};if(+q.codepage>=0&&Xn(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Th();Vn(X,0,o(F));for(var ae=0,ke=0;ae<F.SheetNames.length;++ae)(F.Sheets[F.SheetNames[ae]]||{})["!ref"]&&Vn(X,27,U(F.SheetNames[ae],ke++));var Le=0;for(ae=0;ae<F.SheetNames.length;++ae){var Ne=F.Sheets[F.SheetNames[ae]];if(!(!Ne||!Ne["!ref"])){for(var we=qt(Ne["!ref"]),Be=Array.isArray(Ne),G=[],Ge=Math.min(we.e.r,8191),Je=we.s.r;Je<=Ge;++Je)for(var me=Cr(Je),Se=we.s.c;Se<=we.e.c;++Se){Je===we.s.r&&(G[Se]=ur(Se));var he=G[Se]+me,Me=Be?(Ne[Je]||[])[Se]:Ne[he];if(!(!Me||Me.t=="z"))if(Me.t=="n")Vn(X,23,V(Je,Se,Le,Me.v));else{var He=Ya(Me);Vn(X,22,P(Je,Se,Le,He.slice(0,239)))}}++Le}}return Vn(X,1),X.end()}function i(F){var ee=or(2);return ee.write_shift(2,F),ee}function o(F){var ee=or(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var q=0,X=0,ae=0,ke=0;ke<F.SheetNames.length;++ke){var Le=F.SheetNames[ke],Ne=F.Sheets[Le];if(!(!Ne||!Ne["!ref"])){++ae;var we=Oo(Ne["!ref"]);q<we.e.r&&(q=we.e.r),X<we.e.c&&(X=we.e.c)}}return q>8191&&(q=8191),ee.write_shift(2,q),ee.write_shift(1,ae),ee.write_shift(1,X),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee}function l(F,ee,q){var X={s:{c:0,r:0},e:{c:0,r:0}};return ee==8&&q.qpro?(X.s.c=F.read_shift(1),F.l++,X.s.r=F.read_shift(2),X.e.c=F.read_shift(1),F.l++,X.e.r=F.read_shift(2),X):(X.s.c=F.read_shift(2),X.s.r=F.read_shift(2),ee==12&&q.qpro&&(F.l+=2),X.e.c=F.read_shift(2),X.e.r=F.read_shift(2),ee==12&&q.qpro&&(F.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function u(F){var ee=or(8);return ee.write_shift(2,F.s.c),ee.write_shift(2,F.s.r),ee.write_shift(2,F.e.c),ee.write_shift(2,F.e.r),ee}function f(F,ee,q){var X=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(X[0].c=F.read_shift(1),X[3]=F.read_shift(1),X[0].r=F.read_shift(2),F.l+=2):(X[2]=F.read_shift(1),X[0].c=F.read_shift(2),X[0].r=F.read_shift(2)),X}function h(F,ee,q){var X=F.l+ee,ae=f(F,ee,q);if(ae[1].t="s",q.vers==20768){F.l++;var ke=F.read_shift(1);return ae[1].v=F.read_shift(ke,"utf8"),ae}return q.qpro&&F.l++,ae[1].v=F.read_shift(X-F.l,"cstr"),ae}function m(F,ee,q){var X=or(7+q.length);X.write_shift(1,255),X.write_shift(2,ee),X.write_shift(2,F),X.write_shift(1,39);for(var ae=0;ae<X.length;++ae){var ke=q.charCodeAt(ae);X.write_shift(1,ke>=128?95:ke)}return X.write_shift(1,0),X}function g(F,ee,q){var X=f(F,ee,q);return X[1].v=F.read_shift(2,"i"),X}function x(F,ee,q){var X=or(7);return X.write_shift(1,255),X.write_shift(2,ee),X.write_shift(2,F),X.write_shift(2,q,"i"),X}function _(F,ee,q){var X=f(F,ee,q);return X[1].v=F.read_shift(8,"f"),X}function y(F,ee,q){var X=or(13);return X.write_shift(1,255),X.write_shift(2,ee),X.write_shift(2,F),X.write_shift(8,q,"f"),X}function E(F,ee,q){var X=F.l+ee,ae=f(F,ee,q);if(ae[1].v=F.read_shift(8,"f"),q.qpro)F.l=X;else{var ke=F.read_shift(2);A(F.slice(F.l,F.l+ke),ae),F.l+=ke}return ae}function k(F,ee,q){var X=ee&32768;return ee&=-32769,ee=(X?F:0)+(ee>=8192?ee-16384:ee),(X?"":"$")+(q?ur(ee):Cr(ee))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(F,ee){wr(F,0);for(var q=[],X=0,ae="",ke="",Le="",Ne="";F.l<F.length;){var we=F[F.l++];switch(we){case 0:q.push(F.read_shift(8,"f"));break;case 1:ke=k(ee[0].c,F.read_shift(2),!0),ae=k(ee[0].r,F.read_shift(2),!1),q.push(ke+ae);break;case 2:{var Be=k(ee[0].c,F.read_shift(2),!0),G=k(ee[0].r,F.read_shift(2),!1);ke=k(ee[0].c,F.read_shift(2),!0),ae=k(ee[0].r,F.read_shift(2),!1),q.push(Be+G+":"+ke+ae)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(F.read_shift(2));break;case 6:{for(var Ge="";we=F[F.l++];)Ge+=String.fromCharCode(we);q.push('"'+Ge.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Ne=q.pop(),Le=q.pop(),q.push(["AND","OR"][we-20]+"("+Le+","+Ne+")");break;default:if(we<32&&w[we])Ne=q.pop(),Le=q.pop(),q.push(Le+w[we]+Ne);else if(S[we]){if(X=S[we][1],X==69&&(X=F[F.l++]),X>q.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+q.join("|")+"|");return}var Je=q.slice(-X);q.length-=X,q.push(S[we][0]+"("+Je.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}q.length==1?ee[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function I(F){var ee=[{c:0,r:0},{t:"n",v:0},0];return ee[0].r=F.read_shift(2),ee[3]=F[F.l++],ee[0].c=F[F.l++],ee}function D(F,ee){var q=I(F);return q[1].t="s",q[1].v=F.read_shift(ee-4,"cstr"),q}function P(F,ee,q,X){var ae=or(6+X.length);ae.write_shift(2,F),ae.write_shift(1,q),ae.write_shift(1,ee),ae.write_shift(1,39);for(var ke=0;ke<X.length;++ke){var Le=X.charCodeAt(ke);ae.write_shift(1,Le>=128?95:Le)}return ae.write_shift(1,0),ae}function W(F,ee){var q=I(F);q[1].v=F.read_shift(2);var X=q[1].v>>1;if(q[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return q[1].v=X,q}function j(F,ee){var q=I(F),X=F.read_shift(4),ae=F.read_shift(4),ke=F.read_shift(2);if(ke==65535)return X===0&&ae===3221225472?(q[1].t="e",q[1].v=15):X===0&&ae===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Le=ke&32768;return ke=(ke&32767)-16446,q[1].v=(1-Le*2)*(ae*Math.pow(2,ke+32)+X*Math.pow(2,ke)),q}function V(F,ee,q,X){var ae=or(14);if(ae.write_shift(2,F),ae.write_shift(1,q),ae.write_shift(1,ee),X==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var ke=0,Le=0,Ne=0,we=0;return X<0&&(ke=1,X=-X),Le=Math.log2(X)|0,X/=Math.pow(2,Le-31),we=X>>>0,we&2147483648||(X/=2,++Le,we=X>>>0),X-=we,we|=2147483648,we>>>=0,X*=Math.pow(2,32),Ne=X>>>0,ae.write_shift(4,Ne),ae.write_shift(4,we),Le+=16383+(ke?32768:0),ae.write_shift(2,Le),ae}function B(F,ee){var q=j(F);return F.l+=ee-14,q}function Z(F,ee){var q=I(F),X=F.read_shift(4);return q[1].v=X>>6,q}function K(F,ee){var q=I(F),X=F.read_shift(8,"f");return q[1].v=X,q}function ve(F,ee){var q=K(F);return F.l+=ee-10,q}function _e(F,ee){return F[F.l+ee-1]==0?F.read_shift(ee,"cstr"):""}function de(F,ee){var q=F[F.l++];q>ee-1&&(q=ee-1);for(var X="";X.length<q;)X+=String.fromCharCode(F[F.l++]);return X}function J(F,ee,q){if(!(!q.qpro||ee<21)){var X=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var ae=F.read_shift(ee-21,"cstr");return[X,ae]}}function Q(F,ee){for(var q={},X=F.l+ee;F.l<X;){var ae=F.read_shift(2);if(ae==14e3){for(q[ae]=[0,""],q[ae][0]=F.read_shift(2);F[F.l];)q[ae][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return q}function U(F,ee){var q=or(5+F.length);q.write_shift(2,14e3),q.write_shift(2,ee);for(var X=0;X<F.length;++X){var ae=F.charCodeAt(X);q[q.l++]=ae>127?95:ae}return q[q.l++]=0,q}var te={0:{n:"BOF",f:ar},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function j5(e){var t={},r=e.match(Vr),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=$e(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Yp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var B5=function(){var e=Kl("t"),t=Kl("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:wt(o[1])},u=i.match(t);return u&&(l.s=j5(u[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),z5=function(){var t=/(\r\n|\n)/g;function r(a,i,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),U5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,H5=/<(?:\w+:)?r>/,V5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wt(Pt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pt(e),r&&(n.h=nm(n.t))):e.match(H5)&&(n.r=Pt(e),n.t=wt(Pt((e.replace(V5,"").match(U5)||[]).join("").replace(Vr,""))),r&&(n.h=z5(B5(n.r)))),n):{t:""}}var W5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$5=/<(?:\w+:)?(?:si|sstItem)>/g,G5=/<\/(?:\w+:)?(?:si|sstItem)>/;function Z5(e,t){var r=[],n="";if(!e)return r;var a=e.match(W5);if(a){n=a[2].replace($5,"").split(G5);for(var i=0;i!=n.length;++i){var o=hm(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=$e(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function X5(e){return[e.read_shift(4),e.read_shift(4)]}function q5(e,t){var r=[],n=!1;return ei(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function xw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Wa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Y5(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Wa(e,4),t.U=Wa(e,4),t.W=Wa(e,4),t}function K5(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function J5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(K5(e));return t}function Q5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function eL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Wa(e,4),t.U=Wa(e,4),t.W=Wa(e,4),t}function tL(e){var t=eL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function vw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function _w(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function rL(e){var t=Wa(e);switch(t.Minor){case 2:return[t.Minor,nL(e)];case 3:return[t.Minor,aL()];case 4:return[t.Minor,iL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function nL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=vw(e,r),a=_w(e,e.length-e.l);return{t:"Std",h:n,v:a}}function aL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Vr,function(i){var o=$e(i);switch(Ea(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function sL(e,t){var r={},n=r.EncryptionVersionInfo=Wa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=vw(e,a),t-=a,r.EncryptionVerifier=_w(e,t),r}function oL(e){var t={},r=t.EncryptionVersionInfo=Wa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function lL(e){var t=0,r,n=xw(e),a=n.length+1,i,o,l,u,f;for(r=Li(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],l=t&16384?1:0,u=t<<1&32767,f=l|u,t=f^o;return t^52811}var yw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],u=104,f=o.length-1;f>=0;--f)for(var h=o[f],m=0;m!=7;++m)h&64&&(l^=r[u]),h*=2,--u;return l};return function(o){for(var l=xw(o),u=i(l),f=l.length,h=Li(16),m=0;m!=16;++m)h[m]=0;var g,x,_;for((f&1)===1&&(g=u>>8,h[f]=a(e[0],g),--f,g=u&255,x=l[l.length-1],h[f]=a(x,g));f>0;)--f,g=u>>8,h[f]=a(l[f],g),--f,g=u&255,h[f]=a(l[f],g);for(f=15,_=15-l.length;_>0;)g=u>>8,h[f]=a(e[_],g),--f,--_,g=u&255,h[f]=a(l[f],g),--f,--_;return h}}(),cL=function(e,t,r,n,a){a||(a=t),n||(n=yw(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},uL=function(e){var t=0,r=yw(e);return function(n){var a=cL("",n,t,r);return t=a[1],a[0]}};function fL(e,t,r,n){var a={key:ar(e),verificationBytes:ar(e)};return r.password&&(a.verifier=lL(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=uL(r.password)),a}function dL(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=oL(e):n.Data=sL(e,t),n}function hL(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?dL(e,t-2,n):fL(e,r.biff>=8?t:t-2,r,n),n}var pL=function(){function e(a,i){switch(i.type){case"base64":return t(_n(a),i);case"binary":return t(a,i);case"buffer":return t(ht&&Buffer.isBuffer(a)?a.toString("binary"):ks(a),i);case"array":return t(gs(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},l=o.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,m){Array.isArray(l)&&(l[m]=[]);for(var g=/\\\w+\b/g,x=0,_,y=-1;_=g.exec(h);){switch(_[0]){case"\\cell":var E=h.slice(x,g.lastIndex-_[0].length);if(E[0]==" "&&(E=E.slice(1)),++y,E.length){var k={v:E,t:"s"};Array.isArray(l)?l[m][y]=k:l[Ke({r:m,c:y})]=k}break}x=g.lastIndex}y>f.e.c&&(f.e.c=y)}),l["!ref"]=xt(f),l}function r(a,i){return Di(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=qt(a["!ref"]),l,u=Array.isArray(a),f=o.s.r;f<=o.e.r;++f){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var m=Ke({r:f,c:h});l=u?(a[f]||[])[h]:a[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Ya(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function mL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ec(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function gL(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var l=0,u=0,f=a+i;switch(u=o/(f>1?2-f:f),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,f/2]}function xL(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=a*l,o[0]+=a,o[1]+=u;break;case 1:u=a*(2-l),o[0]+=u,o[1]+=a;break;case 2:u=a*(l-2),o[1]+=a,o[2]+=u;break;case 3:u=a*(4-l),o[1]+=u,o[2]+=a;break;case 4:u=a*(l-4),o[2]+=a,o[0]+=u;break;case 5:u=a*(6-l),o[2]+=u,o[0]+=a;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function kf(e,t){if(t===0)return e;var r=gL(mL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ec(xL(r))}var ww=6,vL=15,_L=1,Zr=ww;function Ef(e){return Math.floor((e+Math.round(128/Zr)/256)*Zr)}function Sf(e){return Math.floor((e-5)/Zr*100+.5)/100}function Ah(e){return Math.round((e*Zr+5)/Zr*256)/256}function fd(e){return Ah(Sf(Ef(e)))}function pm(e){var t=Math.abs(e-fd(e)),r=Zr;if(t>.005)for(Zr=_L;Zr<vL;++Zr)Math.abs(e-fd(e))<=t&&(t=Math.abs(e-fd(e)),r=Zr);Zr=r}function So(e){e.width?(e.wpx=Ef(e.width),e.wch=Sf(e.wpx),e.MDW=Zr):e.wpx?(e.wch=Sf(e.wpx),e.width=Ah(e.wch),e.MDW=Zr):typeof e.wch=="number"&&(e.width=Ah(e.wch),e.wpx=Ef(e.width),e.MDW=Zr),e.customWidth&&delete e.customWidth}var yL=96,kw=yL;function Ew(e){return e*96/kw}function tc(e){return e*kw/96}var wL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function kL(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Vr)||[]).forEach(function(o){var l=$e(o);switch(Ea(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Dt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Dt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function EL(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Vr)||[]).forEach(function(o){var l=$e(o);switch(Ea(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function SL(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Vr)||[]).forEach(function(o){var l=$e(o);switch(Ea(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Pt(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Dt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Dt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Dt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Dt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Dt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Dt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Dt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Yp[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Dt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var u=ss[a.color.index];a.color.index==81&&(u=ss[1]),u||(u=ss[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=kf(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function TL(e,t,r){t.NumberFmt=[];for(var n=wa(tt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=tt[n[a]];var i=e[0].match(Vr);if(i)for(a=0;a<i.length;++a){var o=$e(i[a]);switch(Ea(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=wt(Pt(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}is(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var hu=["numFmtId","fillId","fontId","borderId","xfId"],pu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function CL(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Vr)||[]).forEach(function(i){var o=$e(i),l=0;switch(Ea(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<hu.length;++l)n[hu[l]]&&(n[hu[l]]=parseInt(n[hu[l]],10));for(l=0;l<pu.length;++l)n[pu[l]]&&(n[pu[l]]=Dt(n[pu[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Dt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var bL=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,f){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&TL(m,h,f),(m=l.match(a))&&SL(m,h,u,f),(m=l.match(n))&&EL(m,h,u,f),(m=l.match(i))&&kL(m,h,u,f),(m=l.match(r))&&CL(m,h,f),h}}();function NL(e,t){var r=e.read_shift(2),n=zr(e);return[r,n]}function AL(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=BN(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=jN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=zr(e),n}var LL=Hr;function PL(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var FL=Hr;function OL(e,t,r){var n={};n.NumberFmt=[];for(var a in tt)n.NumberFmt[a]=tt[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return ei(e,function(u,f,h){switch(h){case 44:n.NumberFmt[u[0]]=u[1],is(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=kf(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(h),o=!0;break;case 38:i.pop(),o=!1;break;default:if(f.T>0)i.push(h);else if(f.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var ML=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function RL(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Vr)||[]).forEach(function(a){var i=$e(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[ML.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function DL(){}function IL(){}var jL=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,BL=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,zL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UL(e,t,r){t.themeElements={};var n;[["clrScheme",jL,RL],["fontScheme",BL,DL],["fmtScheme",zL,IL]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var HL=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sw(e,t){(!e||e.length===0)&&(e=VL());var r,n={};if(!(r=e.match(HL)))throw new Error("themeElements not found in theme");return UL(r[0],n,t),n.raw=e,n}function VL(e,t){var r=[R2];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function WL(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=M2(i,{type:"array"})}catch{return}var l=pn(o,"theme/theme/theme1.xml",!0);if(l)return Sw(l,r)}}function $L(e){return e.read_shift(4)}function GL(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=ZL(e,4);break;case 2:t.xclrValue=uw(e);break;case 3:t.xclrValue=$L(e);break;case 4:e.l+=4;break}return e.l+=8,t}function ZL(e,t){return Hr(e,t)}function XL(e,t){return Hr(e,t)}function qL(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=GL(e);break;case 6:n[1]=XL(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function YL(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(qL(e,r-e.l));return{ixfe:n,ext:i}}function KL(e,t){t.forEach(function(r){switch(r[0]){}})}function JL(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:zr(e)}}function QL(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function eP(e){return e.l+=4,e.read_shift(4)!=0}function tP(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,l=2;return ei(e,function(u,f,h){switch(h){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:i.push(h),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!f.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function rP(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(Vr,function(l){var u=$e(l);switch(Ea(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(o=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):i==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function nP(e){var t=[];if(!e)return t;var r=1;return(e.match(Vr)||[]).forEach(function(n){var a=$e(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function aP(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ke(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function iP(e,t,r){var n=[];return ei(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function sP(e,t,r,n){if(!e)return e;var a=n||{},i=!1;ei(e,function(l,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function oP(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Mx(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var l=Xr(o.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[o.ref]=i;var u=qt(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var f=xt(u);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(h.a==n[m].id){h.a=n[m].name||h.a;break}}i.c.push(h)})}function lP(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=$e(l[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=Xr(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&hm(m[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function cP(e,t){var r=[],n=!1,a={},i=0;return e.replace(Vr,function(l,u){var f=$e(l);switch(Ea(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=u+l.length;break;case"</text>":a.t=e.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return l}),r}function uP(e,t){var r=[],n=!1;return e.replace(Vr,function(i){var o=$e(i);switch(Ea(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function fP(e){var t={};t.iauthor=e.read_shift(4);var r=Ss(e);return t.rfx=r.s,t.ref=Ke(r.s),e.l+=16,t}var dP=zr;function hP(e,t){var r=[],n=[],a={},i=!1;return ei(e,function(l,u,f){switch(f){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var pP="application/vnd.ms-office.vbaProject";function mP(e){var t=gt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");gt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),gt.write(t)}function gP(){return{"!type":"dialog"}}function xP(){return{"!type":"dialog"}}function vP(){return{"!type":"macro"}}function _P(){return{"!type":"macro"}}var fo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var l=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,u?f+=t.r:--f,a+(l?"":"$")+ur(h)+(u?"":"$")+Cr(f)}return function(a,i){return t=i,a.replace(e,r)}}(),Tw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yP=function(){return function(t,r){return t.replace(Tw,function(n,a,i,o,l,u){var f=om(o)-(i?0:r.c),h=sm(u)-(l?0:r.r),m=h==0?"":l?h+1:"["+h+"]",g=f==0?"":i?f+1:"["+f+"]";return a+"R"+m+"C"+g})}}();function Cw(e,t){return e.replace(Tw,function(r,n,a,i,o,l){return n+(a=="$"?a+i:ur(om(i)+t.c))+(o=="$"?o+l:Cr(sm(l)+t.r))})}function wP(e,t,r){var n=Oo(t),a=n.s,i=Xr(r),o={r:i.r-a.r,c:i.c-a.c};return Cw(e,o)}function kP(e){return e.length!=1}function Rx(e){return e.replace(/_xlfn\./g,"")}function rr(e){e.l+=1}function Pi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Nw(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Pi(e),l=Pi(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Nw(e){var t=Pi(e),r=Pi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function EP(e,t,r){if(r.biff<8)return Nw(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Pi(e),o=Pi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Aw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SP(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Pi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function SP(e){var t=Pi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function TP(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function CP(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return bP(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function bP(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function NP(e,t,r){var n=(e[e.l++]&96)>>5,a=bw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function AP(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=bw(e,i,r);return[n,a,o]}function LP(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function PP(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function FP(e,t,r){var n=(e[e.l++]&96)>>5,a=EP(e,t-1,r);return[n,a]}function OP(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Dx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function MP(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function RP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function DP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function IP(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function jP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Lw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function BP(e){return e.read_shift(2),Lw(e)}function zP(e){return e.read_shift(2),Lw(e)}function UP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Aw(e,0,r);return[n,a]}function HP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=CP(e,0,r);return[n,a]}function VP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Aw(e,0,r);return[n,a,i]}function WP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[$6[a],Ow[a],n]}function $P(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:GP(e);return[a,(i[0]===0?Ow:W6)[i[1]]]}function GP(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function ZP(e,t,r){e.l+=r&&r.biff==2?3:4}function XP(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function qP(e){return e.l++,Ts[e.read_shift(1)]}function YP(e){return e.l++,e.read_shift(2)}function KP(e){return e.l++,e.read_shift(1)!==0}function JP(e){return e.l++,jr(e)}function QP(e,t,r){return e.l++,vc(e,t-1,r)}function e6(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Kt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ts[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=jr(e);break;case 2:r[1]=Cs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function t6(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Ss:e0)(e));return a}function r6(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=e6(e,r.biff);return o}function n6(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function a6(e,t,r){if(r.biff==5)return i6(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function i6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function s6(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function o6(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function l6(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function c6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var u6=Hr,f6=Hr,d6=Hr;function yc(e,t,r){return e.l+=2,[TP(e)]}function mm(e){return e.l+=6,[]}var h6=yc,p6=mm,m6=mm,g6=yc;function Pw(e){return e.l+=2,[ar(e),e.read_shift(2)&1]}var x6=yc,v6=Pw,_6=mm,y6=yc,w6=yc,k6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function E6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=k6[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function S6(e){return e.l+=2,[e.read_shift(4)]}function T6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function C6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function b6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function N6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function A6(e){return e.l+=4,[0,0]}var Ix={1:{n:"PtgExp",f:XP},2:{n:"PtgTbl",f:d6},3:{n:"PtgAdd",f:rr},4:{n:"PtgSub",f:rr},5:{n:"PtgMul",f:rr},6:{n:"PtgDiv",f:rr},7:{n:"PtgPower",f:rr},8:{n:"PtgConcat",f:rr},9:{n:"PtgLt",f:rr},10:{n:"PtgLe",f:rr},11:{n:"PtgEq",f:rr},12:{n:"PtgGe",f:rr},13:{n:"PtgGt",f:rr},14:{n:"PtgNe",f:rr},15:{n:"PtgIsect",f:rr},16:{n:"PtgUnion",f:rr},17:{n:"PtgRange",f:rr},18:{n:"PtgUplus",f:rr},19:{n:"PtgUminus",f:rr},20:{n:"PtgPercent",f:rr},21:{n:"PtgParen",f:rr},22:{n:"PtgMissArg",f:rr},23:{n:"PtgStr",f:QP},26:{n:"PtgSheet",f:T6},27:{n:"PtgEndSheet",f:C6},28:{n:"PtgErr",f:qP},29:{n:"PtgBool",f:KP},30:{n:"PtgInt",f:YP},31:{n:"PtgNum",f:JP},32:{n:"PtgArray",f:OP},33:{n:"PtgFunc",f:WP},34:{n:"PtgFuncVar",f:$P},35:{n:"PtgName",f:n6},36:{n:"PtgRef",f:UP},37:{n:"PtgArea",f:NP},38:{n:"PtgMemArea",f:s6},39:{n:"PtgMemErr",f:u6},40:{n:"PtgMemNoMem",f:f6},41:{n:"PtgMemFunc",f:o6},42:{n:"PtgRefErr",f:l6},43:{n:"PtgAreaErr",f:LP},44:{n:"PtgRefN",f:HP},45:{n:"PtgAreaN",f:FP},46:{n:"PtgMemAreaN",f:b6},47:{n:"PtgMemNoMemN",f:N6},57:{n:"PtgNameX",f:a6},58:{n:"PtgRef3d",f:VP},59:{n:"PtgArea3d",f:AP},60:{n:"PtgRefErr3d",f:c6},61:{n:"PtgAreaErr3d",f:PP},255:{}},L6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},P6={1:{n:"PtgElfLel",f:Pw},2:{n:"PtgElfRw",f:y6},3:{n:"PtgElfCol",f:h6},6:{n:"PtgElfRwV",f:w6},7:{n:"PtgElfColV",f:g6},10:{n:"PtgElfRadical",f:x6},11:{n:"PtgElfRadicalS",f:_6},13:{n:"PtgElfColS",f:p6},15:{n:"PtgElfColSV",f:m6},16:{n:"PtgElfRadicalLel",f:v6},25:{n:"PtgList",f:E6},29:{n:"PtgSxName",f:S6},255:{}},F6={0:{n:"PtgAttrNoop",f:A6},1:{n:"PtgAttrSemi",f:jP},2:{n:"PtgAttrIf",f:DP},4:{n:"PtgAttrChoose",f:MP},8:{n:"PtgAttrGoto",f:RP},16:{n:"PtgAttrSum",f:ZP},32:{n:"PtgAttrBaxcel",f:Dx},33:{n:"PtgAttrBaxcel",f:Dx},64:{n:"PtgAttrSpace",f:BP},65:{n:"PtgAttrSpaceSemi",f:zP},128:{n:"PtgAttrIfError",f:IP},255:{}};function wc(e,t,r,n){if(n.biff<8)return Hr(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=r6(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=t6(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(Hr(e,t)),i}function kc(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Ix[i]||Ix[L6[i]],(i===24||i===25)&&(a=(i===24?P6:F6)[e[e.l+1]]),!a||!a.f?Hr(e,t):o.push([a.n,a.f(e,t,r)]);return o}function O6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var M6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function R6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Fw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function jx(e,t,r){var n=Fw(e,t,r);return n=="#REF"?n:R6(n,r)}function Rr(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],u,f,h,m=0,g=0,x,_="";if(!e[0]||!e[0][0])return"";for(var y=-1,E="",k=0,S=e[0].length;k<S;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),y>=0){switch(e[0][y][1][0]){case 0:E=Xt(" ",e[0][y][1][1]);break;case 1:E=Xt("\r",e[0][y][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+E,y=-1}l.push(f+M6[w[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=El(w[1][1],o,a),l.push(Sl(h,i));break;case"PtgRefN":h=r?El(w[1][1],r,a):w[1][1],l.push(Sl(h,i));break;case"PtgRef3d":m=w[1][1],h=El(w[1][2],o,a),_=jx(n,m,a),l.push(_+"!"+Sl(h,i));break;case"PtgFunc":case"PtgFuncVar":var A=w[1][0],I=w[1][1];A||(A=0),A&=127;var D=A==0?[]:l.slice(-A);l.length-=A,I==="User"&&(I=D.shift()),l.push(I+"("+D.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":x=vx(w[1][1],r?{s:r}:o,a),l.push(cd(x,a));break;case"PtgArea":x=vx(w[1][1],o,a),l.push(cd(x,a));break;case"PtgArea3d":m=w[1][1],x=w[1][2],_=jx(n,m,a),l.push(_+"!"+cd(x,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=w[1][2];var P=(n.names||[])[g-1]||(n[0]||[])[g],W=P?P.Name:"SH33TJSNAME"+String(g);W&&W.slice(0,6)=="_xlfn."&&!a.xlfn&&(W=W.slice(6)),l.push(W);break;case"PtgNameX":var j=w[1][1];g=w[1][2];var V;if(a.biff<=5)j<0&&(j=-j),n[j]&&(V=n[j][g]);else{var B="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][g]&&n[j][g].itab>0&&(B=n.SheetNames[n[j][g].itab-1]+"!"):B=n.SheetNames[g-1]+"!"),n[j]&&n[j][g])B+=n[j][g].Name;else if(n[0]&&n[0][g])B+=n[0][g].Name;else{var Z=(Fw(n,j,a)||"").split(";;");Z[g-1]?B=Z[g-1]:B+="SH33TJSERRX"}l.push(B);break}V||(V={Name:"SH33TJSERRY"}),l.push(V.Name);break;case"PtgParen":var K="(",ve=")";if(y>=0){switch(E="",e[0][y][1][0]){case 2:K=Xt(" ",e[0][y][1][1])+K;break;case 3:K=Xt("\r",e[0][y][1][1])+K;break;case 4:ve=Xt(" ",e[0][y][1][1])+ve;break;case 5:ve=Xt("\r",e[0][y][1][1])+ve;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}l.push(K+l.pop()+ve);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:w[1][1],r:w[1][0]};var _e={c:r.c,r:r.r};if(n.sharedf[Ke(h)]){var de=n.sharedf[Ke(h)];l.push(Rr(de,o,_e,n,a))}else{var J=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){l.push(Rr(f[1],o,_e,n,a)),J=!0;break}J||l.push(w[1])}break;case"PtgArray":l.push("{"+O6(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&y>=0&&Q.indexOf(e[0][k][0])==-1){w=e[0][y];var U=!0;switch(w[1][0]){case 4:U=!1;case 0:E=Xt(" ",w[1][1]);break;case 5:U=!1;case 1:E=Xt("\r",w[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((U?E:"")+l.pop()+(U?"":E)),y=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function D6(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Hr(e,t-2)];var l=kc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function I6(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Hr(e,t-2)];var l=kc(e,o,r);return t!==o+a&&(i=wc(e,t-o-a,l,r)),e.l=n,[l,i]}function j6(e,t,r,n){var a=e.l+t,i=kc(e,n,r),o;return a!==e.l&&(o=wc(e,a-e.l,i,r)),[i,o]}function B6(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=kc(e,i,r);return i==65535?[[],Hr(e,t-2)]:(t!==i+2&&(a=wc(e,n-i-2,o,r)),[o,a])}function z6(e){var t;if(za(e,e.l+6)!==65535)return[jr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function dd(e,t,r){var n=e.l+t,a=Sa(e);r.biff==2&&++e.l;var i=z6(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=I6(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function t0(e,t,r){var n=e.read_shift(4),a=kc(e,n,r),i=e.read_shift(4),o=i>0?wc(e,i,a,r):null;return[a,o]}var U6=t0,r0=t0,H6=t0,V6=t0,W6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ow={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Bx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function hd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Nl={},ho={};function Al(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Mw(e,t,r,n,a,i){try{n.cellNF&&(e.z=tt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=vr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(tt[t]==null&&is(Gb[t]||"General",t),e.t==="e")e.w=e.w||Ts[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v);else if(e.t==="d"){var o=Kr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Yl(o)}else{if(e.v===void 0)return"";e.w=ms(e.v,ho)}else e.t==="d"?e.w=Dn(t,Kr(e.v),ho):e.w=Dn(t,e.v,ho)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=kf(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=kf(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function G6(e,t){var r=qt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=xt(r))}var Z6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,X6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,q6=/<(?:\w:)?hyperlink [^>]*>/mg,Y6=/"(\w*:\w*)"/,K6=/<(?:\w:)?col\b[^>]*[\/]?>/g,J6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Q6=/<(?:\w:)?pageMargins[^>]*\/>/g,Rw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,eF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,tF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function rF(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",m=e.match(X6);m?(f=e.slice(0,m.index),h=e.slice(m.index+m[0].length)):f=h=e;var g=f.match(Rw);g?gm(g[0],l,a,r):(g=f.match(eF))&&nF(g[0],g[1]||"",l,a,r);var x=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var _=f.slice(x,x+50).match(Y6);_&&G6(l,_[1])}var y=f.match(tF);y&&y[1]&&cF(y[1],a);var E=[];if(t.cellStyles){var k=f.match(K6);k&&sF(E,k)}m&&uF(m[1],l,t,u,i,o);var S=h.match(J6);S&&(l["!autofilter"]=oF(S[0]));var w=[],A=h.match(Z6);if(A)for(x=0;x!=A.length;++x)w[x]=qt(A[x].slice(A[x].indexOf('"')+1));var I=h.match(q6);I&&aF(l,I,n);var D=h.match(Q6);if(D&&(l["!margins"]=iF($e(D[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=xt(u)),t.sheetRows>0&&l["!ref"]){var P=qt(l["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>u.e.r&&(P.e.r=u.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>u.e.c&&(P.e.c=u.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),l["!fullref"]=l["!ref"],l["!ref"]=xt(P))}return E.length>0&&(l["!cols"]=E),w.length>0&&(l["!merges"]=w),l}function gm(e,t,r,n){var a=$e(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=wt(Pt(a.codeName)))}function nF(e,t,r,n,a){gm(e.slice(0,e.indexOf(">")),r,n,a)}function aF(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=$e(Pt(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+wt(i.location))):(i.Target="#"+wt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=qt(i.ref),u=l.s.r;u<=l.e.r;++u)for(var f=l.s.c;f<=l.e.c;++f){var h=Ke({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function iF(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function sF(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=$e(t[n],!0);a.hidden&&(a.hidden=Dt(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,pm(a.width)),So(a);i<=o;)e[i++]=Tr(a)}}function oF(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var lF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function cF(e,t){t.Views||(t.Views=[{}]),(e.match(lF)||[]).forEach(function(r,n){var a=$e(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Dt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var uF=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Kl("v"),o=Kl("f");return function(u,f,h,m,g,x){for(var _=0,y="",E=[],k=[],S=0,w=0,A=0,I="",D,P,W=0,j=0,V,B,Z=0,K=0,ve=Array.isArray(x.CellXf),_e,de=[],J=[],Q=Array.isArray(f),U=[],te={},fe=!1,F=!!h.sheetStubs,ee=u.split(t),q=0,X=ee.length;q!=X;++q){y=ee[q].trim();var ae=y.length;if(ae!==0){var ke=0;e:for(_=0;_<ae;++_)switch(y[_]){case">":if(y[_-1]!="/"){++_;break e}if(h&&h.cellStyles){if(P=$e(y.slice(ke,_),!0),W=P.r!=null?parseInt(P.r,10):W+1,j=-1,h.sheetRows&&h.sheetRows<W)continue;te={},fe=!1,P.ht&&(fe=!0,te.hpt=parseFloat(P.ht),te.hpx=tc(te.hpt)),P.hidden=="1"&&(fe=!0,te.hidden=!0),P.outlineLevel!=null&&(fe=!0,te.level=+P.outlineLevel),fe&&(U[W-1]=te)}break;case"<":ke=_;break}if(ke>=_)break;if(P=$e(y.slice(ke,_),!0),W=P.r!=null?parseInt(P.r,10):W+1,j=-1,!(h.sheetRows&&h.sheetRows<W)){m.s.r>W-1&&(m.s.r=W-1),m.e.r<W-1&&(m.e.r=W-1),h&&h.cellStyles&&(te={},fe=!1,P.ht&&(fe=!0,te.hpt=parseFloat(P.ht),te.hpx=tc(te.hpt)),P.hidden=="1"&&(fe=!0,te.hidden=!0),P.outlineLevel!=null&&(fe=!0,te.level=+P.outlineLevel),fe&&(U[W-1]=te)),E=y.slice(_).split(e);for(var Le=0;Le!=E.length&&E[Le].trim().charAt(0)=="<";++Le);for(E=E.slice(Le),_=0;_!=E.length;++_)if(y=E[_].trim(),y.length!==0){if(k=y.match(r),S=_,w=0,A=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(S=0,I=k[1],w=0;w!=I.length&&!((A=I.charCodeAt(w)-64)<1||A>26);++w)S=26*S+A;--S,j=S}else++j;for(w=0;w!=y.length&&y.charCodeAt(w)!==62;++w);if(++w,P=$e(y.slice(0,w),!0),P.r||(P.r=Ke({r:W-1,c:j})),I=y.slice(w),D={t:""},(k=I.match(i))!=null&&k[1]!==""&&(D.v=wt(k[1])),h.cellFormula){if((k=I.match(o))!=null&&k[1]!==""){if(D.f=wt(Pt(k[1])).replace(/\r\n/g,`
`),h.xlfn||(D.f=Rx(D.f)),k[0].indexOf('t="array"')>-1)D.F=(I.match(a)||[])[1],D.F.indexOf(":")>-1&&de.push([qt(D.F),D.F]);else if(k[0].indexOf('t="shared"')>-1){B=$e(k[0]);var Ne=wt(Pt(k[1]));h.xlfn||(Ne=Rx(Ne)),J[parseInt(B.si,10)]=[B,Ne,P.r]}}else(k=I.match(/<f[^>]*\/>/))&&(B=$e(k[0]),J[B.si]&&(D.f=wP(J[B.si][1],J[B.si][2],P.r)));var we=Xr(P.r);for(w=0;w<de.length;++w)we.r>=de[w][0].s.r&&we.r<=de[w][0].e.r&&we.c>=de[w][0].s.c&&we.c<=de[w][0].e.c&&(D.F=de[w][1])}if(P.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(F)D.t="z";else continue;else D.t=P.t||"n";switch(m.s.c>j&&(m.s.c=j),m.e.c<j&&(m.e.c=j),D.t){case"n":if(D.v==""||D.v==null){if(!F)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!F)continue;D.t="z"}else V=Nl[parseInt(D.v,10)],D.v=V.t,D.r=V.r,h.cellHTML&&(D.h=V.h);break;case"str":D.t="s",D.v=D.v!=null?Pt(D.v):"",h.cellHTML&&(D.h=nm(D.v));break;case"inlineStr":k=I.match(n),D.t="s",k!=null&&(V=hm(k[1]))?(D.v=V.t,h.cellHTML&&(D.h=V.h)):D.v="";break;case"b":D.v=Dt(D.v);break;case"d":h.cellDates?D.v=vr(D.v,1):(D.v=Kr(vr(D.v,1)),D.t="n");break;case"e":(!h||h.cellText!==!1)&&(D.w=D.v),D.v=rw[D.v];break}if(Z=K=0,_e=null,ve&&P.s!==void 0&&(_e=x.CellXf[P.s],_e!=null&&(_e.numFmtId!=null&&(Z=_e.numFmtId),h.cellStyles&&_e.fillId!=null&&(K=_e.fillId))),Mw(D,Z,K,h,g,x),h.cellDates&&ve&&D.t=="n"&&Fo(tt[Z])&&(D.t="d",D.v=Qf(D.v)),P.cm&&h.xlmeta){var Be=(h.xlmeta.Cell||[])[+P.cm-1];Be&&Be.type=="XLDAPR"&&(D.D=!0)}if(Q){var G=Xr(P.r);f[G.r]||(f[G.r]=[]),f[G.r][G.c]=D}else f[P.r]=D}}}}U.length>0&&(f["!rows"]=U)}}();function fF(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var dF=Ss;function hF(){}function pF(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=DN(e),r}function mF(e){var t=In(e);return[t]}function gF(e){var t=Es(e);return[t]}function xF(e){var t=In(e),r=e.read_shift(1);return[t,r,"b"]}function vF(e){var t=Es(e),r=e.read_shift(1);return[t,r,"b"]}function _F(e){var t=In(e),r=e.read_shift(1);return[t,r,"e"]}function yF(e){var t=Es(e),r=e.read_shift(1);return[t,r,"e"]}function wF(e){var t=In(e),r=e.read_shift(4);return[t,r,"s"]}function kF(e){var t=Es(e),r=e.read_shift(4);return[t,r,"s"]}function EF(e){var t=In(e),r=jr(e);return[t,r,"n"]}function Dw(e){var t=Es(e),r=jr(e);return[t,r,"n"]}function SF(e){var t=In(e),r=um(e);return[t,r,"n"]}function TF(e){var t=Es(e),r=um(e);return[t,r,"n"]}function CF(e){var t=In(e),r=lm(e);return[t,r,"is"]}function bF(e){var t=In(e),r=zr(e);return[t,r,"str"]}function NF(e){var t=Es(e),r=zr(e);return[t,r,"str"]}function AF(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=r0(e,n-e.l,r);o[3]=Rr(l,null,a,r.supbooks,r)}else e.l=n;return o}function LF(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=r0(e,n-e.l,r);o[3]=Rr(l,null,a,r.supbooks,r)}else e.l=n;return o}function PF(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=jr(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=r0(e,n-e.l,r);o[3]=Rr(l,null,a,r.supbooks,r)}else e.l=n;return o}function FF(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=zr(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=r0(e,n-e.l,r);o[3]=Rr(l,null,a,r.supbooks,r)}else e.l=n;return o}var OF=Ss;function MF(e,t){var r=e.l+t,n=Ss(e),a=cm(e),i=zr(e),o=zr(e),l=zr(e);e.l=r;var u={rfx:n,relId:a,loc:i,display:l};return o&&(u.Tooltip=o),u}function RF(){}function DF(e,t,r){var n=e.l+t,a=Q2(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var l=U6(e,n-e.l,r);o[1]=l}else e.l=n;return o}function IF(e,t,r){var n=e.l+t,a=Ss(e),i=[a];if(r.cellFormula){var o=V6(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}var jF=["left","right","top","bottom","header","footer"];function BF(e){var t={};return jF.forEach(function(r){t[r]=jr(e)}),t}function zF(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function UF(){}function HF(){}function VF(e,t,r,n,a,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,x,_,y,E,k,S,w,A,I,D=[];l.biff=12,l["!row"]=0;var P=0,W=!1,j=[],V={},B=l.supbooks||a.supbooks||[[]];if(B.sharedf=V,B.arrayf=j,B.SheetNames=a.SheetNames||a.Sheets.map(function(Q){return Q.name}),!l.supbooks&&(l.supbooks=B,a.Names))for(var Z=0;Z<a.Names.length;++Z)B[0][Z+1]=a.Names[Z];var K=[],ve=[],_e=!1;Tf[16]={n:"BrtShortReal",f:Dw};var de;if(ei(e,function(U,te,fe){if(!g)switch(fe){case 148:f=U;break;case 0:x=U,l.sheetRows&&l.sheetRows<=x.r&&(g=!0),A=Cr(E=x.r),l["!row"]=x.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=tc(U.hpt)),ve[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:U[2]},U[2]){case"n":_.v=U[1];break;case"s":w=Nl[U[1]],_.v=w.t,_.r=w.r;break;case"b":_.v=!!U[1];break;case"e":_.v=U[1],l.cellText!==!1&&(_.w=Ts[_.v]);break;case"str":_.t="s",_.v=U[1];break;case"is":_.t="s",_.v=U[1].t;break}if((y=o.CellXf[U[0].iStyleRef])&&Mw(_,y.numFmtId,null,l,i,o),k=U[0].c==-1?k+1:U[0].c,l.dense?(u[E]||(u[E]=[]),u[E][k]=_):u[ur(k)+A]=_,l.cellFormula){for(W=!1,P=0;P<j.length;++P){var F=j[P];x.r>=F[0].s.r&&x.r<=F[0].e.r&&k>=F[0].s.c&&k<=F[0].e.c&&(_.F=xt(F[0]),W=!0)}!W&&U.length>3&&(_.f=U[3])}if(h.s.r>x.r&&(h.s.r=x.r),h.s.c>k&&(h.s.c=k),h.e.r<x.r&&(h.e.r=x.r),h.e.c<k&&(h.e.c=k),l.cellDates&&y&&_.t=="n"&&Fo(tt[y.numFmtId])){var ee=es(_.v);ee&&(_.t="d",_.v=new Date(ee.y,ee.m-1,ee.d,ee.H,ee.M,ee.S,ee.u))}de&&(de.type=="XLDAPR"&&(_.D=!0),de=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;_={t:"z",v:void 0},k=U[0].c==-1?k+1:U[0].c,l.dense?(u[E]||(u[E]=[]),u[E][k]=_):u[ur(k)+A]=_,h.s.r>x.r&&(h.s.r=x.r),h.s.c>k&&(h.s.c=k),h.e.r<x.r&&(h.e.r=x.r),h.e.c<k&&(h.e.c=k),de&&(de.type=="XLDAPR"&&(_.D=!0),de=void 0);break;case 176:D.push(U);break;case 49:de=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var q=n["!id"][U.relId];for(q?(U.Target=q.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=q):U.relId==""&&(U.Target="#"+U.loc),E=U.rfx.s.r;E<=U.rfx.e.r;++E)for(k=U.rfx.s.c;k<=U.rfx.e.c;++k)l.dense?(u[E]||(u[E]=[]),u[E][k]||(u[E][k]={t:"z",v:void 0}),u[E][k].l=U):(S=Ke({c:k,r:E}),u[S]||(u[S]={t:"z",v:void 0}),u[S].l=U);break;case 426:if(!l.cellFormula)break;j.push(U),I=l.dense?u[E][k]:u[ur(k)+A],I.f=Rr(U[1],h,{r:x.r,c:k},B,l),I.F=xt(U[0]);break;case 427:if(!l.cellFormula)break;V[Ke(U[0].s)]=U[1],I=l.dense?u[E][k]:u[ur(k)+A],I.f=Rr(U[1],h,{r:x.r,c:k},B,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)K[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},_e||(_e=!0,pm(U.w/256)),So(K[U.e+1]);break;case 161:u["!autofilter"]={ref:xt(U)};break;case 476:u["!margins"]=U;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),U.name&&(a.Sheets[r].CodeName=U.name),(U.above||U.left)&&(u["!outline"]={above:U.above,left:U.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),U.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!te.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+fe.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=xt(f||h)),l.sheetRows&&u["!ref"]){var J=qt(u["!ref"]);l.sheetRows<=+J.e.r&&(J.e.r=l.sheetRows-1,J.e.r>h.e.r&&(J.e.r=h.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>h.e.c&&(J.e.c=h.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),u["!fullref"]=u["!ref"],u["!ref"]=xt(J))}return D.length>0&&(u["!merges"]=D),K.length>0&&(u["!cols"]=K),ve.length>0&&(u["!rows"]=ve),u}function WF(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function $F(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,u=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=WF(m);h.s.r=h.s.c=0,h.e.c=l,f=ur(l),g[0].forEach(function(x,_){o[f+Cr(_)]={t:"n",v:x,z:g[1]},u=_}),h.e.r<u&&(h.e.r=u),++l}),l>0&&(o["!ref"]=xt(h)),o}function GF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Rw);return l&&gm(l[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function ZF(e,t){e.l+=10;var r=zr(e);return{name:r}}function XF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ei(e,function(u,f,h){switch(h){case 550:i["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Iw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],qF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],YF=[],KF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function zx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Dt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Ux(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Dt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function jw(e){Ux(e.WBProps,Iw),Ux(e.CalcPr,KF),zx(e.WBView,qF),zx(e.Sheets,YF),ho.date1904=Dt(e.WBProps.date1904)}var JF="][*?/\\".split("");function QF(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return JF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var e8=/<\w+:workbook/;function t8(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(Vr,function(u,f){var h=$e(u);switch(Ea(h[0])){case"<?xml":break;case"<workbook":u.match(e8)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Iw.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Dt(h[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:r.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(r.WBProps.CodeName=Pt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=wt(Pt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Pt(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Dt(h.hidden||"0")&&(i.Hidden=!0),o=f+u.length;break;case"</definedName>":i.Ref=wt(Pt(e.slice(o,f))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),_N.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return jw(r),r}function r8(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ch(e),r.name=zr(e),r}function n8(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?zr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function a8(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function i8(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=IN(e),o=H6(e,0,r),l=cm(e);e.l=n;var u={Name:i,Ptg:o};return a<268435455&&(u.Sheet=a),l&&(u.Comment=l),u}function s8(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Tf[16]={n:"BrtFRTArchID$",f:a8},ei(e,function(u,f,h){switch(h){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Rr(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,u]):o[0]=[h,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),jw(r),r.Names=i,r.supbooks=o,r}function o8(e,t,r){return t.slice(-4)===".bin"?s8(e,r):t8(e,r)}function l8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?VF(e,n,r,a,i,o,l):rF(e,n,r,a,i,o,l)}function c8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?XF(e,n,r,a,i):GF(e,n,r,a,i)}function u8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?vP():_P()}function f8(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?gP():xP()}function d8(e,t,r,n){return t.slice(-4)===".bin"?OL(e,r,n):bL(e,r,n)}function h8(e,t,r){return Sw(e,r)}function p8(e,t,r){return t.slice(-4)===".bin"?q5(e,r):Z5(e,r)}function m8(e,t,r){return t.slice(-4)===".bin"?hP(e,r):lP(e,r)}function g8(e,t,r){return t.slice(-4)===".bin"?iP(e):nP(e)}function x8(e,t,r,n){return r.slice(-4)===".bin"?sP(e,t,r,n):void 0}function v8(e,t,r){return t.slice(-4)===".bin"?tP(e,t,r):rP(e,t,r)}var Bw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Bw),i,o,l,u;if(a)for(u=0;u!=a.length;++u)i=a[u].match(zw),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function _8(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Bw),a,i,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(zw),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Ll;function y8(e,t){var r=Ll[e]||wt(e);return r==="General"?ms(t):Dn(r,t)}function w8(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Dt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[wt(t)]=a}function k8(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ts[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=ms(e.v):e.w=y8(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Ll[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Fo(n)){var a=es(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function E8(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=wL[n.Pattern]||n.Pattern)}e[t.ID]=t}function S8(e,t,r,n,a,i,o,l,u,f){var h="General",m=n.StyleID,g={};f=f||{};var x=[],_=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(h=i[m].nf),i[m].Interior&&x.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Dt(e);break;case"String":n.t="s",n.r=cx(wt(e)),n.v=e.indexOf("<")>-1?wt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(vr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=wt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=rw[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=cx(t||e));break}if(k8(n,h,f),f.cellFormula!==!1)if(n.Formula){var y=wt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=fo(y,a),delete n.Formula,n.ArrayRange=="RC"?n.F=fo("RC:RC",a):n.ArrayRange&&(n.F=fo(n.ArrayRange,a),u.push([qt(n.F),n.F]))}else for(_=0;_<u.length;++_)a.r>=u[_][0].s.r&&a.r<=u[_][0].e.r&&a.c>=u[_][0].s.c&&a.c<=u[_][0].e.c&&(n.F=u[_][1]);f.cellStyles&&(x.forEach(function(E){!g.patternType&&E.patternType&&(g.patternType=E.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function T8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function pd(e,t){var r=t||{};N2();var n=ll(am(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Pt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Tr(r);return o.type="string",Ql.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Me){a.indexOf("<"+Me)>=0&&(i=!0)}),i)return M8(n,r);Ll={"General Number":"General","General Date":tt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":tt[15],"Short Date":tt[14],"Long Time":tt[19],"Medium Time":tt[18],"Short Time":tt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:tt[2],Standard:tt[4],Percent:tt[10],Scientific:tt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],f,h={},m=[],g=r.dense?[]:{},x="",_={},y={},E=Hn('<Data ss:Type="String">'),k=0,S=0,w=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},D={},P="",W=0,j=[],V={},B={},Z=0,K=[],ve=[],_e={},de=[],J,Q=!1,U=[],te=[],fe={},F=0,ee=0,q={Sheets:[],WBProps:{date1904:!1}},X={};Jl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";l=Jl.exec(n);)switch(l[3]=(ae=l[3]).toLowerCase()){case"data":if(ae=="data"){if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?S8(n.slice(k,l.index),P,E,u[u.length-1][0]=="comment"?_e:_,{c:S,r:w},I,de[S],y,U,r):(P="",E=Hn(l[0]),k=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(ve.length>0&&(_.c=ve),(!r.sheetRows||r.sheetRows>w)&&_.v!==void 0&&(r.dense?(g[w]||(g[w]=[]),g[w][S]=_):g[ur(S)+Cr(w)]=_),_.HRef&&(_.l={Target:wt(_.HRef)},_.HRefScreenTip&&(_.l.Tooltip=_.HRefScreenTip),delete _.HRef,delete _.HRefScreenTip),(_.MergeAcross||_.MergeDown)&&(F=S+(parseInt(_.MergeAcross,10)|0),ee=w+(parseInt(_.MergeDown,10)|0),j.push({s:{c:S,r:w},e:{c:F,r:ee}})),!r.sheetStubs)_.MergeAcross?S=F+1:++S;else if(_.MergeAcross||_.MergeDown){for(var ke=S;ke<=F;++ke)for(var Le=w;Le<=ee;++Le)(ke>S||Le>w)&&(r.dense?(g[Le]||(g[Le]=[]),g[Le][ke]={t:"z"}):g[ur(ke)+Cr(Le)]={t:"z"});S=F+1}else++S;else _=_8(l[0]),_.Index&&(S=+_.Index-1),S<A.s.c&&(A.s.c=S),S>A.e.c&&(A.e.c=S),l[0].slice(-2)==="/>"&&++S,ve=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<A.s.r&&(A.s.r=w),w>A.e.r&&(A.e.r=w),l[0].slice(-2)==="/>"&&(y=Hn(l[0]),y.Index&&(w=+y.Index-1)),S=0,++w):(y=Hn(l[0]),y.Index&&(w=+y.Index-1),fe={},(y.AutoFitHeight=="0"||y.Height)&&(fe.hpx=parseInt(y.Height,10),fe.hpt=Ew(fe.hpx),te[w]=fe),y.Hidden=="1"&&(fe.hidden=!0,te[w]=fe));break;case"worksheet":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));m.push(x),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(g["!ref"]=xt(A),r.sheetRows&&r.sheetRows<=A.e.r&&(g["!fullref"]=g["!ref"],A.e.r=r.sheetRows-1,g["!ref"]=xt(A))),j.length&&(g["!merges"]=j),de.length>0&&(g["!cols"]=de),te.length>0&&(g["!rows"]=te),h[x]=g}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=S=0,u.push([l[3],!1]),f=Hn(l[0]),x=wt(f.Name),g=r.dense?[]:{},j=[],U=[],te=[],X={name:x,Hidden:0},q.Sheets.push(X);break;case"table":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),de=[],Q=!1}break;case"style":l[1]==="/"?E8(I,D,r):D=Hn(l[0]);break;case"numberformat":D.nf=wt(Hn(l[0]).Format||"General"),Ll[D.nf]&&(D.nf=Ll[D.nf]);for(var Ne=0;Ne!=392&&tt[Ne]!=D.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(tt[Ne]==null){is(D.nf,Ne);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(J=Hn(l[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!Q&&J.wpx>10){Q=!0,Zr=ww;for(var we=0;we<de.length;++we)de[we]&&So(de[we])}Q&&So(J),de[J.Index-1||de.length]=J;for(var Be=0;Be<+J.Span;++Be)de[de.length]=Tr(J);break;case"namedrange":if(l[1]==="/")break;q.Names||(q.Names=[]);var G=$e(l[0]),Ge={Name:G.Name,Ref:fo(G.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(Ge.Sheet=q.Sheets.length-1),q.Names.push(Ge);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?P+=n.slice(W,l.index):W=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Hn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?lA(V,ae,n.slice(Z,l.index)):Z=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));T8(_e),ve.push(_e)}else u.push([l[3],!1]),f=Hn(l[0]),_e={a:f.Author};break;case"autofilter":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Je=Hn(l[0]);g["!autofilter"]={ref:fo(Je.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return Zx(n,r);var me=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:me=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:me=!1}break;case"excelworkbook":switch(l[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:me=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:me=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(Z,l.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else Z=l.index+l[0].length;break;case"header":g["!margins"]||Al(g["!margins"]={},"xlml"),isNaN(+$e(l[0]).Margin)||(g["!margins"].header=+$e(l[0]).Margin);break;case"footer":g["!margins"]||Al(g["!margins"]={},"xlml"),isNaN(+$e(l[0]).Margin)||(g["!margins"].footer=+$e(l[0]).Margin);break;case"pagemargins":var Se=$e(l[0]);g["!margins"]||Al(g["!margins"]={},"xlml"),isNaN(+Se.Top)||(g["!margins"].top=+Se.Top),isNaN(+Se.Left)||(g["!margins"].left=+Se.Left),isNaN(+Se.Right)||(g["!margins"].right=+Se.Right),isNaN(+Se.Bottom)||(g["!margins"].bottom=+Se.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:me=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:me=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:me=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:me=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:me=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:me=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:me=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:me=!1}break;case"smarttags":break;default:me=!1;break}if(me||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?w8(B,ae,K,n.slice(Z,l.index)):(K=l,Z=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=h),he.SheetNames=m,he.Workbook=q,he.SSF=Tr(tt),he.Props=V,he.Custprops=B,he}function Lh(e,t){switch(_m(t=t||{}),t.type||"base64"){case"base64":return pd(_n(e),t);case"binary":case"buffer":case"file":return pd(e,t);case"array":return pd(ks(e),t)}}function C8(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=zN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=UN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var b8=[60,1084,2066,2165,2175];function N8(e,t,r,n,a){var i=n,o=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=i;for(var u=za(r,r.l),f=Ph[u],h=0;f!=null&&b8.indexOf(u)>-1;)i=za(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),l=r.slice(h,r.l+4+i),o.push(l),r.l+=4+i,f=Ph[u=za(r,r.l)];var m=di(o);wr(m,0);var g=0;m.lens=[];for(var x=0;x<o.length;++x)m.lens.push(g),g+=o[x].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,a)}function fa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=tt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ts[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=ms(e.v):e.w=Dn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Fo(tt[n]||String(n))){var a=es(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function mu(e,t,r){return{v:e,ixfe:t,t:r}}function A8(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},l=null,u=[],f="",h={},m,g="",x,_,y,E,k={},S=[],w,A,I=[],D=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},j=function(Ze){return Ze<8?ss[Ze]:Ze<64&&D[Ze-8]||ss[Ze]},V=function(Ze,ue,xe){var Ce=ue.XF.data;if(!(!Ce||!Ce.patternType||!xe||!xe.cellStyles)){ue.s={},ue.s.patternType=Ce.patternType;var Fe;(Fe=ec(j(Ce.icvFore)))&&(ue.s.fgColor={rgb:Fe}),(Fe=ec(j(Ce.icvBack)))&&(ue.s.bgColor={rgb:Fe})}},B=function(Ze,ue,xe){if(!(fe>1)&&!(xe.sheetRows&&Ze.r>=xe.sheetRows)){if(xe.cellStyles&&ue.XF&&ue.XF.data&&V(Ze,ue,xe),delete ue.ixfe,delete ue.XF,m=Ze,g=Ke(Ze),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<o.s.r&&(o.s.r=Ze.r),Ze.c<o.s.c&&(o.s.c=Ze.c),Ze.r+1>o.e.r&&(o.e.r=Ze.r+1),Ze.c+1>o.e.c&&(o.e.c=Ze.c+1),xe.cellFormula&&ue.f){for(var Ce=0;Ce<S.length;++Ce)if(!(S[Ce][0].s.c>Ze.c||S[Ce][0].s.r>Ze.r)&&!(S[Ce][0].e.c<Ze.c||S[Ce][0].e.r<Ze.r)){ue.F=xt(S[Ce][0]),(S[Ce][0].s.c!=Ze.c||S[Ce][0].s.r!=Ze.r)&&delete ue.f,ue.f&&(ue.f=""+Rr(S[Ce][1],o,Ze,U,Z));break}}xe.dense?(a[Ze.r]||(a[Ze.r]=[]),a[Ze.r][Ze.c]=ue):a[g]=ue}},Z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Z.password=t.password);var K,ve=[],_e=[],de=[],J=[],Q=!1,U=[];U.SheetNames=Z.snames,U.sharedf=Z.sharedf,U.arrayf=Z.arrayf,U.names=[],U.XTI=[];var te=0,fe=0,F=0,ee=[],q=[],X;Z.codepage=1200,Xn(1200);for(var ae=!1;e.l<e.length-1;){var ke=e.l,Le=e.read_shift(2);if(Le===0&&te===10)break;var Ne=e.l===e.length?0:e.read_shift(2),we=Ph[Le];if(we&&we.f){if(t.bookSheets&&te===133&&Le!==133)break;if(te=Le,we.r===2||we.r==12){var Be=e.read_shift(2);if(Ne-=2,!Z.enc&&Be!==Le&&((Be&255)<<8|Be>>8)!==Le)throw new Error("rt mismatch: "+Be+"!="+Le);we.r==12&&(e.l+=10,Ne-=10)}var G={};if(Le===10?G=we.f(e,Ne,Z):G=N8(Le,we,e,Ne,Z),fe==0&&[9,521,1033,2057].indexOf(te)===-1)continue;switch(Le){case 34:r.opts.Date1904=P.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Z.enc||(e.l=0),Z.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:Z.lastuser=G;break;case 66:var Ge=Number(G);switch(Ge){case 21010:Ge=1200;break;case 32768:Ge=1e4;break;case 32769:Ge=1252;break}Xn(Z.codepage=Ge),ae=!0;break;case 317:Z.rrtabid=G;break;case 25:Z.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:Z.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(a["!type"]="dialog"),G.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),G.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(G);break;case 430:U.push([G]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(G);break;case 24:case 536:X={Name:G.Name,Ref:Rr(G.rgce,o,null,U,Z)},G.itab>0&&(X.Sheet=G.itab-1),U.names.push(X),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(q[G.itab-1]={ref:xt(G.rgce[0][0][1][2])});break;case 22:Z.ExternCount=G;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(G),U.XTI=U.XTI.concat(G);break;case 2196:if(Z.biff<8)break;X!=null&&(X.Comment=G[1]);break;case 18:a["!protect"]=G;break;case 19:G!==0&&Z.WTF&&console.error("Password verifier: "+G);break;case 133:i[G.pos]=G,Z.snames.push(G.name);break;case 10:{if(--fe)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=xt(o),t.sheetRows&&t.sheetRows<=o.e.r){var Je=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=xt(o),o.e.r=Je}o.e.r++,o.e.c++}ve.length>0&&(a["!merges"]=ve),_e.length>0&&(a["!objects"]=_e),de.length>0&&(a["!cols"]=de),J.length>0&&(a["!rows"]=J),P.Sheets.push(W)}f===""?h=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Z.biff===8&&(Z.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),Z.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(Z.biff=5,ae=!0,Xn(Z.codepage=28591)),Z.biff==8&&G.BIFFVer==0&&G.dt==16&&(Z.biff=2),fe++)break;if(a=t.dense?[]:{},Z.biff<8&&!ae&&(ae=!0,Xn(Z.codepage=t.codepage||1252)),Z.biff<5||G.BIFFVer==0&&G.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var me={pos:e.l-Ne,name:f};i[me.pos]=me,Z.snames.push(f)}else f=(i[ke]||{name:""}).name;G.dt==32&&(a["!type"]="chart"),G.dt==64&&(a["!type"]="macro"),ve=[],_e=[],Z.arrayf=S=[],de=[],J=[],Q=!1,W={Hidden:(i[ke]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[G.r]||[])[G.c]:a[Ke({c:G.c,r:G.r})])&&++G.c,w={ixfe:G.ixfe,XF:I[G.ixfe]||{},v:G.val,t:"n"},F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:G.c,r:G.r},w,t);break;case 5:case 517:w={ixfe:G.ixfe,XF:I[G.ixfe],v:G.val,t:G.t},F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:G.c,r:G.r},w,t);break;case 638:w={ixfe:G.ixfe,XF:I[G.ixfe],v:G.rknum,t:"n"},F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:G.c,r:G.r},w,t);break;case 189:for(var Se=G.c;Se<=G.C;++Se){var he=G.rkrec[Se-G.c][0];w={ixfe:he,XF:I[he],v:G.rkrec[Se-G.c][1],t:"n"},F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:Se,r:G.r},w,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){l=G;break}if(w=mu(G.val,G.cell.ixfe,G.tt),w.XF=I[w.ixfe],t.cellFormula){var Me=G.formula;if(Me&&Me[0]&&Me[0][0]&&Me[0][0][0]=="PtgExp"){var He=Me[0][0][1][0],nt=Me[0][0][1][1],kt=Ke({r:He,c:nt});k[kt]?w.f=""+Rr(G.formula,o,G.cell,U,Z):w.F=((t.dense?(a[He]||[])[nt]:a[kt])||{}).F}else w.f=""+Rr(G.formula,o,G.cell,U,Z)}F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B(G.cell,w,t),l=G}break;case 7:case 519:if(l)l.val=G,w=mu(G,l.cell.ixfe,"s"),w.XF=I[w.ixfe],t.cellFormula&&(w.f=""+Rr(l.formula,o,l.cell,U,Z)),F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(G);var Bt=Ke(G[0].s);if(x=t.dense?(a[G[0].s.r]||[])[G[0].s.c]:a[Bt],t.cellFormula&&x){if(!l||!Bt||!x)break;x.f=""+Rr(G[1],o,G[0],U,Z),x.F=xt(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!l)break;k[Ke(l.cell)]=G[0],x=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Ke(l.cell)],(x||{}).f=""+Rr(G[0],o,m,U,Z)}}break;case 253:w=mu(u[G.isst].t,G.ixfe,"s"),u[G.isst].h&&(w.h=u[G.isst].h),w.XF=I[w.ixfe],F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:G.c,r:G.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:G.ixfe,XF:I[G.ixfe],t:"z"},F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:G.c,r:G.r},w,t));break;case 190:if(t.sheetStubs)for(var pt=G.c;pt<=G.C;++pt){var _t=G.ixfe[pt-G.c];w={ixfe:_t,XF:I[_t],t:"z"},F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:pt,r:G.r},w,t)}break;case 214:case 516:case 4:w=mu(G.val,G.ixfe,"s"),w.XF=I[w.ixfe],F>0&&(w.z=ee[w.ixfe>>8&63]),fa(w,t,r.opts.Date1904),B({c:G.c,r:G.r},w,t);break;case 0:case 512:fe===1&&(o=G);break;case 252:u=G;break;case 1054:if(Z.biff==4){ee[F++]=G[1];for(var Nt=0;Nt<F+163&&tt[Nt]!=G[1];++Nt);Nt>=163&&is(G[1],F+163)}else is(G[1],G[0]);break;case 30:{ee[F++]=G;for(var dr=0;dr<F+163&&tt[dr]!=G;++dr);dr>=163&&is(G,F+163)}break;case 229:ve=ve.concat(G);break;case 93:_e[G.cmo[0]]=Z.lastobj=G;break;case 438:Z.lastobj.TxO=G;break;case 127:Z.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(y=G[0].s.c;y<=G[0].e.c;++y)x=t.dense?(a[E]||[])[y]:a[Ke({c:y,r:E})],x&&(x.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(y=G[0].s.c;y<=G[0].e.c;++y)x=t.dense?(a[E]||[])[y]:a[Ke({c:y,r:E})],x&&x.l&&(x.l.Tooltip=G[1]);break;case 28:{if(Z.biff<=5&&Z.biff>=2)break;x=t.dense?(a[G[0].r]||[])[G[0].c]:a[Ke(G[0])];var Nr=_e[G[2]];x||(t.dense?(a[G[0].r]||(a[G[0].r]=[]),x=a[G[0].r][G[0].c]={t:"z"}):x=a[Ke(G[0])]={t:"z"},o.e.r=Math.max(o.e.r,G[0].r),o.s.r=Math.min(o.s.r,G[0].r),o.e.c=Math.max(o.e.c,G[0].c),o.s.c=Math.min(o.s.c,G[0].c)),x.c||(x.c=[]),_={a:G[1],t:Nr.TxO.t},x.c.push(_)}break;case 2173:KL(I[G.ixfe],G.ext);break;case 125:{if(!Z.cellStyles)break;for(;G.e>=G.s;)de[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},Q||(Q=!0,pm(G.w/256)),So(de[G.e+1])}break;case 520:{var $t={};G.level!=null&&(J[G.r]=$t,$t.level=G.level),G.hidden&&(J[G.r]=$t,$t.hidden=!0),G.hpt&&(J[G.r]=$t,$t.hpt=G.hpt,$t.hpx=tc(G.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Al(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=G;break;case 161:a["!margins"]||Al(a["!margins"]={}),a["!margins"].header=G.header,a["!margins"].footer=G.footer;break;case 574:G.RTL&&(P.Views[0].RTL=!0);break;case 146:D=G;break;case 2198:K=G;break;case 140:A=G;break;case 442:f?W.CodeName=G||W.name:P.WBProps.CodeName=G||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),e.l+=Ne}return r.SheetNames=wa(i).sort(function(Ar,Ze){return Number(Ar)-Number(Ze)}).map(function(Ar){return i[Ar].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&q.forEach(function(Ar,Ze){r.Sheets[r.SheetNames[Ze]]["!autofilter"]=Ar}),r.Strings=u,r.SSF=Tr(tt),Z.enc&&(r.Encryption=Z.enc),K&&(r.Themes=K),r.Metadata={},A!==void 0&&(r.Metadata.Country=A),U.names.length>0&&(P.Names=U.names),r.Workbook=P,r}var Hx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function L8(e,t,r){var n=gt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Tx(n,ZN,Hx.DSI);for(var i in a)t[i]=a[i]}catch(f){if(r.WTF)throw f}var o=gt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=Tx(o,XN,Hx.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(aw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Uw(e,t){t||(t={}),_m(t),g2(),t.codepage&&Kp(t.codepage);var r,n;if(e.FullPaths){if(gt.find(e,"/encryption"))throw new Error("File is password-protected");r=gt.find(e,"!CompObj"),n=gt.find(e,"/Workbook")||gt.find(e,"/Book")}else{switch(t.type){case"base64":e=Zn(_n(e));break;case"binary":e=Zn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var a,i;if(r&&C8(r),t.bookProps&&!t.bookSheets)a={};else{var o=ht?"buffer":"array";if(n&&n.content)a=A8(n.content,t);else if((i=gt.find(e,"PerfectOffice_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=o,t));else if((i=gt.find(e,"NativeContent_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=o,t));else throw(i=gt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&gt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=mP(e))}var l={};return e.FullPaths&&L8(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}var Tf={0:{f:fF},1:{f:mF},2:{f:SF},3:{f:_F},4:{f:xF},5:{f:EF},6:{f:bF},7:{f:wF},8:{f:FF},9:{f:PF},10:{f:AF},11:{f:LF},12:{f:gF},13:{f:TF},14:{f:yF},15:{f:vF},16:{f:Dw},17:{f:NF},18:{f:kF},19:{f:lm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:i8},40:{},42:{},43:{f:AL},44:{f:NL},45:{f:LL},46:{f:FL},47:{f:PL},48:{},49:{f:ON},50:{},51:{f:QL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gw},62:{f:CF},63:{f:aP},64:{f:UF},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pF},148:{f:dF,p:16},151:{f:RF},152:{},153:{f:n8},154:{},155:{},156:{f:r8},157:{},158:{},159:{T:1,f:X5},160:{T:-1},161:{T:1,f:Ss},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:OF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:JL},336:{T:-1},337:{f:eP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ch},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DF},427:{f:IF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:BF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:MF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ch},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:dP},633:{T:1},634:{T:-1},635:{T:1,f:fP},636:{T:-1},637:{f:RN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ZF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:HF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ph={6:{f:dd},10:{f:ii},12:{f:ar},13:{f:ar},14:{f:Kt},15:{f:Kt},16:{f:jr},17:{f:Kt},18:{f:Kt},19:{f:ar},20:{f:Ax},21:{f:Ax},23:{f:mw},24:{f:Px},25:{f:Kt},26:{},27:{},28:{f:c5},29:{},34:{f:Kt},35:{f:Lx},38:{f:jr},39:{f:jr},40:{f:jr},41:{f:jr},42:{f:Kt},43:{f:Kt},47:{f:hL},49:{f:WA},51:{f:ar},60:{},61:{f:UA},64:{f:Kt},65:{f:VA},66:{f:ar},77:{},80:{},81:{},82:{},85:{f:ar},89:{},90:{},91:{},92:{f:OA},93:{f:f5},94:{},95:{f:Kt},96:{},97:{},99:{f:Kt},125:{f:gw},128:{f:e5},129:{f:MA},130:{f:ar},131:{f:Kt},132:{f:Kt},133:{f:RA},134:{},140:{f:x5},141:{f:ar},144:{},146:{f:_5},151:{},152:{},153:{},154:{},155:{},156:{f:ar},157:{},158:{},160:{f:S5},161:{f:w5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:YA},190:{f:KA},193:{f:ii},197:{},198:{},199:{},200:{},201:{},202:{f:Kt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ar},220:{},221:{f:Kt},222:{},224:{f:QA},225:{f:FA},226:{f:ii},227:{},229:{f:u5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:DA},253:{f:$A},255:{f:IA},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Kt},353:{f:ii},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:r5},431:{f:Kt},432:{},433:{},434:{},437:{},438:{f:p5},439:{f:Kt},440:{f:m5},441:{},442:{f:_c},443:{},444:{f:ar},445:{},446:{},448:{f:ii},449:{f:zA,r:2},450:{f:ii},512:{f:bx},513:{f:E5},515:{f:t5},516:{f:GA},517:{f:Nx},519:{f:T5},520:{f:jA},523:{},545:{f:Fx},549:{f:Cx},566:{},574:{f:HA},638:{f:qA},659:{},1048:{},1054:{f:ZA},1084:{},1212:{f:s5},2048:{f:g5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:du},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ii},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:y5,r:12},2173:{f:YL,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Kt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:i5,r:12},2197:{},2198:{f:WL,r:12},2199:{},2200:{},2201:{},2202:{f:o5,r:12},2203:{f:ii},2204:{},2205:{},2206:{},2207:{},2211:{f:BA},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ar},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:k5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:v5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:bx},1:{},2:{f:A5},3:{f:N5},4:{f:b5},5:{f:Nx},7:{f:L5},8:{},9:{f:du},11:{},22:{f:ar},30:{f:XA},31:{},32:{},33:{f:Fx},36:{},37:{f:Cx},50:{f:P5},62:{},52:{},67:{},68:{f:ar},69:{},86:{},126:{},127:{f:C5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:F5},223:{},234:{},354:{},421:{},518:{f:dd},521:{f:du},536:{f:Px},547:{f:Lx},561:{},579:{},1030:{f:dd},1033:{f:du},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vn(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Y2(r)&&e.push(r)}}function Vx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,l=i&&i.index||e.length,u=tN(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,m=0,g=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},_=[];for(o=0;o<u.length;++o){var y=u[o].trim(),E=y.slice(0,3).toLowerCase();if(E=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(E!="<td"&&E!="<th")){var k=y.split(/<\/t[dh]>/i);for(l=0;l<k.length;++l){var S=k[l].trim();if(S.match(/<t[dh]/i)){for(var w=S,A=0;w.charAt(0)=="<"&&(A=w.indexOf(">"))>-1;)w=w.slice(A+1);for(var I=0;I<_.length;++I){var D=_[I];D.s.c==h&&D.s.r<f&&f<=D.e.r&&(h=D.e.c+1,I=-1)}var P=$e(S.slice(0,S.indexOf(">")));g=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||g>1)&&_.push({s:{r:f,c:h},e:{r:f+(m||1)-1,c:h+g-1}});var W=P.t||P["data-t"]||"";if(!w.length){h+=g;continue}if(w=I2(w),x.s.r>f&&(x.s.r=f),x.e.r<f&&(x.e.r=f),x.s.c>h&&(x.s.c=h),x.e.c<h&&(x.e.c=h),!w.length){h+=g;continue}var j={t:"s",v:w};r.raw||!w.trim().length||W=="s"||(w==="TRUE"?j={t:"b",v:!0}:w==="FALSE"?j={t:"b",v:!1}:isNaN(Jn(w))?isNaN(Eo(w).getDate())||(j={t:"d",v:vr(w)},r.cellDates||(j={t:"n",v:Kr(j.v)}),j.z=r.dateNF||tt[14]):j={t:"n",v:Jn(w)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=j):n[Ke({r:f,c:h})]=j,h+=g}}}}return n["!ref"]=xt(x),_.length&&(n["!merges"]=_),n}function P8(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>o)&&!(a[f].e.r<r||a[f].e.c<o)){if(a[f].s.r<r||a[f].s.c<o){l=-1;break}l=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(l<0)){var h=Ke({r,c:o}),m=n.dense?(e[r]||[])[o]:e[h],g=m&&m.v!=null&&(m.h||nm(m.w||(Ya(m),m.w)||""))||"",x={};l>1&&(x.rowspan=l),u>1&&(x.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":m&&(x["data-t"]=m&&m.t||"z",m.v!=null&&(x["data-v"]=m.v),m.z!=null&&(x["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),x.id=(n.id||"sjs")+"-"+h,i.push(xN("td",g,x))}}var _="<tr>";return _+i.join("")+"</tr>"}var F8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',O8="</body></html>";function M8(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Di(Vx(r[0],t),t);var n=wm();return r.forEach(function(a,i){km(n,Vx(a,t),"Sheet"+(i+1))}),n}function R8(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function D8(e,t){var r=t||{},n=r.header!=null?r.header:F8,a=r.footer!=null?r.footer:O8,i=[n],o=Oo(e["!ref"]);r.dense=Array.isArray(e),i.push(R8(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(P8(e,o,l,r));return i.push("</table>"+a),i.join("")}function Hw(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Xr(n.origin):n.origin;a=o.r,i=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Oo(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),a==-1&&(f.e.r=a=h.e.r+1)}var m=[],g=0,x=e["!rows"]||(e["!rows"]=[]),_=0,y=0,E=0,k=0,S=0,w=0;for(e["!cols"]||(e["!cols"]=[]);_<l.length&&y<u;++_){var A=l[_];if(Wx(A)){if(n.display)continue;x[y]={hidden:!0}}var I=A.children;for(E=k=0;E<I.length;++E){var D=I[E];if(!(n.display&&Wx(D))){var P=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):I2(D.innerHTML),W=D.getAttribute("data-z")||D.getAttribute("z");for(g=0;g<m.length;++g){var j=m[g];j.s.c==k+i&&j.s.r<y+a&&y+a<=j.e.r&&(k=j.e.c+1-i,g=-1)}w=+D.getAttribute("colspan")||1,((S=+D.getAttribute("rowspan")||1)>1||w>1)&&m.push({s:{r:y+a,c:k+i},e:{r:y+a+(S||1)-1,c:k+i+(w||1)-1}});var V={t:"s",v:P},B=D.getAttribute("data-t")||D.getAttribute("t")||"";P!=null&&(P.length==0?V.t=B||"z":n.raw||P.trim().length==0||B=="s"||(P==="TRUE"?V={t:"b",v:!0}:P==="FALSE"?V={t:"b",v:!1}:isNaN(Jn(P))?isNaN(Eo(P).getDate())||(V={t:"d",v:vr(P)},n.cellDates||(V={t:"n",v:Kr(V.v)}),V.z=n.dateNF||tt[14]):V={t:"n",v:Jn(P)})),V.z===void 0&&W!=null&&(V.z=W);var Z="",K=D.getElementsByTagName("A");if(K&&K.length)for(var ve=0;ve<K.length&&!(K[ve].hasAttribute("href")&&(Z=K[ve].getAttribute("href"),Z.charAt(0)!="#"));++ve);Z&&Z.charAt(0)!="#"&&(V.l={Target:Z}),n.dense?(e[y+a]||(e[y+a]=[]),e[y+a][k+i]=V):e[Ke({c:k+i,r:y+a})]=V,f.e.c<k+i&&(f.e.c=k+i),k+=w}}++y}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,y-1+a),e["!ref"]=xt(f),y>=u&&(e["!fullref"]=xt((f.e.r=l.length-_+y-1+a,f))),e}function Vw(e,t){var r=t||{},n=r.dense?[]:{};return Hw(n,e,t)}function I8(e,t){return Di(Vw(e,t),t)}function Wx(e){var t="",r=j8(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function j8(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function B8(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wt(t.replace(/<[^>]*>/g,""));return[r]}var $x={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ww(e,t){var r=t||{},n=am(e),a=[],i,o,l={name:""},u="",f=0,h,m,g={},x=[],_=r.dense?[]:{},y,E,k={value:""},S="",w=0,A=[],I=-1,D=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,j={},V=[],B={},Z=0,K=0,ve=[],_e=1,de=1,J=[],Q={Names:[]},U={},te=["",""],fe=[],F={},ee="",q=0,X=!1,ae=!1,ke=0;for(Jl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Jl.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?_["!ref"]=xt(P):_["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(_["!fullref"]=_["!ref"],P.e.r=r.sheetRows-1,_["!ref"]=xt(P)),V.length&&(_["!merges"]=V),ve.length&&(_["!rows"]=ve),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),x.push(h.name),g[h.name]=_,ae=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=$e(y[0],!1),I=D=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,_=r.dense?[]:{},V=[],ve=[],ae=!0);break;case"table-row-group":y[1]==="/"?--W:++W;break;case"table-row":case"":if(y[1]==="/"){I+=_e,_e=1;break}if(m=$e(y[0],!1),m.?I=m.-1:I==-1&&(I=0),_e=+m["number-rows-repeated"]||1,_e<10)for(ke=0;ke<_e;++ke)W>0&&(ve[I+ke]={level:W});D=-1;break;case"covered-table-cell":y[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(_[I]||(_[I]=[]),_[I][D]={t:"z"}):_[Ke({r:I,c:D})]={t:"z"}),S="",A=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++D,k=$e(y[0],!1),de=parseInt(k["number-columns-repeated"]||"1",10),E={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(E.f=Bx(wt(k.formula))),(k.||k["value-type"])=="string"&&(E.t="s",E.v=wt(k["string-value"]||""),r.dense?(_[I]||(_[I]=[]),_[I][D]=E):_[Ke({r:I,c:D})]=E),D+=de-1;else if(y[1]!=="/"){++D,S="",w=0,A=[],de=1;var Le=_e?I+_e-1:I;if(D>P.e.c&&(P.e.c=D),D<P.s.c&&(P.s.c=D),I<P.s.r&&(P.s.r=I),Le>P.e.r&&(P.e.r=Le),k=$e(y[0],!1),fe=[],F={},E={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=wt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Z=parseInt(k["number-matrix-rows-spanned"],10)||0,K=parseInt(k["number-matrix-columns-spanned"],10)||0,B={s:{r:I,c:D},e:{r:I+Z-1,c:D+K-1}},E.F=xt(B),J.push([B,E.F])),k.formula)E.f=Bx(k.formula);else for(ke=0;ke<J.length;++ke)I>=J[ke][0].s.r&&I<=J[ke][0].e.r&&D>=J[ke][0].s.c&&D<=J[ke][0].e.c&&(E.F=J[ke][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Z=parseInt(k["number-rows-spanned"],10)||0,K=parseInt(k["number-columns-spanned"],10)||0,B={s:{r:I,c:D},e:{r:I+Z-1,c:D+K-1}},V.push(B)),k["number-columns-repeated"]&&(de=parseInt(k["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Dt(k["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(k.value);break;case"percentage":E.t="n",E.v=parseFloat(k.value);break;case"currency":E.t="n",E.v=parseFloat(k.value);break;case"date":E.t="d",E.v=vr(k["date-value"]),r.cellDates||(E.t="n",E.v=Kr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=Jb(k["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Qf(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(k.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",k["string-value"]!=null&&(S=wt(k["string-value"]),A=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(X=!1,E.t==="s"&&(E.v=S||"",A.length&&(E.R=A),X=w==0),U.Target&&(E.l=U),fe.length>0&&(E.c=fe,fe=[]),S&&r.cellText!==!1&&(E.w=S),X&&(E.t="z",delete E.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var Ne=0;Ne<_e;++Ne){if(de=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(_[I+Ne]||(_[I+Ne]=[]),_[I+Ne][D]=Ne==0?E:Tr(E);--de>0;)_[I+Ne][D+de]=Tr(E);else for(_[Ke({r:I+Ne,c:D})]=E;--de>0;)_[Ke({r:I+Ne,c:D+de})]=Tr(E);P.e.c<=D&&(P.e.c=D)}de=parseInt(k["number-columns-repeated"]||"1",10),D+=de-1,de=0,E={},S="",A=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i;F.t=S,A.length&&(F.R=A),F.a=ee,fe.push(F)}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);ee="",q=0,S="",w=0,A=[];break;case"creator":y[1]==="/"?ee=n.slice(q,y.index):q=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);S="",w=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(j[l.name]=u,(i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(u="",l=$e(y[0],!1),a.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=$e(y[0],!1),u+=$x[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=$e(y[0],!1),u+=$x[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":o=$e(y[0],!1),te=hd(o["cell-range-address"]);var we={Name:o.name,Ref:te[0]+"!"+te[1]};ae&&(we.Sheet=x.length),Q.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var Be=B8(n.slice(w,y.index));S=(S.length>0?S+`
`:"")+Be[0]}else $e(y[0],!1),w=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{te=hd($e(y[0])["target-range-address"]),g[te[0]]["!autofilter"]={ref:te[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(U=$e(y[0],!1),!U.href)break;U.Target=wt(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(te=hd(U.Target.slice(1)),U.Target="#"+te[0]+"!"+te[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var G={Sheets:g,SheetNames:x,Workbook:Q};return r.bookSheets&&delete G.Sheets,G}function Gx(e,t){t=t||{},bn(e,"META-INF/manifest.xml")&&tA(nr(e,"META-INF/manifest.xml"),t);var r=pn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ww(Pt(r),t);return bn(e,"meta.xml")&&(n.Props=nw(nr(e,"meta.xml"))),n}function Zx(e,t){return Ww(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function xm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pt(ks(e))}function Oh(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Xx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function z8(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function rc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Br(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=rc(e,r),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=rc(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:l,type:i};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function vm(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function U8(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=rc(e,n),i=Br(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:fr(i[1][0].data),messages:[]};i[2].forEach(function(l){var u=Br(l.data),f=fr(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=i[3])!=null&&t[0]&&(o.merge=fr(i[3][0].data)>>>0>0),r.push(o)}return r}function H8(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=rc(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,f=0;if(i==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,i==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Oh(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(a.push(a[0].slice(-u)),f-=u;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-u,-u+f))}}var h=Oh(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function V8(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(H8(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Oh(t)}function W8(e,t,r,n){var a=xm(e),i=a.getUint32(4,!0),o=(n>1?12:8)+Xx(i&(n>1?3470:398))*4,l=-1,u=-1,f=NaN,h=new Date(2001,0,1);i&512&&(l=a.getUint32(o,!0),o+=4),o+=Xx(i&(n>1?12288:4096))*4,i&16&&(u=a.getUint32(o,!0),o+=4),i&32&&(f=a.getFloat64(o,!0),o+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function $8(e,t,r){var n=xm(e),a=n.getUint32(8,!0),i=12,o=-1,l=-1,u=NaN,f=NaN,h=new Date(2001,0,1);a&1&&(u=z8(e,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function G8(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return W8(e,t,r,e[0]);case 5:return $8(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ci(e){var t=Br(e);return rc(t[1][0].data)}function qx(e,t){var r=Br(t.data),n=fr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var l=Br(o.data),u=fr(l[1][0].data)>>>0;switch(n){case 1:i[u]=Fh(l[3][0].data);break;case 8:{var f=e[Ci(l[9][0].data)][0],h=Br(f.data),m=e[Ci(h[1][0].data)][0],g=fr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var x=Br(m.data);i[u]=x[3].map(function(_){return Fh(_.data)}).join("")}break}}),i}function Z8(e,t){var r,n,a,i,o,l,u,f,h,m,g,x,_,y,E=Br(e),k=fr(E[1][0].data)>>>0,S=fr(E[2][0].data)>>>0,w=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&fr(E[8][0].data)>0||!1,A,I;if((i=(a=E[7])==null?void 0:a[0])!=null&&i.data&&t!=0)A=(l=(o=E[7])==null?void 0:o[0])==null?void 0:l.data,I=(f=(u=E[6])==null?void 0:u[0])==null?void 0:f.data;else if((m=(h=E[4])==null?void 0:h[0])!=null&&m.data&&t!=1)A=(x=(g=E[4])==null?void 0:g[0])==null?void 0:x.data,I=(y=(_=E[3])==null?void 0:_[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=w?4:1,P=xm(A),W=[],j=0;j<A.length/2;++j){var V=P.getUint16(j*2,!0);V<65535&&W.push([j,V])}if(W.length!=S)throw"Expected ".concat(S," cells, found ").concat(W.length);var B=[];for(j=0;j<W.length-1;++j)B[W[j][0]]=I.subarray(W[j][1]*D,W[j+1][1]*D);return W.length>=1&&(B[W[W.length-1][0]]=I.subarray(W[W.length-1][1]*D)),{R:k,cells:B}}function X8(e,t){var r,n=Br(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?fr(n[7][0].data)>>>0>0?1:0:-1,i=vm(n[5],function(o){return Z8(o,a)});return{nrows:fr(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,f){if(o[l.R][f])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(f));o[l.R][f]=u}),o},[])}}function q8(e,t,r){var n,a=Br(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(fr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(fr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=xt(i);var o=Br(a[4][0].data),l=qx(e,e[Ci(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?qx(e,e[Ci(o[17][0].data)][0]):[],f=Br(o[3][0].data),h=0;f[1].forEach(function(m){var g=Br(m.data),x=e[Ci(g[2][0].data)][0],_=fr(x.meta[1][0].data);if(_!=6002)throw new Error("6001 unexpected reference to ".concat(_));var y=X8(e,x);y.data.forEach(function(E,k){E.forEach(function(S,w){var A=Ke({r:h+k,c:w}),I=G8(S,l,u);I&&(r[A]=I)})}),h+=y.nrows})}function Y8(e,t){var r=Br(t.data),n={"!ref":"A1"},a=e[Ci(r[2][0].data)],i=fr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return q8(e,a[0],n),n}function K8(e,t){var r,n=Br(t.data),a={name:(r=n[1])!=null&&r[0]?Fh(n[1][0].data):"",sheets:[]},i=vm(n[2],Ci);return i.forEach(function(o){e[o].forEach(function(l){var u=fr(l.meta[1][0].data);u==6e3&&a.sheets.push(Y8(e,l))})}),a}function J8(e,t){var r=wm(),n=Br(t.data),a=vm(n[1],Ci);if(a.forEach(function(i){e[i].forEach(function(o){var l=fr(o.meta[1][0].data);if(l==2){var u=K8(e,o);u.sheets.forEach(function(f,h){km(r,f,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function md(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=V8(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var h;try{h=U8(f)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(u){i[u].forEach(function(f){var h=fr(f.meta[1][0].data)>>>0;if(h==1)if(!l)l=f;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return J8(i,l)}function Q8(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function _m(e){Q8([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function eO(e){return to.WS.indexOf(e)>-1?"sheet":e==to.CS?"chart":e==to.DS?"dialog":e==to.MS?"macro":e&&e.length?e:"sheet"}function tO(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,eO(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function rO(e,t,r,n,a,i,o,l,u,f,h,m){try{i[n]=Tl(pn(e,r,!0),t);var g=nr(e,t),x;switch(l){case"sheet":x=l8(g,t,a,u,i[n],f,h,m);break;case"chart":if(x=c8(g,t,a,u,i[n],f,h,m),!x||!x["!drawel"])break;var _=ul(x["!drawel"].Target,t),y=bh(_),E=oP(pn(e,_,!0),Tl(pn(e,y,!0),_)),k=ul(E,_),S=bh(k);x=$F(pn(e,k,!0),k,u,Tl(pn(e,S,!0),k),f,x);break;case"macro":x=u8(g,t,a,u,i[n],f,h,m);break;case"dialog":x=f8(g,t,a,u,i[n],f,h,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=x;var w=[];i&&i[n]&&wa(i[n]).forEach(function(A){var I="";if(i[n][A].Type==to.CMNT){I=ul(i[n][A].Target,t);var D=m8(nr(e,I,!0),I,u);if(!D||!D.length)return;Mx(x,D,!1)}i[n][A].Type==to.TCMNT&&(I=ul(i[n][A].Target,t),w=w.concat(cP(nr(e,I,!0),u)))}),w&&w.length&&Mx(x,w,!0,u.people||[])}catch(A){if(u.WTF)throw A}}function Tn(e){return e.charAt(0)=="/"?e.slice(1):e}function nO(e,t){if(N2(),t=t||{},_m(t),bn(e,"META-INF/manifest.xml")||bn(e,"objectdata.xml"))return Gx(e,t);if(bn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof md<"u"){if(e.FileIndex)return md(e);var r=gt.utils.cfb_new();return ox(e).forEach(function(ve){aN(r,ve,nN(e,ve))}),md(r)}throw new Error("Unsupported NUMBERS file")}if(!bn(e,"[Content_Types].xml"))throw bn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=ox(e),a=QN(pn(e,"[Content_Types].xml")),i=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",nr(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!nr(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(Nl=[],a.sst)try{Nl=p8(nr(e,Tn(a.sst)),a.sst,t)}catch(ve){if(t.WTF)throw ve}t.cellStyles&&a.themes.length&&(u=h8(pn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=d8(nr(e,Tn(a.style)),a.style,u,t))}a.links.map(function(ve){try{var _e=Tl(pn(e,bh(Tn(ve))),ve);return x8(nr(e,Tn(ve)),_e,ve,t)}catch{}});var h=o8(nr(e,Tn(a.workbooks[0])),a.workbooks[0],t),m={},g="";a.coreprops.length&&(g=nr(e,Tn(a.coreprops[0]),!0),g&&(m=nw(g)),a.extprops.length!==0&&(g=nr(e,Tn(a.extprops[0]),!0),g&&aA(g,m,t)));var x={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(g=pn(e,Tn(a.custprops[0]),!0),g&&(x=sA(g,t)));var _={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(_e){return _e.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(_.Props=m,_.Custprops=x),t.bookSheets&&typeof o<"u"&&(_.SheetNames=o),t.bookSheets?_.SheetNames:t.bookProps))return _;o={};var y={};t.bookDeps&&a.calcchain&&(y=g8(nr(e,Tn(a.calcchain)),a.calcchain));var E=0,k={},S,w;{var A=h.Sheets;m.Worksheets=A.length,m.SheetNames=[];for(var I=0;I!=A.length;++I)m.SheetNames[I]=A[I].name}var D=i?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),W=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");bn(e,W)||(W="xl/_rels/workbook."+D+".rels");var j=Tl(pn(e,W,!0),W.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=v8(nr(e,Tn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=uP(nr(e,Tn(a.people[0])),t)),j&&(j=tO(j,h.Sheets));var V=nr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=m.Worksheets;++E){var B="sheet";if(j&&j[E]?(S="xl/"+j[E][1].replace(/[\/]?xl\//,""),bn(e,S)||(S=j[E][1]),bn(e,S)||(S=W.replace(/_rels\/.*$/,"")+j[E][1]),B=j[E][2]):(S="xl/worksheets/sheet"+(E+1-V)+"."+D,S=S.replace(/sheet0\./,"sheet.")),w=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(m.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Z=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==E&&(Z=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==m.SheetNames[E].toLowerCase()&&(Z=1);if(!Z)continue e}}rO(e,S,w,m.SheetNames[E],E,k,o,B,t,h,u,f)}return _={Directory:a,Workbook:h,Props:m,Custprops:x,Deps:y,Sheets:o,SheetNames:m.SheetNames,Strings:Nl,Styles:f,Themes:u,SSF:Tr(tt)},t&&t.bookFiles&&(e.files?(_.keys=n,_.files=e.files):(_.keys=[],_.files={},e.FullPaths.forEach(function(ve,_e){ve=ve.replace(/^Root Entry[\/]/,""),_.keys.push(ve),_.files[ve]=e.FileIndex[_e]}))),t&&t.bookVBA&&(a.vba.length>0?_.vbaraw=nr(e,Tn(a.vba[0]),!0):a.defaults&&a.defaults.bin===pP&&(_.vbaraw=nr(e,"xl/vbaProject.bin",!0))),_}function aO(e,t){var r=t||{},n="Workbook",a=gt.find(e,n);try{if(n="/!DataSpaces/Version",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Y5(a.content),n="/!DataSpaces/DataSpaceMap",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=J5(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Q5(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);tL(a.content)}catch{}if(n="/EncryptionInfo",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=rL(a.content);if(n="/EncryptedPackage",a=gt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function ym(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_n(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function iO(e,t){return gt.find(e,"EncryptedPackage")?aO(e,t):Uw(e,t)}function sO(e,t){var r,n=e,a=t||{};return a.type||(a.type=ht&&Buffer.isBuffer(e)?"buffer":"base64"),r=M2(n,a),nO(r,a)}function $w(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lh(e.slice(r),t);default:break e}return Ql.to_workbook(e,t)}function oO(e,t){var r="",n=ym(e,t);switch(t.type){case"base64":r=_n(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=gs(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Pt(r)),t.type="binary",$w(r,t)}function lO(e,t){var r=e;return t.type=="base64"&&(r=_n(r)),r=fi.utils.decode(1200,r.slice(2),"str"),t.type="binary",$w(r,t)}function cO(e){return e.match(/[^\x00-\x7F]/)?fl(e):e}function gd(e,t,r,n){return n?(r.type="string",Ql.to_workbook(e,r)):Ql.to_workbook(t,r)}function Mh(e,t){g2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Mh(new Uint8Array(e),(r=Tr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ho={},r.dateNF&&(ho.dateNF=r.dateNF),r.type||(r.type=ht&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ht?"buffer":"binary",n=Yb(e),typeof Uint8Array<"u"&&!ht&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=cO(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Tr(r),r.type="array",Mh(Jp(n),r)}switch((a=ym(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return iO(gt.read(n,r),r);break;case 9:if(a[1]<=8)return Uw(n,r);break;case 60:return Lh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return I5(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return R5.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?sO(n,r):gd(e,n,r,i);case 239:return a[3]===60?Lh(n,r):gd(e,n,r,i);case 255:if(a[1]===254)return lO(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return bl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return bl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Ox.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return pL.to_workbook(n,r);break;case 10:case 13:case 32:return oO(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return O5.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ox.to_workbook(n,r):gd(e,n,r,i)}function uO(e,t,r,n,a,i,o,l){var u=Cr(r),f=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!o||e[r])for(var x=t.s.c;x<=t.e.c;++x){var _=o?e[r][x]:e[n[x]+u];if(_===void 0||_.t===void 0){if(f===void 0)continue;i[x]!=null&&(g[i[x]]=f);continue}var y=_.v;switch(_.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(i[x]!=null){if(y==null)if(_.t=="e"&&y===null)g[i[x]]=null;else if(f!==void 0)g[i[x]]=f;else if(h&&y===null)g[i[x]]=null;else continue;else g[i[x]]=h&&(_.t!=="n"||_.t==="n"&&l.rawNumbers!==!1)?y:Ya(_,y,l);y!=null&&(m=!1)}}return{row:g,isempty:m}}function Rh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":u=qt(h);break;case"number":u=qt(e["!ref"]),u.s.r=h;break;default:u=h}n>0&&(a=0);var m=Cr(u.s.r),g=[],x=[],_=0,y=0,E=Array.isArray(e),k=u.s.r,S=0,w={};E&&!e[k]&&(e[k]=[]);var A=f.skipHidden&&e["!cols"]||[],I=f.skipHidden&&e["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(A[S]||{}).hidden)switch(g[S]=ur(S),r=E?e[k][S]:e[g[S]+m],n){case 1:i[S]=S-u.s.c;break;case 2:i[S]=g[S];break;case 3:i[S]=f.header[S-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ya(r,null,f),y=w[o]||0,!y)w[o]=1;else{do l=o+"_"+y++;while(w[l]);w[o]=y,w[l]=1}i[S]=l}for(k=u.s.r+a;k<=u.e.r;++k)if(!(I[k]||{}).hidden){var D=uO(e,u,k,g,n,i,E,f);(D.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(x[_++]=D.row)}return x.length=_,x}var Yx=/"/g;function fO(e,t,r,n,a,i,o,l){for(var u=!0,f=[],h="",m=Cr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var x=l.dense?(e[r]||[])[g]:e[n[g]+m];if(x==null)h="";else if(x.v!=null){u=!1,h=""+(l.rawNumbers&&x.t=="n"?x.v:Ya(x,null,l));for(var _=0,y=0;_!==h.length;++_)if((y=h.charCodeAt(_))===a||y===i||y===34||l.forceQuotes){h='"'+h.replace(Yx,'""')+'"';break}h=="ID"&&(h='"ID"')}else x.f!=null&&!x.F?(u=!1,h="="+x.f,h.indexOf(",")>=0&&(h='"'+h.replace(Yx,'""')+'"')):h="";f.push(h)}return l.blankrows===!1&&u?null:f.join(o)}function Gw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=qt(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),h="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],_=a.s.c;_<=a.e.c;++_)(g[_]||{}).hidden||(m[_]=ur(_));for(var y=0,E=a.s.r;E<=a.e.r;++E)(x[E]||{}).hidden||(h=fO(e,a,E,m,o,u,i,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&r.push((y++?l:"")+h)));return delete n.dense,r.join("")}function dO(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Gw(e,t);return r}function hO(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=qt(e["!ref"]),i="",o=[],l,u=[],f=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=ur(l);for(var h=a.s.r;h<=a.e.r;++h)for(i=Cr(h),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+i,r=f?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function Zw(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Xr(n.origin):n.origin;o=u.r,l=u.c}var f,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(i["!ref"]){var m=qt(i["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(o=m.e.r+1,h.e.r=o+t.length-1+a)}else o==-1&&(o=0,h.e.r=t.length-1+a);var g=n.header||[],x=0;t.forEach(function(y,E){wa(y).forEach(function(k){(x=g.indexOf(k))==-1&&(g[x=g.length]=k);var S=y[k],w="z",A="",I=Ke({c:l+x,r:o+E+a});f=nc(i,I),S&&typeof S=="object"&&!(S instanceof Date)?i[I]=S:(typeof S=="number"?w="n":typeof S=="boolean"?w="b":typeof S=="string"?w="s":S instanceof Date?(w="d",n.cellDates||(w="n",S=Kr(S)),A=n.dateNF||tt[14]):S===null&&n.nullError&&(w="e",S=0),f?(f.t=w,f.v=S,delete f.w,delete f.R,A&&(f.z=A)):i[I]=f={t:w,v:S},A&&(f.z=A))})}),h.e.c=Math.max(h.e.c,l+g.length-1);var _=Cr(o);if(a)for(x=0;x<g.length;++x)i[ur(x+l)+_]={t:"s",v:g[x]};return i["!ref"]=xt(h),i}function pO(e,t){return Zw(null,e,t)}function nc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Xr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?nc(e,Ke(t)):nc(e,Ke({r:t,c:r||0}))}function mO(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function wm(){return{SheetNames:[],Sheets:{}}}function km(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(QF(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function gO(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=mO(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function xO(e,t){return e.z=t,e}function Xw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function vO(e,t,r){return Xw(e,"#"+t,r)}function _O(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yO(e,t,r,n){for(var a=typeof t!="string"?t:qt(t),i=typeof t=="string"?t:xt(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var u=nc(e,o,l);u.t="n",u.F=i,delete u.v,o==a.s.r&&l==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var wO={encode_col:ur,encode_row:Cr,encode_cell:Ke,encode_range:xt,decode_col:om,decode_row:sm,split_cell:FN,decode_cell:Xr,decode_range:Oo,format_cell:Ya,sheet_add_aoa:J2,sheet_add_json:Zw,sheet_add_dom:Hw,aoa_to_sheet:Mo,json_to_sheet:pO,table_to_sheet:Vw,table_to_book:I8,sheet_to_csv:Gw,sheet_to_txt:dO,sheet_to_json:Rh,sheet_to_html:D8,sheet_to_formulae:hO,sheet_to_row_object_array:Rh,sheet_get_cell:nc,book_new:wm,book_append_sheet:km,book_set_sheet_visibility:gO,cell_set_number_format:xO,cell_set_hyperlink:Xw,cell_set_internal_link:vO,cell_add_comment:_O,sheet_set_array_formula:yO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class dl extends Error{}dl.prototype.name="InvalidTokenError";function kO(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function EO(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return kO(t)}catch{return atob(t)}}function SO(e,t){if(typeof e!="string")throw new dl("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new dl(`Invalid token specified: missing part #${r+1}`);let a;try{a=EO(n)}catch(i){throw new dl(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(a)}catch(i){throw new dl(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const TO=e=>{try{const t=SO(e),r=Date.now()/1e3;return t.exp>r}catch{return!1}},ma=()=>{const e=localStorage.getItem("token");return e?TO(e)?e:(CO(),null):null},CO=()=>{localStorage.removeItem("token")},bO=async(e,t)=>{var r,n;try{return(await Ue.post(`${jt}/command/execute/`,{firewall_id:e,command:t},{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})).data}catch(a){throw Ue.isAxiosError(a)?new Error(((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.error)||"Failed to execute command"):a}},NO=async e=>{var t,r;try{return(await Ue.get(`${jt}/command/commands/`,{params:{firewall_id:e},headers:{Authorization:`Bearer ${ma()}`}})).data}catch(n){throw Ue.isAxiosError(n)?new Error(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.error)||"Failed to fetch command history"):n}},$i=Ue.create({baseURL:jt,headers:{"Content-Type":"application/json"},withCredentials:!0});$i.interceptors.request.use(async e=>{var n;const t=ma();t&&(e.headers.Authorization=`Bearer ${t}`);const r=(n=document.cookie.split("; ").find(a=>a.startsWith("csrftoken=")))==null?void 0:n.split("=")[1];return r&&(e.headers["X-CSRFToken"]=r),e},e=>Promise.reject(e));const AO=[{name:"Name",description:"Template name"},{name:"Source Address",description:"Source IP address or network"},{name:"Source Description",description:"Description of the source"},{name:"Source Interface",description:"Source network interface"},{name:"Destination Address",description:"Destination IP address or network"},{name:"Destination Description",description:"Description of the destination"},{name:"Destination Interface",description:"Destination network interface"},{name:"Service",description:"Network service or port"}];class LO{async getVariables(){try{return(await $i.get("/templates/variables/")).data.results||[]}catch{throw new Error("Failed to fetch variables")}}async getTemplate(t){try{return(await $i.get(`/templates/${t}/`)).data}catch{throw new Error("Failed to fetch template")}}async getTemplates(){try{return(await $i.get("/templates/")).data.results||[]}catch{throw new Error("Failed to fetch templates")}}async createTemplate(t){try{return(await $i.post("/templates/",t)).data}catch{throw new Error("Failed to create template")}}async updateTemplate(t,r){try{return(await $i.patch(`/templates/${t}/`,r)).data}catch{throw new Error("Failed to update template")}}async deleteTemplate(t){try{await $i.delete(`/templates/${t}/`)}catch{throw new Error("Failed to delete template")}}}const zs=new LO,Us={getVariables:async()=>{var e,t,r;try{const n=ma();if(!n)return console.error("No authentication token found"),[];let a=[],i=`${jt}/templates/variables/`;for(;i;){const o=await Ue.get(i,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(Array.isArray(o.data))a=[...a,...o.data],i=null;else if(o.data.results&&Array.isArray(o.data.results))a=[...a,...o.data.results],i=o.data.next;else{console.error("Unexpected API response format:",o.data);break}}return a}catch(n){return console.error("Error fetching variables:",n),Ue.isAxiosError(n)&&console.error("Error details:",{status:(e=n.response)==null?void 0:e.status,data:(t=n.response)==null?void 0:t.data,headers:(r=n.response)==null?void 0:r.headers}),[]}},createVariable:async e=>{try{return(await Ue.post(`${jt}/templates/variables/`,e,{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})).data}catch(t){throw console.error("Error creating variable:",t),t}},updateVariable:async(e,t)=>{try{return(await Ue.put(`${jt}/templates/variables/${e}/`,t,{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})).data}catch(r){throw console.error("Error updating variable:",r),r}},deleteVariable:async e=>{try{await Ue.delete(`${jt}/templates/variables/${e}/`,{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})}catch(t){throw console.error("Error deleting variable:",t),t}},addVariableToTemplate:async(e,t)=>{try{await Ue.post(`${jt}/templates/${e}/add_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error adding variable to template:",r),r}},removeVariableFromTemplate:async(e,t)=>{try{await Ue.post(`${jt}/templates/${e}/remove_variable/`,{variable_id:t},{headers:{Authorization:`Bearer ${ma()}`,"Content-Type":"application/json"}})}catch(r){throw console.error("Error removing variable from template:",r),r}},async ensureRequiredVariables(){const e=await this.getVariables(),t=new Set(e.map(r=>r.name));for(const r of AO)t.has(r.name)||await this.createVariable(r)}},Kx=(e,t)=>{let r;return function(...a){const i=()=>{clearTimeout(r),e(...a)};clearTimeout(r),r=setTimeout(i,t)}},PO=()=>localStorage.getItem("token"),Ma=Ue.create({baseURL:jt});Ma.interceptors.request.use(e=>{const t=PO();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ma.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),uf("/login")),Promise.reject(e)));const FO=()=>{var ut,sr,Tt,at;const[e,t]=C.useState([]),[r,n]=C.useState(null),[a,i]=C.useState({hostname:"",ipAddress:"",vdom:"",setName:"",srcaddr:"",srcaddrDesc:"",srcintf:"",dstaddr:"",dstaddrDesc:"",dstintf:"",service:""});C.useState(""),C.useState("");const[o,l]=C.useState([]),[u,f]=C.useState([]),[h,m]=C.useState([]),[g,x]=C.useState(null),[_,y]=C.useState(!1),[E,k]=C.useState(""),[S,w]=C.useState(""),[A,I]=C.useState([]),[D,P]=C.useState([]),[W,j]=C.useState([]),[V,B]=C.useState({}),[Z,K]=C.useState(""),[ve,_e]=C.useState(""),[de,J]=C.useState([]),[Q,U]=C.useState(!1),[te,fe]=C.useState(null),[F,ee]=C.useState(""),[q,X]=C.useState([]),[ae,ke]=C.useState(!1),[Le,Ne]=C.useState(null);C.useEffect(()=>{(async()=>{try{ke(!0),Ne(null);const ye=await zs.getTemplates();X(ye)}catch(ye){console.error("Error loading templates:",ye),Ne("Failed to load templates")}finally{ke(!1)}})()},[]);const[we,Be]=C.useState(null),[G,Ge]=C.useState(!1),[Je,me]=C.useState(null),[Se,he]=C.useState(null),[Me,He]=C.useState(!1),[nt,kt]=C.useState(null),[Bt,pt]=C.useState([]);C.useEffect(()=>{(async()=>{try{y(!0);const ye=await Ma.get("/datacenters/hierarchy/");pt(ye.data)}catch(ye){console.error("Error fetching hierarchy:",ye)}finally{y(!1)}})()},[]);const _t=()=>{if(!E)return[];const re=Bt.find(ye=>ye.id===E);return re?re.firewall_types:[]},Nt=()=>{if(!S)return[];const re=Bt.find(ze=>ze.id===E);if(!re)return[];const ye=re.firewall_types.find(ze=>ze.id===S);return ye?ye.firewalls:[]},dr=re=>{const ye=re.target.value;k(ye),w(""),x(null)},Nr=re=>{const ye=re.target.value;w(ye),x(null)},$t=re=>{var dt,St;const ye=re.target.value,st=Nt().find(Gt=>Gt.id===ye);if(st){const Gt={id:st.id,name:st.name,ip_address:st.ip_address,data_center:{id:E,name:((dt=Bt.find(Qt=>Qt.id===E))==null?void 0:dt.name)||""},firewall_type:{id:S,name:((St=_t().find(Qt=>Qt.id===S))==null?void 0:St.name)||""},config:{id:"",config_data:{}},created_at:new Date().toISOString()};x(Gt)}};C.useEffect(()=>{Ar()},[]);const Ar=async()=>{try{y(!0);let re=[],ye="/firewalls/firewalls/";for(;ye;){const O=(await Ma.get(ye)).data;re=[...re,...O.results||[]],ye=O.next}const[ze,st]=await Promise.all([Ma.get("/firewalls/firewall-types/"),Ma.get("/datacenters/")]);console.log("API Responses:",{firewallTypes:ze.data,dataCenters:st.data,firewalls:re});const St=(ze.data.results||[]).map(M=>({id:M.id,name:M.name,data_center:M.data_center,attributes_schema:M.attributes_schema||{}}));l(St);const Qt=(st.data.results||[]).map(M=>({id:M.id,name:M.name}));f(Qt);const aa=re.map(M=>({id:M.id,name:M.name,ip_address:M.ip_address,data_center:M.data_center&&M.data_center.id&&M.data_center.name?{id:M.data_center.id,name:M.data_center.name}:null,firewall_type:M.firewall_type&&M.firewall_type.id&&M.firewall_type.name?{id:M.firewall_type.id,name:M.firewall_type.name}:null,config:M.config||{id:"",config_data:{}},created_at:M.created_at}));m(aa);const Lr=localStorage.getItem("dataCenter"),Ie=localStorage.getItem("firewallType"),b=localStorage.getItem("selectedFirewallId");if(Lr&&k(Lr),Ie&&w(Ie),b){const M=aa.find(O=>O.id===b);M&&(x(M),i(O=>({...O,ipAddress:M.ip_address})))}}catch(re){console.error("Error fetching data:",re)}finally{y(!1)}};C.useEffect(()=>{if(E){const re=o.filter(ye=>{if(!ye.data_center)return console.log("No data_center for type:",ye),!1;const ze=ye.data_center===E;return console.log("Type matches:",{typeId:ye.id,typeDataCenter:ye.data_center,selectedDataCenter:E,matches:ze}),ze});console.log("Filtered Firewall Types:",{selectedDataCenter:E,allTypes:o,filteredTypes:re}),I(re),S&&!re.some(ye=>ye.id===S)&&(w(""),localStorage.removeItem("firewallType"))}else I([]),w("")},[E,o]),C.useEffect(()=>{var re;if(S){const ye=A.find(ze=>ze.id===S);if(console.log("Selected Type:",ye),(re=ye==null?void 0:ye.attributes_schema)!=null&&re.properties){const ze=Object.entries(ye.attributes_schema.properties).map(([st,dt])=>({name:st,label:dt.title||st,required:dt.required||!1,type:dt.type||"string"}));console.log("Generated Form Fields:",ze),j(ze)}else console.log("No attributes schema found for type:",ye),j([])}else j([])},[S,A]),C.useEffect(()=>{if(S&&E){const re=h.filter(ye=>{if(!ye.firewall_type||!ye.data_center)return!1;const ze=ye.firewall_type.id===S,st=ye.data_center.id===E;return console.log("Firewall Filter Check:",{firewallId:ye.id,firewallType:ye.firewall_type.id,dataCenter:ye.data_center.id,selectedType:S,selectedDC:E,matchesType:ze,matchesDataCenter:st}),ze&&st});console.log("Filtered Firewalls:",{selectedFirewallType:S,selectedDataCenter:E,allFirewalls:h,filteredFirewalls:re}),P(re),g&&!re.some(ye=>ye.id===g.id)&&(x(null),localStorage.removeItem("selectedFirewallId"))}else P([]),x(null)},[S,E,h]),C.useEffect(()=>{const re=localStorage.getItem("dataCenter"),ye=localStorage.getItem("firewallType"),ze=localStorage.getItem("selectedFirewallId");if(console.log("Loading saved selections:",{savedDataCenter:re,savedFirewallType:ye,savedFirewallId:ze}),re&&k(re),ye&&w(ye),ze){const st=h.find(dt=>dt.id===ze);st&&(x(st),i(dt=>({...dt,ipAddress:st.ip_address})))}},[h]);const Ze=re=>{var ye;try{const ze=Mh(re,{type:"array"});if(!ze.SheetNames.length)throw new Error("No sheets found in the Excel file");const st=ze.SheetNames[0],dt=ze.Sheets[st],St=A.find(b=>b.id===S);if(!St)throw new Error("No firewall type selected");if(!((ye=St.attributes_schema)!=null&&ye.properties))throw new Error("No attributes defined for the selected firewall type");const Gt=Object.entries(St.attributes_schema.properties).filter(([b,M])=>M.required).map(([b])=>b),Qt=wO.sheet_to_json(dt,{raw:!1,header:1});if(!Array.isArray(Qt)||Qt.length===0)throw new Error("No data found in the Excel file");const aa=Qt[0];if(!Array.isArray(aa)||aa.length===0)throw new Error("No headers found in the Excel file");const Ie=Qt.slice(1).map((b,M)=>{var H;const O={};Array.isArray(b)&&aa.forEach((ne,ge)=>{const se=b[ge];O[ne]=se});const R=Gt.filter(ne=>!O[ne]);if(R.length>0)throw new Error(`Missing required fields in row ${M+2}: ${R.join(", ")}`);const z={};return(H=St==null?void 0:St.attributes_schema)!=null&&H.properties&&Object.entries(St.attributes_schema.properties).forEach(([ne,ge])=>{const se=Object.keys(O).find(oe=>{const le=oe.toLowerCase().replace(/\s+/g,""),Te=ne.toLowerCase().replace(/\s+/g,""),Pe={ipaddress:["ip","ipaddress","ipaddr","ip_address","ipaddress","IP Adresse"],sourceaddress:["source","src","sourceaddr","source_address","sourceaddress","source"],destinationinterface:["dstintf","destinationintf","destination_interface","dstinterface","destinationinterface","destination"],name:["name","nom","hostname","device"],vdom:["vdom","virtualdomain"],service:["service","services","protocol"],hostname:["hostname","name","device"],sourcedescription:["sourcedescription","srcdesc","source_desc"],sourceinterface:["sourceinterface","srcintf","source_intf"],destinationaddress:["destinationaddress","dstaddr","destination_addr"],destinationdescription:["destinationdescription","dstdesc","destination_desc"]};return le===Te?!0:Pe[Te]?Pe[Te].includes(le):!1});se?z[ne]=O[se]||"":z[ne]=""}),z});t(Ie),Ie.length>0&&(n(Ie[0]),B(Ie[0])),alert(`${Ie.length} configurations loaded successfully`)}catch(ze){alert(`Error processing Excel file: ${ze.message}`)}},ue=re=>{var ze;const ye=(ze=re.target.files)==null?void 0:ze[0];if(ye){if(!S){alert("Please select a firewall type before uploading the file");return}const st=new FileReader;st.onload=dt=>{var Gt;const St=(Gt=dt.target)==null?void 0:Gt.result;Ze(St)},st.readAsArrayBuffer(ye)}},xe=os.useCallback(Kx(async re=>{var ye,ze,st,dt;if(!(!g||!re)){Ge(!0),me(null),Be(null);try{const St=await Ma.post("/analysis/flow-matrix/analyze-ip/",{source_ip:re,firewall_id:g.id,data_center_name:((ye=g.data_center)==null?void 0:ye.name)||"",firewall_type_name:((ze=g.firewall_type)==null?void 0:ze.name)||""});Be(St.data)}catch(St){me(((dt=(st=St.response)==null?void 0:st.data)==null?void 0:dt.error)||"Failed to search address")}finally{Ge(!1)}}},500),[g]),Ce=os.useCallback(Kx(async re=>{var ye,ze,st,dt;if(!(!g||!re)){He(!0),kt(null),he(null);try{const St=await Ma.post("/analysis/flow-matrix/analyze-ip/",{source_ip:re,firewall_id:g.id,data_center_name:((ye=g.data_center)==null?void 0:ye.name)||"",firewall_type_name:((ze=g.firewall_type)==null?void 0:ze.name)||""});he(St.data)}catch(St){kt(((dt=(st=St.response)==null?void 0:st.data)==null?void 0:dt.error)||"Failed to search address")}finally{He(!1)}}},500),[g]),Fe=(re,ye)=>{B(ze=>({...ze,[re]:ye})),re==="SourceAddress"?xe(ye):re==="DestinationAddress"&&Ce(ye)},Ve=r&&{fields:[{name:"hostname",label:"Hostname",required:!0},{name:"ipAddress",label:"IP Address",required:!0},{name:"vdom",label:"VDOM",required:!0},{name:"setName",label:"Set Name",required:!0},{name:"srcaddr",label:"Source Address",required:!0},{name:"srcaddrDesc",label:"Source Description",required:!1},{name:"srcintf",label:"Source Interface",required:!0},{name:"dstaddr",label:"Destination Address",required:!0},{name:"dstaddrDesc",label:"Destination Description",required:!1},{name:"dstintf",label:"Destination Interface",required:!0},{name:"service",label:"Service",required:!0}]};Ve!=null&&Ve.fields;const Et=async re=>{if(!g){lt("Please select a firewall first");return}try{const ye=await bO(g.id,re);J(ze=>Array.isArray(ze)?[...ze,ye]:[ye]),K(""),lt(null)}catch(ye){lt(ye instanceof Error?ye.message:"Failed to execute command")}};C.useEffect(()=>{(async()=>{if(g)try{const ye=await NO(g.id);J(Array.isArray(ye)?ye:[])}catch(ye){console.error("Error loading command history:",ye),J([])}})()},[g]);const it=()=>{if(!F)return;const re=q.find(Gt=>Gt.name===F);if(!re)return;const ye=/{{([^}]+)}}/g,ze=new Set;let st;for(;(st=ye.exec(re.content))!==null;){const Gt=st[1].trim();ze.add(Gt)}const dt={};ze.forEach(Gt=>{const Qt=V[Gt]||"";dt[`{{ ${Gt} }}`]=Qt});let St=re.content;Object.entries(dt).forEach(([Gt,Qt])=>{St=St.replace(new RegExp(Gt,"g"),Qt)}),K(St)},Xe=async()=>{var re,ye,ze,st;if(!g||!V.SourceAddress){me("Please select a firewall and enter a source address");return}Ge(!0),me(null),Be(null);try{const dt=await Ma.post("/analysis/flow-matrix/analyze-ip/",{source_ip:V.SourceAddress,firewall_id:g.id,data_center_name:((re=g.data_center)==null?void 0:re.name)||"",firewall_type_name:((ye=g.firewall_type)==null?void 0:ye.name)||""});Be(dt.data)}catch(dt){me(((st=(ze=dt.response)==null?void 0:ze.data)==null?void 0:st.error)||"Failed to search source address")}finally{Ge(!1)}};C.useState(!1);const[Ye,lt]=C.useState(null);return C.useState([]),C.useState(!1),C.useState(null),C.useState([]),C.useState([]),C.useState(""),C.useState(""),C.useState(""),d.jsxs("div",{className:"p-8",children:[d.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(mc,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),d.jsxs("select",{value:E,onChange:dr,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"",children:"All data centers"}),Bt.map(re=>d.jsx("option",{value:re.id,children:re.name},re.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(ps,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),d.jsxs("select",{value:S,onChange:Nr,disabled:!E,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${E?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall type"}),_t().map(re=>d.jsx("option",{value:re.id,children:re.name},re.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(gc,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),d.jsxs("select",{value:(g==null?void 0:g.id)||"",onChange:$t,disabled:!S,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${S?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall"}),Nt().map(re=>d.jsxs("option",{value:re.id,children:[re.name," - ",re.ip_address]},re.id))]})]})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsx("div",{className:"space-y-6",children:d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Configuration"}),d.jsx("div",{className:"space-y-4",children:W.length>0?W.map(re=>d.jsxs("div",{className:"mb-6",children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[re.label,re.required&&d.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),d.jsx("div",{className:"relative",children:d.jsx("input",{type:re.type==="string"?"text":re.type,value:V[re.name]||"",onChange:ye=>Fe(re.name,ye.target.value),required:re.required,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2",placeholder:`Enter ${re.label.toLowerCase()}`})})]},re.name)):d.jsx("div",{className:"text-center py-4 text-gray-500",children:S?"No fields defined for this firewall type":"Select a firewall type to see available fields"})})]})}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Slectionner une configuration"}),e.length>0?d.jsxs(d.Fragment,{children:[d.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg mb-4",value:r?JSON.stringify(r):"",onChange:re=>{const ye=JSON.parse(re.target.value);n(ye);const ze={};Object.entries(ye).forEach(([st,dt])=>{ze[st]=String(dt)}),B(ze)},children:[d.jsx("option",{value:"",children:"Choisir une configuration"}),e.map((re,ye)=>d.jsxs("option",{value:JSON.stringify(re),children:[re.hostname," - ",re.ipAddress]},ye))]}),r&&d.jsxs("button",{onClick:()=>{const re={};Object.entries(r).forEach(([ye,ze])=>{re[ye]=String(ze)}),B(re)},className:"w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 flex items-center justify-center",children:[d.jsx(Zp,{className:"w-5 h-5 mr-2"}),"Appliquer la configuration"]})]}):d.jsx("div",{className:"text-center py-4 text-gray-500",children:"Aucune configuration disponible. Veuillez importer un fichier Excel ou crer une configuration manuelle."})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Importer une configuration"}),d.jsx("div",{className:"space-y-4",children:S?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-4",children:d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Format Excel requis:"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsx("tr",{children:Object.entries(((sr=(ut=A.find(re=>re.id===S))==null?void 0:ut.attributes_schema)==null?void 0:sr.properties)||{}).map(([re,ye])=>d.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 uppercase tracking-wider border-b border-gray-200",children:[ye.title," ",ye.required&&d.jsx("span",{className:"text-red-500 ml-1",children:"*"})]},re))})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.jsx("tr",{children:Object.entries(((at=(Tt=A.find(re=>re.id===S))==null?void 0:Tt.attributes_schema)==null?void 0:at.properties)||{}).map(([re,ye])=>d.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 border-b border-gray-200",children:ye.type==="string"?"Texte":ye.type},re))})})]})}),d.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[d.jsx("span",{className:"text-red-500",children:"*"})," Champs obligatoires"]})]})}),d.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[d.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ue,className:"hidden",id:"file-upload"}),d.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center",children:[d.jsx(p2,{className:"h-12 w-12 text-gray-400 mb-4"}),d.jsx("span",{className:"text-gray-600",children:"Choisir un fichier Excel"}),d.jsx("span",{className:"text-sm text-gray-500 mt-2",children:"Format: .xlsx, .xls"})]})]})]}):d.jsx("div",{className:"text-center py-8",children:d.jsx("p",{className:"text-gray-500",children:"Veuillez slectionner un type de pare-feu pour voir les champs requis"})})})]})]})]}),d.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Source Address Search"}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx("input",{type:"text",value:V.SourceAddress||"",onChange:re=>Fe("SourceAddress",re.target.value),placeholder:"Enter source address",className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),d.jsx("button",{onClick:Xe,disabled:G||!g||!V.SourceAddress,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:G?"Searching...":"Search Address"})]}),Je&&d.jsx("div",{className:"mt-4 p-4 bg-red-50 text-red-700 rounded-md",children:Je}),we&&d.jsx("div",{className:"mt-4 space-y-4",children:d.jsxs("div",{className:"p-4 bg-green-50 rounded-md",children:[d.jsx("h4",{className:"font-medium text-green-800 mb-4",children:"Search Results"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Source Address"}),d.jsx("p",{className:"font-medium text-gray-900",children:we.ip})]}),d.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Config Path"}),d.jsx("p",{className:"font-medium text-gray-900",children:we.config_path})]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Matched Address Objects"}),we.matches&&we.matches.length>0?d.jsx("div",{className:"space-y-4",children:we.matches.map((re,ye)=>d.jsxs("div",{className:"border-l-4 border-green-500 pl-3",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),d.jsx("span",{className:"font-medium text-gray-900",children:re.name})]}),re.comment&&d.jsx("div",{className:"ml-4 mt-1",children:d.jsx("p",{className:"text-xs text-gray-500 italic",children:re.comment})}),re.groups&&re.groups.length>0&&d.jsxs("div",{className:"ml-4 mt-2 text-sm text-blue-600",children:["Groups: ",re.groups.join(", ")]})]},ye))}):d.jsx("p",{className:"text-gray-500 italic mt-2",children:"No matches found"})]}),we.matches&&we.matches.length>0&&d.jsxs("details",{className:"mt-4",children:[d.jsx("summary",{className:"text-sm text-gray-500 cursor-pointer",children:"Debug Information"}),d.jsx("div",{className:"mt-2 space-y-2",children:we.matches.map((re,ye)=>d.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"Name:"})," ",re.name]}),re.comment&&d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"Comment:"})," ",re.comment]}),re.groups&&re.groups.length>0&&d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"Groups:"})," ",re.groups.join(", ")]})]},ye))})]})]})})]}),d.jsxs("div",{className:"mt-8 bg-gray-900 rounded-lg shadow-lg p-6",children:[d.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[d.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),d.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),d.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),d.jsx("h2",{className:"text-xl font-semibold text-gray-200 ml-2",children:"Terminal"})]}),d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"text-gray-400",children:"Selected Firewall:"}),d.jsx("span",{className:"text-purple-400",children:g?`${g.name} (${g.ip_address})`:"None"})]}),d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"text-gray-400",children:"Template:"})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsxs("select",{value:F,onChange:re=>ee(re.target.value),className:"flex-1 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:ae,children:[d.jsx("option",{value:"",children:"Select a template..."}),q.map(re=>d.jsx("option",{value:re.name,children:re.name},re.id))]}),d.jsx("button",{onClick:it,disabled:!F||ae,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:ae?"Loading...":"Apply Template"})]}),Le&&d.jsx("div",{className:"mt-2 text-sm text-red-400",children:Le})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsxs("div",{className:"flex-1 relative",children:[d.jsx("span",{className:"absolute left-3 top-2 text-green-400",children:"$"}),d.jsx("textarea",{value:Z,onChange:re=>K(re.target.value),placeholder:"Enter command...",className:"w-full h-32 pl-8 p-2 bg-gray-800 text-gray-200 border border-gray-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm resize-none",onKeyDown:re=>{re.key==="Enter"&&!re.shiftKey&&(re.preventDefault(),Et(Z))}})]}),d.jsxs("div",{className:"flex flex-col space-y-2",children:[d.jsx("button",{onClick:re=>{re.preventDefault(),Et(Z)},disabled:Q||!g||!Z.trim(),className:`px-4 py-2 rounded-md transition-colors duration-200 ${Q?"bg-yellow-600 text-white":!g||!Z.trim()?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,children:Q?d.jsxs("div",{className:"flex items-center",children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Executing..."]}):"Execute"}),d.jsx("button",{onClick:()=>K(""),className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors duration-200",children:"Clear"})]})]})]}),ve&&d.jsxs("div",{className:"mb-4 p-4 bg-gray-800 rounded-md border border-gray-700",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("span",{className:"text-gray-400 text-lg",children:"Output:"}),d.jsx("button",{onClick:()=>_e(""),className:"text-gray-500 hover:text-gray-400",children:"Clear"})]}),d.jsx("pre",{className:"text-sm overflow-auto max-h-96 font-mono text-gray-300 p-4 bg-gray-900 rounded-md",children:ve})]}),te&&d.jsxs("div",{className:"mb-4 p-4 bg-red-900/50 text-red-400 rounded-md border border-red-700",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-red-500 font-semibold",children:"Error:"}),d.jsx("button",{onClick:()=>fe(null),className:"text-red-500 hover:text-red-400",children:"Clear"})]}),d.jsx("p",{className:"mt-2",children:te})]}),de.length>0&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"text-gray-400",children:"History:"})]}),d.jsx("button",{onClick:()=>J([]),className:"text-gray-500 hover:text-gray-400 text-sm",children:"Clear History"})]}),d.jsx("div",{className:"space-y-2",children:de.map((re,ye)=>d.jsxs("div",{className:"bg-gray-800 rounded-md p-3 border border-gray-700",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-green-400",children:"$"}),d.jsx("span",{className:"font-mono text-sm text-gray-300",children:re.command})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:`px-2 py-1 rounded text-xs ${re.status==="completed"?"bg-green-900 text-green-300":re.status==="failed"?"bg-red-900 text-red-300":re.status==="executing"?"bg-yellow-900 text-yellow-300":"bg-gray-900 text-gray-300"}`,children:re.status}),d.jsx("span",{className:"text-xs text-gray-500",children:new Date(re.executed_at).toLocaleString()})]})]}),re.output&&d.jsx("pre",{className:`text-sm overflow-auto max-h-40 font-mono ${re.status==="completed"?"text-gray-300":"text-red-400"}`,children:re.output}),re.error_message&&d.jsxs("div",{className:"mt-2 text-sm text-red-400",children:["Error: ",re.error_message]})]},`${re.id}-${re.executed_at}-${ye}`))})]})]})]})};let OO={data:""},MO=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||OO,RO=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,DO=/\/\*[^]*?\*\/|  +/g,Jx=/\n+/g,hi=(e,t)=>{let r="",n="",a="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?hi(o,i):i+"{"+hi(o,i[1]=="k"?"":t)+"}":typeof o=="object"?n+=hi(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=hi.p?hi.p(i,o):i+":"+o+";")}return r+(t&&a?t+"{"+a+"}":a)+n},Fa={},qw=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+qw(e[r]);return t}return e},IO=(e,t,r,n,a)=>{let i=qw(e),o=Fa[i]||(Fa[i]=(u=>{let f=0,h=11;for(;f<u.length;)h=101*h+u.charCodeAt(f++)>>>0;return"go"+h})(i));if(!Fa[o]){let u=i!==e?e:(f=>{let h,m,g=[{}];for(;h=RO.exec(f.replace(DO,""));)h[4]?g.shift():h[3]?(m=h[3].replace(Jx," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][h[1]]=h[2].replace(Jx," ").trim();return g[0]})(e);Fa[o]=hi(a?{["@keyframes "+o]:u}:u,r?"":"."+o)}let l=r&&Fa.g?Fa.g:null;return r&&(Fa.g=Fa[o]),((u,f,h,m)=>{m?f.data=f.data.replace(m,u):f.data.indexOf(u)===-1&&(f.data=h?u+f.data:f.data+u)})(Fa[o],t,n,l),o},jO=(e,t,r)=>e.reduce((n,a,i)=>{let o=t[i];if(o&&o.call){let l=o(r),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":hi(l,""):l===!1?"":l}return n+a+(o??"")},"");function n0(e){let t=this||{},r=e.call?e(t.p):e;return IO(r.unshift?r.raw?jO(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,MO(t.target),t.g,t.o,t.k)}let Yw,Dh,Ih;n0.bind({g:1});let Ka=n0.bind({k:1});function BO(e,t,r,n){hi.p=t,Yw=e,Dh=r,Ih=n}function Ii(e,t){let r=this||{};return function(){let n=arguments;function a(i,o){let l=Object.assign({},i),u=l.className||a.className;r.p=Object.assign({theme:Dh&&Dh()},l),r.o=/ *go\d+/.test(u),l.className=n0.apply(r,n)+(u?" "+u:"");let f=e;return e[0]&&(f=l.as||e,delete l.as),Ih&&f[0]&&Ih(l),Yw(f,l)}return a}}var zO=e=>typeof e=="function",Cf=(e,t)=>zO(e)?e(t):e,UO=(()=>{let e=0;return()=>(++e).toString()})(),Kw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),HO=20,Jw=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,HO)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return Jw(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Mu=[],ts={toasts:[],pausedAt:void 0},bs=e=>{ts=Jw(ts,e),Mu.forEach(t=>{t(ts)})},VO={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},WO=(e={})=>{let[t,r]=C.useState(ts),n=C.useRef(ts);C.useEffect(()=>(n.current!==ts&&r(ts),Mu.push(r),()=>{let i=Mu.indexOf(r);i>-1&&Mu.splice(i,1)}),[]);let a=t.toasts.map(i=>{var o,l,u;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((o=e[i.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((l=e[i.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||VO[i.type],style:{...e.style,...(u=e[i.type])==null?void 0:u.style,...i.style}}});return{...t,toasts:a}},$O=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||UO()}),Ec=e=>(t,r)=>{let n=$O(t,e,r);return bs({type:2,toast:n}),n.id},kr=(e,t)=>Ec("blank")(e,t);kr.error=Ec("error");kr.success=Ec("success");kr.loading=Ec("loading");kr.custom=Ec("custom");kr.dismiss=e=>{bs({type:3,toastId:e})};kr.remove=e=>bs({type:4,toastId:e});kr.promise=(e,t,r)=>{let n=kr.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?Cf(t.success,a):void 0;return i?kr.success(i,{id:n,...r,...r==null?void 0:r.success}):kr.dismiss(n),a}).catch(a=>{let i=t.error?Cf(t.error,a):void 0;i?kr.error(i,{id:n,...r,...r==null?void 0:r.error}):kr.dismiss(n)}),e};var GO=(e,t)=>{bs({type:1,toast:{id:e,height:t}})},ZO=()=>{bs({type:5,time:Date.now()})},Pl=new Map,XO=1e3,qO=(e,t=XO)=>{if(Pl.has(e))return;let r=setTimeout(()=>{Pl.delete(e),bs({type:4,toastId:e})},t);Pl.set(e,r)},YO=e=>{let{toasts:t,pausedAt:r}=WO(e);C.useEffect(()=>{if(r)return;let i=Date.now(),o=t.map(l=>{if(l.duration===1/0)return;let u=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(u<0){l.visible&&kr.dismiss(l.id);return}return setTimeout(()=>kr.dismiss(l.id),u)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[t,r]);let n=C.useCallback(()=>{r&&bs({type:6,time:Date.now()})},[r]),a=C.useCallback((i,o)=>{let{reverseOrder:l=!1,gutter:u=8,defaultPosition:f}=o||{},h=t.filter(x=>(x.position||f)===(i.position||f)&&x.height),m=h.findIndex(x=>x.id===i.id),g=h.filter((x,_)=>_<m&&x.visible).length;return h.filter(x=>x.visible).slice(...l?[g+1]:[0,g]).reduce((x,_)=>x+(_.height||0)+u,0)},[t]);return C.useEffect(()=>{t.forEach(i=>{if(i.dismissed)qO(i.id,i.removeDelay);else{let o=Pl.get(i.id);o&&(clearTimeout(o),Pl.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:GO,startPause:ZO,endPause:n,calculateOffset:a}}},KO=Ka`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,JO=Ka`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,QO=Ka`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,eM=Ii("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${KO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${JO} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${QO} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,tM=Ka`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,rM=Ii("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${tM} 1s linear infinite;
`,nM=Ka`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,aM=Ka`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,iM=Ii("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${nM} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${aM} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,sM=Ii("div")`
  position: absolute;
`,oM=Ii("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,lM=Ka`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,cM=Ii("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${lM} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,uM=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?C.createElement(cM,null,t):t:r==="blank"?null:C.createElement(oM,null,C.createElement(rM,{...n}),r!=="loading"&&C.createElement(sM,null,r==="error"?C.createElement(eM,{...n}):C.createElement(iM,{...n})))},fM=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,dM=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,hM="0%{opacity:0;} 100%{opacity:1;}",pM="0%{opacity:1;} 100%{opacity:0;}",mM=Ii("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,gM=Ii("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,xM=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=Kw()?[hM,pM]:[fM(r),dM(r)];return{animation:t?`${Ka(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ka(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},vM=C.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?xM(e.position||t||"top-center",e.visible):{opacity:0},i=C.createElement(uM,{toast:e}),o=C.createElement(gM,{...e.ariaProps},Cf(e.message,e));return C.createElement(mM,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:o}):C.createElement(C.Fragment,null,i,o))});BO(C.createElement);var _M=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=C.useCallback(o=>{if(o){let l=()=>{let u=o.getBoundingClientRect().height;n(e,u)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return C.createElement("div",{ref:i,className:t,style:r},a)},yM=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Kw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},wM=n0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,gu=16,kM=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:u}=YO(r);return C.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:gu,left:gu,right:gu,bottom:gu,pointerEvents:"none",...i},className:o,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(f=>{let h=f.position||t,m=u.calculateOffset(f,{reverseOrder:e,gutter:n,defaultPosition:t}),g=yM(h,m);return C.createElement(_M,{id:f.id,key:f.id,onHeightUpdate:u.updateHeight,className:f.visible?wM:"",style:g},f.type==="custom"?Cf(f.message,f):a?a(f):C.createElement(vM,{toast:f,position:h}))}))};const EM=()=>localStorage.getItem("token"),ro=Ue.create({baseURL:jt});ro.interceptors.request.use(e=>{const t=EM();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));ro.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function SM(){ka();const[e,t]=C.useState(""),[r,n]=C.useState("show"),[a,i]=C.useState(!1),[o,l]=C.useState(null),[u,f]=C.useState(null),[h,m]=C.useState([]);C.useState(!1);const[g,x]=C.useState([]),[_,y]=C.useState(""),[E,k]=C.useState(""),[S,w]=C.useState(null);C.useEffect(()=>{(async()=>{try{i(!0),l(null);const Z=await ro.get("/datacenters/hierarchy/");x(Z.data)}catch(Z){console.error("Error fetching hierarchy:",Z),l("Failed to fetch hierarchy data")}finally{i(!1)}})()},[]);const A=()=>{if(!_)return[];const B=g.find(Z=>Z.id===_);return B?B.firewall_types:[]},I=()=>{if(!E)return[];const B=g.find(K=>K.id===_);if(!B)return[];const Z=B.firewall_types.find(K=>K.id===E);return Z?Z.firewalls:[]},D=B=>{const Z=B.target.value;y(Z),k(""),w(null),m([])},P=B=>{const Z=B.target.value;k(Z),w(null),m([])},W=()=>{const B=I();h.length===B.length?m([]):m(B.map(Z=>Z.id))},j=B=>{m(Z=>Z.includes(B)?Z.filter(K=>K!==B):[...Z,B])},V=async()=>{if(!h.length&&!E){l("Please select firewalls or a firewall type");return}i(!0),l(null),f(null);try{const B=h.length>0?I().filter(K=>h.includes(K.id)):I(),Z=await ro.post("/command/commands/save_bulk_config/",{firewall_ids:B.map(K=>K.id),command:r});if(Z.data.status==="success"){f("Configuration save started. You can leave this page, the saves will continue in the background.");const K=Z.data.task_id,ve=setInterval(async()=>{try{const de=(await ro.get(`/command/commands/check_task_status/?task_id=${K}`)).data;if(f(`${de.message} (${de.progress}%)`),de.status==="completed"){if(clearInterval(ve),f("All configurations saved successfully"),de.results&&de.results.length>0){const J=de.results.filter(U=>U.status==="success"&&U.filepath),Q=de.results.filter(U=>U.status==="failed");for(const U of J)try{const te=await ro.get("/command/commands/download_config_file/",{responseType:"blob",params:{filepath:U.filepath}}),fe=new Blob([te.data],{type:"text/plain"}),F=window.URL.createObjectURL(fe),ee=document.createElement("a");ee.href=F,ee.setAttribute("download",`${U.firewall_name}_config.txt`),document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),window.URL.revokeObjectURL(F)}catch(te){console.error(`Error downloading config for ${U.firewall_name}:`,te),kr.error(`Failed to download configuration for ${U.firewall_name}`)}J.length>0&&f(`${J.length} configurations saved and downloaded successfully`),Q.length>0&&l(`Failed to save ${Q.length} configurations: ${Q.map(U=>U.firewall_name).join(", ")}`)}}else de.status==="failed"&&(clearInterval(ve),l(`Configuration save failed: ${de.message}`))}catch(_e){console.error("Error checking task status:",_e),clearInterval(ve),l("Failed to check task status")}},2e3);return()=>clearInterval(ve)}else l("Failed to start configuration save")}catch(B){console.error("Error during bulk save:",B),l("Failed to save configurations")}finally{i(!1)}};return a?d.jsx("div",{className:"p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),d.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):o?d.jsx("div",{className:"p-8",children:d.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[d.jsx("strong",{className:"font-bold",children:"Error!"}),d.jsxs("span",{className:"block sm:inline",children:[" ",o]})]})}):d.jsxs("div",{className:"p-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall Configuration"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Manage firewall configurations"}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(mc,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),d.jsxs("select",{value:_,onChange:D,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"",children:"All data centers"}),g.map(B=>d.jsx("option",{value:B.id,children:B.name},B.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(ps,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),d.jsxs("select",{value:E,onChange:P,disabled:!_,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${_?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall type"}),A().map(B=>d.jsx("option",{value:B.id,children:B.name},B.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(gc,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),d.jsxs("div",{className:"mt-1 space-y-2",children:[d.jsx("button",{onClick:W,disabled:!E,className:`w-full px-3 py-1 text-sm rounded-md ${h.length===I().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${E?"":"opacity-50 cursor-not-allowed"}`,children:h.length===I().length?"Deselect All":"Select All"}),d.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:I().map(B=>d.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${h.includes(B.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>j(B.id),children:[d.jsx("input",{type:"checkbox",checked:h.includes(B.id),onChange:()=>j(B.id),className:"mr-2"}),d.jsxs("span",{className:"text-sm",children:[B.name," - ",B.ip_address]})]},B.id))})]})]})]})]})}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP Address"}),d.jsx("input",{type:"text",value:e,onChange:B=>t(B.target.value),placeholder:"e.g., 192.168.1.1",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Command"}),d.jsx("input",{type:"text",value:r,onChange:B=>n(B.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),o&&d.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md",children:o}),u&&d.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md",children:u}),d.jsx("div",{className:"flex space-x-4",children:d.jsxs("button",{onClick:V,disabled:a||!h.length&&!E,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[d.jsx(Zp,{className:"h-5 w-5 mr-2"}),a?"Saving...":"Save Configuration"]})})]})})]})}const Qx=["Hostname","IP Adresse","VDOM","Name","SourceAddress","SourceDescription","SourceInterface","DestinationAddress","DestinationDescription","DestinationInterface","service"];function TM(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[a,i]=C.useState([]),[o,l]=C.useState({name:"",description:"",location:"",latitude:"",longitude:""}),[u,f]=C.useState({name:"",description:""}),[h,m]=C.useState([]),[g,x]=C.useState({}),[_,y]=C.useState(!1),[E,k]=C.useState(null),[S,w]=C.useState({}),[A,I]=C.useState(""),[D,P]=C.useState(""),[W,j]=C.useState(!1),[V,B]=C.useState(null),[Z,K]=C.useState(null),[ve,_e]=C.useState(null);C.useState(1);const[de,J]=C.useState(null),[Q,U]=C.useState(!1),[te,fe]=C.useState(null),[F,ee]=C.useState(!1),[q,X]=C.useState({name:"",ip_address:"",firewall_type:""}),[ae,ke]=C.useState(!1),[Le,Ne]=C.useState(""),we=()=>{const ue=localStorage.getItem("token");if(!ue)throw new Error("No authentication token found");return ue},Be=Ue.create({baseURL:jt,headers:{"Content-Type":"application/json"}});Be.interceptors.request.use(ue=>{var xe;try{const Ce=we();return Ce&&(ue.headers.Authorization=`Bearer ${Ce}`),(xe=ue.url)!=null&&xe.startsWith("/api/")&&(ue.url=ue.url.replace("/api/","/")),ue}catch(Ce){console.error("Authentication error:",Ce),uf("/login")}return ue},ue=>Promise.reject(ue)),Be.interceptors.response.use(ue=>ue,ue=>(ue.response&&ue.response.status===401&&(localStorage.removeItem("token"),uf("/login")),Promise.reject(ue)));const G=async()=>{var ue,xe,Ce;try{y(!0);const[Fe,Ve,Et]=await Promise.all([Be.get("/firewalls/firewall-types/"),Be.get("/datacenters/"),Be.get("/firewalls/")]),it=Array.isArray((ue=Fe.data)==null?void 0:ue.results)?Fe.data.results:[],Xe=Array.isArray((xe=Ve.data)==null?void 0:xe.results)?Ve.data.results:[],Ye=Array.isArray((Ce=Et.data)==null?void 0:Ce.results)?Et.data.results:[],lt=Xe.map(at=>({id:at.id,name:at.name,description:at.description||"",location:at.location||"",latitude:at.latitude?parseFloat(at.latitude):null,longitude:at.longitude?parseFloat(at.longitude):null,owner:at.owner||"",owner_username:at.owner_username||"",created_at:at.created_at,updated_at:at.updated_at,is_active:at.is_active,firewall_count:at.firewall_count||0,firewall_type_count:at.firewall_type_count||0,firewalls:Ye.filter(re=>{var ye;return((ye=re.data_center)==null?void 0:ye.id)===at.id}),firewall_types:it.filter(re=>re.data_center===at.id)}));t(lt);const ut=localStorage.getItem("selectedFirewallId"),sr=localStorage.getItem("firewallType"),Tt=localStorage.getItem("dataCenter");if(ut){const at=Ye.find(re=>re.id===ut);at&&(k(at),w(re=>({...re,ipAddress:at.ip_address})))}sr&&I(sr),Tt&&P(Tt)}catch{alert("Erreur lors du chargement des donnes. Veuillez rafrachir la page.")}finally{y(!1)}};C.useEffect(()=>{G()},[]);const Ge=async()=>{await G()},Je=ue=>{n(xe=>xe.includes(ue)?xe.filter(Ce=>Ce!==ue):[...xe,ue])},me=ue=>{i(xe=>xe.includes(ue)?xe.filter(Ce=>Ce!==ue):[...xe,ue])},Se=async()=>{var ue,xe,Ce,Fe,Ve,Et,it,Xe,Ye,lt;if(o.name)try{let ut=null,sr=null;if(o.latitude){const re=parseFloat(o.latitude);if(!isNaN(re)&&re>=-90&&re<=90)ut=Number(re.toFixed(6));else{alert("La latitude doit tre comprise entre -90 et 90 degrs");return}}if(o.longitude){const re=parseFloat(o.longitude);if(!isNaN(re)&&re>=-180&&re<=180)sr=Number(re.toFixed(6));else{alert("La longitude doit tre comprise entre -180 et 180 degrs");return}}const Tt={name:o.name.trim(),description:o.description.trim()||null,location:o.location.trim()||null,latitude:ut,longitude:sr,is_active:!0};if(Tt.latitude!==null&&Tt.longitude===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(Tt.latitude===null&&Tt.longitude!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}console.log("Sending data to API:",Tt);const at=await Be.post("/datacenters/",Tt);console.log("API Response:",at.data),l({name:"",description:"",location:"",latitude:"",longitude:""}),await Ge()}catch(ut){if(console.error("Error creating data center:",ut),console.error("Error response:",(ue=ut.response)==null?void 0:ue.data),(Ce=(xe=ut.response)==null?void 0:xe.data)!=null&&Ce.longitude)alert(`Erreur de longitude: ${ut.response.data.longitude[0]}`);else if((Ve=(Fe=ut.response)==null?void 0:Fe.data)!=null&&Ve.latitude)alert(`Erreur de latitude: ${ut.response.data.latitude[0]}`);else{const sr=((it=(Et=ut.response)==null?void 0:Et.data)==null?void 0:it.detail)||((lt=(Ye=(Xe=ut.response)==null?void 0:Xe.data)==null?void 0:Ye.non_field_errors)==null?void 0:lt[0])||"Erreur lors de la cration du datacenter. Veuillez ressayer.";alert(sr)}}else alert("Le nom du datacenter est requis")},he=async ue=>{var Fe,Ve,Et,it,Xe,Ye;const{name:xe,description:Ce}=u;if(xe)try{const lt=Object.entries(g).filter(([Tt,at])=>at).map(([Tt])=>Tt),ut={name:xe,description:Ce||"",data_center:ue,attributes_schema:{type:"object",properties:lt.reduce((Tt,at)=>{const re=h.find(ye=>ye.name===at);return re&&(Tt[at]={type:"string",title:re.label,required:re.required}),Tt},{}),required:lt.filter(Tt=>{const at=h.find(re=>re.name===Tt);return at==null?void 0:at.required})}};console.log("Creating firewall type with data:",ut);const sr=await Be.post("/firewalls/firewall-types/",ut,{headers:{"Content-Type":"application/json",Accept:"application/json"}});console.log("Firewall type created successfully:",sr.data),f({name:"",description:""}),x(h.reduce((Tt,at)=>({...Tt,[at.name]:!1}),{})),await Ge()}catch(lt){console.error("Error creating firewall type:",lt),console.error("Error response:",(Fe=lt.response)==null?void 0:Fe.data);const ut=((Et=(Ve=lt.response)==null?void 0:Ve.data)==null?void 0:Et.detail)||((Ye=(Xe=(it=lt.response)==null?void 0:it.data)==null?void 0:Xe.owner)==null?void 0:Ye[0])||"Erreur lors de la cration du type de pare-feu.";alert(ut)}},Me=async ue=>{var xe,Ce;try{await Be.delete(`/datacenters/${ue}/`),await Ge()}catch(Fe){console.error("Error deleting data center:",Fe);const Ve=((Ce=(xe=Fe.response)==null?void 0:xe.data)==null?void 0:Ce.detail)||"Erreur lors de la suppression du datacenter.";alert(Ve)}},He=async ue=>{var xe,Ce;if(window.confirm("tes-vous sr de vouloir supprimer ce type de pare-feu ?"))try{await Be.delete(`/firewalls/firewall-types/${ue}/`),await Ge()}catch(Fe){console.error("Error deleting firewall type:",Fe);const Ve=((Ce=(xe=Fe.response)==null?void 0:xe.data)==null?void 0:Ce.detail)||"Erreur lors de la suppression du type de pare-feu.";alert(Ve)}},nt=C.useCallback(ue=>{ue.preventDefault(),j(!0)},[]),kt=C.useCallback(ue=>{ue.preventDefault(),j(!1)},[]),Bt=C.useCallback(async(ue,xe)=>{var Ve,Et;ue.preventDefault(),j(!1),K(null),B(0);const Fe=Array.from(ue.dataTransfer.files).filter(it=>it.type==="text/csv"||it.name.endsWith(".csv"));if(Fe.length===0){K("Veuillez dposer uniquement des fichiers CSV");return}for(const it of Fe)try{const Xe=new FormData;Xe.append("file",it),Xe.append("firewall_type",xe);const Ye=await Be.post("/api/firewalls/upload-csv/",Xe,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:lt=>{const ut=lt.total?Math.round(lt.loaded*100/lt.total):0;B(ut)}});if(Ye.data.success)_e(`Fichier tlcharg avec succs. ${Ye.data.created_count} pare-feu(s) cr(s).`),K(null),await Ge();else{const lt=Ye.data.error||"Erreur lors du tlchargement",ut=Ye.data.errors||[];K(`${lt}
${ut.join(`
`)}`)}}catch(Xe){console.error("Error uploading CSV:",Xe);const Ye=((Et=(Ve=Xe.response)==null?void 0:Ve.data)==null?void 0:Et.error)||"Erreur lors du tlchargement du fichier";K(Ye)}},[Ge]),pt=ue=>{J(ue),U(!0)},_t=async()=>{var ue,xe,Ce,Fe,Ve,Et,it;if(de)try{let Xe=de.latitude,Ye=de.longitude;if(Xe!==null&&(Xe<-90||Xe>90)){alert("La latitude doit tre comprise entre -90 et 90 degrs");return}if(Ye!==null&&(Ye<-180||Ye>180)){alert("La longitude doit tre comprise entre -180 et 180 degrs");return}if(Xe!==null&&Ye===null){alert("Si la latitude est fournie, la longitude doit galement tre fournie");return}if(Xe===null&&Ye!==null){alert("Si la longitude est fournie, la latitude doit galement tre fournie");return}const lt={name:de.name.trim(),description:((ue=de.description)==null?void 0:ue.trim())||null,location:((xe=de.location)==null?void 0:xe.trim())||null,latitude:Xe,longitude:Ye,is_active:de.is_active};await Be.put(`/datacenters/${de.id}/`,lt),U(!1),J(null),await Ge()}catch(Xe){console.error("Error updating data center:",Xe);const Ye=((Fe=(Ce=Xe.response)==null?void 0:Ce.data)==null?void 0:Fe.detail)||((it=(Et=(Ve=Xe.response)==null?void 0:Ve.data)==null?void 0:Et.non_field_errors)==null?void 0:it[0])||"Erreur lors de la mise  jour du datacenter.";alert(Ye)}},Nt=ue=>{fe(ue),ee(!0)},dr=async()=>{var ue,xe,Ce,Fe,Ve,Et;if(te)try{const it=Object.entries(g).filter(([Ye,lt])=>lt).map(([Ye])=>Ye),Xe={name:te.name.trim(),description:((ue=te.description)==null?void 0:ue.trim())||"",data_center:te.data_center,attributes_schema:{type:"object",properties:it.reduce((Ye,lt)=>{const ut=h.find(sr=>sr.name===lt);return ut&&(Ye[lt]={type:"string",title:ut.label,required:ut.required}),Ye},{}),required:it.filter(Ye=>{const lt=h.find(ut=>ut.name===Ye);return lt==null?void 0:lt.required})}};await Be.put(`/firewalls/firewall-types/${te.id}/`,Xe),ee(!1),fe(null),await Ge()}catch(it){console.error("Error updating firewall type:",it);const Xe=((Ce=(xe=it.response)==null?void 0:xe.data)==null?void 0:Ce.detail)||((Et=(Ve=(Fe=it.response)==null?void 0:Fe.data)==null?void 0:Ve.non_field_errors)==null?void 0:Et[0])||"Erreur lors de la mise  jour du type de pare-feu.";alert(Xe)}},Nr=async ue=>{var xe,Ce;if(!q.name||!q.ip_address){alert("Le nom et l'adresse IP sont requis");return}try{const Fe=e.flatMap(Ye=>Ye.firewall_types).find(Ye=>Ye.id===ue);if(!Fe)throw new Error("Type de firewall non trouv");let Ve;const Et=localStorage.getItem("userData");if(Et?Ve=JSON.parse(Et).id:Ve=(await Be.get("/auth/users/me/")).data.id,!Ve)throw new Error("Impossible de rcuprer l'ID de l'utilisateur");const it={name:q.name.trim(),ip_address:q.ip_address.trim(),firewall_type:ue,data_center:Fe.data_center,owner:Ve};console.log("Sending data to API:",it);const Xe=await Be.post("/firewalls/firewalls/",it);console.log("API Response:",Xe.data),X({name:"",ip_address:"",firewall_type:""}),ke(!1),await Ge()}catch(Fe){console.error("Error creating firewall:",Fe),console.error("Error response:",(xe=Fe.response)==null?void 0:xe.data);let Ve="Erreur lors de la cration du pare-feu.";(Ce=Fe.response)!=null&&Ce.data&&(typeof Fe.response.data=="object"?Ve=`Erreurs de validation:
${Object.entries(Fe.response.data).map(([it,Xe])=>`${it}: ${Array.isArray(Xe)?Xe.join(", "):Xe}`).join(`
`)}`:typeof Fe.response.data=="string"?Ve=Fe.response.data:Fe.response.data.detail&&(Ve=Fe.response.data.detail)),alert(Ve)}},$t=async ue=>{var xe,Ce;if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await Be.delete(`/firewalls/${ue}/`),await Ge()}catch(Fe){console.error("Error deleting firewall:",Fe);const Ve=((Ce=(xe=Fe.response)==null?void 0:xe.data)==null?void 0:Ce.detail)||"Erreur lors de la suppression du pare-feu.";alert(Ve)}},Ar=()=>d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Liste des Datacenters et Types de Firewall"}),d.jsx("div",{className:"space-y-4",children:e.map(ue=>{var xe;return d.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[d.jsxs("div",{className:"bg-gray-50 p-4 flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:ue.name}),d.jsx("p",{className:"text-sm text-gray-500",children:ue.location})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:()=>pt(ue),className:"px-3 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-2",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),d.jsxs("button",{onClick:()=>Me(ue.id),className:"px-3 py-1.5 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-2",children:[d.jsx(Ln,{className:"h-4 w-4"}),"Supprimer"]})]})]}),d.jsxs("div",{className:"p-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Types de Firewall"}),d.jsx("div",{className:"space-y-3",children:(xe=ue.firewall_types)==null?void 0:xe.map(Ce=>{var Fe;return d.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:Ce.name}),d.jsx("p",{className:"text-sm text-gray-500",children:Ce.description}),d.jsxs("div",{className:"mt-2",children:[d.jsx("p",{className:"text-xs text-gray-500",children:"Attributs configurs:"}),d.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:((Fe=Ce.attributes_schema)==null?void 0:Fe.properties)&&Object.entries(Ce.attributes_schema.properties).sort(([Ve],[Et])=>{const it=Qx.indexOf(Ve),Xe=Qx.indexOf(Et);return it===-1?1:Xe===-1?-1:it-Xe}).map(([Ve,Et])=>d.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:Ve},Ve))})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:()=>{Ne(Ce.id),ke(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[d.jsx(Qi,{className:"h-3 w-3"}),"Ajouter Firewall"]}),d.jsxs("button",{onClick:()=>Nt(Ce),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),d.jsxs("button",{onClick:()=>He(Ce.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[d.jsx(Ln,{className:"h-3 w-3"}),"Supprimer"]})]})]})},Ce.id)})})]})]},ue.id)})})]}),Ze=(ue,xe)=>{var Ce;return d.jsxs("div",{className:"ml-6 mb-4",children:[d.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-md",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{onClick:()=>me(xe.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:a.includes(xe.id)?d.jsx(ff,{size:20}):d.jsx(_h,{size:20})}),d.jsx("span",{className:"font-medium",children:xe.name})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:()=>{Ne(xe.id),ke(!0)},className:"px-2 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center gap-1",children:[d.jsx(Qi,{className:"h-3 w-3"}),"Ajouter Firewall"]}),d.jsxs("button",{onClick:()=>Nt(xe),className:"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]}),d.jsxs("button",{onClick:()=>He(xe.id),className:"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center gap-1",children:[d.jsx(Ln,{className:"h-3 w-3"}),"Supprimer"]})]})]}),a.includes(xe.id)&&d.jsxs("div",{className:"mt-2 p-4 bg-white rounded-md shadow",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pare-feu existants"}),d.jsx("div",{className:"space-y-2",children:(Ce=xe.firewalls)==null?void 0:Ce.map(Fe=>d.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:Fe.name}),d.jsx("p",{className:"text-sm text-gray-500",children:Fe.ip_address})]}),d.jsx("button",{onClick:()=>$t(Fe.id),className:"text-red-500 hover:text-red-700",children:d.jsx(Ln,{className:"h-4 w-4"})})]},Fe.id))})]}),d.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center ${W?"border-purple-500 bg-purple-50":"border-gray-300"}`,onDragOver:nt,onDragLeave:kt,onDrop:Fe=>Bt(Fe,xe.id),children:[d.jsx(p2,{className:"mx-auto h-12 w-12 text-gray-400"}),d.jsxs("div",{className:"mt-4",children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Glissez et dposez vos fichiers CSV ici"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ou cliquez pour slectionner des fichiers"})]}),V!==null&&d.jsxs("div",{className:"mt-4",children:[d.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:d.jsx("div",{className:"bg-purple-600 h-2.5 rounded-full",style:{width:`${V}%`}})}),d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Progression: ",V,"%"]})]}),Z&&d.jsx("p",{className:"text-red-500 text-sm mt-2",children:Z})]})]})]},xe.id)};return C.useEffect(()=>{(async()=>{try{const Ce=(await Us.getVariables()).map(Fe=>({name:Fe.name,label:Fe.name,required:!1}));m(Ce),x(Ce.reduce((Fe,Ve)=>({...Fe,[Ve.name]:!1}),{}))}catch(xe){console.error("Error loading variables:",xe)}})()},[]),d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Paramtres CMS"}),d.jsx("p",{className:"text-gray-600",children:"Grez la structure des data centers et leurs types de firewalls"})]}),d.jsxs("button",{onClick:Ge,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[d.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Rafrachir"]})]}),_?d.jsx("div",{className:"flex justify-center items-center h-64",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):d.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[Ar(),d.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:d.jsx("div",{className:"space-y-6",children:d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-purple-900 mb-4",children:"Structure"}),d.jsx("div",{className:"mb-6 p-4 border border-dashed border-gray-300 rounded-lg",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"Nom du Data Center *",value:o.name,onChange:ue=>l(xe=>({...xe,name:ue.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm",required:!0}),d.jsx("button",{onClick:Se,className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:d.jsx(Qi,{className:"w-4 h-4"})})]}),d.jsx("textarea",{placeholder:"Description",value:o.description,onChange:ue=>l(xe=>({...xe,description:ue.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),d.jsx("input",{type:"text",placeholder:"Adresse physique",value:o.location,onChange:ue=>l(xe=>({...xe,location:ue.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("div",{children:[d.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude (-90  90)",value:o.latitude,onChange:ue=>{const xe=ue.target.value;(xe===""||parseFloat(xe)>=-90&&parseFloat(xe)<=90)&&l(Ce=>({...Ce,latitude:xe}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: 33.552084"})]}),d.jsxs("div",{children:[d.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude (-180  180)",value:o.longitude,onChange:ue=>{const xe=ue.target.value;(xe===""||parseFloat(xe)>=-180&&parseFloat(xe)<=180)&&l(Ce=>({...Ce,longitude:xe}))},className:"w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ex: -7.657616"})]})]})]})}),d.jsx("div",{className:"space-y-2",children:Array.isArray(e)&&e.map(ue=>{var xe;return d.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-t-lg",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{onClick:()=>Je(ue.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:r.includes(ue.id)?d.jsx(ff,{className:"w-4 h-4"}):d.jsx(_h,{className:"w-4 h-4"})}),d.jsx("span",{className:"font-medium",children:ue.name})]}),d.jsx("button",{onClick:()=>Me(ue.id),className:"text-red-500 hover:text-red-700",children:d.jsx(Ln,{className:"w-4 h-4"})})]}),r.includes(ue.id)&&d.jsxs("div",{className:"p-4 space-y-4",children:[d.jsx("div",{className:"p-4 border border-dashed border-gray-300 rounded-lg",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"Nom du type de pare-feu",value:u.name,onChange:Ce=>f(Fe=>({...Fe,name:Ce.target.value})),className:"flex-1 p-2 border border-gray-300 rounded-md text-sm"}),d.jsx("button",{onClick:()=>he(ue.id),className:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:d.jsx(Qi,{className:"w-4 h-4"})})]}),d.jsx("textarea",{placeholder:"Description",value:u.description,onChange:Ce=>f(Fe=>({...Fe,description:Ce.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:h.map(Ce=>d.jsxs("label",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"checkbox",checked:g[Ce.name],onChange:Fe=>x(Ve=>({...Ve,[Ce.name]:Fe.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:Ce.label})]},Ce.name))})]})}),d.jsx("div",{className:"space-y-2",children:(xe=ue.firewall_types)==null?void 0:xe.map(Ce=>Ze(ue,Ce))})]})]},ue.id)})})]})})})]}),Q&&de&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Data Center"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),d.jsx("input",{type:"text",value:de.name,onChange:ue=>J(xe=>xe?{...xe,name:ue.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),d.jsx("textarea",{value:de.description||"",onChange:ue=>J(xe=>xe?{...xe,description:ue.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse physique"}),d.jsx("input",{type:"text",value:de.location||"",onChange:ue=>J(xe=>xe?{...xe,location:ue.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude (-90  90)"}),d.jsx("input",{type:"number",step:"0.000001",value:de.latitude||"",onChange:ue=>{const xe=ue.target.value===""?null:parseFloat(ue.target.value);(xe===null||xe>=-90&&xe<=90)&&J(Ce=>Ce?{...Ce,latitude:xe}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-90",max:"90"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude (-180  180)"}),d.jsx("input",{type:"number",step:"0.000001",value:de.longitude||"",onChange:ue=>{const xe=ue.target.value===""?null:parseFloat(ue.target.value);(xe===null||xe>=-180&&xe<=180)&&J(Ce=>Ce?{...Ce,longitude:xe}:null)},className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",min:"-180",max:"180"})]})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:de.is_active,onChange:ue=>J(xe=>xe?{...xe,is_active:ue.target.checked}:null),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),d.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Actif"})]})]}),d.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>{U(!1),J(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),d.jsx("button",{onClick:_t,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),F&&te&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Modifier le Type de Pare-feu"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),d.jsx("input",{type:"text",value:te.name,onChange:ue=>fe(xe=>xe?{...xe,name:ue.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),d.jsx("textarea",{value:te.description||"",onChange:ue=>fe(xe=>xe?{...xe,description:ue.target.value}:null),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",rows:3})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attributs de configuration"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:h.map(ue=>d.jsxs("label",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"checkbox",checked:g[ue.name],onChange:xe=>x(Ce=>({...Ce,[ue.name]:xe.target.checked})),className:"rounded text-purple-600 focus:ring-purple-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:ue.label})]},ue.name))})]})]}),d.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>{ee(!1),fe(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),d.jsx("button",{onClick:dr,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Enregistrer"})]})]})}),ae&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ajouter un Pare-feu"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom *"}),d.jsx("input",{type:"text",value:q.name,onChange:ue=>X(xe=>({...xe,name:ue.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse IP *"}),d.jsx("input",{type:"text",value:q.ip_address,onChange:ue=>X(xe=>({...xe,ip_address:ue.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md text-sm",required:!0,placeholder:"Ex: 192.168.1.1"})]})]}),d.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>{ke(!1),X({name:"",ip_address:"",firewall_type:""})},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Annuler"}),d.jsx("button",{onClick:()=>Nr(Le),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Ajouter"})]})]})})]})}const Xi=Ue.create({baseURL:jt});Xi.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Xi.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));const ev={getFirewalls:async()=>{try{return(await Xi.get("/firewalls/firewalls/")).data.results||[]}catch(e){throw e}},getFirewall:async e=>{try{return(await Xi.get(`/firewalls/firewalls/${e}/`)).data}catch(t){throw t}},createFirewall:async e=>{try{return(await Xi.post("/firewalls/firewalls/",e)).data}catch(t){throw t}},updateFirewall:async(e,t)=>{try{return(await Xi.put(`/firewalls/firewalls/${e}/`,t)).data}catch(r){throw r}},deleteFirewall:async e=>{try{await Xi.delete(`/firewalls/firewalls/${e}/`)}catch(t){throw t}}},tv=()=>{const[e,t]=C.useState([]),[r,n]=C.useState([]),[a,i]=C.useState(""),[o,l]=C.useState(!0),[u,f]=C.useState(null),[h,m]=C.useState(0);C.useEffect(()=>{(async()=>{try{l(!0);const y=await ev.getFirewalls(),E=Array.isArray(y)?y:y.results||[];t(E),n(E),f(null)}catch(y){f(`Erreur lors de la rcupration des pare-feux: ${y.message||"Erreur inconnue"}`)}finally{l(!1)}})()},[h]),C.useEffect(()=>{if(!a.trim()){n(e);return}const _=a.toLowerCase().trim(),y=e.filter(E=>E.name.toLowerCase().includes(_)||E.ip_address.toLowerCase().includes(_));n(y)},[a,e]);const g=()=>{m(_=>_+1)},x=async _=>{if(window.confirm("tes-vous sr de vouloir supprimer ce pare-feu ?"))try{await ev.deleteFirewall(_),t(e.filter(y=>y.id!==_))}catch{f("Erreur lors de la suppression du pare-feu")}};return o?d.jsx("div",{className:"flex items-center justify-center h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})}):d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Liste des Pare-feux"}),d.jsx("p",{className:"text-gray-600",children:"Grez vos pare-feux et leurs configurations"})]}),d.jsxs("button",{onClick:g,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center gap-2",children:[d.jsx(db,{className:"w-4 h-4"}),"Rafrachir"]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(hb,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-purple-500 focus:border-purple-500 sm:text-sm",placeholder:"Rechercher par nom ou adresse IP...",value:a,onChange:_=>i(_.target.value)})]}),a&&d.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:[r.length," pare-feu",r.length!==1?"x":""," trouv",r.length!==1?"s":""]})]}),u&&d.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-md",children:u}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(_=>{var y;return d.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200",children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(ps,{className:"h-8 w-8 text-purple-600 mr-3"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:_.name}),d.jsx("p",{className:"text-gray-500 text-sm",children:_.ip_address})]})]}),d.jsx("div",{className:"flex space-x-2",children:d.jsx("button",{onClick:()=>x(_.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors duration-200",children:d.jsx(Ln,{className:"h-5 w-5"})})})]}),d.jsxs("div",{className:"mt-4 space-y-3",children:[d.jsxs("div",{className:"flex items-center text-gray-600",children:[d.jsx(mc,{className:"h-5 w-5 mr-2"}),d.jsxs("span",{children:["Data Center: ",((y=_.data_center_info)==null?void 0:y.name)||"N/A"]})]}),d.jsxs("div",{className:"flex items-center text-gray-600",children:[d.jsx(gc,{className:"h-5 w-5 mr-2"}),d.jsxs("span",{children:["Type: ",typeof _.firewall_type=="object"&&_.firewall_type?_.firewall_type.name:"N/A"]})]})]})]})},_.id)})}),r.length===0&&!o&&d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ps,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Aucun rsultat trouv":"Aucun pare-feu trouv"}),d.jsx("p",{className:"text-gray-500 mt-2",children:a?"Essayez de modifier votre recherche":"Commencez par ajouter un nouveau pare-feu."})]})]})};function Em(e,t){const r=C.useRef(t);C.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function CM(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const Qw=1;function ek(e){return Object.freeze({__version:Qw,map:e})}function Sm(e,t){return Object.freeze({...e,...t})}const Tm=C.createContext(null),Cm=Tm.Provider;function Sc(){const e=C.useContext(Tm);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function bm(e){function t(r,n){const{instance:a,context:i}=e(r).current;return C.useImperativeHandle(n,()=>a),r.children==null?null:os.createElement(Cm,{value:i},r.children)}return C.forwardRef(t)}function tk(e){function t(r,n){const[a,i]=C.useState(!1),{instance:o}=e(r,i).current;C.useImperativeHandle(n,()=>o),C.useEffect(function(){a&&o.update()},[o,a,r.children]);const l=o._contentNode;return l?Ty.createPortal(r.children,l):null}return C.forwardRef(t)}function Nm(e){function t(r,n){const{instance:a}=e(r).current;return C.useImperativeHandle(n,()=>a),null}return C.forwardRef(t)}function rk(e){return function(r){const n=Sc(),a=e(r,n),{instance:i}=a.current,o=C.useRef(r.position),{position:l}=r;return C.useEffect(function(){return i.addTo(n.map),function(){i.remove()}},[n.map,i]),C.useEffect(function(){l!=null&&l!==o.current&&(i.setPosition(l),o.current=l)},[i,l]),a}}function a0(e,t){const r=C.useRef();C.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function Tc(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function nk(e,t){return function(n,a){const i=Sc(),o=e(Tc(n,i),i);return Em(i.map,n.attribution),a0(o.current,n.eventHandlers),t(o.current,i,n,a),o}}var jh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(bi,function(r){var n="1.9.4";function a(s){var c,p,v,T;for(p=1,v=arguments.length;p<v;p++){T=arguments[p];for(c in T)s[c]=T[c]}return s}var i=Object.create||function(){function s(){}return function(c){return s.prototype=c,new s}}();function o(s,c){var p=Array.prototype.slice;if(s.bind)return s.bind.apply(s,p.call(arguments,1));var v=p.call(arguments,2);return function(){return s.apply(c,v.length?v.concat(p.call(arguments)):arguments)}}var l=0;function u(s){return"_leaflet_id"in s||(s._leaflet_id=++l),s._leaflet_id}function f(s,c,p){var v,T,N,Y;return Y=function(){v=!1,T&&(N.apply(p,T),T=!1)},N=function(){v?T=arguments:(s.apply(p,arguments),setTimeout(Y,c),v=!0)},N}function h(s,c,p){var v=c[1],T=c[0],N=v-T;return s===v&&p?s:((s-T)%N+N)%N+T}function m(){return!1}function g(s,c){if(c===!1)return s;var p=Math.pow(10,c===void 0?6:c);return Math.round(s*p)/p}function x(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function _(s){return x(s).split(/\s+/)}function y(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?i(s.options):{});for(var p in c)s.options[p]=c[p];return s.options}function E(s,c,p){var v=[];for(var T in s)v.push(encodeURIComponent(p?T.toUpperCase():T)+"="+encodeURIComponent(s[T]));return(!c||c.indexOf("?")===-1?"?":"&")+v.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function S(s,c){return s.replace(k,function(p,v){var T=c[v];if(T===void 0)throw new Error("No value provided for variable "+p);return typeof T=="function"&&(T=T(c)),T})}var w=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function A(s,c){for(var p=0;p<s.length;p++)if(s[p]===c)return p;return-1}var I="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function D(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var P=0;function W(s){var c=+new Date,p=Math.max(0,16-(c-P));return P=c+p,window.setTimeout(s,p)}var j=window.requestAnimationFrame||D("RequestAnimationFrame")||W,V=window.cancelAnimationFrame||D("CancelAnimationFrame")||D("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function B(s,c,p){if(p&&j===W)s.call(c);else return j.call(window,o(s,c))}function Z(s){s&&V.call(window,s)}var K={__proto__:null,extend:a,create:i,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:h,falseFn:m,formatNum:g,trim:x,splitWords:_,setOptions:y,getParamString:E,template:S,isArray:w,indexOf:A,emptyImageUrl:I,requestFn:j,cancelFn:V,requestAnimFrame:B,cancelAnimFrame:Z};function ve(){}ve.extend=function(s){var c=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=c.__super__=this.prototype,v=i(p);v.constructor=c,c.prototype=v;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return s.statics&&a(c,s.statics),s.includes&&(_e(s.includes),a.apply(null,[v].concat(s.includes))),a(v,s),delete v.statics,delete v.includes,v.options&&(v.options=p.options?i(p.options):{},a(v.options,s.options)),v._initHooks=[],v.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var N=0,Y=v._initHooks.length;N<Y;N++)v._initHooks[N].call(this)}},c},ve.include=function(s){var c=this.prototype.options;return a(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},ve.mergeOptions=function(s){return a(this.prototype.options,s),this},ve.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),p=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function _e(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=w(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(s,c,p){if(typeof s=="object")for(var v in s)this._on(v,s[v],c);else{s=_(s);for(var T=0,N=s.length;T<N;T++)this._on(s[T],c,p)}return this},off:function(s,c,p){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var v in s)this._off(v,s[v],c);else{s=_(s);for(var T=arguments.length===1,N=0,Y=s.length;N<Y;N++)T?this._off(s[N]):this._off(s[N],c,p)}return this},_on:function(s,c,p,v){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,p)===!1){p===this&&(p=void 0);var T={fn:c,ctx:p};v&&(T.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(T)}},_off:function(s,c,p){var v,T,N;if(this._events&&(v=this._events[s],!!v)){if(arguments.length===1){if(this._firingCount)for(T=0,N=v.length;T<N;T++)v[T].fn=m;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var Y=this._listens(s,c,p);if(Y!==!1){var ie=v[Y];this._firingCount&&(ie.fn=m,this._events[s]=v=v.slice()),v.splice(Y,1)}}},fire:function(s,c,p){if(!this.listens(s,p))return this;var v=a({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[s];if(T){this._firingCount=this._firingCount+1||1;for(var N=0,Y=T.length;N<Y;N++){var ie=T[N],ce=ie.fn;ie.once&&this.off(s,ce,ie.ctx),ce.call(ie.ctx||this,v)}this._firingCount--}}return p&&this._propagateEvent(v),this},listens:function(s,c,p,v){typeof s!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(v=!!c,T=void 0,p=void 0);var N=this._events&&this._events[s];if(N&&N.length&&this._listens(s,T,p)!==!1)return!0;if(v){for(var Y in this._eventParents)if(this._eventParents[Y].listens(s,c,p,v))return!0}return!1},_listens:function(s,c,p){if(!this._events)return!1;var v=this._events[s]||[];if(!c)return!!v.length;p===this&&(p=void 0);for(var T=0,N=v.length;T<N;T++)if(v[T].fn===c&&v[T].ctx===p)return T;return!1},once:function(s,c,p){if(typeof s=="object")for(var v in s)this._on(v,s[v],c,!0);else{s=_(s);for(var T=0,N=s.length;T<N;T++)this._on(s[T],c,p,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[u(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[u(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,a({layer:s.target,propagatedFrom:s.target},s),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var J=ve.extend(de);function Q(s,c,p){this.x=p?Math.round(s):s,this.y=p?Math.round(c):c}var U=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};Q.prototype={clone:function(){return new Q(this.x,this.y)},add:function(s){return this.clone()._add(te(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(te(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new Q(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new Q(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=U(this.x),this.y=U(this.y),this},distanceTo:function(s){s=te(s);var c=s.x-this.x,p=s.y-this.y;return Math.sqrt(c*c+p*p)},equals:function(s){return s=te(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=te(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function te(s,c,p){return s instanceof Q?s:w(s)?new Q(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new Q(s.x,s.y):new Q(s,c,p)}function fe(s,c){if(s)for(var p=c?[s,c]:s,v=0,T=p.length;v<T;v++)this.extend(p[v])}fe.prototype={extend:function(s){var c,p;if(!s)return this;if(s instanceof Q||typeof s[0]=="number"||"x"in s)c=p=te(s);else if(s=F(s),c=s.min,p=s.max,!c||!p)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=p.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(s){return te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return te(this.min.x,this.max.y)},getTopRight:function(){return te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,p;return typeof s[0]=="number"||s instanceof Q?s=te(s):s=F(s),s instanceof fe?(c=s.min,p=s.max):c=p=s,c.x>=this.min.x&&p.x<=this.max.x&&c.y>=this.min.y&&p.y<=this.max.y},intersects:function(s){s=F(s);var c=this.min,p=this.max,v=s.min,T=s.max,N=T.x>=c.x&&v.x<=p.x,Y=T.y>=c.y&&v.y<=p.y;return N&&Y},overlaps:function(s){s=F(s);var c=this.min,p=this.max,v=s.min,T=s.max,N=T.x>c.x&&v.x<p.x,Y=T.y>c.y&&v.y<p.y;return N&&Y},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,p=this.max,v=Math.abs(c.x-p.x)*s,T=Math.abs(c.y-p.y)*s;return F(te(c.x-v,c.y-T),te(p.x+v,p.y+T))},equals:function(s){return s?(s=F(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function F(s,c){return!s||s instanceof fe?s:new fe(s,c)}function ee(s,c){if(s)for(var p=c?[s,c]:s,v=0,T=p.length;v<T;v++)this.extend(p[v])}ee.prototype={extend:function(s){var c=this._southWest,p=this._northEast,v,T;if(s instanceof X)v=s,T=s;else if(s instanceof ee){if(v=s._southWest,T=s._northEast,!v||!T)return this}else return s?this.extend(ae(s)||q(s)):this;return!c&&!p?(this._southWest=new X(v.lat,v.lng),this._northEast=new X(T.lat,T.lng)):(c.lat=Math.min(v.lat,c.lat),c.lng=Math.min(v.lng,c.lng),p.lat=Math.max(T.lat,p.lat),p.lng=Math.max(T.lng,p.lng)),this},pad:function(s){var c=this._southWest,p=this._northEast,v=Math.abs(c.lat-p.lat)*s,T=Math.abs(c.lng-p.lng)*s;return new ee(new X(c.lat-v,c.lng-T),new X(p.lat+v,p.lng+T))},getCenter:function(){return new X((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new X(this.getNorth(),this.getWest())},getSouthEast:function(){return new X(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof X||"lat"in s?s=ae(s):s=q(s);var c=this._southWest,p=this._northEast,v,T;return s instanceof ee?(v=s.getSouthWest(),T=s.getNorthEast()):v=T=s,v.lat>=c.lat&&T.lat<=p.lat&&v.lng>=c.lng&&T.lng<=p.lng},intersects:function(s){s=q(s);var c=this._southWest,p=this._northEast,v=s.getSouthWest(),T=s.getNorthEast(),N=T.lat>=c.lat&&v.lat<=p.lat,Y=T.lng>=c.lng&&v.lng<=p.lng;return N&&Y},overlaps:function(s){s=q(s);var c=this._southWest,p=this._northEast,v=s.getSouthWest(),T=s.getNorthEast(),N=T.lat>c.lat&&v.lat<p.lat,Y=T.lng>c.lng&&v.lng<p.lng;return N&&Y},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=q(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function q(s,c){return s instanceof ee?s:new ee(s,c)}function X(s,c,p){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,p!==void 0&&(this.alt=+p)}X.prototype={equals:function(s,c){if(!s)return!1;s=ae(s);var p=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return p<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+g(this.lat,s)+", "+g(this.lng,s)+")"},distanceTo:function(s){return Le.distance(this,ae(s))},wrap:function(){return Le.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,p=c/Math.cos(Math.PI/180*this.lat);return q([this.lat-c,this.lng-p],[this.lat+c,this.lng+p])},clone:function(){return new X(this.lat,this.lng,this.alt)}};function ae(s,c,p){return s instanceof X?s:w(s)&&typeof s[0]!="object"?s.length===3?new X(s[0],s[1],s[2]):s.length===2?new X(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new X(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new X(s,c,p)}var ke={latLngToPoint:function(s,c){var p=this.projection.project(s),v=this.scale(c);return this.transformation._transform(p,v)},pointToLatLng:function(s,c){var p=this.scale(c),v=this.transformation.untransform(s,p);return this.projection.unproject(v)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,p=this.scale(s),v=this.transformation.transform(c.min,p),T=this.transformation.transform(c.max,p);return new fe(v,T)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?h(s.lng,this.wrapLng,!0):s.lng,p=this.wrapLat?h(s.lat,this.wrapLat,!0):s.lat,v=s.alt;return new X(p,c,v)},wrapLatLngBounds:function(s){var c=s.getCenter(),p=this.wrapLatLng(c),v=c.lat-p.lat,T=c.lng-p.lng;if(v===0&&T===0)return s;var N=s.getSouthWest(),Y=s.getNorthEast(),ie=new X(N.lat-v,N.lng-T),ce=new X(Y.lat-v,Y.lng-T);return new ee(ie,ce)}},Le=a({},ke,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var p=Math.PI/180,v=s.lat*p,T=c.lat*p,N=Math.sin((c.lat-s.lat)*p/2),Y=Math.sin((c.lng-s.lng)*p/2),ie=N*N+Math.cos(v)*Math.cos(T)*Y*Y,ce=2*Math.atan2(Math.sqrt(ie),Math.sqrt(1-ie));return this.R*ce}}),Ne=6378137,we={R:Ne,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,p=this.MAX_LATITUDE,v=Math.max(Math.min(p,s.lat),-p),T=Math.sin(v*c);return new Q(this.R*s.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(s){var c=180/Math.PI;return new X((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:function(){var s=Ne*Math.PI;return new fe([-s,-s],[s,s])}()};function Be(s,c,p,v){if(w(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=p,this._d=v}Be.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new Q((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function G(s,c,p,v){return new Be(s,c,p,v)}var Ge=a({},Le,{code:"EPSG:3857",projection:we,transformation:function(){var s=.5/(Math.PI*we.R);return G(s,.5,-s,.5)}()}),Je=a({},Ge,{code:"EPSG:900913"});function me(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Se(s,c){var p="",v,T,N,Y,ie,ce;for(v=0,N=s.length;v<N;v++){for(ie=s[v],T=0,Y=ie.length;T<Y;T++)ce=ie[T],p+=(T?"L":"M")+ce.x+" "+ce.y;p+=c?Ie.svg?"z":"x":""}return p||"M0 0"}var he=document.documentElement.style,Me="ActiveXObject"in window,He=Me&&!document.addEventListener,nt="msLaunchUri"in navigator&&!("documentMode"in document),kt=Lr("webkit"),Bt=Lr("android"),pt=Lr("android 2")||Lr("android 3"),_t=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Nt=Bt&&Lr("Google")&&_t<537&&!("AudioNode"in window),dr=!!window.opera,Nr=!nt&&Lr("chrome"),$t=Lr("gecko")&&!kt&&!dr&&!Me,Ar=!Nr&&Lr("safari"),Ze=Lr("phantom"),ue="OTransition"in he,xe=navigator.platform.indexOf("Win")===0,Ce=Me&&"transition"in he,Fe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!pt,Ve="MozPerspective"in he,Et=!window.L_DISABLE_3D&&(Ce||Fe||Ve)&&!ue&&!Ze,it=typeof orientation<"u"||Lr("mobile"),Xe=it&&kt,Ye=it&&Fe,lt=!window.PointerEvent&&window.MSPointerEvent,ut=!!(window.PointerEvent||lt),sr="ontouchstart"in window||!!window.TouchEvent,Tt=!window.L_NO_TOUCH&&(sr||ut),at=it&&dr,re=it&&$t,ye=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ze=function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return s}(),st=function(){return!!document.createElement("canvas").getContext}(),dt=!!(document.createElementNS&&me("svg").createSVGRect),St=!!dt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Gt=!dt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Qt=navigator.platform.indexOf("Mac")===0,aa=navigator.platform.indexOf("Linux")===0;function Lr(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Ie={ie:Me,ielt9:He,edge:nt,webkit:kt,android:Bt,android23:pt,androidStock:Nt,opera:dr,chrome:Nr,gecko:$t,safari:Ar,phantom:Ze,opera12:ue,win:xe,ie3d:Ce,webkit3d:Fe,gecko3d:Ve,any3d:Et,mobile:it,mobileWebkit:Xe,mobileWebkit3d:Ye,msPointer:lt,pointer:ut,touch:Tt,touchNative:sr,mobileOpera:at,mobileGecko:re,retina:ye,passiveEvents:ze,canvas:st,svg:dt,vml:Gt,inlineSvg:St,mac:Qt,linux:aa},b=Ie.msPointer?"MSPointerDown":"pointerdown",M=Ie.msPointer?"MSPointerMove":"pointermove",O=Ie.msPointer?"MSPointerUp":"pointerup",R=Ie.msPointer?"MSPointerCancel":"pointercancel",z={touchstart:b,touchmove:M,touchend:O,touchcancel:R},H={touchstart:Oe,touchmove:Ae,touchend:Ae,touchcancel:Ae},ne={},ge=!1;function se(s,c,p){return c==="touchstart"&&De(),H[c]?(p=H[c].bind(this,p),s.addEventListener(z[c],p,!1),p):(console.warn("wrong event specified:",c),m)}function oe(s,c,p){if(!z[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(z[c],p,!1)}function le(s){ne[s.pointerId]=s}function Te(s){ne[s.pointerId]&&(ne[s.pointerId]=s)}function Pe(s){delete ne[s.pointerId]}function De(){ge||(document.addEventListener(b,le,!0),document.addEventListener(M,Te,!0),document.addEventListener(O,Pe,!0),document.addEventListener(R,Pe,!0),ge=!0)}function Ae(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var p in ne)c.touches.push(ne[p]);c.changedTouches=[c],s(c)}}function Oe(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&_r(c),Ae(s,c)}function qe(s){var c={},p,v;for(v in s)p=s[v],c[v]=p&&p.bind?p.bind(s):p;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Ft=200;function Ot(s,c){s.addEventListener("dblclick",c);var p=0,v;function T(N){if(N.detail!==1){v=N.detail;return}if(!(N.pointerType==="mouse"||N.sourceCapabilities&&!N.sourceCapabilities.firesTouchEvents)){var Y=Rm(N);if(!(Y.some(function(ce){return ce instanceof HTMLLabelElement&&ce.attributes.for})&&!Y.some(function(ce){return ce instanceof HTMLInputElement||ce instanceof HTMLSelectElement}))){var ie=Date.now();ie-p<=Ft?(v++,v===2&&c(qe(N))):v=1,p=ie}}}return s.addEventListener("click",T),{dblclick:c,simDblclick:T}}function hr(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var Ca=Nc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),jn=Nc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ti=jn==="webkitTransition"||jn==="OTransition"?jn+"End":"transitionend";function ia(s){return typeof s=="string"?document.getElementById(s):s}function ba(s,c){var p=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!p||p==="auto")&&document.defaultView){var v=document.defaultView.getComputedStyle(s,null);p=v?v[c]:null}return p==="auto"?null:p}function Qe(s,c,p){var v=document.createElement(s);return v.className=c||"",p&&p.appendChild(v),v}function zt(s){var c=s.parentNode;c&&c.removeChild(s)}function Cc(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Ns(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function As(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function s0(s,c){if(s.classList!==void 0)return s.classList.contains(c);var p=bc(s);return p.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(p)}function ot(s,c){if(s.classList!==void 0)for(var p=_(c),v=0,T=p.length;v<T;v++)s.classList.add(p[v]);else if(!s0(s,c)){var N=bc(s);o0(s,(N?N+" ":"")+c)}}function Yt(s,c){s.classList!==void 0?s.classList.remove(c):o0(s,x((" "+bc(s)+" ").replace(" "+c+" "," ")))}function o0(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function bc(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function kn(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&bk(s,c)}function bk(s,c){var p=!1,v="DXImageTransform.Microsoft.Alpha";try{p=s.filters.item(v)}catch{if(c===1)return}c=Math.round(c*100),p?(p.Enabled=c!==100,p.Opacity=c):s.style.filter+=" progid:"+v+"(opacity="+c+")"}function Nc(s){for(var c=document.documentElement.style,p=0;p<s.length;p++)if(s[p]in c)return s[p];return!1}function ji(s,c,p){var v=c||new Q(0,0);s.style[Ca]=(Ie.ie3d?"translate("+v.x+"px,"+v.y+"px)":"translate3d("+v.x+"px,"+v.y+"px,0)")+(p?" scale("+p+")":"")}function er(s,c){s._leaflet_pos=c,Ie.any3d?ji(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function Bi(s){return s._leaflet_pos||new Q(0,0)}var Io,jo,l0;if("onselectstart"in document)Io=function(){et(window,"selectstart",_r)},jo=function(){At(window,"selectstart",_r)};else{var Bo=Nc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Io=function(){if(Bo){var s=document.documentElement.style;l0=s[Bo],s[Bo]="none"}},jo=function(){Bo&&(document.documentElement.style[Bo]=l0,l0=void 0)}}function c0(){et(window,"dragstart",_r)}function u0(){At(window,"dragstart",_r)}var Ac,f0;function d0(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Lc(),Ac=s,f0=s.style.outlineStyle,s.style.outlineStyle="none",et(window,"keydown",Lc))}function Lc(){Ac&&(Ac.style.outlineStyle=f0,Ac=void 0,f0=void 0,At(window,"keydown",Lc))}function Om(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function h0(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var Nk={__proto__:null,TRANSFORM:Ca,TRANSITION:jn,TRANSITION_END:ti,get:ia,getStyle:ba,create:Qe,remove:zt,empty:Cc,toFront:Ns,toBack:As,hasClass:s0,addClass:ot,removeClass:Yt,setClass:o0,getClass:bc,setOpacity:kn,testProp:Nc,setTransform:ji,setPosition:er,getPosition:Bi,get disableTextSelection(){return Io},get enableTextSelection(){return jo},disableImageDrag:c0,enableImageDrag:u0,preventOutline:d0,restoreOutline:Lc,getSizedParentNode:Om,getScale:h0};function et(s,c,p,v){if(c&&typeof c=="object")for(var T in c)m0(s,T,c[T],p);else{c=_(c);for(var N=0,Y=c.length;N<Y;N++)m0(s,c[N],p,v)}return this}var sa="_leaflet_events";function At(s,c,p,v){if(arguments.length===1)Mm(s),delete s[sa];else if(c&&typeof c=="object")for(var T in c)g0(s,T,c[T],p);else if(c=_(c),arguments.length===2)Mm(s,function(ie){return A(c,ie)!==-1});else for(var N=0,Y=c.length;N<Y;N++)g0(s,c[N],p,v);return this}function Mm(s,c){for(var p in s[sa]){var v=p.split(/\d/)[0];(!c||c(v))&&g0(s,v,null,null,p)}}var p0={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function m0(s,c,p,v){var T=c+u(p)+(v?"_"+u(v):"");if(s[sa]&&s[sa][T])return this;var N=function(ie){return p.call(v||s,ie||window.event)},Y=N;!Ie.touchNative&&Ie.pointer&&c.indexOf("touch")===0?N=se(s,c,N):Ie.touch&&c==="dblclick"?N=Ot(s,N):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(p0[c]||c,N,Ie.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(N=function(ie){ie=ie||window.event,v0(s,ie)&&Y(ie)},s.addEventListener(p0[c],N,!1)):s.addEventListener(c,Y,!1):s.attachEvent("on"+c,N),s[sa]=s[sa]||{},s[sa][T]=N}function g0(s,c,p,v,T){T=T||c+u(p)+(v?"_"+u(v):"");var N=s[sa]&&s[sa][T];if(!N)return this;!Ie.touchNative&&Ie.pointer&&c.indexOf("touch")===0?oe(s,c,N):Ie.touch&&c==="dblclick"?hr(s,N):"removeEventListener"in s?s.removeEventListener(p0[c]||c,N,!1):s.detachEvent("on"+c,N),s[sa][T]=null}function zi(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function x0(s){return m0(s,"wheel",zi),this}function zo(s){return et(s,"mousedown touchstart dblclick contextmenu",zi),s._leaflet_disable_click=!0,this}function _r(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Ui(s){return _r(s),zi(s),this}function Rm(s){if(s.composedPath)return s.composedPath();for(var c=[],p=s.target;p;)c.push(p),p=p.parentNode;return c}function Dm(s,c){if(!c)return new Q(s.clientX,s.clientY);var p=h0(c),v=p.boundingClientRect;return new Q((s.clientX-v.left)/p.x-c.clientLeft,(s.clientY-v.top)/p.y-c.clientTop)}var Ak=Ie.linux&&Ie.chrome?window.devicePixelRatio:Ie.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Im(s){return Ie.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Ak:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function v0(s,c){var p=c.relatedTarget;if(!p)return!0;try{for(;p&&p!==s;)p=p.parentNode}catch{return!1}return p!==s}var Lk={__proto__:null,on:et,off:At,stopPropagation:zi,disableScrollPropagation:x0,disableClickPropagation:zo,preventDefault:_r,stop:Ui,getPropagationPath:Rm,getMousePosition:Dm,getWheelDelta:Im,isExternalTarget:v0,addListener:et,removeListener:At},jm=J.extend({run:function(s,c,p,v){this.stop(),this._el=s,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(v||.5,.2),this._startPos=Bi(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=B(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,p=this._duration*1e3;c<p?this._runFrame(this._easeOut(c/p),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var p=this._startPos.add(this._offset.multiplyBy(s));c&&p._round(),er(this._el,p),this.fire("step")},_complete:function(){Z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),mt=J.extend({options:{crs:Ge,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=y(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(ae(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=jn&&Ie.any3d&&!Ie.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),et(this._proxy,ti,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,p){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(ae(s),c,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=a({animate:p.animate},p.zoom),p.pan=a({animate:p.animate,duration:p.duration},p.pan));var v=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,p.zoom):this._tryAnimatedPan(s,p.pan);if(v)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,p.pan&&p.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,p){var v=this.getZoomScale(c),T=this.getSize().divideBy(2),N=s instanceof Q?s:this.latLngToContainerPoint(s),Y=N.subtract(T).multiplyBy(1-1/v),ie=this.containerPointToLatLng(T.add(Y));return this.setView(ie,c,{zoom:p})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():q(s);var p=te(c.paddingTopLeft||c.padding||[0,0]),v=te(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(s,!1,p.add(v));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:s.getCenter(),zoom:T};var N=v.subtract(p).divideBy(2),Y=this.project(s.getSouthWest(),T),ie=this.project(s.getNorthEast(),T),ce=this.unproject(Y.add(ie).divideBy(2).add(N),T);return{center:ce,zoom:T}},fitBounds:function(s,c){if(s=q(s),!s.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(s,c);return this.setView(p.center,p.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=te(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new jm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ot(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,p,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,p){if(p=p||{},p.animate===!1||!Ie.any3d)return this.setView(s,c,p);this._stop();var v=this.project(this.getCenter()),T=this.project(s),N=this.getSize(),Y=this._zoom;s=ae(s),c=c===void 0?Y:c;var ie=Math.max(N.x,N.y),ce=ie*this.getZoomScale(Y,c),Ee=T.distanceTo(v)||1,Re=1.42,We=Re*Re;function ct(tr){var Hc=tr?-1:1,vE=tr?ce:ie,_E=ce*ce-ie*ie+Hc*We*We*Ee*Ee,yE=2*vE*We*Ee,A0=_E/yE,v1=Math.sqrt(A0*A0+1)-A0,wE=v1<1e-9?-18:Math.log(v1);return wE}function Wr(tr){return(Math.exp(tr)-Math.exp(-tr))/2}function pr(tr){return(Math.exp(tr)+Math.exp(-tr))/2}function Sn(tr){return Wr(tr)/pr(tr)}var en=ct(0);function Rs(tr){return ie*(pr(en)/pr(en+Re*tr))}function pE(tr){return ie*(pr(en)*Sn(en+Re*tr)-Wr(en))/We}function mE(tr){return 1-Math.pow(1-tr,1.5)}var gE=Date.now(),g1=(ct(1)-en)/Re,xE=p.duration?1e3*p.duration:1e3*g1*.8;function x1(){var tr=(Date.now()-gE)/xE,Hc=mE(tr)*g1;tr<=1?(this._flyToFrame=B(x1,this),this._move(this.unproject(v.add(T.subtract(v).multiplyBy(pE(Hc)/Ee)),Y),this.getScaleZoom(ie/Rs(Hc),Y),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),x1.call(this),this},flyToBounds:function(s,c){var p=this._getBoundsCenterZoom(s,c);return this.flyTo(p.center,p.zoom,c)},setMaxBounds:function(s){return s=q(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var p=this.getCenter(),v=this._limitCenter(p,this._zoom,q(s));return p.equals(v)||this.panTo(v,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var p=te(c.paddingTopLeft||c.padding||[0,0]),v=te(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),N=this.project(s),Y=this.getPixelBounds(),ie=F([Y.min.add(p),Y.max.subtract(v)]),ce=ie.getSize();if(!ie.contains(N)){this._enforcingBounds=!0;var Ee=N.subtract(ie.getCenter()),Re=ie.extend(N).getSize().subtract(ce);T.x+=Ee.x<0?-Re.x:Re.x,T.y+=Ee.y<0?-Re.y:Re.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=a({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),v=c.divideBy(2).round(),T=p.divideBy(2).round(),N=v.subtract(T);return!N.x&&!N.y?this:(s.animate&&s.pan?this.panBy(N):(s.pan&&this._rawPanBy(N),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=a({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),p=o(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,p,s):navigator.geolocation.getCurrentPosition(c,p,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,p=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,p=s.coords.longitude,v=new X(c,p),T=v.toBounds(s.coords.accuracy*2),N=this._locateOptions;if(N.setView){var Y=this.getBoundsZoom(T);this.setView(v,N.maxZoom?Math.min(Y,N.maxZoom):Y)}var ie={latlng:v,bounds:T,timestamp:s.timestamp};for(var ce in s.coords)typeof s.coords[ce]=="number"&&(ie[ce]=s.coords[ce]);this.fire("locationfound",ie)}},addHandler:function(s,c){if(!c)return this;var p=this[s]=new c(this);return this._handlers.push(p),this.options[s]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),zt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)zt(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var p="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),v=Qe("div",p,c||this._mapPane);return s&&(this._panes[s]=v),v},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),p=this.unproject(s.getTopRight());return new ee(c,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,p){s=q(s),p=te(p||[0,0]);var v=this.getZoom()||0,T=this.getMinZoom(),N=this.getMaxZoom(),Y=s.getNorthWest(),ie=s.getSouthEast(),ce=this.getSize().subtract(p),Ee=F(this.project(ie,v),this.project(Y,v)).getSize(),Re=Ie.any3d?this.options.zoomSnap:1,We=ce.x/Ee.x,ct=ce.y/Ee.y,Wr=c?Math.max(We,ct):Math.min(We,ct);return v=this.getScaleZoom(Wr,v),Re&&(v=Math.round(v/(Re/100))*(Re/100),v=c?Math.ceil(v/Re)*Re:Math.floor(v/Re)*Re),Math.max(T,Math.min(N,v))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var p=this._getTopLeftPoint(s,c);return new fe(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var p=this.options.crs;return c=c===void 0?this._zoom:c,p.scale(s)/p.scale(c)},getScaleZoom:function(s,c){var p=this.options.crs;c=c===void 0?this._zoom:c;var v=p.zoom(s*p.scale(c));return isNaN(v)?1/0:v},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(ae(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(te(s),c)},layerPointToLatLng:function(s){var c=te(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(ae(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(ae(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(q(s))},distance:function(s,c){return this.options.crs.distance(ae(s),ae(c))},containerPointToLayerPoint:function(s){return te(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return te(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(te(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ae(s)))},mouseEventToContainerPoint:function(s){return Dm(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=ia(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");et(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ie.any3d,ot(s,"leaflet-container"+(Ie.touch?" leaflet-touch":"")+(Ie.retina?" leaflet-retina":"")+(Ie.ielt9?" leaflet-oldie":"")+(Ie.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=ba(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),er(this._mapPane,new Q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ot(s.markerPane,"leaflet-zoom-hide"),ot(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,p){er(this._mapPane,new Q(0,0));var v=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,p)._move(s,c)._moveEnd(T),this.fire("viewreset"),v&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,p,v){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),v?p&&p.pinch&&this.fire("zoom",p):((T||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){er(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[u(this._container)]=this;var c=s?At:et;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Ie.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Z(this._resizeRequest),this._resizeRequest=B(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var p=[],v,T=c==="mouseout"||c==="mouseover",N=s.target||s.srcElement,Y=!1;N;){if(v=this._targets[u(N)],v&&(c==="click"||c==="preclick")&&this._draggableMoved(v)){Y=!0;break}if(v&&v.listens(c,!0)&&(T&&!v0(N,s)||(p.push(v),T))||N===this._container)break;N=N.parentNode}return!p.length&&!Y&&!T&&this.listens(c,!0)&&(p=[this]),p},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var p=s.type;p==="mousedown"&&d0(c),this._fireDOMEvent(s,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,p){if(s.type==="click"){var v=a({},s);v.type="preclick",this._fireDOMEvent(v,v.type,p)}var T=this._findEventTargets(s,c);if(p){for(var N=[],Y=0;Y<p.length;Y++)p[Y].listens(c,!0)&&N.push(p[Y]);T=N.concat(T)}if(T.length){c==="contextmenu"&&_r(s);var ie=T[0],ce={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Ee=ie.getLatLng&&(!ie._radius||ie._radius<=10);ce.containerPoint=Ee?this.latLngToContainerPoint(ie.getLatLng()):this.mouseEventToContainerPoint(s),ce.layerPoint=this.containerPointToLayerPoint(ce.containerPoint),ce.latlng=Ee?ie.getLatLng():this.layerPointToLatLng(ce.layerPoint)}for(Y=0;Y<T.length;Y++)if(T[Y].fire(c,ce,!0),ce.originalEvent._stopped||T[Y].options.bubblingMouseEvents===!1&&A(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return Bi(this._mapPane)||new Q(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var p=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var p=this.getSize()._divideBy(2);return this.project(s,c)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,p){var v=this._getNewPixelOrigin(p,c);return this.project(s,c)._subtract(v)},_latLngBoundsToNewLayerBounds:function(s,c,p){var v=this._getNewPixelOrigin(p,c);return F([this.project(s.getSouthWest(),c)._subtract(v),this.project(s.getNorthWest(),c)._subtract(v),this.project(s.getSouthEast(),c)._subtract(v),this.project(s.getNorthEast(),c)._subtract(v)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,p){if(!p)return s;var v=this.project(s,c),T=this.getSize().divideBy(2),N=new fe(v.subtract(T),v.add(T)),Y=this._getBoundsOffset(N,p,c);return Math.abs(Y.x)<=1&&Math.abs(Y.y)<=1?s:this.unproject(v.add(Y),c)},_limitOffset:function(s,c){if(!c)return s;var p=this.getPixelBounds(),v=new fe(p.min.add(s),p.max.add(s));return s.add(this._getBoundsOffset(v,c))},_getBoundsOffset:function(s,c,p){var v=F(this.project(c.getNorthEast(),p),this.project(c.getSouthWest(),p)),T=v.min.subtract(s.min),N=v.max.subtract(s.max),Y=this._rebound(T.x,-N.x),ie=this._rebound(T.y,-N.y);return new Q(Y,ie)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),p=this.getMaxZoom(),v=Ie.any3d?this.options.zoomSnap:1;return v&&(s=Math.round(s/v)*v),Math.max(c,Math.min(p,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Yt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var p=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,c),!0)},_createAnimProxy:function(){var s=this._proxy=Qe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var p=Ca,v=this._proxy.style[p];ji(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),v===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){zt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();ji(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var v=this.getZoomScale(c),T=this._getCenterOffset(s)._divideBy(1-1/v);return p.animate!==!0&&!this.getSize().contains(T)?!1:(B(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,p,v){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:v}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Yt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Pk(s,c){return new mt(s,c)}var Bn=ve.extend({options:{position:"topright"},initialize:function(s){y(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),p=this.getPosition(),v=s._controlCorners[p];return ot(c,"leaflet-control"),p.indexOf("bottom")!==-1?v.insertBefore(c,v.firstChild):v.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(zt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Uo=function(s){return new Bn(s)};mt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",p=this._controlContainer=Qe("div",c+"control-container",this._container);function v(T,N){var Y=c+T+" "+c+N;s[T+N]=Qe("div",Y,p)}v("top","left"),v("top","right"),v("bottom","left"),v("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)zt(this._controlCorners[s]);zt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Bm=Bn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,p,v){return p<v?-1:v<p?1:0}},initialize:function(s,c,p){y(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var v in s)this._addLayer(s[v],v);for(v in c)this._addLayer(c[v],v,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Bn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Yt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Yt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=Qe("div",s),p=this.options.collapsed;c.setAttribute("aria-haspopup",!0),zo(c),x0(c);var v=this._section=Qe("section",s+"-list");p&&(this._map.on("click",this.collapse,this),et(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=Qe("a",s+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),et(T,{keydown:function(N){N.keyCode===13&&this._expandSafely()},click:function(N){_r(N),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=Qe("div",s+"-base",v),this._separator=Qe("div",s+"-separator",v),this._overlaysList=Qe("div",s+"-overlays",v),c.appendChild(v)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,p){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:p}),this.options.sortLayers&&this._layers.sort(o(function(v,T){return this.options.sortFunction(v.layer,T.layer,v.name,T.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Cc(this._baseLayersList),Cc(this._overlaysList),this._layerControlInputs=[];var s,c,p,v,T=0;for(p=0;p<this._layers.length;p++)v=this._layers[p],this._addItem(v),c=c||v.overlay,s=s||!v.overlay,T+=v.overlay?0:1;return this.options.hideSingleBase&&(s=s&&T>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(u(s.target)),p=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;p&&this._map.fire(p,c)},_createRadioElement:function(s,c){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",v=document.createElement("div");return v.innerHTML=p,v.firstChild},_addItem:function(s){var c=document.createElement("label"),p=this._map.hasLayer(s.layer),v;s.overlay?(v=document.createElement("input"),v.type="checkbox",v.className="leaflet-control-layers-selector",v.defaultChecked=p):v=this._createRadioElement("leaflet-base-layers_"+u(this),p),this._layerControlInputs.push(v),v.layerId=u(s.layer),et(v,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+s.name;var N=document.createElement("span");c.appendChild(N),N.appendChild(v),N.appendChild(T);var Y=s.overlay?this._overlaysList:this._baseLayersList;return Y.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,p,v=[],T=[];this._handlingClick=!0;for(var N=s.length-1;N>=0;N--)c=s[N],p=this._getLayer(c.layerId).layer,c.checked?v.push(p):c.checked||T.push(p);for(N=0;N<T.length;N++)this._map.hasLayer(T[N])&&this._map.removeLayer(T[N]);for(N=0;N<v.length;N++)this._map.hasLayer(v[N])||this._map.addLayer(v[N]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,p,v=this._map.getZoom(),T=s.length-1;T>=0;T--)c=s[T],p=this._getLayer(c.layerId).layer,c.disabled=p.options.minZoom!==void 0&&v<p.options.minZoom||p.options.maxZoom!==void 0&&v>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,et(s,"click",_r),this.expand();var c=this;setTimeout(function(){At(s,"click",_r),c._preventClick=!1})}}),Fk=function(s,c,p){return new Bm(s,c,p)},_0=Bn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",p=Qe("div",c+" leaflet-bar"),v=this.options;return this._zoomInButton=this._createButton(v.zoomInText,v.zoomInTitle,c+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(v.zoomOutText,v.zoomOutTitle,c+"-out",p,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,p,v,T){var N=Qe("a",p,v);return N.innerHTML=s,N.href="#",N.title=c,N.setAttribute("role","button"),N.setAttribute("aria-label",c),zo(N),et(N,"click",Ui),et(N,"click",T,this),et(N,"click",this._refocusOnMap,this),N},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";Yt(this._zoomInButton,c),Yt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(ot(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(ot(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});mt.mergeOptions({zoomControl:!0}),mt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new _0,this.addControl(this.zoomControl))});var Ok=function(s){return new _0(s)},zm=Bn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",p=Qe("div",c),v=this.options;return this._addScales(v,c+"-line",p),s.on(v.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),p},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,p){s.metric&&(this._mScale=Qe("div",c,p)),s.imperial&&(this._iScale=Qe("div",c,p))},_update:function(){var s=this._map,c=s.getSize().y/2,p=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(p)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),p=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,p,c/s)},_updateImperial:function(s){var c=s*3.2808399,p,v,T;c>5280?(p=c/5280,v=this._getRoundNum(p),this._updateScale(this._iScale,v+" mi",v/p)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(s,c,p){s.style.width=Math.round(this.options.maxWidth*p)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),p=s/c;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,c*p}}),Mk=function(s){return new zm(s)},Rk='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',y0=Bn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ie.inlineSvg?Rk+" ":"")+"Leaflet</a>"},initialize:function(s){y(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Qe("div","leaflet-control-attribution"),zo(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var p=[];this.options.prefix&&p.push(this.options.prefix),s.length&&p.push(s.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});mt.mergeOptions({attributionControl:!0}),mt.addInitHook(function(){this.options.attributionControl&&new y0().addTo(this)});var Dk=function(s){return new y0(s)};Bn.Layers=Bm,Bn.Zoom=_0,Bn.Scale=zm,Bn.Attribution=y0,Uo.layers=Fk,Uo.zoom=Ok,Uo.scale=Mk,Uo.attribution=Dk;var oa=ve.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});oa.addTo=function(s,c){return s.addHandler(c,this),this};var Ik={Events:de},Um=Ie.touch?"touchstart mousedown":"mousedown",ri=J.extend({options:{clickTolerance:3},initialize:function(s,c,p,v){y(this,v),this._element=s,this._dragStartTarget=c||s,this._preventOutline=p},enable:function(){this._enabled||(et(this._dragStartTarget,Um,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ri._dragging===this&&this.finishDrag(!0),At(this._dragStartTarget,Um,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!s0(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){ri._dragging===this&&this.finishDrag();return}if(!(ri._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(ri._dragging=this,this._preventOutline&&d0(this._element),c0(),Io(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,p=Om(this._element);this._startPoint=new Q(c.clientX,c.clientY),this._startPos=Bi(this._element),this._parentScale=h0(p);var v=s.type==="mousedown";et(document,v?"mousemove":"touchmove",this._onMove,this),et(document,v?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,p=new Q(c.clientX,c.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,_r(s),this._moved||(this.fire("dragstart"),this._moved=!0,ot(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),er(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Yt(document.body,"leaflet-dragging"),this._lastTarget&&(Yt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),At(document,"mousemove touchmove",this._onMove,this),At(document,"mouseup touchend touchcancel",this._onUp,this),u0(),jo();var c=this._moved&&this._moving;this._moving=!1,ri._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Hm(s,c,p){var v,T=[1,4,2,8],N,Y,ie,ce,Ee,Re,We,ct;for(N=0,Re=s.length;N<Re;N++)s[N]._code=Hi(s[N],c);for(ie=0;ie<4;ie++){for(We=T[ie],v=[],N=0,Re=s.length,Y=Re-1;N<Re;Y=N++)ce=s[N],Ee=s[Y],ce._code&We?Ee._code&We||(ct=Pc(Ee,ce,We,c,p),ct._code=Hi(ct,c),v.push(ct)):(Ee._code&We&&(ct=Pc(Ee,ce,We,c,p),ct._code=Hi(ct,c),v.push(ct)),v.push(ce));s=v}return s}function Vm(s,c){var p,v,T,N,Y,ie,ce,Ee,Re;if(!s||s.length===0)throw new Error("latlngs not passed");En(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var We=ae([0,0]),ct=q(s),Wr=ct.getNorthWest().distanceTo(ct.getSouthWest())*ct.getNorthEast().distanceTo(ct.getNorthWest());Wr<1700&&(We=w0(s));var pr=s.length,Sn=[];for(p=0;p<pr;p++){var en=ae(s[p]);Sn.push(c.project(ae([en.lat-We.lat,en.lng-We.lng])))}for(ie=ce=Ee=0,p=0,v=pr-1;p<pr;v=p++)T=Sn[p],N=Sn[v],Y=T.y*N.x-N.y*T.x,ce+=(T.x+N.x)*Y,Ee+=(T.y+N.y)*Y,ie+=Y*3;ie===0?Re=Sn[0]:Re=[ce/ie,Ee/ie];var Rs=c.unproject(te(Re));return ae([Rs.lat+We.lat,Rs.lng+We.lng])}function w0(s){for(var c=0,p=0,v=0,T=0;T<s.length;T++){var N=ae(s[T]);c+=N.lat,p+=N.lng,v++}return ae([c/v,p/v])}var jk={__proto__:null,clipPolygon:Hm,polygonCenter:Vm,centroid:w0};function Wm(s,c){if(!c||!s.length)return s.slice();var p=c*c;return s=Uk(s,p),s=zk(s,p),s}function $m(s,c,p){return Math.sqrt(Ho(s,c,p,!0))}function Bk(s,c,p){return Ho(s,c,p)}function zk(s,c){var p=s.length,v=typeof Uint8Array<"u"?Uint8Array:Array,T=new v(p);T[0]=T[p-1]=1,k0(s,T,c,0,p-1);var N,Y=[];for(N=0;N<p;N++)T[N]&&Y.push(s[N]);return Y}function k0(s,c,p,v,T){var N=0,Y,ie,ce;for(ie=v+1;ie<=T-1;ie++)ce=Ho(s[ie],s[v],s[T],!0),ce>N&&(Y=ie,N=ce);N>p&&(c[Y]=1,k0(s,c,p,v,Y),k0(s,c,p,Y,T))}function Uk(s,c){for(var p=[s[0]],v=1,T=0,N=s.length;v<N;v++)Hk(s[v],s[T])>c&&(p.push(s[v]),T=v);return T<N-1&&p.push(s[N-1]),p}var Gm;function Zm(s,c,p,v,T){var N=v?Gm:Hi(s,p),Y=Hi(c,p),ie,ce,Ee;for(Gm=Y;;){if(!(N|Y))return[s,c];if(N&Y)return!1;ie=N||Y,ce=Pc(s,c,ie,p,T),Ee=Hi(ce,p),ie===N?(s=ce,N=Ee):(c=ce,Y=Ee)}}function Pc(s,c,p,v,T){var N=c.x-s.x,Y=c.y-s.y,ie=v.min,ce=v.max,Ee,Re;return p&8?(Ee=s.x+N*(ce.y-s.y)/Y,Re=ce.y):p&4?(Ee=s.x+N*(ie.y-s.y)/Y,Re=ie.y):p&2?(Ee=ce.x,Re=s.y+Y*(ce.x-s.x)/N):p&1&&(Ee=ie.x,Re=s.y+Y*(ie.x-s.x)/N),new Q(Ee,Re,T)}function Hi(s,c){var p=0;return s.x<c.min.x?p|=1:s.x>c.max.x&&(p|=2),s.y<c.min.y?p|=4:s.y>c.max.y&&(p|=8),p}function Hk(s,c){var p=c.x-s.x,v=c.y-s.y;return p*p+v*v}function Ho(s,c,p,v){var T=c.x,N=c.y,Y=p.x-T,ie=p.y-N,ce=Y*Y+ie*ie,Ee;return ce>0&&(Ee=((s.x-T)*Y+(s.y-N)*ie)/ce,Ee>1?(T=p.x,N=p.y):Ee>0&&(T+=Y*Ee,N+=ie*Ee)),Y=s.x-T,ie=s.y-N,v?Y*Y+ie*ie:new Q(T,N)}function En(s){return!w(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Xm(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),En(s)}function qm(s,c){var p,v,T,N,Y,ie,ce,Ee;if(!s||s.length===0)throw new Error("latlngs not passed");En(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Re=ae([0,0]),We=q(s),ct=We.getNorthWest().distanceTo(We.getSouthWest())*We.getNorthEast().distanceTo(We.getNorthWest());ct<1700&&(Re=w0(s));var Wr=s.length,pr=[];for(p=0;p<Wr;p++){var Sn=ae(s[p]);pr.push(c.project(ae([Sn.lat-Re.lat,Sn.lng-Re.lng])))}for(p=0,v=0;p<Wr-1;p++)v+=pr[p].distanceTo(pr[p+1])/2;if(v===0)Ee=pr[0];else for(p=0,N=0;p<Wr-1;p++)if(Y=pr[p],ie=pr[p+1],T=Y.distanceTo(ie),N+=T,N>v){ce=(N-v)/T,Ee=[ie.x-ce*(ie.x-Y.x),ie.y-ce*(ie.y-Y.y)];break}var en=c.unproject(te(Ee));return ae([en.lat+Re.lat,en.lng+Re.lng])}var Vk={__proto__:null,simplify:Wm,pointToSegmentDistance:$m,closestPointOnSegment:Bk,clipSegment:Zm,_getEdgeIntersection:Pc,_getBitCode:Hi,_sqClosestPointOnSegment:Ho,isFlat:En,_flat:Xm,polylineCenter:qm},E0={project:function(s){return new Q(s.lng,s.lat)},unproject:function(s){return new X(s.y,s.x)},bounds:new fe([-180,-90],[180,90])},S0={R:6378137,R_MINOR:6356752314245179e-9,bounds:new fe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,p=this.R,v=s.lat*c,T=this.R_MINOR/p,N=Math.sqrt(1-T*T),Y=N*Math.sin(v),ie=Math.tan(Math.PI/4-v/2)/Math.pow((1-Y)/(1+Y),N/2);return v=-p*Math.log(Math.max(ie,1e-10)),new Q(s.lng*c*p,v)},unproject:function(s){for(var c=180/Math.PI,p=this.R,v=this.R_MINOR/p,T=Math.sqrt(1-v*v),N=Math.exp(-s.y/p),Y=Math.PI/2-2*Math.atan(N),ie=0,ce=.1,Ee;ie<15&&Math.abs(ce)>1e-7;ie++)Ee=T*Math.sin(Y),Ee=Math.pow((1-Ee)/(1+Ee),T/2),ce=Math.PI/2-2*Math.atan(N*Ee)-Y,Y+=ce;return new X(Y*c,s.x*c/p)}},Wk={__proto__:null,LonLat:E0,Mercator:S0,SphericalMercator:we},$k=a({},Le,{code:"EPSG:3395",projection:S0,transformation:function(){var s=.5/(Math.PI*S0.R);return G(s,.5,-s,.5)}()}),Ym=a({},Le,{code:"EPSG:4326",projection:E0,transformation:G(1/180,1,-1/180,.5)}),Gk=a({},ke,{projection:E0,transformation:G(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var p=c.lng-s.lng,v=c.lat-s.lat;return Math.sqrt(p*p+v*v)},infinite:!0});ke.Earth=Le,ke.EPSG3395=$k,ke.EPSG3857=Ge,ke.EPSG900913=Je,ke.EPSG4326=Ym,ke.Simple=Gk;var zn=J.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[u(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[u(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var p=this.getEvents();c.on(p,this),this.once("remove",function(){c.off(p,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});mt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=u(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return u(s)in this._layers},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},_addLayers:function(s){s=s?w(s)?s:[s]:[];for(var c=0,p=s.length;c<p;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[u(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=u(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,p=this._getZoomSpan();for(var v in this._zoomBoundLayers){var T=this._zoomBoundLayers[v].options;s=T.minZoom===void 0?s:Math.min(s,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ls=zn.extend({initialize:function(s,c){y(this,c),this._layers={};var p,v;if(s)for(p=0,v=s.length;p<v;p++)this.addLayer(s[p])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),p,v;for(p in this._layers)v=this._layers[p],v[s]&&v[s].apply(v,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var p in this._layers)s.call(c,this._layers[p]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return u(s)}}),Zk=function(s,c){return new Ls(s,c)},Na=Ls.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Ls.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Ls.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new ee;for(var c in this._layers){var p=this._layers[c];s.extend(p.getBounds?p.getBounds():p.getLatLng())}return s}}),Xk=function(s,c){return new Na(s,c)},Ps=ve.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){y(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var p=this._getIconUrl(s);if(!p){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var v=this._createImg(p,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(v,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v},_setIconStyles:function(s,c){var p=this.options,v=p[c+"Size"];typeof v=="number"&&(v=[v,v]);var T=te(v),N=te(c==="shadow"&&p.shadowAnchor||p.iconAnchor||T&&T.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(p.className||""),N&&(s.style.marginLeft=-N.x+"px",s.style.marginTop=-N.y+"px"),T&&(s.style.width=T.x+"px",s.style.height=T.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return Ie.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function qk(s){return new Ps(s)}var Vo=Ps.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Vo.imagePath!="string"&&(Vo.imagePath=this._detectIconPath()),(this.options.imagePath||Vo.imagePath)+Ps.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(p,v,T){var N=v.exec(p);return N&&N[T]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Qe("div","leaflet-default-icon-path",document.body),c=ba(s,"background-image")||ba(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Km=oa.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new ri(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ot(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Yt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,p=c._map,v=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,N=Bi(c._icon),Y=p.getPixelBounds(),ie=p.getPixelOrigin(),ce=F(Y.min._subtract(ie).add(T),Y.max._subtract(ie).subtract(T));if(!ce.contains(N)){var Ee=te((Math.max(ce.max.x,N.x)-ce.max.x)/(Y.max.x-ce.max.x)-(Math.min(ce.min.x,N.x)-ce.min.x)/(Y.min.x-ce.min.x),(Math.max(ce.max.y,N.y)-ce.max.y)/(Y.max.y-ce.max.y)-(Math.min(ce.min.y,N.y)-ce.min.y)/(Y.min.y-ce.min.y)).multiplyBy(v);p.panBy(Ee,{animate:!1}),this._draggable._newPos._add(Ee),this._draggable._startPos._add(Ee),er(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=B(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(Z(this._panRequest),this._panRequest=B(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,p=c._shadow,v=Bi(c._icon),T=c._map.layerPointToLatLng(v);p&&er(p,v),c._latlng=T,s.latlng=T,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){Z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Fc=zn.extend({options:{icon:new Vo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){y(this,c),this._latlng=ae(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=ae(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=s.icon.createIcon(this._icon),v=!1;p!==this._icon&&(this._icon&&this._removeIcon(),v=!0,s.title&&(p.title=s.title),p.tagName==="IMG"&&(p.alt=s.alt||"")),ot(p,c),s.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&et(p,"focus",this._panOnFocus,this);var T=s.icon.createShadow(this._shadow),N=!1;T!==this._shadow&&(this._removeShadow(),N=!0),T&&(ot(T,c),T.alt=""),this._shadow=T,s.opacity<1&&this._updateOpacity(),v&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&N&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&At(this._icon,"focus",this._panOnFocus,this),zt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&zt(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&er(this._icon,s),this._shadow&&er(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Km)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Km(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&kn(this._icon,s),this._shadow&&kn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,p=c.iconSize?te(c.iconSize):te(0,0),v=c.iconAnchor?te(c.iconAnchor):te(0,0);s.panInside(this._latlng,{paddingTopLeft:v,paddingBottomRight:p.subtract(v)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Yk(s,c){return new Fc(s,c)}var ni=zn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return y(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Oc=ni.extend({options:{fill:!0,radius:10},initialize:function(s,c){y(this,c),this._latlng=ae(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=ae(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return ni.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,p=this._clickTolerance(),v=[s+p,c+p];this._pxBounds=new fe(this._point.subtract(v),this._point.add(v))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Kk(s,c){return new Oc(s,c)}var T0=Oc.extend({initialize:function(s,c,p){if(typeof c=="number"&&(c=a({},p,{radius:c})),y(this,c),this._latlng=ae(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new ee(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:ni.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,p=this._map,v=p.options.crs;if(v.distance===Le.distance){var T=Math.PI/180,N=this._mRadius/Le.R/T,Y=p.project([c+N,s]),ie=p.project([c-N,s]),ce=Y.add(ie).divideBy(2),Ee=p.unproject(ce).lat,Re=Math.acos((Math.cos(N*T)-Math.sin(c*T)*Math.sin(Ee*T))/(Math.cos(c*T)*Math.cos(Ee*T)))/T;(isNaN(Re)||Re===0)&&(Re=N/Math.cos(Math.PI/180*c)),this._point=ce.subtract(p.getPixelOrigin()),this._radius=isNaN(Re)?0:ce.x-p.project([Ee,s-Re]).x,this._radiusY=ce.y-Y.y}else{var We=v.unproject(v.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(We).x}this._updateBounds()}});function Jk(s,c,p){return new T0(s,c,p)}var Aa=ni.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){y(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,p=null,v=Ho,T,N,Y=0,ie=this._parts.length;Y<ie;Y++)for(var ce=this._parts[Y],Ee=1,Re=ce.length;Ee<Re;Ee++){T=ce[Ee-1],N=ce[Ee];var We=v(s,T,N,!0);We<c&&(c=We,p=v(s,T,N))}return p&&(p.distance=Math.sqrt(c)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return qm(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=ae(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new ee,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return En(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],p=En(s),v=0,T=s.length;v<T;v++)p?(c[v]=ae(s[v]),this._bounds.extend(c[v])):c[v]=this._convertLatLngs(s[v]);return c},_project:function(){var s=new fe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new Q(s,s);this._rawPxBounds&&(this._pxBounds=new fe([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,p){var v=s[0]instanceof X,T=s.length,N,Y;if(v){for(Y=[],N=0;N<T;N++)Y[N]=this._map.latLngToLayerPoint(s[N]),p.extend(Y[N]);c.push(Y)}else for(N=0;N<T;N++)this._projectLatlngs(s[N],c,p)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,p,v,T,N,Y,ie,ce;for(p=0,T=0,N=this._rings.length;p<N;p++)for(ce=this._rings[p],v=0,Y=ce.length;v<Y-1;v++)ie=Zm(ce[v],ce[v+1],s,v,!0),ie&&(c[T]=c[T]||[],c[T].push(ie[0]),(ie[1]!==ce[v+1]||v===Y-2)&&(c[T].push(ie[1]),T++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,p=0,v=s.length;p<v;p++)s[p]=Wm(s[p],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var p,v,T,N,Y,ie,ce=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(p=0,N=this._parts.length;p<N;p++)for(ie=this._parts[p],v=0,Y=ie.length,T=Y-1;v<Y;T=v++)if(!(!c&&v===0)&&$m(s,ie[T],ie[v])<=ce)return!0;return!1}});function Qk(s,c){return new Aa(s,c)}Aa._flat=Xm;var Fs=Aa.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vm(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=Aa.prototype._convertLatLngs.call(this,s),p=c.length;return p>=2&&c[0]instanceof X&&c[0].equals(c[p-1])&&c.pop(),c},_setLatLngs:function(s){Aa.prototype._setLatLngs.call(this,s),En(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return En(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,p=new Q(c,c);if(s=new fe(s.min.subtract(p),s.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var v=0,T=this._rings.length,N;v<T;v++)N=Hm(this._rings[v],s,!0),N.length&&this._parts.push(N)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,p,v,T,N,Y,ie,ce,Ee;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(N=0,ce=this._parts.length;N<ce;N++)for(p=this._parts[N],Y=0,Ee=p.length,ie=Ee-1;Y<Ee;ie=Y++)v=p[Y],T=p[ie],v.y>s.y!=T.y>s.y&&s.x<(T.x-v.x)*(s.y-v.y)/(T.y-v.y)+v.x&&(c=!c);return c||Aa.prototype._containsPoint.call(this,s,!0)}});function eE(s,c){return new Fs(s,c)}var La=Na.extend({initialize:function(s,c){y(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=w(s)?s:s.features,p,v,T;if(c){for(p=0,v=c.length;p<v;p++)T=c[p],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var N=this.options;if(N.filter&&!N.filter(s))return this;var Y=Mc(s,N);return Y?(Y.feature=Ic(s),Y.defaultOptions=Y.options,this.resetStyle(Y),N.onEachFeature&&N.onEachFeature(s,Y),this.addLayer(Y)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=a({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function Mc(s,c){var p=s.type==="Feature"?s.geometry:s,v=p?p.coordinates:null,T=[],N=c&&c.pointToLayer,Y=c&&c.coordsToLatLng||C0,ie,ce,Ee,Re;if(!v&&!p)return null;switch(p.type){case"Point":return ie=Y(v),Jm(N,s,ie,c);case"MultiPoint":for(Ee=0,Re=v.length;Ee<Re;Ee++)ie=Y(v[Ee]),T.push(Jm(N,s,ie,c));return new Na(T);case"LineString":case"MultiLineString":return ce=Rc(v,p.type==="LineString"?0:1,Y),new Aa(ce,c);case"Polygon":case"MultiPolygon":return ce=Rc(v,p.type==="Polygon"?1:2,Y),new Fs(ce,c);case"GeometryCollection":for(Ee=0,Re=p.geometries.length;Ee<Re;Ee++){var We=Mc({geometry:p.geometries[Ee],type:"Feature",properties:s.properties},c);We&&T.push(We)}return new Na(T);case"FeatureCollection":for(Ee=0,Re=p.features.length;Ee<Re;Ee++){var ct=Mc(p.features[Ee],c);ct&&T.push(ct)}return new Na(T);default:throw new Error("Invalid GeoJSON object.")}}function Jm(s,c,p,v){return s?s(c,p):new Fc(p,v&&v.markersInheritOptions&&v)}function C0(s){return new X(s[1],s[0],s[2])}function Rc(s,c,p){for(var v=[],T=0,N=s.length,Y;T<N;T++)Y=c?Rc(s[T],c-1,p):(p||C0)(s[T]),v.push(Y);return v}function b0(s,c){return s=ae(s),s.alt!==void 0?[g(s.lng,c),g(s.lat,c),g(s.alt,c)]:[g(s.lng,c),g(s.lat,c)]}function Dc(s,c,p,v){for(var T=[],N=0,Y=s.length;N<Y;N++)T.push(c?Dc(s[N],En(s[N])?0:c-1,p,v):b0(s[N],v));return!c&&p&&T.length>0&&T.push(T[0].slice()),T}function Os(s,c){return s.feature?a({},s.feature,{geometry:c}):Ic(c)}function Ic(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var N0={toGeoJSON:function(s){return Os(this,{type:"Point",coordinates:b0(this.getLatLng(),s)})}};Fc.include(N0),T0.include(N0),Oc.include(N0),Aa.include({toGeoJSON:function(s){var c=!En(this._latlngs),p=Dc(this._latlngs,c?1:0,!1,s);return Os(this,{type:(c?"Multi":"")+"LineString",coordinates:p})}}),Fs.include({toGeoJSON:function(s){var c=!En(this._latlngs),p=c&&!En(this._latlngs[0]),v=Dc(this._latlngs,p?2:c?1:0,!0,s);return c||(v=[v]),Os(this,{type:(p?"Multi":"")+"Polygon",coordinates:v})}}),Ls.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(p){c.push(p.toGeoJSON(s).geometry.coordinates)}),Os(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var p=c==="GeometryCollection",v=[];return this.eachLayer(function(T){if(T.toGeoJSON){var N=T.toGeoJSON(s);if(p)v.push(N.geometry);else{var Y=Ic(N);Y.type==="FeatureCollection"?v.push.apply(v,Y.features):v.push(Y)}}}),p?Os(this,{geometries:v,type:"GeometryCollection"}):{type:"FeatureCollection",features:v}}});function Qm(s,c){return new La(s,c)}var tE=Qm,jc=zn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,p){this._url=s,this._bounds=q(c),y(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){zt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Ns(this._image),this},bringToBack:function(){return this._map&&As(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=q(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:Qe("img");if(ot(c,"leaflet-image-layer"),this._zoomAnimated&&ot(c,"leaflet-zoom-animated"),this.options.className&&ot(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;ji(this._image,p,c)},_reset:function(){var s=this._image,c=new fe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=c.getSize();er(s,c.min),s.style.width=p.x+"px",s.style.height=p.y+"px"},_updateOpacity:function(){kn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),rE=function(s,c,p){return new jc(s,c,p)},e1=jc.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:Qe("video");if(ot(c,"leaflet-image-layer"),this._zoomAnimated&&ot(c,"leaflet-zoom-animated"),this.options.className&&ot(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),s){for(var p=c.getElementsByTagName("source"),v=[],T=0;T<p.length;T++)v.push(p[T].src);this._url=p.length>0?v:[c.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var N=0;N<this._url.length;N++){var Y=Qe("source");Y.src=this._url[N],c.appendChild(Y)}}});function nE(s,c,p){return new e1(s,c,p)}var t1=jc.extend({_initImage:function(){var s=this._image=this._url;ot(s,"leaflet-image-layer"),this._zoomAnimated&&ot(s,"leaflet-zoom-animated"),this.options.className&&ot(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function aE(s,c,p){return new t1(s,c,p)}var la=zn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof X||w(s))?(this._latlng=ae(s),y(this,c)):(y(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&kn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&kn(this._container,1),this.bringToFront(),this.options.interactive&&(ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(kn(this._container,0),this._removeTimeout=setTimeout(o(zt,void 0,this._container),200)):zt(this._container),this.options.interactive&&(Yt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=ae(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ns(this._container),this},bringToBack:function(){return this._map&&As(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof Na){c=null;var p=this._source._layers;for(var v in p)if(p[v]._map){c=p[v];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=te(this.options.offset),p=this._getAnchor();this._zoomAnimated?er(this._container,s.add(p)):c=c.add(s).add(p);var v=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=v+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});mt.include({_initOverlay:function(s,c,p,v){var T=c;return T instanceof s||(T=new s(v).setContent(c)),p&&T.setLatLng(p),T}}),zn.include({_initOverlay:function(s,c,p,v){var T=p;return T instanceof s?(y(T,v),T._source=this):(T=c&&!v?c:new s(v,this),T.setContent(p)),T}});var Bc=la.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,la.prototype.openOn.call(this,s)},onAdd:function(s){la.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ni||this._source.on("preclick",zi))},onRemove:function(s){la.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ni||this._source.off("preclick",zi))},getEvents:function(){var s=la.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=Qe("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=Qe("div",s+"-content-wrapper",c);if(this._contentNode=Qe("div",s+"-content",p),zo(c),x0(this._contentNode),et(c,"contextmenu",zi),this._tipContainer=Qe("div",s+"-tip-container",c),this._tip=Qe("div",s+"-tip",this._tipContainer),this.options.closeButton){var v=this._closeButton=Qe("a",s+"-close-button",c);v.setAttribute("role","button"),v.setAttribute("aria-label","Close popup"),v.href="#close",v.innerHTML='<span aria-hidden="true">&#215;</span>',et(v,"click",function(T){_r(T),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var p=s.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),c.width=p+1+"px",c.whiteSpace="",c.height="";var v=s.offsetHeight,T=this.options.maxHeight,N="leaflet-popup-scrolled";T&&v>T?(c.height=T+"px",ot(s,N)):Yt(s,N),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),p=this._getAnchor();er(this._container,c.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(ba(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+c,v=this._containerWidth,T=new Q(this._containerLeft,-p-this._containerBottom);T._add(Bi(this._container));var N=s.layerPointToContainerPoint(T),Y=te(this.options.autoPanPadding),ie=te(this.options.autoPanPaddingTopLeft||Y),ce=te(this.options.autoPanPaddingBottomRight||Y),Ee=s.getSize(),Re=0,We=0;N.x+v+ce.x>Ee.x&&(Re=N.x+v-Ee.x+ce.x),N.x-Re-ie.x<0&&(Re=N.x-ie.x),N.y+p+ce.y>Ee.y&&(We=N.y+p-Ee.y+ce.y),N.y-We-ie.y<0&&(We=N.y-ie.y),(Re||We)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Re,We]))}},_getAnchor:function(){return te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),iE=function(s,c){return new Bc(s,c)};mt.mergeOptions({closePopupOnClick:!0}),mt.include({openPopup:function(s,c,p){return this._initOverlay(Bc,s,c,p).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),zn.include({bindPopup:function(s,c){return this._popup=this._initOverlay(Bc,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Na||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Ui(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof ni)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var zc=la.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){la.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){la.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=la.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Qe("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,p,v=this._map,T=this._container,N=v.latLngToContainerPoint(v.getCenter()),Y=v.layerPointToContainerPoint(s),ie=this.options.direction,ce=T.offsetWidth,Ee=T.offsetHeight,Re=te(this.options.offset),We=this._getAnchor();ie==="top"?(c=ce/2,p=Ee):ie==="bottom"?(c=ce/2,p=0):ie==="center"?(c=ce/2,p=Ee/2):ie==="right"?(c=0,p=Ee/2):ie==="left"?(c=ce,p=Ee/2):Y.x<N.x?(ie="right",c=0,p=Ee/2):(ie="left",c=ce+(Re.x+We.x)*2,p=Ee/2),s=s.subtract(te(c,p,!0)).add(Re).add(We),Yt(T,"leaflet-tooltip-right"),Yt(T,"leaflet-tooltip-left"),Yt(T,"leaflet-tooltip-top"),Yt(T,"leaflet-tooltip-bottom"),ot(T,"leaflet-tooltip-"+ie),er(T,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&kn(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),sE=function(s,c){return new zc(s,c)};mt.include({openTooltip:function(s,c,p){return this._initOverlay(zc,s,c,p).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),zn.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(zc,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[c](p),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Na||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(et(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),et(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,p,v;this._tooltip.options.sticky&&s.originalEvent&&(p=this._map.mouseEventToContainerPoint(s.originalEvent),v=this._map.containerPointToLayerPoint(p),c=this._map.layerPointToLatLng(v)),this._tooltip.setLatLng(c)}});var r1=Ps.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),p=this.options;if(p.html instanceof Element?(Cc(c),c.appendChild(p.html)):c.innerHTML=p.html!==!1?p.html:"",p.bgPos){var v=te(p.bgPos);c.style.backgroundPosition=-v.x+"px "+-v.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function oE(s){return new r1(s)}Ps.Default=Vo;var Wo=zn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ie.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){y(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),zt(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ns(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(As(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof Q?s:new Q(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,p=-s(-1/0,1/0),v=0,T=c.length,N;v<T;v++)N=c[v].style.zIndex,c[v]!==this._container&&N&&(p=s(p,+N));isFinite(p)&&(this.options.zIndex=p+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ie.ielt9){kn(this._container,this.options.opacity);var s=+new Date,c=!1,p=!1;for(var v in this._tiles){var T=this._tiles[v];if(!(!T.current||!T.loaded)){var N=Math.min(1,(s-T.loaded)/200);kn(T.el,N),N<1?c=!0:(T.active?p=!0:this._onOpaqueTile(T),T.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),c&&(Z(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=Qe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===s?(this._levels[p].el.style.zIndex=c-Math.abs(s-p),this._onUpdateLevel(p)):(zt(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var v=this._levels[s],T=this._map;return v||(v=this._levels[s]={},v.el=Qe("div","leaflet-tile-container leaflet-zoom-animated",this._container),v.el.style.zIndex=c,v.origin=T.project(T.unproject(T.getPixelOrigin()),s).round(),v.zoom=s,this._setZoomTransform(v,T.getCenter(),T.getZoom()),m(v.el.offsetWidth),this._onCreateLevel(v)),this._level=v,v}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,c,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var v=c.coords;this._retainParent(v.x,v.y,v.z,v.z-5)||this._retainChildren(v.x,v.y,v.z,v.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)zt(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,p,v){var T=Math.floor(s/2),N=Math.floor(c/2),Y=p-1,ie=new Q(+T,+N);ie.z=+Y;var ce=this._tileCoordsToKey(ie),Ee=this._tiles[ce];return Ee&&Ee.active?(Ee.retain=!0,!0):(Ee&&Ee.loaded&&(Ee.retain=!0),Y>v?this._retainParent(T,N,Y,v):!1)},_retainChildren:function(s,c,p,v){for(var T=2*s;T<2*s+2;T++)for(var N=2*c;N<2*c+2;N++){var Y=new Q(T,N);Y.z=p+1;var ie=this._tileCoordsToKey(Y),ce=this._tiles[ie];if(ce&&ce.active){ce.retain=!0;continue}else ce&&ce.loaded&&(ce.retain=!0);p+1<v&&this._retainChildren(T,N,p+1,v)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,p,v){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var N=this.options.updateWhenZooming&&T!==this._tileZoom;(!v||N)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(s),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var p in this._levels)this._setZoomTransform(this._levels[p],s,c)},_setZoomTransform:function(s,c,p){var v=this._map.getZoomScale(p,s.zoom),T=s.origin.multiplyBy(v).subtract(this._map._getNewPixelOrigin(c,p)).round();Ie.any3d?ji(s.el,T,v):er(s.el,T)},_resetGrid:function(){var s=this._map,c=s.options.crs,p=this._tileSize=this.getTileSize(),v=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],v).x/p.x),Math.ceil(s.project([0,c.wrapLng[1]],v).x/p.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],v).y/p.x),Math.ceil(s.project([c.wrapLat[1],0],v).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,p=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),v=c.getZoomScale(p,this._tileZoom),T=c.project(s,this._tileZoom).floor(),N=c.getSize().divideBy(v*2);return new fe(T.subtract(N),T.add(N))},_update:function(s){var c=this._map;if(c){var p=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var v=this._getTiledPixelBounds(s),T=this._pxBoundsToTileRange(v),N=T.getCenter(),Y=[],ie=this.options.keepBuffer,ce=new fe(T.getBottomLeft().subtract([ie,-ie]),T.getTopRight().add([ie,-ie]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ee in this._tiles){var Re=this._tiles[Ee].coords;(Re.z!==this._tileZoom||!ce.contains(new Q(Re.x,Re.y)))&&(this._tiles[Ee].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(s,p);return}for(var We=T.min.y;We<=T.max.y;We++)for(var ct=T.min.x;ct<=T.max.x;ct++){var Wr=new Q(ct,We);if(Wr.z=this._tileZoom,!!this._isValidTile(Wr)){var pr=this._tiles[this._tileCoordsToKey(Wr)];pr?pr.current=!0:Y.push(Wr)}}if(Y.sort(function(en,Rs){return en.distanceTo(N)-Rs.distanceTo(N)}),Y.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Sn=document.createDocumentFragment();for(ct=0;ct<Y.length;ct++)this._addTile(Y[ct],Sn);this._level.el.appendChild(Sn)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var p=this._globalTileRange;if(!c.wrapLng&&(s.x<p.min.x||s.x>p.max.x)||!c.wrapLat&&(s.y<p.min.y||s.y>p.max.y))return!1}if(!this.options.bounds)return!0;var v=this._tileCoordsToBounds(s);return q(this.options.bounds).overlaps(v)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,p=this.getTileSize(),v=s.scaleBy(p),T=v.add(p),N=c.unproject(v,s.z),Y=c.unproject(T,s.z);return[N,Y]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),p=new ee(c[0],c[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),p=new Q(+c[0],+c[1]);return p.z=+c[2],p},_removeTile:function(s){var c=this._tiles[s];c&&(zt(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){ot(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=m,s.onmousemove=m,Ie.ielt9&&this.options.opacity<1&&kn(s,this.options.opacity)},_addTile:function(s,c){var p=this._getTilePos(s),v=this._tileCoordsToKey(s),T=this.createTile(this._wrapCoords(s),o(this._tileReady,this,s));this._initTile(T),this.createTile.length<2&&B(o(this._tileReady,this,s,null,T)),er(T,p),this._tiles[v]={el:T,coords:s,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:s})},_tileReady:function(s,c,p){c&&this.fire("tileerror",{error:c,tile:p,coords:s});var v=this._tileCoordsToKey(s);p=this._tiles[v],p&&(p.loaded=+new Date,this._map._fadeAnimated?(kn(p.el,0),Z(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),c||(ot(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ie.ielt9||!this._map._fadeAnimated?B(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new Q(this._wrapX?h(s.x,this._wrapX):s.x,this._wrapY?h(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new fe(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function lE(s){return new Wo(s)}var Ms=Wo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=y(this,c),c.detectRetina&&Ie.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var p=document.createElement("img");return et(p,"load",o(this._tileOnLoad,this,c,p)),et(p,"error",o(this._tileOnError,this,c,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(s),p},getTileUrl:function(s){var c={r:Ie.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=p),c["-y"]=p}return S(this._url,a(c,this.options))},_tileOnLoad:function(s,c){Ie.ielt9?setTimeout(o(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,p){var v=this.options.errorTileUrl;v&&c.getAttribute("src")!==v&&(c.src=v),s(p,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,p=this.options.zoomReverse,v=this.options.zoomOffset;return p&&(s=c-s),s+v},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=m,c.onerror=m,!c.complete)){c.src=I;var p=this._tiles[s].coords;zt(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:p})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",I),Wo.prototype._removeTile.call(this,s)},_tileReady:function(s,c,p){if(!(!this._map||p&&p.getAttribute("src")===I))return Wo.prototype._tileReady.call(this,s,c,p)}});function n1(s,c){return new Ms(s,c)}var a1=Ms.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var p=a({},this.defaultWmsParams);for(var v in c)v in this.options||(p[v]=c[v]);c=y(this,c);var T=c.detectRetina&&Ie.retina?2:1,N=this.getTileSize();p.width=N.x*T,p.height=N.y*T,this.wmsParams=p},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Ms.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),p=this._crs,v=F(p.project(c[0]),p.project(c[1])),T=v.min,N=v.max,Y=(this._wmsVersion>=1.3&&this._crs===Ym?[T.y,T.x,N.y,N.x]:[T.x,T.y,N.x,N.y]).join(","),ie=Ms.prototype.getTileUrl.call(this,s);return ie+E(this.wmsParams,ie,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Y},setParams:function(s,c){return a(this.wmsParams,s),c||this.redraw(),this}});function cE(s,c){return new a1(s,c)}Ms.WMS=a1,n1.wms=cE;var Pa=zn.extend({options:{padding:.1},initialize:function(s){y(this,s),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var p=this._map.getZoomScale(c,this._zoom),v=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),N=v.multiplyBy(-p).add(T).subtract(this._map._getNewPixelOrigin(s,c));Ie.any3d?ji(this._container,N,p):er(this._container,N)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),p=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new fe(p,p.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),i1=Pa.extend({options:{tolerance:0},getEvents:function(){var s=Pa.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Pa.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");et(s,"mousemove",this._onMouseMove,this),et(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),et(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){Z(this._redrawRequest),delete this._ctx,zt(this._container),At(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pa.prototype._update.call(this);var s=this._bounds,c=this._container,p=s.getSize(),v=Ie.retina?2:1;er(c,s.min),c.width=v*p.x,c.height=v*p.y,c.style.width=p.x+"px",c.style.height=p.y+"px",Ie.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Pa.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[u(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,p=c.next,v=c.prev;p?p.prev=v:this._drawLast=v,v?v.next=p:this._drawFirst=p,delete s._order,delete this._layers[u(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),p=[],v,T;for(T=0;T<c.length;T++){if(v=Number(c[T]),isNaN(v))return;p.push(v)}s.options._dashArray=p}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||B(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new fe,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var p=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var v=this._drawFirst;v;v=v.next)s=v.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var p,v,T,N,Y=s._parts,ie=Y.length,ce=this._ctx;if(ie){for(ce.beginPath(),p=0;p<ie;p++){for(v=0,T=Y[p].length;v<T;v++)N=Y[p][v],ce[v?"lineTo":"moveTo"](N.x,N.y);c&&ce.closePath()}this._fillStroke(ce,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,p=this._ctx,v=Math.max(Math.round(s._radius),1),T=(Math.max(Math.round(s._radiusY),1)||v)/v;T!==1&&(p.save(),p.scale(1,T)),p.beginPath(),p.arc(c.x,c.y/T,v,0,Math.PI*2,!1),T!==1&&p.restore(),this._fillStroke(p,s)}},_fillStroke:function(s,c){var p=c.options;p.fill&&(s.globalAlpha=p.fillOpacity,s.fillStyle=p.fillColor||p.color,s.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=p.opacity,s.lineWidth=p.weight,s.strokeStyle=p.color,s.lineCap=p.lineCap,s.lineJoin=p.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),p,v,T=this._drawFirst;T;T=T.next)p=T.layer,p.options.interactive&&p._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(p))&&(v=p);this._fireEvent(v?[v]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(Yt(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var p,v,T=this._drawFirst;T;T=T.next)p=T.layer,p.options.interactive&&p._containsPoint(c)&&(v=p);v!==this._hoveredLayer&&(this._handleMouseOut(s),v&&(ot(this._container,"leaflet-interactive"),this._fireEvent([v],s,"mouseover"),this._hoveredLayer=v)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,p){this._map._fireDOMEvent(c,p||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var p=c.next,v=c.prev;if(p)p.prev=v;else return;v?v.next=p:p&&(this._drawFirst=p),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var p=c.next,v=c.prev;if(v)v.next=p;else return;p?p.prev=v:v&&(this._drawLast=v),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function s1(s){return Ie.canvas?new i1(s):null}var $o=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),uE={_initContainer:function(){this._container=Qe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Pa.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=$o("shape");ot(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=$o("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;zt(c),s.removeInteractiveTarget(c),delete this._layers[u(s)]},_updateStyle:function(s){var c=s._stroke,p=s._fill,v=s.options,T=s._container;T.stroked=!!v.stroke,T.filled=!!v.fill,v.stroke?(c||(c=s._stroke=$o("stroke")),T.appendChild(c),c.weight=v.weight+"px",c.color=v.color,c.opacity=v.opacity,v.dashArray?c.dashStyle=w(v.dashArray)?v.dashArray.join(" "):v.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=v.lineCap.replace("butt","flat"),c.joinstyle=v.lineJoin):c&&(T.removeChild(c),s._stroke=null),v.fill?(p||(p=s._fill=$o("fill")),T.appendChild(p),p.color=v.fillColor||v.color,p.opacity=v.fillOpacity):p&&(T.removeChild(p),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),p=Math.round(s._radius),v=Math.round(s._radiusY||p);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+p+","+v+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){Ns(s._container)},_bringToBack:function(s){As(s._container)}},Uc=Ie.vml?$o:me,Go=Pa.extend({_initContainer:function(){this._container=Uc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Uc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){zt(this._container),At(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pa.prototype._update.call(this);var s=this._bounds,c=s.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,p.setAttribute("width",c.x),p.setAttribute("height",c.y)),er(p,s.min),p.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=Uc("path");s.options.className&&ot(c,s.options.className),s.options.interactive&&ot(c,"leaflet-interactive"),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){zt(s._path),s.removeInteractiveTarget(s._path),delete this._layers[u(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,p=s.options;c&&(p.stroke?(c.setAttribute("stroke",p.color),c.setAttribute("stroke-opacity",p.opacity),c.setAttribute("stroke-width",p.weight),c.setAttribute("stroke-linecap",p.lineCap),c.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?c.setAttribute("stroke-dasharray",p.dashArray):c.removeAttribute("stroke-dasharray"),p.dashOffset?c.setAttribute("stroke-dashoffset",p.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),p.fill?(c.setAttribute("fill",p.fillColor||p.color),c.setAttribute("fill-opacity",p.fillOpacity),c.setAttribute("fill-rule",p.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,Se(s._parts,c))},_updateCircle:function(s){var c=s._point,p=Math.max(Math.round(s._radius),1),v=Math.max(Math.round(s._radiusY),1)||p,T="a"+p+","+v+" 0 1,0 ",N=s._empty()?"M0 0":"M"+(c.x-p)+","+c.y+T+p*2+",0 "+T+-p*2+",0 ";this._setPath(s,N)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){Ns(s._path)},_bringToBack:function(s){As(s._path)}});Ie.vml&&Go.include(uE);function o1(s){return Ie.svg||Ie.vml?new Go(s):null}mt.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&s1(s)||o1(s)}});var l1=Fs.extend({initialize:function(s,c){Fs.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=q(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function fE(s,c){return new l1(s,c)}Go.create=Uc,Go.pointsToPath=Se,La.geometryToLayer=Mc,La.coordsToLatLng=C0,La.coordsToLatLngs=Rc,La.latLngToCoords=b0,La.latLngsToCoords=Dc,La.getFeature=Os,La.asFeature=Ic,mt.mergeOptions({boxZoom:!0});var c1=oa.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){et(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){At(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){zt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Io(),c0(),this._startPoint=this._map.mouseEventToContainerPoint(s),et(document,{contextmenu:Ui,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Qe("div","leaflet-zoom-box",this._container),ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new fe(this._point,this._startPoint),p=c.getSize();er(this._box,c.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(zt(this._box),Yt(this._container,"leaflet-crosshair")),jo(),u0(),At(document,{contextmenu:Ui,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});mt.addInitHook("addHandler","boxZoom",c1),mt.mergeOptions({doubleClickZoom:!0});var u1=oa.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,p=c.getZoom(),v=c.options.zoomDelta,T=s.originalEvent.shiftKey?p-v:p+v;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(s.containerPoint,T)}});mt.addInitHook("addHandler","doubleClickZoom",u1),mt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var f1=oa.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new ri(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Yt(this._map._container,"leaflet-grab"),Yt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=q(this._map.options.maxBounds);this._offsetLimit=F(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),p=this._initialWorldOffset,v=this._draggable._newPos.x,T=(v-c+p)%s+c-p,N=(v+c+p)%s-c-p,Y=Math.abs(T+p)<Math.abs(N+p)?T:N;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Y},_onDragEnd:function(s){var c=this._map,p=c.options,v=!p.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),v)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),N=(this._lastTime-this._times[0])/1e3,Y=p.easeLinearity,ie=T.multiplyBy(Y/N),ce=ie.distanceTo([0,0]),Ee=Math.min(p.inertiaMaxSpeed,ce),Re=ie.multiplyBy(Ee/ce),We=Ee/(p.inertiaDeceleration*Y),ct=Re.multiplyBy(-We/2).round();!ct.x&&!ct.y?c.fire("moveend"):(ct=c._limitOffset(ct,c.options.maxBounds),B(function(){c.panBy(ct,{duration:We,easeLinearity:Y,noMoveStart:!0,animate:!0})}))}}});mt.addInitHook("addHandler","dragging",f1),mt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var d1=oa.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),et(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),At(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,p=s.scrollTop||c.scrollTop,v=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(v,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},p=this.keyCodes,v,T;for(v=0,T=p.left.length;v<T;v++)c[p.left[v]]=[-1*s,0];for(v=0,T=p.right.length;v<T;v++)c[p.right[v]]=[s,0];for(v=0,T=p.down.length;v<T;v++)c[p.down[v]]=[0,s];for(v=0,T=p.up.length;v<T;v++)c[p.up[v]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},p=this.keyCodes,v,T;for(v=0,T=p.zoomIn.length;v<T;v++)c[p.zoomIn[v]]=s;for(v=0,T=p.zoomOut.length;v<T;v++)c[p.zoomOut[v]]=-s},_addHooks:function(){et(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){At(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,p=this._map,v;if(c in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(v=this._panKeys[c],s.shiftKey&&(v=te(v).multiplyBy(3)),p.options.maxBounds&&(v=p._limitOffset(te(v),p.options.maxBounds)),p.options.worldCopyJump){var T=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(v)));p.panTo(T)}else p.panBy(v)}else if(c in this._zoomKeys)p.setZoom(p.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Ui(s)}}});mt.addInitHook("addHandler","keyboard",d1),mt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var h1=oa.extend({addHooks:function(){et(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){At(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=Im(s),p=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var v=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),v),Ui(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),p=this._map.options.zoomSnap||0;s._stop();var v=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(v))))/Math.LN2,N=p?Math.ceil(T/p)*p:T,Y=s._limitZoom(c+(this._delta>0?N:-N))-c;this._delta=0,this._startTime=null,Y&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+Y):s.setZoomAround(this._lastMousePos,c+Y))}});mt.addInitHook("addHandler","scrollWheelZoom",h1);var dE=600;mt.mergeOptions({tapHold:Ie.touchNative&&Ie.safari&&Ie.mobile,tapTolerance:15});var p1=oa.extend({addHooks:function(){et(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){At(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new Q(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(et(document,"touchend",_r),et(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),dE),et(document,"touchend touchcancel contextmenu",this._cancel,this),et(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){At(document,"touchend",_r),At(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),At(document,"touchend touchcancel contextmenu",this._cancel,this),At(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new Q(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var p=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});p._simulated=!0,c.target.dispatchEvent(p)}});mt.addInitHook("addHandler","tapHold",p1),mt.mergeOptions({touchZoom:Ie.touch,bounceAtZoomLimits:!0});var m1=oa.extend({addHooks:function(){ot(this._map._container,"leaflet-touch-zoom"),et(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Yt(this._map._container,"leaflet-touch-zoom"),At(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var p=c.mouseEventToContainerPoint(s.touches[0]),v=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(p.add(v)._divideBy(2))),this._startDist=p.distanceTo(v),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),et(document,"touchmove",this._onTouchMove,this),et(document,"touchend touchcancel",this._onTouchEnd,this),_r(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,p=c.mouseEventToContainerPoint(s.touches[0]),v=c.mouseEventToContainerPoint(s.touches[1]),T=p.distanceTo(v)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var N=p._add(v)._divideBy(2)._subtract(this._centerPoint);if(T===1&&N.x===0&&N.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(N),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),Z(this._animRequest);var Y=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=B(Y,this,!0),_r(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Z(this._animRequest),At(document,"touchmove",this._onTouchMove,this),At(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});mt.addInitHook("addHandler","touchZoom",m1),mt.BoxZoom=c1,mt.DoubleClickZoom=u1,mt.Drag=f1,mt.Keyboard=d1,mt.ScrollWheelZoom=h1,mt.TapHold=p1,mt.TouchZoom=m1,r.Bounds=fe,r.Browser=Ie,r.CRS=ke,r.Canvas=i1,r.Circle=T0,r.CircleMarker=Oc,r.Class=ve,r.Control=Bn,r.DivIcon=r1,r.DivOverlay=la,r.DomEvent=Lk,r.DomUtil=Nk,r.Draggable=ri,r.Evented=J,r.FeatureGroup=Na,r.GeoJSON=La,r.GridLayer=Wo,r.Handler=oa,r.Icon=Ps,r.ImageOverlay=jc,r.LatLng=X,r.LatLngBounds=ee,r.Layer=zn,r.LayerGroup=Ls,r.LineUtil=Vk,r.Map=mt,r.Marker=Fc,r.Mixin=Ik,r.Path=ni,r.Point=Q,r.PolyUtil=jk,r.Polygon=Fs,r.Polyline=Aa,r.Popup=Bc,r.PosAnimation=jm,r.Projection=Wk,r.Rectangle=l1,r.Renderer=Pa,r.SVG=Go,r.SVGOverlay=t1,r.TileLayer=Ms,r.Tooltip=zc,r.Transformation=Be,r.Util=K,r.VideoOverlay=e1,r.bind=o,r.bounds=F,r.canvas=s1,r.circle=Jk,r.circleMarker=Kk,r.control=Uo,r.divIcon=oE,r.extend=a,r.featureGroup=Xk,r.geoJSON=Qm,r.geoJson=tE,r.gridLayer=lE,r.icon=qk,r.imageOverlay=rE,r.latLng=ae,r.latLngBounds=q,r.layerGroup=Zk,r.map=Pk,r.marker=Yk,r.point=te,r.polygon=eE,r.polyline=Qk,r.popup=iE,r.rectangle=fE,r.setOptions=y,r.stamp=u,r.svg=o1,r.svgOverlay=aE,r.tileLayer=n1,r.tooltip=sE,r.transformation=G,r.version=n,r.videoOverlay=nE;var hE=window.L;r.noConflict=function(){return window.L=hE,this},window.L=r})})(jh,jh.exports);var Ta=jh.exports;const Er=dv(Ta);function ak(e){return e.split(" ").filter(Boolean)}function ik(e,t){ak(t).forEach(r=>{Ta.DomUtil.addClass(e,r)})}function sk(e,t){ak(t).forEach(r=>{Ta.DomUtil.removeClass(e,r)})}function bM(e,t,r){e!=null&&r!==t&&(t!=null&&t.length>0&&sk(e,t),r!=null&&r.length>0&&ik(e,r))}function Ro(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Do(e,t){return t==null?function(n,a){const i=C.useRef();return i.current||(i.current=e(n,a)),i}:function(n,a){const i=C.useRef();i.current||(i.current=e(n,a));const o=C.useRef(n),{instance:l}=i.current;return C.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,a]),i}}function Am(e,t){C.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var i;(i=t.layerContainer)==null||i.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Lm(e){return function(r){const n=Sc(),a=e(Tc(r,n),n);return Em(n.map,r.attribution),a0(a.current,r.eventHandlers),Am(a.current,n),a}}function ok(e,t){const r=C.useRef();C.useEffect(function(){if(t.pathOptions!==r.current){const a=t.pathOptions??{};e.instance.setStyle(a),r.current=a}},[e,t])}function lk(e){return function(r){const n=Sc(),a=e(Tc(r,n),n);return a0(a.current,r.eventHandlers),Am(a.current,n),ok(a.current,r),a}}function NM(e){function t(a,i){return Ro(e(a),i)}const r=Do(t),n=rk(r);return Nm(n)}function ck(e,t){const r=Do(e,t),n=Lm(r);return bm(n)}function uk(e,t){const r=Do(e),n=nk(r,t);return tk(n)}function fk(e,t){const r=Do(e,t),n=lk(r);return bm(n)}function dk(e,t){const r=Do(e,t),n=Lm(r);return Nm(n)}function hk(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function AM(e,t,r){t.bounds instanceof Ta.LatLngBounds&&t.bounds!==r.bounds&&e.setBounds(t.bounds),t.opacity!=null&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),t.zIndex!=null&&t.zIndex!==r.zIndex&&e.setZIndex(t.zIndex)}const LM=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_VERSION:Qw,LeafletContext:Tm,LeafletProvider:Cm,addClassName:ik,createContainerComponent:bm,createControlComponent:NM,createControlHook:rk,createDivOverlayComponent:tk,createDivOverlayHook:nk,createElementHook:Do,createElementObject:Ro,createLayerComponent:ck,createLayerHook:Lm,createLeafComponent:Nm,createLeafletContext:ek,createOverlayComponent:uk,createPathComponent:fk,createPathHook:lk,createTileLayerComponent:dk,extendContext:Sm,removeClassName:sk,updateCircle:CM,updateClassName:bM,updateGridLayer:hk,updateMediaOverlay:AM,useAttribution:Em,useEventHandlers:a0,useLayerLifecycle:Am,useLeafletContext:Sc,usePathOptions:ok,withPane:Tc},Symbol.toStringTag,{value:"Module"})),PM=fk(function({data:t,...r},n){const a=new Ta.GeoJSON(t,r);return Ro(a,Sm(n,{overlayContainer:a}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function Bh(){return Bh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bh.apply(this,arguments)}function FM({bounds:e,boundsOptions:t,center:r,children:n,className:a,id:i,placeholder:o,style:l,whenReady:u,zoom:f,...h},m){const[g]=C.useState({className:a,id:i,style:l}),[x,_]=C.useState(null);C.useImperativeHandle(m,()=>(x==null?void 0:x.map)??null,[x]);const y=C.useCallback(k=>{if(k!==null&&x===null){const S=new Ta.Map(k,h);r!=null&&f!=null?S.setView(r,f):e!=null&&S.fitBounds(e,t),u!=null&&S.whenReady(u),_(ek(S))}},[]);C.useEffect(()=>()=>{x==null||x.map.remove()},[x]);const E=x?os.createElement(Cm,{value:x},n):o??null;return os.createElement("div",Bh({},g,{ref:y}),E)}const pk=C.forwardRef(FM),mk=ck(function({position:t,...r},n){const a=new Ta.Marker(t,r);return Ro(a,Sm(n,{overlayContainer:a}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),gk=uk(function(t,r){const n=new Ta.Popup(t,r.overlayContainer);return Ro(n,r)},function(t,r,{position:n},a){C.useEffect(function(){const{instance:o}=t;function l(f){f.popup===o&&(o.update(),a(!0))}function u(f){f.popup===o&&a(!1)}return r.map.on({popupopen:l,popupclose:u}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var h;r.map.off({popupopen:l,popupclose:u}),(h=r.overlayContainer)==null||h.unbindPopup(),r.map.removeLayer(o)}},[t,r,a,n])}),xk=dk(function({url:t,...r},n){const a=new Ta.TileLayer(t,Tc(r,n));return Ro(a,n)},function(t,r,n){hk(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)}),vk=C.createContext({token:null,setToken:()=>{},isAuthenticated:!1,user:null,setUser:()=>{}}),Pm=()=>C.useContext(vk),OM=({children:e})=>{const[t,r]=C.useState(localStorage.getItem("token")),[n,a]=C.useState(null),i=!!t;return d.jsx(vk.Provider,{value:{token:t,setToken:r,isAuthenticated:i,user:n,setUser:a},children:e})};var _k={};const MM=Nf(LM);var rv={exports:{}};(function(e,t){(function(r,n){n(t)})(bi,function(r){var n=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(i){L.Util.setOptions(this,i),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var o=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,o?this._withAnimation:this._noAnimation),this._markerCluster=o?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(i){if(i instanceof L.LayerGroup)return this.addLayers([i]);if(!i.getLatLng)return this._nonPointGroup.addLayer(i),this.fire("layeradd",{layer:i}),this;if(!this._map)return this._needsClustering.push(i),this.fire("layeradd",{layer:i}),this;if(this.hasLayer(i))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(i,this._maxZoom),this.fire("layeradd",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var o=i,l=this._zoom;if(i.__parent)for(;o.__parent._zoom>=l;)o=o.__parent;return this._currentShownBounds.contains(o.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(i,o):this._animationAddLayerNonAnimated(i,o)),this},removeLayer:function(i){return i instanceof L.LayerGroup?this.removeLayers([i]):i.getLatLng?this._map?i.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(i)),this._removeLayer(i,!0),this.fire("layerremove",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),i.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(i)&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,i)&&this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}),this):(this._nonPointGroup.removeLayer(i),this.fire("layerremove",{layer:i}),this)},addLayers:function(i,o){if(!L.Util.isArray(i))return this.addLayer(i);var l=this._featureGroup,u=this._nonPointGroup,f=this.options.chunkedLoading,h=this.options.chunkInterval,m=this.options.chunkProgress,g=i.length,x=0,_=!0,y;if(this._map){var E=new Date().getTime(),k=L.bind(function(){var w=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();x<g;x++){if(f&&x%200===0){var A=new Date().getTime()-w;if(A>h)break}if(y=i[x],y instanceof L.LayerGroup){_&&(i=i.slice(),_=!1),this._extractNonGroupLayers(y,i),g=i.length;continue}if(!y.getLatLng){u.addLayer(y),o||this.fire("layeradd",{layer:y});continue}if(!this.hasLayer(y)&&(this._addLayer(y,this._maxZoom),o||this.fire("layeradd",{layer:y}),y.__parent&&y.__parent.getChildCount()===2)){var I=y.__parent.getAllChildMarkers(),D=I[0]===y?I[1]:I[0];l.removeLayer(D)}}m&&m(x,g,new Date().getTime()-E),x===g?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(k,this.options.chunkDelay)},this);k()}else for(var S=this._needsClustering;x<g;x++){if(y=i[x],y instanceof L.LayerGroup){_&&(i=i.slice(),_=!1),this._extractNonGroupLayers(y,i),g=i.length;continue}if(!y.getLatLng){u.addLayer(y);continue}this.hasLayer(y)||S.push(y)}return this},removeLayers:function(i){var o,l,u=i.length,f=this._featureGroup,h=this._nonPointGroup,m=!0;if(!this._map){for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}this._arraySplice(this._needsClustering,l),h.removeLayer(l),this.hasLayer(l)&&this._needsRemoving.push({layer:l,latlng:l._latlng}),this.fire("layerremove",{layer:l})}return this}if(this._unspiderfy){this._unspiderfy();var g=i.slice(),x=u;for(o=0;o<x;o++){if(l=g[o],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,g),x=g.length;continue}this._unspiderfyLayer(l)}}for(o=0;o<u;o++){if(l=i[o],l instanceof L.LayerGroup){m&&(i=i.slice(),m=!1),this._extractNonGroupLayers(l,i),u=i.length;continue}if(!l.__parent){h.removeLayer(l),this.fire("layerremove",{layer:l});continue}this._removeLayer(l,!0,!0),this.fire("layerremove",{layer:l}),f.hasLayer(l)&&(f.removeLayer(l),l.clusterShow&&l.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(i){i.off(this._childMarkerEventHandlers,this),delete i.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var i=new L.LatLngBounds;this._topClusterLevel&&i.extend(this._topClusterLevel._bounds);for(var o=this._needsClustering.length-1;o>=0;o--)i.extend(this._needsClustering[o].getLatLng());return i.extend(this._nonPointGroup.getBounds()),i},eachLayer:function(i,o){var l=this._needsClustering.slice(),u=this._needsRemoving,f,h,m;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(l),h=l.length-1;h>=0;h--){for(f=!0,m=u.length-1;m>=0;m--)if(u[m].layer===l[h]){f=!1;break}f&&i.call(o,l[h])}this._nonPointGroup.eachLayer(i,o)},getLayers:function(){var i=[];return this.eachLayer(function(o){i.push(o)}),i},getLayer:function(i){var o=null;return i=parseInt(i,10),this.eachLayer(function(l){L.stamp(l)===i&&(o=l)}),o},hasLayer:function(i){if(!i)return!1;var o,l=this._needsClustering;for(o=l.length-1;o>=0;o--)if(l[o]===i)return!0;for(l=this._needsRemoving,o=l.length-1;o>=0;o--)if(l[o].layer===i)return!1;return!!(i.__parent&&i.__parent._group===this)||this._nonPointGroup.hasLayer(i)},zoomToShowLayer:function(i,o){var l=this._map;typeof o!="function"&&(o=function(){});var u=function(){(l.hasLayer(i)||l.hasLayer(i.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),l.hasLayer(i)?o():i.__parent._icon&&(this.once("spiderfied",o,this),i.__parent.spiderfy()))};i._icon&&this._map.getBounds().contains(i.getLatLng())?o():i.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(i.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),i.__parent.zoomToBounds())},onAdd:function(i){this._map=i;var o,l,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(i),this._nonPointGroup.addTo(i),this._gridClusters||this._generateInitialClusters(),this._maxLat=i.options.crs.projection.MAX_LATITUDE,o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(o=0,l=this._needsRemoving.length;o<l;o++)u=this._needsRemoving[o],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),l=this._needsClustering,this._needsClustering=[],this.addLayers(l,!0)},onRemove:function(i){i.off("zoomend",this._zoomEnd,this),i.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(i){for(var o=i;o&&!o._icon;)o=o.__parent;return o||null},_arraySplice:function(i,o){for(var l=i.length-1;l>=0;l--)if(i[l]===o)return i.splice(l,1),!0},_removeFromGridUnclustered:function(i,o){for(var l=this._map,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());o>=f&&u[o].removeObject(i,l.project(i.getLatLng(),o));o--);},_childMarkerDragStart:function(i){i.target.__dragStart=i.target._latlng},_childMarkerMoved:function(i){if(!this._ignoreMove&&!i.target.__dragStart){var o=i.target._popup&&i.target._popup.isOpen();this._moveChild(i.target,i.oldLatLng,i.latlng),o&&i.target.openPopup()}},_moveChild:function(i,o,l){i._latlng=o,this.removeLayer(i),i._latlng=l,this.addLayer(i)},_childMarkerDragEnd:function(i){var o=i.target.__dragStart;delete i.target.__dragStart,o&&this._moveChild(i.target,o,i.target._latlng)},_removeLayer:function(i,o,l){var u=this._gridClusters,f=this._gridUnclustered,h=this._featureGroup,m=this._map,g=Math.floor(this._map.getMinZoom());o&&this._removeFromGridUnclustered(i,this._maxZoom);var x=i.__parent,_=x._markers,y;for(this._arraySplice(_,i);x&&(x._childCount--,x._boundsNeedUpdate=!0,!(x._zoom<g));)o&&x._childCount<=1?(y=x._markers[0]===i?x._markers[1]:x._markers[0],u[x._zoom].removeObject(x,m.project(x._cLatLng,x._zoom)),f[x._zoom].addObject(y,m.project(y.getLatLng(),x._zoom)),this._arraySplice(x.__parent._childClusters,x),x.__parent._markers.push(y),y.__parent=x.__parent,x._icon&&(h.removeLayer(x),l||h.addLayer(y))):x._iconNeedsUpdate=!0,x=x.__parent;delete i.__parent},_isOrIsParent:function(i,o){for(;o;){if(i===o)return!0;o=o.parentNode}return!1},fire:function(i,o,l){if(o&&o.layer instanceof L.MarkerCluster){if(o.originalEvent&&this._isOrIsParent(o.layer._icon,o.originalEvent.relatedTarget))return;i="cluster"+i}L.FeatureGroup.prototype.fire.call(this,i,o,l)},listens:function(i,o){return L.FeatureGroup.prototype.listens.call(this,i,o)||L.FeatureGroup.prototype.listens.call(this,"cluster"+i,o)},_defaultIconCreateFunction:function(i){var o=i.getChildCount(),l=" marker-cluster-";return o<10?l+="small":o<100?l+="medium":l+="large",new L.DivIcon({html:"<div><span>"+o+"</span></div>",className:"marker-cluster"+l,iconSize:new L.Point(40,40)})},_bindEvents:function(){var i=this._map,o=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(o||u||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),i.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(i){var o=i.layer,l=o;if(!(i.type==="clusterkeypress"&&i.originalEvent&&i.originalEvent.keyCode!==13)){for(;l._childClusters.length===1;)l=l._childClusters[0];l._zoom===this._maxZoom&&l._childCount===o._childCount&&this.options.spiderfyOnMaxZoom?o.spiderfy():this.options.zoomToBoundsOnClick&&o.zoomToBounds(),this.options.spiderfyOnEveryZoom&&o.spiderfy(),i.originalEvent&&i.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(i){var o=this._map;this._inZoomAnimation||(this._shownPolygon&&o.removeLayer(this._shownPolygon),i.layer.getChildCount()>2&&i.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(i.layer.getConvexHull(),this.options.polygonOptions),o.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var i=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,f=this._map;(i||l||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var i=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,i),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),i),this._currentShownBounds=i}},_generateInitialClusters:function(){var i=Math.ceil(this._map.getMaxZoom()),o=Math.floor(this._map.getMinZoom()),l=this.options.maxClusterRadius,u=l;typeof l!="function"&&(u=function(){return l}),this.options.disableClusteringAtZoom!==null&&(i=this.options.disableClusteringAtZoom-1),this._maxZoom=i,this._gridClusters={},this._gridUnclustered={};for(var f=i;f>=o;f--)this._gridClusters[f]=new L.DistanceGrid(u(f)),this._gridUnclustered[f]=new L.DistanceGrid(u(f));this._topClusterLevel=new this._markerCluster(this,o-1)},_addLayer:function(i,o){var l=this._gridClusters,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),h,m;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(i),i.on(this._childMarkerEventHandlers,this);o>=f;o--){h=this._map.project(i.getLatLng(),o);var g=l[o].getNearObject(h);if(g){g._addChild(i),i.__parent=g;return}if(g=u[o].getNearObject(h),g){var x=g.__parent;x&&this._removeLayer(g,!1);var _=new this._markerCluster(this,o,g,i);l[o].addObject(_,this._map.project(_._cLatLng,o)),g.__parent=_,i.__parent=_;var y=_;for(m=o-1;m>x._zoom;m--)y=new this._markerCluster(this,m,y),l[m].addObject(y,this._map.project(g.getLatLng(),m));x._addChild(y),this._removeFromGridUnclustered(g,o);return}u[o].addObject(i,h)}this._topClusterLevel._addChild(i),i.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(i){i instanceof L.MarkerCluster&&i._iconNeedsUpdate&&i._updateIcon()})},_enqueue:function(i){this._queue.push(i),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var i=0;i<this._queue.length;i++)this._queue[i].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var i=Math.round(this._map._zoom);this._processQueue(),this._zoom<i&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,i)):this._zoom>i?(this._animationStart(),this._animationZoomOut(this._zoom,i)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(i){var o=this._maxLat;return o!==void 0&&(i.getNorth()>=o&&(i._northEast.lat=1/0),i.getSouth()<=-o&&(i._southWest.lat=-1/0)),i},_animationAddLayerNonAnimated:function(i,o){if(o===i)this._featureGroup.addLayer(i);else if(o._childCount===2){o._addToMap();var l=o.getAllChildMarkers();this._featureGroup.removeLayer(l[0]),this._featureGroup.removeLayer(l[1])}else o._updateIcon()},_extractNonGroupLayers:function(i,o){var l=i.getLayers(),u=0,f;for(o=o||[];u<l.length;u++){if(f=l[u],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,o);continue}o.push(f)}return o},_overrideMarkerIcon:function(i){var o=i.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[i]}});return o}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(i,o){this._animationAddLayerNonAnimated(i,o)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(i,o){var l=this._getExpandedVisibleBounds(),u=this._featureGroup,f=Math.floor(this._map.getMinZoom()),h;this._ignoreMove=!0,this._topClusterLevel._recursively(l,i,f,function(m){var g=m._latlng,x=m._markers,_;for(l.contains(g)||(g=null),m._isSingleParent()&&i+1===o?(u.removeLayer(m),m._recursivelyAddChildrenToMap(null,o,l)):(m.clusterHide(),m._recursivelyAddChildrenToMap(g,o,l)),h=x.length-1;h>=0;h--)_=x[h],l.contains(_._latlng)||u.removeLayer(_)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(l,o),u.eachLayer(function(m){!(m instanceof L.MarkerCluster)&&m._icon&&m.clusterShow()}),this._topClusterLevel._recursively(l,i,o,function(m){m._recursivelyRestoreChildPositions(o)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(l,i,f,function(m){u.removeLayer(m),m.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(i,o){this._animationZoomOutSingle(this._topClusterLevel,i-1,o),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i,this._getExpandedVisibleBounds())},_animationAddLayer:function(i,o){var l=this,u=this._featureGroup;u.addLayer(i),o!==i&&(o._childCount>2?(o._updateIcon(),this._forceLayout(),this._animationStart(),i._setPos(this._map.latLngToLayerPoint(o.getLatLng())),i.clusterHide(),this._enqueue(function(){u.removeLayer(i),i.clusterShow(),l._animationEnd()})):(this._forceLayout(),l._animationStart(),l._animationZoomOutSingle(o,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(i,o,l){var u=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());i._recursivelyAnimateChildrenInAndAddSelfToMap(u,f,o+1,l);var h=this;this._forceLayout(),i._recursivelyBecomeVisible(u,l),this._enqueue(function(){if(i._childCount===1){var m=i._markers[0];this._ignoreMove=!0,m.setLatLng(m.getLatLng()),this._ignoreMove=!1,m.clusterShow&&m.clusterShow()}else i._recursively(u,l,f,function(g){g._recursivelyRemoveChildrenFromMap(u,f,o+1)});h._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(i){return new L.MarkerClusterGroup(i)};var a=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(i,o,l,u){L.Marker.prototype.initialize.call(this,l?l._cLatLng||l.getLatLng():new L.LatLng(0,0),{icon:this,pane:i.options.clusterPane}),this._group=i,this._zoom=o,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,l&&this._addChild(l),u&&this._addChild(u)},getAllChildMarkers:function(i,o){i=i||[];for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l].getAllChildMarkers(i,o);for(var u=this._markers.length-1;u>=0;u--)o&&this._markers[u].__dragStart||i.push(this._markers[u]);return i},getChildCount:function(){return this._childCount},zoomToBounds:function(i){for(var o=this._childClusters.slice(),l=this._group._map,u=l.getBoundsZoom(this._bounds),f=this._zoom+1,h=l.getZoom(),m;o.length>0&&u>f;){f++;var g=[];for(m=0;m<o.length;m++)g=g.concat(o[m]._childClusters);o=g}u>f?this._group._map.setView(this._latlng,f):u<=h?this._group._map.setView(this._latlng,h+1):this._group._map.fitBounds(this._bounds,i)},getBounds:function(){var i=new L.LatLngBounds;return i.extend(this._bounds),i},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(i,o){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(i),i instanceof L.MarkerCluster?(o||(this._childClusters.push(i),i.__parent=this),this._childCount+=i._childCount):(o||this._markers.push(i),this._childCount++),this.__parent&&this.__parent._addChild(i,!0)},_setClusterCenter:function(i){this._cLatLng||(this._cLatLng=i._cLatLng||i._latlng)},_resetBounds:function(){var i=this._bounds;i._southWest&&(i._southWest.lat=1/0,i._southWest.lng=1/0),i._northEast&&(i._northEast.lat=-1/0,i._northEast.lng=-1/0)},_recalculateBounds:function(){var i=this._markers,o=this._childClusters,l=0,u=0,f=this._childCount,h,m,g,x;if(f!==0){for(this._resetBounds(),h=0;h<i.length;h++)g=i[h]._latlng,this._bounds.extend(g),l+=g.lat,u+=g.lng;for(h=0;h<o.length;h++)m=o[h],m._boundsNeedUpdate&&m._recalculateBounds(),this._bounds.extend(m._bounds),g=m._wLatLng,x=m._childCount,l+=g.lat*x,u+=g.lng*x;this._latlng=this._wLatLng=new L.LatLng(l/f,u/f),this._boundsNeedUpdate=!1}},_addToMap:function(i){i&&(this._backupLatlng=this._latlng,this.setLatLng(i)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(i,o,l){this._recursively(i,this._group._map.getMinZoom(),l-1,function(u){var f=u._markers,h,m;for(h=f.length-1;h>=0;h--)m=f[h],m._icon&&(m._setPos(o),m.clusterHide())},function(u){var f=u._childClusters,h,m;for(h=f.length-1;h>=0;h--)m=f[h],m._icon&&(m._setPos(o),m.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(i,o,l,u){this._recursively(i,u,o,function(f){f._recursivelyAnimateChildrenIn(i,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),l),f._isSingleParent()&&l-1===u?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(i,o,l)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(i,o){this._recursively(i,this._group._map.getMinZoom(),o,null,function(l){l.clusterShow()})},_recursivelyAddChildrenToMap:function(i,o,l){this._recursively(l,this._group._map.getMinZoom()-1,o,function(u){if(o!==u._zoom)for(var f=u._markers.length-1;f>=0;f--){var h=u._markers[f];l.contains(h._latlng)&&(i&&(h._backupLatlng=h.getLatLng(),h.setLatLng(i),h.clusterHide&&h.clusterHide()),u._group._featureGroup.addLayer(h))}},function(u){u._addToMap(i)})},_recursivelyRestoreChildPositions:function(i){for(var o=this._markers.length-1;o>=0;o--){var l=this._markers[o];l._backupLatlng&&(l.setLatLng(l._backupLatlng),delete l._backupLatlng)}if(i-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(i)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(i,o,l,u){var f,h;this._recursively(i,o-1,l-1,function(m){for(h=m._markers.length-1;h>=0;h--)f=m._markers[h],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(m){for(h=m._childClusters.length-1;h>=0;h--)f=m._childClusters[h],(!u||!u.contains(f._latlng))&&(m._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(i,o,l,u,f){var h=this._childClusters,m=this._zoom,g,x;if(o<=m&&(u&&u(this),f&&m===l&&f(this)),m<o||m<l)for(g=h.length-1;g>=0;g--)x=h[g],x._boundsNeedUpdate&&x._recalculateBounds(),i.intersects(x._bounds)&&x._recursively(i,o,l,u,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var i=this.options.opacity;return this.setOpacity(0),this.options.opacity=i,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(i){this._cellSize=i,this._sqCellSize=i*i,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,h=f[u]=f[u]||{},m=h[l]=h[l]||[],g=L.Util.stamp(i);this._objectPoint[g]=o,m.push(i)},updateObject:function(i,o){this.removeObject(i),this.addObject(i,o)},removeObject:function(i,o){var l=this._getCoord(o.x),u=this._getCoord(o.y),f=this._grid,h=f[u]=f[u]||{},m=h[l]=h[l]||[],g,x;for(delete this._objectPoint[L.Util.stamp(i)],g=0,x=m.length;g<x;g++)if(m[g]===i)return m.splice(g,1),x===1&&delete h[l],!0},eachObject:function(i,o){var l,u,f,h,m,g,x,_=this._grid;for(l in _){m=_[l];for(u in m)for(g=m[u],f=0,h=g.length;f<h;f++)x=i.call(o,g[f]),x&&(f--,h--)}},getNearObject:function(i){var o=this._getCoord(i.x),l=this._getCoord(i.y),u,f,h,m,g,x,_,y,E=this._objectPoint,k=this._sqCellSize,S=null;for(u=l-1;u<=l+1;u++)if(m=this._grid[u],m){for(f=o-1;f<=o+1;f++)if(g=m[f],g)for(h=0,x=g.length;h<x;h++)_=g[h],y=this._sqDist(E[L.Util.stamp(_)],i),(y<k||y<=k&&S===null)&&(k=y,S=_)}return S},_getCoord:function(i){var o=Math.floor(i/this._cellSize);return isFinite(o)?o:i},_sqDist:function(i,o){var l=o.x-i.x,u=o.y-i.y;return l*l+u*u}},function(){L.QuickHull={getDistant:function(i,o){var l=o[1].lat-o[0].lat,u=o[0].lng-o[1].lng;return u*(i.lat-o[0].lat)+l*(i.lng-o[0].lng)},findMostDistantPointFromBaseLine:function(i,o){var l=0,u=null,f=[],h,m,g;for(h=o.length-1;h>=0;h--){if(m=o[h],g=this.getDistant(m,i),g>0)f.push(m);else continue;g>l&&(l=g,u=m)}return{maxPoint:u,newPoints:f}},buildConvexHull:function(i,o){var l=[],u=this.findMostDistantPointFromBaseLine(i,o);return u.maxPoint?(l=l.concat(this.buildConvexHull([i[0],u.maxPoint],u.newPoints)),l=l.concat(this.buildConvexHull([u.maxPoint,i[1]],u.newPoints)),l):[i[0]]},getConvexHull:function(i){var o=!1,l=!1,u=!1,f=!1,h=null,m=null,g=null,x=null,_=null,y=null,E;for(E=i.length-1;E>=0;E--){var k=i[E];(o===!1||k.lat>o)&&(h=k,o=k.lat),(l===!1||k.lat<l)&&(m=k,l=k.lat),(u===!1||k.lng>u)&&(g=k,u=k.lng),(f===!1||k.lng<f)&&(x=k,f=k.lng)}l!==o?(y=m,_=h):(y=x,_=g);var S=[].concat(this.buildConvexHull([y,_],i),this.buildConvexHull([_,y],i));return S}}}(),L.MarkerCluster.include({getConvexHull:function(){var i=this.getAllChildMarkers(),o=[],l,u;for(u=i.length-1;u>=0;u--)l=i[u].getLatLng(),o.push(l);return L.QuickHull.getConvexHull(o)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var i=this.getAllChildMarkers(null,!0),o=this._group,l=o._map,u=l.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(i.length,u):i.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(i.length,u):(u.y+=10,f=this._generatePointsCircle(i.length,u)),this._animationSpiderfy(i,f)}},unspiderfy:function(i){this._group._inZoomAnimation||(this._animationUnspiderfy(i),this._group._spiderfied=null)},_generatePointsCircle:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+i),u=l/this._2PI,f=this._2PI/i,h=[],m,g;for(u=Math.max(u,35),h.length=i,m=0;m<i;m++)g=this._circleStartAngle+m*f,h[m]=new L.Point(o.x+u*Math.cos(g),o.y+u*Math.sin(g))._round();return h},_generatePointsSpiral:function(i,o){var l=this._group.options.spiderfyDistanceMultiplier,u=l*this._spiralLengthStart,f=l*this._spiralFootSeparation,h=l*this._spiralLengthFactor*this._2PI,m=0,g=[],x;for(g.length=i,x=i;x>=0;x--)x<i&&(g[x]=new L.Point(o.x+u*Math.cos(m),o.y+u*Math.sin(m))._round()),m+=f/u+x*5e-4,u+=h/m;return g},_noanimationUnspiderfy:function(){var i=this._group,o=i._map,l=i._featureGroup,u=this.getAllChildMarkers(null,!0),f,h;for(i._ignoreMove=!0,this.setOpacity(1),h=u.length-1;h>=0;h--)f=u[h],l.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(o.removeLayer(f._spiderLeg),delete f._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:u}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(i,o){var l=this._group,u=l._map,f=l._featureGroup,h=this._group.options.spiderLegPolylineOptions,m,g,x,_;for(l._ignoreMove=!0,m=0;m<i.length;m++)_=u.layerPointToLatLng(o[m]),g=i[m],x=new L.Polyline([this._latlng,_],h),u.addLayer(x),g._spiderLeg=x,g._preSpiderfyLatlng=g._latlng,g.setLatLng(_),g.setZIndexOffset&&g.setZIndexOffset(1e6),f.addLayer(g);this.setOpacity(.3),l._ignoreMove=!1,l.fire("spiderfied",{cluster:this,markers:i})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(i,o){var l=this,u=this._group,f=u._map,h=u._featureGroup,m=this._latlng,g=f.latLngToLayerPoint(m),x=L.Path.SVG,_=L.extend({},this._group.options.spiderLegPolylineOptions),y=_.opacity,E,k,S,w,A,I;for(y===void 0&&(y=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),x?(_.opacity=0,_.className=(_.className||"")+" leaflet-cluster-spider-leg"):_.opacity=y,u._ignoreMove=!0,E=0;E<i.length;E++)k=i[E],I=f.layerPointToLatLng(o[E]),S=new L.Polyline([m,I],_),f.addLayer(S),k._spiderLeg=S,x&&(w=S._path,A=w.getTotalLength()+.1,w.style.strokeDasharray=A,w.style.strokeDashoffset=A),k.setZIndexOffset&&k.setZIndexOffset(1e6),k.clusterHide&&k.clusterHide(),h.addLayer(k),k._setPos&&k._setPos(g);for(u._forceLayout(),u._animationStart(),E=i.length-1;E>=0;E--)I=f.layerPointToLatLng(o[E]),k=i[E],k._preSpiderfyLatlng=k._latlng,k.setLatLng(I),k.clusterShow&&k.clusterShow(),x&&(S=k._spiderLeg,w=S._path,w.style.strokeDashoffset=0,S.setStyle({opacity:y}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:l,markers:i})},200)},_animationUnspiderfy:function(i){var o=this,l=this._group,u=l._map,f=l._featureGroup,h=i?u._latLngToNewLayerPoint(this._latlng,i.zoom,i.center):u.latLngToLayerPoint(this._latlng),m=this.getAllChildMarkers(null,!0),g=L.Path.SVG,x,_,y,E,k,S;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),_=m.length-1;_>=0;_--)x=m[_],x._preSpiderfyLatlng&&(x.closePopup(),x.setLatLng(x._preSpiderfyLatlng),delete x._preSpiderfyLatlng,S=!0,x._setPos&&(x._setPos(h),S=!1),x.clusterHide&&(x.clusterHide(),S=!1),S&&f.removeLayer(x),g&&(y=x._spiderLeg,E=y._path,k=E.getTotalLength()+.1,E.style.strokeDashoffset=k,y.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var w=0;for(_=m.length-1;_>=0;_--)x=m[_],x._spiderLeg&&w++;for(_=m.length-1;_>=0;_--)x=m[_],x._spiderLeg&&(x.clusterShow&&x.clusterShow(),x.setZIndexOffset&&x.setZIndexOffset(0),w>1&&f.removeLayer(x),u.removeLayer(x._spiderLeg),delete x._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:o,markers:m})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(i){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(i))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(i){this._spiderfied&&this._spiderfied.unspiderfy(i)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(i){i._spiderLeg&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow(),i.setZIndexOffset&&i.setZIndexOffset(0),this._map.removeLayer(i._spiderLeg),delete i._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(i){return i?i instanceof L.MarkerClusterGroup?i=i._topClusterLevel.getAllChildMarkers():i instanceof L.LayerGroup?i=i._layers:i instanceof L.MarkerCluster?i=i.getAllChildMarkers():i instanceof L.Marker&&(i=[i]):i=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(i),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(i),this},_flagParentsIconsNeedUpdate:function(i){var o,l;for(o in i)for(l=i[o].__parent;l;)l._iconNeedsUpdate=!0,l=l.__parent},_refreshSingleMarkerModeMarkers:function(i){var o,l;for(o in i)l=i[o],this.hasLayer(l)&&l.setIcon(this._overrideMarkerIcon(l))}}),L.Marker.include({refreshIconOptions:function(i,o){var l=this.options.icon;return L.setOptions(l,i),this.setIcon(l),o&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),r.MarkerClusterGroup=n,r.MarkerCluster=a,Object.defineProperty(r,"__esModule",{value:!0})})})(rv,rv.exports);const RM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",DM=Object.freeze(Object.defineProperty({__proto__:null,default:RM},Symbol.toStringTag,{value:"Module"})),IM=Nf(DM),jM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",BM=Object.freeze(Object.defineProperty({__proto__:null,default:jM},Symbol.toStringTag,{value:"Module"})),zM=Nf(BM),UM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",HM=Object.freeze(Object.defineProperty({__proto__:null,default:UM},Symbol.toStringTag,{value:"Module"})),VM=Nf(HM);var no=bi&&bi.__assign||function(){return no=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},no.apply(this,arguments)},WM=bi&&bi.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},$M=bi&&bi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_k,"__esModule",{value:!0});var zh=MM,Fm=$M(Ta);delete Fm.default.Icon.Default.prototype._getIconUrl;Fm.default.Icon.Default.mergeOptions({iconRetinaUrl:IM.default,iconUrl:zM.default,shadowUrl:VM.default});function GM(e){var t={},r={};e.children;var n=WM(e,["children"]);return Object.entries(n).forEach(function(a){var i,o,l=a[0],u=a[1];l.startsWith("on")?r=no(no({},r),(i={},i[l]=u,i)):t=no(no({},t),(o={},o[l]=u,o))}),{clusterProps:t,clusterEvents:r}}function ZM(e,t){var r=GM(e),n=r.clusterProps,a=r.clusterEvents,i=new Fm.default.MarkerClusterGroup(n);return Object.entries(a).forEach(function(o){var l=o[0],u=o[1],f="cluster".concat(l.substring(2).toLowerCase());i.on(f,u)}),(0,zh.createElementObject)(i,(0,zh.extendContext)(t,{layerContainer:i}))}var XM=function(e,t,r){},qM=(0,zh.createPathComponent)(ZM,XM),yk=_k.default=qM;const nv=(e,t)=>{const r=Math.abs(e),n=Math.floor(r),a=Math.floor((r-n)*60),i=((r-n-a/60)*3600).toFixed(1),o=t?e>=0?"N":"S":e>=0?"E":"W";return`${n}${a}'${i}"${o}`},YM=({onClose:e,position:t,onSuccess:r,onError:n,onCamerasUpdate:a})=>{const[i,o]=C.useState({name:"",ip_address:"",location:`${nv(t[0],!0)} ${nv(t[1],!1)}`,latitude:t[0].toString(),longitude:t[1].toString()}),{isAuthenticated:l,token:u}=Pm(),f=C.useRef(null),[h,m]=C.useState(!1),g=async _=>{var y,E,k;if(_.preventDefault(),!l||!u){n("Veuillez vous connecter pour ajouter une camra");return}m(!0);try{if((await Ue.post(`${jt}/cameras/cameras/`,i,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}})).status===201){r("Camra ajoute avec succs");const w=await Ue.get(`${jt}/cameras/cameras/`,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(w.data.results||[]),e()}}catch(S){console.error("Error adding camera:",S),Ue.isAxiosError(S)?((y=S.response)==null?void 0:y.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):n(((k=(E=S.response)==null?void 0:E.data)==null?void 0:k.error)||"Erreur lors de l'ajout de la camra"):n("Erreur lors de l'ajout de la camra")}finally{m(!1)}},x=async _=>{var k,S,w,A,I;if(!l||!u){n("Veuillez vous connecter pour importer des camras");return}const y=(k=_.target.files)==null?void 0:k[0];if(!y)return;if(!y.name.endsWith(".csv")){n("Le fichier doit tre au format CSV");return}m(!0);const E=new FormData;E.append("file",y);try{const D=await Ue.post(`${jt}/cameras/cameras/upload_csv/`,E,{headers:{Authorization:`Bearer ${u}`,Accept:"application/json","Content-Type":"multipart/form-data"}});if(D.status===200){r(`Import russi: ${D.data.created} cres, ${D.data.updated} mises  jour`);const P=await Ue.get(`${jt}/cameras/cameras/`,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json",Accept:"application/json"}});a(P.data.results||[]),e()}}catch(D){console.error("Error uploading CSV:",D),Ue.isAxiosError(D)?((S=D.response)==null?void 0:S.status)===401?(n("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):((w=D.response)==null?void 0:w.status)===400?n(D.response.data.error||"Format de fichier invalide ou donnes manquantes"):n(((I=(A=D.response)==null?void 0:A.data)==null?void 0:I.error)||"Erreur lors de l'importation du fichier CSV"):n("Erreur lors de l'importation du fichier CSV")}finally{m(!1),f.current&&(f.current.value="")}};return d.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl z-50 w-full max-w-2xl mx-auto border border-gray-200",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Ajouter une nouvelle camra"}),d.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",disabled:h,children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),d.jsxs("form",{onSubmit:g,className:"space-y-6",children:[d.jsxs("fieldset",{className:"border border-gray-300 rounded-lg p-4 pb-6",children:[d.jsx("legend",{className:"text-md font-semibold text-gray-700 px-2",children:"Informations Gnrales"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-4 pt-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom de la camra"}),d.jsx("input",{type:"text",id:"name",value:i.name,onChange:_=>o({...i,name:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: Camra Principale Entre",required:!0,disabled:h})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"ip_address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse IP"}),d.jsx("input",{type:"text",id:"ip_address",value:i.ip_address,onChange:_=>o({...i,ip_address:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: 192.168.1.100",required:!0,disabled:h})]}),d.jsxs("div",{className:"col-span-1 md:col-span-2",children:[d.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Emplacement (Description)"}),d.jsx("input",{type:"text",id:"location",value:i.location,onChange:_=>o({...i,location:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: Btiment A, Porte 2",disabled:h})]})]})]}),d.jsxs("fieldset",{className:"border border-gray-300 rounded-lg p-4 pb-6",children:[d.jsx("legend",{className:"text-md font-semibold text-gray-700 px-2",children:"Coordonnes Gographiques"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-4 pt-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"latitude",className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),d.jsx("input",{type:"text",id:"latitude",value:i.latitude,onChange:_=>o({...i,latitude:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: 34.0000 (Dcimal)",required:!0,disabled:h})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"longitude",className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),d.jsx("input",{type:"text",id:"longitude",value:i.longitude,onChange:_=>o({...i,longitude:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2",placeholder:"Ex: -6.0000 (Dcimal)",required:!0,disabled:h})]})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4 mt-6",children:[d.jsx("input",{type:"file",ref:f,onChange:x,accept:".csv",className:"hidden",id:"csv-upload",disabled:h}),d.jsx("label",{htmlFor:"csv-upload",className:`w-full sm:w-auto flex justify-center items-center px-6 py-2 border border-transparent text-sm font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 cursor-pointer transition-colors duration-200 ${h?"opacity-50 cursor-not-allowed":""}`,children:h?d.jsxs("span",{className:"flex items-center",children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-green-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," Importation..."]}):"Importer CSV"}),d.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto flex justify-center items-center px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200",disabled:h,children:"Annuler"}),d.jsx("button",{type:"submit",className:`w-full sm:w-auto flex justify-center items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 ${h?"opacity-50 cursor-not-allowed":""}`,disabled:h,children:h?d.jsxs("span",{className:"flex items-center",children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})," Ajout en cours..."]}):"Ajouter"})]})]})]})},pa=Ue.create({baseURL:jt,headers:{"Content-Type":"application/json",Accept:"application/json"}});pa.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));pa.interceptors.response.use(e=>e,e=>{if(e.response){if(e.response.status===401)localStorage.removeItem("token"),window.location.href="/login";else if(e.response.status===404)return console.error("Endpoint not found:",e.response.config.url),Promise.reject(new Error("Endpoint non trouv. Veuillez vrifier la configuration du serveur."))}return Promise.reject(e)});const KM=Er.icon({iconUrl:"/images/marker-icon.png",iconRetinaUrl:"/images/marker-icon-2x.png",shadowUrl:"/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),JM=Er.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#22c55e">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),QM=Er.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#ef4444">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),eR=Er.divIcon({className:"custom-camera-icon",html:`
    <svg viewBox="0 0 60.051 60.051" width="32" height="32">
      <g fill="#2563eb">
        <path d="M56.963,32.026H55.14c-1.703,0-3.088,1.385-3.088,3.088v3.912h-10v-6.219c3.646-1.177,5.957-6.052,5.957-12.781
          c0-7.235-2.669-12.333-6.8-12.988c-0.052-0.008-0.104-0.012-0.157-0.012h-40c-0.481,0-0.893,0.343-0.982,0.816l-0.001,0
          c-0.02,0.107-0.472,2.648,1.243,4.714c1.138,1.371,2.92,2.169,5.292,2.395c-0.357,1.59-0.552,3.31-0.552,5.075
          c0,7.29,3.075,13,7,13h21v12.967c0,1.672,1.36,3.033,3.033,3.033h1.935c1.308,0,2.415-0.837,2.84-2h10.193v2.912
          c0,1.703,1.385,3.088,3.088,3.088h1.823c1.703,0,3.088-1.385,3.088-3.088V35.114C60.051,33.411,58.666,32.026,56.963,32.026z"/>
        <circle cx="32.051" cy="27.026" r="1"/>
        <circle cx="28.051" cy="27.026" r="1"/>
        <circle cx="24.051" cy="27.026" r="1"/>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),tR=`
  .custom-camera-icon {
    background: none;
    border: none;
  }
  .custom-camera-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-camera-icon:hover svg {
    transform: scale(1.1);
  }
  .custom-datacenter-icon {
    background: none;
    border: none;
  }
  .custom-datacenter-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-datacenter-icon:hover svg {
    transform: scale(1.1);
  }
  .leaflet-popup-content-wrapper {
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  .leaflet-popup-content {
    margin: 0;
    min-width: 300px;
    max-width: 500px;
  }
  .datacenter-popup-content {
    padding: 1rem;
    min-width: 300px;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    background: white;
    border-radius: 8px;
  }
`,wk=document.createElement("style");wk.innerText=tR;document.head.appendChild(wk);const rR=()=>{const[e,t]=C.useState(null),[r,n]=C.useState([]),[a,i]=C.useState(!1),[o,l]=C.useState([0,0]),[u,f]=C.useState(null),[h,m]=C.useState(null),[g,x]=C.useState({}),{isAuthenticated:_,token:y}=Pm(),E=C.useRef(null),[k,S]=C.useState("all"),[w,A]=C.useState("all"),[I,D]=C.useState(""),[P,W]=C.useState(!1),j=C.useRef(null),[V,B]=C.useState(!1),[Z,K]=C.useState(null),[ve,_e]=C.useState(!1),[de,J]=C.useState(new Set),[Q,U]=C.useState(!1),[te,fe]=C.useState(!1),F=me=>{f(me),j.current&&clearTimeout(j.current),j.current=window.setTimeout(()=>{window.location.reload()},3e3)};C.useEffect(()=>{const me=localStorage.getItem("token");if(!me){F("Veuillez vous connecter pour accder  cette page");return}return pa.get(Gg.CAMERAS.LIST,{headers:{Authorization:`Bearer ${me}`,"Content-Type":"application/json",Accept:"application/json"}}).then(()=>{W(!0)}).catch(Se=>{var he;((he=Se.response)==null?void 0:he.status)===401?(F("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):f("Erreur de connexion au serveur")}),()=>{j.current&&clearTimeout(j.current)}},[]),C.useEffect(()=>{P&&(Er.Marker.prototype.options.icon=KM,t(e))},[P]),C.useEffect(()=>P?((async()=>{var Se;try{const he=localStorage.getItem("token");if(!he){f("Token non trouv. Veuillez vous reconnecter.");return}let Me=[],He=Gg.CAMERAS.LIST;for(;He;){const nt=await pa.get(He,{headers:{Authorization:`Bearer ${he}`,"Content-Type":"application/json",Accept:"application/json"}});nt.data.results&&(Me=[...Me,...nt.data.results]),He=nt.data.next}n(Me),f(null)}catch(he){console.error("Error fetching cameras:",he),Ue.isAxiosError(he)&&((Se=he.response)==null?void 0:Se.status)===401?(f("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):f("Erreur lors du chargement des camras"),n([])}})(),()=>{Er.Marker.prototype.options.icon=void 0}):void 0,[P]);const ee=async me=>{try{x(Me=>({...Me,[me]:{status:"loading",responseTime:null}}));const Se=await fetch(`${jt}/cameras/cameras/${me}/ping/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!Se.ok)throw new Error("Erreur lors du ping");const he=await Se.json();x(Me=>({...Me,[me]:{status:he.status,responseTime:he.response_time,lastUpdate:Date.now()}}))}catch(Se){console.error("Error pinging camera:",Se),x(he=>({...he,[me]:{status:"error",responseTime:null,lastUpdate:Date.now()}}))}},q=async me=>{var Se,he,Me;if(!_||!y){f("Veuillez vous connecter pour supprimer une camra");return}_e(!0);try{(await pa.delete(`/cameras/cameras/${me.id}/`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json",Accept:"application/json"}})).status===204&&(m(`Camra "${X(me.name)}" supprime avec succs`),n(nt=>nt.filter(kt=>kt.id!==me.id)),K(null))}catch(He){console.error("Error deleting camera:",He),Ue.isAxiosError(He)?((Se=He.response)==null?void 0:Se.status)===401?(f("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):f(((Me=(he=He.response)==null?void 0:he.data)==null?void 0:Me.error)||"Erreur lors de la suppression de la camra"):f("Erreur lors de la suppression de la camra")}finally{_e(!1)}},X=me=>me.replace(//g,"").replace(//g,"").replace(//g,"").replace(/ /g,"").replace(//g,"").replace(//g,"").replace(//g,"").replace(//g,"").replace(//g,""),ae=me=>me?Date.now()-me>3e5:!0,ke=me=>{const Se=g[me];return!Se||Se.status==="idle"||ae(Se.lastUpdate)?eR:Se.status==="online"?JM:QM},Le=r.filter(me=>{var He,nt,kt;const Se=me.name.toLowerCase().includes(I.toLowerCase())||me.ip_address.toLowerCase().includes(I.toLowerCase()),he=k==="all"||k==="cameras",Me=w==="all"||w==="online"&&((He=g[me.id])==null?void 0:He.status)==="online"||w==="offline"&&(((nt=g[me.id])==null?void 0:nt.status)==="offline"||((kt=g[me.id])==null?void 0:kt.status)==="error");return Se&&he&&Me}),Ne=async()=>{if(!_){f("Veuillez vous connecter pour effectuer un ping");return}B(!0);try{const Se=(await pa.post("/cameras/cameras/ping_all/")).data.task_id,he=async()=>{try{const He=(await pa.get(`/cameras/cameras/check_ping_status/?task_id=${Se}`)).data;if(He.status==="completed"){const nt={};He.results.forEach(pt=>{nt[pt.id]={status:pt.status,responseTime:pt.response_time,lastUpdate:Date.now()}}),x(pt=>({...pt,...nt})),n(pt=>pt.map(_t=>{const Nt=nt[_t.id];return Nt?{..._t,is_online:Nt.status==="online"}:_t}));const kt=Object.values(nt).filter(pt=>pt.status==="online").length,Bt=Object.values(nt).filter(pt=>pt.status==="offline"||pt.status==="error").length;m(`Ping termin: ${kt} en ligne, ${Bt} hors ligne`),B(!1)}else He.status==="failed"?(f(`Erreur lors du ping: ${He.message}`),B(!1)):setTimeout(he,2e3)}catch(Me){console.error("Error checking ping status:",Me),f("Erreur lors de la vrification du statut"),B(!1)}};he()}catch(me){console.error("Error starting ping process:",me),f("Erreur lors du dmarrage du ping"),B(!1)}},we=async me=>{try{const he=(await pa.get(`/cameras/cameras/get_ping_history/?camera_id=${me}`)).data.results;if(he&&he.length>0){const Me=he[0];x(He=>({...He,[me]:{status:Me.status,responseTime:Me.response_time,lastUpdate:new Date(Me.timestamp).getTime()}}))}}catch(Se){console.error("Error fetching ping history:",Se)}};C.useEffect(()=>{r.length>0&&r.forEach(me=>{we(me.id)})},[r]);const Be=me=>{Q&&(J(Se=>{const he=new Set(Se);return he.has(me)?he.delete(me):he.add(me),he}),fe(!0))},G=me=>{J(Se=>{const he=new Set(Se);return he.delete(me),he})},Ge=async()=>{var me,Se,he;if(!(!_||!y||de.size===0)){_e(!0);try{const Me=Array.from(de).map(He=>pa.delete(`/cameras/cameras/${He}/`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json",Accept:"application/json"}}));await Promise.all(Me),m(`${de.size} camra(s) supprime(s) avec succs`),n(He=>He.filter(nt=>!de.has(nt.id))),J(new Set),U(!1)}catch(Me){console.error("Error deleting cameras:",Me),Ue.isAxiosError(Me)?((me=Me.response)==null?void 0:me.status)===401?(f("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("token"),window.location.href="/login"):f(((he=(Se=Me.response)==null?void 0:Se.data)==null?void 0:he.error)||"Erreur lors de la suppression des camras"):f("Erreur lors de la suppression des camras")}finally{_e(!1)}}},Je=async()=>{if(!(!_||!y||de.size===0)){B(!0);try{const me=Array.from(de).map(Me=>pa.post(`/cameras/cameras/${Me}/ping/`)),Se=await Promise.all(me),he={};Se.forEach((Me,He)=>{const nt=Array.from(de)[He];he[nt]={status:Me.data.status,responseTime:Me.data.response_time,lastUpdate:Date.now()}}),x(Me=>({...Me,...he})),m(`Ping de ${de.size} camra(s) termin`)}catch(me){console.error("Error pinging cameras:",me),f("Erreur lors du ping des camras slectionnes")}finally{B(!1)}}};return d.jsxs("div",{className:"w-[1270px] h-[550px] rounded-lg overflow-hidden shadow-lg relative",children:[d.jsxs("div",{className:"absolute top-4 right-4 z-[1000] bg-white rounded-lg shadow-lg p-4 space-y-4 w-80",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode slection"}),d.jsx("button",{onClick:()=>{U(!Q),Q||(J(new Set),fe(!1))},className:`relative inline-flex h-6 w-11 items-center rounded-full ${Q?"bg-blue-600":"bg-gray-200"}`,children:d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${Q?"translate-x-6":"translate-x-1"}`})})]}),Q&&de.size>0&&te&&d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[d.jsxs("div",{className:"p-3 border-b border-gray-200 flex justify-between items-center",children:[d.jsxs("h3",{className:"text-sm font-medium text-gray-700",children:["Camras slectionnes (",de.size,")"]}),d.jsx("button",{onClick:()=>fe(!1),className:"text-gray-400 hover:text-gray-600",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),d.jsx("div",{className:"max-h-60 overflow-y-auto",children:Array.from(de).map(me=>{var he,Me,He,nt,kt,Bt,pt;const Se=r.find(_t=>_t.id===me);return Se?d.jsx("div",{className:"p-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900",children:X(Se.name)}),d.jsxs("p",{className:"text-xs text-gray-500",children:["IP: ",Se.ip_address]}),Se.latitude&&Se.longitude&&d.jsxs("p",{className:"text-xs text-gray-500",children:["Position: ",Se.latitude,", ",Se.longitude]}),d.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[d.jsx("button",{onClick:()=>ee(Se.id),disabled:((he=g[Se.id])==null?void 0:he.status)==="loading",className:`px-2 py-1 rounded text-xs text-white ${((Me=g[Se.id])==null?void 0:Me.status)==="loading"?"bg-gray-400":((He=g[Se.id])==null?void 0:He.status)==="online"?"bg-green-500":((nt=g[Se.id])==null?void 0:nt.status)==="offline"?"bg-red-500":"bg-blue-500"}`,children:((kt=g[Se.id])==null?void 0:kt.status)==="loading"?d.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-2 border-white border-t-transparent"}):((Bt=g[Se.id])==null?void 0:Bt.status)==="online"?d.jsx(Sh,{className:"w-3 h-3"}):((pt=g[Se.id])==null?void 0:pt.status)==="offline"?d.jsx(Eh,{className:"w-3 h-3"}):"Ping"}),d.jsx("button",{onClick:()=>G(Se.id),className:"px-2 py-1 rounded text-xs text-white bg-red-500 hover:bg-red-600",children:"Retirer"})]})]}),d.jsx("div",{className:"ml-2",children:d.jsx("button",{onClick:()=>{if(E.current){const _t=parseFloat(Se.latitude||"0"),Nt=parseFloat(Se.longitude||"0");!isNaN(_t)&&!isNaN(Nt)&&E.current.setView([_t,Nt],13)}},className:"text-gray-400 hover:text-gray-600",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})})]})},me):null})}),d.jsx("div",{className:"p-3 bg-gray-50 border-t border-gray-200",children:d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:Je,disabled:V,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${V?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:V?"Ping en cours...":"Ping slection"}),d.jsx("button",{onClick:Ge,disabled:ve,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${ve?"bg-red-400":"bg-red-500 hover:bg-red-600"}`,children:ve?"Suppression...":"Supprimer"})]})})]}),Q&&de.size>0&&!te&&d.jsxs("div",{className:"bg-blue-50 p-3 rounded-md space-y-2",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"text-sm font-medium text-blue-700",children:[de.size," camra(s) slectionne(s)"]}),d.jsx("button",{onClick:()=>fe(!0),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Voir la liste"})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:Je,disabled:V,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${V?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:V?"Ping en cours...":"Ping slection"}),d.jsx("button",{onClick:Ge,disabled:ve,className:`flex-1 px-3 py-1.5 rounded-md text-sm text-white ${ve?"bg-red-400":"bg-red-500 hover:bg-red-600"}`,children:ve?"Suppression...":"Supprimer"})]})]}),d.jsxs("button",{onClick:()=>{if(!_){F("Veuillez vous connecter pour ajouter une camra");return}i(!0)},className:"w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[d.jsx(Qi,{className:"h-5 w-5 mr-2"}),"Ajouter une Camra"]}),d.jsxs("div",{className:"flex space-x-2 mb-2",children:[d.jsx("button",{onClick:()=>S("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${k==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tout"}),d.jsx("button",{onClick:()=>S("cameras"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${k==="cameras"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Camras"})]}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:I,onChange:me=>D(me.target.value),placeholder:"Rechercher une camra...",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),I&&d.jsx("button",{onClick:()=>D(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:()=>A("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${w==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous"}),d.jsx("button",{onClick:()=>A("online"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${w==="online"?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"En ligne"}),d.jsx("button",{onClick:()=>A("offline"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${w==="offline"?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Hors ligne"})]}),d.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[d.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Statistiques"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Camras:"}),d.jsx("span",{className:"font-semibold",children:Le.length})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"En ligne:"}),d.jsx("span",{className:"text-green-500 font-semibold",children:Object.values(g).filter(me=>me.status==="online").length})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Hors ligne:"}),d.jsx("span",{className:"text-red-500 font-semibold",children:Object.values(g).filter(me=>me.status==="offline"||me.status==="error").length})]})]}),d.jsx("button",{onClick:Ne,disabled:V,className:`w-full px-4 py-2 rounded-md text-white text-sm flex items-center justify-center gap-2 ${V?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:V?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Ping en cours..."]}):d.jsxs(d.Fragment,{children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),"Tester toutes les camras"]})})]})]}),d.jsxs(pk,{center:[31.7917,-7.0926],zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,ref:E,children:[d.jsx(xk,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),e&&d.jsx(PM,{data:e,style:{color:"#2563eb",weight:2,fillOpacity:.1,fillColor:"#3b82f6"},onEachFeature:(me,Se)=>{var he;Se.bindPopup(`
                <div class="p-2">
                  <h3 class="font-semibold text-lg">${me.properties.ADMIN}</h3>
                  <p class="text-sm">Population: ${((he=me.properties.POP_EST)==null?void 0:he.toLocaleString())||"N/A"}</p>
                </div>
              `)}}),d.jsx(yk,{chunkedLoading:!0,maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:me=>Er.divIcon({html:`<div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${me.getChildCount()}</div>`,className:"custom-cluster-icon",iconSize:Er.point(32,32)}),children:Le.map(me=>{var Se,he,Me,He,nt,kt,Bt,pt;if(me.latitude&&me.longitude){const _t=parseFloat(me.latitude),Nt=parseFloat(me.longitude);if(!isNaN(_t)&&!isNaN(Nt)){const dr=de.has(me.id);return d.jsx(mk,{position:[_t,Nt],icon:ke(me.id),riseOnHover:!0,eventHandlers:{click:()=>Be(me.id)},children:d.jsx(gk,{children:d.jsxs("div",{className:`p-2 min-w-[200px] ${dr?"bg-blue-50":""}`,children:[d.jsx("h3",{className:"font-semibold text-lg",children:X(me.name)}),d.jsxs("p",{className:"text-sm",children:["IP: ",me.ip_address]}),d.jsxs("p",{className:"text-sm",children:["Latitude: ",_t]}),d.jsxs("p",{className:"text-sm",children:["Longitude: ",Nt]}),d.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[d.jsxs("button",{onClick:Nr=>{Nr.preventDefault(),ee(me.id)},className:`px-3 py-1 rounded-md text-white text-sm flex items-center gap-2 ${((Se=g[me.id])==null?void 0:Se.status)==="loading"?"bg-gray-400":((he=g[me.id])==null?void 0:he.status)==="online"?"bg-green-500":((Me=g[me.id])==null?void 0:Me.status)==="offline"?"bg-red-500":"bg-blue-500"}`,disabled:((He=g[me.id])==null?void 0:He.status)==="loading",children:[((nt=g[me.id])==null?void 0:nt.status)==="loading"?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((kt=g[me.id])==null?void 0:kt.status)==="online"?d.jsx(Sh,{className:"w-4 h-4"}):((Bt=g[me.id])==null?void 0:Bt.status)==="offline"?d.jsx(Eh,{className:"w-4 h-4"}):"Ping",((pt=g[me.id])==null?void 0:pt.status)==="online"&&g[me.id].responseTime&&d.jsxs("span",{children:[Math.round(g[me.id].responseTime||0),"ms"]})]}),!Q&&d.jsxs("button",{onClick:Nr=>{Nr.preventDefault(),K(me)},className:"px-3 py-1 rounded-md text-white text-sm bg-red-500 hover:bg-red-600 flex items-center gap-2",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Supprimer"]})]})]})})},me.id)}}return null})})]}),a&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1000]",onClick:()=>i(!1)}),d.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1001]",children:d.jsx(YM,{onClose:()=>i(!1),position:o,onSuccess:me=>{m(me),i(!1)},onError:me=>{f(me),i(!1)},onCamerasUpdate:me=>{n(me)}})})]}),Z&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1000]",onClick:()=>!ve&&K(null)}),d.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1001] bg-white rounded-lg p-6 w-96",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Confirmer la suppression"}),d.jsxs("div",{className:"mb-4",children:[d.jsx("p",{className:"text-gray-600 mb-2",children:"tes-vous sr de vouloir supprimer la camra suivante ?"}),d.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[d.jsx("p",{className:"font-medium",children:X(Z.name)}),d.jsxs("p",{className:"text-sm text-gray-500",children:["IP: ",Z.ip_address]}),Z.latitude&&Z.longitude&&d.jsxs("p",{className:"text-sm text-gray-500",children:["Position: ",Z.latitude,", ",Z.longitude]})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>K(null),disabled:ve,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Annuler"}),d.jsx("button",{onClick:()=>q(Z),disabled:ve,className:`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 ${ve?"bg-red-400":"bg-red-600 hover:bg-red-700"}`,children:ve?d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Suppression..."]}):"Supprimer"})]})]})]}),u&&d.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[d.jsx("strong",{className:"font-bold",children:"Erreur! "}),d.jsx("span",{className:"block sm:inline",children:u}),d.jsx("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>f(null),children:d.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[d.jsx("title",{children:"Close"}),d.jsx("path",{d:"M14.348 14.849a1 1 0 0 1-1.697 0L10 11.819l-2.651 3.029a1 1 0 1 0 1.697 1.414L10 13.515l2.651-3.029a1 1 0 0 1 1.697-1.697L10 11.414l2.651-3.031a1 1 0 1 0 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),h&&d.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",role:"alert",children:[d.jsx("strong",{className:"font-bold",children:"Succs! "}),d.jsx("span",{className:"block sm:inline",children:h}),d.jsx("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>m(null),children:d.jsxs("svg",{className:"fill-current h-6 w-6 text-green-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[d.jsx("title",{children:"Close"}),d.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1 1 0 1 0 1.697 1.697L10 13.515l2.651-3.029a1 1 0 0 0-1.697-1.697L10 11.819l2.651-3.031a1 1 0 1 0 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})]})};function xd(){const{id:e}=PT(),t=ka(),[r,n]=C.useState(""),[a,i]=C.useState(""),[o,l]=C.useState([]),[u,f]=C.useState([]),[h,m]=C.useState({name:"",description:""}),[g,x]=C.useState(null),[_,y]=C.useState(!1),[E,k]=C.useState(null),S=C.useRef(null),w=async()=>{try{const K=await Us.getVariables();if(Array.isArray(K)){const ve=K.sort((_e,de)=>_e.name.localeCompare(de.name));l(ve)}else l([])}catch{k("Erreur lors du chargement des variables"),l([])}},A=async()=>{try{y(!0);const K=await zs.getTemplates();Array.isArray(K)?f(K):f([])}catch{k("Erreur lors du chargement des templates"),f([])}finally{y(!1)}};C.useEffect(()=>{e&&I(e),w(),A()},[e]);const I=async K=>{try{y(!0);const ve=await zs.getTemplate(parseInt(K)),_e=await Us.getVariables();i(ve.name),n(ve.content),l(_e)}catch{k("Erreur lors du chargement du template")}finally{y(!1)}},D=K=>{if(S.current){const ve=S.current,_e=ve.selectionStart,de=ve.selectionEnd,J=ve.value,Q=J.substring(0,_e)+`{{ ${K} }}`+J.substring(de);n(Q),setTimeout(()=>{ve.focus(),ve.setSelectionRange(_e+K.length+6,_e+K.length+6)},0)}},P=async()=>{if(!h.name||!h.description){k("Veuillez remplir tous les champs de la variable");return}try{y(!0);const K=await Us.createVariable(h);e&&await Us.addVariableToTemplate(parseInt(e),K.id),m({name:"",description:""}),await w()}catch{k("Erreur lors de l'ajout de la variable")}finally{y(!1)}},W=async K=>{try{y(!0),await Us.deleteVariable(K),await w()}catch{k("Erreur lors de la suppression de la variable")}finally{y(!1)}},j=async()=>{if(!a){k("Veuillez donner un nom au template");return}try{y(!0);const K={name:a,content:r};e?await zs.updateTemplate(parseInt(e),K):await zs.createTemplate({...K,description:"",variables:[]}),t("/templates")}catch{k("Erreur lors de la sauvegarde du template")}finally{y(!1)}},V=async K=>{if(window.confirm("tes-vous sr de vouloir supprimer ce template ?"))try{y(!0),await zs.deleteTemplate(K),await A()}catch{k("Erreur lors de la suppression du template")}finally{y(!1)}},B=async K=>{try{y(!0);const ve=await Ue.get(`${jt}/templates/${K}/download_excel/`,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),_e=new Blob([ve.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),de=window.URL.createObjectURL(_e),J=document.createElement("a");J.href=de,J.download=`template_${K}_${new Date().toISOString()}.xlsx`,document.body.appendChild(J),J.click(),document.body.removeChild(J),window.URL.revokeObjectURL(de)}catch(ve){console.error("Error downloading Excel file:",ve),k("Failed to download Excel file")}finally{y(!1)}},Z=async()=>{y(!0);try{await Promise.all([w(),A()])}catch{k("Erreur lors du rafrachissement")}finally{y(!1)}};return _?d.jsx("div",{className:"p-8 flex items-center justify-center",children:d.jsx(nl,{className:"w-8 h-8 animate-spin text-purple-600"})}):d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e?"Modifier le Template":"Nouveau Template"}),d.jsx("p",{className:"text-gray-600",children:"Crez et modifiez vos templates avec des variables dynamiques"})]}),d.jsx("button",{onClick:Z,disabled:_,className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",title:"Rafrachir",children:_?d.jsx(nl,{className:"w-5 h-5 animate-spin"}):d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})})]}),E&&d.jsx("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded-md",children:E}),d.jsxs("div",{className:"flex gap-6",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{htmlFor:"templateName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du Template"}),d.jsx("input",{id:"templateName",name:"templateName",type:"text",value:a,onChange:K=>i(K.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"Entrez le nom du template"})]}),d.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:d.jsx("textarea",{ref:S,value:r,onChange:K=>n(K.target.value),className:"w-full h-[500px] p-4 font-mono text-sm bg-gray-900 text-gray-100 border-0 focus:ring-0 resize-none",placeholder:"Entrez le contenu du template ici...",style:{lineHeight:"1.5",tabSize:2}})}),d.jsxs("div",{className:"mt-4 flex gap-4",children:[d.jsxs("button",{onClick:j,disabled:_,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:[_?d.jsx(nl,{className:"w-5 h-5 mr-2 animate-spin"}):d.jsx(h2,{className:"w-5 h-5 mr-2"}),_?"Enregistrement...":"Enregistrer"]}),d.jsxs("button",{onClick:()=>t("/templates"),className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[d.jsx(ib,{className:"w-5 h-5 mr-2"}),"Retour"]}),e&&d.jsxs("button",{onClick:()=>V(parseInt(e)),disabled:_,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:[d.jsx(Ln,{className:"w-5 h-5 mr-2"}),"Supprimer"]})]})]}),d.jsx("div",{className:"w-80",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Variables Disponibles"}),d.jsx("div",{className:"space-y-4 mb-6",children:o&&o.length>0?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mb-4",children:[d.jsxs("h3",{className:"text-sm font-medium text-purple-600 mb-2 flex items-center",children:[d.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),"Variables Requises"]}),d.jsx("div",{className:"space-y-2",children:o.filter(K=>["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(K.name)).map(K=>d.jsxs("div",{className:"group relative",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 bg-purple-50 hover:bg-purple-100 rounded-md transition-colors duration-200",children:[d.jsx("button",{onClick:()=>D(K.name),className:"flex-1 text-left flex items-center",children:d.jsx("span",{className:"text-purple-700 font-medium",children:K.name})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(wh,{className:"w-4 h-4 text-purple-400"}),d.jsx("button",{onClick:()=>W(K.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(Ln,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===K.name&&d.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:K.description})]},`variable-${K.id||K.name}`))})]}),d.jsxs("div",{children:[d.jsxs("h3",{className:"text-sm font-medium text-gray-600 mb-2 flex items-center",children:[d.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),"Variables Personnalises"]}),d.jsx("div",{className:"space-y-2",children:o.filter(K=>!["Hostname","IP Address","VDOM","Name","Source Address","Source Description","Source Interface","Destination Address","Destination Description","Destination Interface","Service"].includes(K.name)).map(K=>d.jsxs("div",{className:"group relative",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 hover:bg-gray-100 rounded-md transition-colors duration-200",children:[d.jsx("button",{onClick:()=>D(K.name),className:"flex-1 text-left flex items-center",children:d.jsx("span",{className:"text-gray-700",children:K.name})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(wh,{className:"w-4 h-4 text-gray-400"}),d.jsx("button",{onClick:()=>W(K.id),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(Ln,{className:"w-4 h-4 text-red-500 hover:text-red-700"})})]})]}),g===K.name&&d.jsx("div",{className:"absolute z-10 w-48 px-3 py-2 bg-gray-800 text-white text-sm rounded-md shadow-lg -top-8 right-0",children:K.description})]},`variable-${K.id||K.name}`))})]})]}):d.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucune variable disponible"})}),d.jsxs("div",{className:"border-t pt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Ajouter une variable"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"variableName",className:"block text-sm text-gray-600 mb-1",children:"Nom de la variable"}),d.jsx("input",{id:"variableName",name:"variableName",type:"text",value:h.name,onChange:K=>m({...h,name:K.target.value}),placeholder:"Nom de la variable",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"variableDescription",className:"block text-sm text-gray-600 mb-1",children:"Description"}),d.jsx("input",{id:"variableDescription",name:"variableDescription",type:"text",value:h.description,onChange:K=>m({...h,description:K.target.value}),placeholder:"Description",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),d.jsxs("button",{onClick:P,disabled:_,className:"w-full flex items-center justify-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 transition-colors duration-200",children:[_?d.jsx(nl,{className:"w-4 h-4 mr-2 animate-spin"}):d.jsx(Qi,{className:"w-4 h-4 mr-2"}),"Ajouter"]})]})]}),d.jsxs("div",{className:"border-t mt-6 pt-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Templates"}),d.jsxs("button",{onClick:()=>t("/templates/new"),className:"flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm",children:[d.jsx(Qi,{className:"w-4 h-4 mr-1"}),"Nouveau"]})]}),d.jsx("div",{className:"space-y-3",children:_?d.jsx("div",{className:"flex justify-center py-4",children:d.jsx(nl,{className:"w-6 h-6 animate-spin text-purple-600"})}):u&&u.length>0?u.map(K=>d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 hover:bg-gray-100 rounded-md",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"font-medium text-gray-900",children:K.name}),d.jsxs("div",{className:"text-sm text-gray-500",children:["Cr le: ",K.created_at?new Date(K.created_at).toLocaleDateString():"N/A"]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>t(`/templates/${K.id}`),className:"p-1 text-blue-500 hover:text-blue-700",title:"Modifier",children:d.jsx(fb,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>B(K.id),className:"p-1 text-green-500 hover:text-green-700",title:"Tlcharger Excel",children:d.jsx(ob,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>V(K.id),className:"p-1 text-red-500 hover:text-red-700",title:"Supprimer",children:d.jsx(Ln,{className:"w-4 h-4"})})]})]},`template-${K.id}`)):d.jsx("div",{className:"text-center text-gray-500 py-4",children:"Aucun template disponible"})})]})]})})]})]})}function nR(){const e=ka(),[t,r]=C.useState(null),[n,a]=C.useState(!1),[i,o]=C.useState({}),[l,u]=C.useState(null),[f,h]=C.useState(null),[m,g]=C.useState(null),[x,_]=C.useState(!1),[y,E]=C.useState(null),[k,S]=C.useState(!1),[w,A]=C.useState({current_password:"",new_password:"",confirm_password:""});C.useEffect(()=>{(async()=>{try{const j=await an.get("/auth/users/me/");r(j.data),o(j.data),u(null)}catch(j){console.error("Error fetching user profile data:",j),u(j.message)}})()},[]);const I=async W=>{W.preventDefault();try{console.log("Updating user data:",i);const j=await an.put("/auth/users/update_user_info/",i);console.log("Update response:",j.data),j.data&&(r(j.data.user),a(!1),u(null))}catch(j){console.error("Error updating user data:",j),u(j.message)}},D=async W=>{var j,V;if(W.preventDefault(),h(null),g(null),w.new_password!==w.confirm_password){h("Les mots de passe ne correspondent pas");return}if(w.new_password.length<8){h("Le mot de passe doit contenir au moins 8 caractres");return}try{(await an.put("/auth/users/update_user_info/",{current_password:w.current_password,password:w.new_password})).data&&(g("Mot de passe mis  jour avec succs"),A({current_password:"",new_password:"",confirm_password:""}))}catch(B){console.error("Error updating password:",B),h(((V=(j=B.response)==null?void 0:j.data)==null?void 0:V.error)||"Erreur lors de la mise  jour du mot de passe")}},P=async()=>{var W,j;S(!0),E(null);try{await an.delete("/auth/users/me/"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e("/login")}catch(V){console.error("Error deleting profile:",V),E(((j=(W=V.response)==null?void 0:W.data)==null?void 0:j.error)||"Erreur lors de la suppression du profil"),_(!1)}finally{S(!1)}};return l?d.jsx("div",{className:"max-w-2xl mx-auto p-6",children:d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsxs("p",{className:"text-red-600",children:["Error: ",l]})})}):t?d.jsx("div",{className:"max-w-2xl mx-auto p-6",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[d.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[d.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:d.jsx(ko,{className:"h-8 w-8 text-purple-600"})}),d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[t.first_name," ",t.last_name]}),d.jsxs("p",{className:"text-gray-600",children:["@",t.username]})]})]}),d.jsxs("form",{onSubmit:I,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(ko,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"text",value:i.username||"",onChange:W=>o({...i,username:W.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),d.jsx("input",{type:"text",value:i.first_name||"",onChange:W=>o({...i,first_name:W.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),d.jsx("input",{type:"text",value:i.last_name||"",onChange:W=>o({...i,last_name:W.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(u2,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"email",value:i.email||"",onChange:W=>o({...i,email:W.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(d2,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"tel",value:i.phone_number||"",onChange:W=>o({...i,phone_number:W.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",disabled:!n})]})]}),d.jsx("div",{className:"flex justify-end space-x-4 mt-6",children:n?d.jsxs(d.Fragment,{children:[d.jsx("button",{type:"button",onClick:()=>{a(!1),o(t)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[d.jsx(h2,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}):d.jsx("button",{type:"button",onClick:()=>a(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Edit Profile"})})]}),d.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[d.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),d.jsxs("form",{onSubmit:D,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(Ba,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"password",value:w.current_password,onChange:W=>A({...w,current_password:W.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(Ba,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"password",value:w.new_password,onChange:W=>A({...w,new_password:W.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),d.jsxs("div",{className:"mt-1 flex items-center",children:[d.jsx(Ba,{className:"h-5 w-5 text-gray-400 mr-2"}),d.jsx("input",{type:"password",value:w.confirm_password,onChange:W=>A({...w,confirm_password:W.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]})]}),f&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsx("p",{className:"text-red-600",children:f})}),m&&d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:d.jsx("p",{className:"text-green-600",children:m})}),d.jsx("div",{className:"flex justify-end",children:d.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[d.jsx(Ba,{className:"h-4 w-4 mr-2"}),"Change Password"]})})]})]}),d.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[d.jsx("h2",{className:"text-lg font-medium text-red-600 mb-4",children:"Zone de danger"}),d.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[d.jsx("p",{className:"text-red-600 mb-4",children:"La suppression de votre compte est irrversible. Toutes vos donnes seront dfinitivement supprimes."}),d.jsxs("button",{onClick:()=>_(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center",children:[d.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Supprimer mon compte"]})]})]}),x&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[d.jsx("h3",{className:"text-lg font-medium text-red-600 mb-4",children:"Confirmer la suppression"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"tes-vous sr de vouloir supprimer votre compte ? Cette action est irrversible."}),y&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:d.jsx("p",{className:"text-red-600",children:y})}),d.jsxs("div",{className:"flex justify-end space-x-4",children:[d.jsx("button",{onClick:()=>_(!1),disabled:k,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Annuler"}),d.jsx("button",{onClick:P,disabled:k,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center disabled:opacity-50",children:k?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Suppression en cours..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Confirmer la suppression"]})})]})]})})]})}):d.jsx("div",{className:"max-w-2xl mx-auto p-6",children:d.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:d.jsxs("div",{className:"animate-pulse",children:[d.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"h-4 bg-gray-200 rounded"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]})})})}const kk=6048e5,aR=864e5,av=Symbol.for("constructDateFrom");function Fi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&av in e?e[av](t):e instanceof Date?new e.constructor(t):new Date(t)}function na(e,t){return Fi(t||e,e)}let iR={};function i0(){return iR}function ac(e,t){var l,u,f,h;const r=i0(),n=(t==null?void 0:t.weekStartsOn)??((u=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((h=(f=r.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??0,a=na(e,t==null?void 0:t.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function bf(e,t){return ac(e,{...t,weekStartsOn:1})}function Ek(e,t){const r=na(e,t==null?void 0:t.in),n=r.getFullYear(),a=Fi(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=bf(a),o=Fi(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=bf(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function iv(e){const t=na(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function sR(e,...t){const r=Fi.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function sv(e,t){const r=na(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function oR(e,t,r){const[n,a]=sR(r==null?void 0:r.in,e,t),i=sv(n),o=sv(a),l=+i-iv(i),u=+o-iv(o);return Math.round((l-u)/aR)}function lR(e,t){const r=Ek(e,t),n=Fi(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),bf(n)}function cR(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function uR(e){return!(!cR(e)&&typeof e!="number"||isNaN(+na(e)))}function fR(e,t){const r=na(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const dR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},hR=(e,t,r)=>{let n;const a=dR[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function po(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const pR={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mR={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},gR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xR={date:po({formats:pR,defaultWidth:"full"}),time:po({formats:mR,defaultWidth:"full"}),dateTime:po({formats:gR,defaultWidth:"full"})},vR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},_R=(e,t,r,n)=>vR[e];function xa(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const yR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},wR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ER={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},SR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},TR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},CR=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},bR={ordinalNumber:CR,era:xa({values:yR,defaultWidth:"wide"}),quarter:xa({values:wR,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xa({values:kR,defaultWidth:"wide"}),day:xa({values:ER,defaultWidth:"wide"}),dayPeriod:xa({values:SR,defaultWidth:"wide",formattingValues:TR,defaultFormattingWidth:"wide"})};function va(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(l)?AR(l,m=>m.test(o)):NR(l,m=>m.test(o));let f;f=e.valueCallback?e.valueCallback(u):u,f=r.valueCallback?r.valueCallback(f):f;const h=t.slice(o.length);return{value:f,rest:h}}}function NR(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function AR(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Sk(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const LR=/^(\d+)(th|st|nd|rd)?/i,PR=/\d+/i,FR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},OR={any:[/^b/i,/^(a|c)/i]},MR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},RR={any:[/1/i,/2/i,/3/i,/4/i]},DR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},IR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jR={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},BR={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},zR={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},UR={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},HR={ordinalNumber:Sk({matchPattern:LR,parsePattern:PR,valueCallback:e=>parseInt(e,10)}),era:va({matchPatterns:FR,defaultMatchWidth:"wide",parsePatterns:OR,defaultParseWidth:"any"}),quarter:va({matchPatterns:MR,defaultMatchWidth:"wide",parsePatterns:RR,defaultParseWidth:"any",valueCallback:e=>e+1}),month:va({matchPatterns:DR,defaultMatchWidth:"wide",parsePatterns:IR,defaultParseWidth:"any"}),day:va({matchPatterns:jR,defaultMatchWidth:"wide",parsePatterns:BR,defaultParseWidth:"any"}),dayPeriod:va({matchPatterns:zR,defaultMatchWidth:"any",parsePatterns:UR,defaultParseWidth:"any"})},VR={code:"en-US",formatDistance:hR,formatLong:xR,formatRelative:_R,localize:bR,match:HR,options:{weekStartsOn:0,firstWeekContainsDate:1}};function WR(e,t){const r=na(e,t==null?void 0:t.in);return oR(r,fR(r))+1}function $R(e,t){const r=na(e,t==null?void 0:t.in),n=+bf(r)-+lR(r);return Math.round(n/kk)+1}function Tk(e,t){var h,m,g,x;const r=na(e,t==null?void 0:t.in),n=r.getFullYear(),a=i0(),i=(t==null?void 0:t.firstWeekContainsDate)??((m=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((x=(g=a.locale)==null?void 0:g.options)==null?void 0:x.firstWeekContainsDate)??1,o=Fi((t==null?void 0:t.in)||e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=ac(o,t),u=Fi((t==null?void 0:t.in)||e,0);u.setFullYear(n,0,i),u.setHours(0,0,0,0);const f=ac(u,t);return+r>=+l?n+1:+r>=+f?n:n-1}function GR(e,t){var l,u,f,h;const r=i0(),n=(t==null?void 0:t.firstWeekContainsDate)??((u=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((h=(f=r.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,a=Tk(e,t),i=Fi((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),ac(i,t)}function ZR(e,t){const r=na(e,t==null?void 0:t.in),n=+ac(r,t)-+GR(r,t);return Math.round(n/kk)+1}function Ct(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const si={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Ct(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ct(r+1,2)},d(e,t){return Ct(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ct(e.getHours()%12||12,t.length)},H(e,t){return Ct(e.getHours(),t.length)},m(e,t){return Ct(e.getMinutes(),t.length)},s(e,t){return Ct(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ct(a,t.length)}},js={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ov={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return si.y(e,t)},Y:function(e,t,r,n){const a=Tk(e,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return Ct(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Ct(i,t.length)},R:function(e,t){const r=Ek(e);return Ct(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ct(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Ct(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Ct(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return si.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Ct(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=ZR(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Ct(a,t.length)},I:function(e,t,r){const n=$R(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Ct(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):si.d(e,t)},D:function(e,t,r){const n=WR(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ct(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Ct(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Ct(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Ct(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=js.noon:n===0?a=js.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=js.evening:n>=12?a=js.afternoon:n>=4?a=js.morning:a=js.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return si.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):si.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ct(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ct(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):si.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):si.s(e,t)},S:function(e,t){return si.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return cv(n);case"XXXX":case"XX":return Gi(n);case"XXXXX":case"XXX":default:return Gi(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return cv(n);case"xxxx":case"xx":return Gi(n);case"xxxxx":case"xxx":default:return Gi(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+lv(n,":");case"OOOO":default:return"GMT"+Gi(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+lv(n,":");case"zzzz":default:return"GMT"+Gi(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Ct(n,t.length)},T:function(e,t,r){return Ct(+e,t.length)}};function lv(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Ct(i,2)}function cv(e,t){return e%60===0?(e>0?"-":"+")+Ct(Math.abs(e)/60,2):Gi(e,t)}function Gi(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Ct(Math.trunc(n/60),2),i=Ct(n%60,2);return r+a+t+i}const uv=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Ck=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},XR=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return uv(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",uv(n,t)).replace("{{time}}",Ck(a,t))},qR={p:Ck,P:XR},YR=/^D+$/,KR=/^Y+$/,JR=["D","DD","YY","YYYY"];function QR(e){return YR.test(e)}function eD(e){return KR.test(e)}function tD(e,t,r){const n=rD(e,t,r);if(console.warn(n),JR.includes(e))throw new RangeError(n)}function rD(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const nD=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,aD=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,iD=/^'([^]*?)'?$/,sD=/''/g,oD=/[a-zA-Z]/;function lD(e,t,r){var h,m,g,x,_,y,E,k;const n=i0(),a=(r==null?void 0:r.locale)??n.locale??VR,i=(r==null?void 0:r.firstWeekContainsDate)??((m=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((y=(_=r==null?void 0:r.locale)==null?void 0:_.options)==null?void 0:y.weekStartsOn)??n.weekStartsOn??((k=(E=n.locale)==null?void 0:E.options)==null?void 0:k.weekStartsOn)??0,l=na(e,r==null?void 0:r.in);if(!uR(l))throw new RangeError("Invalid time value");let u=t.match(aD).map(S=>{const w=S[0];if(w==="p"||w==="P"){const A=qR[w];return A(S,a.formatLong)}return S}).join("").match(nD).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const w=S[0];if(w==="'")return{isToken:!1,value:cD(S)};if(ov[w])return{isToken:!0,value:S};if(w.match(oD))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(u=a.localize.preprocessor(l,u));const f={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return u.map(S=>{if(!S.isToken)return S.value;const w=S.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&eD(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&QR(w))&&tD(w,t,String(e));const A=ov[w[0]];return A(l,w,a.localize,f)}).join("")}function cD(e){const t=e.match(iD);return t?t[1].replace(sD,"'"):e}const uD={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},fD=(e,t,r)=>{let n;const a=uD[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},dD={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},hD={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},pD={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},mD={date:po({formats:dD,defaultWidth:"full"}),time:po({formats:hD,defaultWidth:"full"}),dateTime:po({formats:pD,defaultWidth:"full"})},gD={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},xD=(e,t,r,n)=>gD[e],vD={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},_D={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},yD={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},wD={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},kD={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},ED=(e,t)=>{const r=Number(e),n=t==null?void 0:t.unit;if(r===0)return"0";const a=["year","week","hour","minute","second"];let i;return r===1?i=n&&a.includes(n)?"re":"er":i="me",r+i},SD=["MMM","MMMM"],TD={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&SD.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:ED,era:xa({values:vD,defaultWidth:"wide"}),quarter:xa({values:_D,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xa({values:yD,defaultWidth:"wide"}),day:xa({values:wD,defaultWidth:"wide"}),dayPeriod:xa({values:kD,defaultWidth:"wide"})},CD=/^(\d+)(ime|re|me|er|e)?/i,bD=/\d+/i,ND={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},AD={any:[/^av/i,/^ap/i]},LD={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},PD={any:[/1/i,/2/i,/3/i,/4/i]},FD={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},OD={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},MD={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},RD={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},DD={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},ID={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},jD={ordinalNumber:Sk({matchPattern:CD,parsePattern:bD,valueCallback:e=>parseInt(e)}),era:va({matchPatterns:ND,defaultMatchWidth:"wide",parsePatterns:AD,defaultParseWidth:"any"}),quarter:va({matchPatterns:LD,defaultMatchWidth:"wide",parsePatterns:PD,defaultParseWidth:"any",valueCallback:e=>e+1}),month:va({matchPatterns:FD,defaultMatchWidth:"wide",parsePatterns:OD,defaultParseWidth:"any"}),day:va({matchPatterns:MD,defaultMatchWidth:"wide",parsePatterns:RD,defaultParseWidth:"any"}),dayPeriod:va({matchPatterns:DD,defaultMatchWidth:"any",parsePatterns:ID,defaultParseWidth:"any"})},BD={code:"fr",formatDistance:fD,formatLong:mD,formatRelative:xD,localize:TD,match:jD,options:{weekStartsOn:1,firstWeekContainsDate:4}},zD=()=>{const[e,t]=C.useState(null),[r,n]=C.useState(!0),[a,i]=C.useState(null),[o,l]=C.useState(null),u=k=>{switch(k.toLowerCase()){case"firewall":return d.jsx(ps,{className:"h-5 w-5 text-purple-600"});case"data_center":return d.jsx(mc,{className:"h-5 w-5 text-blue-600"});case"firewall_type":return d.jsx(gc,{className:"h-5 w-5 text-green-600"});case"command":return d.jsx(pb,{className:"h-5 w-5 text-yellow-600"});case"config":return d.jsx(kh,{className:"h-5 w-5 text-indigo-600"});case"auth":return d.jsx(Ba,{className:"h-5 w-5 text-red-600"});default:return d.jsx(kh,{className:"h-5 w-5 text-gray-600"})}},f=k=>({firewall:"Pare-feu",data_center:"Centre de donnes",firewall_type:"Type de pare-feu",command:"Commandes",config:"Configuration",auth:"Authentification"})[k]||k,h=k=>{try{return lD(new Date(k),"PPpp",{locale:BD})}catch{return k}},m=k=>k.includes("create")?"bg-green-100 text-green-800":k.includes("update")?"bg-blue-100 text-blue-800":k.includes("delete")?"bg-red-100 text-red-800":k.includes("status")?"bg-yellow-100 text-yellow-800":k.includes("restore")?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800",g=k=>({firewall_create:"Cration de pare-feu",firewall_update:"Modification de pare-feu",firewall_delete:"Suppression de pare-feu",firewall_type_create:"Cration de type de pare-feu",firewall_type_update:"Modification de type de pare-feu",firewall_type_delete:"Suppression de type de pare-feu",create:"Cration",update:"Modification",delete:"Suppression",add:"Ajout",remove:"Suppression",edit:"Modification",execute:"Excution",save:"Sauvegarde",restore:"Restauration",download:"Tlchargement",ping:"Test de connectivit",login:"Connexion",logout:"Dconnexion",password_change:"Changement de mot de passe",ssh_key_update:"Mise  jour de cl SSH"})[k.toLowerCase()]||k,x=(k,S,w)=>{const A=(w==null?void 0:w.name)||k||"Unknown";return A==="Unknown"?S:A},_=k=>typeof k=="string"?k:typeof k=="object"?JSON.stringify(k,null,2):String(k),y=()=>{if(!e||!e.services)return[];const k=[];return Object.entries(e.services).forEach(([S,w])=>{w.actions.forEach(A=>{k.push({...A,serviceType:S})})}),k.sort((S,w)=>new Date(w.timestamp).getTime()-new Date(S.timestamp).getTime())};if(C.useEffect(()=>{let k=!0;return(async()=>{try{if(n(!0),!ma())throw new Error("No authentication token found");const A=await an.get("/history/");k&&(t(A.data),n(!1))}catch(w){k&&(console.error("Error fetching history:",w),i("Failed to load history data"),n(!1))}})(),()=>{k=!1}},[]),r)return d.jsx("div",{className:"flex items-center justify-center h-screen",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900"})});if(a)return d.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mon Historique"}),d.jsx("p",{className:"text-gray-600",children:"Consultez l'historique de vos actions"})]}),d.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4",children:a})]});const E=y();return E.length===0?d.jsxs("div",{className:"text-center py-16",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mb-4",children:d.jsx(df,{className:"h-8 w-8 text-gray-400"})}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune action rcente"}),d.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:"Votre historique d'actions apparatra ici."})]}):d.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mon Historique"}),d.jsx("p",{className:"text-gray-600",children:"Historique de vos actions sur les services"})]}),d.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:E.map(k=>d.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[d.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>l(o===k.id?null:k.id),children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[u(k.serviceType),d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m(k.action)}`,children:g(k.action)}),d.jsx("span",{className:"text-sm font-medium text-gray-900",children:x(k.entity_name,k.action,k.details)}),d.jsx("span",{className:"text-sm text-gray-500",children:f(k.serviceType)})]}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[d.jsx(df,{className:"h-4 w-4 mr-1"}),h(k.timestamp)]}),o===k.id?d.jsx(sb,{className:"h-5 w-5 text-gray-500"}):d.jsx(ff,{className:"h-5 w-5 text-gray-500"})]})]})}),o===k.id&&d.jsx("div",{className:"px-4 pb-4 bg-gray-50",children:d.jsxs("div",{className:"flex items-start space-x-2",children:[d.jsx(wh,{className:"h-5 w-5 text-gray-400 mt-0.5"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Dtails de l'action"}),d.jsx("pre",{className:"text-sm text-gray-600 whitespace-pre-wrap bg-white p-3 rounded-lg border border-gray-200",children:_(k.details)})]})]})})]},k.id))})]})},UD=()=>localStorage.getItem("token"),Ra=Ue.create({baseURL:jt});Ra.interceptors.request.use(e=>{const t=UD();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ra.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));function HD(){ka();const[e,t]=C.useState(!1),[r,n]=C.useState(null),[a,i]=C.useState(null),[o,l]=C.useState([]),[u,f]=C.useState([]),[h,m]=C.useState(`config global
get system status
diagnose autoupdate versions
get hardware memory`),[g,x]=C.useState([]),[_,y]=C.useState(""),[E,k]=C.useState("");C.useEffect(()=>{(async()=>{try{t(!0),n(null);const B=await Ra.get("/datacenters/hierarchy/");x(B.data)}catch(B){console.error("Error fetching hierarchy:",B),n("Failed to fetch hierarchy data")}finally{t(!1)}})()},[]),C.useEffect(()=>{(async()=>{try{const B=await Ra.get("/daily-check/daily-checks/");f(B.data.results||[])}catch(B){console.error("Error fetching daily checks:",B),f([])}})()},[]);const S=()=>{if(!_)return[];const V=g.find(B=>B.id===_);return V?V.firewall_types:[]},w=()=>{if(!E)return[];const V=g.find(Z=>Z.id===_);if(!V)return[];const B=V.firewall_types.find(Z=>Z.id===E);return B?B.firewalls:[]},A=V=>{const B=V.target.value;y(B),k(""),l([])},I=V=>{const B=V.target.value;k(B),l([])},D=()=>{const V=w();o.length===V.length?l([]):l(V.map(B=>B.id))},P=V=>{l(B=>B.includes(V)?B.filter(Z=>Z!==V):[...B,V])},W=async()=>{if(!o.length){n("Please select at least one firewall");return}if(!h.trim()){n("Please enter at least one command");return}t(!0),n(null),i(null);try{const V=h.split(`
`).filter(Z=>Z.trim()),B=await Ra.post("/daily-check/daily-checks/run_multiple_checks/",{firewalls:o,commands:V});if(B.data.status==="success"){i("Daily checks started. You can leave this page, the checks will continue in the background.");const Z=B.data.task_id,K=setInterval(async()=>{try{const _e=(await Ra.get(`/daily-check/daily-checks/check_task_status/?task_id=${Z}`)).data;if(i(`${_e.message} (${_e.progress}%)`),_e.status==="completed"){clearInterval(K),i("All daily checks completed successfully");const de=await Ra.get("/daily-check/daily-checks/");if(f(de.data.results||[]),_e.results&&_e.results.length>0){const J=[...new Set(_e.results.filter(Q=>Q.success&&Q.report_path).map(Q=>Q.report_path))];for(const Q of J)try{const U=await Ra.get("/daily-check/daily-checks/download_multiple_reports/",{responseType:"blob",params:{report_path:Q}}),te=new Blob([U.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),fe=window.URL.createObjectURL(te),F=document.createElement("a");F.href=fe,F.setAttribute("download",`daily_check_${new Date().toISOString()}.xlsx`),document.body.appendChild(F),F.click(),document.body.removeChild(F),window.URL.revokeObjectURL(fe)}catch(U){console.error("Error downloading report:",U),kr.error(`Failed to download report from ${Q}`)}}}else _e.status==="failed"&&(clearInterval(K),n(`Daily checks failed: ${_e.message}`))}catch(ve){console.error("Error checking task status:",ve),clearInterval(K),n("Failed to check task status")}},2e3);return()=>clearInterval(K)}else n("Failed to start daily checks")}catch(V){console.error("Error during daily check:",V),n("Failed to start daily checks")}finally{t(!1)}},j=async V=>{try{const B=await Ra.get(`/daily-check/daily-checks/${V}/download_report/`,{responseType:"blob"}),Z=new Blob([B.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),K=window.URL.createObjectURL(Z),ve=document.createElement("a");ve.href=K;const _e=B.headers["content-disposition"];let de="daily_check_report.xlsx";if(_e){const J=_e.match(/filename="(.+)"/);J&&(de=J[1])}ve.setAttribute("download",de),document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),window.URL.revokeObjectURL(K)}catch(B){console.error("Error downloading report:",B),kr.error("Failed to download report")}};return e?d.jsx("div",{className:"p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-purple-600 border-r-transparent"}),d.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):d.jsxs("div",{className:"p-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firewall"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Daily Check"}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(mc,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Data Center"}),d.jsxs("select",{value:_,onChange:A,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",children:[d.jsx("option",{value:"",children:"All data centers"}),g.map(V=>d.jsx("option",{value:V.id,children:V.name},V.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(ps,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewall Type"}),d.jsxs("select",{value:E,onChange:I,disabled:!_,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md ${_?"":"bg-gray-100"}`,children:[d.jsx("option",{value:"",children:"Select a firewall type"}),S().map(V=>d.jsx("option",{value:V.id,children:V.name},V.id))]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(gc,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Firewalls"}),d.jsxs("div",{className:"mt-1 space-y-2",children:[d.jsx("button",{onClick:D,disabled:!E,className:`w-full px-3 py-1 text-sm rounded-md ${o.length===w().length?"bg-purple-600 text-white":"bg-purple-100 text-purple-700"} ${E?"":"opacity-50 cursor-not-allowed"}`,children:o.length===w().length?"Deselect All":"Select All"}),d.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:w().map(V=>d.jsxs("div",{className:`flex items-center p-2 rounded-md cursor-pointer ${o.includes(V.id)?"bg-purple-100":"hover:bg-gray-100"}`,onClick:()=>P(V.id),children:[d.jsx("input",{type:"checkbox",checked:o.includes(V.id),onChange:()=>P(V.id),className:"mr-2"}),d.jsxs("span",{className:"text-sm",children:[V.name," - ",V.ip_address]})]},V.id))})]})]})]})]}),d.jsx("div",{className:"mt-6",children:d.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[d.jsx(yh,{className:"h-6 w-6 text-purple-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Commands (one per line)"}),d.jsx("textarea",{value:h,onChange:V=>m(V.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm rounded-md",rows:5,placeholder:"Enter commands (one per line)"})]})]})})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[r&&d.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md mb-4",children:r}),a&&d.jsx("div",{className:"p-3 bg-green-100 text-green-700 rounded-md mb-4",children:a}),d.jsx("div",{className:"flex space-x-4",children:d.jsxs("button",{onClick:W,disabled:e||!o.length,className:"flex-1 flex items-center justify-center px-4 py-2 bg-purple-900 text-white rounded-md hover:bg-purple-800 disabled:opacity-50",children:[d.jsx(Zp,{className:"h-5 w-5 mr-2"}),e?"Running...":"Run Daily Check"]})})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Daily Checks History"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Firewall"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(V=>{var K,ve;const B=(ve=(K=V.historique_dailycheck)==null?void 0:K.entries)==null?void 0:ve[V.historique_dailycheck.entries.length-1],Z=(B==null?void 0:B.user)||"Unknown";return d.jsxs("tr",{children:[d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:V.firewall.name}),d.jsx("div",{className:"text-sm text-gray-500",children:V.firewall.ip_address})]}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-gray-900",children:Z})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-gray-900",children:new Date(V.check_date).toLocaleString()})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${V.status==="SUCCESS"?"bg-green-100 text-green-800":V.status==="FAILED"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:V.status})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:V.excel_report&&d.jsxs("button",{onClick:()=>j(V.id),className:"text-purple-600 hover:text-purple-900 flex items-center",children:[d.jsx(yh,{className:"h-4 w-4 mr-1"}),"Download Report"]})})]},V.id)})})]})})]})]})}delete Er.Icon.Default.prototype._getIconUrl;Er.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const Hs=Ue.create({baseURL:jt,headers:{"Content-Type":"application/json",Accept:"application/json"}});Hs.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const fv=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),VD=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#ef4444" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),WD=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#f97316" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),$D=Er.divIcon({className:"custom-datacenter-icon",html:`
    <svg fill="#22c55e" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	   viewBox="0 0 60 60" xml:space="preserve">
      <g>
        <g>
          <path d="M2,34H0v25c0,0.6,0.4,1,1,1h26v-2H2V34z"/>
          <path d="M58,58H33v2h26c0.6,0,1-0.4,1-1V34h-2V58z"/>
          <path d="M59,0H33v2h25v6H36v2h22v18h2V1C60,0.4,59.6,0,59,0z"/>
          <path d="M2,10h22V8H2V2h25V0H1C0.4,0,0,0.4,0,1v27h2V10z"/>
          <rect x="4" y="4" width="2" height="2"/>
          <rect x="8" y="4" width="2" height="2"/>
          <rect x="12" y="4" width="2" height="2"/>
          <rect x="52" y="4" width="4" height="2"/>
          <path d="M16,16v10v10v10c0,0.6,0.4,1,1,1h26c0.6,0,1-0.4,1-1V36V26V16c0-0.6-0.4-1-1-1H17C16.4,15,16,15.4,16,16z M42,35H18v-8h24
            V35z M42,45H18v-8h24V45z M18,17h24v8H18V17z"/>
          <rect x="20" y="19" width="2" height="4"/>
          <rect x="24" y="19" width="2" height="4"/>
          <rect x="28" y="19" width="2" height="4"/>
          <rect x="20" y="29" width="2" height="4"/>
          <rect x="24" y="29" width="2" height="4"/>
          <rect x="28" y="29" width="2" height="4"/>
          <rect x="34" y="20" width="2" height="2"/>
          <rect x="38" y="20" width="2" height="2"/>
          <rect x="34" y="30" width="2" height="2"/>
          <rect x="38" y="30" width="2" height="2"/>
          <rect x="29" y="40" width="6" height="2"/>
          <rect x="37" y="40" width="2" height="2"/>
          <rect x="25" y="40" width="2" height="2"/>
          <rect x="21" y="40" width="2" height="2"/>
        </g>
      </g>
    </svg>
  `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),GD=`
  .custom-datacenter-icon {
    background: none;
    border: none;
  }
  .custom-datacenter-icon svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.2s ease;
  }
  .custom-datacenter-icon:hover svg {
    transform: scale(1.1);
  }
  .leaflet-popup-content-wrapper {
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  .leaflet-popup-content {
    margin: 0;
    min-width: 300px;
    max-width: 500px;
  }
  .datacenter-popup-content {
    padding: 1rem;
    min-width: 300px;
    max-width: 500px;
    max-height: 500px;
    overflow-y: auto;
    background: white;
    border-radius: 8px;
  }
`,ZD=()=>{const[e,t]=C.useState([]),[r,n]=C.useState({}),[a,i]=C.useState({}),[o,l]=C.useState({}),[u,f]=C.useState(null),[h,m]=C.useState(!1),g=C.useRef(null),{token:x}=Pm(),[_,y]=C.useState("all"),[E,k]=C.useState(""),[S,w]=C.useState(!1),[A,I]=C.useState({}),D=J=>{I(Q=>({...Q,[J]:!Q[J]}))};C.useEffect(()=>{const J=document.createElement("style");return J.innerText=GD,document.head.appendChild(J),()=>{document.head.removeChild(J)}},[]);const P=J=>{f(J),g.current&&clearTimeout(g.current),g.current=window.setTimeout(()=>{window.location.reload()},3e3)};C.useEffect(()=>{console.log("Starting authentication check...");const J=localStorage.getItem("token");if(!J){console.log("No token found"),P("Please login to access this page");return}return console.log("Token found, verifying..."),Hs.get("/datacenters/",{headers:{Authorization:`Bearer ${J}`,"Content-Type":"application/json",Accept:"application/json"}}).then(()=>{console.log("Token verified successfully"),m(!0)}).catch(Q=>{var U;console.error("Token verification failed:",Q),Ue.isAxiosError(Q)&&(((U=Q.response)==null?void 0:U.status)===401?(P("Session expired. Please login again."),localStorage.removeItem("token"),window.location.href="/login"):f("Server connection error"))}),()=>{g.current&&clearTimeout(g.current)}},[]),C.useEffect(()=>{console.log("Map initialization effect running, isInitialized:",h),h&&(console.log("Setting default marker icon"),Er.Marker.prototype.options.icon=fv)},[h]),C.useEffect(()=>{if(console.log("Fetch datacenters effect running, isInitialized:",h),!h)return;(async()=>{var Q;try{console.log("Starting to fetch datacenters...");const U=localStorage.getItem("token");if(!U){console.log("No token found during fetch"),f("Token not found. Please login again.");return}const te=await Hs.get("/datacenters/",{headers:{Authorization:`Bearer ${U}`,"Content-Type":"application/json",Accept:"application/json"}});console.log("Raw API response:",te.data),te.data.results?(console.log("Setting datacenters:",te.data.results),t(te.data.results),te.data.results.forEach(fe=>{W(fe.id)})):(console.log("No results in API response"),t([]))}catch(U){console.error("Error fetching datacenters:",U),Ue.isAxiosError(U)&&(((Q=U.response)==null?void 0:Q.status)===401?(f("Session expired. Please login again."),localStorage.removeItem("token"),window.location.href="/login"):f("Error loading datacenters")),t([])}})()},[h]),C.useEffect(()=>{console.log("Datacenters state updated:",e)},[e]);const W=async J=>{var Q;try{l(fe=>({...fe,[J]:!0}));const U=localStorage.getItem("token");if(!U){f("Token not found. Please login again.");return}const te=await Hs.get("/datacenters/hierarchy/",{headers:{Authorization:`Bearer ${U}`,"Content-Type":"application/json",Accept:"application/json"}});if(te.data){const fe=te.data.find(F=>F.id===J);fe&&fe.firewall_types?(console.log(`Datacenter found in hierarchy (ID: ${J}):`,fe),n(F=>({...F,[J]:fe.firewall_types}))):(console.warn(`Datacenter with ID ${J} not found or has no firewall types in hierarchy.`,te.data),n(F=>({...F,[J]:[]})))}}catch(U){console.error("Error fetching firewall types:",U),Ue.isAxiosError(U)&&((Q=U.response)==null?void 0:Q.status)===401?(f("Session expired. Please login again."),localStorage.removeItem("token"),window.location.href="/login"):f("Error fetching firewall types")}finally{l(U=>({...U,[J]:!1}))}},j=C.useMemo(()=>e.filter(J=>_==="all"?!0:_==="online"?J.is_active:_==="offline"?!J.is_active:!1),[e,_]),V=(J,Q,U)=>{const te=Q[J]||[];let fe=0,F=0,ee=!1;return te.forEach(q=>{var X;(X=q.firewalls)==null||X.forEach(ae=>{const ke=U[ae.id];ke&&!_e(ke.lastUpdate)?(fe++,ke.status==="online"&&F++):ee=!0})}),fe===0||ee?"unknown":F===fe?"online":F===0?"offline":"partial"},B=C.useCallback(J=>{switch(V(J,r,a)){case"online":return $D;case"offline":return VD;case"partial":return WD;default:return fv}},[r,a]),Z=C.useCallback(J=>{W(J.id)},[W]),K=C.useCallback(async J=>{var Q;if(((Q=a[J])==null?void 0:Q.status)!=="loading")try{i(fe=>({...fe,[J]:{status:"loading",responseTime:null}}));const U=await Hs.post(`/firewalls/${J}/ping/`);if(console.log(`Ping response for firewall ${J}:`,U.data),!U.data)throw new Error("Invalid response from server");if(console.log("Response data details:",{status:U.data.status,response_time:U.data.response_time,message:U.data.message}),U.data.status==="error"){console.log("Error status detected, setting firewall to offline"),i(fe=>({...fe,[J]:{status:"offline",responseTime:null,lastUpdate:Date.now(),error:U.data.message||"Connection failed"}}));return}const te=U.data.status==="online"?"online":"offline";console.log("Status determination:",{firewallId:J,status:te,responseTime:U.data.response_time}),i(fe=>({...fe,[J]:{status:te,responseTime:U.data.response_time,lastUpdate:Date.now(),error:U.data.message||void 0}}))}catch(U){console.error(`Error pinging firewall ${J}:`,U),i(te=>({...te,[J]:{status:"offline",responseTime:null,lastUpdate:Date.now(),error:U instanceof Error?U.message:"Connection failed"}}))}},[a]),ve=C.useCallback(async()=>{if(!x){f("Please login to perform this action.");return}w(!0);try{const J=await Hs.post("/firewalls/ping_all/");if(console.log("Ping all response:",J.data),J.data&&J.data.results){const Q={};J.data.results.forEach(U=>{Q[U.id]={status:U.status==="online"?"online":"offline",responseTime:U.response_time,lastUpdate:Date.now(),error:U.message}}),i(U=>({...U,...Q})),console.log("Ping statistics:",{total:J.data.total,online:J.data.online,offline:J.data.offline,errors:J.data.errors})}}catch(J){console.error("Error pinging all firewalls:",J),f("Error pinging all firewalls")}finally{w(!1)}},[x]),_e=J=>J?Date.now()-J>5*60*1e3:!0,de=C.useMemo(()=>j.map(J=>{if(!J.latitude||!J.longitude)return null;const Q=parseFloat(J.latitude.toString()),U=parseFloat(J.longitude.toString());if(isNaN(Q)||isNaN(U))return null;const te=V(J.id,r,a);return d.jsx(mk,{position:[Q,U],icon:B(J.id),eventHandlers:{click:()=>Z(J)},children:d.jsx(gk,{children:d.jsxs("div",{className:"datacenter-popup-content",children:[d.jsxs("div",{className:"border-b border-gray-200 pb-3 mb-4",children:[d.jsxs("h3",{className:"font-semibold text-lg text-purple-700 flex items-center gap-2",children:[d.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 2L2 7v10l10 5 10-5V7L12 2zm0 2.5L20 8v8l-8 4-8-4V8l8-3.5z",fill:"currentColor"})}),J.name]}),J.location&&d.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[d.jsx("span",{className:"font-medium",children:"Adresse:"})," ",J.location]}),d.jsx("div",{className:"mt-2",children:d.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${te==="online"?"bg-green-100 text-green-800":te==="offline"?"bg-red-100 text-red-800":te==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:te==="online"?"Actif":te==="offline"?"Inactif":te==="partial"?"Partiellement Actif":"Statut Inconnu"})})]}),d.jsxs("div",{className:"mt-4",children:[d.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-3 flex items-center gap-2",children:[d.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),"Types de Firewall"]}),o[J.id]?d.jsxs("div",{className:"flex items-center justify-center py-4",children:[d.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-purple-500 border-t-transparent"}),d.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Chargement des firewalls..."})]}):r[J.id]?d.jsx("div",{className:"space-y-3",children:r[J.id].map(fe=>d.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[d.jsx("div",{className:"bg-purple-50 p-3 border-b border-purple-100 cursor-pointer hover:bg-purple-100 transition-colors",onClick:()=>D(fe.id),children:d.jsxs("div",{className:"font-medium text-sm text-purple-700 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})}),fe.name]}),d.jsx("svg",{className:`w-4 h-4 transform transition-transform ${A[fe.id]?"rotate-180":""}`,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M7 10l5 5 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),A[fe.id]&&d.jsx("div",{className:"p-3",children:fe.firewalls&&fe.firewalls.length>0?d.jsx("div",{className:"space-y-2",children:fe.firewalls.map(F=>{var ee,q,X,ae,ke,Le,Ne,we,Be;return d.jsx("div",{className:"bg-gray-50 rounded-md p-3 hover:bg-gray-100 transition-colors",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm",children:d.jsx("svg",{className:"w-4 h-4 text-purple-600",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.18l7 3.12v4.7c0 4.67-3.13 8.96-7 10.69-3.87-1.73-7-6.02-7-10.69v-4.7l7-3.12z",fill:"currentColor"})})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-medium text-sm",children:F.name}),d.jsx("div",{className:"text-xs text-gray-500 mt-1",children:F.ip_address})]})]}),d.jsxs("button",{onClick:G=>{G.stopPropagation(),K(F.id)},className:`px-3 py-1.5 rounded-md text-white text-sm flex items-center gap-2 transition-colors ${((ee=a[F.id])==null?void 0:ee.status)==="loading"?"bg-gray-400":((q=a[F.id])==null?void 0:q.status)==="online"?"bg-green-500 hover:bg-green-600":((X=a[F.id])==null?void 0:X.status)==="offline"?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600"}`,disabled:((ae=a[F.id])==null?void 0:ae.status)==="loading",title:((ke=a[F.id])==null?void 0:ke.error)||"",children:[((Le=a[F.id])==null?void 0:Le.status)==="loading"?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):((Ne=a[F.id])==null?void 0:Ne.status)==="online"?d.jsx(Sh,{className:"w-4 h-4"}):((we=a[F.id])==null?void 0:we.status)==="offline"?d.jsx(Eh,{className:"w-4 h-4"}):"Ping",((Be=a[F.id])==null?void 0:Be.status)==="online"&&a[F.id].responseTime&&d.jsxs("span",{children:[Math.round(a[F.id].responseTime||0),"ms"]})]})]})},F.id)})}):d.jsx("div",{className:"text-center text-sm text-gray-500",children:"Aucun firewall trouv"})})]},fe.id))}):d.jsx("div",{className:"text-center text-sm text-gray-500",children:"Aucun type de firewall trouv"})]})]})})},J.id)}),[j,B,K,Z,D,o,r,A,a]);return d.jsxs("div",{className:"h-screen w-full",children:[u&&d.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-500 text-white p-2 text-center z-50",children:u}),d.jsxs("div",{className:"absolute top-4 right-4 z-[1000] bg-white rounded-lg shadow-lg p-4 space-y-4 w-80",children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:E,onChange:J=>k(J.target.value),placeholder:"Rechercher un datacenter...",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),E&&d.jsx("button",{onClick:()=>k(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:()=>y("all"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${_==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous"}),d.jsx("button",{onClick:()=>y("online"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${_==="online"?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"En ligne"}),d.jsx("button",{onClick:()=>y("offline"),className:`flex-1 px-3 py-1.5 rounded-md text-sm ${_==="offline"?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Hors ligne"})]}),d.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[d.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Statistiques"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Datacenters:"}),d.jsx("span",{className:"font-semibold",children:j.length})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"En ligne:"}),d.jsx("span",{className:"text-green-500 font-semibold",children:j.filter(J=>{const Q=r[J.id]||[];let U=0,te=0;return Q.forEach(fe=>{var F;(F=fe.firewalls)==null||F.forEach(ee=>{const q=a[ee.id];q&&!_e(q.lastUpdate)&&(U++,q.status==="online"&&te++)})}),J.is_active&&(U===0||te===U)}).length})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Hors ligne:"}),d.jsx("span",{className:"text-red-500 font-semibold",children:j.filter(J=>{const Q=r[J.id]||[];let U=0,te=0;return Q.forEach(fe=>{var F;(F=fe.firewalls)==null||F.forEach(ee=>{const q=a[ee.id];q&&!_e(q.lastUpdate)&&(U++,q.status==="online"&&te++)})}),!J.is_active||U>0&&te<U}).length})]})]})]}),d.jsx("button",{onClick:ve,disabled:S,className:`w-full px-4 py-2 rounded-md text-white text-sm flex items-center justify-center gap-2 ${S?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:S?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Test en cours..."]}):d.jsxs(d.Fragment,{children:[d.jsx(f2,{className:"w-4 h-4"}),"Tester tous les firewalls"]})})]}),d.jsxs(pk,{center:[31.7917,-7.0926],zoom:6,style:{height:"100%",width:"100%"},minZoom:4,maxZoom:18,children:[d.jsx(xk,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),d.jsx(yk,{chunkedLoading:!0,maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:J=>Er.divIcon({html:`<div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">${J.getChildCount()}</div>`,className:"custom-cluster-icon",iconSize:Er.point(32,32)}),children:de})]})]})},XD=os.memo(ZD),un=({children:e})=>localStorage.getItem("token")?d.jsx(d.Fragment,{children:e}):d.jsx(GT,{to:"/login"}),fn=({children:e})=>{const[t,r]=C.useState(!1),n=ka(),a=async()=>{try{await an.post("/auth/logout/")}catch(i){console.error("Logout error:",i)}finally{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),delete an.defaults.headers.common.Authorization,n("/login")}};return t?d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-900"})}):d.jsxs("div",{className:"flex h-screen bg-gray-100",children:[d.jsx(_b,{onLogout:a}),d.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:d.jsx("main",{className:"flex-1 overflow-y-auto",children:e})})]})},qD=()=>{const[e,t]=C.useState(!1),r=ka();return C.useEffect(()=>{tb(r)},[r]),C.useEffect(()=>{const n=localStorage.getItem("token"),a=localStorage.getItem("refreshToken");n&&a&&(t(!0),an.defaults.headers.common.Authorization=`Bearer ${n}`)},[]),d.jsxs(XT,{children:[d.jsx(Mr,{path:"/login",element:d.jsx(gb,{onLogin:()=>t(!0)})}),d.jsx(Mr,{path:"/register",element:d.jsx(xb,{onRegister:()=>t(!0)})}),d.jsx(Mr,{path:"/",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(tv,{})})})}),d.jsx(Mr,{path:"/firewalls",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(tv,{})})})}),d.jsx(Mr,{path:"/profile",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(nR,{})})})}),d.jsx(Mr,{path:"/templates",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(xd,{})})})}),d.jsx(Mr,{path:"/templates/new",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(xd,{})})})}),d.jsx(Mr,{path:"/templates/:id",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(xd,{})})})}),d.jsx(Mr,{path:"/config",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(SM,{})})})}),d.jsx(Mr,{path:"/matrix",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(FO,{})})})}),d.jsx(Mr,{path:"/map",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(rR,{})})})}),d.jsx(Mr,{path:"/settings",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(TM,{})})})}),d.jsx(Mr,{path:"/history",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(zD,{})})})}),d.jsx(Mr,{path:"/daily-check",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(HD,{})})})}),d.jsx(Mr,{path:"/network-map",element:d.jsx(un,{children:d.jsx(fn,{children:d.jsx(XD,{})})})})]})};function YD(){return d.jsxs($T,{children:[d.jsx(kM,{position:"top-right"}),d.jsx(OM,{children:d.jsx(qD,{})})]})}window.__REACT_DEVTOOLS_GLOBAL_HOOK__={isDisabled:!0};vd.createRoot(document.getElementById("root")).render(d.jsx(os.StrictMode,{children:d.jsx(YD,{})}));
